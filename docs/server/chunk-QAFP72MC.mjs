import './polyfills.server.mjs';
import{$ as yi,$a as Ii,$b as Ide,A as tde,Aa as dde,Ab as yde,B as ide,Ba as vr,C as rde,Ca as ar,Cb as wde,D as ZR,Da as wi,Db as Xi,E as cL,Ea as mi,Eb as sA,F as Fs,Fa as ht,G as uc,Ga as tl,Gb as bi,H as Hr,Ha as hi,Hb as Ia,I as nde,Ia as Aa,Ib as CW,J as Qc,Ja as ude,Jb as Cde,K as dL,Ka as Mr,Kb as xde,L as hc,La as rA,Lb as Sde,M as kt,Ma as nA,Mb as xW,N as Dt,Na as ae,Nb as ir,O as St,Oa as ne,P as lt,Pa as bt,Pb as mL,Q as Jt,Qa as b_,Qb as JC,R as QR,Ra as eo,Rb as ex,S as JR,Sa as il,Sb as gL,T as Tt,Ta as hde,Tb as vL,U as Mt,Ua as At,Ub as bL,V as Ot,Va as fde,Vb as Wn,W as ode,Wa as $t,Wb as Ede,X as v_,Xa as Br,Xb as ev,Y as sde,Ya as Ri,Yb as Tde,Z as Li,Za as pde,Zb as Rde,_ as _i,_a as ws,_b as Ade,a as jn,aa as cf,ab as ai,ac as Dde,b as m_,ba as $C,bb as li,bc as zu,c as Qce,ca as el,cb as mde,cc as fc,d as Ft,da as Jc,db as gde,dc as ns,e as Ta,ea as kn,eb as Js,ec as df,f as Jce,fa as uL,fb as _e,fc as SW,g as qC,ga as qt,gb as zn,gc as Ll,h as XR,ha as Nt,hb as ji,hc as Mde,i as qi,ia as eA,ib as vde,ic as kde,j as ede,ja as ade,jb as KC,k as Qg,ka as lde,kb as ZC,l as Gi,la as rs,lb as QC,lc as Ode,m as Jg,ma as cde,mb as zi,n as KR,na as GC,nb as zt,o as YC,oa as Ye,ob as _W,p as lf,pa as Te,pb as yW,q as pW,qa as tA,qb as oA,r as Ra,ra as Pl,rb as br,rc as Nde,s as Ls,sa as XC,sb as _r,sc as Pde,t as mW,ta as hL,tb as pL,u as g_,ua as ni,v as gW,va as fL,vb as bde,w as vW,wa as ed,wb as wW,x as lL,xa as Qs,y as Vo,ya as bW,z as Kp,za as iA,zb as _de}from"./chunk-JDLEWR2H.mjs";import{a as Yde}from"./chunk-GAGSLIHV.mjs";import{A as vYe,D as bYe,E as Bde,F as AW,M as Vde,O as IW,Q as _Ye,S as rl,T as DW,U as yYe,V as jde,X as MW,Y as zde,Z as Wde,a as _L,aa as Ude,b as yL,ba as wYe,c as EW,d as wL,e as Lde,ea as qde,f as tx,g as sYe,ga as kW,ha as CYe,i as aYe,j as lYe,ja as xYe,ka as SYe,l as aA,m as Fde,ma as EYe,n as TW,na as TYe,o as cYe,p as dYe,r as uYe,s as hYe,t as fYe,u as pYe,v as mYe,w as Hde,y as RW,z as gYe}from"./chunk-3HRQEJXM.mjs";import{a as Ke,b as Lt,c as Ze,d as Mn,e as Ja,f as z,g as fW,h as U,i as Zce,j as Ei,k as _o,l as dc,m as af,n as Ea}from"./chunk-BA4H3CMS.mjs";var nl=z((gU,_x)=>{"use strict";(function(t,e){typeof gU=="object"&&typeof _x<"u"?_x.exports=e():typeof define=="function"&&define.amd?define(e):t.moment=e()})(gU,function(){"use strict";var t;function e(){return t.apply(null,arguments)}function i(b){t=b}function r(b){return b instanceof Array||Object.prototype.toString.call(b)==="[object Array]"}function n(b){return b!=null&&Object.prototype.toString.call(b)==="[object Object]"}function o(b,E){return Object.prototype.hasOwnProperty.call(b,E)}function s(b){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(b).length===0;var E;for(E in b)if(o(b,E))return!1;return!0}function a(b){return b===void 0}function c(b){return typeof b=="number"||Object.prototype.toString.call(b)==="[object Number]"}function d(b){return b instanceof Date||Object.prototype.toString.call(b)==="[object Date]"}function u(b,E){var H=[],q,me=b.length;for(q=0;q<me;++q)H.push(E(b[q],q));return H}function h(b,E){for(var H in E)o(E,H)&&(b[H]=E[H]);return o(E,"toString")&&(b.toString=E.toString),o(E,"valueOf")&&(b.valueOf=E.valueOf),b}function p(b,E,H,q){return Ga(b,E,H,q,!0).utc()}function f(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(b){return b._pf==null&&(b._pf=f()),b._pf}var g;Array.prototype.some?g=Array.prototype.some:g=function(b){var E=Object(this),H=E.length>>>0,q;for(q=0;q<H;q++)if(q in E&&b.call(this,E[q],q,E))return!0;return!1};function y(b){var E=null,H=!1,q=b._d&&!isNaN(b._d.getTime());if(q&&(E=m(b),H=g.call(E.parsedDateParts,function(me){return me!=null}),q=E.overflow<0&&!E.empty&&!E.invalidEra&&!E.invalidMonth&&!E.invalidWeekday&&!E.weekdayMismatch&&!E.nullInput&&!E.invalidFormat&&!E.userInvalidated&&(!E.meridiem||E.meridiem&&H),b._strict&&(q=q&&E.charsLeftOver===0&&E.unusedTokens.length===0&&E.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(b))b._isValid=q;else return q;return b._isValid}function w(b){var E=p(NaN);return b!=null?h(m(E),b):m(E).userInvalidated=!0,E}var x=e.momentProperties=[],T=!1;function M(b,E){var H,q,me,Pe=x.length;if(a(E._isAMomentObject)||(b._isAMomentObject=E._isAMomentObject),a(E._i)||(b._i=E._i),a(E._f)||(b._f=E._f),a(E._l)||(b._l=E._l),a(E._strict)||(b._strict=E._strict),a(E._tzm)||(b._tzm=E._tzm),a(E._isUTC)||(b._isUTC=E._isUTC),a(E._offset)||(b._offset=E._offset),a(E._pf)||(b._pf=m(E)),a(E._locale)||(b._locale=E._locale),Pe>0)for(H=0;H<Pe;H++)q=x[H],me=E[q],a(me)||(b[q]=me);return b}function B(b){M(this,b),this._d=new Date(b._d!=null?b._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),T===!1&&(T=!0,e.updateOffset(this),T=!1)}function G(b){return b instanceof B||b!=null&&b._isAMomentObject!=null}function F(b){e.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+b)}function O(b,E){var H=!0;return h(function(){if(e.deprecationHandler!=null&&e.deprecationHandler(null,b),H){var q=[],me,Pe,et,Ut=arguments.length;for(Pe=0;Pe<Ut;Pe++){if(me="",typeof arguments[Pe]=="object"){me+=`
[`+Pe+"] ";for(et in arguments[0])o(arguments[0],et)&&(me+=et+": "+arguments[0][et]+", ");me=me.slice(0,-2)}else me=arguments[Pe];q.push(me)}F(b+`
Arguments: `+Array.prototype.slice.call(q).join("")+`
`+new Error().stack),H=!1}return E.apply(this,arguments)},E)}var V={};function J(b,E){e.deprecationHandler!=null&&e.deprecationHandler(b,E),V[b]||(F(E),V[b]=!0)}e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;function N(b){return typeof Function<"u"&&b instanceof Function||Object.prototype.toString.call(b)==="[object Function]"}function P(b){var E,H;for(H in b)o(b,H)&&(E=b[H],N(E)?this[H]=E:this["_"+H]=E);this._config=b,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function $(b,E){var H=h({},b),q;for(q in E)o(E,q)&&(n(b[q])&&n(E[q])?(H[q]={},h(H[q],b[q]),h(H[q],E[q])):E[q]!=null?H[q]=E[q]:delete H[q]);for(q in b)o(b,q)&&!o(E,q)&&n(b[q])&&(H[q]=h({},H[q]));return H}function K(b){b!=null&&this.set(b)}var ve;Object.keys?ve=Object.keys:ve=function(b){var E,H=[];for(E in b)o(b,E)&&H.push(E);return H};var W={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function ee(b,E,H){var q=this._calendar[b]||this._calendar.sameElse;return N(q)?q.call(E,H):q}function te(b,E,H){var q=""+Math.abs(b),me=E-q.length,Pe=b>=0;return(Pe?H?"+":"":"-")+Math.pow(10,Math.max(0,me)).toString().substr(1)+q}var se=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ae=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,k={},S={};function I(b,E,H,q){var me=q;typeof q=="string"&&(me=function(){return this[q]()}),b&&(S[b]=me),E&&(S[E[0]]=function(){return te(me.apply(this,arguments),E[1],E[2])}),H&&(S[H]=function(){return this.localeData().ordinal(me.apply(this,arguments),b)})}function X(b){return b.match(/\[[\s\S]/)?b.replace(/^\[|\]$/g,""):b.replace(/\\/g,"")}function Q(b){var E=b.match(se),H,q;for(H=0,q=E.length;H<q;H++)S[E[H]]?E[H]=S[E[H]]:E[H]=X(E[H]);return function(me){var Pe="",et;for(et=0;et<q;et++)Pe+=N(E[et])?E[et].call(me,b):E[et];return Pe}}function le(b,E){return b.isValid()?(E=xe(E,b.localeData()),k[E]=k[E]||Q(E),k[E](b)):b.localeData().invalidDate()}function xe(b,E){var H=5;function q(me){return E.longDateFormat(me)||me}for(Ae.lastIndex=0;H>=0&&Ae.test(b);)b=b.replace(Ae,q),Ae.lastIndex=0,H-=1;return b}var Re={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Oe(b){var E=this._longDateFormat[b],H=this._longDateFormat[b.toUpperCase()];return E||!H?E:(this._longDateFormat[b]=H.match(se).map(function(q){return q==="MMMM"||q==="MM"||q==="DD"||q==="dddd"?q.slice(1):q}).join(""),this._longDateFormat[b])}var We="Invalid date";function Le(){return this._invalidDate}var Ne="%d",it=/\d{1,2}/;function ct(b){return this._ordinal.replace("%d",b)}var Ue={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Se(b,E,H,q){var me=this._relativeTime[H];return N(me)?me(b,E,H,q):me.replace(/%d/i,b)}function gt(b,E){var H=this._relativeTime[b>0?"future":"past"];return N(H)?H(E):H.replace(/%s/i,E)}var ce={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function de(b){return typeof b=="string"?ce[b]||ce[b.toLowerCase()]:void 0}function ye(b){var E={},H,q;for(q in b)o(b,q)&&(H=de(q),H&&(E[H]=b[q]));return E}var Me={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function pe(b){var E=[],H;for(H in b)o(b,H)&&E.push({unit:H,priority:Me[H]});return E.sort(function(q,me){return q.priority-me.priority}),E}var ue=/\d/,A=/\d\d/,L=/\d{3}/,Y=/\d{4}/,Z=/[+-]?\d{6}/,fe=/\d\d?/,we=/\d\d\d\d?/,ke=/\d\d\d\d\d\d?/,Ie=/\d{1,3}/,ze=/\d{1,4}/,rt=/[+-]?\d{1,6}/,yt=/\d+/,st=/[+-]?\d+/,vt=/Z|[+-]\d\d:?\d\d/gi,di=/Z|[+-]\d\d(?::?\d\d)?/gi,fi=/[+-]?\d+(\.\d{1,3})?/,fo=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,mr=/^[1-9]\d?/,Bn=/^([1-9]\d|\d)/,vs;vs={};function ft(b,E,H){vs[b]=N(E)?E:function(q,me){return q&&H?H:E}}function ii(b,E){return o(vs,b)?vs[b](E._strict,E._locale):new RegExp(pi(b))}function pi(b){return va(b.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(E,H,q,me,Pe){return H||q||me||Pe}))}function va(b){return b.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function nn(b){return b<0?Math.ceil(b)||0:Math.floor(b)}function Oi(b){var E=+b,H=0;return E!==0&&isFinite(E)&&(H=nn(E)),H}var ec={};function Rt(b,E){var H,q=E,me;for(typeof b=="string"&&(b=[b]),c(E)&&(q=function(Pe,et){et[E]=Oi(Pe)}),me=b.length,H=0;H<me;H++)ec[b[H]]=q}function ba(b,E){Rt(b,function(H,q,me,Pe){me._w=me._w||{},E(H,me._w,me,Pe)})}function Dd(b,E,H){E!=null&&o(ec,b)&&ec[b](E,H._a,H,b)}function ks(b){return b%4===0&&b%100!==0||b%400===0}var Cr=0,on=1,po=2,Vn=3,Qo=4,Jo=5,Os=6,Uc=7,Md=8;I("Y",0,0,function(){var b=this.year();return b<=9999?te(b,4):"+"+b}),I(0,["YY",2],0,function(){return this.year()%100}),I(0,["YYYY",4],0,"year"),I(0,["YYYYY",5],0,"year"),I(0,["YYYYYY",6,!0],0,"year"),ft("Y",st),ft("YY",fe,A),ft("YYYY",ze,Y),ft("YYYYY",rt,Z),ft("YYYYYY",rt,Z),Rt(["YYYYY","YYYYYY"],Cr),Rt("YYYY",function(b,E){E[Cr]=b.length===2?e.parseTwoDigitYear(b):Oi(b)}),Rt("YY",function(b,E){E[Cr]=e.parseTwoDigitYear(b)}),Rt("Y",function(b,E){E[Cr]=parseInt(b,10)});function Gs(b){return ks(b)?366:365}e.parseTwoDigitYear=function(b){return Oi(b)+(Oi(b)>68?1900:2e3)};var qc=Yc("FullYear",!0);function Np(){return ks(this.year())}function Yc(b,E){return function(H){return H!=null?(Pp(this,b,H),e.updateOffset(this,E),this):kd(this,b)}}function kd(b,E){if(!b.isValid())return NaN;var H=b._d,q=b._isUTC;switch(E){case"Milliseconds":return q?H.getUTCMilliseconds():H.getMilliseconds();case"Seconds":return q?H.getUTCSeconds():H.getSeconds();case"Minutes":return q?H.getUTCMinutes():H.getMinutes();case"Hours":return q?H.getUTCHours():H.getHours();case"Date":return q?H.getUTCDate():H.getDate();case"Day":return q?H.getUTCDay():H.getDay();case"Month":return q?H.getUTCMonth():H.getMonth();case"FullYear":return q?H.getUTCFullYear():H.getFullYear();default:return NaN}}function Pp(b,E,H){var q,me,Pe,et,Ut;if(!(!b.isValid()||isNaN(H))){switch(q=b._d,me=b._isUTC,E){case"Milliseconds":return void(me?q.setUTCMilliseconds(H):q.setMilliseconds(H));case"Seconds":return void(me?q.setUTCSeconds(H):q.setSeconds(H));case"Minutes":return void(me?q.setUTCMinutes(H):q.setMinutes(H));case"Hours":return void(me?q.setUTCHours(H):q.setHours(H));case"Date":return void(me?q.setUTCDate(H):q.setDate(H));case"FullYear":break;default:return}Pe=H,et=b.month(),Ut=b.date(),Ut=Ut===29&&et===1&&!ks(Pe)?28:Ut,me?q.setUTCFullYear(Pe,et,Ut):q.setFullYear(Pe,et,Ut)}}function Ig(b){return b=de(b),N(this[b])?this[b]():this}function vC(b,E){if(typeof b=="object"){b=ye(b);var H=pe(b),q,me=H.length;for(q=0;q<me;q++)this[H[q].unit](b[H[q].unit])}else if(b=de(b),N(this[b]))return this[b](E);return this}function wR(b,E){return(b%E+E)%E}var Qn;Array.prototype.indexOf?Qn=Array.prototype.indexOf:Qn=function(b){var E;for(E=0;E<this.length;++E)if(this[E]===b)return E;return-1};function Vh(b,E){if(isNaN(b)||isNaN(E))return NaN;var H=wR(E,12);return b+=(E-H)/12,H===1?ks(b)?29:28:31-H%7%2}I("M",["MM",2],"Mo",function(){return this.month()+1}),I("MMM",0,0,function(b){return this.localeData().monthsShort(this,b)}),I("MMMM",0,0,function(b){return this.localeData().months(this,b)}),ft("M",fe,mr),ft("MM",fe,A),ft("MMM",function(b,E){return E.monthsShortRegex(b)}),ft("MMMM",function(b,E){return E.monthsRegex(b)}),Rt(["M","MM"],function(b,E){E[on]=Oi(b)-1}),Rt(["MMM","MMMM"],function(b,E,H,q){var me=H._locale.monthsParse(b,q,H._strict);me!=null?E[on]=me:m(H).invalidMonth=b});var bC="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),_C="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Dg=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,CR=fo,yC=fo;function xR(b,E){return b?r(this._months)?this._months[b.month()]:this._months[(this._months.isFormat||Dg).test(E)?"format":"standalone"][b.month()]:r(this._months)?this._months:this._months.standalone}function Mg(b,E){return b?r(this._monthsShort)?this._monthsShort[b.month()]:this._monthsShort[Dg.test(E)?"format":"standalone"][b.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function SR(b,E,H){var q,me,Pe,et=b.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],q=0;q<12;++q)Pe=p([2e3,q]),this._shortMonthsParse[q]=this.monthsShort(Pe,"").toLocaleLowerCase(),this._longMonthsParse[q]=this.months(Pe,"").toLocaleLowerCase();return H?E==="MMM"?(me=Qn.call(this._shortMonthsParse,et),me!==-1?me:null):(me=Qn.call(this._longMonthsParse,et),me!==-1?me:null):E==="MMM"?(me=Qn.call(this._shortMonthsParse,et),me!==-1?me:(me=Qn.call(this._longMonthsParse,et),me!==-1?me:null)):(me=Qn.call(this._longMonthsParse,et),me!==-1?me:(me=Qn.call(this._shortMonthsParse,et),me!==-1?me:null))}function Eo(b,E,H){var q,me,Pe;if(this._monthsParseExact)return SR.call(this,b,E,H);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),q=0;q<12;q++){if(me=p([2e3,q]),H&&!this._longMonthsParse[q]&&(this._longMonthsParse[q]=new RegExp("^"+this.months(me,"").replace(".","")+"$","i"),this._shortMonthsParse[q]=new RegExp("^"+this.monthsShort(me,"").replace(".","")+"$","i")),!H&&!this._monthsParse[q]&&(Pe="^"+this.months(me,"")+"|^"+this.monthsShort(me,""),this._monthsParse[q]=new RegExp(Pe.replace(".",""),"i")),H&&E==="MMMM"&&this._longMonthsParse[q].test(b))return q;if(H&&E==="MMM"&&this._shortMonthsParse[q].test(b))return q;if(!H&&this._monthsParse[q].test(b))return q}}function U0(b,E){if(!b.isValid())return b;if(typeof E=="string"){if(/^\d+$/.test(E))E=Oi(E);else if(E=b.localeData().monthsParse(E),!c(E))return b}var H=E,q=b.date();return q=q<29?q:Math.min(q,Vh(b.year(),H)),b._isUTC?b._d.setUTCMonth(H,q):b._d.setMonth(H,q),b}function q0(b){return b!=null?(U0(this,b),e.updateOffset(this,!0),this):kd(this,"Month")}function wC(){return Vh(this.year(),this.month())}function Y0(b){return this._monthsParseExact?(o(this,"_monthsRegex")||tc.call(this),b?this._monthsShortStrictRegex:this._monthsShortRegex):(o(this,"_monthsShortRegex")||(this._monthsShortRegex=CR),this._monthsShortStrictRegex&&b?this._monthsShortStrictRegex:this._monthsShortRegex)}function ER(b){return this._monthsParseExact?(o(this,"_monthsRegex")||tc.call(this),b?this._monthsStrictRegex:this._monthsRegex):(o(this,"_monthsRegex")||(this._monthsRegex=yC),this._monthsStrictRegex&&b?this._monthsStrictRegex:this._monthsRegex)}function tc(){function b(xi,gr){return gr.length-xi.length}var E=[],H=[],q=[],me,Pe,et,Ut;for(me=0;me<12;me++)Pe=p([2e3,me]),et=va(this.monthsShort(Pe,"")),Ut=va(this.months(Pe,"")),E.push(et),H.push(Ut),q.push(Ut),q.push(et);E.sort(b),H.sort(b),q.sort(b),this._monthsRegex=new RegExp("^("+q.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+H.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+E.join("|")+")","i")}function kg(b,E,H,q,me,Pe,et){var Ut;return b<100&&b>=0?(Ut=new Date(b+400,E,H,q,me,Pe,et),isFinite(Ut.getFullYear())&&Ut.setFullYear(b)):Ut=new Date(b,E,H,q,me,Pe,et),Ut}function bs(b){var E,H;return b<100&&b>=0?(H=Array.prototype.slice.call(arguments),H[0]=b+400,E=new Date(Date.UTC.apply(null,H)),isFinite(E.getUTCFullYear())&&E.setUTCFullYear(b)):E=new Date(Date.UTC.apply(null,arguments)),E}function jh(b,E,H){var q=7+E-H,me=(7+bs(b,0,q).getUTCDay()-E)%7;return-me+q-1}function $0(b,E,H,q,me){var Pe=(7+H-q)%7,et=jh(b,q,me),Ut=1+7*(E-1)+Pe+et,xi,gr;return Ut<=0?(xi=b-1,gr=Gs(xi)+Ut):Ut>Gs(b)?(xi=b+1,gr=Ut-Gs(b)):(xi=b,gr=Ut),{year:xi,dayOfYear:gr}}function Lp(b,E,H){var q=jh(b.year(),E,H),me=Math.floor((b.dayOfYear()-q-1)/7)+1,Pe,et;return me<1?(et=b.year()-1,Pe=me+ic(et,E,H)):me>ic(b.year(),E,H)?(Pe=me-ic(b.year(),E,H),et=b.year()+1):(et=b.year(),Pe=me),{week:Pe,year:et}}function ic(b,E,H){var q=jh(b,E,H),me=jh(b+1,E,H);return(Gs(b)-q+me)/7}I("w",["ww",2],"wo","week"),I("W",["WW",2],"Wo","isoWeek"),ft("w",fe,mr),ft("ww",fe,A),ft("W",fe,mr),ft("WW",fe,A),ba(["w","ww","W","WW"],function(b,E,H,q){E[q.substr(0,1)]=Oi(b)});function TR(b){return Lp(b,this._week.dow,this._week.doy).week}var CC={dow:0,doy:6};function RR(){return this._week.dow}function G0(){return this._week.doy}function AR(b){var E=this.localeData().week(this);return b==null?E:this.add((b-E)*7,"d")}function IR(b){var E=Lp(this,1,4).week;return b==null?E:this.add((b-E)*7,"d")}I("d",0,"do","day"),I("dd",0,0,function(b){return this.localeData().weekdaysMin(this,b)}),I("ddd",0,0,function(b){return this.localeData().weekdaysShort(this,b)}),I("dddd",0,0,function(b){return this.localeData().weekdays(this,b)}),I("e",0,0,"weekday"),I("E",0,0,"isoWeekday"),ft("d",fe),ft("e",fe),ft("E",fe),ft("dd",function(b,E){return E.weekdaysMinRegex(b)}),ft("ddd",function(b,E){return E.weekdaysShortRegex(b)}),ft("dddd",function(b,E){return E.weekdaysRegex(b)}),ba(["dd","ddd","dddd"],function(b,E,H,q){var me=H._locale.weekdaysParse(b,q,H._strict);me!=null?E.d=me:m(H).invalidWeekday=b}),ba(["d","e","E"],function(b,E,H,q){E[q]=Oi(b)});function DR(b,E){return typeof b!="string"?b:isNaN(b)?(b=E.weekdaysParse(b),typeof b=="number"?b:null):parseInt(b,10)}function Ou(b,E){return typeof b=="string"?E.weekdaysParse(b)%7||7:isNaN(b)?null:b}function zh(b,E){return b.slice(E,7).concat(b.slice(0,E))}var Og="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),X0="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Xs="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),MR=fo,xC=fo,Ni=fo;function kR(b,E){var H=r(this._weekdays)?this._weekdays:this._weekdays[b&&b!==!0&&this._weekdays.isFormat.test(E)?"format":"standalone"];return b===!0?zh(H,this._week.dow):b?H[b.day()]:H}function OR(b){return b===!0?zh(this._weekdaysShort,this._week.dow):b?this._weekdaysShort[b.day()]:this._weekdaysShort}function Od(b){return b===!0?zh(this._weekdaysMin,this._week.dow):b?this._weekdaysMin[b.day()]:this._weekdaysMin}function SC(b,E,H){var q,me,Pe,et=b.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],q=0;q<7;++q)Pe=p([2e3,1]).day(q),this._minWeekdaysParse[q]=this.weekdaysMin(Pe,"").toLocaleLowerCase(),this._shortWeekdaysParse[q]=this.weekdaysShort(Pe,"").toLocaleLowerCase(),this._weekdaysParse[q]=this.weekdays(Pe,"").toLocaleLowerCase();return H?E==="dddd"?(me=Qn.call(this._weekdaysParse,et),me!==-1?me:null):E==="ddd"?(me=Qn.call(this._shortWeekdaysParse,et),me!==-1?me:null):(me=Qn.call(this._minWeekdaysParse,et),me!==-1?me:null):E==="dddd"?(me=Qn.call(this._weekdaysParse,et),me!==-1||(me=Qn.call(this._shortWeekdaysParse,et),me!==-1)?me:(me=Qn.call(this._minWeekdaysParse,et),me!==-1?me:null)):E==="ddd"?(me=Qn.call(this._shortWeekdaysParse,et),me!==-1||(me=Qn.call(this._weekdaysParse,et),me!==-1)?me:(me=Qn.call(this._minWeekdaysParse,et),me!==-1?me:null)):(me=Qn.call(this._minWeekdaysParse,et),me!==-1||(me=Qn.call(this._weekdaysParse,et),me!==-1)?me:(me=Qn.call(this._shortWeekdaysParse,et),me!==-1?me:null))}function EC(b,E,H){var q,me,Pe;if(this._weekdaysParseExact)return SC.call(this,b,E,H);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),q=0;q<7;q++){if(me=p([2e3,1]).day(q),H&&!this._fullWeekdaysParse[q]&&(this._fullWeekdaysParse[q]=new RegExp("^"+this.weekdays(me,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[q]=new RegExp("^"+this.weekdaysShort(me,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[q]=new RegExp("^"+this.weekdaysMin(me,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[q]||(Pe="^"+this.weekdays(me,"")+"|^"+this.weekdaysShort(me,"")+"|^"+this.weekdaysMin(me,""),this._weekdaysParse[q]=new RegExp(Pe.replace(".",""),"i")),H&&E==="dddd"&&this._fullWeekdaysParse[q].test(b))return q;if(H&&E==="ddd"&&this._shortWeekdaysParse[q].test(b))return q;if(H&&E==="dd"&&this._minWeekdaysParse[q].test(b))return q;if(!H&&this._weekdaysParse[q].test(b))return q}}function Ng(b){if(!this.isValid())return b!=null?this:NaN;var E=kd(this,"Day");return b!=null?(b=DR(b,this.localeData()),this.add(b-E,"d")):E}function K0(b){if(!this.isValid())return b!=null?this:NaN;var E=(this.day()+7-this.localeData()._week.dow)%7;return b==null?E:this.add(b-E,"d")}function NR(b){if(!this.isValid())return b!=null?this:NaN;if(b!=null){var E=Ou(b,this.localeData());return this.day(this.day()%7?E:E-7)}else return this.day()||7}function PR(b){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Nu.call(this),b?this._weekdaysStrictRegex:this._weekdaysRegex):(o(this,"_weekdaysRegex")||(this._weekdaysRegex=MR),this._weekdaysStrictRegex&&b?this._weekdaysStrictRegex:this._weekdaysRegex)}function LR(b){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Nu.call(this),b?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(o(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=xC),this._weekdaysShortStrictRegex&&b?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Z0(b){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Nu.call(this),b?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(o(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ni),this._weekdaysMinStrictRegex&&b?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Nu(){function b(xa,Zc){return Zc.length-xa.length}var E=[],H=[],q=[],me=[],Pe,et,Ut,xi,gr;for(Pe=0;Pe<7;Pe++)et=p([2e3,1]).day(Pe),Ut=va(this.weekdaysMin(et,"")),xi=va(this.weekdaysShort(et,"")),gr=va(this.weekdays(et,"")),E.push(Ut),H.push(xi),q.push(gr),me.push(Ut),me.push(xi),me.push(gr);E.sort(b),H.sort(b),q.sort(b),me.sort(b),this._weekdaysRegex=new RegExp("^("+me.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+q.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+H.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+E.join("|")+")","i")}function Nd(){return this.hours()%12||12}function FR(){return this.hours()||24}I("H",["HH",2],0,"hour"),I("h",["hh",2],0,Nd),I("k",["kk",2],0,FR),I("hmm",0,0,function(){return""+Nd.apply(this)+te(this.minutes(),2)}),I("hmmss",0,0,function(){return""+Nd.apply(this)+te(this.minutes(),2)+te(this.seconds(),2)}),I("Hmm",0,0,function(){return""+this.hours()+te(this.minutes(),2)}),I("Hmmss",0,0,function(){return""+this.hours()+te(this.minutes(),2)+te(this.seconds(),2)});function Wh(b,E){I(b,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),E)})}Wh("a",!0),Wh("A",!1);function Pg(b,E){return E._meridiemParse}ft("a",Pg),ft("A",Pg),ft("H",fe,Bn),ft("h",fe,mr),ft("k",fe,mr),ft("HH",fe,A),ft("hh",fe,A),ft("kk",fe,A),ft("hmm",we),ft("hmmss",ke),ft("Hmm",we),ft("Hmmss",ke),Rt(["H","HH"],Vn),Rt(["k","kk"],function(b,E,H){var q=Oi(b);E[Vn]=q===24?0:q}),Rt(["a","A"],function(b,E,H){H._isPm=H._locale.isPM(b),H._meridiem=b}),Rt(["h","hh"],function(b,E,H){E[Vn]=Oi(b),m(H).bigHour=!0}),Rt("hmm",function(b,E,H){var q=b.length-2;E[Vn]=Oi(b.substr(0,q)),E[Qo]=Oi(b.substr(q)),m(H).bigHour=!0}),Rt("hmmss",function(b,E,H){var q=b.length-4,me=b.length-2;E[Vn]=Oi(b.substr(0,q)),E[Qo]=Oi(b.substr(q,2)),E[Jo]=Oi(b.substr(me)),m(H).bigHour=!0}),Rt("Hmm",function(b,E,H){var q=b.length-2;E[Vn]=Oi(b.substr(0,q)),E[Qo]=Oi(b.substr(q))}),Rt("Hmmss",function(b,E,H){var q=b.length-4,me=b.length-2;E[Vn]=Oi(b.substr(0,q)),E[Qo]=Oi(b.substr(q,2)),E[Jo]=Oi(b.substr(me))});function Lg(b){return(b+"").toLowerCase().charAt(0)==="p"}var TC=/[ap]\.?m?\.?/i,RC=Yc("Hours",!0);function AC(b,E,H){return b>11?H?"pm":"PM":H?"am":"AM"}var Q0={calendar:W,longDateFormat:Re,invalidDate:We,ordinal:Ne,dayOfMonthOrdinalParse:it,relativeTime:Ue,months:bC,monthsShort:_C,week:CC,weekdays:Og,weekdaysMin:Xs,weekdaysShort:X0,meridiemParse:TC},Er={},Dl={},Fp;function Uh(b,E){var H,q=Math.min(b.length,E.length);for(H=0;H<q;H+=1)if(b[H]!==E[H])return H;return q}function rc(b){return b&&b.toLowerCase().replace("_","-")}function J0(b){for(var E=0,H,q,me,Pe;E<b.length;){for(Pe=rc(b[E]).split("-"),H=Pe.length,q=rc(b[E+1]),q=q?q.split("-"):null;H>0;){if(me=Fg(Pe.slice(0,H).join("-")),me)return me;if(q&&q.length>=H&&Uh(Pe,q)>=H-1)break;H--}E++}return Fp}function Hp(b){return!!(b&&b.match("^[^/\\\\]*$"))}function Fg(b){var E=null,H;if(Er[b]===void 0&&typeof _x<"u"&&_x&&_x.exports&&Hp(b))try{E=Fp._abbr,H=Ze,H("./locale/"+b),Ml(E)}catch{Er[b]=null}return Er[b]}function Ml(b,E){var H;return b&&(a(E)?H=kl(b):H=e_(b,E),H?Fp=H:typeof console<"u"&&console.warn&&console.warn("Locale "+b+" not found. Did you forget to load it?")),Fp._abbr}function e_(b,E){if(E!==null){var H,q=Q0;if(E.abbr=b,Er[b]!=null)J("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),q=Er[b]._config;else if(E.parentLocale!=null)if(Er[E.parentLocale]!=null)q=Er[E.parentLocale]._config;else if(H=Fg(E.parentLocale),H!=null)q=H._config;else return Dl[E.parentLocale]||(Dl[E.parentLocale]=[]),Dl[E.parentLocale].push({name:b,config:E}),null;return Er[b]=new K($(q,E)),Dl[b]&&Dl[b].forEach(function(me){e_(me.name,me.config)}),Ml(b),Er[b]}else return delete Er[b],null}function t_(b,E){if(E!=null){var H,q,me=Q0;Er[b]!=null&&Er[b].parentLocale!=null?Er[b].set($(Er[b]._config,E)):(q=Fg(b),q!=null&&(me=q._config),E=$(me,E),q==null&&(E.abbr=b),H=new K(E),H.parentLocale=Er[b],Er[b]=H),Ml(b)}else Er[b]!=null&&(Er[b].parentLocale!=null?(Er[b]=Er[b].parentLocale,b===Ml()&&Ml(b)):Er[b]!=null&&delete Er[b]);return Er[b]}function kl(b){var E;if(b&&b._locale&&b._locale._abbr&&(b=b._locale._abbr),!b)return Fp;if(!r(b)){if(E=Fg(b),E)return E;b=[b]}return J0(b)}function IC(){return ve(Er)}function qh(b){var E,H=b._a;return H&&m(b).overflow===-2&&(E=H[on]<0||H[on]>11?on:H[po]<1||H[po]>Vh(H[Cr],H[on])?po:H[Vn]<0||H[Vn]>24||H[Vn]===24&&(H[Qo]!==0||H[Jo]!==0||H[Os]!==0)?Vn:H[Qo]<0||H[Qo]>59?Qo:H[Jo]<0||H[Jo]>59?Jo:H[Os]<0||H[Os]>999?Os:-1,m(b)._overflowDayOfYear&&(E<Cr||E>po)&&(E=po),m(b)._overflowWeeks&&E===-1&&(E=Uc),m(b)._overflowWeekday&&E===-1&&(E=Md),m(b).overflow=E),b}var i_=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,r_=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,DC=/Z|[+-]\d\d(?::?\d\d)?/,Hg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Yh=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Bp=/^\/?Date\((-?\d+)/i,n_=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,$h={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Bg(b){var E,H,q=b._i,me=i_.exec(q)||r_.exec(q),Pe,et,Ut,xi,gr=Hg.length,xa=Yh.length;if(me){for(m(b).iso=!0,E=0,H=gr;E<H;E++)if(Hg[E][1].exec(me[1])){et=Hg[E][0],Pe=Hg[E][2]!==!1;break}if(et==null){b._isValid=!1;return}if(me[3]){for(E=0,H=xa;E<H;E++)if(Yh[E][1].exec(me[3])){Ut=(me[2]||" ")+Yh[E][0];break}if(Ut==null){b._isValid=!1;return}}if(!Pe&&Ut!=null){b._isValid=!1;return}if(me[4])if(DC.exec(me[4]))xi="Z";else{b._isValid=!1;return}b._f=et+(Ut||"")+(xi||""),cr(b)}else b._isValid=!1}function R(b,E,H,q,me,Pe){var et=[re(b),_C.indexOf(E),parseInt(H,10),parseInt(q,10),parseInt(me,10)];return Pe&&et.push(parseInt(Pe,10)),et}function re(b){var E=parseInt(b,10);return E<=49?2e3+E:E<=999?1900+E:E}function De(b){return b.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Fe(b,E,H){if(b){var q=X0.indexOf(b),me=new Date(E[0],E[1],E[2]).getDay();if(q!==me)return m(H).weekdayMismatch=!0,H._isValid=!1,!1}return!0}function qe(b,E,H){if(b)return $h[b];if(E)return 0;var q=parseInt(H,10),me=q%100,Pe=(q-me)/100;return Pe*60+me}function tt(b){var E=n_.exec(De(b._i)),H;if(E){if(H=R(E[4],E[3],E[2],E[5],E[6],E[7]),!Fe(E[1],H,b))return;b._a=H,b._tzm=qe(E[8],E[9],E[10]),b._d=bs.apply(null,b._a),b._d.setUTCMinutes(b._d.getUTCMinutes()-b._tzm),m(b).rfc2822=!0}else b._isValid=!1}function pt(b){var E=Bp.exec(b._i);if(E!==null){b._d=new Date(+E[1]);return}if(Bg(b),b._isValid===!1)delete b._isValid;else return;if(tt(b),b._isValid===!1)delete b._isValid;else return;b._strict?b._isValid=!1:e.createFromInputFallback(b)}e.createFromInputFallback=O("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(b){b._d=new Date(b._i+(b._useUTC?" UTC":""))});function It(b,E,H){return b??E??H}function ui(b){var E=new Date(e.now());return b._useUTC?[E.getUTCFullYear(),E.getUTCMonth(),E.getUTCDate()]:[E.getFullYear(),E.getMonth(),E.getDate()]}function Pi(b){var E,H,q=[],me,Pe,et;if(!b._d){for(me=ui(b),b._w&&b._a[po]==null&&b._a[on]==null&&Fi(b),b._dayOfYear!=null&&(et=It(b._a[Cr],me[Cr]),(b._dayOfYear>Gs(et)||b._dayOfYear===0)&&(m(b)._overflowDayOfYear=!0),H=bs(et,0,b._dayOfYear),b._a[on]=H.getUTCMonth(),b._a[po]=H.getUTCDate()),E=0;E<3&&b._a[E]==null;++E)b._a[E]=q[E]=me[E];for(;E<7;E++)b._a[E]=q[E]=b._a[E]==null?E===2?1:0:b._a[E];b._a[Vn]===24&&b._a[Qo]===0&&b._a[Jo]===0&&b._a[Os]===0&&(b._nextDay=!0,b._a[Vn]=0),b._d=(b._useUTC?bs:kg).apply(null,q),Pe=b._useUTC?b._d.getUTCDay():b._d.getDay(),b._tzm!=null&&b._d.setUTCMinutes(b._d.getUTCMinutes()-b._tzm),b._nextDay&&(b._a[Vn]=24),b._w&&typeof b._w.d<"u"&&b._w.d!==Pe&&(m(b).weekdayMismatch=!0)}}function Fi(b){var E,H,q,me,Pe,et,Ut,xi,gr;E=b._w,E.GG!=null||E.W!=null||E.E!=null?(Pe=1,et=4,H=It(E.GG,b._a[Cr],Lp(xr(),1,4).year),q=It(E.W,1),me=It(E.E,1),(me<1||me>7)&&(xi=!0)):(Pe=b._locale._week.dow,et=b._locale._week.doy,gr=Lp(xr(),Pe,et),H=It(E.gg,b._a[Cr],gr.year),q=It(E.w,gr.week),E.d!=null?(me=E.d,(me<0||me>6)&&(xi=!0)):E.e!=null?(me=E.e+Pe,(E.e<0||E.e>6)&&(xi=!0)):me=Pe),q<1||q>ic(H,Pe,et)?m(b)._overflowWeeks=!0:xi!=null?m(b)._overflowWeekday=!0:(Ut=$0(H,q,me,Pe,et),b._a[Cr]=Ut.year,b._dayOfYear=Ut.dayOfYear)}e.ISO_8601=function(){},e.RFC_2822=function(){};function cr(b){if(b._f===e.ISO_8601){Bg(b);return}if(b._f===e.RFC_2822){tt(b);return}b._a=[],m(b).empty=!0;var E=""+b._i,H,q,me,Pe,et,Ut=E.length,xi=0,gr,xa;for(me=xe(b._f,b._locale).match(se)||[],xa=me.length,H=0;H<xa;H++)Pe=me[H],q=(E.match(ii(Pe,b))||[])[0],q&&(et=E.substr(0,E.indexOf(q)),et.length>0&&m(b).unusedInput.push(et),E=E.slice(E.indexOf(q)+q.length),xi+=q.length),S[Pe]?(q?m(b).empty=!1:m(b).unusedTokens.push(Pe),Dd(Pe,q,b)):b._strict&&!q&&m(b).unusedTokens.push(Pe);m(b).charsLeftOver=Ut-xi,E.length>0&&m(b).unusedInput.push(E),b._a[Vn]<=12&&m(b).bigHour===!0&&b._a[Vn]>0&&(m(b).bigHour=void 0),m(b).parsedDateParts=b._a.slice(0),m(b).meridiem=b._meridiem,b._a[Vn]=Jn(b._locale,b._a[Vn],b._meridiem),gr=m(b).era,gr!==null&&(b._a[Cr]=b._locale.erasConvertYear(gr,b._a[Cr])),Pi(b),qh(b)}function Jn(b,E,H){var q;return H==null?E:b.meridiemHour!=null?b.meridiemHour(E,H):(b.isPM!=null&&(q=b.isPM(H),q&&E<12&&(E+=12),!q&&E===12&&(E=0)),E)}function mo(b){var E,H,q,me,Pe,et,Ut=!1,xi=b._f.length;if(xi===0){m(b).invalidFormat=!0,b._d=new Date(NaN);return}for(me=0;me<xi;me++)Pe=0,et=!1,E=M({},b),b._useUTC!=null&&(E._useUTC=b._useUTC),E._f=b._f[me],cr(E),y(E)&&(et=!0),Pe+=m(E).charsLeftOver,Pe+=m(E).unusedTokens.length*10,m(E).score=Pe,Ut?Pe<q&&(q=Pe,H=E):(q==null||Pe<q||et)&&(q=Pe,H=E,et&&(Ut=!0));h(b,H||E)}function Fo(b){if(!b._d){var E=ye(b._i),H=E.day===void 0?E.date:E.day;b._a=u([E.year,E.month,H,E.hour,E.minute,E.second,E.millisecond],function(q){return q&&parseInt(q,10)}),Pi(b)}}function Ks(b){var E=new B(qh(es(b)));return E._nextDay&&(E.add(1,"d"),E._nextDay=void 0),E}function es(b){var E=b._i,H=b._f;return b._locale=b._locale||kl(b._l),E===null||H===void 0&&E===""?w({nullInput:!0}):(typeof E=="string"&&(b._i=E=b._locale.preparse(E)),G(E)?new B(qh(E)):(d(E)?b._d=E:r(H)?mo(b):H?cr(b):$c(b),y(b)||(b._d=null),b))}function $c(b){var E=b._i;a(E)?b._d=new Date(e.now()):d(E)?b._d=new Date(E.valueOf()):typeof E=="string"?pt(b):r(E)?(b._a=u(E.slice(0),function(H){return parseInt(H,10)}),Pi(b)):n(E)?Fo(b):c(E)?b._d=new Date(E):e.createFromInputFallback(b)}function Ga(b,E,H,q,me){var Pe={};return(E===!0||E===!1)&&(q=E,E=void 0),(H===!0||H===!1)&&(q=H,H=void 0),(n(b)&&s(b)||r(b)&&b.length===0)&&(b=void 0),Pe._isAMomentObject=!0,Pe._useUTC=Pe._isUTC=me,Pe._l=H,Pe._i=b,Pe._f=E,Pe._strict=q,Ks(Pe)}function xr(b,E,H,q){return Ga(b,E,H,q,!1)}var MC=O("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var b=xr.apply(null,arguments);return this.isValid()&&b.isValid()?b<this?this:b:w()}),o_=O("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var b=xr.apply(null,arguments);return this.isValid()&&b.isValid()?b>this?this:b:w()});function Vg(b,E){var H,q;if(E.length===1&&r(E[0])&&(E=E[0]),!E.length)return xr();for(H=E[0],q=1;q<E.length;++q)(!E[q].isValid()||E[q][b](H))&&(H=E[q]);return H}function jg(){var b=[].slice.call(arguments,0);return Vg("isBefore",b)}function s_(){var b=[].slice.call(arguments,0);return Vg("isAfter",b)}var a_=function(){return Date.now?Date.now():+new Date},Pd=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ns(b){var E,H=!1,q,me=Pd.length;for(E in b)if(o(b,E)&&!(Qn.call(Pd,E)!==-1&&(b[E]==null||!isNaN(b[E]))))return!1;for(q=0;q<me;++q)if(b[Pd[q]]){if(H)return!1;parseFloat(b[Pd[q]])!==Oi(b[Pd[q]])&&(H=!0)}return!0}function zg(){return this._isValid}function Wg(){return vo(NaN)}function Pu(b){var E=ye(b),H=E.year||0,q=E.quarter||0,me=E.month||0,Pe=E.week||E.isoWeek||0,et=E.day||0,Ut=E.hour||0,xi=E.minute||0,gr=E.second||0,xa=E.millisecond||0;this._isValid=Ns(E),this._milliseconds=+xa+gr*1e3+xi*6e4+Ut*1e3*60*60,this._days=+et+Pe*7,this._months=+me+q*3+H*12,this._data={},this._locale=kl(),this._bubble()}function Gh(b){return b instanceof Pu}function Zs(b){return b<0?Math.round(-1*b)*-1:Math.round(b)}function HR(b,E,H){var q=Math.min(b.length,E.length),me=Math.abs(b.length-E.length),Pe=0,et;for(et=0;et<q;et++)(H&&b[et]!==E[et]||!H&&Oi(b[et])!==Oi(E[et]))&&Pe++;return Pe+me}function Ug(b,E){I(b,0,0,function(){var H=this.utcOffset(),q="+";return H<0&&(H=-H,q="-"),q+te(~~(H/60),2)+E+te(~~H%60,2)})}Ug("Z",":"),Ug("ZZ",""),ft("Z",di),ft("ZZ",di),Rt(["Z","ZZ"],function(b,E,H){H._useUTC=!0,H._tzm=Xa(di,b)});var kC=/([\+\-]|\d\d)/gi;function Xa(b,E){var H=(E||"").match(b),q,me,Pe;return H===null?null:(q=H[H.length-1]||[],me=(q+"").match(kC)||["-",0,0],Pe=+(me[1]*60)+Oi(me[2]),Pe===0?0:me[0]==="+"?Pe:-Pe)}function Xh(b,E){var H,q;return E._isUTC?(H=E.clone(),q=(G(b)||d(b)?b.valueOf():xr(b).valueOf())-H.valueOf(),H._d.setTime(H._d.valueOf()+q),e.updateOffset(H,!1),H):xr(b).local()}function qg(b){return-Math.round(b._d.getTimezoneOffset())}e.updateOffset=function(){};function OC(b,E,H){var q=this._offset||0,me;if(!this.isValid())return b!=null?this:NaN;if(b!=null){if(typeof b=="string"){if(b=Xa(di,b),b===null)return this}else Math.abs(b)<16&&!H&&(b=b*60);return!this._isUTC&&E&&(me=qg(this)),this._offset=b,this._isUTC=!0,me!=null&&this.add(me,"m"),q!==b&&(!E||this._changeInProgress?Jh(this,vo(b-q,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?q:qg(this)}function Kh(b,E){return b!=null?(typeof b!="string"&&(b=-b),this.utcOffset(b,E),this):-this.utcOffset()}function Vp(b){return this.utcOffset(0,b)}function Ka(b){return this._isUTC&&(this.utcOffset(0,b),this._isUTC=!1,b&&this.subtract(qg(this),"m")),this}function _a(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var b=Xa(vt,this._i);b!=null?this.utcOffset(b):this.utcOffset(0,!0)}return this}function Zh(b){return this.isValid()?(b=b?xr(b).utcOffset():0,(this.utcOffset()-b)%60===0):!1}function Lu(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Fu(){if(!a(this._isDSTShifted))return this._isDSTShifted;var b={},E;return M(b,this),b=es(b),b._a?(E=b._isUTC?p(b._a):xr(b._a),this._isDSTShifted=this.isValid()&&HR(b._a,E.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Yg(){return this.isValid()?!this._isUTC:!1}function Hu(){return this.isValid()?this._isUTC:!1}function go(){return this.isValid()?this._isUTC&&this._offset===0:!1}var l_=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,ya=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function vo(b,E){var H=b,q=null,me,Pe,et;return Gh(b)?H={ms:b._milliseconds,d:b._days,M:b._months}:c(b)||!isNaN(+b)?(H={},E?H[E]=+b:H.milliseconds=+b):(q=l_.exec(b))?(me=q[1]==="-"?-1:1,H={y:0,d:Oi(q[po])*me,h:Oi(q[Vn])*me,m:Oi(q[Qo])*me,s:Oi(q[Jo])*me,ms:Oi(Zs(q[Os]*1e3))*me}):(q=ya.exec(b))?(me=q[1]==="-"?-1:1,H={y:nc(q[2],me),M:nc(q[3],me),w:nc(q[4],me),d:nc(q[5],me),h:nc(q[6],me),m:nc(q[7],me),s:nc(q[8],me)}):H==null?H={}:typeof H=="object"&&("from"in H||"to"in H)&&(et=d_(xr(H.from),xr(H.to)),H={},H.ms=et.milliseconds,H.M=et.months),Pe=new Pu(H),Gh(b)&&o(b,"_locale")&&(Pe._locale=b._locale),Gh(b)&&o(b,"_isValid")&&(Pe._isValid=b._isValid),Pe}vo.fn=Pu.prototype,vo.invalid=Wg;function nc(b,E){var H=b&&parseFloat(b.replace(",","."));return(isNaN(H)?0:H)*E}function c_(b,E){var H={};return H.months=E.month()-b.month()+(E.year()-b.year())*12,b.clone().add(H.months,"M").isAfter(E)&&--H.months,H.milliseconds=+E-+b.clone().add(H.months,"M"),H}function d_(b,E){var H;return b.isValid()&&E.isValid()?(E=Xh(E,b),b.isBefore(E)?H=c_(b,E):(H=c_(E,b),H.milliseconds=-H.milliseconds,H.months=-H.months),H):{milliseconds:0,months:0}}function Qh(b,E){return function(H,q){var me,Pe;return q!==null&&!isNaN(+q)&&(J(E,"moment()."+E+"(period, number) is deprecated. Please use moment()."+E+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),Pe=H,H=q,q=Pe),me=vo(H,q),Jh(this,me,b),this}}function Jh(b,E,H,q){var me=E._milliseconds,Pe=Zs(E._days),et=Zs(E._months);b.isValid()&&(q=q??!0,et&&U0(b,kd(b,"Month")+et*H),Pe&&Pp(b,"Date",kd(b,"Date")+Pe*H),me&&b._d.setTime(b._d.valueOf()+me*H),q&&e.updateOffset(b,Pe||et))}var ef=Qh(1,"add"),jp=Qh(-1,"subtract");function zp(b){return typeof b=="string"||b instanceof String}function Wp(b){return G(b)||d(b)||zp(b)||c(b)||u_(b)||tf(b)||b===null||b===void 0}function tf(b){var E=n(b)&&!s(b),H=!1,q=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],me,Pe,et=q.length;for(me=0;me<et;me+=1)Pe=q[me],H=H||o(b,Pe);return E&&H}function u_(b){var E=r(b),H=!1;return E&&(H=b.filter(function(q){return!c(q)&&zp(b)}).length===0),E&&H}function oc(b){var E=n(b)&&!s(b),H=!1,q=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],me,Pe;for(me=0;me<q.length;me+=1)Pe=q[me],H=H||o(b,Pe);return E&&H}function sc(b,E){var H=b.diff(E,"days",!0);return H<-6?"sameElse":H<-1?"lastWeek":H<0?"lastDay":H<1?"sameDay":H<2?"nextDay":H<7?"nextWeek":"sameElse"}function xn(b,E){arguments.length===1&&(arguments[0]?Wp(arguments[0])?(b=arguments[0],E=void 0):oc(arguments[0])&&(E=arguments[0],b=void 0):(b=void 0,E=void 0));var H=b||xr(),q=Xh(H,this).startOf("day"),me=e.calendarFormat(this,q)||"sameElse",Pe=E&&(N(E[me])?E[me].call(this,H):E[me]);return this.format(Pe||this.localeData().calendar(me,this,xr(H)))}function Sn(){return new B(this)}function To(b,E){var H=G(b)?b:xr(b);return this.isValid()&&H.isValid()?(E=de(E)||"millisecond",E==="millisecond"?this.valueOf()>H.valueOf():H.valueOf()<this.clone().startOf(E).valueOf()):!1}function ts(b,E){var H=G(b)?b:xr(b);return this.isValid()&&H.isValid()?(E=de(E)||"millisecond",E==="millisecond"?this.valueOf()<H.valueOf():this.clone().endOf(E).valueOf()<H.valueOf()):!1}function Bu(b,E,H,q){var me=G(b)?b:xr(b),Pe=G(E)?E:xr(E);return this.isValid()&&me.isValid()&&Pe.isValid()?(q=q||"()",(q[0]==="("?this.isAfter(me,H):!this.isBefore(me,H))&&(q[1]===")"?this.isBefore(Pe,H):!this.isAfter(Pe,H))):!1}function h_(b,E){var H=G(b)?b:xr(b),q;return this.isValid()&&H.isValid()?(E=de(E)||"millisecond",E==="millisecond"?this.valueOf()===H.valueOf():(q=H.valueOf(),this.clone().startOf(E).valueOf()<=q&&q<=this.clone().endOf(E).valueOf())):!1}function $g(b,E){return this.isSame(b,E)||this.isAfter(b,E)}function NC(b,E){return this.isSame(b,E)||this.isBefore(b,E)}function BR(b,E,H){var q,me,Pe;if(!this.isValid())return NaN;if(q=Xh(b,this),!q.isValid())return NaN;switch(me=(q.utcOffset()-this.utcOffset())*6e4,E=de(E),E){case"year":Pe=Up(this,q)/12;break;case"month":Pe=Up(this,q);break;case"quarter":Pe=Up(this,q)/3;break;case"second":Pe=(this-q)/1e3;break;case"minute":Pe=(this-q)/6e4;break;case"hour":Pe=(this-q)/36e5;break;case"day":Pe=(this-q-me)/864e5;break;case"week":Pe=(this-q-me)/6048e5;break;default:Pe=this-q}return H?Pe:nn(Pe)}function Up(b,E){if(b.date()<E.date())return-Up(E,b);var H=(E.year()-b.year())*12+(E.month()-b.month()),q=b.clone().add(H,"months"),me,Pe;return E-q<0?(me=b.clone().add(H-1,"months"),Pe=(E-q)/(q-me)):(me=b.clone().add(H+1,"months"),Pe=(E-q)/(me-q)),-(H+Pe)||0}e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Ol(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ac(b){if(!this.isValid())return null;var E=b!==!0,H=E?this.clone().utc():this;return H.year()<0||H.year()>9999?le(H,E?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):N(Date.prototype.toISOString)?E?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",le(H,"Z")):le(H,E?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function PC(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var b="moment",E="",H,q,me,Pe;return this.isLocal()||(b=this.utcOffset()===0?"moment.utc":"moment.parseZone",E="Z"),H="["+b+'("]',q=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",me="-MM-DD[T]HH:mm:ss.SSS",Pe=E+'[")]',this.format(H+q+me+Pe)}function LC(b){b||(b=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var E=le(this,b);return this.localeData().postformat(E)}function BP(b,E){return this.isValid()&&(G(b)&&b.isValid()||xr(b).isValid())?vo({to:this,from:b}).locale(this.locale()).humanize(!E):this.localeData().invalidDate()}function FC(b){return this.from(xr(),b)}function HC(b,E){return this.isValid()&&(G(b)&&b.isValid()||xr(b).isValid())?vo({from:this,to:b}).locale(this.locale()).humanize(!E):this.localeData().invalidDate()}function VR(b){return this.to(xr(),b)}function jR(b){var E;return b===void 0?this._locale._abbr:(E=kl(b),E!=null&&(this._locale=E),this)}var BC=O("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(b){return b===void 0?this.localeData():this.locale(b)});function VC(){return this._locale}var qp=1e3,rf=60*qp,jC=60*rf,VP=(365*400+97)*24*jC;function Yp(b,E){return(b%E+E)%E}function jP(b,E,H){return b<100&&b>=0?new Date(b+400,E,H)-VP:new Date(b,E,H).valueOf()}function zP(b,E,H){return b<100&&b>=0?Date.UTC(b+400,E,H)-VP:Date.UTC(b,E,H)}function Wz(b){var E,H;if(b=de(b),b===void 0||b==="millisecond"||!this.isValid())return this;switch(H=this._isUTC?zP:jP,b){case"year":E=H(this.year(),0,1);break;case"quarter":E=H(this.year(),this.month()-this.month()%3,1);break;case"month":E=H(this.year(),this.month(),1);break;case"week":E=H(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":E=H(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":E=H(this.year(),this.month(),this.date());break;case"hour":E=this._d.valueOf(),E-=Yp(E+(this._isUTC?0:this.utcOffset()*rf),jC);break;case"minute":E=this._d.valueOf(),E-=Yp(E,rf);break;case"second":E=this._d.valueOf(),E-=Yp(E,qp);break}return this._d.setTime(E),e.updateOffset(this,!0),this}function Uz(b){var E,H;if(b=de(b),b===void 0||b==="millisecond"||!this.isValid())return this;switch(H=this._isUTC?zP:jP,b){case"year":E=H(this.year()+1,0,1)-1;break;case"quarter":E=H(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":E=H(this.year(),this.month()+1,1)-1;break;case"week":E=H(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":E=H(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":E=H(this.year(),this.month(),this.date()+1)-1;break;case"hour":E=this._d.valueOf(),E+=jC-Yp(E+(this._isUTC?0:this.utcOffset()*rf),jC)-1;break;case"minute":E=this._d.valueOf(),E+=rf-Yp(E,rf)-1;break;case"second":E=this._d.valueOf(),E+=qp-Yp(E,qp)-1;break}return this._d.setTime(E),e.updateOffset(this,!0),this}function qz(){return this._d.valueOf()-(this._offset||0)*6e4}function zR(){return Math.floor(this.valueOf()/1e3)}function WR(){return new Date(this.valueOf())}function f_(){var b=this;return[b.year(),b.month(),b.date(),b.hour(),b.minute(),b.second(),b.millisecond()]}function Yz(){var b=this;return{years:b.year(),months:b.month(),date:b.date(),hours:b.hours(),minutes:b.minutes(),seconds:b.seconds(),milliseconds:b.milliseconds()}}function $z(){return this.isValid()?this.toISOString():null}function WP(){return y(this)}function Gz(){return h({},m(this))}function Xz(){return m(this).overflow}function Kz(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}I("N",0,0,"eraAbbr"),I("NN",0,0,"eraAbbr"),I("NNN",0,0,"eraAbbr"),I("NNNN",0,0,"eraName"),I("NNNNN",0,0,"eraNarrow"),I("y",["y",1],"yo","eraYear"),I("y",["yy",2],0,"eraYear"),I("y",["yyy",3],0,"eraYear"),I("y",["yyyy",4],0,"eraYear"),ft("N",zC),ft("NN",zC),ft("NNN",zC),ft("NNNN",qP),ft("NNNNN",YP),Rt(["N","NN","NNN","NNNN","NNNNN"],function(b,E,H,q){var me=H._locale.erasParse(b,q,H._strict);me?m(H).era=me:m(H).invalidEra=b}),ft("y",yt),ft("yy",yt),ft("yyy",yt),ft("yyyy",yt),ft("yo",$P),Rt(["y","yy","yyy","yyyy"],Cr),Rt(["yo"],function(b,E,H,q){var me;H._locale._eraYearOrdinalRegex&&(me=b.match(H._locale._eraYearOrdinalRegex)),H._locale.eraYearOrdinalParse?E[Cr]=H._locale.eraYearOrdinalParse(b,me):E[Cr]=parseInt(b,10)});function Zz(b,E){var H,q,me,Pe=this._eras||kl("en")._eras;for(H=0,q=Pe.length;H<q;++H){switch(typeof Pe[H].since){case"string":me=e(Pe[H].since).startOf("day"),Pe[H].since=me.valueOf();break}switch(typeof Pe[H].until){case"undefined":Pe[H].until=1/0;break;case"string":me=e(Pe[H].until).startOf("day").valueOf(),Pe[H].until=me.valueOf();break}}return Pe}function nf(b,E,H){var q,me,Pe=this.eras(),et,Ut,xi;for(b=b.toUpperCase(),q=0,me=Pe.length;q<me;++q)if(et=Pe[q].name.toUpperCase(),Ut=Pe[q].abbr.toUpperCase(),xi=Pe[q].narrow.toUpperCase(),H)switch(E){case"N":case"NN":case"NNN":if(Ut===b)return Pe[q];break;case"NNNN":if(et===b)return Pe[q];break;case"NNNNN":if(xi===b)return Pe[q];break}else if([et,Ut,xi].indexOf(b)>=0)return Pe[q]}function Gc(b,E){var H=b.since<=b.until?1:-1;return E===void 0?e(b.since).year():e(b.since).year()+(E-b.offset)*H}function Vu(){var b,E,H,q=this.localeData().eras();for(b=0,E=q.length;b<E;++b)if(H=this.clone().startOf("day").valueOf(),q[b].since<=H&&H<=q[b].until||q[b].until<=H&&H<=q[b].since)return q[b].name;return""}function Qz(){var b,E,H,q=this.localeData().eras();for(b=0,E=q.length;b<E;++b)if(H=this.clone().startOf("day").valueOf(),q[b].since<=H&&H<=q[b].until||q[b].until<=H&&H<=q[b].since)return q[b].narrow;return""}function UP(){var b,E,H,q=this.localeData().eras();for(b=0,E=q.length;b<E;++b)if(H=this.clone().startOf("day").valueOf(),q[b].since<=H&&H<=q[b].until||q[b].until<=H&&H<=q[b].since)return q[b].abbr;return""}function of(){var b,E,H,q,me=this.localeData().eras();for(b=0,E=me.length;b<E;++b)if(H=me[b].since<=me[b].until?1:-1,q=this.clone().startOf("day").valueOf(),me[b].since<=q&&q<=me[b].until||me[b].until<=q&&q<=me[b].since)return(this.year()-e(me[b].since).year())*H+me[b].offset;return this.year()}function lc(b){return o(this,"_erasNameRegex")||UR.call(this),b?this._erasNameRegex:this._erasRegex}function Jz(b){return o(this,"_erasAbbrRegex")||UR.call(this),b?this._erasAbbrRegex:this._erasRegex}function eW(b){return o(this,"_erasNarrowRegex")||UR.call(this),b?this._erasNarrowRegex:this._erasRegex}function zC(b,E){return E.erasAbbrRegex(b)}function qP(b,E){return E.erasNameRegex(b)}function YP(b,E){return E.erasNarrowRegex(b)}function $P(b,E){return E._eraYearOrdinalRegex||yt}function UR(){var b=[],E=[],H=[],q=[],me,Pe,et,Ut,xi,gr=this.eras();for(me=0,Pe=gr.length;me<Pe;++me)et=va(gr[me].name),Ut=va(gr[me].abbr),xi=va(gr[me].narrow),E.push(et),b.push(Ut),H.push(xi),q.push(et),q.push(Ut),q.push(xi);this._erasRegex=new RegExp("^("+q.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+E.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+b.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+H.join("|")+")","i")}I(0,["gg",2],0,function(){return this.weekYear()%100}),I(0,["GG",2],0,function(){return this.isoWeekYear()%100});function $p(b,E){I(0,[b,b.length],0,E)}$p("gggg","weekYear"),$p("ggggg","weekYear"),$p("GGGG","isoWeekYear"),$p("GGGGG","isoWeekYear"),ft("G",st),ft("g",st),ft("GG",fe,A),ft("gg",fe,A),ft("GGGG",ze,Y),ft("gggg",ze,Y),ft("GGGGG",rt,Z),ft("ggggg",rt,Z),ba(["gggg","ggggg","GGGG","GGGGG"],function(b,E,H,q){E[q.substr(0,2)]=Oi(b)}),ba(["gg","GG"],function(b,E,H,q){E[q]=e.parseTwoDigitYear(b)});function WC(b){return KP.call(this,b,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function p_(b){return KP.call(this,b,this.isoWeek(),this.isoWeekday(),1,4)}function qR(){return ic(this.year(),1,4)}function GP(){return ic(this.isoWeekYear(),1,4)}function tW(){var b=this.localeData()._week;return ic(this.year(),b.dow,b.doy)}function XP(){var b=this.localeData()._week;return ic(this.weekYear(),b.dow,b.doy)}function KP(b,E,H,q,me){var Pe;return b==null?Lp(this,q,me).year:(Pe=ic(b,q,me),E>Pe&&(E=Pe),iW.call(this,b,E,H,q,me))}function iW(b,E,H,q,me){var Pe=$0(b,E,H,q,me),et=bs(Pe.year,0,Pe.dayOfYear);return this.year(et.getUTCFullYear()),this.month(et.getUTCMonth()),this.date(et.getUTCDate()),this}I("Q",0,"Qo","quarter"),ft("Q",ue),Rt("Q",function(b,E){E[on]=(Oi(b)-1)*3});function rW(b){return b==null?Math.ceil((this.month()+1)/3):this.month((b-1)*3+this.month()%3)}I("D",["DD",2],"Do","date"),ft("D",fe,mr),ft("DD",fe,A),ft("Do",function(b,E){return b?E._dayOfMonthOrdinalParse||E._ordinalParse:E._dayOfMonthOrdinalParseLenient}),Rt(["D","DD"],po),Rt("Do",function(b,E){E[po]=Oi(b.match(fe)[0])});var ZP=Yc("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear"),ft("DDD",Ie),ft("DDDD",L),Rt(["DDD","DDDD"],function(b,E,H){H._dayOfYear=Oi(b)});function nW(b){var E=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return b==null?E:this.add(b-E,"d")}I("m",["mm",2],0,"minute"),ft("m",fe,Bn),ft("mm",fe,A),Rt(["m","mm"],Qo);var oW=Yc("Minutes",!1);I("s",["ss",2],0,"second"),ft("s",fe,Bn),ft("ss",fe,A),Rt(["s","ss"],Jo);var QP=Yc("Seconds",!1);I("S",0,0,function(){return~~(this.millisecond()/100)}),I(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),I(0,["SSS",3],0,"millisecond"),I(0,["SSSS",4],0,function(){return this.millisecond()*10}),I(0,["SSSSS",5],0,function(){return this.millisecond()*100}),I(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),I(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),I(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),I(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),ft("S",Ie,ue),ft("SS",Ie,A),ft("SSS",Ie,L);var Xc,JP;for(Xc="SSSS";Xc.length<=9;Xc+="S")ft(Xc,yt);function sW(b,E){E[Os]=Oi(("0."+b)*1e3)}for(Xc="S";Xc.length<=9;Xc+="S")Rt(Xc,sW);JP=Yc("Milliseconds",!1),I("z",0,0,"zoneAbbr"),I("zz",0,0,"zoneName");function eL(){return this._isUTC?"UTC":""}function v(){return this._isUTC?"Coordinated Universal Time":""}var C=B.prototype;C.add=ef,C.calendar=xn,C.clone=Sn,C.diff=BR,C.endOf=Uz,C.format=LC,C.from=BP,C.fromNow=FC,C.to=HC,C.toNow=VR,C.get=Ig,C.invalidAt=Xz,C.isAfter=To,C.isBefore=ts,C.isBetween=Bu,C.isSame=h_,C.isSameOrAfter=$g,C.isSameOrBefore=NC,C.isValid=WP,C.lang=BC,C.locale=jR,C.localeData=VC,C.max=o_,C.min=MC,C.parsingFlags=Gz,C.set=vC,C.startOf=Wz,C.subtract=jp,C.toArray=f_,C.toObject=Yz,C.toDate=WR,C.toISOString=ac,C.inspect=PC,typeof Symbol<"u"&&Symbol.for!=null&&(C[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),C.toJSON=$z,C.toString=Ol,C.unix=zR,C.valueOf=qz,C.creationData=Kz,C.eraName=Vu,C.eraNarrow=Qz,C.eraAbbr=UP,C.eraYear=of,C.year=qc,C.isLeapYear=Np,C.weekYear=WC,C.isoWeekYear=p_,C.quarter=C.quarters=rW,C.month=q0,C.daysInMonth=wC,C.week=C.weeks=AR,C.isoWeek=C.isoWeeks=IR,C.weeksInYear=tW,C.weeksInWeekYear=XP,C.isoWeeksInYear=qR,C.isoWeeksInISOWeekYear=GP,C.date=ZP,C.day=C.days=Ng,C.weekday=K0,C.isoWeekday=NR,C.dayOfYear=nW,C.hour=C.hours=RC,C.minute=C.minutes=oW,C.second=C.seconds=QP,C.millisecond=C.milliseconds=JP,C.utcOffset=OC,C.utc=Vp,C.local=Ka,C.parseZone=_a,C.hasAlignedHourOffset=Zh,C.isDST=Lu,C.isLocal=Yg,C.isUtcOffset=Hu,C.isUtc=go,C.isUTC=go,C.zoneAbbr=eL,C.zoneName=v,C.dates=O("dates accessor is deprecated. Use date instead.",ZP),C.months=O("months accessor is deprecated. Use month instead",q0),C.years=O("years accessor is deprecated. Use year instead",qc),C.zone=O("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Kh),C.isDSTShifted=O("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Fu);function D(b){return xr(b*1e3)}function j(){return xr.apply(null,arguments).parseZone()}function ie(b){return b}var oe=K.prototype;oe.calendar=ee,oe.longDateFormat=Oe,oe.invalidDate=Le,oe.ordinal=ct,oe.preparse=ie,oe.postformat=ie,oe.relativeTime=Se,oe.pastFuture=gt,oe.set=P,oe.eras=Zz,oe.erasParse=nf,oe.erasConvertYear=Gc,oe.erasAbbrRegex=Jz,oe.erasNameRegex=lc,oe.erasNarrowRegex=eW,oe.months=xR,oe.monthsShort=Mg,oe.monthsParse=Eo,oe.monthsRegex=ER,oe.monthsShortRegex=Y0,oe.week=TR,oe.firstDayOfYear=G0,oe.firstDayOfWeek=RR,oe.weekdays=kR,oe.weekdaysMin=Od,oe.weekdaysShort=OR,oe.weekdaysParse=EC,oe.weekdaysRegex=PR,oe.weekdaysShortRegex=LR,oe.weekdaysMinRegex=Z0,oe.isPM=Lg,oe.meridiem=AC;function he(b,E,H,q){var me=kl(),Pe=p().set(q,E);return me[H](Pe,b)}function ge(b,E,H){if(c(b)&&(E=b,b=void 0),b=b||"",E!=null)return he(b,E,H,"month");var q,me=[];for(q=0;q<12;q++)me[q]=he(b,q,H,"month");return me}function be(b,E,H,q){typeof b=="boolean"?(c(E)&&(H=E,E=void 0),E=E||""):(E=b,H=E,b=!1,c(E)&&(H=E,E=void 0),E=E||"");var me=kl(),Pe=b?me._week.dow:0,et,Ut=[];if(H!=null)return he(E,(H+Pe)%7,q,"day");for(et=0;et<7;et++)Ut[et]=he(E,(et+Pe)%7,q,"day");return Ut}function Ee(b,E){return ge(b,E,"months")}function He(b,E){return ge(b,E,"monthsShort")}function Ge(b,E,H){return be(b,E,H,"weekdays")}function Xe(b,E,H){return be(b,E,H,"weekdaysShort")}function je(b,E,H){return be(b,E,H,"weekdaysMin")}Ml("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(b){var E=b%10,H=Oi(b%100/10)===1?"th":E===1?"st":E===2?"nd":E===3?"rd":"th";return b+H}}),e.lang=O("moment.lang is deprecated. Use moment.locale instead.",Ml),e.langData=O("moment.langData is deprecated. Use moment.localeData instead.",kl);var nt=Math.abs;function Je(){var b=this._data;return this._milliseconds=nt(this._milliseconds),this._days=nt(this._days),this._months=nt(this._months),b.milliseconds=nt(b.milliseconds),b.seconds=nt(b.seconds),b.minutes=nt(b.minutes),b.hours=nt(b.hours),b.months=nt(b.months),b.years=nt(b.years),this}function Be(b,E,H,q){var me=vo(E,H);return b._milliseconds+=q*me._milliseconds,b._days+=q*me._days,b._months+=q*me._months,b._bubble()}function Ve(b,E){return Be(this,b,E,1)}function ot(b,E){return Be(this,b,E,-1)}function ut(b){return b<0?Math.floor(b):Math.ceil(b)}function at(){var b=this._milliseconds,E=this._days,H=this._months,q=this._data,me,Pe,et,Ut,xi;return b>=0&&E>=0&&H>=0||b<=0&&E<=0&&H<=0||(b+=ut(Et(H)+E)*864e5,E=0,H=0),q.milliseconds=b%1e3,me=nn(b/1e3),q.seconds=me%60,Pe=nn(me/60),q.minutes=Pe%60,et=nn(Pe/60),q.hours=et%24,E+=nn(et/24),xi=nn(Wt(E)),H+=xi,E-=ut(Et(xi)),Ut=nn(H/12),H%=12,q.days=E,q.months=H,q.years=Ut,this}function Wt(b){return b*4800/146097}function Et(b){return b*146097/4800}function vi(b){if(!this.isValid())return NaN;var E,H,q=this._milliseconds;if(b=de(b),b==="month"||b==="quarter"||b==="year")switch(E=this._days+q/864e5,H=this._months+Wt(E),b){case"month":return H;case"quarter":return H/3;case"year":return H/12}else switch(E=this._days+Math.round(Et(this._months)),b){case"week":return E/7+q/6048e5;case"day":return E+q/864e5;case"hour":return E*24+q/36e5;case"minute":return E*1440+q/6e4;case"second":return E*86400+q/1e3;case"millisecond":return Math.floor(E*864e5)+q;default:throw new Error("Unknown unit "+b)}}function xt(b){return function(){return this.as(b)}}var Dr=xt("ms"),qr=xt("s"),Tr=xt("m"),dr=xt("h"),_n=xt("d"),sn=xt("w"),Ui=xt("M"),Ho=xt("Q"),Za=xt("y"),Bo=Dr;function Qa(){return vo(this)}function Yr(b){return b=de(b),this.isValid()?this[b+"s"]():NaN}function is(b){return function(){return this.isValid()?this._data[b]:NaN}}var Nl=is("milliseconds"),_s=is("seconds"),Ps=is("minutes"),wa=is("hours"),cc=is("days"),Ld=is("months"),ys=is("years");function ju(){return nn(this.days()/7)}var Ca=Math.round,Kc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function sf(b,E,H,q,me){return me.relativeTime(E||1,!!H,b,q)}function bo(b,E,H,q){var me=vo(b).abs(),Pe=Ca(me.as("s")),et=Ca(me.as("m")),Ut=Ca(me.as("h")),xi=Ca(me.as("d")),gr=Ca(me.as("M")),xa=Ca(me.as("w")),Zc=Ca(me.as("y")),Sa=Pe<=H.ss&&["s",Pe]||Pe<H.s&&["ss",Pe]||et<=1&&["m"]||et<H.m&&["mm",et]||Ut<=1&&["h"]||Ut<H.h&&["hh",Ut]||xi<=1&&["d"]||xi<H.d&&["dd",xi];return H.w!=null&&(Sa=Sa||xa<=1&&["w"]||xa<H.w&&["ww",xa]),Sa=Sa||gr<=1&&["M"]||gr<H.M&&["MM",gr]||Zc<=1&&["y"]||["yy",Zc],Sa[2]=E,Sa[3]=+b>0,Sa[4]=q,sf.apply(null,Sa)}function YR(b){return b===void 0?Ca:typeof b=="function"?(Ca=b,!0):!1}function tL(b,E){return Kc[b]===void 0?!1:E===void 0?Kc[b]:(Kc[b]=E,b==="s"&&(Kc.ss=E-1),!0)}function iL(b,E){if(!this.isValid())return this.localeData().invalidDate();var H=!1,q=Kc,me,Pe;return typeof b=="object"&&(E=b,b=!1),typeof b=="boolean"&&(H=b),typeof E=="object"&&(q=Object.assign({},Kc,E),E.s!=null&&E.ss==null&&(q.ss=E.s-1)),me=this.localeData(),Pe=bo(this,!H,q,me),H&&(Pe=me.pastFuture(+this,Pe)),me.postformat(Pe)}var Gg=Math.abs;function Fd(b){return(b>0)-(b<0)||+b}function Gp(){if(!this.isValid())return this.localeData().invalidDate();var b=Gg(this._milliseconds)/1e3,E=Gg(this._days),H=Gg(this._months),q,me,Pe,et,Ut=this.asSeconds(),xi,gr,xa,Zc;return Ut?(q=nn(b/60),me=nn(q/60),b%=60,q%=60,Pe=nn(H/12),H%=12,et=b?b.toFixed(3).replace(/\.?0+$/,""):"",xi=Ut<0?"-":"",gr=Fd(this._months)!==Fd(Ut)?"-":"",xa=Fd(this._days)!==Fd(Ut)?"-":"",Zc=Fd(this._milliseconds)!==Fd(Ut)?"-":"",xi+"P"+(Pe?gr+Pe+"Y":"")+(H?gr+H+"M":"")+(E?xa+E+"D":"")+(me||q||b?"T":"")+(me?Zc+me+"H":"")+(q?Zc+q+"M":"")+(b?Zc+et+"S":"")):"P0D"}var Hi=Pu.prototype;Hi.isValid=zg,Hi.abs=Je,Hi.add=Ve,Hi.subtract=ot,Hi.as=vi,Hi.asMilliseconds=Dr,Hi.asSeconds=qr,Hi.asMinutes=Tr,Hi.asHours=dr,Hi.asDays=_n,Hi.asWeeks=sn,Hi.asMonths=Ui,Hi.asQuarters=Ho,Hi.asYears=Za,Hi.valueOf=Bo,Hi._bubble=at,Hi.clone=Qa,Hi.get=Yr,Hi.milliseconds=Nl,Hi.seconds=_s,Hi.minutes=Ps,Hi.hours=wa,Hi.days=cc,Hi.weeks=ju,Hi.months=Ld,Hi.years=ys,Hi.humanize=iL,Hi.toISOString=Gp,Hi.toString=Gp,Hi.toJSON=Gp,Hi.locale=jR,Hi.localeData=VC,Hi.toIsoString=O("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Gp),Hi.lang=BC,I("X",0,0,"unix"),I("x",0,0,"valueOf"),ft("x",st),ft("X",fi),Rt("X",function(b,E,H){H._d=new Date(parseFloat(b)*1e3)}),Rt("x",function(b,E,H){H._d=new Date(Oi(b))});return e.version="2.30.1",i(xr),e.fn=C,e.min=jg,e.max=s_,e.now=a_,e.utc=p,e.unix=D,e.months=Ee,e.isDate=d,e.locale=Ml,e.invalid=w,e.duration=vo,e.isMoment=G,e.weekdays=Ge,e.parseZone=j,e.localeData=kl,e.isDuration=Gh,e.monthsShort=He,e.weekdaysMin=je,e.defineLocale=e_,e.updateLocale=t_,e.locales=IC,e.weekdaysShort=Xe,e.normalizeUnits=de,e.relativeTimeRounding=YR,e.relativeTimeThreshold=tL,e.calendarFormat=sc,e.prototype=C,e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},e})});var rve=z((rai,ive)=>{"use strict";var pnt=Bde().f;ive.exports=function(t,e,i){i in t||pnt(t,i,{configurable:!0,get:function(){return e[i]},set:function(r){e[i]=r}})}});var sve=z((nai,ove)=>{"use strict";var mnt=aA(),gnt=Fde(),nve=jde();ove.exports=function(t,e,i){var r,n;return nve&&mnt(r=e.constructor)&&r!==i&&gnt(n=r.prototype)&&n!==i.prototype&&nve(t,n),t}});var lve=z((oai,ave)=>{"use strict";var vnt=MW();ave.exports=function(t,e){return t===void 0?arguments.length<2?"":e:vnt(t)}});var dve=z((sai,cve)=>{"use strict";var bnt=Fde(),_nt=AW();cve.exports=function(t,e){bnt(e)&&"cause"in e&&_nt(t,"cause",e.cause)}});var pve=z((aai,fve)=>{"use strict";var ynt=tx(),uve=Error,wnt=ynt("".replace),Cnt=function(t){return String(new uve(t).stack)}("zxcasd"),hve=/\n\s*at [^:]*:[^\n]*/,xnt=hve.test(Cnt);fve.exports=function(t,e){if(xnt&&typeof t=="string"&&!uve.prepareStackTrace)for(;e--;)t=wnt(t,hve,"");return t}});var gve=z((lai,mve)=>{"use strict";var Snt=yL(),Ent=Lde();mve.exports=!Snt(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",Ent(1,7)),t.stack!==7):!0})});var _ve=z((cai,bve)=>{"use strict";var Tnt=AW(),Rnt=pve(),Ant=gve(),vve=Error.captureStackTrace;bve.exports=function(t,e,i,r){Ant&&(vve?vve(t,e):Tnt(t,"stack",Rnt(i,r)))}});var Rve=z((dai,Tve)=>{"use strict";var yve=TW(),Int=gYe(),wve=AW(),Dnt=cYe(),Cve=jde(),xve=_Ye(),Sve=rve(),Mnt=sve(),knt=lve(),Ont=dve(),Nnt=_ve(),Pnt=EW(),Eve=Hde();Tve.exports=function(t,e,i,r){var n="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],c=yve.apply(null,s);if(c){var d=c.prototype;if(!Eve&&Int(d,"cause")&&delete d.cause,!i)return c;var u=yve("Error"),h=e(function(p,f){var m=knt(r?f:p,void 0),g=r?new c(p):new c;return m!==void 0&&wve(g,"message",m),Nnt(g,h,g.stack,2),this&&Dnt(d,this)&&Mnt(g,this,h),arguments.length>o&&Ont(g,arguments[o]),g});if(h.prototype=d,a!=="Error"?Cve?Cve(h,u):xve(h,u,{name:!0}):Pnt&&n in c&&(Sve(h,c,n),Sve(h,c,"prepareStackTrace")),xve(h,c),!Eve)try{d.name!==a&&wve(d,"name",a),d.constructor=h}catch{}return h}}});var $e=z(()=>{"use strict";var Ive=rl(),Lnt=_L(),Sf=DW(),Dve=Rve(),l7="WebAssembly",Ave=Lnt[l7],i5=new Error("e",{cause:7}).cause!==7,z_=function(t,e){var i={};i[t]=Dve(t,e,i5),Ive({global:!0,constructor:!0,arity:1,forced:i5},i)},c7=function(t,e){if(Ave&&Ave[t]){var i={};i[t]=Dve(l7+"."+t,e,i5),Ive({target:l7,stat:!0,constructor:!0,arity:1,forced:i5},i)}};z_("Error",function(t){return function(i){return Sf(t,this,arguments)}});z_("EvalError",function(t){return function(i){return Sf(t,this,arguments)}});z_("RangeError",function(t){return function(i){return Sf(t,this,arguments)}});z_("ReferenceError",function(t){return function(i){return Sf(t,this,arguments)}});z_("SyntaxError",function(t){return function(i){return Sf(t,this,arguments)}});z_("TypeError",function(t){return function(i){return Sf(t,this,arguments)}});z_("URIError",function(t){return function(i){return Sf(t,this,arguments)}});c7("CompileError",function(t){return function(i){return Sf(t,this,arguments)}});c7("LinkError",function(t){return function(i){return Sf(t,this,arguments)}});c7("RuntimeError",function(t){return function(i){return Sf(t,this,arguments)}})});var d7=z((fai,Mve)=>{"use strict";var Fnt=EW(),Hnt=zde(),Bnt=TypeError,Vnt=Object.getOwnPropertyDescriptor,jnt=Fnt&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();Mve.exports=jnt?function(t,e){if(Hnt(t)&&!Vnt(t,"length").writable)throw new Bnt("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}});var u7=z((pai,kve)=>{"use strict";var znt=TypeError,Wnt=9007199254740991;kve.exports=function(t){if(t>Wnt)throw znt("Maximum allowed index exceeded");return t}});var dt=z(()=>{"use strict";var Unt=rl(),qnt=RW(),Ynt=IW(),$nt=d7(),Gnt=u7(),Xnt=yL(),Knt=Xnt(function(){return[].push.call({length:4294967296},1)!==4294967297}),Znt=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Qnt=Knt||!Znt();Unt({target:"Array",proto:!0,arity:1,forced:Qnt},{push:function(e){var i=qnt(this),r=Ynt(i),n=arguments.length;Gnt(r+n);for(var o=0;o<n;o++)i[r]=arguments[o],r++;return $nt(i,r),r}})});var Xu=z((vai,Ove)=>{"use strict";var h7=tx(),r5=Set.prototype;Ove.exports={Set,add:h7(r5.add),has:h7(r5.has),remove:h7(r5.delete),proto:r5}});var kv=z((bai,Nve)=>{"use strict";var Jnt=Xu().has;Nve.exports=function(t){return Jnt(t),t}});var Ov=z((_ai,Pve)=>{"use strict";var eot=wL();Pve.exports=function(t,e,i){for(var r=i?t:t.iterator,n=t.next,o,s;!(o=eot(n,r)).done;)if(s=e(o.value),s!==void 0)return s}});var Xx=z((yai,Vve)=>{"use strict";var Lve=tx(),tot=Ov(),Fve=Xu(),iot=Fve.Set,Hve=Fve.proto,rot=Lve(Hve.forEach),Bve=Lve(Hve.keys),not=Bve(new iot).next;Vve.exports=function(t,e,i){return i?tot({iterator:Bve(t),next:not},e):rot(t,e)}});var n5=z((wai,zve)=>{"use strict";var jve=Xu(),oot=Xx(),sot=jve.Set,aot=jve.add;zve.exports=function(t){var e=new sot;return oot(t,function(i){aot(e,i)}),e}});var Kx=z((Cai,Wve)=>{"use strict";var lot=yYe(),cot=Xu();Wve.exports=lot(cot.proto,"size","get")||function(t){return t.size}});var qve=z((xai,Uve)=>{"use strict";Uve.exports=function(t){return{iterator:t,next:t.next,done:!1}}});var Nv=z((Sai,Zve)=>{"use strict";var Yve=pYe(),Xve=bYe(),$ve=wL(),dot=Vde(),uot=qve(),Gve="Invalid size",hot=RangeError,fot=TypeError,pot=Math.max,Kve=function(t,e){this.set=t,this.size=pot(e,0),this.has=Yve(t.has),this.keys=Yve(t.keys)};Kve.prototype={getIterator:function(){return uot(Xve($ve(this.keys,this.set)))},includes:function(t){return $ve(this.has,this.set,t)}};Zve.exports=function(t){Xve(t);var e=+t.size;if(e!==e)throw new fot(Gve);var i=dot(e);if(i<0)throw new hot(Gve);return new Kve(t,i)}});var tbe=z((Eai,ebe)=>{"use strict";var mot=kv(),Jve=Xu(),got=n5(),vot=Kx(),bot=Nv(),_ot=Xx(),yot=Ov(),wot=Jve.has,Qve=Jve.remove;ebe.exports=function(e){var i=mot(this),r=bot(e),n=got(i);return vot(i)<=r.size?_ot(i,function(o){r.includes(o)&&Qve(n,o)}):yot(r.getIterator(),function(o){wot(i,o)&&Qve(n,o)}),n}});var Pv=z((Tai,rbe)=>{"use strict";var Cot=TW(),ibe=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};rbe.exports=function(t){var e=Cot("Set");try{new e()[t](ibe(0));try{return new e()[t](ibe(-1)),!1}catch{return!0}}catch{return!1}}});var nbe=z(()=>{"use strict";var xot=rl(),Sot=tbe(),Eot=Pv();xot({target:"Set",proto:!0,real:!0,forced:!Eot("difference")},{difference:Sot})});var ln=z(()=>{"use strict";nbe()});var abe=z((Mai,sbe)=>{"use strict";var Tot=kv(),f7=Xu(),Rot=Kx(),Aot=Nv(),Iot=Xx(),Dot=Ov(),Mot=f7.Set,obe=f7.add,kot=f7.has;sbe.exports=function(e){var i=Tot(this),r=Aot(e),n=new Mot;return Rot(i)>r.size?Dot(r.getIterator(),function(o){kot(i,o)&&obe(n,o)}):Iot(i,function(o){r.includes(o)&&obe(n,o)}),n}});var lbe=z(()=>{"use strict";var Oot=rl(),Not=yL(),Pot=abe(),Lot=Pv(),Fot=!Lot("intersection")||Not(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});Oot({target:"Set",proto:!0,real:!0,forced:Fot},{intersection:Pot})});var cn=z(()=>{"use strict";lbe()});var dbe=z((Lai,cbe)=>{"use strict";var Hot=kv(),Bot=Xu().has,Vot=Kx(),jot=Nv(),zot=Xx(),Wot=Ov(),Uot=Wde();cbe.exports=function(e){var i=Hot(this),r=jot(e);if(Vot(i)<=r.size)return zot(i,function(o){if(r.includes(o))return!1},!0)!==!1;var n=r.getIterator();return Wot(n,function(o){if(Bot(i,o))return Uot(n,"normal",!1)})!==!1}});var ube=z(()=>{"use strict";var qot=rl(),Yot=dbe(),$ot=Pv();qot({target:"Set",proto:!0,real:!0,forced:!$ot("isDisjointFrom")},{isDisjointFrom:Yot})});var dn=z(()=>{"use strict";ube()});var fbe=z((jai,hbe)=>{"use strict";var Got=kv(),Xot=Kx(),Kot=Xx(),Zot=Nv();hbe.exports=function(e){var i=Got(this),r=Zot(e);return Xot(i)>r.size?!1:Kot(i,function(n){if(!r.includes(n))return!1},!0)!==!1}});var pbe=z(()=>{"use strict";var Qot=rl(),Jot=fbe(),est=Pv();Qot({target:"Set",proto:!0,real:!0,forced:!est("isSubsetOf")},{isSubsetOf:Jot})});var un=z(()=>{"use strict";pbe()});var gbe=z((Yai,mbe)=>{"use strict";var tst=kv(),ist=Xu().has,rst=Kx(),nst=Nv(),ost=Ov(),sst=Wde();mbe.exports=function(e){var i=tst(this),r=nst(e);if(rst(i)<r.size)return!1;var n=r.getIterator();return ost(n,function(o){if(!ist(i,o))return sst(n,"normal",!1)})!==!1}});var vbe=z(()=>{"use strict";var ast=rl(),lst=gbe(),cst=Pv();ast({target:"Set",proto:!0,real:!0,forced:!cst("isSupersetOf")},{isSupersetOf:lst})});var hn=z(()=>{"use strict";vbe()});var _be=z((Zai,bbe)=>{"use strict";var dst=kv(),p7=Xu(),ust=n5(),hst=Nv(),fst=Ov(),pst=p7.add,mst=p7.has,gst=p7.remove;bbe.exports=function(e){var i=dst(this),r=hst(e).getIterator(),n=ust(i);return fst(r,function(o){mst(i,o)?gst(n,o):pst(n,o)}),n}});var ybe=z(()=>{"use strict";var vst=rl(),bst=_be(),_st=Pv();vst({target:"Set",proto:!0,real:!0,forced:!_st("symmetricDifference")},{symmetricDifference:bst})});var fn=z(()=>{"use strict";ybe()});var Cbe=z((ili,wbe)=>{"use strict";var yst=kv(),wst=Xu().add,Cst=n5(),xst=Nv(),Sst=Ov();wbe.exports=function(e){var i=yst(this),r=xst(e).getIterator(),n=Cst(i);return Sst(r,function(o){wst(n,o)}),n}});var xbe=z(()=>{"use strict";var Est=rl(),Tst=Cbe(),Rst=Pv();Est({target:"Set",proto:!0,real:!0,forced:!Rst("union")},{union:Tst})});var pn=z(()=>{"use strict";xbe()});var Ebe=z(()=>{"use strict";var Ast=rl(),Ist=_L(),Sbe=qde().clear;Ast({global:!0,bind:!0,enumerable:!0,forced:Ist.clearImmediate!==Sbe},{clearImmediate:Sbe})});var Rbe=z((cli,Tbe)=>{"use strict";Tbe.exports=typeof Bun=="function"&&Bun&&typeof Bun.version=="string"});var Dbe=z((dli,Ibe)=>{"use strict";var Abe=_L(),Dst=DW(),Mst=aA(),kst=Rbe(),Ost=dYe(),Nst=Ude(),Pst=wYe(),Lst=Abe.Function,Fst=/MSIE .\./.test(Ost)||kst&&function(){var t=Abe.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}();Ibe.exports=function(t,e){var i=e?2:1;return Fst?function(r,n){var o=Pst(arguments.length,1)>i,s=Mst(r)?r:Lst(r),a=o?Nst(arguments,i):[],c=o?function(){Dst(s,this,a)}:s;return e?t(c,n):t(c)}:t}});var Nbe=z(()=>{"use strict";var Hst=rl(),Obe=_L(),Mbe=qde().set,Bst=Dbe(),kbe=Obe.setImmediate?Bst(Mbe,!1):Mbe;Hst({global:!0,bind:!0,enumerable:!0,forced:Obe.setImmediate!==kbe},{setImmediate:kbe})});var Pbe=z(()=>{"use strict";Ebe();Nbe()});var I0e=z((Bli,A0e)=>{"use strict";var Yst=tx(),E0e=zde(),$st=aA(),T0e=sYe(),Gst=MW(),R0e=Yst([].push);A0e.exports=function(t){if($st(t))return t;if(E0e(t)){for(var e=t.length,i=[],r=0;r<e;r++){var n=t[r];typeof n=="string"?R0e(i,n):(typeof n=="number"||T0e(n)==="Number"||T0e(n)==="String")&&R0e(i,Gst(n))}var o=i.length,s=!0;return function(a,c){if(s)return s=!1,c;if(E0e(this))return c;for(var d=0;d<o;d++)if(i[d]===a)return c}}}});var C5=z(()=>{"use strict";var Xst=rl(),F0e=TW(),H0e=DW(),Kst=wL(),bI=tx(),B0e=yL(),D0e=aA(),M0e=hYe(),V0e=Ude(),Zst=I0e(),Qst=uYe(),Jst=String,Vv=F0e("JSON","stringify"),w5=bI(/./.exec),k0e=bI("".charAt),eat=bI("".charCodeAt),tat=bI("".replace),iat=bI(1 .toString),rat=/[\uD800-\uDFFF]/g,O0e=/^[\uD800-\uDBFF]$/,N0e=/^[\uDC00-\uDFFF]$/,P0e=!Qst||B0e(function(){var t=F0e("Symbol")("stringify detection");return Vv([t])!=="[null]"||Vv({a:t})!=="{}"||Vv(Object(t))!=="{}"}),L0e=B0e(function(){return Vv("\uDF06\uD834")!=='"\\udf06\\ud834"'||Vv("\uDEAD")!=='"\\udead"'}),nat=function(t,e){var i=V0e(arguments),r=Zst(e);if(!(!D0e(r)&&(t===void 0||M0e(t))))return i[1]=function(n,o){if(D0e(r)&&(o=Kst(r,this,Jst(n),o)),!M0e(o))return o},H0e(Vv,null,i)},oat=function(t,e,i){var r=k0e(i,e-1),n=k0e(i,e+1);return w5(O0e,t)&&!w5(N0e,n)||w5(N0e,t)&&!w5(O0e,r)?"\\u"+iat(eat(t,0),16):t};Vv&&Xst({target:"JSON",stat:!0,arity:3,forced:P0e||L0e},{stringify:function(e,i,r){var n=V0e(arguments),o=H0e(P0e?nat:Vv,null,n);return L0e&&typeof o=="string"?tat(o,rat,oat):o}})});var M7=z(()=>{"use strict";var cat=kW();cat("flatMap")});var n_e=z(()=>{"use strict";var Mat=rl(),kat=wL(),W7=tx(),i_e=lYe(),Oat=aA(),Nat=aYe(),Pat=CYe(),g1=MW(),Lat=mYe(),Fat=xYe(),Hat=SYe(),Bat=vYe(),Vat=Hde(),jat=Bat("replace"),zat=TypeError,z7=W7("".indexOf),Wat=W7("".replace),r_e=W7("".slice),Uat=Math.max;Mat({target:"String",proto:!0},{replaceAll:function(e,i){var r=i_e(this),n,o,s,a,c,d,u,h,p,f=0,m=0,g="";if(!Nat(e)){if(n=Pat(e),n&&(o=g1(i_e(Fat(e))),!~z7(o,"g")))throw new zat("`.replaceAll` does not allow non-global regexes");if(s=Lat(e,jat),s)return kat(s,e,r,i);if(Vat&&n)return Wat(g1(r),e,i)}for(a=g1(r),c=g1(e),d=Oat(i),d||(i=g1(i)),u=c.length,h=Uat(1,u),f=z7(a,c);f!==-1;)p=d?g1(i(c,f,a)):Hat(c,a,f,[],void 0,i),g+=r_e(a,m,f)+p,m=f+u,f=f+h>a.length?-1:z7(a,c,f+h);return m<a.length&&(g+=r_e(a,m)),g}})});var Q7=z(()=>{"use strict";var dlt=rl(),ult=RW(),hlt=IW(),flt=Vde(),plt=kW();dlt({target:"Array",proto:!0},{at:function(e){var i=ult(this),r=hlt(i),n=flt(e),o=n>=0?n:r+n;return o<0||o>=r?void 0:i[o]}});plt("at")});var m9=z(()=>{"use strict";var Nct=kW();Nct("flat")});var zCe=z((jCe,FY)=>{"use strict";(function(t){typeof jCe=="object"&&typeof FY<"u"?FY.exports=t():typeof define=="function"&&define.amd?define([],t):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).numbro=t()})(function(){return function t(e,i,r){function n(a,c){if(!i[a]){if(!e[a]){var d=typeof Ze=="function"&&Ze;if(!c&&d)return d(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(p){return n(e[a][1][p]||p)},h,h.exports,t,e,i,r)}return i[a].exports}for(var o=typeof Ze=="function"&&Ze,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e,i){(function(r){"use strict";var n,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,a=Math.floor,c="[BigNumber Error] ",d=c+"Number primitive has more than 15 significant digits: ",u=1e14,h=14,p=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,g=1e9;function y(F){var O=0|F;return 0<F||F===O?O:O-1}function w(F){for(var O,V,J=1,N=F.length,P=F[0]+"";J<N;){for(O=F[J++]+"",V=h-O.length;V--;O="0"+O);P+=O}for(N=P.length;P.charCodeAt(--N)===48;);return P.slice(0,N+1||1)}function x(F,O){var V,J,N=F.c,P=O.c,$=F.s,K=O.s,ve=F.e,W=O.e;if(!$||!K)return null;if(V=N&&!N[0],J=P&&!P[0],V||J)return V?J?0:-K:$;if($!=K)return $;if(V=$<0,J=ve==W,!N||!P)return J?0:!N^V?1:-1;if(!J)return W<ve^V?1:-1;for(K=(ve=N.length)<(W=P.length)?ve:W,$=0;$<K;$++)if(N[$]!=P[$])return N[$]>P[$]^V?1:-1;return ve==W?0:W<ve^V?1:-1}function T(F,O,V,J){if(F<O||V<F||F!==(F<0?s(F):a(F)))throw Error(c+(J||"Argument")+(typeof F=="number"?F<O||V<F?" out of range: ":" not an integer: ":" not a primitive number: ")+String(F))}function M(F){var O=F.c.length-1;return y(F.e/h)==O&&F.c[O]%2!=0}function B(F,O){return(1<F.length?F.charAt(0)+"."+F.slice(1):F)+(O<0?"e":"e+")+O}function G(F,O,V){var J,N;if(O<0){for(N=V+".";++O;N+=V);F=N+F}else if(++O>(J=F.length)){for(N=V,O-=J;--O;N+=V);F+=N}else O<J&&(F=F.slice(0,O)+"."+F.slice(O));return F}(n=function F(O){var V,J,N,P,$,K,ve,W,ee,te,se=Ne.prototype={constructor:Ne,toString:null,valueOf:null},Ae=new Ne(1),k=20,S=4,I=-7,X=21,Q=-1e7,le=1e7,xe=!1,Re=1,Oe=0,We={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Le="0123456789abcdefghijklmnopqrstuvwxyz";function Ne(ce,de){var ye,Me,pe,ue,A,L,Y,Z,fe=this;if(!(fe instanceof Ne))return new Ne(ce,de);if(de==null){if(ce instanceof Ne)return fe.s=ce.s,fe.e=ce.e,void(fe.c=(ce=ce.c)?ce.slice():ce);if((L=typeof ce=="number")&&0*ce==0){if(fe.s=1/ce<0?(ce=-ce,-1):1,ce===~~ce){for(ue=0,A=ce;10<=A;A/=10,ue++);return fe.e=ue,void(fe.c=[ce])}Z=String(ce)}else{if(Z=String(ce),!o.test(Z))return N(fe,Z,L);fe.s=Z.charCodeAt(0)==45?(Z=Z.slice(1),-1):1}-1<(ue=Z.indexOf("."))&&(Z=Z.replace(".","")),0<(A=Z.search(/e/i))?(ue<0&&(ue=A),ue+=+Z.slice(A+1),Z=Z.substring(0,A)):ue<0&&(ue=Z.length)}else{if(T(de,2,Le.length,"Base"),Z=String(ce),de==10)return Se(fe=new Ne(ce instanceof Ne?ce:Z),k+fe.e+1,S);if(L=typeof ce=="number"){if(0*ce!=0)return N(fe,Z,L,de);if(fe.s=1/ce<0?(Z=Z.slice(1),-1):1,Ne.DEBUG&&15<Z.replace(/^0\.0*|\./,"").length)throw Error(d+ce);L=!1}else fe.s=Z.charCodeAt(0)===45?(Z=Z.slice(1),-1):1;for(ye=Le.slice(0,de),ue=A=0,Y=Z.length;A<Y;A++)if(ye.indexOf(Me=Z.charAt(A))<0){if(Me=="."){if(ue<A){ue=Y;continue}}else if(!pe&&(Z==Z.toUpperCase()&&(Z=Z.toLowerCase())||Z==Z.toLowerCase()&&(Z=Z.toUpperCase()))){pe=!0,A=-1,ue=0;continue}return N(fe,String(ce),L,de)}-1<(ue=(Z=J(Z,de,10,fe.s)).indexOf("."))?Z=Z.replace(".",""):ue=Z.length}for(A=0;Z.charCodeAt(A)===48;A++);for(Y=Z.length;Z.charCodeAt(--Y)===48;);if(Z=Z.slice(A,++Y)){if(Y-=A,L&&Ne.DEBUG&&15<Y&&(p<ce||ce!==a(ce)))throw Error(d+fe.s*ce);if(le<(ue=ue-A-1))fe.c=fe.e=null;else if(ue<Q)fe.c=[fe.e=0];else{if(fe.e=ue,fe.c=[],A=(ue+1)%h,ue<0&&(A+=h),A<Y){for(A&&fe.c.push(+Z.slice(0,A)),Y-=h;A<Y;)fe.c.push(+Z.slice(A,A+=h));Z=Z.slice(A),A=h-Z.length}else A-=Y;for(;A--;Z+="0");fe.c.push(+Z)}}else fe.c=[fe.e=0]}function it(ce,de,ye,Me){var pe,ue,A,L,Y;if(ye==null?ye=S:T(ye,0,8),!ce.c)return ce.toString();if(pe=ce.c[0],A=ce.e,de==null)Y=w(ce.c),Y=Me==1||Me==2&&(A<=I||X<=A)?B(Y,A):G(Y,A,"0");else if(ue=(ce=Se(new Ne(ce),de,ye)).e,L=(Y=w(ce.c)).length,Me==1||Me==2&&(de<=ue||ue<=I)){for(;L<de;Y+="0",L++);Y=B(Y,ue)}else if(de-=A,Y=G(Y,ue,"0"),L<ue+1){if(0<--de)for(Y+=".";de--;Y+="0");}else if(0<(de+=ue-L))for(ue+1==L&&(Y+=".");de--;Y+="0");return ce.s<0&&pe?"-"+Y:Y}function ct(ce,de){for(var ye,Me=1,pe=new Ne(ce[0]);Me<ce.length;Me++){if(!(ye=new Ne(ce[Me])).s){pe=ye;break}de.call(pe,ye)&&(pe=ye)}return pe}function Ue(ce,de,ye){for(var Me=1,pe=de.length;!de[--pe];de.pop());for(pe=de[0];10<=pe;pe/=10,Me++);return(ye=Me+ye*h-1)>le?ce.c=ce.e=null:ce.c=ye<Q?[ce.e=0]:(ce.e=ye,de),ce}function Se(ce,de,ye,Me){var pe,ue,A,L,Y,Z,fe,we=ce.c,ke=f;if(we){e:{for(pe=1,L=we[0];10<=L;L/=10,pe++);if((ue=de-pe)<0)ue+=h,A=de,fe=(Y=we[Z=0])/ke[pe-A-1]%10|0;else if((Z=s((ue+1)/h))>=we.length){if(!Me)break e;for(;we.length<=Z;we.push(0));Y=fe=0,A=(ue%=h)-h+(pe=1)}else{for(Y=L=we[Z],pe=1;10<=L;L/=10,pe++);fe=(A=(ue%=h)-h+pe)<0?0:Y/ke[pe-A-1]%10|0}if(Me=Me||de<0||we[Z+1]!=null||(A<0?Y:Y%ke[pe-A-1]),Me=ye<4?(fe||Me)&&(ye==0||ye==(ce.s<0?3:2)):5<fe||fe==5&&(ye==4||Me||ye==6&&(0<ue?0<A?Y/ke[pe-A]:0:we[Z-1])%10&1||ye==(ce.s<0?8:7)),de<1||!we[0])return we.length=0,Me?(de-=ce.e+1,we[0]=ke[(h-de%h)%h],ce.e=-de||0):we[0]=ce.e=0,ce;if(ue==0?(we.length=Z,L=1,Z--):(we.length=Z+1,L=ke[h-ue],we[Z]=0<A?a(Y/ke[pe-A]%ke[A])*L:0),Me)for(;;){if(Z==0){for(ue=1,A=we[0];10<=A;A/=10,ue++);for(A=we[0]+=L,L=1;10<=A;A/=10,L++);ue!=L&&(ce.e++,we[0]==u&&(we[0]=1));break}if(we[Z]+=L,we[Z]!=u)break;we[Z--]=0,L=1}for(ue=we.length;we[--ue]===0;we.pop());}ce.e>le?ce.c=ce.e=null:ce.e<Q&&(ce.c=[ce.e=0])}return ce}function gt(ce){var de,ye=ce.e;return ye===null?ce.toString():(de=w(ce.c),de=ye<=I||X<=ye?B(de,ye):G(de,ye,"0"),ce.s<0?"-"+de:de)}return Ne.clone=F,Ne.ROUND_UP=0,Ne.ROUND_DOWN=1,Ne.ROUND_CEIL=2,Ne.ROUND_FLOOR=3,Ne.ROUND_HALF_UP=4,Ne.ROUND_HALF_DOWN=5,Ne.ROUND_HALF_EVEN=6,Ne.ROUND_HALF_CEIL=7,Ne.ROUND_HALF_FLOOR=8,Ne.EUCLID=9,Ne.config=Ne.set=function(ce){var de,ye;if(ce!=null){if(typeof ce!="object")throw Error(c+"Object expected: "+ce);if(ce.hasOwnProperty(de="DECIMAL_PLACES")&&(T(ye=ce[de],0,g,de),k=ye),ce.hasOwnProperty(de="ROUNDING_MODE")&&(T(ye=ce[de],0,8,de),S=ye),ce.hasOwnProperty(de="EXPONENTIAL_AT")&&((ye=ce[de])&&ye.pop?(T(ye[0],-g,0,de),T(ye[1],0,g,de),I=ye[0],X=ye[1]):(T(ye,-g,g,de),I=-(X=ye<0?-ye:ye))),ce.hasOwnProperty(de="RANGE"))if((ye=ce[de])&&ye.pop)T(ye[0],-g,-1,de),T(ye[1],1,g,de),Q=ye[0],le=ye[1];else{if(T(ye,-g,g,de),!ye)throw Error(c+de+" cannot be zero: "+ye);Q=-(le=ye<0?-ye:ye)}if(ce.hasOwnProperty(de="CRYPTO")){if((ye=ce[de])!==!!ye)throw Error(c+de+" not true or false: "+ye);if(ye){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw xe=!ye,Error(c+"crypto unavailable");xe=ye}else xe=ye}if(ce.hasOwnProperty(de="MODULO_MODE")&&(T(ye=ce[de],0,9,de),Re=ye),ce.hasOwnProperty(de="POW_PRECISION")&&(T(ye=ce[de],0,g,de),Oe=ye),ce.hasOwnProperty(de="FORMAT")){if(typeof(ye=ce[de])!="object")throw Error(c+de+" not an object: "+ye);We=ye}if(ce.hasOwnProperty(de="ALPHABET")){if(typeof(ye=ce[de])!="string"||/^.$|[+-.\s]|(.).*\1/.test(ye))throw Error(c+de+" invalid: "+ye);Le=ye}}return{DECIMAL_PLACES:k,ROUNDING_MODE:S,EXPONENTIAL_AT:[I,X],RANGE:[Q,le],CRYPTO:xe,MODULO_MODE:Re,POW_PRECISION:Oe,FORMAT:We,ALPHABET:Le}},Ne.isBigNumber=function(ce){return ce instanceof Ne||ce&&ce._isBigNumber===!0||!1},Ne.maximum=Ne.max=function(){return ct(arguments,se.lt)},Ne.minimum=Ne.min=function(){return ct(arguments,se.gt)},Ne.random=(P=9007199254740992,$=Math.random()*P&2097151?function(){return a(Math.random()*P)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(ce){var de,ye,Me,pe,ue,A=0,L=[],Y=new Ne(Ae);if(ce==null?ce=k:T(ce,0,g),pe=s(ce/h),xe)if(crypto.getRandomValues){for(de=crypto.getRandomValues(new Uint32Array(pe*=2));A<pe;)9e15<=(ue=131072*de[A]+(de[A+1]>>>11))?(ye=crypto.getRandomValues(new Uint32Array(2)),de[A]=ye[0],de[A+1]=ye[1]):(L.push(ue%1e14),A+=2);A=pe/2}else{if(!crypto.randomBytes)throw xe=!1,Error(c+"crypto unavailable");for(de=crypto.randomBytes(pe*=7);A<pe;)9e15<=(ue=281474976710656*(31&de[A])+1099511627776*de[A+1]+4294967296*de[A+2]+16777216*de[A+3]+(de[A+4]<<16)+(de[A+5]<<8)+de[A+6])?crypto.randomBytes(7).copy(de,A):(L.push(ue%1e14),A+=7);A=pe/7}if(!xe)for(;A<pe;)(ue=$())<9e15&&(L[A++]=ue%1e14);for(pe=L[--A],ce%=h,pe&&ce&&(ue=f[h-ce],L[A]=a(pe/ue)*ue);L[A]===0;L.pop(),A--);if(A<0)L=[Me=0];else{for(Me=-1;L[0]===0;L.splice(0,1),Me-=h);for(A=1,ue=L[0];10<=ue;ue/=10,A++);A<h&&(Me-=h-A)}return Y.e=Me,Y.c=L,Y}),Ne.sum=function(){for(var ce=1,de=arguments,ye=new Ne(de[0]);ce<de.length;)ye=ye.plus(de[ce++]);return ye},J=function(){var ce="0123456789";function de(ye,Me,pe,ue){for(var A,L,Y=[0],Z=0,fe=ye.length;Z<fe;){for(L=Y.length;L--;Y[L]*=Me);for(Y[0]+=ue.indexOf(ye.charAt(Z++)),A=0;A<Y.length;A++)Y[A]>pe-1&&(Y[A+1]==null&&(Y[A+1]=0),Y[A+1]+=Y[A]/pe|0,Y[A]%=pe)}return Y.reverse()}return function(ye,Me,pe,ue,A){var L,Y,Z,fe,we,ke,Ie,ze,rt=ye.indexOf("."),yt=k,st=S;for(0<=rt&&(fe=Oe,Oe=0,ye=ye.replace(".",""),ke=(ze=new Ne(Me)).pow(ye.length-rt),Oe=fe,ze.c=de(G(w(ke.c),ke.e,"0"),10,pe,ce),ze.e=ze.c.length),Z=fe=(Ie=de(ye,Me,pe,A?(L=Le,ce):(L=ce,Le))).length;Ie[--fe]==0;Ie.pop());if(!Ie[0])return L.charAt(0);if(rt<0?--Z:(ke.c=Ie,ke.e=Z,ke.s=ue,Ie=(ke=V(ke,ze,yt,st,pe)).c,we=ke.r,Z=ke.e),rt=Ie[Y=Z+yt+1],fe=pe/2,we=we||Y<0||Ie[Y+1]!=null,we=st<4?(rt!=null||we)&&(st==0||st==(ke.s<0?3:2)):fe<rt||rt==fe&&(st==4||we||st==6&&1&Ie[Y-1]||st==(ke.s<0?8:7)),Y<1||!Ie[0])ye=we?G(L.charAt(1),-yt,L.charAt(0)):L.charAt(0);else{if(Ie.length=Y,we)for(--pe;++Ie[--Y]>pe;)Ie[Y]=0,Y||(++Z,Ie=[1].concat(Ie));for(fe=Ie.length;!Ie[--fe];);for(rt=0,ye="";rt<=fe;ye+=L.charAt(Ie[rt++]));ye=G(ye,Z,L.charAt(0))}return ye}}(),V=function(){function ce(Me,pe,ue){var A,L,Y,Z,fe=0,we=Me.length,ke=pe%m,Ie=pe/m|0;for(Me=Me.slice();we--;)fe=((L=ke*(Y=Me[we]%m)+(A=Ie*Y+(Z=Me[we]/m|0)*ke)%m*m+fe)/ue|0)+(A/m|0)+Ie*Z,Me[we]=L%ue;return fe&&(Me=[fe].concat(Me)),Me}function de(Me,pe,ue,A){var L,Y;if(ue!=A)Y=A<ue?1:-1;else for(L=Y=0;L<ue;L++)if(Me[L]!=pe[L]){Y=Me[L]>pe[L]?1:-1;break}return Y}function ye(Me,pe,ue,A){for(var L=0;ue--;)Me[ue]-=L,L=Me[ue]<pe[ue]?1:0,Me[ue]=L*A+Me[ue]-pe[ue];for(;!Me[0]&&1<Me.length;Me.splice(0,1));}return function(Me,pe,ue,A,L){var Y,Z,fe,we,ke,Ie,ze,rt,yt,st,vt,di,fi,fo,mr,Bn,vs,ft=Me.s==pe.s?1:-1,ii=Me.c,pi=pe.c;if(!(ii&&ii[0]&&pi&&pi[0]))return new Ne(Me.s&&pe.s&&(ii?!pi||ii[0]!=pi[0]:pi)?ii&&ii[0]==0||!pi?0*ft:ft/0:NaN);for(yt=(rt=new Ne(ft)).c=[],ft=ue+(Z=Me.e-pe.e)+1,L||(L=u,Z=y(Me.e/h)-y(pe.e/h),ft=ft/h|0),fe=0;pi[fe]==(ii[fe]||0);fe++);if(pi[fe]>(ii[fe]||0)&&Z--,ft<0)yt.push(1),we=!0;else{for(fo=ii.length,Bn=pi.length,ft+=2,1<(ke=a(L/(pi[fe=0]+1)))&&(pi=ce(pi,ke,L),ii=ce(ii,ke,L),Bn=pi.length,fo=ii.length),fi=Bn,vt=(st=ii.slice(0,Bn)).length;vt<Bn;st[vt++]=0);vs=pi.slice(),vs=[0].concat(vs),mr=pi[0],pi[1]>=L/2&&mr++;do{if(ke=0,(Y=de(pi,st,Bn,vt))<0){if(di=st[0],Bn!=vt&&(di=di*L+(st[1]||0)),1<(ke=a(di/mr)))for(L<=ke&&(ke=L-1),ze=(Ie=ce(pi,ke,L)).length,vt=st.length;de(Ie,st,ze,vt)==1;)ke--,ye(Ie,Bn<ze?vs:pi,ze,L),ze=Ie.length,Y=1;else ke==0&&(Y=ke=1),ze=(Ie=pi.slice()).length;if(ze<vt&&(Ie=[0].concat(Ie)),ye(st,Ie,vt,L),vt=st.length,Y==-1)for(;de(pi,st,Bn,vt)<1;)ke++,ye(st,Bn<vt?vs:pi,vt,L),vt=st.length}else Y===0&&(ke++,st=[0]);yt[fe++]=ke,st[0]?st[vt++]=ii[fi]||0:(st=[ii[fi]],vt=1)}while((fi++<fo||st[0]!=null)&&ft--);we=st[0]!=null,yt[0]||yt.splice(0,1)}if(L==u){for(fe=1,ft=yt[0];10<=ft;ft/=10,fe++);Se(rt,ue+(rt.e=fe+Z*h-1)+1,A,we)}else rt.e=Z,rt.r=+we;return rt}}(),K=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ve=/^([^.]+)\.$/,W=/^\.([^.]+)$/,ee=/^-?(Infinity|NaN)$/,te=/^\s*\+(?=[\w.])|^\s+|\s+$/g,N=function(ce,de,ye,Me){var pe,ue=ye?de:de.replace(te,"");if(ee.test(ue))ce.s=isNaN(ue)?null:ue<0?-1:1,ce.c=ce.e=null;else{if(!ye&&(ue=ue.replace(K,function(A,L,Y){return pe=(Y=Y.toLowerCase())=="x"?16:Y=="b"?2:8,Me&&Me!=pe?A:L}),Me&&(pe=Me,ue=ue.replace(ve,"$1").replace(W,"0.$1")),de!=ue))return new Ne(ue,pe);if(Ne.DEBUG)throw Error(c+"Not a"+(Me?" base "+Me:"")+" number: "+de);ce.c=ce.e=ce.s=null}},se.absoluteValue=se.abs=function(){var ce=new Ne(this);return ce.s<0&&(ce.s=1),ce},se.comparedTo=function(ce,de){return x(this,new Ne(ce,de))},se.decimalPlaces=se.dp=function(ce,de){var ye,Me,pe;if(ce!=null)return T(ce,0,g),de==null?de=S:T(de,0,8),Se(new Ne(this),ce+this.e+1,de);if(!(ye=this.c))return null;if(Me=((pe=ye.length-1)-y(this.e/h))*h,pe=ye[pe])for(;pe%10==0;pe/=10,Me--);return Me<0&&(Me=0),Me},se.dividedBy=se.div=function(ce,de){return V(this,new Ne(ce,de),k,S)},se.dividedToIntegerBy=se.idiv=function(ce,de){return V(this,new Ne(ce,de),0,1)},se.exponentiatedBy=se.pow=function(ce,de){var ye,Me,pe,ue,A,L,Y,Z,fe=this;if((ce=new Ne(ce)).c&&!ce.isInteger())throw Error(c+"Exponent not an integer: "+gt(ce));if(de!=null&&(de=new Ne(de)),A=14<ce.e,!fe.c||!fe.c[0]||fe.c[0]==1&&!fe.e&&fe.c.length==1||!ce.c||!ce.c[0])return Z=new Ne(Math.pow(+gt(fe),A?2-M(ce):+gt(ce))),de?Z.mod(de):Z;if(L=ce.s<0,de){if(de.c?!de.c[0]:!de.s)return new Ne(NaN);(Me=!L&&fe.isInteger()&&de.isInteger())&&(fe=fe.mod(de))}else{if(9<ce.e&&(0<fe.e||fe.e<-1||(fe.e==0?1<fe.c[0]||A&&24e7<=fe.c[1]:fe.c[0]<8e13||A&&fe.c[0]<=9999975e7)))return ue=fe.s<0&&M(ce)?-0:0,-1<fe.e&&(ue=1/ue),new Ne(L?1/ue:ue);Oe&&(ue=s(Oe/h+2))}for(Y=A?(ye=new Ne(.5),L&&(ce.s=1),M(ce)):(pe=Math.abs(+gt(ce)))%2,Z=new Ne(Ae);;){if(Y){if(!(Z=Z.times(fe)).c)break;ue?Z.c.length>ue&&(Z.c.length=ue):Me&&(Z=Z.mod(de))}if(pe){if((pe=a(pe/2))===0)break;Y=pe%2}else if(Se(ce=ce.times(ye),ce.e+1,1),14<ce.e)Y=M(ce);else{if((pe=+gt(ce))==0)break;Y=pe%2}fe=fe.times(fe),ue?fe.c&&fe.c.length>ue&&(fe.c.length=ue):Me&&(fe=fe.mod(de))}return Me?Z:(L&&(Z=Ae.div(Z)),de?Z.mod(de):ue?Se(Z,Oe,S,void 0):Z)},se.integerValue=function(ce){var de=new Ne(this);return ce==null?ce=S:T(ce,0,8),Se(de,de.e+1,ce)},se.isEqualTo=se.eq=function(ce,de){return x(this,new Ne(ce,de))===0},se.isFinite=function(){return!!this.c},se.isGreaterThan=se.gt=function(ce,de){return 0<x(this,new Ne(ce,de))},se.isGreaterThanOrEqualTo=se.gte=function(ce,de){return(de=x(this,new Ne(ce,de)))===1||de===0},se.isInteger=function(){return!!this.c&&y(this.e/h)>this.c.length-2},se.isLessThan=se.lt=function(ce,de){return x(this,new Ne(ce,de))<0},se.isLessThanOrEqualTo=se.lte=function(ce,de){return(de=x(this,new Ne(ce,de)))===-1||de===0},se.isNaN=function(){return!this.s},se.isNegative=function(){return this.s<0},se.isPositive=function(){return 0<this.s},se.isZero=function(){return!!this.c&&this.c[0]==0},se.minus=function(ce,de){var ye,Me,pe,ue,A=this,L=A.s;if(de=(ce=new Ne(ce,de)).s,!L||!de)return new Ne(NaN);if(L!=de)return ce.s=-de,A.plus(ce);var Y=A.e/h,Z=ce.e/h,fe=A.c,we=ce.c;if(!Y||!Z){if(!fe||!we)return fe?(ce.s=-de,ce):new Ne(we?A:NaN);if(!fe[0]||!we[0])return we[0]?(ce.s=-de,ce):new Ne(fe[0]?A:S==3?-0:0)}if(Y=y(Y),Z=y(Z),fe=fe.slice(),L=Y-Z){for((pe=(ue=L<0)?(L=-L,fe):(Z=Y,we)).reverse(),de=L;de--;pe.push(0));pe.reverse()}else for(Me=(ue=(L=fe.length)<(de=we.length))?L:de,L=de=0;de<Me;de++)if(fe[de]!=we[de]){ue=fe[de]<we[de];break}if(ue&&(pe=fe,fe=we,we=pe,ce.s=-ce.s),0<(de=(Me=we.length)-(ye=fe.length)))for(;de--;fe[ye++]=0);for(de=u-1;L<Me;){if(fe[--Me]<we[Me]){for(ye=Me;ye&&!fe[--ye];fe[ye]=de);--fe[ye],fe[Me]+=u}fe[Me]-=we[Me]}for(;fe[0]==0;fe.splice(0,1),--Z);return fe[0]?Ue(ce,fe,Z):(ce.s=S==3?-1:1,ce.c=[ce.e=0],ce)},se.modulo=se.mod=function(ce,de){var ye,Me,pe=this;return ce=new Ne(ce,de),!pe.c||!ce.s||ce.c&&!ce.c[0]?new Ne(NaN):!ce.c||pe.c&&!pe.c[0]?new Ne(pe):(Re==9?(Me=ce.s,ce.s=1,ye=V(pe,ce,0,3),ce.s=Me,ye.s*=Me):ye=V(pe,ce,0,Re),(ce=pe.minus(ye.times(ce))).c[0]||Re!=1||(ce.s=pe.s),ce)},se.multipliedBy=se.times=function(ce,de){var ye,Me,pe,ue,A,L,Y,Z,fe,we,ke,Ie,ze,rt,yt,st=this,vt=st.c,di=(ce=new Ne(ce,de)).c;if(!(vt&&di&&vt[0]&&di[0]))return!st.s||!ce.s||vt&&!vt[0]&&!di||di&&!di[0]&&!vt?ce.c=ce.e=ce.s=null:(ce.s*=st.s,vt&&di?(ce.c=[0],ce.e=0):ce.c=ce.e=null),ce;for(Me=y(st.e/h)+y(ce.e/h),ce.s*=st.s,(Y=vt.length)<(we=di.length)&&(ze=vt,vt=di,di=ze,pe=Y,Y=we,we=pe),pe=Y+we,ze=[];pe--;ze.push(0));for(rt=u,yt=m,pe=we;0<=--pe;){for(ye=0,ke=di[pe]%yt,Ie=di[pe]/yt|0,ue=pe+(A=Y);pe<ue;)ye=((Z=ke*(Z=vt[--A]%yt)+(L=Ie*Z+(fe=vt[A]/yt|0)*ke)%yt*yt+ze[ue]+ye)/rt|0)+(L/yt|0)+Ie*fe,ze[ue--]=Z%rt;ze[ue]=ye}return ye?++Me:ze.splice(0,1),Ue(ce,ze,Me)},se.negated=function(){var ce=new Ne(this);return ce.s=-ce.s||null,ce},se.plus=function(ce,de){var ye,Me=this,pe=Me.s;if(de=(ce=new Ne(ce,de)).s,!pe||!de)return new Ne(NaN);if(pe!=de)return ce.s=-de,Me.minus(ce);var ue=Me.e/h,A=ce.e/h,L=Me.c,Y=ce.c;if(!ue||!A){if(!L||!Y)return new Ne(pe/0);if(!L[0]||!Y[0])return Y[0]?ce:new Ne(L[0]?Me:0*pe)}if(ue=y(ue),A=y(A),L=L.slice(),pe=ue-A){for((ye=0<pe?(A=ue,Y):(pe=-pe,L)).reverse();pe--;ye.push(0));ye.reverse()}for((pe=L.length)-(de=Y.length)<0&&(ye=Y,Y=L,L=ye,de=pe),pe=0;de;)pe=(L[--de]=L[de]+Y[de]+pe)/u|0,L[de]=u===L[de]?0:L[de]%u;return pe&&(L=[pe].concat(L),++A),Ue(ce,L,A)},se.precision=se.sd=function(ce,de){var ye,Me,pe;if(ce!=null&&ce!==!!ce)return T(ce,1,g),de==null?de=S:T(de,0,8),Se(new Ne(this),ce,de);if(!(ye=this.c))return null;if(Me=(pe=ye.length-1)*h+1,pe=ye[pe]){for(;pe%10==0;pe/=10,Me--);for(pe=ye[0];10<=pe;pe/=10,Me++);}return ce&&this.e+1>Me&&(Me=this.e+1),Me},se.shiftedBy=function(ce){return T(ce,-p,p),this.times("1e"+ce)},se.squareRoot=se.sqrt=function(){var ce,de,ye,Me,pe,ue=this,A=ue.c,L=ue.s,Y=ue.e,Z=k+4,fe=new Ne("0.5");if(L!==1||!A||!A[0])return new Ne(!L||L<0&&(!A||A[0])?NaN:A?ue:1/0);if((ye=(L=Math.sqrt(+gt(ue)))==0||L==1/0?(((de=w(A)).length+Y)%2==0&&(de+="0"),L=Math.sqrt(+de),Y=y((Y+1)/2)-(Y<0||Y%2),new Ne(de=L==1/0?"1e"+Y:(de=L.toExponential()).slice(0,de.indexOf("e")+1)+Y)):new Ne(L+"")).c[0]){for((L=(Y=ye.e)+Z)<3&&(L=0);;)if(pe=ye,ye=fe.times(pe.plus(V(ue,pe,Z,1))),w(pe.c).slice(0,L)===(de=w(ye.c)).slice(0,L)){if(ye.e<Y&&--L,(de=de.slice(L-3,L+1))!="9999"&&(Me||de!="4999")){+de&&(+de.slice(1)||de.charAt(0)!="5")||(Se(ye,ye.e+k+2,1),ce=!ye.times(ye).eq(ue));break}if(!Me&&(Se(pe,pe.e+k+2,0),pe.times(pe).eq(ue))){ye=pe;break}Z+=4,L+=4,Me=1}}return Se(ye,ye.e+k+1,S,ce)},se.toExponential=function(ce,de){return ce!=null&&(T(ce,0,g),ce++),it(this,ce,de,1)},se.toFixed=function(ce,de){return ce!=null&&(T(ce,0,g),ce=ce+this.e+1),it(this,ce,de)},se.toFormat=function(ce,de,ye){var Me;if(ye==null)ce!=null&&de&&typeof de=="object"?(ye=de,de=null):ce&&typeof ce=="object"?(ye=ce,ce=de=null):ye=We;else if(typeof ye!="object")throw Error(c+"Argument not an object: "+ye);if(Me=this.toFixed(ce,de),this.c){var pe,ue=Me.split("."),A=+ye.groupSize,L=+ye.secondaryGroupSize,Y=ye.groupSeparator||"",Z=ue[0],fe=ue[1],we=this.s<0,ke=we?Z.slice(1):Z,Ie=ke.length;if(L&&(pe=A,A=L,Ie-=L=pe),0<A&&0<Ie){for(pe=Ie%A||A,Z=ke.substr(0,pe);pe<Ie;pe+=A)Z+=Y+ke.substr(pe,A);0<L&&(Z+=Y+ke.slice(pe)),we&&(Z="-"+Z)}Me=fe?Z+(ye.decimalSeparator||"")+((L=+ye.fractionGroupSize)?fe.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(ye.fractionGroupSeparator||"")):fe):Z}return(ye.prefix||"")+Me+(ye.suffix||"")},se.toFraction=function(ce){var de,ye,Me,pe,ue,A,L,Y,Z,fe,we,ke,Ie=this,ze=Ie.c;if(ce!=null&&(!(L=new Ne(ce)).isInteger()&&(L.c||L.s!==1)||L.lt(Ae)))throw Error(c+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+gt(L));if(!ze)return new Ne(Ie);for(de=new Ne(Ae),Z=ye=new Ne(Ae),Me=Y=new Ne(Ae),ke=w(ze),ue=de.e=ke.length-Ie.e-1,de.c[0]=f[(A=ue%h)<0?h+A:A],ce=!ce||0<L.comparedTo(de)?0<ue?de:Z:L,A=le,le=1/0,L=new Ne(ke),Y.c[0]=0;fe=V(L,de,0,1),(pe=ye.plus(fe.times(Me))).comparedTo(ce)!=1;)ye=Me,Me=pe,Z=Y.plus(fe.times(pe=Z)),Y=pe,de=L.minus(fe.times(pe=de)),L=pe;return pe=V(ce.minus(ye),Me,0,1),Y=Y.plus(pe.times(Z)),ye=ye.plus(pe.times(Me)),Y.s=Z.s=Ie.s,we=V(Z,Me,ue*=2,S).minus(Ie).abs().comparedTo(V(Y,ye,ue,S).minus(Ie).abs())<1?[Z,Me]:[Y,ye],le=A,we},se.toNumber=function(){return+gt(this)},se.toPrecision=function(ce,de){return ce!=null&&T(ce,1,g),it(this,ce,de,2)},se.toString=function(ce){var de,ye=this,Me=ye.s,pe=ye.e;return pe===null?Me?(de="Infinity",Me<0&&(de="-"+de)):de="NaN":(de=ce==null?pe<=I||X<=pe?B(w(ye.c),pe):G(w(ye.c),pe,"0"):ce===10?G(w((ye=Se(new Ne(ye),k+pe+1,S)).c),ye.e,"0"):(T(ce,2,Le.length,"Base"),J(G(w(ye.c),pe,"0"),10,ce,Me,!0)),Me<0&&ye.c[0]&&(de="-"+de)),de},se.valueOf=se.toJSON=function(){return gt(this)},se._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(se[Symbol.toStringTag]="BigNumber",se[Symbol.for("nodejs.util.inspect.custom")]=se.valueOf),O!=null&&Ne.set(O),Ne}()).default=n.BigNumber=n,e!==void 0&&e.exports?e.exports=n:(r||(r=typeof self<"u"&&self?self:window),r.BigNumber=n)})(this)},{}],2:[function(t,e,i){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(r){var n=r%10;return~~(r%100/10)==1?"th":n===1?"st":n===2?"nd":n===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,i){"use strict";function r(y,w){return function(x){if(Array.isArray(x))return x}(y)||function(x,T){var M=[],B=!0,G=!1,F=void 0;try{for(var O,V=x[Symbol.iterator]();!(B=(O=V.next()).done)&&(M.push(O.value),!T||M.length!==T);B=!0);}catch(J){G=!0,F=J}finally{try{B||V.return==null||V.return()}finally{if(G)throw F}}return M}(y,w)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var n=t("./globalState"),o=t("./validating"),s=t("./parsing"),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:a,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:a,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function u(y){var w=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},x=2<arguments.length?arguments[2]:void 0;if(typeof w=="string"&&(w=s.parseFormat(w)),!o.validateFormat(w))return"ERROR: invalid format";var T=w.prefix||"",M=w.postfix||"",B=function(G,F,O){switch(F.output){case"currency":return F=g(F,n.currentCurrencyDefaultFormat()),function(Le,Ne,it){var ct=it.currentCurrency(),Ue=Object.assign({},d,Ne),Se=void 0,gt="",ce=!!Ue.totalLength||!!Ue.forceAverage||Ue.average,de=Ne.currencyPosition||ct.position,ye=Ne.currencySymbol||ct.symbol;Ue.spaceSeparated&&(gt=" "),de==="infix"&&(Se=gt+ye+gt);var Me=m({instance:Le,providedFormat:Ne,state:it,decimalSeparator:Se});return de==="prefix"&&(Me=Le._value<0&&Ue.negative==="sign"?"-".concat(gt).concat(ye).concat(Me.slice(1)):ye+gt+Me),de&&de!=="postfix"||(Me=Me+(gt=ce?"":gt)+ye),Me}(G,F,n);case"percent":return F=g(F,n.currentPercentageDefaultFormat()),function(Le,Ne,it,ct){var Ue=Ne.prefixSymbol,Se=m({instance:ct(100*Le._value),providedFormat:Ne,state:it}),gt=Object.assign({},d,Ne);return Ue?"%".concat(gt.spaceSeparated?" ":"").concat(Se):"".concat(Se).concat(gt.spaceSeparated?" ":"","%")}(G,F,n,O);case"byte":return F=g(F,n.currentByteDefaultFormat()),Ae=G,S=n,I=O,X=(k=F).base||"binary",Q=c[X],le=h(Ae._value,Q.suffixes,Q.scale),xe=le.value,Re=le.suffix,Oe=m({instance:I(xe),providedFormat:k,state:S,defaults:S.currentByteDefaultFormat()}),We=S.currentAbbreviations(),"".concat(Oe).concat(We.spaced?" ":"").concat(Re);case"time":return F=g(F,n.currentTimeDefaultFormat()),W=G,ee=Math.floor(W._value/60/60),te=Math.floor((W._value-60*ee*60)/60),se=Math.round(W._value-60*ee*60-60*te),"".concat(ee,":").concat(te<10?"0":"").concat(te,":").concat(se<10?"0":"").concat(se);case"ordinal":return F=g(F,n.currentOrdinalDefaultFormat()),V=G,J=F,P=(N=n).currentOrdinal(),$=Object.assign({},d,J),K=m({instance:V,providedFormat:J,state:N}),ve=P(V._value),"".concat(K).concat($.spaceSeparated?" ":"").concat(ve);case"number":default:return m({instance:G,providedFormat:F,numbro:O})}var V,J,N,P,$,K,ve,W,ee,te,se,Ae,k,S,I,X,Q,le,xe,Re,Oe,We}(y,w,x);return B=(B=T+B)+M}function h(y,w,x){var T=w[0],M=Math.abs(y);if(x<=M){for(var B=1;B<w.length;++B){var G=Math.pow(x,B),F=Math.pow(x,B+1);if(G<=M&&M<F){T=w[B],y/=G;break}}T===w[0]&&(y/=Math.pow(x,w.length-1),T=w[w.length-1])}return{value:y,suffix:T}}function p(y){for(var w="",x=0;x<y;x++)w+="0";return w}function f(y,w){return y.toString().indexOf("e")!==-1?function(x,T){var M=x.toString(),B=r(M.split("e"),2),G=B[0],F=B[1],O=r(G.split("."),2),V=O[0],J=O[1],N=J===void 0?"":J;if(0<+F)M=V+N+p(F-N.length);else{var P=".";P=+V<0?"-0".concat(P):"0".concat(P);var $=(p(-F-1)+Math.abs(V)+N).substr(0,T);$.length<T&&($+=p(T-$.length)),M=P+$}return 0<+F&&0<T&&(M+=".".concat(p(T))),M}(y,w):(Math.round(+"".concat(y,"e+").concat(w))/Math.pow(10,w)).toFixed(w)}function m(y){var w=y.instance,x=y.providedFormat,T=y.state,M=T===void 0?n:T,B=y.decimalSeparator,G=y.defaults,F=G===void 0?M.currentDefaults():G,O=w._value;if(O===0&&M.hasZeroFormat())return M.getZeroFormat();if(!isFinite(O))return O.toString();var V,J,N,P,$,K,ve,W,ee=Object.assign({},d,F,x),te=ee.totalLength,se=te?0:ee.characteristic,Ae=ee.optionalCharacteristic,k=ee.forceAverage,S=!!te||!!k||ee.average,I=te?-1:S&&x.mantissa===void 0?0:ee.mantissa,X=!te&&(x.optionalMantissa===void 0?I===-1:ee.optionalMantissa),Q=ee.trimMantissa,le=ee.thousandSeparated,xe=ee.spaceSeparated,Re=ee.negative,Oe=ee.forceSign,We=ee.exponential,Le="";if(S){var Ne=function(ce){var de=ce.value,ye=ce.forceAverage,Me=ce.abbreviations,pe=ce.spaceSeparated,ue=pe!==void 0&&pe,A=ce.totalLength,L=A===void 0?0:A,Y="",Z=Math.abs(de),fe=-1;if(Z>=Math.pow(10,12)&&!ye||ye==="trillion"?(Y=Me.trillion,de/=Math.pow(10,12)):Z<Math.pow(10,12)&&Z>=Math.pow(10,9)&&!ye||ye==="billion"?(Y=Me.billion,de/=Math.pow(10,9)):Z<Math.pow(10,9)&&Z>=Math.pow(10,6)&&!ye||ye==="million"?(Y=Me.million,de/=Math.pow(10,6)):(Z<Math.pow(10,6)&&Z>=Math.pow(10,3)&&!ye||ye==="thousand")&&(Y=Me.thousand,de/=Math.pow(10,3)),Y&&(Y=(ue?" ":"")+Y),L){var we=de.toString().split(".")[0];fe=Math.max(L-we.length,0)}return{value:de,abbreviation:Y,mantissaPrecision:fe}}({value:O,forceAverage:k,abbreviations:M.currentAbbreviations(),spaceSeparated:xe,totalLength:te});O=Ne.value,Le+=Ne.abbreviation,te&&(I=Ne.mantissaPrecision)}if(We){var it=(J=(V={value:O,characteristicPrecision:se}).value,N=V.characteristicPrecision,P=N===void 0?0:N,$=r(J.toExponential().split("e"),2),K=$[0],ve=$[1],W=+K,P&&1<P&&(W*=Math.pow(10,P-1),ve=0<=(ve=+ve-(P-1))?"+".concat(ve):ve),{value:W,abbreviation:"e".concat(ve)});O=it.value,Le=it.abbreviation+Le}var ct,Ue,Se,gt=function(ce,de,ye,Me,pe){if(Me===-1)return ce;var ue=f(de,Me),A=r(ue.toString().split("."),2),L=A[0],Y=A[1],Z=Y===void 0?"":Y;if(Z.match(/^0+$/)&&(ye||pe))return L;var fe=Z.match(/0+$/);return pe&&fe?"".concat(L,".").concat(Z.toString().slice(0,fe.index)):ue.toString()}(O.toString(),O,X,I,Q);return gt=function(ce,de,ye,Me,pe){var ue=Me.currentDelimiters(),A=ue.thousands;pe=pe||ue.decimal;var L=ue.thousandsSize||3,Y=ce.toString(),Z=Y.split(".")[0],fe=Y.split(".")[1];return ye&&(de<0&&(Z=Z.slice(1)),function(we,ke){for(var Ie=[],ze=0,rt=we;0<rt;rt--)ze===ke&&(Ie.unshift(rt),ze=0),ze++;return Ie}(Z.length,L).forEach(function(we,ke){Z=Z.slice(0,we+ke)+A+Z.slice(we+ke)}),de<0&&(Z="-".concat(Z))),Y=fe?Z+pe+fe:Z}(gt=function(ce,de,ye,Me){var pe=ce,ue=r(pe.toString().split("."),2),A=ue[0],L=ue[1];if(A.match(/^-?0$/)&&ye)return L?"".concat(A.replace("0",""),".").concat(L):A.replace("0","");if(A.length<Me)for(var Y=Me-A.length,Z=0;Z<Y;Z++)pe="0".concat(pe);return pe.toString()}(gt,0,Ae,se),O,le,M,B),(S||We)&&(gt=gt+Le),(Oe||O<0)&&(ct=gt,Se=Re,gt=(Ue=O)===0?ct:+ct==0?ct.replace("-",""):0<Ue?"+".concat(ct):Se==="sign"?ct:"(".concat(ct.replace("-",""),")")),gt}function g(y,w){if(!y)return w;var x=Object.keys(y);return x.length===1&&x[0]==="output"?w:y}e.exports=function(y){return{format:function(){for(var w=arguments.length,x=new Array(w),T=0;T<w;T++)x[T]=arguments[T];return u.apply(void 0,x.concat([y]))},getByteUnit:function(){for(var w=arguments.length,x=new Array(w),T=0;T<w;T++)x[T]=arguments[T];return(function(M){var B=c.general;return h(M._value,B.suffixes,B.scale).suffix}).apply(void 0,x.concat([y]))},getBinaryByteUnit:function(){for(var w=arguments.length,x=new Array(w),T=0;T<w;T++)x[T]=arguments[T];return(function(M){var B=c.binary;return h(M._value,B.suffixes,B.scale).suffix}).apply(void 0,x.concat([y]))},getDecimalByteUnit:function(){for(var w=arguments.length,x=new Array(w),T=0;T<w;T++)x[T]=arguments[T];return(function(M){var B=c.decimal;return h(M._value,B.suffixes,B.scale).suffix}).apply(void 0,x.concat([y]))},formatOrDefault:g}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,i){"use strict";var r=t("./en-US"),n=t("./validating"),o=t("./parsing"),s={},a=void 0,c={},d=null,u={};function h(f){a=f}function p(){return c[a]}s.languages=function(){return Object.assign({},c)},s.currentLanguage=function(){return a},s.currentCurrency=function(){return p().currency},s.currentAbbreviations=function(){return p().abbreviations},s.currentDelimiters=function(){return p().delimiters},s.currentOrdinal=function(){return p().ordinal},s.currentDefaults=function(){return Object.assign({},p().defaults,u)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),p().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),p().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),p().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),p().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),p().timeFormat)},s.setDefaults=function(f){f=o.parseFormat(f),n.validateFormat(f)&&(u=f)},s.getZeroFormat=function(){return d},s.setZeroFormat=function(f){return d=typeof f=="string"?f:null},s.hasZeroFormat=function(){return d!==null},s.languageData=function(f){if(f){if(c[f])return c[f];throw new Error('Unknown tag "'.concat(f,'"'))}return p()},s.registerLanguage=function(f){var m=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!n.validateLanguage(f))throw new Error("Invalid language data");c[f.languageTag]=f,m&&h(f.languageTag)},s.setLanguage=function(f){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:r.languageTag;if(!c[f]){var g=f.split("-")[0],y=Object.keys(c).find(function(w){return w.split("-")[0]===g});return c[y]?void h(y):void h(m)}h(f)},s.registerLanguage(r),a=r.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,i){"use strict";e.exports=function(r){return{loadLanguagesInNode:function(n){return o=r,void n.forEach(function(s){var a=void 0;try{a=t("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}a&&o.registerLanguage(a)});var o}}}},{}],6:[function(t,e,i){"use strict";var r=t("bignumber.js");function n(o,s,a){var c=new r(o._value),d=s;return a.isNumbro(s)&&(d=s._value),d=new r(d),o._value=c.minus(d).toNumber(),o}e.exports=function(o){return{add:function(s,a){return d=a,u=o,h=new r((c=s)._value),p=d,u.isNumbro(d)&&(p=d._value),p=new r(p),c._value=h.plus(p).toNumber(),c;var c,d,u,h,p},subtract:function(s,a){return n(s,a,o)},multiply:function(s,a){return d=a,u=o,h=new r((c=s)._value),p=d,u.isNumbro(d)&&(p=d._value),p=new r(p),c._value=h.times(p).toNumber(),c;var c,d,u,h,p},divide:function(s,a){return d=a,u=o,h=new r((c=s)._value),p=d,u.isNumbro(d)&&(p=d._value),p=new r(p),c._value=h.dividedBy(p).toNumber(),c;var c,d,u,h,p},set:function(s,a){return c=s,u=d=a,o.isNumbro(d)&&(u=d._value),c._value=u,c;var c,d,u},difference:function(s,a){return c=a,n(u=(d=o)(s._value),c,d),Math.abs(u._value);var c,d,u}}}},{"bignumber.js":1}],7:[function(t,e,i){"use strict";function r(m,g){for(var y=0;y<g.length;y++){var w=g[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(m,w.key,w)}}var n=t("./globalState"),o=t("./validating"),s=t("./loading")(f),a=t("./unformatting"),c=t("./formatting")(f),d=t("./manipulating")(f),u=t("./parsing"),h=function(){function m(x){(function(T,M){if(!(T instanceof M))throw new TypeError("Cannot call a class as a function")})(this,m),this._value=x}var g,y,w;return g=m,(y=[{key:"clone",value:function(){return f(this._value)}},{key:"format",value:function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,x)}},{key:"formatCurrency",value:function(x){return typeof x=="string"&&(x=u.parseFormat(x)),(x=c.formatOrDefault(x,n.currentCurrencyDefaultFormat())).output="currency",c.format(this,x)}},{key:"formatTime",value:function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return x.output="time",c.format(this,x)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(x){return d.difference(this,x)}},{key:"add",value:function(x){return d.add(this,x)}},{key:"subtract",value:function(x){return d.subtract(this,x)}},{key:"multiply",value:function(x){return d.multiply(this,x)}},{key:"divide",value:function(x){return d.divide(this,x)}},{key:"set",value:function(x){return d.set(this,p(x))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&r(g.prototype,y),w&&r(g,w),m}();function p(m){var g=m;return f.isNumbro(m)?g=m._value:typeof m=="string"?g=f.unformat(m):isNaN(m)&&(g=NaN),g}function f(m){return new h(p(m))}f.version="2.1.2",f.isNumbro=function(m){return m instanceof h},f.language=n.currentLanguage,f.registerLanguage=n.registerLanguage,f.setLanguage=n.setLanguage,f.languages=n.languages,f.languageData=n.languageData,f.zeroFormat=n.setZeroFormat,f.defaultFormat=n.currentDefaults,f.setDefaults=n.setDefaults,f.defaultCurrencyFormat=n.currentCurrencyDefaultFormat,f.validate=o.validate,f.loadLanguagesInNode=s.loadLanguagesInNode,f.unformat=a.unformat,e.exports=f},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,i){"use strict";e.exports={parseFormat:function(r){var n,o,s,a,c,d,u,h,p,f,m,g,y,w,x,T,M,B,G,F,O=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof r!="string"?r:(o=O,r=(s=(n=r).match(/^{([^}]*)}/))?(o.prefix=s[1],n.slice(s[0].length)):n,c=O,function(V,J){if(V.indexOf("$")===-1){if(V.indexOf("%")===-1)return V.indexOf("bd")!==-1?(J.output="byte",J.base="general"):V.indexOf("b")!==-1?(J.output="byte",J.base="binary"):V.indexOf("d")!==-1?(J.output="byte",J.base="decimal"):V.indexOf(":")===-1?V.indexOf("o")!==-1&&(J.output="ordinal"):J.output="time";J.output="percent"}else J.output="currency"}(r=(d=(a=r).match(/{([^}]*)}$/))?(c.postfix=d[1],a.slice(0,-d[0].length)):a,O),u=O,(h=r.match(/[1-9]+[0-9]*/))&&(u.totalLength=+h[0]),p=O,(f=r.split(".")[0].match(/0+/))&&(p.characteristic=f[0].length),function(V,J){if(V.indexOf(".")!==-1){var N=V.split(".")[0];J.optionalCharacteristic=N.indexOf("0")===-1}}(r,O),m=O,r.indexOf("a")!==-1&&(m.average=!0),y=O,(g=r).indexOf("K")!==-1?y.forceAverage="thousand":g.indexOf("M")!==-1?y.forceAverage="million":g.indexOf("B")!==-1?y.forceAverage="billion":g.indexOf("T")!==-1&&(y.forceAverage="trillion"),function(V,J){var N=V.split(".")[1];if(N){var P=N.match(/0+/);P&&(J.mantissa=P[0].length)}}(r,O),x=O,(w=r).match(/\[\.]/)?x.optionalMantissa=!0:w.match(/\./)&&(x.optionalMantissa=!1),T=O,r.indexOf(",")!==-1&&(T.thousandSeparated=!0),M=O,r.indexOf(" ")!==-1&&(M.spaceSeparated=!0),G=O,(B=r).match(/^\+?\([^)]*\)$/)&&(G.negative="parenthesis"),B.match(/^\+?-/)&&(G.negative="sign"),F=O,r.match(/^\+/)&&(F.forceSign=!0),O)}}},{}],9:[function(t,e,i){"use strict";var r=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function n(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function o(s,a){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,u=4<arguments.length?arguments[4]:void 0,h=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===u?0:function f(m,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",w=3<arguments.length?arguments[3]:void 0,x=4<arguments.length?arguments[4]:void 0,T=5<arguments.length?arguments[5]:void 0,M=6<arguments.length?arguments[6]:void 0;if(!isNaN(+m))return+m;var B="",G=m.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(G!==m)return-1*f(G,g,y,w,x,T,M);for(var F=0;F<r.length;F++){var O=r[F];if((B=m.replace(O.key,""))!==m)return f(B,g,y,w,x,T,M)*O.factor}if((B=m.replace("%",""))!==m)return f(B,g,y,w,x,T,M)/100;var V=parseFloat(m);if(!isNaN(V)){var J=w(V);if(J&&J!=="."&&(B=m.replace(new RegExp("".concat(n(J),"$")),""))!==m)return f(B,g,y,w,x,T,M);var N={};Object.keys(T).forEach(function(te){N[T[te]]=te});for(var P=Object.keys(N).sort().reverse(),$=P.length,K=0;K<$;K++){var ve=P[K],W=N[ve];if((B=m.replace(ve,""))!==m){var ee=void 0;switch(W){case"thousand":ee=Math.pow(10,3);break;case"million":ee=Math.pow(10,6);break;case"billion":ee=Math.pow(10,9);break;case"trillion":ee=Math.pow(10,12)}return f(B,g,y,w,x,T,M)*ee}}}}(function(f,m){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",y=f.replace(g,"");return y=(y=y.replace(new RegExp("([0-9])".concat(n(m.thousands),"([0-9])"),"g"),"$1$2")).replace(m.decimal,".")}(s,a,c),a,c,d,u,h,p)}e.exports={unformat:function(s,a){var c,d,u,h=t("./globalState"),p=h.currentDelimiters(),f=h.currentCurrency().symbol,m=h.currentOrdinal(),g=h.getZeroFormat(),y=h.currentAbbreviations(),w=void 0;if(typeof s=="string")w=function(x,T){if(!x.indexOf(":")||T.thousands===":")return!1;var M=x.split(":");if(M.length!==3)return!1;var B=+M[0],G=+M[1],F=+M[2];return!isNaN(B)&&!isNaN(G)&&!isNaN(F)}(s,p)?(c=s.split(":"),d=+c[0],u=+c[1],+c[2]+60*u+3600*d):o(s,p,f,m,g,y,a);else{if(typeof s!="number")return;w=s}if(w!==void 0)return w}}},{"./globalState":4}],10:[function(t,e,i){"use strict";function r(p){return function(f){if(Array.isArray(f)){for(var m=0,g=new Array(f.length);m<f.length;m++)g[m]=f[m];return g}}(p)||function(f){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]")return Array.from(f)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function n(p){return(n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(p)}var o=t("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,a={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,f){return f.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,f){return!f.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,f){return f.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(p){return!!o.unformat(p)}function u(p,f,m){var g=3<arguments.length&&arguments[3]!==void 0&&arguments[3],y=Object.keys(p).map(function(w){if(!f[w])return console.error("".concat(m," Invalid key: ").concat(w)),!1;var x=p[w],T=f[w];if(typeof T=="string"&&(T={type:T}),T.type==="format"){if(!u(x,a,"[Validate ".concat(w,"]"),!0))return!1}else if(n(x)!==T.type)return console.error("".concat(m," ").concat(w,' type mismatched: "').concat(T.type,'" expected, "').concat(n(x),'" provided')),!1;if(T.restrictions&&T.restrictions.length)for(var M=T.restrictions.length,B=0;B<M;B++){var G=T.restrictions[B],F=G.restriction,O=G.message;if(!F(x,p))return console.error("".concat(m," ").concat(w," invalid value: ").concat(O)),!1}return T.restriction&&!T.restriction(x,p)?(console.error("".concat(m," ").concat(w," invalid value: ").concat(T.message)),!1):T.validValues&&T.validValues.indexOf(x)===-1?(console.error("".concat(m," ").concat(w," invalid value: must be among ").concat(JSON.stringify(T.validValues),', "').concat(x,'" provided')),!1):!(T.children&&!u(x,T.children,"[Validate ".concat(w,"]")))});return g||y.push.apply(y,r(Object.keys(f).map(function(w){var x=f[w];if(typeof x=="string"&&(x={type:x}),x.mandatory){var T=x.mandatory;if(typeof T=="function"&&(T=T(p)),T&&p[w]===void 0)return console.error("".concat(m,' Missing mandatory key "').concat(w,'"')),!1}return!0}))),y.reduce(function(w,x){return w&&x},!0)}function h(p){return u(p,a,"[Validate format]")}e.exports={validate:function(p,f){var m=d(p),g=h(f);return m&&g},validateFormat:h,validateInput:d,validateLanguage:function(p){return u(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})});var Xxe=z((rNi,Gxe)=>{"use strict";var $xe=fYe(),upt=TypeError;Gxe.exports=function(t,e){if(!delete t[e])throw new upt("Cannot delete property "+$xe(e)+" of "+$xe(t))}});var Kxe=z(()=>{"use strict";var hpt=rl(),fpt=RW(),ppt=IW(),mpt=d7(),gpt=Xxe(),vpt=u7(),bpt=[].unshift(0)!==1,_pt=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},ypt=bpt||!_pt();hpt({target:"Array",proto:!0,arity:1,forced:ypt},{unshift:function(e){var i=fpt(this),r=ppt(i),n=arguments.length;if(n){vpt(r+n);for(var o=r;o--;){var s=o+n;o in i?i[s]=i[o]:gpt(i,s)}for(var a=0;a<n;a++)i[a]=arguments[a]}return mpt(i,r+n)}})});var gTe=z((e7i,mTe)=>{"use strict";var $yt=EW(),Gyt=Bde(),Xyt=Lde();mTe.exports=function(t,e,i){$yt?Gyt.f(t,e,Xyt(0,i)):t[e]=i}});var vTe=z(()=>{"use strict";var Kyt=rl(),Zyt=EYe(),Qyt=gTe();Kyt({target:"Object",stat:!0},{fromEntries:function(e){var i={};return Zyt(e,function(r,n){Qyt(i,r,n)},{AS_ENTRIES:!0}),i}})});var Go=z((P$i,sRe)=>{"use strict";var{toString:oRe}=Object.prototype,cCt=/["&<>]/,zm={each:function(e,i){e&&(Array.isArray(e)?e.forEach(i):Object.keys(e).forEach(r=>{i(e[r],r)}))},some:function(e,i){return e?Array.isArray(e)?e.some(i):Object.keys(e).some(r=>i(e[r],r)):!1},every:function(e,i){return e?Array.isArray(e)?e.every(i):Object.keys(e).every(r=>i(e[r],r)):!0},map:function(e,i){return e?Array.isArray(e)?e.map(i):Object.keys(e).map(r=>i(e[r],r)):[]},keyBy(t,e){return t.reduce((i,r)=>(i[r[e]]=r,i),{})},isEqual:function(e,i){let r=typeof e,n=typeof i,o=Array.isArray(e),s=Array.isArray(i),a;if(r!==n)return!1;switch(typeof e){case"object":if(o||s)return o&&s?e.length===i.length&&e.every((c,d)=>{let u=i[d];return zm.isEqual(c,u)}):!1;if(e===null||i===null)return e===i;if(a=Object.keys(e),Object.keys(i).length!==a.length)return!1;for(let c of a)if(!i.hasOwnProperty(c))return!1;return zm.every(e,(c,d)=>{let u=i[d];return zm.isEqual(c,u)});default:return e===i}},escapeHtml(t){let e=cCt.exec(t);if(!e)return t;let i="",r="",n=0,o=e.index;for(;o<t.length;o++){switch(t.charAt(o)){case'"':r="&quot;";break;case"&":r="&amp;";break;case"'":r="&apos;";break;case"<":r="&lt;";break;case">":r="&gt;";break;default:continue}n!==o&&(i+=t.substring(n,o)),n=o+1,i+=r}return n!==o?i+t.substring(n,o):i},strcmp(t,e){return t<e?-1:t>e?1:0},isUndefined(t){return oRe.call(t)==="[object Undefined]"},isObject(t){return oRe.call(t)==="[object Object]"},deepMerge(){let t=arguments[0]||{},{length:e}=arguments,i,r,n;function o(s,a){i=t[a],n=Array.isArray(s),zm.isObject(s)||n?(n?(n=!1,r=i&&Array.isArray(i)?i:[]):r=i&&zm.isObject(i)?i:{},t[a]=zm.deepMerge(r,s)):zm.isUndefined(s)||(t[a]=s)}for(let s=0;s<e;s++)zm.each(arguments[s],o);return t}};sRe.exports=zm});var Oo=z((L$i,aRe)=>{"use strict";var dCt=/^[A-Z]+\d+$/,GO={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level(t){return t<=26?1:t<=676?2:3},_fill(t){let e,i,r,n,o,s=1;if(t>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&t>=1){for(;s<=26;)e=this._dictionary[s-1],this._n2l[s]=e,this._l2n[e]=s,s++;this._l2nFill=1}if(this._l2nFill<2&&t>=2){for(s=27;s<=702;)i=s-27,r=i%26,n=Math.floor(i/26),e=this._dictionary[n]+this._dictionary[r],this._n2l[s]=e,this._l2n[e]=s,s++;this._l2nFill=2}if(this._l2nFill<3&&t>=3){for(s=703;s<=16384;)i=s-703,r=i%26,n=Math.floor(i/26)%26,o=Math.floor(i/676),e=this._dictionary[o]+this._dictionary[n]+this._dictionary[r],this._n2l[s]=e,this._l2n[e]=s,s++;this._l2nFill=3}},l2n(t){if(this._l2n[t]||this._fill(t.length),!this._l2n[t])throw new Error(`Out of bounds. Invalid column letter: ${t}`);return this._l2n[t]},n2l(t){if(t<1||t>16384)throw new Error(`${t} is out of bounds. Excel supports columns from 1 to 16384`);return this._n2l[t]||this._fill(this._level(t)),this._n2l[t]},_hash:{},validateAddress(t){if(!dCt.test(t))throw new Error(`Invalid Address: ${t}`);return!0},decodeAddress(t){let e=t.length<5&&this._hash[t];if(e)return e;let i=!1,r="",n=0,o=!1,s="",a=0;for(let d=0,u;d<t.length;d++)if(u=t.charCodeAt(d),!o&&u>=65&&u<=90)i=!0,r+=t[d],n=n*26+u-64;else if(u>=48&&u<=57)o=!0,s+=t[d],a=a*10+u-48;else if(o&&i&&u!==36)break;if(!i)n=void 0;else if(n>16384)throw new Error(`Out of bounds. Invalid column letter: ${r}`);o||(a=void 0),t=r+s;let c={address:t,col:n,row:a,$col$row:`$${r}$${s}`};return n<=100&&a<=100&&(this._hash[t]=c,this._hash[c.$col$row]=c),c},getAddress(t,e){if(e){let i=this.n2l(e)+t;return this.decodeAddress(i)}return this.decodeAddress(t)},decode(t){let e=t.split(":");if(e.length===2){let i=this.decodeAddress(e[0]),r=this.decodeAddress(e[1]),n={top:Math.min(i.row,r.row),left:Math.min(i.col,r.col),bottom:Math.max(i.row,r.row),right:Math.max(i.col,r.col)};return n.tl=this.n2l(n.left)+n.top,n.br=this.n2l(n.right)+n.bottom,n.dimensions=`${n.tl}:${n.br}`,n}return this.decodeAddress(t)},decodeEx(t){let e=t.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),i=e[1]||e[2],r=e[3],n=r.split(":");if(n.length>1){let s=this.decodeAddress(n[0]),a=this.decodeAddress(n[1]),c=Math.min(s.row,a.row),d=Math.min(s.col,a.col),u=Math.max(s.row,a.row),h=Math.max(s.col,a.col);return s=this.n2l(d)+c,a=this.n2l(h)+u,{top:c,left:d,bottom:u,right:h,sheetName:i,tl:{address:s,col:d,row:c,$col$row:`$${this.n2l(d)}$${c}`,sheetName:i},br:{address:a,col:h,row:u,$col$row:`$${this.n2l(h)}$${u}`,sheetName:i},dimensions:`${s}:${a}`}}if(r.startsWith("#"))return i?{sheetName:i,error:r}:{error:r};let o=this.decodeAddress(r);return i?Ke({sheetName:i},o):o},encodeAddress(t,e){return GO.n2l(e)+t},encode(){switch(arguments.length){case 2:return GO.encodeAddress(arguments[0],arguments[1]);case 4:return`${GO.encodeAddress(arguments[0],arguments[1])}:${GO.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(t,e){let[i,r,,n,o]=t,[s,a]=e;return s>=i&&s<=n&&a>=r&&a<=o}};aRe.exports=GO});var Wm=z((H$i,lRe)=>{"use strict";var sp=Oo(),WK=class t{constructor(){this.decode(arguments)}setTLBR(e,i,r,n,o){if(arguments.length<4){let s=sp.decodeAddress(e),a=sp.decodeAddress(i);this.model={top:Math.min(s.row,a.row),left:Math.min(s.col,a.col),bottom:Math.max(s.row,a.row),right:Math.max(s.col,a.col),sheetName:r},this.setTLBR(s.row,s.col,a.row,a.col,o)}else this.model={top:Math.min(e,r),left:Math.min(i,n),bottom:Math.max(e,r),right:Math.max(i,n),sheetName:o}}decode(e){switch(e.length){case 5:this.setTLBR(e[0],e[1],e[2],e[3],e[4]);break;case 4:this.setTLBR(e[0],e[1],e[2],e[3]);break;case 3:this.setTLBR(e[0],e[1],e[2]);break;case 2:this.setTLBR(e[0],e[1]);break;case 1:{let i=e[0];if(i instanceof t)this.model={top:i.model.top,left:i.model.left,bottom:i.model.bottom,right:i.model.right,sheetName:i.sheetName};else if(i instanceof Array)this.decode(i);else if(i.top&&i.left&&i.bottom&&i.right)this.model={top:i.top,left:i.left,bottom:i.bottom,right:i.right,sheetName:i.sheetName};else{let r=sp.decodeEx(i);r.top?this.model={top:r.top,left:r.left,bottom:r.bottom,right:r.right,sheetName:r.sheetName}:this.model={top:r.row,left:r.col,bottom:r.row,right:r.col,sheetName:r.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error(`Invalid number of arguments to _getDimensions() - ${e.length}`)}}get top(){return this.model.top||1}set top(e){this.model.top=e}get left(){return this.model.left||1}set left(e){this.model.left=e}get bottom(){return this.model.bottom||1}set bottom(e){this.model.bottom=e}get right(){return this.model.right||1}set right(e){this.model.right=e}get sheetName(){return this.model.sheetName}set sheetName(e){this.model.sheetName=e}get _serialisedSheetName(){let{sheetName:e}=this.model;return e?/^[a-zA-Z0-9]*$/.test(e)?`${e}!`:`'${e}'!`:""}expand(e,i,r,n){(!this.model.top||e<this.top)&&(this.top=e),(!this.model.left||i<this.left)&&(this.left=i),(!this.model.bottom||r>this.bottom)&&(this.bottom=r),(!this.model.right||n>this.right)&&(this.right=n)}expandRow(e){if(e){let{dimensions:i,number:r}=e;i&&this.expand(r,i.min,r,i.max)}}expandToAddress(e){let i=sp.decodeEx(e);this.expand(i.row,i.col,i.row,i.col)}get tl(){return sp.n2l(this.left)+this.top}get $t$l(){return`$${sp.n2l(this.left)}$${this.top}`}get br(){return sp.n2l(this.right)+this.bottom}get $b$r(){return`$${sp.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(e){return!(e.sheetName&&this.sheetName&&e.sheetName!==this.sheetName||e.bottom<this.top||e.top>this.bottom||e.right<this.left||e.left>this.right)}contains(e){let i=sp.decodeEx(e);return this.containsEx(i)}containsEx(e){return e.sheetName&&this.sheetName&&e.sheetName!==this.sheetName?!1:e.row>=this.top&&e.row<=this.bottom&&e.col>=this.left&&e.col<=this.right}forEachAddress(e){for(let i=this.left;i<=this.right;i++)for(let r=this.top;r<=this.bottom;r++)e(sp.encodeAddress(r,i),r,i)}};lRe.exports=WK});var wh=z((B$i,cRe)=>{"use strict";cRe.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}});var uRe=z((V$i,dRe)=>{"use strict";var I4=Oo(),uCt=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,hCt=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;function fCt(t,e,i){let r=I4.decode(e),n=I4.decode(i);return t.replace(uCt,(o,s,a,c,d)=>{if(d)return o;let u=hCt.exec(c);if(u){let h=u[1],p=u[2].toUpperCase(),f=u[3],m=u[4];if(p.length>3||p.length===3&&p>"XFD")return o;let g=I4.l2n(p),y=parseInt(m,10);return h||(g+=n.col-r.col),f||(y+=n.row-r.row),(s||"")+(h||"")+I4.n2l(g)+(f||"")+y}return o})}dRe.exports={slideFormula:fCt}});var fRe=z((j$i,hRe)=>{"use strict";var pCt=Go(),mCt=(()=>{class t{constructor(i){this.note=i}get model(){let i=null;switch(typeof this.note){case"string":i={type:"note",note:{texts:[{text:this.note}]}};break;default:i={type:"note",note:this.note};break}return pCt.deepMerge({},t.DEFAULT_CONFIGS,i)}set model(i){let{note:r}=i,{texts:n}=r;n.length===1&&Object.keys(n[0]).length===1?this.note=n[0].text:this.note=r}static fromModel(i){let r=new t;return r.model=i,r}}return t.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},t})();hRe.exports=mCt});var gRe=z((z$i,mRe)=>{"use strict";var gCt=Oo(),vCt=Go(),Ch=wh(),{slideFormula:bCt}=uRe(),pRe=fRe(),Yt=class t{constructor(e,i,r){if(!e||!i)throw new Error("A Cell needs a Row");this._row=e,this._column=i,gCt.validateAddress(r),this._address=r,this._value=Bb.create(t.Types.Null,this),this.style=this._mergeStyle(e.style,i.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(e){this.style.numFmt=e}get font(){return this.style.font}set font(e){this.style.font=e}get alignment(){return this.style.alignment}set alignment(e){this.style.alignment=e}get border(){return this.style.border}set border(e){this.style.border=e}get fill(){return this.style.fill}set fill(e){this.style.fill=e}get protection(){return this.style.protection}set protection(e){this.style.protection=e}_mergeStyle(e,i,r){let n=e&&e.numFmt||i&&i.numFmt;n&&(r.numFmt=n);let o=e&&e.font||i&&i.font;o&&(r.font=o);let s=e&&e.alignment||i&&i.alignment;s&&(r.alignment=s);let a=e&&e.border||i&&i.border;a&&(r.border=a);let c=e&&e.fill||i&&i.fill;c&&(r.fill=c);let d=e&&e.protection||i&&i.protection;return d&&(r.protection=d),r}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===t.Types.Merge}merge(e,i){this._value.release(),this._value=Bb.create(t.Types.Merge,this,e),i||(this.style=e.style)}unmerge(){this.type===t.Types.Merge&&(this._value.release(),this._value=Bb.create(t.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(e){return this._value.type!==t.Types.Merge?!1:this._value.isMergedTo(e)}get master(){return this.type===t.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===t.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(e){if(this.type===t.Types.Merge){this._value.master.value=e;return}this._value.release(),this._value=Bb.create(Bb.getType(e),this,e)}get note(){return this._comment&&this._comment.note}set note(e){this._comment=new pRe(e)}get text(){return this._value.toString()}get html(){return vCt.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(e){this.type===t.Types.String&&(this._value=Bb.create(t.Types.Hyperlink,this,{text:this._value.value,hyperlink:e}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){let{worksheet:e}=this._row;return{sheetName:e.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(e){this.names=[e]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(e){let{definedNames:i}=this.workbook;i.removeAllNames(this.fullAddress),e.forEach(r=>{i.addEx(this.fullAddress,r)})}addName(e){this.workbook.definedNames.addEx(this.fullAddress,e)}removeName(e){this.workbook.definedNames.removeEx(this.fullAddress,e)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(e){this._dataValidations.add(this.address,e)}get model(){let{model:e}=this._value;return e.style=this.style,this._comment&&(e.comment=this._comment.model),e}set model(e){if(this._value.release(),this._value=Bb.create(e.type,this),this._value.model=e,e.comment)switch(e.comment.type){case"note":this._comment=pRe.fromModel(e.comment);break}e.style?this.style=e.style:this.style={}}};Yt.Types=Ch.ValueType;var UK=class{constructor(e){this.model={address:e.address,type:Yt.Types.Null}}get value(){return null}set value(e){}get type(){return Yt.Types.Null}get effectiveType(){return Yt.Types.Null}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){}toString(){return""}},qK=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.Number,value:i}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return Yt.Types.Number}get effectiveType(){return Yt.Types.Number}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}},YK=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.String,value:i}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return Yt.Types.String}get effectiveType(){return Yt.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}},$K=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.String,value:i}}get value(){return this.model.value}set value(e){this.model.value=e}toString(){return this.model.value.richText.map(e=>e.text).join("")}get type(){return Yt.Types.RichText}get effectiveType(){return Yt.Types.RichText}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}},GK=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.Date,value:i}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return Yt.Types.Date}get effectiveType(){return Yt.Types.Date}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}},XK=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.Hyperlink,text:i?i.text:void 0,hyperlink:i?i.hyperlink:void 0},i&&i.tooltip&&(this.model.tooltip=i.tooltip)}get value(){let e={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(e.tooltip=this.model.tooltip),e}set value(e){this.model={text:e.text,hyperlink:e.hyperlink},e.tooltip&&(this.model.tooltip=e.tooltip)}get text(){return this.model.text}set text(e){this.model.text=e}get hyperlink(){return this.model.hyperlink}set hyperlink(e){this.model.hyperlink=e}get type(){return Yt.Types.Hyperlink}get effectiveType(){return Yt.Types.Hyperlink}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}},KK=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.Merge,master:i?i.address:void 0},this._master=i,i&&i.addMergeRef()}get value(){return this._master.value}set value(e){e instanceof Yt?(this._master&&this._master.releaseMergeRef(),e.addMergeRef(),this._master=e):this._master.value=e}isMergedTo(e){return e===this._master}get master(){return this._master}get type(){return Yt.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}},ZK=class{constructor(e,i){this.cell=e,this.model={address:e.address,type:Yt.Types.Formula,shareType:i?i.shareType:void 0,ref:i?i.ref:void 0,formula:i?i.formula:void 0,sharedFormula:i?i.sharedFormula:void 0,result:i?i.result:void 0}}_copyModel(e){let i={},r=n=>{let o=e[n];o&&(i[n]=o)};return r("formula"),r("result"),r("ref"),r("shareType"),r("sharedFormula"),i}get value(){return this._copyModel(this.model)}set value(e){this.model=this._copyModel(e)}validate(e){switch(Bb.getType(e)){case Yt.Types.Null:case Yt.Types.String:case Yt.Types.Number:case Yt.Types.Date:break;case Yt.Types.Hyperlink:case Yt.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){let e=this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),i=this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g);return{ranges:e,cells:i}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(e){this.model.formula=e}get formulaType(){return this.model.formula?Ch.FormulaType.Master:this.model.sharedFormula?Ch.FormulaType.Shared:Ch.FormulaType.None}get result(){return this.model.result}set result(e){this.model.result=e}get type(){return Yt.Types.Formula}get effectiveType(){let e=this.model.result;return e==null?Ch.ValueType.Null:e instanceof String||typeof e=="string"?Ch.ValueType.String:typeof e=="number"?Ch.ValueType.Number:e instanceof Date?Ch.ValueType.Date:e.text&&e.hyperlink?Ch.ValueType.Hyperlink:e.formula?Ch.ValueType.Formula:Ch.ValueType.Null}get address(){return this.model.address}set address(e){this.model.address=e}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){let{worksheet:e}=this.cell,i=e.findCell(this.model.sharedFormula);this._translatedFormula=i&&bCt(i.formula,i.address,this.model.address)}return this._translatedFormula}toCsvString(){return`${this.model.result||""}`}release(){}toString(){return this.model.result?this.model.result.toString():""}},QK=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.SharedString,value:i}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return Yt.Types.SharedString}get effectiveType(){return Yt.Types.SharedString}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}},JK=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.Boolean,value:i}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return Yt.Types.Boolean}get effectiveType(){return Yt.Types.Boolean}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}},eZ=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.Error,value:i}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return Yt.Types.Error}get effectiveType(){return Yt.Types.Error}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}},tZ=class{constructor(e,i){this.model={address:e.address,type:Yt.Types.String,value:JSON.stringify(i),rawValue:i}}get value(){return this.model.rawValue}set value(e){this.model.rawValue=e,this.model.value=JSON.stringify(e)}get type(){return Yt.Types.String}get effectiveType(){return Yt.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}},Bb={getType(t){return t==null?Yt.Types.Null:t instanceof String||typeof t=="string"?Yt.Types.String:typeof t=="number"?Yt.Types.Number:typeof t=="boolean"?Yt.Types.Boolean:t instanceof Date?Yt.Types.Date:t.text&&t.hyperlink?Yt.Types.Hyperlink:t.formula||t.sharedFormula?Yt.Types.Formula:t.richText?Yt.Types.RichText:t.sharedString?Yt.Types.SharedString:t.error?Yt.Types.Error:Yt.Types.JSON},types:[{t:Yt.Types.Null,f:UK},{t:Yt.Types.Number,f:qK},{t:Yt.Types.String,f:YK},{t:Yt.Types.Date,f:GK},{t:Yt.Types.Hyperlink,f:XK},{t:Yt.Types.Formula,f:ZK},{t:Yt.Types.Merge,f:KK},{t:Yt.Types.JSON,f:tZ},{t:Yt.Types.SharedString,f:QK},{t:Yt.Types.RichText,f:$K},{t:Yt.Types.Boolean,f:JK},{t:Yt.Types.Error,f:eZ}].reduce((t,e)=>(t[e.t]=e.f,t),[]),create(t,e,i){let r=this.types[t];if(!r)throw new Error(`Could not create Value of type ${t}`);return new r(e,i)}};mRe.exports=Yt});var M4=z((W$i,bRe)=>{"use strict";var _Ct=Go(),D4=wh(),ew=Oo(),vRe=gRe(),iZ=class{constructor(e,i){this._worksheet=e,this._number=i,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(e){return this._cells[e-1]}getCellEx(e){let i=this._cells[e.col-1];if(!i){let r=this._worksheet.getColumn(e.col);i=new vRe(this,r,e.address),this._cells[e.col-1]=i}return i}getCell(e){if(typeof e=="string"){let i=this._worksheet.getColumnKey(e);i?e=i.number:e=ew.l2n(e)}return this._cells[e-1]||this.getCellEx({address:ew.encodeAddress(this._number,e),row:this._number,col:e})}splice(e,i,...r){let n=e+i,o=r.length-i,s=this._cells.length,a,c,d;if(o<0)for(a=e+r.length;a<=s;a++)d=this._cells[a-1],c=this._cells[a-o-1],c?(d=this.getCell(a),d.value=c.value,d.style=c.style,d._comment=c._comment):d&&(d.value=null,d.style={},d._comment=void 0);else if(o>0)for(a=s;a>=n;a--)c=this._cells[a-1],c?(d=this.getCell(a+o),d.value=c.value,d.style=c.style,d._comment=c._comment):this._cells[a+o-1]=void 0;for(a=0;a<r.length;a++)d=this.getCell(e+a),d.value=r[a],d.style={},d._comment=void 0}eachCell(e,i){if(i||(i=e,e=null),e&&e.includeEmpty){let r=this._cells.length;for(let n=1;n<=r;n++)i(this.getCell(n),n)}else this._cells.forEach((r,n)=>{r&&r.type!==D4.ValueType.Null&&i(r,n+1)})}addPageBreak(e,i){let r=this._worksheet,n=Math.max(0,e-1)||0,o=Math.max(0,i-1)||16838,s={id:this._number,max:o,man:1};n&&(s.min=n),r.rowBreaks.push(s)}get values(){let e=[];return this._cells.forEach(i=>{i&&i.type!==D4.ValueType.Null&&(e[i.col]=i.value)}),e}set values(e){if(this._cells=[],e)if(e instanceof Array){let i=0;e.hasOwnProperty("0")&&(i=1),e.forEach((r,n)=>{r!==void 0&&(this.getCellEx({address:ew.encodeAddress(this._number,n+i),row:this._number,col:n+i}).value=r)})}else this._worksheet.eachColumnKey((i,r)=>{e[r]!==void 0&&(this.getCellEx({address:ew.encodeAddress(this._number,i.number),row:this._number,col:i.number}).value=e[r])})}get hasValues(){return _Ct.some(this._cells,e=>e&&e.type!==D4.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let e=0;return this.eachCell(()=>{e++}),e}get dimensions(){let e=0,i=0;return this._cells.forEach(r=>{r&&r.type!==D4.ValueType.Null&&((!e||e>r.col)&&(e=r.col),i<r.col&&(i=r.col))}),e>0?{min:e,max:i}:null}_applyStyle(e,i){return this.style[e]=i,this._cells.forEach(r=>{r&&(r[e]=i)}),i}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){let e=[],i=0,r=0;return this._cells.forEach(n=>{if(n){let o=n.model;o&&((!i||i>n.col)&&(i=n.col),r<n.col&&(r=n.col),e.push(o))}}),this.height||e.length?{cells:e,number:this.number,min:i,max:r,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(e){if(e.number!==this._number)throw new Error("Invalid row number in model");this._cells=[];let i;e.cells.forEach(r=>{switch(r.type){case vRe.Types.Merge:break;default:{let n;if(r.address)n=ew.decodeAddress(r.address);else if(i){let{row:s}=i,a=i.col+1;n={row:s,col:a,address:ew.encodeAddress(s,a),$col$row:`$${ew.n2l(a)}$${s}`}}i=n;let o=this.getCellEx(n);o.model=r;break}}}),e.height?this.height=e.height:delete this.height,this.hidden=e.hidden,this.outlineLevel=e.outlineLevel||0,this.style=e.style&&JSON.parse(JSON.stringify(e.style))||{}}};bRe.exports=iZ});var k4=z((U$i,_Re)=>{"use strict";var yCt=Go(),wCt=wh(),CCt=Oo(),rZ=9,nZ=class t{constructor(e,i,r){this._worksheet=e,this._number=i,r!==!1&&(this.defn=r)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return CCt.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==rZ}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(e){e?(this.key=e.key,this.width=e.width!==void 0?e.width:rZ,this.outlineLevel=e.outlineLevel,e.style?this.style=e.style:this.style={},this.header=e.header,this._hidden=!!e.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(e){e!==void 0?(this._header=e,this.headers.forEach((i,r)=>{this._worksheet.getCell(r+1,this.number).value=i})):this._header=void 0}get key(){return this._key}set key(e){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=e,e&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(e){return this.width===e.width&&this.hidden===e.hidden&&this.outlineLevel===e.outlineLevel&&yCt.isEqual(this.style,e.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;let e=this.style;return!(e&&(e.font||e.numFmt||e.alignment||e.border||e.fill||e.protection))}get headerCount(){return this.headers.length}eachCell(e,i){let r=this.number;i||(i=e,e=null),this._worksheet.eachRow(e,(n,o)=>{i(n.getCell(r),o)})}get values(){let e=[];return this.eachCell((i,r)=>{i&&i.type!==wCt.ValueType.Null&&(e[r]=i.value)}),e}set values(e){if(!e)return;let i=this.number,r=0;e.hasOwnProperty("0")&&(r=1),e.forEach((n,o)=>{this._worksheet.getCell(o+r,i).value=n})}_applyStyle(e,i){return this.style[e]=i,this.eachCell(r=>{r[e]=i}),i}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}static toModel(e){let i=[],r=null;return e&&e.forEach((n,o)=>{n.isDefault?r&&(r=null):!r||!n.equivalentTo(r)?(r={min:o+1,max:o+1,width:n.width!==void 0?n.width:rZ,style:n.style,isCustomWidth:n.isCustomWidth,hidden:n.hidden,outlineLevel:n.outlineLevel,collapsed:n.collapsed},i.push(r)):r.max=o+1}),i.length?i:void 0}static fromModel(e,i){i=i||[];let r=[],n=1,o=0;for(i=i.sort(function(s,a){return s.min-a.min});o<i.length;){let s=i[o++];for(;n<s.min;)r.push(new t(e,n++));for(;n<=s.max;)r.push(new t(e,n++,s))}return r.length?r:null}};_Re.exports=nZ});var wRe=z((q$i,yRe)=>{"use strict";var xCt=Oo(),oZ=class t{constructor(e,i,r=0){if(this.worksheet=e,!i)this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0;else if(typeof i=="string"){let n=xCt.decodeAddress(i);this.nativeCol=n.col+r,this.nativeColOff=0,this.nativeRow=n.row+r,this.nativeRowOff=0}else i.nativeCol!==void 0?(this.nativeCol=i.nativeCol||0,this.nativeColOff=i.nativeColOff||0,this.nativeRow=i.nativeRow||0,this.nativeRowOff=i.nativeRowOff||0):i.col!==void 0?(this.col=i.col+r,this.row=i.row+r):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0)}static asInstance(e){return e instanceof t||e==null?e:new t(e)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(e){this.nativeCol=Math.floor(e),this.nativeColOff=Math.floor((e-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(e){this.nativeRow=Math.floor(e),this.nativeRowOff=Math.floor((e-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(this.worksheet.getColumn(this.nativeCol+1).width*1e4):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(this.worksheet.getRow(this.nativeRow+1).height*1e4):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(e){this.nativeCol=e.nativeCol,this.nativeColOff=e.nativeColOff,this.nativeRow=e.nativeRow,this.nativeRowOff=e.nativeRowOff}};yRe.exports=oZ});var xRe=z((Y$i,CRe)=>{"use strict";var SCt=Oo(),O4=wRe(),sZ=class{constructor(e,i){this.worksheet=e,this.model=i}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model({type:e,imageId:i,range:r,hyperlinks:n}){if(this.type=e,this.imageId=i,e==="image")if(typeof r=="string"){let o=SCt.decode(r);this.range={tl:new O4(this.worksheet,{col:o.left,row:o.top},-1),br:new O4(this.worksheet,{col:o.right,row:o.bottom},0),editAs:"oneCell"}}else this.range={tl:new O4(this.worksheet,r.tl,0),br:r.br&&new O4(this.worksheet,r.br,0),ext:r.ext,editAs:r.editAs,hyperlinks:n||r.hyperlinks}}};CRe.exports=sZ});var ERe=z(($$i,SRe)=>{"use strict";var N4=Oo(),aZ=class{constructor(e,i,r){this.table=e,this.column=i,this.index=r}_set(e,i){this.table.cacheState(),this.column[e]=i}get name(){return this.column.name}set name(e){this._set("name",e)}get filterButton(){return this.column.filterButton}set filterButton(e){this.column.filterButton=e}get style(){return this.column.style}set style(e){this.column.style=e}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(e){this._set("totalsRowLabel",e)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(e){this._set("totalsRowFunction",e)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(e){this._set("totalsRowResult",e)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(e){this._set("totalsRowFormula",e)}},lZ=class{constructor(e,i){this.worksheet=e,i&&(this.table=i,this.validate(),this.store())}getFormula(e){switch(e.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${e.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${e.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${e.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${e.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${e.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${e.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${e.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${e.name}])`;case"custom":return e.totalsRowFormula;default:throw new Error(`Invalid Totals Row Function: ${e.totalsRowFunction}`)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){let{table:e}=this,i=(d,u,h)=>{d[u]===void 0&&(d[u]=h)};i(e,"headerRow",!0),i(e,"totalsRow",!1),i(e,"style",{}),i(e.style,"theme","TableStyleMedium2"),i(e.style,"showFirstColumn",!1),i(e.style,"showLastColumn",!1),i(e.style,"showRowStripes",!1),i(e.style,"showColumnStripes",!1);let r=(d,u)=>{if(!d)throw new Error(u)};r(e.ref,"Table must have ref"),r(e.columns,"Table must have column definitions"),r(e.rows,"Table must have row definitions"),e.tl=N4.decodeAddress(e.ref);let{row:n,col:o}=e.tl;r(n>0,"Table must be on valid row"),r(o>0,"Table must be on valid col");let{width:s,filterHeight:a,tableHeight:c}=this;e.autoFilterRef=N4.encode(n,o,n+a-1,o+s-1),e.tableRef=N4.encode(n,o,n+c-1,o+s-1),e.columns.forEach((d,u)=>{r(d.name,`Column ${u} must have a name`),u===0?i(d,"totalsRowLabel","Total"):(i(d,"totalsRowFunction","none"),d.totalsRowFormula=this.getFormula(d))})}store(){let e=(a,c)=>{c&&Object.keys(c).forEach(d=>{a[d]=c[d]})},{worksheet:i,table:r}=this,{row:n,col:o}=r.tl,s=0;if(r.headerRow){let a=i.getRow(n+s++);r.columns.forEach((c,d)=>{let{style:u,name:h}=c,p=a.getCell(o+d);p.value=h,e(p,u)})}if(r.rows.forEach(a=>{let c=i.getRow(n+s++);a.forEach((d,u)=>{let h=c.getCell(o+u);h.value=d,e(h,r.columns[u].style)})}),r.totalsRow){let a=i.getRow(n+s++);r.columns.forEach((c,d)=>{let u=a.getCell(o+d);d===0?u.value=c.totalsRowLabel:this.getFormula(c)?u.value={formula:c.totalsRowFormula,result:c.totalsRowResult}:u.value=null,e(u,c.style)})}}load(e){let{table:i}=this,{row:r,col:n}=i.tl,o=0;if(i.headerRow){let s=e.getRow(r+o++);i.columns.forEach((a,c)=>{let d=s.getCell(n+c);d.value=a.name})}if(i.rows.forEach(s=>{let a=e.getRow(r+o++);s.forEach((c,d)=>{let u=a.getCell(n+d);u.value=c})}),i.totalsRow){let s=e.getRow(r+o++);i.columns.forEach((a,c)=>{let d=s.getCell(n+c);c===0?d.value=a.totalsRowLabel:this.getFormula(a)&&(d.value={formula:a.totalsRowFormula,result:a.totalsRowResult})})}}get model(){return this.table}set model(e){this.table=e}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();let e=N4.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let i=0;i<this._cache.tableHeight;i++){let r=this.worksheet.getRow(e.row+i);for(let n=0;n<this._cache.width;n++){let o=r.getCell(e.col+n);o.value=null}}else{for(let i=this.tableHeight;i<this._cache.tableHeight;i++){let r=this.worksheet.getRow(e.row+i);for(let n=0;n<this._cache.width;n++){let o=r.getCell(e.col+n);o.value=null}}for(let i=0;i<this.tableHeight;i++){let r=this.worksheet.getRow(e.row+i);for(let n=this.width;n<this._cache.width;n++){let o=r.getCell(e.col+n);o.value=null}}}this.store()}addRow(e,i){this.cacheState(),i===void 0?this.table.rows.push(e):this.table.rows.splice(i,0,e)}removeRows(e,i=1){this.cacheState(),this.table.rows.splice(e,i)}getColumn(e){let i=this.table.columns[e];return new aZ(this,i,e)}addColumn(e,i,r){this.cacheState(),r===void 0?(this.table.columns.push(e),this.table.rows.forEach((n,o)=>{n.push(i[o])})):(this.table.columns.splice(r,0,e),this.table.rows.forEach((n,o)=>{n.splice(r,0,i[o])}))}removeColumns(e,i=1){this.cacheState(),this.table.columns.splice(e,i),this.table.rows.forEach(r=>{r.splice(e,i)})}_assign(e,i,r){this.cacheState(),e[i]=r}get ref(){return this.table.ref}set ref(e){this._assign(this.table,"ref",e)}get name(){return this.table.name}set name(e){this.table.name=e}get displayName(){return this.table.displyName||this.table.name}set displayNamename(e){this.table.displayName=e}get headerRow(){return this.table.headerRow}set headerRow(e){this._assign(this.table,"headerRow",e)}get totalsRow(){return this.table.totalsRow}set totalsRow(e){this._assign(this.table,"totalsRow",e)}get theme(){return this.table.style.name}set theme(e){this.table.style.name=e}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(e){this.table.style.showFirstColumn=e}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(e){this.table.style.showLastColumn=e}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(e){this.table.style.showRowStripes=e}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(e){this.table.style.showColumnStripes=e}};SRe.exports=lZ});var dZ=z((G$i,TRe)=>{"use strict";var cZ=class{constructor(e){this.model=e||{}}add(e,i){return this.model[e]=i}find(e){return this.model[e]}remove(e){this.model[e]=void 0}};TRe.exports=cZ});var hZ=z((X$i,RRe)=>{"use strict";var uZ=Ze("crypto"),ECt={hash(t,...e){let i=uZ.createHash(t);return i.update(Buffer.concat(e)),i.digest()},convertPasswordToHash(t,e,i,r){if(e=e.toLowerCase(),uZ.getHashes().indexOf(e)<0)throw new Error(`Hash algorithm '${e}' not supported!`);let o=Buffer.from(t,"utf16le"),s=this.hash(e,Buffer.from(i,"base64"),o);for(let a=0;a<r;a++){let c=Buffer.alloc(4);c.writeUInt32LE(a,0),s=this.hash(e,s,c)}return s.toString("base64")},randomBytes(t){return uZ.randomBytes(t)}};RRe.exports=ECt});var DRe=z(IRe=>{"use strict";var ARe=(t,e)=>Ke(Ke({},t),e.reduce((i,r)=>(t[r]&&(i[r]=Ke({},t[r])),i),{})),ap=(t,e,i,r=[])=>{t[i]&&(e[i]=ARe(t[i],r))},TCt=t=>Object.keys(t).length===0,RCt=t=>{if(!t)return t;if(TCt(t))return{};let e=Ke({},t);return ap(t,e,"font",["color"]),ap(t,e,"alignment"),ap(t,e,"protection"),t.border&&(ap(t,e,"border"),ap(t.border,e.border,"top",["color"]),ap(t.border,e.border,"left",["color"]),ap(t.border,e.border,"bottom",["color"]),ap(t.border,e.border,"right",["color"]),ap(t.border,e.border,"diagonal",["color"])),t.fill&&(ap(t,e,"fill",["fgColor","bgColor","center"]),t.fill.stops&&(e.fill.stops=t.fill.stops.map(i=>ARe(i,["color"])))),e};IRe.copyStyle=RCt});var FRe=z((Q$i,LRe)=>{"use strict";var XO=Go(),KO=Oo(),ZO=Wm(),MRe=M4(),P4=k4(),ACt=wh(),fZ=xRe(),kRe=ERe(),ORe=dZ(),NRe=hZ(),{copyStyle:PRe}=DRe(),pZ=class{constructor(e){e=e||{},this._workbook=e.workbook,this.id=e.id,this.orderNo=e.orderNo,this.name=e.name,this.state=e.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},e.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!!(e.pageSetup&&(e.pageSetup.fitToWidth||e.pageSetup.fitToHeight)&&!e.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},e.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},e.headerFooter),this.dataValidations=new ORe,this.views=e.views||[],this.autoFilter=e.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(e){if(e===void 0&&(e=`sheet${this.id}`),this._name!==e){if(typeof e!="string")throw new Error("The name has to be a string.");if(e==="")throw new Error("The name can't be empty.");if(e==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(e))throw new Error(`Worksheet name ${e} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(e))throw new Error(`The first or last character of worksheet name cannot be a single quotation mark: ${e}`);if(e&&e.length>31&&(console.warn(`Worksheet name ${e} exceeds 31 chars. This will be truncated`),e=e.substring(0,31)),this._workbook._worksheets.find(i=>i&&i.name.toLowerCase()===e.toLowerCase()))throw new Error(`Worksheet name already exists: ${e}`);this._name=e}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){let e=new ZO;return this._rows.forEach(i=>{if(i){let r=i.dimensions;r&&e.expand(i.number,r.min,i.number,r.max)}}),e}get columns(){return this._columns}set columns(e){this._headerRowCount=e.reduce((n,o)=>{let s=o.header&&1||o.headers&&o.headers.length||0;return Math.max(n,s)},0);let i=1,r=this._columns=[];e.forEach(n=>{let o=new P4(this,i++,!1);r.push(o),o.defn=n})}getColumnKey(e){return this._keys[e]}setColumnKey(e,i){this._keys[e]=i}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){XO.each(this._keys,e)}getColumn(e){if(typeof e=="string"){let i=this._keys[e];if(i)return i;e=KO.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let i=this._columns.length+1;for(;i<=e;)this._columns.push(new P4(this,i++))}return this._columns[e-1]}spliceColumns(e,i,...r){let o=this._rows.length;if(r.length>0)for(let d=0;d<o;d++){let u=[e,i];r.forEach(p=>{u.push(p[d]||null)});let h=this.getRow(d+1);h.splice.apply(h,u)}else this._rows.forEach(d=>{d&&d.splice(e,i)});let s=r.length-i,a=e+i,c=this._columns.length;if(s<0)for(let d=e+r.length;d<=c;d++)this.getColumn(d).defn=this.getColumn(d-s).defn;else if(s>0)for(let d=c;d>=a;d--)this.getColumn(d+s).defn=this.getColumn(d).defn;for(let d=e;d<e+r.length;d++)this.getColumn(d).defn=null;this.workbook.definedNames.spliceColumns(this.name,e,i,r.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let e=0;return this.eachRow(i=>{e=Math.max(e,i.cellCount)}),e}get actualColumnCount(){let e=[],i=0;return this.eachRow(r=>{r.eachCell(({col:n})=>{e[n]||(e[n]=!0,i++)})}),i}_commitRow(){}get _lastRowNumber(){let e=this._rows,i=e.length;for(;i>0&&e[i-1]===void 0;)i--;return i}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(e){return this._rows[e-1]}findRows(e,i){return this._rows.slice(e-1,e-1+i)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let e=0;return this.eachRow(()=>{e++}),e}getRow(e){let i=this._rows[e-1];return i||(i=this._rows[e-1]=new MRe(this,e)),i}getRows(e,i){if(i<1)return;let r=[];for(let n=e;n<e+i;n++)r.push(this.getRow(n));return r}addRow(e,i="n"){let r=this._nextRow,n=this.getRow(r);return n.values=e,this._setStyleOption(r,i[0]==="i"?i:"n"),n}addRows(e,i="n"){let r=[];return e.forEach(n=>{r.push(this.addRow(n,i))}),r}insertRow(e,i,r="n"){return this.spliceRows(e,0,i),this._setStyleOption(e,r),this.getRow(e)}insertRows(e,i,r="n"){if(this.spliceRows(e,0,...i),r!=="n")for(let n=0;n<i.length;n++)r[0]==="o"&&this.findRow(i.length+e+n)!==void 0?this._copyStyle(i.length+e+n,e+n,r[1]==="+"):r[0]==="i"&&this.findRow(e-1)!==void 0&&this._copyStyle(e-1,e+n,r[1]==="+");return this.getRows(e,i.length)}_setStyleOption(e,i="n"){i[0]==="o"&&this.findRow(e+1)!==void 0?this._copyStyle(e+1,e,i[1]==="+"):i[0]==="i"&&this.findRow(e-1)!==void 0&&this._copyStyle(e-1,e,i[1]==="+")}_copyStyle(e,i,r=!1){let n=this.getRow(e),o=this.getRow(i);o.style=PRe(n.style),n.eachCell({includeEmpty:r},(s,a)=>{o.getCell(a).style=PRe(s.style)}),o.height=n.height}duplicateRow(e,i,r=!1){let n=this._rows[e-1],o=new Array(i).fill(n.values);this.spliceRows(e+1,r?0:i,...o);for(let s=0;s<i;s++){let a=this._rows[e+s];a.style=n.style,a.height=n.height,n.eachCell({includeEmpty:!0},(c,d)=>{a.getCell(d).style=c.style})}}spliceRows(e,i,...r){let n=e+i,o=r.length,s=o-i,a=this._rows.length,c,d;if(s<0)for(e===a&&(this._rows[a-1]=void 0),c=n;c<=a;c++)if(d=this._rows[c-1],d){let u=this.getRow(c+s);u.values=d.values,u.style=d.style,u.height=d.height,d.eachCell({includeEmpty:!0},(h,p)=>{u.getCell(p).style=h.style}),this._rows[c-1]=void 0}else this._rows[c+s-1]=void 0;else if(s>0)for(c=a;c>=n;c--)if(d=this._rows[c-1],d){let u=this.getRow(c+s);u.values=d.values,u.style=d.style,u.height=d.height,d.eachCell({includeEmpty:!0},(h,p)=>{if(u.getCell(p).style=h.style,h._value.constructor.name==="MergeValue"){let f=this.getRow(h._row._number+o).getCell(p),m=h._value._master,g=this.getRow(m._row._number+o).getCell(m._column._number);f.merge(g)}})}else this._rows[c+s-1]=void 0;for(c=0;c<o;c++){let u=this.getRow(e+c);u.style={},u.values=r[c]}this.workbook.definedNames.spliceRows(this.name,e,i,o)}eachRow(e,i){if(i||(i=e,e=void 0),e&&e.includeEmpty){let r=this._rows.length;for(let n=1;n<=r;n++)i(this.getRow(n),n)}else this._rows.forEach(r=>{r&&r.hasValues&&i(r,r.number)})}getSheetValues(){let e=[];return this._rows.forEach(i=>{i&&(e[i.number]=i.values)}),e}findCell(e,i){let r=KO.getAddress(e,i),n=this._rows[r.row-1];return n?n.findCell(r.col):void 0}getCell(e,i){let r=KO.getAddress(e,i);return this.getRow(r.row).getCellEx(r)}mergeCells(...e){let i=new ZO(e);this._mergeCellsInternal(i)}mergeCellsWithoutStyle(...e){let i=new ZO(e);this._mergeCellsInternal(i,!0)}_mergeCellsInternal(e,i){XO.each(this._merges,n=>{if(n.intersects(e))throw new Error("Cannot merge already merged cells")});let r=this.getCell(e.top,e.left);for(let n=e.top;n<=e.bottom;n++)for(let o=e.left;o<=e.right;o++)(n>e.top||o>e.left)&&this.getCell(n,o).merge(r,i);this._merges[r.address]=e}_unMergeMaster(e){let i=this._merges[e.address];if(i){for(let r=i.top;r<=i.bottom;r++)for(let n=i.left;n<=i.right;n++)this.getCell(r,n).unmerge();delete this._merges[e.address]}}get hasMerges(){return XO.some(this._merges,Boolean)}unMergeCells(...e){let i=new ZO(e);for(let r=i.top;r<=i.bottom;r++)for(let n=i.left;n<=i.right;n++){let o=this.findCell(r,n);o&&(o.type===ACt.ValueType.Merge?this._unMergeMaster(o.master):this._merges[o.address]&&this._unMergeMaster(o))}}fillFormula(e,i,r,n="shared"){let o=KO.decode(e),{top:s,left:a,bottom:c,right:d}=o,u=d-a+1,h=KO.encodeAddress(s,a),p=n==="shared",f;typeof r=="function"?f=r:Array.isArray(r)?Array.isArray(r[0])?f=(g,y)=>r[g-s][y-a]:f=(g,y)=>r[(g-s)*u+(y-a)]:f=()=>{};let m=!0;for(let g=s;g<=c;g++)for(let y=a;y<=d;y++)m?(this.getCell(g,y).value={shareType:n,formula:i,ref:e,result:f(g,y)},m=!1):this.getCell(g,y).value=p?{sharedFormula:h,result:f(g,y)}:f(g,y)}addImage(e,i){let r={type:"image",imageId:e,range:i};this._media.push(new fZ(this,r))}getImages(){return this._media.filter(e=>e.type==="image")}addBackgroundImage(e){let i={type:"background",imageId:e};this._media.push(new fZ(this,i))}getBackgroundImageId(){let e=this._media.find(i=>i.type==="background");return e&&e.imageId}protect(e,i){return new Promise(r=>{this.sheetProtection={sheet:!0},i&&"spinCount"in i&&(i.spinCount=Number.isFinite(i.spinCount)?Math.round(Math.max(0,i.spinCount)):1e5),e&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=NRe.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=i&&"spinCount"in i?i.spinCount:1e5,this.sheetProtection.hashValue=NRe.convertPasswordToHash(e,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),i&&(this.sheetProtection=Object.assign(this.sheetProtection,i),!e&&"spinCount"in i&&delete this.sheetProtection.spinCount),r()})}unprotect(){this.sheetProtection=null}addTable(e){let i=new kRe(this,e);return this.tables[e.name]=i,i}getTable(e){return this.tables[e]}removeTable(e){delete this.tables[e]}getTables(){return Object.values(this.tables)}addConditionalFormatting(e){this.conditionalFormattings.push(e)}removeConditionalFormatting(e){typeof e=="number"?this.conditionalFormattings.splice(e,1):e instanceof Function?this.conditionalFormattings=this.conditionalFormattings.filter(e):this.conditionalFormattings=[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(e){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=e}get model(){let e={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(n=>n.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(n=>n.model),conditionalFormattings:this.conditionalFormattings};e.cols=P4.toModel(this.columns);let i=e.rows=[],r=e.dimensions=new ZO;return this._rows.forEach(n=>{let o=n&&n.model;o&&(r.expand(o.number,o.min,o.number,o.max),i.push(o))}),e.merges=[],XO.each(this._merges,n=>{e.merges.push(n.range)}),e}_parseRows(e){this._rows=[],e.rows.forEach(i=>{let r=new MRe(this,i.number);this._rows[r.number-1]=r,r.model=i})}_parseMergeCells(e){XO.each(e.mergeCells,i=>{this.mergeCellsWithoutStyle(i)})}set model(e){this.name=e.name,this._columns=P4.fromModel(this,e.cols),this._parseRows(e),this._parseMergeCells(e),this.dataValidations=new ORe(e.dataValidations),this.properties=e.properties,this.pageSetup=e.pageSetup,this.headerFooter=e.headerFooter,this.views=e.views,this.autoFilter=e.autoFilter,this._media=e.media.map(i=>new fZ(this,i)),this.sheetProtection=e.sheetProtection,this.tables=e.tables.reduce((i,r)=>{let n=new kRe;return n.model=r,i[r.name]=n,i},{}),this.conditionalFormattings=e.conditionalFormattings}};LRe.exports=pZ});var VRe=z((J$i,BRe)=>{"use strict";var HRe=Go(),L4=Oo(),mZ=class{constructor(e){this.template=e,this.sheets={}}addCell(e){this.addCellEx(L4.decodeEx(e))}getCell(e){return this.findCellEx(L4.decodeEx(e),!0)}findCell(e){return this.findCellEx(L4.decodeEx(e),!1)}findCellAt(e,i,r){let n=this.sheets[e],o=n&&n[i];return o&&o[r]}addCellEx(e){if(e.top)for(let i=e.top;i<=e.bottom;i++)for(let r=e.left;r<=e.right;r++)this.getCellAt(e.sheetName,i,r);else this.findCellEx(e,!0)}getCellEx(e){return this.findCellEx(e,!0)}findCellEx(e,i){let r=this.findSheet(e,i),n=this.findSheetRow(r,e,i);return this.findRowCell(n,e,i)}getCellAt(e,i,r){let n=this.sheets[e]||(this.sheets[e]=[]),o=n[i]||(n[i]=[]);return o[r]||(o[r]={sheetName:e,address:L4.n2l(r)+i,row:i,col:r})}removeCellEx(e){let i=this.findSheet(e);if(!i)return;let r=this.findSheetRow(i,e);r&&delete r[e.col]}forEachInSheet(e,i){let r=this.sheets[e];r&&r.forEach((n,o)=>{n&&n.forEach((s,a)=>{s&&i(s,o,a)})})}forEach(e){HRe.each(this.sheets,(i,r)=>{this.forEachInSheet(r,e)})}map(e){let i=[];return this.forEach(r=>{i.push(e(r))}),i}findSheet(e,i){let r=e.sheetName;if(this.sheets[r])return this.sheets[r];if(i)return this.sheets[r]=[]}findSheetRow(e,i,r){let{row:n}=i;if(e&&e[n])return e[n];if(r)return e[n]=[]}findRowCell(e,i,r){let{col:n}=i;if(e&&e[n])return e[n];if(r)return e[n]=this.template?Object.assign(i,JSON.parse(JSON.stringify(this.template))):i}spliceRows(e,i,r,n){let o=this.sheets[e];if(o){let s=[];for(let a=0;a<n;a++)s.push([]);o.splice(i,r,...s)}}spliceColumns(e,i,r,n){let o=this.sheets[e];if(o){let s=[];for(let a=0;a<n;a++)s.push(null);HRe.each(o,a=>{a.splice(i,r,...s)})}}};BRe.exports=mZ});var vZ=z((eGi,zRe)=>{"use strict";var aE=Go(),QO=Oo(),jRe=VRe(),ICt=Wm(),DCt=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/,gZ=class{constructor(){this.matrixMap={}}getMatrix(e){return this.matrixMap[e]||(this.matrixMap[e]=new jRe)}add(e,i){let r=QO.decodeEx(e);this.addEx(r,i)}addEx(e,i){let r=this.getMatrix(i);if(e.top)for(let n=e.left;n<=e.right;n++)for(let o=e.top;o<=e.bottom;o++){let s={sheetName:e.sheetName,address:QO.n2l(n)+o,row:o,col:n};r.addCellEx(s)}else r.addCellEx(e)}remove(e,i){let r=QO.decodeEx(e);this.removeEx(r,i)}removeEx(e,i){this.getMatrix(i).removeCellEx(e)}removeAllNames(e){aE.each(this.matrixMap,i=>{i.removeCellEx(e)})}forEach(e){aE.each(this.matrixMap,(i,r)=>{i.forEach(n=>{e(r,n)})})}getNames(e){return this.getNamesEx(QO.decodeEx(e))}getNamesEx(e){return aE.map(this.matrixMap,(i,r)=>i.findCellEx(e)&&r).filter(Boolean)}_explore(e,i){i.mark=!1;let{sheetName:r}=i,n=new ICt(i.row,i.col,i.row,i.col,r),o,s;function a(d,u){let h=e.findCellAt(r,d,i.col);return!h||!h.mark?!1:(n[u]=d,h.mark=!1,!0)}for(s=i.row-1;a(s,"top");s--);for(s=i.row+1;a(s,"bottom");s++);function c(d,u){let h=[];for(s=n.top;s<=n.bottom;s++){let p=e.findCellAt(r,s,d);if(p&&p.mark)h.push(p);else return!1}n[u]=d;for(let p=0;p<h.length;p++)h[p].mark=!1;return!0}for(o=i.col-1;c(o,"left");o--);for(o=i.col+1;c(o,"right");o++);return n}getRanges(e,i){if(i=i||this.matrixMap[e],!i)return{name:e,ranges:[]};i.forEach(n=>{n.mark=!0});let r=i.map(n=>n.mark&&this._explore(i,n)).filter(Boolean).map(n=>n.$shortRange);return{name:e,ranges:r}}normaliseMatrix(e,i){e.forEachInSheet(i,(r,n,o)=>{r&&(r.row!==n||r.col!==o)&&(r.row=n,r.col=o,r.address=QO.n2l(o)+n)})}spliceRows(e,i,r,n){aE.each(this.matrixMap,o=>{o.spliceRows(e,i,r,n),this.normaliseMatrix(o,e)})}spliceColumns(e,i,r,n){aE.each(this.matrixMap,o=>{o.spliceColumns(e,i,r,n),this.normaliseMatrix(o,e)})}get model(){return aE.map(this.matrixMap,(e,i)=>this.getRanges(i,e)).filter(e=>e.ranges.length)}set model(e){let i=this.matrixMap={};e.forEach(r=>{let n=i[r.name]=new jRe;r.ranges.forEach(o=>{DCt.test(o.split("!").pop()||"")&&n.addCell(o)})})}};zRe.exports=gZ});var hs=z((tGi,bZ)=>{"use strict";typeof process>"u"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?bZ.exports={nextTick:MCt}:bZ.exports=process;function MCt(t,e,i,r){if(typeof t!="function")throw new TypeError('"callback" argument must be a function');var n=arguments.length,o,s;switch(n){case 0:case 1:return process.nextTick(t);case 2:return process.nextTick(function(){t.call(null,e)});case 3:return process.nextTick(function(){t.call(null,e,i)});case 4:return process.nextTick(function(){t.call(null,e,i,r)});default:for(o=new Array(n-1),s=0;s<o.length;)o[s++]=arguments[s];return process.nextTick(function(){t.apply(null,o)})}}});var lE=z((iGi,WRe)=>{"use strict";var kCt={}.toString;WRe.exports=Array.isArray||function(t){return kCt.call(t)=="[object Array]"}});var _Z=z((rGi,URe)=>{"use strict";URe.exports=Ze("stream")});var JO=z((yZ,YRe)=>{"use strict";var F4=Ze("buffer"),Um=F4.Buffer;function qRe(t,e){for(var i in t)e[i]=t[i]}Um.from&&Um.alloc&&Um.allocUnsafe&&Um.allocUnsafeSlow?YRe.exports=F4:(qRe(F4,yZ),yZ.Buffer=cE);function cE(t,e,i){return Um(t,e,i)}qRe(Um,cE);cE.from=function(t,e,i){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Um(t,e,i)};cE.alloc=function(t,e,i){if(typeof t!="number")throw new TypeError("Argument must be a number");var r=Um(t);return e!==void 0?typeof i=="string"?r.fill(e,i):r.fill(e):r.fill(0),r};cE.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Um(t)};cE.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return F4.SlowBuffer(t)}});var Xn=z(vl=>{"use strict";function OCt(t){return Array.isArray?Array.isArray(t):H4(t)==="[object Array]"}vl.isArray=OCt;function NCt(t){return typeof t=="boolean"}vl.isBoolean=NCt;function PCt(t){return t===null}vl.isNull=PCt;function LCt(t){return t==null}vl.isNullOrUndefined=LCt;function FCt(t){return typeof t=="number"}vl.isNumber=FCt;function HCt(t){return typeof t=="string"}vl.isString=HCt;function BCt(t){return typeof t=="symbol"}vl.isSymbol=BCt;function VCt(t){return t===void 0}vl.isUndefined=VCt;function jCt(t){return H4(t)==="[object RegExp]"}vl.isRegExp=jCt;function zCt(t){return typeof t=="object"&&t!==null}vl.isObject=zCt;function WCt(t){return H4(t)==="[object Date]"}vl.isDate=WCt;function UCt(t){return H4(t)==="[object Error]"||t instanceof Error}vl.isError=UCt;function qCt(t){return typeof t=="function"}vl.isFunction=qCt;function YCt(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}vl.isPrimitive=YCt;vl.isBuffer=Ze("buffer").Buffer.isBuffer;function H4(t){return Object.prototype.toString.call(t)}});var $Re=z((oGi,wZ)=>{"use strict";typeof Object.create=="function"?wZ.exports=function(e,i){i&&(e.super_=i,e.prototype=Object.create(i.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:wZ.exports=function(e,i){if(i){e.super_=i;var r=function(){};r.prototype=i.prototype,e.prototype=new r,e.prototype.constructor=e}}});var Vi=z((sGi,xZ)=>{"use strict";try{if(CZ=Ze("util"),typeof CZ.inherits!="function")throw"";xZ.exports=CZ.inherits}catch{xZ.exports=$Re()}var CZ});var XRe=z((aGi,SZ)=>{"use strict";function $Ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var GRe=JO().Buffer,e2=Ze("util");function GCt(t,e,i){t.copy(e,i)}SZ.exports=function(){function t(){$Ct(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(i){var r={data:i,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length},t.prototype.unshift=function(i){var r={data:i,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length},t.prototype.shift=function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(i){if(this.length===0)return"";for(var r=this.head,n=""+r.data;r=r.next;)n+=i+r.data;return n},t.prototype.concat=function(i){if(this.length===0)return GRe.alloc(0);for(var r=GRe.allocUnsafe(i>>>0),n=this.head,o=0;n;)GCt(n.data,r,o),o+=n.data.length,n=n.next;return r},t}();e2&&e2.inspect&&e2.inspect.custom&&(SZ.exports.prototype[e2.inspect.custom]=function(){var t=e2.inspect({length:this.length});return this.constructor.name+" "+t})});var EZ=z((lGi,KRe)=>{"use strict";var B4=hs();function XCt(t,e){var i=this,r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,B4.nextTick(V4,this,t)):B4.nextTick(V4,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,B4.nextTick(V4,i,o)):B4.nextTick(V4,i,o):e&&e(o)}),this)}function KCt(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function V4(t,e){t.emit("error",e)}KRe.exports={destroy:XCt,undestroy:KCt}});var tw=z((cGi,ZRe)=>{"use strict";ZRe.exports=Ze("util").deprecate});var RZ=z((dGi,oAe)=>{"use strict";var iw=hs();oAe.exports=Es;function JRe(t){var e=this;this.next=null,this.entry=null,this.finish=function(){pxt(e,t)}}var ZCt=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:iw.nextTick,dE;Es.WritableState=i2;var eAe=Object.create(Xn());eAe.inherits=Vi();var QCt={deprecate:tw()},tAe=_Z(),z4=JO().Buffer,JCt=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function ext(t){return z4.from(t)}function txt(t){return z4.isBuffer(t)||t instanceof JCt}var iAe=EZ();eAe.inherits(Es,tAe);function ixt(){}function i2(t,e){dE=dE||rw(),t=t||{};var i=e instanceof dE;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,n=t.writableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=t.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){cxt(e,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new JRe(this)}i2.prototype.getBuffer=function(){for(var e=this.bufferedRequest,i=[];e;)i.push(e),e=e.next;return i};(function(){try{Object.defineProperty(i2.prototype,"buffer",{get:QCt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var j4;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(j4=Function.prototype[Symbol.hasInstance],Object.defineProperty(Es,Symbol.hasInstance,{value:function(t){return j4.call(this,t)?!0:this!==Es?!1:t&&t._writableState instanceof i2}})):j4=function(t){return t instanceof this};function Es(t){if(dE=dE||rw(),!j4.call(Es,this)&&!(this instanceof dE))return new Es(t);this._writableState=new i2(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),tAe.call(this)}Es.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function rxt(t,e){var i=new Error("write after end");t.emit("error",i),iw.nextTick(e,i)}function nxt(t,e,i,r){var n=!0,o=!1;return i===null?o=new TypeError("May not write null values to stream"):typeof i!="string"&&i!==void 0&&!e.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),iw.nextTick(r,o),n=!1),n}Es.prototype.write=function(t,e,i){var r=this._writableState,n=!1,o=!r.objectMode&&txt(t);return o&&!z4.isBuffer(t)&&(t=ext(t)),typeof e=="function"&&(i=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),typeof i!="function"&&(i=ixt),r.ended?rxt(this,i):(o||nxt(this,r,t,i))&&(r.pendingcb++,n=sxt(this,r,o,t,e,i)),n};Es.prototype.cork=function(){var t=this._writableState;t.corked++};Es.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&rAe(this,t))};Es.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function oxt(t,e,i){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=z4.from(e,i)),e}Object.defineProperty(Es.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function sxt(t,e,i,r,n,o){if(!i){var s=oxt(e,r,n);r!==s&&(i=!0,n="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var d=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:o,next:null},d?d.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else TZ(t,e,!1,a,r,n,o);return c}function TZ(t,e,i,r,n,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,i?t._writev(n,e.onwrite):t._write(n,o,e.onwrite),e.sync=!1}function axt(t,e,i,r,n){--e.pendingcb,i?(iw.nextTick(n,r),iw.nextTick(t2,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(n(r),t._writableState.errorEmitted=!0,t.emit("error",r),t2(t,e))}function lxt(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function cxt(t,e){var i=t._writableState,r=i.sync,n=i.writecb;if(lxt(i),e)axt(t,i,r,e,n);else{var o=nAe(i);!o&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest&&rAe(t,i),r?ZCt(QRe,t,i,o,n):QRe(t,i,o,n)}}function QRe(t,e,i,r){i||dxt(t,e),e.pendingcb--,r(),t2(t,e)}function dxt(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function rAe(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,n=new Array(r),o=e.corkedRequestsFree;o.entry=i;for(var s=0,a=!0;i;)n[s]=i,i.isBuf||(a=!1),i=i.next,s+=1;n.allBuffers=a,TZ(t,e,!0,e.length,n,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new JRe(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,d=i.encoding,u=i.callback,h=e.objectMode?1:c.length;if(TZ(t,e,!1,h,c,d,u),i=i.next,e.bufferedRequestCount--,e.writing)break}i===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}Es.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))};Es.prototype._writev=null;Es.prototype.end=function(t,e,i){var r=this._writableState;typeof t=="function"?(i=t,t=null,e=null):typeof e=="function"&&(i=e,e=null),t!=null&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||fxt(this,r,i)};function nAe(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function uxt(t,e){t._final(function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),t2(t,e)})}function hxt(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,iw.nextTick(uxt,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function t2(t,e){var i=nAe(e);return i&&(hxt(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),i}function fxt(t,e,i){e.ending=!0,t2(t,e),i&&(e.finished?iw.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}function pxt(t,e,i){var r=t.entry;for(t.entry=null;r;){var n=r.callback;e.pendingcb--,n(i),r=r.next}e.corkedRequestsFree.next=t}Object.defineProperty(Es.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}});Es.prototype.destroy=iAe.destroy;Es.prototype._undestroy=iAe.undestroy;Es.prototype._destroy=function(t,e){this.end(),e(t)}});var rw=z((uGi,cAe)=>{"use strict";var sAe=hs(),mxt=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};cAe.exports=qm;var aAe=Object.create(Xn());aAe.inherits=Vi();var lAe=DZ(),IZ=RZ();aAe.inherits(qm,lAe);for(AZ=mxt(IZ.prototype),W4=0;W4<AZ.length;W4++)U4=AZ[W4],qm.prototype[U4]||(qm.prototype[U4]=IZ.prototype[U4]);var AZ,U4,W4;function qm(t){if(!(this instanceof qm))return new qm(t);lAe.call(this,t),IZ.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",gxt)}Object.defineProperty(qm.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function gxt(){this.allowHalfOpen||this._writableState.ended||sAe.nextTick(vxt,this)}function vxt(t){t.end()}Object.defineProperty(qm.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});qm.prototype._destroy=function(t,e){this.push(null),this.end(),sAe.nextTick(e,t)}});var OZ=z(uAe=>{"use strict";var kZ=JO().Buffer,dAe=kZ.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function bxt(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function _xt(t){var e=bxt(t);if(typeof e!="string"&&(kZ.isEncoding===dAe||!dAe(t)))throw new Error("Unknown encoding: "+t);return e||t}uAe.StringDecoder=r2;function r2(t){this.encoding=_xt(t);var e;switch(this.encoding){case"utf16le":this.text=Ext,this.end=Txt,e=4;break;case"utf8":this.fillLast=Cxt,e=4;break;case"base64":this.text=Rxt,this.end=Axt,e=3;break;default:this.write=Ixt,this.end=Dxt;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=kZ.allocUnsafe(e)}r2.prototype.write=function(t){if(t.length===0)return"";var e,i;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""};r2.prototype.end=Sxt;r2.prototype.text=xxt;r2.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function MZ(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function yxt(t,e,i){var r=e.length-1;if(r<i)return 0;var n=MZ(e[r]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--r<i||n===-2?0:(n=MZ(e[r]),n>=0?(n>0&&(t.lastNeed=n-2),n):--r<i||n===-2?0:(n=MZ(e[r]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function wxt(t,e,i){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function Cxt(t){var e=this.lastTotal-this.lastNeed,i=wxt(this,t,e);if(i!==void 0)return i;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function xxt(t,e){var i=yxt(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var r=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function Sxt(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function Ext(t,e){if((t.length-e)%2===0){var i=t.toString("utf16le",e);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function Txt(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function Rxt(t,e){var i=(t.length-e)%3;return i===0?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,i===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function Axt(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Ixt(t){return t.toString(this.encoding)}function Dxt(t){return t&&t.length?this.write(t):""}});var DZ=z((pGi,xAe)=>{"use strict";var hE=hs();xAe.exports=no;var Mxt=lE(),n2;no.ReadableState=bAe;var fGi=Ze("events").EventEmitter,mAe=function(t,e){return t.listeners(e).length},HZ=_Z(),o2=JO().Buffer,kxt=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Oxt(t){return o2.from(t)}function Nxt(t){return o2.isBuffer(t)||t instanceof kxt}var gAe=Object.create(Xn());gAe.inherits=Vi();var NZ=Ze("util"),Kr=void 0;NZ&&NZ.debuglog?Kr=NZ.debuglog("stream"):Kr=function(){};var Pxt=XRe(),vAe=EZ(),uE;gAe.inherits(no,HZ);var PZ=["error","close","destroy","pause","resume"];function Lxt(t,e,i){if(typeof t.prependListener=="function")return t.prependListener(e,i);!t._events||!t._events[e]?t.on(e,i):Mxt(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]}function bAe(t,e){n2=n2||rw(),t=t||{};var i=e instanceof n2;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,n=t.readableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new Pxt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(uE||(uE=OZ().StringDecoder),this.decoder=new uE(t.encoding),this.encoding=t.encoding)}function no(t){if(n2=n2||rw(),!(this instanceof no))return new no(t);this._readableState=new bAe(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),HZ.call(this)}Object.defineProperty(no.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}});no.prototype.destroy=vAe.destroy;no.prototype._undestroy=vAe.undestroy;no.prototype._destroy=function(t,e){this.push(null),e(t)};no.prototype.push=function(t,e){var i=this._readableState,r;return i.objectMode?r=!0:typeof t=="string"&&(e=e||i.defaultEncoding,e!==i.encoding&&(t=o2.from(t,e),e=""),r=!0),_Ae(this,t,e,!1,r)};no.prototype.unshift=function(t){return _Ae(this,t,null,!0,!1)};function _Ae(t,e,i,r,n){var o=t._readableState;if(e===null)o.reading=!1,Vxt(t,o);else{var s;n||(s=Fxt(o,e)),s?t.emit("error",s):o.objectMode||e&&e.length>0?(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==o2.prototype&&(e=Oxt(e)),r?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):LZ(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||e.length!==0?LZ(t,o,e,!1):yAe(t,o)):LZ(t,o,e,!1))):r||(o.reading=!1)}return Hxt(o)}function LZ(t,e,i,r){e.flowing&&e.length===0&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,r?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&q4(t)),yAe(t,e)}function Fxt(t,e){var i;return!Nxt(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(i=new TypeError("Invalid non-string/buffer chunk")),i}function Hxt(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}no.prototype.isPaused=function(){return this._readableState.flowing===!1};no.prototype.setEncoding=function(t){return uE||(uE=OZ().StringDecoder),this._readableState.decoder=new uE(t),this._readableState.encoding=t,this};var hAe=8388608;function Bxt(t){return t>=hAe?t=hAe:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function fAe(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=Bxt(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}no.prototype.read=function(t){Kr("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Kr("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?FZ(this):q4(this),null;if(t=fAe(t,e),t===0&&e.ended)return e.length===0&&FZ(this),null;var r=e.needReadable;Kr("need readable",r),(e.length===0||e.length-t<e.highWaterMark)&&(r=!0,Kr("length less than watermark",r)),e.ended||e.reading?(r=!1,Kr("reading or ended",r)):r&&(Kr("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=fAe(i,e)));var n;return t>0?n=wAe(t,e):n=null,n===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&FZ(this)),n!==null&&this.emit("data",n),n};function Vxt(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,q4(t)}}function q4(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(Kr("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?hE.nextTick(pAe,t):pAe(t))}function pAe(t){Kr("emit readable"),t.emit("readable"),BZ(t)}function yAe(t,e){e.readingMore||(e.readingMore=!0,hE.nextTick(jxt,t,e))}function jxt(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Kr("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}no.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};no.prototype.pipe=function(t,e){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1,Kr("pipe count=%d opts=%j",r.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=n?a:y;r.endEmitted?hE.nextTick(o):i.once("end",o),t.on("unpipe",s);function s(w,x){Kr("onunpipe"),w===i&&x&&x.hasUnpiped===!1&&(x.hasUnpiped=!0,u())}function a(){Kr("onend"),t.end()}var c=zxt(i);t.on("drain",c);var d=!1;function u(){Kr("cleanup"),t.removeListener("close",m),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",f),t.removeListener("unpipe",s),i.removeListener("end",a),i.removeListener("end",y),i.removeListener("data",p),d=!0,r.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}var h=!1;i.on("data",p);function p(w){Kr("ondata"),h=!1;var x=t.write(w);x===!1&&!h&&((r.pipesCount===1&&r.pipes===t||r.pipesCount>1&&CAe(r.pipes,t)!==-1)&&!d&&(Kr("false write response, pause",r.awaitDrain),r.awaitDrain++,h=!0),i.pause())}function f(w){Kr("onerror",w),y(),t.removeListener("error",f),mAe(t,"error")===0&&t.emit("error",w)}Lxt(t,"error",f);function m(){t.removeListener("finish",g),y()}t.once("close",m);function g(){Kr("onfinish"),t.removeListener("close",m),y()}t.once("finish",g);function y(){Kr("unpipe"),i.unpipe(t)}return t.emit("pipe",i),r.flowing||(Kr("pipe resume"),i.resume()),t};function zxt(t){return function(){var e=t._readableState;Kr("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&mAe(t,"data")&&(e.flowing=!0,BZ(t))}}no.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<n;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=CAe(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i),this)};no.prototype.on=function(t,e){var i=HZ.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var r=this._readableState;!r.endEmitted&&!r.readableListening&&(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&q4(this):hE.nextTick(Wxt,this))}return i};no.prototype.addListener=no.prototype.on;function Wxt(t){Kr("readable nexttick read 0"),t.read(0)}no.prototype.resume=function(){var t=this._readableState;return t.flowing||(Kr("resume"),t.flowing=!0,Uxt(this,t)),this};function Uxt(t,e){e.resumeScheduled||(e.resumeScheduled=!0,hE.nextTick(qxt,t,e))}function qxt(t,e){e.reading||(Kr("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),BZ(t),e.flowing&&!e.reading&&t.read(0)}no.prototype.pause=function(){return Kr("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Kr("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function BZ(t){var e=t._readableState;for(Kr("flow",e.flowing);e.flowing&&t.read()!==null;);}no.prototype.wrap=function(t){var e=this,i=this._readableState,r=!1;t.on("end",function(){if(Kr("wrapped end"),i.decoder&&!i.ended){var s=i.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(Kr("wrapped data"),i.decoder&&(s=i.decoder.write(s)),!(i.objectMode&&s==null)&&!(!i.objectMode&&(!s||!s.length))){var a=e.push(s);a||(r=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(s){return function(){return t[s].apply(t,arguments)}}(n));for(var o=0;o<PZ.length;o++)t.on(PZ[o],this.emit.bind(this,PZ[o]));return this._read=function(s){Kr("wrapped _read",s),r&&(r=!1,t.resume())},this};Object.defineProperty(no.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});no._fromList=wAe;function wAe(t,e){if(e.length===0)return null;var i;return e.objectMode?i=e.buffer.shift():!t||t>=e.length?(e.decoder?i=e.buffer.join(""):e.buffer.length===1?i=e.buffer.head.data:i=e.buffer.concat(e.length),e.buffer.clear()):i=Yxt(t,e.buffer,e.decoder),i}function Yxt(t,e,i){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?r=e.shift():r=i?$xt(t,e):Gxt(t,e),r}function $xt(t,e){var i=e.head,r=1,n=i.data;for(t-=n.length;i=i.next;){var o=i.data,s=t>o.length?o.length:t;if(s===o.length?n+=o:n+=o.slice(0,t),t-=s,t===0){s===o.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=o.slice(s));break}++r}return e.length-=r,n}function Gxt(t,e){var i=o2.allocUnsafe(t),r=e.head,n=1;for(r.data.copy(i),t-=r.data.length;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,s),t-=s,t===0){s===o.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++n}return e.length-=n,i}function FZ(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,hE.nextTick(Xxt,e,t))}function Xxt(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function CAe(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}});var VZ=z((mGi,TAe)=>{"use strict";TAe.exports=Ym;var Y4=rw(),EAe=Object.create(Xn());EAe.inherits=Vi();EAe.inherits(Ym,Y4);function Kxt(t,e){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,e!=null&&this.push(e),r(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function Ym(t){if(!(this instanceof Ym))return new Ym(t);Y4.call(this,t),this._transformState={afterTransform:Kxt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",Zxt)}function Zxt(){var t=this;typeof this._flush=="function"?this._flush(function(e,i){SAe(t,e,i)}):SAe(this,null,null)}Ym.prototype.push=function(t,e){return this._transformState.needTransform=!1,Y4.prototype.push.call(this,t,e)};Ym.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")};Ym.prototype._write=function(t,e,i){var r=this._transformState;if(r.writecb=i,r.writechunk=t,r.writeencoding=e,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};Ym.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Ym.prototype._destroy=function(t,e){var i=this;Y4.prototype._destroy.call(this,t,function(r){e(r),i.emit("close")})};function SAe(t,e,i){if(e)return t.emit("error",e);if(i!=null&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var DAe=z((gGi,IAe)=>{"use strict";IAe.exports=s2;var RAe=VZ(),AAe=Object.create(Xn());AAe.inherits=Vi();AAe.inherits(s2,RAe);function s2(t){if(!(this instanceof s2))return new s2(t);RAe.call(this,t)}s2.prototype._transform=function(t,e,i){i(null,t)}});var jZ=z((La,$4)=>{"use strict";var lp=Ze("stream");process.env.READABLE_STREAM==="disable"&&lp?($4.exports=lp,La=$4.exports=lp.Readable,La.Readable=lp.Readable,La.Writable=lp.Writable,La.Duplex=lp.Duplex,La.Transform=lp.Transform,La.PassThrough=lp.PassThrough,La.Stream=lp):(La=$4.exports=DZ(),La.Stream=lp||La,La.Readable=La,La.Writable=RZ(),La.Duplex=rw(),La.Transform=VZ(),La.PassThrough=DAe())});var $m=z(yd=>{"use strict";yd.base64=!0;yd.array=!0;yd.string=!0;yd.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u";yd.nodebuffer=typeof Buffer<"u";yd.uint8array=typeof Uint8Array<"u";if(typeof ArrayBuffer>"u")yd.blob=!1;else{zZ=new ArrayBuffer(0);try{yd.blob=new Blob([zZ],{type:"application/zip"}).size===0}catch{try{MAe=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,WZ=new MAe,WZ.append(zZ),yd.blob=WZ.getBlob("application/zip").size===0}catch{yd.blob=!1}}}var zZ,MAe,WZ;try{yd.nodestream=!!jZ().Readable}catch{yd.nodestream=!1}});var qZ=z(UZ=>{"use strict";var Qxt=No(),Jxt=$m(),cp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";UZ.encode=function(t){for(var e=[],i,r,n,o,s,a,c,d=0,u=t.length,h=u,p=Qxt.getTypeOf(t)!=="string";d<t.length;)h=u-d,p?(i=t[d++],r=d<u?t[d++]:0,n=d<u?t[d++]:0):(i=t.charCodeAt(d++),r=d<u?t.charCodeAt(d++):0,n=d<u?t.charCodeAt(d++):0),o=i>>2,s=(i&3)<<4|r>>4,a=h>1?(r&15)<<2|n>>6:64,c=h>2?n&63:64,e.push(cp.charAt(o)+cp.charAt(s)+cp.charAt(a)+cp.charAt(c));return e.join("")};UZ.decode=function(t){var e,i,r,n,o,s,a,c=0,d=0,u="data:";if(t.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");t=t.replace(/[^A-Za-z0-9+/=]/g,"");var h=t.length*3/4;if(t.charAt(t.length-1)===cp.charAt(64)&&h--,t.charAt(t.length-2)===cp.charAt(64)&&h--,h%1!==0)throw new Error("Invalid base64 input, bad content length.");var p;for(Jxt.uint8array?p=new Uint8Array(h|0):p=new Array(h|0);c<t.length;)n=cp.indexOf(t.charAt(c++)),o=cp.indexOf(t.charAt(c++)),s=cp.indexOf(t.charAt(c++)),a=cp.indexOf(t.charAt(c++)),e=n<<2|o>>4,i=(o&15)<<4|s>>2,r=(s&3)<<6|a,p[d++]=e,s!==64&&(p[d++]=i),a!==64&&(p[d++]=r);return p}});var a2=z((_Gi,kAe)=>{"use strict";kAe.exports={isNode:typeof Buffer<"u",newBufferFrom:function(t,e){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,e);if(typeof t=="number")throw new Error('The "data" argument must not be a number');return new Buffer(t,e)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var e=new Buffer(t);return e.fill(0),e},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&typeof t.on=="function"&&typeof t.pause=="function"&&typeof t.resume=="function"}}});var LAe=z((yGi,PAe)=>{"use strict";var OAe=global.MutationObserver||global.WebKitMutationObserver,fE;process.browser?OAe?(YZ=0,NAe=new OAe(l2),$Z=global.document.createTextNode(""),NAe.observe($Z,{characterData:!0}),fE=function(){$Z.data=YZ=++YZ%2}):!global.setImmediate&&typeof global.MessageChannel<"u"?(GZ=new global.MessageChannel,GZ.port1.onmessage=l2,fE=function(){GZ.port2.postMessage(0)}):"document"in global&&"onreadystatechange"in global.document.createElement("script")?fE=function(){var t=global.document.createElement("script");t.onreadystatechange=function(){l2(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},global.document.documentElement.appendChild(t)}:fE=function(){setTimeout(l2,0)}:fE=function(){process.nextTick(l2)};var YZ,NAe,$Z,GZ,XZ,c2=[];function l2(){XZ=!0;for(var t,e,i=c2.length;i;){for(e=c2,c2=[],t=-1;++t<i;)e[t]();i=c2.length}XZ=!1}PAe.exports=e1t;function e1t(t){c2.push(t)===1&&!XZ&&fE()}});var WAe=z((wGi,zAe)=>{"use strict";var FAe=LAe();function pE(){}var bl={},HAe=["REJECTED"],KZ=["FULFILLED"],BAe=["PENDING"];process.browser||(d2=["UNHANDLED"]);var d2;zAe.exports=Vb;function Vb(t){if(typeof t!="function")throw new TypeError("resolver must be a function");this.state=BAe,this.queue=[],this.outcome=void 0,process.browser||(this.handled=d2),t!==pE&&VAe(this,t)}Vb.prototype.finally=function(t){if(typeof t!="function")return this;var e=this.constructor;return this.then(i,r);function i(n){function o(){return n}return e.resolve(t()).then(o)}function r(n){function o(){throw n}return e.resolve(t()).then(o)}};Vb.prototype.catch=function(t){return this.then(null,t)};Vb.prototype.then=function(t,e){if(typeof t!="function"&&this.state===KZ||typeof e!="function"&&this.state===HAe)return this;var i=new this.constructor(pE);if(process.browser||this.handled===d2&&(this.handled=null),this.state!==BAe){var r=this.state===KZ?t:e;ZZ(i,r,this.outcome)}else this.queue.push(new u2(i,t,e));return i};function u2(t,e,i){this.promise=t,typeof e=="function"&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),typeof i=="function"&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}u2.prototype.callFulfilled=function(t){bl.resolve(this.promise,t)};u2.prototype.otherCallFulfilled=function(t){ZZ(this.promise,this.onFulfilled,t)};u2.prototype.callRejected=function(t){bl.reject(this.promise,t)};u2.prototype.otherCallRejected=function(t){ZZ(this.promise,this.onRejected,t)};function ZZ(t,e,i){FAe(function(){var r;try{r=e(i)}catch(n){return bl.reject(t,n)}r===t?bl.reject(t,new TypeError("Cannot resolve promise with itself")):bl.resolve(t,r)})}bl.resolve=function(t,e){var i=jAe(t1t,e);if(i.status==="error")return bl.reject(t,i.value);var r=i.value;if(r)VAe(t,r);else{t.state=KZ,t.outcome=e;for(var n=-1,o=t.queue.length;++n<o;)t.queue[n].callFulfilled(e)}return t};bl.reject=function(t,e){t.state=HAe,t.outcome=e,process.browser||t.handled===d2&&FAe(function(){t.handled===d2&&process.emit("unhandledRejection",e,t)});for(var i=-1,r=t.queue.length;++i<r;)t.queue[i].callRejected(e);return t};function t1t(t){var e=t&&t.then;if(t&&(typeof t=="object"||typeof t=="function")&&typeof e=="function")return function(){e.apply(t,arguments)}}function VAe(t,e){var i=!1;function r(a){i||(i=!0,bl.reject(t,a))}function n(a){i||(i=!0,bl.resolve(t,a))}function o(){e(n,r)}var s=jAe(o);s.status==="error"&&r(s.value)}function jAe(t,e){var i={};try{i.value=t(e),i.status="success"}catch(r){i.status="error",i.value=r}return i}Vb.resolve=i1t;function i1t(t){return t instanceof this?t:bl.resolve(new this(pE),t)}Vb.reject=r1t;function r1t(t){var e=new this(pE);return bl.reject(e,t)}Vb.all=n1t;function n1t(t){var e=this;if(Object.prototype.toString.call(t)!=="[object Array]")return this.reject(new TypeError("must be an array"));var i=t.length,r=!1;if(!i)return this.resolve([]);for(var n=new Array(i),o=0,s=-1,a=new this(pE);++s<i;)c(t[s],s);return a;function c(d,u){e.resolve(d).then(h,function(p){r||(r=!0,bl.reject(a,p))});function h(p){n[u]=p,++o===i&&!r&&(r=!0,bl.resolve(a,n))}}}Vb.race=o1t;function o1t(t){var e=this;if(Object.prototype.toString.call(t)!=="[object Array]")return this.reject(new TypeError("must be an array"));var i=t.length,r=!1;if(!i)return this.resolve([]);for(var n=-1,o=new this(pE);++n<i;)s(t[n]);return o;function s(a){e.resolve(a).then(function(c){r||(r=!0,bl.resolve(o,c))},function(c){r||(r=!0,bl.reject(o,c))})}}});var mE=z((CGi,UAe)=>{"use strict";var QZ=null;typeof Promise<"u"?QZ=Promise:QZ=WAe();UAe.exports={Promise:QZ}});var JZ=z(qAe=>{"use strict";(function(t,e){"use strict";if(t.setImmediate)return;var i=1,r={},n=!1,o=t.document,s;function a(x){typeof x!="function"&&(x=new Function(""+x));for(var T=new Array(arguments.length-1),M=0;M<T.length;M++)T[M]=arguments[M+1];var B={callback:x,args:T};return r[i]=B,s(i),i++}function c(x){delete r[x]}function d(x){var T=x.callback,M=x.args;switch(M.length){case 0:T();break;case 1:T(M[0]);break;case 2:T(M[0],M[1]);break;case 3:T(M[0],M[1],M[2]);break;default:T.apply(e,M);break}}function u(x){if(n)setTimeout(u,0,x);else{var T=r[x];if(T){n=!0;try{d(T)}finally{c(x),n=!1}}}}function h(){s=function(x){process.nextTick(function(){u(x)})}}function p(){if(t.postMessage&&!t.importScripts){var x=!0,T=t.onmessage;return t.onmessage=function(){x=!1},t.postMessage("","*"),t.onmessage=T,x}}function f(){var x="setImmediate$"+Math.random()+"$",T=function(M){M.source===t&&typeof M.data=="string"&&M.data.indexOf(x)===0&&u(+M.data.slice(x.length))};t.addEventListener?t.addEventListener("message",T,!1):t.attachEvent("onmessage",T),s=function(M){t.postMessage(x+M,"*")}}function m(){var x=new MessageChannel;x.port1.onmessage=function(T){var M=T.data;u(M)},s=function(T){x.port2.postMessage(T)}}function g(){var x=o.documentElement;s=function(T){var M=o.createElement("script");M.onreadystatechange=function(){u(T),M.onreadystatechange=null,x.removeChild(M),M=null},x.appendChild(M)}}function y(){s=function(x){setTimeout(u,0,x)}}var w=Object.getPrototypeOf&&Object.getPrototypeOf(t);w=w&&w.setTimeout?w:t,{}.toString.call(t.process)==="[object process]"?h():p()?f():t.MessageChannel?m():o&&"onreadystatechange"in o.createElement("script")?g():y(),w.setImmediate=a,w.clearImmediate=c})(typeof self>"u"?typeof global>"u"?qAe:global:self)});var No=z(Ts=>{"use strict";var jb=$m(),s1t=qZ(),gE=a2(),eQ=mE();JZ();function a1t(t){var e=null;return jb.uint8array?e=new Uint8Array(t.length):e=new Array(t.length),X4(t,e)}Ts.newBlob=function(t,e){Ts.checkSupport("blob");try{return new Blob([t],{type:e})}catch{try{var i=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,r=new i;return r.append(t),r.getBlob(e)}catch{throw new Error("Bug : can't construct the Blob.")}}};function h2(t){return t}function X4(t,e){for(var i=0;i<t.length;++i)e[i]=t.charCodeAt(i)&255;return e}var G4={stringifyByChunk:function(t,e,i){var r=[],n=0,o=t.length;if(o<=i)return String.fromCharCode.apply(null,t);for(;n<o;)e==="array"||e==="nodebuffer"?r.push(String.fromCharCode.apply(null,t.slice(n,Math.min(n+i,o)))):r.push(String.fromCharCode.apply(null,t.subarray(n,Math.min(n+i,o)))),n+=i;return r.join("")},stringifyByChar:function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e},applyCanBeUsed:{uint8array:function(){try{return jb.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return jb.nodebuffer&&String.fromCharCode.apply(null,gE.allocBuffer(1)).length===1}catch{return!1}}()}};function f2(t){var e=65536,i=Ts.getTypeOf(t),r=!0;if(i==="uint8array"?r=G4.applyCanBeUsed.uint8array:i==="nodebuffer"&&(r=G4.applyCanBeUsed.nodebuffer),r)for(;e>1;)try{return G4.stringifyByChunk(t,i,e)}catch{e=Math.floor(e/2)}return G4.stringifyByChar(t)}Ts.applyFromCharCode=f2;function K4(t,e){for(var i=0;i<t.length;i++)e[i]=t[i];return e}var zb={};zb.string={string:h2,array:function(t){return X4(t,new Array(t.length))},arraybuffer:function(t){return zb.string.uint8array(t).buffer},uint8array:function(t){return X4(t,new Uint8Array(t.length))},nodebuffer:function(t){return X4(t,gE.allocBuffer(t.length))}};zb.array={string:f2,array:h2,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return gE.newBufferFrom(t)}};zb.arraybuffer={string:function(t){return f2(new Uint8Array(t))},array:function(t){return K4(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:h2,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return gE.newBufferFrom(new Uint8Array(t))}};zb.uint8array={string:f2,array:function(t){return K4(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:h2,nodebuffer:function(t){return gE.newBufferFrom(t)}};zb.nodebuffer={string:f2,array:function(t){return K4(t,new Array(t.length))},arraybuffer:function(t){return zb.nodebuffer.uint8array(t).buffer},uint8array:function(t){return K4(t,new Uint8Array(t.length))},nodebuffer:h2};Ts.transformTo=function(t,e){if(e||(e=""),!t)return e;Ts.checkSupport(t);var i=Ts.getTypeOf(e),r=zb[i][t](e);return r};Ts.resolve=function(t){for(var e=t.split("/"),i=[],r=0;r<e.length;r++){var n=e[r];n==="."||n===""&&r!==0&&r!==e.length-1||(n===".."?i.pop():i.push(n))}return i.join("/")};Ts.getTypeOf=function(t){if(typeof t=="string")return"string";if(Object.prototype.toString.call(t)==="[object Array]")return"array";if(jb.nodebuffer&&gE.isBuffer(t))return"nodebuffer";if(jb.uint8array&&t instanceof Uint8Array)return"uint8array";if(jb.arraybuffer&&t instanceof ArrayBuffer)return"arraybuffer"};Ts.checkSupport=function(t){var e=jb[t.toLowerCase()];if(!e)throw new Error(t+" is not supported by this platform")};Ts.MAX_VALUE_16BITS=65535;Ts.MAX_VALUE_32BITS=-1;Ts.pretty=function(t){var e="",i,r;for(r=0;r<(t||"").length;r++)i=t.charCodeAt(r),e+="\\x"+(i<16?"0":"")+i.toString(16).toUpperCase();return e};Ts.delay=function(t,e,i){setImmediate(function(){t.apply(i||null,e||[])})};Ts.inherits=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i};Ts.extend=function(){var t={},e,i;for(e=0;e<arguments.length;e++)for(i in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],i)&&typeof t[i]>"u"&&(t[i]=arguments[e][i]);return t};Ts.prepareContent=function(t,e,i,r,n){var o=eQ.Promise.resolve(e).then(function(s){var a=jb.blob&&(s instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(s))!==-1);return a&&typeof FileReader<"u"?new eQ.Promise(function(c,d){var u=new FileReader;u.onload=function(h){c(h.target.result)},u.onerror=function(h){d(h.target.error)},u.readAsArrayBuffer(s)}):s});return o.then(function(s){var a=Ts.getTypeOf(s);return a?(a==="arraybuffer"?s=Ts.transformTo("uint8array",s):a==="string"&&(n?s=s1t.decode(s):i&&r!==!0&&(s=a1t(s))),s):eQ.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}});var wd=z((EGi,$Ae)=>{"use strict";function YAe(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}YAe.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return this.isFinished?!1:(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var i=0;i<this._listeners[t].length;i++)this._listeners[t][i].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",function(i){e.processChunk(i)}),t.on("end",function(){e.end()}),t.on("error",function(i){e.error(i)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}};$Ae.exports=YAe});var bE=z(Wb=>{"use strict";var vE=No(),nw=$m(),l1t=a2(),Z4=wd(),p2=new Array(256);for(Gm=0;Gm<256;Gm++)p2[Gm]=Gm>=252?6:Gm>=248?5:Gm>=240?4:Gm>=224?3:Gm>=192?2:1;var Gm;p2[254]=p2[254]=1;var c1t=function(t){var e,i,r,n,o,s=t.length,a=0;for(n=0;n<s;n++)i=t.charCodeAt(n),(i&64512)===55296&&n+1<s&&(r=t.charCodeAt(n+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),n++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(nw.uint8array?e=new Uint8Array(a):e=new Array(a),o=0,n=0;o<a;n++)i=t.charCodeAt(n),(i&64512)===55296&&n+1<s&&(r=t.charCodeAt(n+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),n++)),i<128?e[o++]=i:i<2048?(e[o++]=192|i>>>6,e[o++]=128|i&63):i<65536?(e[o++]=224|i>>>12,e[o++]=128|i>>>6&63,e[o++]=128|i&63):(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63,e[o++]=128|i>>>6&63,e[o++]=128|i&63);return e},d1t=function(t,e){var i;for(e=e||t.length,e>t.length&&(e=t.length),i=e-1;i>=0&&(t[i]&192)===128;)i--;return i<0||i===0?e:i+p2[t[i]]>e?i:e},u1t=function(t){var e,i,r,n,o=t.length,s=new Array(o*2);for(i=0,e=0;e<o;){if(r=t[e++],r<128){s[i++]=r;continue}if(n=p2[r],n>4){s[i++]=65533,e+=n-1;continue}for(r&=n===2?31:n===3?15:7;n>1&&e<o;)r=r<<6|t[e++]&63,n--;if(n>1){s[i++]=65533;continue}r<65536?s[i++]=r:(r-=65536,s[i++]=55296|r>>10&1023,s[i++]=56320|r&1023)}return s.length!==i&&(s.subarray?s=s.subarray(0,i):s.length=i),vE.applyFromCharCode(s)};Wb.utf8encode=function(e){return nw.nodebuffer?l1t.newBufferFrom(e,"utf-8"):c1t(e)};Wb.utf8decode=function(e){return nw.nodebuffer?vE.transformTo("nodebuffer",e).toString("utf-8"):(e=vE.transformTo(nw.uint8array?"uint8array":"array",e),u1t(e))};function Q4(){Z4.call(this,"utf-8 decode"),this.leftOver=null}vE.inherits(Q4,Z4);Q4.prototype.processChunk=function(t){var e=vE.transformTo(nw.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(nw.uint8array){var i=e;e=new Uint8Array(i.length+this.leftOver.length),e.set(this.leftOver,0),e.set(i,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var r=d1t(e),n=e;r!==e.length&&(nw.uint8array?(n=e.subarray(0,r),this.leftOver=e.subarray(r,e.length)):(n=e.slice(0,r),this.leftOver=e.slice(r,e.length))),this.push({data:Wb.utf8decode(n),meta:t.meta})};Q4.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:Wb.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)};Wb.Utf8DecodeWorker=Q4;function tQ(){Z4.call(this,"utf-8 encode")}vE.inherits(tQ,Z4);tQ.prototype.processChunk=function(t){this.push({data:Wb.utf8encode(t.data),meta:t.meta})};Wb.Utf8EncodeWorker=tQ});var ZAe=z((RGi,KAe)=>{"use strict";var GAe=wd(),XAe=No();function iQ(t){GAe.call(this,"ConvertWorker to "+t),this.destType=t}XAe.inherits(iQ,GAe);iQ.prototype.processChunk=function(t){this.push({data:XAe.transformTo(this.destType,t.data),meta:t.meta})};KAe.exports=iQ});var eIe=z((AGi,JAe)=>{"use strict";var QAe=jZ().Readable,h1t=No();h1t.inherits(rQ,QAe);function rQ(t,e,i){QAe.call(this,e),this._helper=t;var r=this;t.on("data",function(n,o){r.push(n)||r._helper.pause(),i&&i(o)}).on("error",function(n){r.emit("error",n)}).on("end",function(){r.push(null)})}rQ.prototype._read=function(){this._helper.resume()};JAe.exports=rQ});var nQ=z((IGi,rIe)=>{"use strict";var ow=No(),f1t=ZAe(),p1t=wd(),m1t=qZ(),g1t=$m(),v1t=mE(),tIe=null;if(g1t.nodestream)try{tIe=eIe()}catch{}function b1t(t,e,i){switch(t){case"blob":return ow.newBlob(ow.transformTo("arraybuffer",e),i);case"base64":return m1t.encode(e);default:return ow.transformTo(t,e)}}function _1t(t,e){var i,r=0,n=null,o=0;for(i=0;i<e.length;i++)o+=e[i].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(n=new Uint8Array(o),i=0;i<e.length;i++)n.set(e[i],r),r+=e[i].length;return n;case"nodebuffer":return Buffer.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}function y1t(t,e){return new v1t.Promise(function(i,r){var n=[],o=t._internalType,s=t._outputType,a=t._mimeType;t.on("data",function(c,d){n.push(c),e&&e(d)}).on("error",function(c){n=[],r(c)}).on("end",function(){try{var c=b1t(s,_1t(o,n),a);i(c)}catch(d){r(d)}n=[]}).resume()})}function iIe(t,e,i){var r=e;switch(e){case"blob":case"arraybuffer":r="uint8array";break;case"base64":r="string";break}try{this._internalType=r,this._outputType=e,this._mimeType=i,ow.checkSupport(r),this._worker=t.pipe(new f1t(r)),t.lock()}catch(n){this._worker=new p1t("error"),this._worker.error(n)}}iIe.prototype={accumulate:function(t){return y1t(this,t)},on:function(t,e){var i=this;return t==="data"?this._worker.on(t,function(r){e.call(i,r.data,r.meta)}):this._worker.on(t,function(){ow.delay(e,arguments,i)}),this},resume:function(){return ow.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(ow.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new tIe(this,{objectMode:this._outputType!=="nodebuffer"},t)}};rIe.exports=iIe});var oQ=z(xh=>{"use strict";xh.base64=!1;xh.binary=!1;xh.dir=!1;xh.createFolders=!0;xh.date=null;xh.compression=null;xh.compressionOptions=null;xh.comment=null;xh.unixPermissions=null;xh.dosPermissions=null});var sQ=z((MGi,nIe)=>{"use strict";var J4=No(),eV=wd(),w1t=16*1024;function _E(t){eV.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then(function(i){e.dataIsReady=!0,e.data=i,e.max=i&&i.length||0,e.type=J4.getTypeOf(i),e.isPaused||e._tickAndRepeat()},function(i){e.error(i)})}J4.inherits(_E,eV);_E.prototype.cleanUp=function(){eV.prototype.cleanUp.call(this),this.data=null};_E.prototype.resume=function(){return eV.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,J4.delay(this._tickAndRepeat,[],this)),!0):!1};_E.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(J4.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))};_E.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=w1t,e=null,i=Math.min(this.max,this.index+t);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,i);break;case"uint8array":e=this.data.subarray(this.index,i);break;case"array":case"nodebuffer":e=this.data.slice(this.index,i);break}return this.index=i,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})};nIe.exports=_E});var tV=z((kGi,sIe)=>{"use strict";var C1t=No();function x1t(){for(var t,e=[],i=0;i<256;i++){t=i;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[i]=t}return e}var oIe=x1t();function S1t(t,e,i,r){var n=oIe,o=r+i;t=t^-1;for(var s=r;s<o;s++)t=t>>>8^n[(t^e[s])&255];return t^-1}function E1t(t,e,i,r){var n=oIe,o=r+i;t=t^-1;for(var s=r;s<o;s++)t=t>>>8^n[(t^e.charCodeAt(s))&255];return t^-1}sIe.exports=function(e,i){if(typeof e>"u"||!e.length)return 0;var r=C1t.getTypeOf(e)!=="string";return r?S1t(i|0,e,e.length,0):E1t(i|0,e,e.length,0)}});var lQ=z((OGi,lIe)=>{"use strict";var aIe=wd(),T1t=tV(),R1t=No();function aQ(){aIe.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}R1t.inherits(aQ,aIe);aQ.prototype.processChunk=function(t){this.streamInfo.crc32=T1t(t.data,this.streamInfo.crc32||0),this.push(t)};lIe.exports=aQ});var dIe=z((NGi,cIe)=>{"use strict";var A1t=No(),cQ=wd();function dQ(t){cQ.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}A1t.inherits(dQ,cQ);dQ.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}cQ.prototype.processChunk.call(this,t)};cIe.exports=dQ});var iV=z((PGi,fIe)=>{"use strict";var uIe=mE(),hIe=sQ(),I1t=lQ(),uQ=dIe();function hQ(t,e,i,r,n){this.compressedSize=t,this.uncompressedSize=e,this.crc32=i,this.compression=r,this.compressedContent=n}hQ.prototype={getContentWorker:function(){var t=new hIe(uIe.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new uQ("data_length")),e=this;return t.on("end",function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),t},getCompressedWorker:function(){return new hIe(uIe.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};hQ.createWorkerFrom=function(t,e,i){return t.pipe(new I1t).pipe(new uQ("uncompressedSize")).pipe(e.compressWorker(i)).pipe(new uQ("compressedSize")).withStreamInfo("compression",e)};fIe.exports=hQ});var vIe=z((LGi,gIe)=>{"use strict";var D1t=nQ(),M1t=sQ(),fQ=bE(),pQ=iV(),pIe=wd(),mQ=function(t,e,i){this.name=t,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=e,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}};mQ.prototype={internalStream:function(t){var e=null,i="string";try{if(!t)throw new Error("No output type specified.");i=t.toLowerCase();var r=i==="string"||i==="text";(i==="binarystring"||i==="text")&&(i="string"),e=this._decompressWorker();var n=!this._dataBinary;n&&!r&&(e=e.pipe(new fQ.Utf8EncodeWorker)),!n&&r&&(e=e.pipe(new fQ.Utf8DecodeWorker))}catch(o){e=new pIe("error"),e.error(o)}return new D1t(e,i,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof pQ&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new fQ.Utf8EncodeWorker)),pQ.createWorkerFrom(i,t,e)},_decompressWorker:function(){return this._data instanceof pQ?this._data.getContentWorker():this._data instanceof pIe?this._data:new M1t(this._data)}};var mIe=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],k1t=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")};for(rV=0;rV<mIe.length;rV++)mQ.prototype[mIe[rV]]=k1t;var rV;gIe.exports=mQ});var Xm=z(Gl=>{"use strict";var O1t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function N1t(t,e){return Object.prototype.hasOwnProperty.call(t,e)}Gl.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(var r in i)N1t(i,r)&&(t[r]=i[r])}}return t};Gl.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var P1t={arraySet:function(t,e,i,r,n){if(e.subarray&&t.subarray){t.set(e.subarray(i,i+r),n);return}for(var o=0;o<r;o++)t[n+o]=e[i+o]},flattenChunks:function(t){var e,i,r,n,o,s;for(r=0,e=0,i=t.length;e<i;e++)r+=t[e].length;for(s=new Uint8Array(r),n=0,e=0,i=t.length;e<i;e++)o=t[e],s.set(o,n),n+=o.length;return s}},L1t={arraySet:function(t,e,i,r,n){for(var o=0;o<r;o++)t[n+o]=e[i+o]},flattenChunks:function(t){return[].concat.apply([],t)}};Gl.setTyped=function(t){t?(Gl.Buf8=Uint8Array,Gl.Buf16=Uint16Array,Gl.Buf32=Int32Array,Gl.assign(Gl,P1t)):(Gl.Buf8=Array,Gl.Buf16=Array,Gl.Buf32=Array,Gl.assign(Gl,L1t))};Gl.setTyped(O1t)});var VIe=z(CE=>{"use strict";var F1t=Xm(),H1t=4,bIe=0,_Ie=1,B1t=2;function wE(t){for(var e=t.length;--e>=0;)t[e]=0}var V1t=0,EIe=1,j1t=2,z1t=3,W1t=258,CQ=29,y2=256,g2=y2+1+CQ,yE=30,xQ=19,TIe=2*g2+1,sw=15,gQ=16,U1t=7,SQ=256,RIe=16,AIe=17,IIe=18,yQ=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],nV=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],q1t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],DIe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y1t=512,Km=new Array((g2+2)*2);wE(Km);var m2=new Array(yE*2);wE(m2);var v2=new Array(Y1t);wE(v2);var b2=new Array(W1t-z1t+1);wE(b2);var EQ=new Array(CQ);wE(EQ);var oV=new Array(yE);wE(oV);function vQ(t,e,i,r,n){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=r,this.max_length=n,this.has_stree=t&&t.length}var MIe,kIe,OIe;function bQ(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function NIe(t){return t<256?v2[t]:v2[256+(t>>>7)]}function _2(t,e){t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255}function Lc(t,e,i){t.bi_valid>gQ-i?(t.bi_buf|=e<<t.bi_valid&65535,_2(t,t.bi_buf),t.bi_buf=e>>gQ-t.bi_valid,t.bi_valid+=i-gQ):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function dp(t,e,i){Lc(t,i[e*2],i[e*2+1])}function PIe(t,e){var i=0;do i|=t&1,t>>>=1,i<<=1;while(--e>0);return i>>>1}function $1t(t){t.bi_valid===16?(_2(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function G1t(t,e){var i=e.dyn_tree,r=e.max_code,n=e.stat_desc.static_tree,o=e.stat_desc.has_stree,s=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length,d,u,h,p,f,m,g=0;for(p=0;p<=sw;p++)t.bl_count[p]=0;for(i[t.heap[t.heap_max]*2+1]=0,d=t.heap_max+1;d<TIe;d++)u=t.heap[d],p=i[i[u*2+1]*2+1]+1,p>c&&(p=c,g++),i[u*2+1]=p,!(u>r)&&(t.bl_count[p]++,f=0,u>=a&&(f=s[u-a]),m=i[u*2],t.opt_len+=m*(p+f),o&&(t.static_len+=m*(n[u*2+1]+f)));if(g!==0){do{for(p=c-1;t.bl_count[p]===0;)p--;t.bl_count[p]--,t.bl_count[p+1]+=2,t.bl_count[c]--,g-=2}while(g>0);for(p=c;p!==0;p--)for(u=t.bl_count[p];u!==0;)h=t.heap[--d],!(h>r)&&(i[h*2+1]!==p&&(t.opt_len+=(p-i[h*2+1])*i[h*2],i[h*2+1]=p),u--)}}function LIe(t,e,i){var r=new Array(sw+1),n=0,o,s;for(o=1;o<=sw;o++)r[o]=n=n+i[o-1]<<1;for(s=0;s<=e;s++){var a=t[s*2+1];a!==0&&(t[s*2]=PIe(r[a]++,a))}}function X1t(){var t,e,i,r,n,o=new Array(sw+1);for(i=0,r=0;r<CQ-1;r++)for(EQ[r]=i,t=0;t<1<<yQ[r];t++)b2[i++]=r;for(b2[i-1]=r,n=0,r=0;r<16;r++)for(oV[r]=n,t=0;t<1<<nV[r];t++)v2[n++]=r;for(n>>=7;r<yE;r++)for(oV[r]=n<<7,t=0;t<1<<nV[r]-7;t++)v2[256+n++]=r;for(e=0;e<=sw;e++)o[e]=0;for(t=0;t<=143;)Km[t*2+1]=8,t++,o[8]++;for(;t<=255;)Km[t*2+1]=9,t++,o[9]++;for(;t<=279;)Km[t*2+1]=7,t++,o[7]++;for(;t<=287;)Km[t*2+1]=8,t++,o[8]++;for(LIe(Km,g2+1,o),t=0;t<yE;t++)m2[t*2+1]=5,m2[t*2]=PIe(t,5);MIe=new vQ(Km,yQ,y2+1,g2,sw),kIe=new vQ(m2,nV,0,yE,sw),OIe=new vQ(new Array(0),q1t,0,xQ,U1t)}function FIe(t){var e;for(e=0;e<g2;e++)t.dyn_ltree[e*2]=0;for(e=0;e<yE;e++)t.dyn_dtree[e*2]=0;for(e=0;e<xQ;e++)t.bl_tree[e*2]=0;t.dyn_ltree[SQ*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function HIe(t){t.bi_valid>8?_2(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function K1t(t,e,i,r){HIe(t),r&&(_2(t,i),_2(t,~i)),F1t.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}function yIe(t,e,i,r){var n=e*2,o=i*2;return t[n]<t[o]||t[n]===t[o]&&r[e]<=r[i]}function _Q(t,e,i){for(var r=t.heap[i],n=i<<1;n<=t.heap_len&&(n<t.heap_len&&yIe(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!yIe(e,r,t.heap[n],t.depth));)t.heap[i]=t.heap[n],i=n,n<<=1;t.heap[i]=r}function wIe(t,e,i){var r,n,o=0,s,a;if(t.last_lit!==0)do r=t.pending_buf[t.d_buf+o*2]<<8|t.pending_buf[t.d_buf+o*2+1],n=t.pending_buf[t.l_buf+o],o++,r===0?dp(t,n,e):(s=b2[n],dp(t,s+y2+1,e),a=yQ[s],a!==0&&(n-=EQ[s],Lc(t,n,a)),r--,s=NIe(r),dp(t,s,i),a=nV[s],a!==0&&(r-=oV[s],Lc(t,r,a)));while(o<t.last_lit);dp(t,SQ,e)}function wQ(t,e){var i=e.dyn_tree,r=e.stat_desc.static_tree,n=e.stat_desc.has_stree,o=e.stat_desc.elems,s,a,c=-1,d;for(t.heap_len=0,t.heap_max=TIe,s=0;s<o;s++)i[s*2]!==0?(t.heap[++t.heap_len]=c=s,t.depth[s]=0):i[s*2+1]=0;for(;t.heap_len<2;)d=t.heap[++t.heap_len]=c<2?++c:0,i[d*2]=1,t.depth[d]=0,t.opt_len--,n&&(t.static_len-=r[d*2+1]);for(e.max_code=c,s=t.heap_len>>1;s>=1;s--)_Q(t,i,s);d=o;do s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],_Q(t,i,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,i[d*2]=i[s*2]+i[a*2],t.depth[d]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,i[s*2+1]=i[a*2+1]=d,t.heap[1]=d++,_Q(t,i,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],G1t(t,e),LIe(i,c,t.bl_count)}function CIe(t,e,i){var r,n=-1,o,s=e[0*2+1],a=0,c=7,d=4;for(s===0&&(c=138,d=3),e[(i+1)*2+1]=65535,r=0;r<=i;r++)o=s,s=e[(r+1)*2+1],!(++a<c&&o===s)&&(a<d?t.bl_tree[o*2]+=a:o!==0?(o!==n&&t.bl_tree[o*2]++,t.bl_tree[RIe*2]++):a<=10?t.bl_tree[AIe*2]++:t.bl_tree[IIe*2]++,a=0,n=o,s===0?(c=138,d=3):o===s?(c=6,d=3):(c=7,d=4))}function xIe(t,e,i){var r,n=-1,o,s=e[0*2+1],a=0,c=7,d=4;for(s===0&&(c=138,d=3),r=0;r<=i;r++)if(o=s,s=e[(r+1)*2+1],!(++a<c&&o===s)){if(a<d)do dp(t,o,t.bl_tree);while(--a!==0);else o!==0?(o!==n&&(dp(t,o,t.bl_tree),a--),dp(t,RIe,t.bl_tree),Lc(t,a-3,2)):a<=10?(dp(t,AIe,t.bl_tree),Lc(t,a-3,3)):(dp(t,IIe,t.bl_tree),Lc(t,a-11,7));a=0,n=o,s===0?(c=138,d=3):o===s?(c=6,d=3):(c=7,d=4)}}function Z1t(t){var e;for(CIe(t,t.dyn_ltree,t.l_desc.max_code),CIe(t,t.dyn_dtree,t.d_desc.max_code),wQ(t,t.bl_desc),e=xQ-1;e>=3&&t.bl_tree[DIe[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e}function Q1t(t,e,i,r){var n;for(Lc(t,e-257,5),Lc(t,i-1,5),Lc(t,r-4,4),n=0;n<r;n++)Lc(t,t.bl_tree[DIe[n]*2+1],3);xIe(t,t.dyn_ltree,e-1),xIe(t,t.dyn_dtree,i-1)}function J1t(t){var e=4093624447,i;for(i=0;i<=31;i++,e>>>=1)if(e&1&&t.dyn_ltree[i*2]!==0)return bIe;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return _Ie;for(i=32;i<y2;i++)if(t.dyn_ltree[i*2]!==0)return _Ie;return bIe}var SIe=!1;function eSt(t){SIe||(X1t(),SIe=!0),t.l_desc=new bQ(t.dyn_ltree,MIe),t.d_desc=new bQ(t.dyn_dtree,kIe),t.bl_desc=new bQ(t.bl_tree,OIe),t.bi_buf=0,t.bi_valid=0,FIe(t)}function BIe(t,e,i,r){Lc(t,(V1t<<1)+(r?1:0),3),K1t(t,e,i,!0)}function tSt(t){Lc(t,EIe<<1,3),dp(t,SQ,Km),$1t(t)}function iSt(t,e,i,r){var n,o,s=0;t.level>0?(t.strm.data_type===B1t&&(t.strm.data_type=J1t(t)),wQ(t,t.l_desc),wQ(t,t.d_desc),s=Z1t(t),n=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=n&&(n=o)):n=o=i+5,i+4<=n&&e!==-1?BIe(t,e,i,r):t.strategy===H1t||o===n?(Lc(t,(EIe<<1)+(r?1:0),3),wIe(t,Km,m2)):(Lc(t,(j1t<<1)+(r?1:0),3),Q1t(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),wIe(t,t.dyn_ltree,t.dyn_dtree)),FIe(t),r&&HIe(t)}function rSt(t,e,i){return t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=i&255,t.last_lit++,e===0?t.dyn_ltree[i*2]++:(t.matches++,e--,t.dyn_ltree[(b2[i]+y2+1)*2]++,t.dyn_dtree[NIe(e)*2]++),t.last_lit===t.lit_bufsize-1}CE._tr_init=eSt;CE._tr_stored_block=BIe;CE._tr_flush_block=iSt;CE._tr_tally=rSt;CE._tr_align=tSt});var TQ=z((BGi,jIe)=>{"use strict";function nSt(t,e,i,r){for(var n=t&65535|0,o=t>>>16&65535|0,s=0;i!==0;){s=i>2e3?2e3:i,i-=s;do n=n+e[r++]|0,o=o+n|0;while(--s);n%=65521,o%=65521}return n|o<<16|0}jIe.exports=nSt});var RQ=z((VGi,zIe)=>{"use strict";function oSt(){for(var t,e=[],i=0;i<256;i++){t=i;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[i]=t}return e}var sSt=oSt();function aSt(t,e,i,r){var n=sSt,o=r+i;t^=-1;for(var s=r;s<o;s++)t=t>>>8^n[(t^e[s])&255];return t^-1}zIe.exports=aSt});var sV=z((jGi,WIe)=>{"use strict";WIe.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var QIe=z(fp=>{"use strict";var Xl=Xm(),wu=VIe(),$Ie=TQ(),Ub=RQ(),lSt=sV(),dw=0,cSt=1,dSt=3,Xb=4,UIe=5,hp=0,qIe=1,Cu=-2,uSt=-3,AQ=-5,hSt=-1,fSt=1,aV=2,pSt=3,mSt=4,gSt=0,vSt=2,uV=8,bSt=9,_St=15,ySt=8,wSt=29,CSt=256,DQ=CSt+1+wSt,xSt=30,SSt=19,ESt=2*DQ+1,TSt=15,Ir=3,$b=258,Sh=$b+Ir+1,RSt=32,hV=42,MQ=69,lV=73,cV=91,dV=103,aw=113,C2=666,Us=1,x2=2,lw=3,EE=4,ASt=3;function Gb(t,e){return t.msg=lSt[e],e}function YIe(t){return(t<<1)-(t>4?9:0)}function Yb(t){for(var e=t.length;--e>=0;)t[e]=0}function qb(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),i!==0&&(Xl.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,e.pending===0&&(e.pending_out=0))}function Fa(t,e){wu._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,qb(t.strm)}function zr(t,e){t.pending_buf[t.pending++]=e}function w2(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255}function ISt(t,e,i,r){var n=t.avail_in;return n>r&&(n=r),n===0?0:(t.avail_in-=n,Xl.arraySet(e,t.input,t.next_in,n,i),t.state.wrap===1?t.adler=$Ie(t.adler,e,n,i):t.state.wrap===2&&(t.adler=Ub(t.adler,e,n,i)),t.next_in+=n,t.total_in+=n,n)}function GIe(t,e){var i=t.max_chain_length,r=t.strstart,n,o,s=t.prev_length,a=t.nice_match,c=t.strstart>t.w_size-Sh?t.strstart-(t.w_size-Sh):0,d=t.window,u=t.w_mask,h=t.prev,p=t.strstart+$b,f=d[r+s-1],m=d[r+s];t.prev_length>=t.good_match&&(i>>=2),a>t.lookahead&&(a=t.lookahead);do if(n=e,!(d[n+s]!==m||d[n+s-1]!==f||d[n]!==d[r]||d[++n]!==d[r+1])){r+=2,n++;do;while(d[++r]===d[++n]&&d[++r]===d[++n]&&d[++r]===d[++n]&&d[++r]===d[++n]&&d[++r]===d[++n]&&d[++r]===d[++n]&&d[++r]===d[++n]&&d[++r]===d[++n]&&r<p);if(o=$b-(p-r),r=p-$b,o>s){if(t.match_start=e,s=o,o>=a)break;f=d[r+s-1],m=d[r+s]}}while((e=h[e&u])>c&&--i!==0);return s<=t.lookahead?s:t.lookahead}function cw(t){var e=t.w_size,i,r,n,o,s;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Sh)){Xl.arraySet(t.window,t.window,e,e,0),t.match_start-=e,t.strstart-=e,t.block_start-=e,r=t.hash_size,i=r;do n=t.head[--i],t.head[i]=n>=e?n-e:0;while(--r);r=e,i=r;do n=t.prev[--i],t.prev[i]=n>=e?n-e:0;while(--r);o+=e}if(t.strm.avail_in===0)break;if(r=ISt(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=r,t.lookahead+t.insert>=Ir)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+Ir-1])&t.hash_mask,t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<Ir)););}while(t.lookahead<Sh&&t.strm.avail_in!==0)}function DSt(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(cw(t),t.lookahead===0&&e===dw)return Us;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+i;if((t.strstart===0||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,Fa(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Sh&&(Fa(t,!1),t.strm.avail_out===0))return Us}return t.insert=0,e===Xb?(Fa(t,!0),t.strm.avail_out===0?lw:EE):(t.strstart>t.block_start&&(Fa(t,!1),t.strm.avail_out===0),Us)}function IQ(t,e){for(var i,r;;){if(t.lookahead<Sh){if(cw(t),t.lookahead<Sh&&e===dw)return Us;if(t.lookahead===0)break}if(i=0,t.lookahead>=Ir&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Ir-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),i!==0&&t.strstart-i<=t.w_size-Sh&&(t.match_length=GIe(t,i)),t.match_length>=Ir)if(r=wu._tr_tally(t,t.strstart-t.match_start,t.match_length-Ir),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Ir){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Ir-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=wu._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(Fa(t,!1),t.strm.avail_out===0))return Us}return t.insert=t.strstart<Ir-1?t.strstart:Ir-1,e===Xb?(Fa(t,!0),t.strm.avail_out===0?lw:EE):t.last_lit&&(Fa(t,!1),t.strm.avail_out===0)?Us:x2}function xE(t,e){for(var i,r,n;;){if(t.lookahead<Sh){if(cw(t),t.lookahead<Sh&&e===dw)return Us;if(t.lookahead===0)break}if(i=0,t.lookahead>=Ir&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Ir-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Ir-1,i!==0&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-Sh&&(t.match_length=GIe(t,i),t.match_length<=5&&(t.strategy===fSt||t.match_length===Ir&&t.strstart-t.match_start>4096)&&(t.match_length=Ir-1)),t.prev_length>=Ir&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-Ir,r=wu._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-Ir),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Ir-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=Ir-1,t.strstart++,r&&(Fa(t,!1),t.strm.avail_out===0))return Us}else if(t.match_available){if(r=wu._tr_tally(t,0,t.window[t.strstart-1]),r&&Fa(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Us}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=wu._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Ir-1?t.strstart:Ir-1,e===Xb?(Fa(t,!0),t.strm.avail_out===0?lw:EE):t.last_lit&&(Fa(t,!1),t.strm.avail_out===0)?Us:x2}function MSt(t,e){for(var i,r,n,o,s=t.window;;){if(t.lookahead<=$b){if(cw(t),t.lookahead<=$b&&e===dw)return Us;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Ir&&t.strstart>0&&(n=t.strstart-1,r=s[n],r===s[++n]&&r===s[++n]&&r===s[++n])){o=t.strstart+$b;do;while(r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&n<o);t.match_length=$b-(o-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Ir?(i=wu._tr_tally(t,1,t.match_length-Ir),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=wu._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(Fa(t,!1),t.strm.avail_out===0))return Us}return t.insert=0,e===Xb?(Fa(t,!0),t.strm.avail_out===0?lw:EE):t.last_lit&&(Fa(t,!1),t.strm.avail_out===0)?Us:x2}function kSt(t,e){for(var i;;){if(t.lookahead===0&&(cw(t),t.lookahead===0)){if(e===dw)return Us;break}if(t.match_length=0,i=wu._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(Fa(t,!1),t.strm.avail_out===0))return Us}return t.insert=0,e===Xb?(Fa(t,!0),t.strm.avail_out===0?lw:EE):t.last_lit&&(Fa(t,!1),t.strm.avail_out===0)?Us:x2}function up(t,e,i,r,n){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=r,this.func=n}var SE;SE=[new up(0,0,0,0,DSt),new up(4,4,8,4,IQ),new up(4,5,16,8,IQ),new up(4,6,32,32,IQ),new up(4,4,16,16,xE),new up(8,16,32,32,xE),new up(8,16,128,128,xE),new up(8,32,128,256,xE),new up(32,128,258,1024,xE),new up(32,258,258,4096,xE)];function OSt(t){t.window_size=2*t.w_size,Yb(t.head),t.max_lazy_match=SE[t.level].max_lazy,t.good_match=SE[t.level].good_length,t.nice_match=SE[t.level].nice_length,t.max_chain_length=SE[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Ir-1,t.match_available=0,t.ins_h=0}function NSt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=uV,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Xl.Buf16(ESt*2),this.dyn_dtree=new Xl.Buf16((2*xSt+1)*2),this.bl_tree=new Xl.Buf16((2*SSt+1)*2),Yb(this.dyn_ltree),Yb(this.dyn_dtree),Yb(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Xl.Buf16(TSt+1),this.heap=new Xl.Buf16(2*DQ+1),Yb(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Xl.Buf16(2*DQ+1),Yb(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function XIe(t){var e;return!t||!t.state?Gb(t,Cu):(t.total_in=t.total_out=0,t.data_type=vSt,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?hV:aw,t.adler=e.wrap===2?0:1,e.last_flush=dw,wu._tr_init(e),hp)}function KIe(t){var e=XIe(t);return e===hp&&OSt(t.state),e}function PSt(t,e){return!t||!t.state||t.state.wrap!==2?Cu:(t.state.gzhead=e,hp)}function ZIe(t,e,i,r,n,o){if(!t)return Cu;var s=1;if(e===hSt&&(e=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),n<1||n>bSt||i!==uV||r<8||r>15||e<0||e>9||o<0||o>mSt)return Gb(t,Cu);r===8&&(r=9);var a=new NSt;return t.state=a,a.strm=t,a.wrap=s,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Ir-1)/Ir),a.window=new Xl.Buf8(a.w_size*2),a.head=new Xl.Buf16(a.hash_size),a.prev=new Xl.Buf16(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Xl.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=o,a.method=i,KIe(t)}function LSt(t,e){return ZIe(t,e,uV,_St,ySt,gSt)}function FSt(t,e){var i,r,n,o;if(!t||!t.state||e>UIe||e<0)return t?Gb(t,Cu):Cu;if(r=t.state,!t.output||!t.input&&t.avail_in!==0||r.status===C2&&e!==Xb)return Gb(t,t.avail_out===0?AQ:Cu);if(r.strm=t,i=r.last_flush,r.last_flush=e,r.status===hV)if(r.wrap===2)t.adler=0,zr(r,31),zr(r,139),zr(r,8),r.gzhead?(zr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),zr(r,r.gzhead.time&255),zr(r,r.gzhead.time>>8&255),zr(r,r.gzhead.time>>16&255),zr(r,r.gzhead.time>>24&255),zr(r,r.level===9?2:r.strategy>=aV||r.level<2?4:0),zr(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(zr(r,r.gzhead.extra.length&255),zr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=Ub(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=MQ):(zr(r,0),zr(r,0),zr(r,0),zr(r,0),zr(r,0),zr(r,r.level===9?2:r.strategy>=aV||r.level<2?4:0),zr(r,ASt),r.status=aw);else{var s=uV+(r.w_bits-8<<4)<<8,a=-1;r.strategy>=aV||r.level<2?a=0:r.level<6?a=1:r.level===6?a=2:a=3,s|=a<<6,r.strstart!==0&&(s|=RSt),s+=31-s%31,r.status=aw,w2(r,s),r.strstart!==0&&(w2(r,t.adler>>>16),w2(r,t.adler&65535)),t.adler=1}if(r.status===MQ)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(r.gzhead.extra.length&65535)&&!(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(t.adler=Ub(t.adler,r.pending_buf,r.pending-n,n)),qb(t),n=r.pending,r.pending===r.pending_buf_size));)zr(r,r.gzhead.extra[r.gzindex]&255),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(t.adler=Ub(t.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=lV)}else r.status=lV;if(r.status===lV)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(t.adler=Ub(t.adler,r.pending_buf,r.pending-n,n)),qb(t),n=r.pending,r.pending===r.pending_buf_size)){o=1;break}r.gzindex<r.gzhead.name.length?o=r.gzhead.name.charCodeAt(r.gzindex++)&255:o=0,zr(r,o)}while(o!==0);r.gzhead.hcrc&&r.pending>n&&(t.adler=Ub(t.adler,r.pending_buf,r.pending-n,n)),o===0&&(r.gzindex=0,r.status=cV)}else r.status=cV;if(r.status===cV)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(t.adler=Ub(t.adler,r.pending_buf,r.pending-n,n)),qb(t),n=r.pending,r.pending===r.pending_buf_size)){o=1;break}r.gzindex<r.gzhead.comment.length?o=r.gzhead.comment.charCodeAt(r.gzindex++)&255:o=0,zr(r,o)}while(o!==0);r.gzhead.hcrc&&r.pending>n&&(t.adler=Ub(t.adler,r.pending_buf,r.pending-n,n)),o===0&&(r.status=dV)}else r.status=dV;if(r.status===dV&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&qb(t),r.pending+2<=r.pending_buf_size&&(zr(r,t.adler&255),zr(r,t.adler>>8&255),t.adler=0,r.status=aw)):r.status=aw),r.pending!==0){if(qb(t),t.avail_out===0)return r.last_flush=-1,hp}else if(t.avail_in===0&&YIe(e)<=YIe(i)&&e!==Xb)return Gb(t,AQ);if(r.status===C2&&t.avail_in!==0)return Gb(t,AQ);if(t.avail_in!==0||r.lookahead!==0||e!==dw&&r.status!==C2){var c=r.strategy===aV?kSt(r,e):r.strategy===pSt?MSt(r,e):SE[r.level].func(r,e);if((c===lw||c===EE)&&(r.status=C2),c===Us||c===lw)return t.avail_out===0&&(r.last_flush=-1),hp;if(c===x2&&(e===cSt?wu._tr_align(r):e!==UIe&&(wu._tr_stored_block(r,0,0,!1),e===dSt&&(Yb(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),qb(t),t.avail_out===0))return r.last_flush=-1,hp}return e!==Xb?hp:r.wrap<=0?qIe:(r.wrap===2?(zr(r,t.adler&255),zr(r,t.adler>>8&255),zr(r,t.adler>>16&255),zr(r,t.adler>>24&255),zr(r,t.total_in&255),zr(r,t.total_in>>8&255),zr(r,t.total_in>>16&255),zr(r,t.total_in>>24&255)):(w2(r,t.adler>>>16),w2(r,t.adler&65535)),qb(t),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?hp:qIe)}function HSt(t){var e;return!t||!t.state?Cu:(e=t.state.status,e!==hV&&e!==MQ&&e!==lV&&e!==cV&&e!==dV&&e!==aw&&e!==C2?Gb(t,Cu):(t.state=null,e===aw?Gb(t,uSt):hp))}function BSt(t,e){var i=e.length,r,n,o,s,a,c,d,u;if(!t||!t.state||(r=t.state,s=r.wrap,s===2||s===1&&r.status!==hV||r.lookahead))return Cu;for(s===1&&(t.adler=$Ie(t.adler,e,i,0)),r.wrap=0,i>=r.w_size&&(s===0&&(Yb(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new Xl.Buf8(r.w_size),Xl.arraySet(u,e,i-r.w_size,r.w_size,0),e=u,i=r.w_size),a=t.avail_in,c=t.next_in,d=t.input,t.avail_in=i,t.next_in=0,t.input=e,cw(r);r.lookahead>=Ir;){n=r.strstart,o=r.lookahead-(Ir-1);do r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+Ir-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++;while(--o);r.strstart=n,r.lookahead=Ir-1,cw(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Ir-1,r.match_available=0,t.next_in=c,t.input=d,t.avail_in=a,r.wrap=s,hp}fp.deflateInit=LSt;fp.deflateInit2=ZIe;fp.deflateReset=KIe;fp.deflateResetKeep=XIe;fp.deflateSetHeader=PSt;fp.deflate=FSt;fp.deflateEnd=HSt;fp.deflateSetDictionary=BSt;fp.deflateInfo="pako deflate (from Nodeca project)"});var kQ=z(TE=>{"use strict";var fV=Xm(),JIe=!0,eDe=!0;try{String.fromCharCode.apply(null,[0])}catch{JIe=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{eDe=!1}var S2=new fV.Buf8(256);for(Zm=0;Zm<256;Zm++)S2[Zm]=Zm>=252?6:Zm>=248?5:Zm>=240?4:Zm>=224?3:Zm>=192?2:1;var Zm;S2[254]=S2[254]=1;TE.string2buf=function(t){var e,i,r,n,o,s=t.length,a=0;for(n=0;n<s;n++)i=t.charCodeAt(n),(i&64512)===55296&&n+1<s&&(r=t.charCodeAt(n+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),n++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(e=new fV.Buf8(a),o=0,n=0;o<a;n++)i=t.charCodeAt(n),(i&64512)===55296&&n+1<s&&(r=t.charCodeAt(n+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),n++)),i<128?e[o++]=i:i<2048?(e[o++]=192|i>>>6,e[o++]=128|i&63):i<65536?(e[o++]=224|i>>>12,e[o++]=128|i>>>6&63,e[o++]=128|i&63):(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63,e[o++]=128|i>>>6&63,e[o++]=128|i&63);return e};function tDe(t,e){if(e<65534&&(t.subarray&&eDe||!t.subarray&&JIe))return String.fromCharCode.apply(null,fV.shrinkBuf(t,e));for(var i="",r=0;r<e;r++)i+=String.fromCharCode(t[r]);return i}TE.buf2binstring=function(t){return tDe(t,t.length)};TE.binstring2buf=function(t){for(var e=new fV.Buf8(t.length),i=0,r=e.length;i<r;i++)e[i]=t.charCodeAt(i);return e};TE.buf2string=function(t,e){var i,r,n,o,s=e||t.length,a=new Array(s*2);for(r=0,i=0;i<s;){if(n=t[i++],n<128){a[r++]=n;continue}if(o=S2[n],o>4){a[r++]=65533,i+=o-1;continue}for(n&=o===2?31:o===3?15:7;o>1&&i<s;)n=n<<6|t[i++]&63,o--;if(o>1){a[r++]=65533;continue}n<65536?a[r++]=n:(n-=65536,a[r++]=55296|n>>10&1023,a[r++]=56320|n&1023)}return tDe(a,r)};TE.utf8border=function(t,e){var i;for(e=e||t.length,e>t.length&&(e=t.length),i=e-1;i>=0&&(t[i]&192)===128;)i--;return i<0||i===0?e:i+S2[t[i]]>e?i:e}});var OQ=z((UGi,iDe)=>{"use strict";function VSt(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}iDe.exports=VSt});var sDe=z(R2=>{"use strict";var E2=QIe(),T2=Xm(),PQ=kQ(),LQ=sV(),jSt=OQ(),oDe=Object.prototype.toString,zSt=0,NQ=4,RE=0,rDe=1,nDe=2,WSt=-1,USt=0,qSt=8;function uw(t){if(!(this instanceof uw))return new uw(t);this.options=T2.assign({level:WSt,method:qSt,chunkSize:16384,windowBits:15,memLevel:8,strategy:USt,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jSt,this.strm.avail_out=0;var i=E2.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==RE)throw new Error(LQ[i]);if(e.header&&E2.deflateSetHeader(this.strm,e.header),e.dictionary){var r;if(typeof e.dictionary=="string"?r=PQ.string2buf(e.dictionary):oDe.call(e.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(e.dictionary):r=e.dictionary,i=E2.deflateSetDictionary(this.strm,r),i!==RE)throw new Error(LQ[i]);this._dict_set=!0}}uw.prototype.push=function(t,e){var i=this.strm,r=this.options.chunkSize,n,o;if(this.ended)return!1;o=e===~~e?e:e===!0?NQ:zSt,typeof t=="string"?i.input=PQ.string2buf(t):oDe.call(t)==="[object ArrayBuffer]"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new T2.Buf8(r),i.next_out=0,i.avail_out=r),n=E2.deflate(i,o),n!==rDe&&n!==RE)return this.onEnd(n),this.ended=!0,!1;(i.avail_out===0||i.avail_in===0&&(o===NQ||o===nDe))&&(this.options.to==="string"?this.onData(PQ.buf2binstring(T2.shrinkBuf(i.output,i.next_out))):this.onData(T2.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||i.avail_out===0)&&n!==rDe);return o===NQ?(n=E2.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===RE):(o===nDe&&(this.onEnd(RE),i.avail_out=0),!0)};uw.prototype.onData=function(t){this.chunks.push(t)};uw.prototype.onEnd=function(t){t===RE&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=T2.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function FQ(t,e){var i=new uw(e);if(i.push(t,!0),i.err)throw i.msg||LQ[i.err];return i.result}function YSt(t,e){return e=e||{},e.raw=!0,FQ(t,e)}function $St(t,e){return e=e||{},e.gzip=!0,FQ(t,e)}R2.Deflate=uw;R2.deflate=FQ;R2.deflateRaw=YSt;R2.gzip=$St});var lDe=z((YGi,aDe)=>{"use strict";var pV=30,GSt=12;aDe.exports=function(e,i){var r,n,o,s,a,c,d,u,h,p,f,m,g,y,w,x,T,M,B,G,F,O,V,J,N;r=e.state,n=e.next_in,J=e.input,o=n+(e.avail_in-5),s=e.next_out,N=e.output,a=s-(i-e.avail_out),c=s+(e.avail_out-257),d=r.dmax,u=r.wsize,h=r.whave,p=r.wnext,f=r.window,m=r.hold,g=r.bits,y=r.lencode,w=r.distcode,x=(1<<r.lenbits)-1,T=(1<<r.distbits)-1;e:do{g<15&&(m+=J[n++]<<g,g+=8,m+=J[n++]<<g,g+=8),M=y[m&x];t:for(;;){if(B=M>>>24,m>>>=B,g-=B,B=M>>>16&255,B===0)N[s++]=M&65535;else if(B&16){G=M&65535,B&=15,B&&(g<B&&(m+=J[n++]<<g,g+=8),G+=m&(1<<B)-1,m>>>=B,g-=B),g<15&&(m+=J[n++]<<g,g+=8,m+=J[n++]<<g,g+=8),M=w[m&T];i:for(;;){if(B=M>>>24,m>>>=B,g-=B,B=M>>>16&255,B&16){if(F=M&65535,B&=15,g<B&&(m+=J[n++]<<g,g+=8,g<B&&(m+=J[n++]<<g,g+=8)),F+=m&(1<<B)-1,F>d){e.msg="invalid distance too far back",r.mode=pV;break e}if(m>>>=B,g-=B,B=s-a,F>B){if(B=F-B,B>h&&r.sane){e.msg="invalid distance too far back",r.mode=pV;break e}if(O=0,V=f,p===0){if(O+=u-B,B<G){G-=B;do N[s++]=f[O++];while(--B);O=s-F,V=N}}else if(p<B){if(O+=u+p-B,B-=p,B<G){G-=B;do N[s++]=f[O++];while(--B);if(O=0,p<G){B=p,G-=B;do N[s++]=f[O++];while(--B);O=s-F,V=N}}}else if(O+=p-B,B<G){G-=B;do N[s++]=f[O++];while(--B);O=s-F,V=N}for(;G>2;)N[s++]=V[O++],N[s++]=V[O++],N[s++]=V[O++],G-=3;G&&(N[s++]=V[O++],G>1&&(N[s++]=V[O++]))}else{O=s-F;do N[s++]=N[O++],N[s++]=N[O++],N[s++]=N[O++],G-=3;while(G>2);G&&(N[s++]=N[O++],G>1&&(N[s++]=N[O++]))}}else if(B&64){e.msg="invalid distance code",r.mode=pV;break e}else{M=w[(M&65535)+(m&(1<<B)-1)];continue i}break}}else if(B&64)if(B&32){r.mode=GSt;break e}else{e.msg="invalid literal/length code",r.mode=pV;break e}else{M=y[(M&65535)+(m&(1<<B)-1)];continue t}break}}while(n<o&&s<c);G=g>>3,n-=G,g-=G<<3,m&=(1<<g)-1,e.next_in=n,e.next_out=s,e.avail_in=n<o?5+(o-n):5-(n-o),e.avail_out=s<c?257+(c-s):257-(s-c),r.hold=m,r.bits=g}});var mDe=z(($Gi,pDe)=>{"use strict";var cDe=Xm(),AE=15,dDe=852,uDe=592,hDe=0,HQ=1,fDe=2,XSt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],KSt=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ZSt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],QSt=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];pDe.exports=function(e,i,r,n,o,s,a,c){var d=c.bits,u=0,h=0,p=0,f=0,m=0,g=0,y=0,w=0,x=0,T=0,M,B,G,F,O,V=null,J=0,N,P=new cDe.Buf16(AE+1),$=new cDe.Buf16(AE+1),K=null,ve=0,W,ee,te;for(u=0;u<=AE;u++)P[u]=0;for(h=0;h<n;h++)P[i[r+h]]++;for(m=d,f=AE;f>=1&&P[f]===0;f--);if(m>f&&(m=f),f===0)return o[s++]=1<<24|64<<16|0,o[s++]=1<<24|64<<16|0,c.bits=1,0;for(p=1;p<f&&P[p]===0;p++);for(m<p&&(m=p),w=1,u=1;u<=AE;u++)if(w<<=1,w-=P[u],w<0)return-1;if(w>0&&(e===hDe||f!==1))return-1;for($[1]=0,u=1;u<AE;u++)$[u+1]=$[u]+P[u];for(h=0;h<n;h++)i[r+h]!==0&&(a[$[i[r+h]]++]=h);if(e===hDe?(V=K=a,N=19):e===HQ?(V=XSt,J-=257,K=KSt,ve-=257,N=256):(V=ZSt,K=QSt,N=-1),T=0,h=0,u=p,O=s,g=m,y=0,G=-1,x=1<<m,F=x-1,e===HQ&&x>dDe||e===fDe&&x>uDe)return 1;for(;;){W=u-y,a[h]<N?(ee=0,te=a[h]):a[h]>N?(ee=K[ve+a[h]],te=V[J+a[h]]):(ee=96,te=0),M=1<<u-y,B=1<<g,p=B;do B-=M,o[O+(T>>y)+B]=W<<24|ee<<16|te|0;while(B!==0);for(M=1<<u-1;T&M;)M>>=1;if(M!==0?(T&=M-1,T+=M):T=0,h++,--P[u]===0){if(u===f)break;u=i[r+a[h]]}if(u>m&&(T&F)!==G){for(y===0&&(y=m),O+=p,g=u-y,w=1<<g;g+y<f&&(w-=P[g+y],!(w<=0));)g++,w<<=1;if(x+=1<<g,e===HQ&&x>dDe||e===fDe&&x>uDe)return 1;G=T&F,o[G]=m<<24|g<<16|O-s|0}}return T!==0&&(o[O+T]=u-y<<24|64<<16|0),c.bits=m,0}});var KDe=z(Eh=>{"use strict";var Cd=Xm(),UQ=TQ(),pp=RQ(),JSt=lDe(),A2=mDe(),eEt=0,jDe=1,zDe=2,gDe=4,tEt=5,mV=6,hw=0,iEt=1,rEt=2,xu=-2,WDe=-3,qQ=-4,nEt=-5,vDe=8,UDe=1,bDe=2,_De=3,yDe=4,wDe=5,CDe=6,xDe=7,SDe=8,EDe=9,TDe=10,bV=11,Qm=12,BQ=13,RDe=14,VQ=15,ADe=16,IDe=17,DDe=18,MDe=19,gV=20,vV=21,kDe=22,ODe=23,NDe=24,PDe=25,LDe=26,jQ=27,FDe=28,HDe=29,xo=30,YQ=31,oEt=32,sEt=852,aEt=592,lEt=15,cEt=lEt;function BDe(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function dEt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Cd.Buf16(320),this.work=new Cd.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function qDe(t){var e;return!t||!t.state?xu:(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=UDe,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Cd.Buf32(sEt),e.distcode=e.distdyn=new Cd.Buf32(aEt),e.sane=1,e.back=-1,hw)}function YDe(t){var e;return!t||!t.state?xu:(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,qDe(t))}function $De(t,e){var i,r;return!t||!t.state||(r=t.state,e<0?(i=0,e=-e):(i=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?xu:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=i,r.wbits=e,YDe(t))}function GDe(t,e){var i,r;return t?(r=new dEt,t.state=r,r.window=null,i=$De(t,e),i!==hw&&(t.state=null),i):xu}function uEt(t){return GDe(t,cEt)}var VDe=!0,zQ,WQ;function hEt(t){if(VDe){var e;for(zQ=new Cd.Buf32(512),WQ=new Cd.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(A2(jDe,t.lens,0,288,zQ,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;A2(zDe,t.lens,0,32,WQ,0,t.work,{bits:5}),VDe=!1}t.lencode=zQ,t.lenbits=9,t.distcode=WQ,t.distbits=5}function XDe(t,e,i,r){var n,o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Cd.Buf8(o.wsize)),r>=o.wsize?(Cd.arraySet(o.window,e,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(n=o.wsize-o.wnext,n>r&&(n=r),Cd.arraySet(o.window,e,i-r,n,o.wnext),r-=n,r?(Cd.arraySet(o.window,e,i-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0}function fEt(t,e){var i,r,n,o,s,a,c,d,u,h,p,f,m,g,y=0,w,x,T,M,B,G,F,O,V=new Cd.Buf8(4),J,N,P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return xu;i=t.state,i.mode===Qm&&(i.mode=BQ),s=t.next_out,n=t.output,c=t.avail_out,o=t.next_in,r=t.input,a=t.avail_in,d=i.hold,u=i.bits,h=a,p=c,O=hw;e:for(;;)switch(i.mode){case UDe:if(i.wrap===0){i.mode=BQ;break}for(;u<16;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(i.wrap&2&&d===35615){i.check=0,V[0]=d&255,V[1]=d>>>8&255,i.check=pp(i.check,V,2,0),d=0,u=0,i.mode=bDe;break}if(i.flags=0,i.head&&(i.head.done=!1),!(i.wrap&1)||(((d&255)<<8)+(d>>8))%31){t.msg="incorrect header check",i.mode=xo;break}if((d&15)!==vDe){t.msg="unknown compression method",i.mode=xo;break}if(d>>>=4,u-=4,F=(d&15)+8,i.wbits===0)i.wbits=F;else if(F>i.wbits){t.msg="invalid window size",i.mode=xo;break}i.dmax=1<<F,t.adler=i.check=1,i.mode=d&512?TDe:Qm,d=0,u=0;break;case bDe:for(;u<16;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(i.flags=d,(i.flags&255)!==vDe){t.msg="unknown compression method",i.mode=xo;break}if(i.flags&57344){t.msg="unknown header flags set",i.mode=xo;break}i.head&&(i.head.text=d>>8&1),i.flags&512&&(V[0]=d&255,V[1]=d>>>8&255,i.check=pp(i.check,V,2,0)),d=0,u=0,i.mode=_De;case _De:for(;u<32;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}i.head&&(i.head.time=d),i.flags&512&&(V[0]=d&255,V[1]=d>>>8&255,V[2]=d>>>16&255,V[3]=d>>>24&255,i.check=pp(i.check,V,4,0)),d=0,u=0,i.mode=yDe;case yDe:for(;u<16;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}i.head&&(i.head.xflags=d&255,i.head.os=d>>8),i.flags&512&&(V[0]=d&255,V[1]=d>>>8&255,i.check=pp(i.check,V,2,0)),d=0,u=0,i.mode=wDe;case wDe:if(i.flags&1024){for(;u<16;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}i.length=d,i.head&&(i.head.extra_len=d),i.flags&512&&(V[0]=d&255,V[1]=d>>>8&255,i.check=pp(i.check,V,2,0)),d=0,u=0}else i.head&&(i.head.extra=null);i.mode=CDe;case CDe:if(i.flags&1024&&(f=i.length,f>a&&(f=a),f&&(i.head&&(F=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),Cd.arraySet(i.head.extra,r,o,f,F)),i.flags&512&&(i.check=pp(i.check,r,f,o)),a-=f,o+=f,i.length-=f),i.length))break e;i.length=0,i.mode=xDe;case xDe:if(i.flags&2048){if(a===0)break e;f=0;do F=r[o+f++],i.head&&F&&i.length<65536&&(i.head.name+=String.fromCharCode(F));while(F&&f<a);if(i.flags&512&&(i.check=pp(i.check,r,f,o)),a-=f,o+=f,F)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=SDe;case SDe:if(i.flags&4096){if(a===0)break e;f=0;do F=r[o+f++],i.head&&F&&i.length<65536&&(i.head.comment+=String.fromCharCode(F));while(F&&f<a);if(i.flags&512&&(i.check=pp(i.check,r,f,o)),a-=f,o+=f,F)break e}else i.head&&(i.head.comment=null);i.mode=EDe;case EDe:if(i.flags&512){for(;u<16;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(d!==(i.check&65535)){t.msg="header crc mismatch",i.mode=xo;break}d=0,u=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Qm;break;case TDe:for(;u<32;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}t.adler=i.check=BDe(d),d=0,u=0,i.mode=bV;case bV:if(i.havedict===0)return t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,i.hold=d,i.bits=u,rEt;t.adler=i.check=1,i.mode=Qm;case Qm:if(e===tEt||e===mV)break e;case BQ:if(i.last){d>>>=u&7,u-=u&7,i.mode=jQ;break}for(;u<3;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}switch(i.last=d&1,d>>>=1,u-=1,d&3){case 0:i.mode=RDe;break;case 1:if(hEt(i),i.mode=gV,e===mV){d>>>=2,u-=2;break e}break;case 2:i.mode=IDe;break;case 3:t.msg="invalid block type",i.mode=xo}d>>>=2,u-=2;break;case RDe:for(d>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){t.msg="invalid stored block lengths",i.mode=xo;break}if(i.length=d&65535,d=0,u=0,i.mode=VQ,e===mV)break e;case VQ:i.mode=ADe;case ADe:if(f=i.length,f){if(f>a&&(f=a),f>c&&(f=c),f===0)break e;Cd.arraySet(n,r,o,f,s),a-=f,o+=f,c-=f,s+=f,i.length-=f;break}i.mode=Qm;break;case IDe:for(;u<14;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(i.nlen=(d&31)+257,d>>>=5,u-=5,i.ndist=(d&31)+1,d>>>=5,u-=5,i.ncode=(d&15)+4,d>>>=4,u-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=xo;break}i.have=0,i.mode=DDe;case DDe:for(;i.have<i.ncode;){for(;u<3;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}i.lens[P[i.have++]]=d&7,d>>>=3,u-=3}for(;i.have<19;)i.lens[P[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,J={bits:i.lenbits},O=A2(eEt,i.lens,0,19,i.lencode,0,i.work,J),i.lenbits=J.bits,O){t.msg="invalid code lengths set",i.mode=xo;break}i.have=0,i.mode=MDe;case MDe:for(;i.have<i.nlen+i.ndist;){for(;y=i.lencode[d&(1<<i.lenbits)-1],w=y>>>24,x=y>>>16&255,T=y&65535,!(w<=u);){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(T<16)d>>>=w,u-=w,i.lens[i.have++]=T;else{if(T===16){for(N=w+2;u<N;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(d>>>=w,u-=w,i.have===0){t.msg="invalid bit length repeat",i.mode=xo;break}F=i.lens[i.have-1],f=3+(d&3),d>>>=2,u-=2}else if(T===17){for(N=w+3;u<N;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}d>>>=w,u-=w,F=0,f=3+(d&7),d>>>=3,u-=3}else{for(N=w+7;u<N;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}d>>>=w,u-=w,F=0,f=11+(d&127),d>>>=7,u-=7}if(i.have+f>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=xo;break}for(;f--;)i.lens[i.have++]=F}}if(i.mode===xo)break;if(i.lens[256]===0){t.msg="invalid code -- missing end-of-block",i.mode=xo;break}if(i.lenbits=9,J={bits:i.lenbits},O=A2(jDe,i.lens,0,i.nlen,i.lencode,0,i.work,J),i.lenbits=J.bits,O){t.msg="invalid literal/lengths set",i.mode=xo;break}if(i.distbits=6,i.distcode=i.distdyn,J={bits:i.distbits},O=A2(zDe,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,J),i.distbits=J.bits,O){t.msg="invalid distances set",i.mode=xo;break}if(i.mode=gV,e===mV)break e;case gV:i.mode=vV;case vV:if(a>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,i.hold=d,i.bits=u,JSt(t,p),s=t.next_out,n=t.output,c=t.avail_out,o=t.next_in,r=t.input,a=t.avail_in,d=i.hold,u=i.bits,i.mode===Qm&&(i.back=-1);break}for(i.back=0;y=i.lencode[d&(1<<i.lenbits)-1],w=y>>>24,x=y>>>16&255,T=y&65535,!(w<=u);){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(x&&!(x&240)){for(M=w,B=x,G=T;y=i.lencode[G+((d&(1<<M+B)-1)>>M)],w=y>>>24,x=y>>>16&255,T=y&65535,!(M+w<=u);){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}d>>>=M,u-=M,i.back+=M}if(d>>>=w,u-=w,i.back+=w,i.length=T,x===0){i.mode=LDe;break}if(x&32){i.back=-1,i.mode=Qm;break}if(x&64){t.msg="invalid literal/length code",i.mode=xo;break}i.extra=x&15,i.mode=kDe;case kDe:if(i.extra){for(N=i.extra;u<N;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}i.length+=d&(1<<i.extra)-1,d>>>=i.extra,u-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=ODe;case ODe:for(;y=i.distcode[d&(1<<i.distbits)-1],w=y>>>24,x=y>>>16&255,T=y&65535,!(w<=u);){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(!(x&240)){for(M=w,B=x,G=T;y=i.distcode[G+((d&(1<<M+B)-1)>>M)],w=y>>>24,x=y>>>16&255,T=y&65535,!(M+w<=u);){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}d>>>=M,u-=M,i.back+=M}if(d>>>=w,u-=w,i.back+=w,x&64){t.msg="invalid distance code",i.mode=xo;break}i.offset=T,i.extra=x&15,i.mode=NDe;case NDe:if(i.extra){for(N=i.extra;u<N;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}i.offset+=d&(1<<i.extra)-1,d>>>=i.extra,u-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=xo;break}i.mode=PDe;case PDe:if(c===0)break e;if(f=p-c,i.offset>f){if(f=i.offset-f,f>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=xo;break}f>i.wnext?(f-=i.wnext,m=i.wsize-f):m=i.wnext-f,f>i.length&&(f=i.length),g=i.window}else g=n,m=s-i.offset,f=i.length;f>c&&(f=c),c-=f,i.length-=f;do n[s++]=g[m++];while(--f);i.length===0&&(i.mode=vV);break;case LDe:if(c===0)break e;n[s++]=i.length,c--,i.mode=vV;break;case jQ:if(i.wrap){for(;u<32;){if(a===0)break e;a--,d|=r[o++]<<u,u+=8}if(p-=c,t.total_out+=p,i.total+=p,p&&(t.adler=i.check=i.flags?pp(i.check,n,p,s-p):UQ(i.check,n,p,s-p)),p=c,(i.flags?d:BDe(d))!==i.check){t.msg="incorrect data check",i.mode=xo;break}d=0,u=0}i.mode=FDe;case FDe:if(i.wrap&&i.flags){for(;u<32;){if(a===0)break e;a--,d+=r[o++]<<u,u+=8}if(d!==(i.total&4294967295)){t.msg="incorrect length check",i.mode=xo;break}d=0,u=0}i.mode=HDe;case HDe:O=iEt;break e;case xo:O=WDe;break e;case YQ:return qQ;case oEt:default:return xu}return t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,i.hold=d,i.bits=u,(i.wsize||p!==t.avail_out&&i.mode<xo&&(i.mode<jQ||e!==gDe))&&XDe(t,t.output,t.next_out,p-t.avail_out)?(i.mode=YQ,qQ):(h-=t.avail_in,p-=t.avail_out,t.total_in+=h,t.total_out+=p,i.total+=p,i.wrap&&p&&(t.adler=i.check=i.flags?pp(i.check,n,p,t.next_out-p):UQ(i.check,n,p,t.next_out-p)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Qm?128:0)+(i.mode===gV||i.mode===VQ?256:0),(h===0&&p===0||e===gDe)&&O===hw&&(O=nEt),O)}function pEt(t){if(!t||!t.state)return xu;var e=t.state;return e.window&&(e.window=null),t.state=null,hw}function mEt(t,e){var i;return!t||!t.state||(i=t.state,!(i.wrap&2))?xu:(i.head=e,e.done=!1,hw)}function gEt(t,e){var i=e.length,r,n,o;return!t||!t.state||(r=t.state,r.wrap!==0&&r.mode!==bV)?xu:r.mode===bV&&(n=1,n=UQ(n,e,i,0),n!==r.check)?WDe:(o=XDe(t,e,i,i),o?(r.mode=YQ,qQ):(r.havedict=1,hw))}Eh.inflateReset=YDe;Eh.inflateReset2=$De;Eh.inflateResetKeep=qDe;Eh.inflateInit=uEt;Eh.inflateInit2=GDe;Eh.inflate=fEt;Eh.inflateEnd=pEt;Eh.inflateGetHeader=mEt;Eh.inflateSetDictionary=gEt;Eh.inflateInfo="pako inflate (from Nodeca project)"});var $Q=z((XGi,ZDe)=>{"use strict";ZDe.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var JDe=z((KGi,QDe)=>{"use strict";function vEt(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}QDe.exports=vEt});var tMe=z(D2=>{"use strict";var IE=KDe(),I2=Xm(),_V=kQ(),fs=$Q(),GQ=sV(),bEt=OQ(),_Et=JDe(),eMe=Object.prototype.toString;function fw(t){if(!(this instanceof fw))return new fw(t);this.options=I2.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new bEt,this.strm.avail_out=0;var i=IE.inflateInit2(this.strm,e.windowBits);if(i!==fs.Z_OK)throw new Error(GQ[i]);if(this.header=new _Et,IE.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=_V.string2buf(e.dictionary):eMe.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=IE.inflateSetDictionary(this.strm,e.dictionary),i!==fs.Z_OK)))throw new Error(GQ[i])}fw.prototype.push=function(t,e){var i=this.strm,r=this.options.chunkSize,n=this.options.dictionary,o,s,a,c,d,u=!1;if(this.ended)return!1;s=e===~~e?e:e===!0?fs.Z_FINISH:fs.Z_NO_FLUSH,typeof t=="string"?i.input=_V.binstring2buf(t):eMe.call(t)==="[object ArrayBuffer]"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new I2.Buf8(r),i.next_out=0,i.avail_out=r),o=IE.inflate(i,fs.Z_NO_FLUSH),o===fs.Z_NEED_DICT&&n&&(o=IE.inflateSetDictionary(this.strm,n)),o===fs.Z_BUF_ERROR&&u===!0&&(o=fs.Z_OK,u=!1),o!==fs.Z_STREAM_END&&o!==fs.Z_OK)return this.onEnd(o),this.ended=!0,!1;i.next_out&&(i.avail_out===0||o===fs.Z_STREAM_END||i.avail_in===0&&(s===fs.Z_FINISH||s===fs.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=_V.utf8border(i.output,i.next_out),c=i.next_out-a,d=_V.buf2string(i.output,a),i.next_out=c,i.avail_out=r-c,c&&I2.arraySet(i.output,i.output,a,c,0),this.onData(d)):this.onData(I2.shrinkBuf(i.output,i.next_out))),i.avail_in===0&&i.avail_out===0&&(u=!0)}while((i.avail_in>0||i.avail_out===0)&&o!==fs.Z_STREAM_END);return o===fs.Z_STREAM_END&&(s=fs.Z_FINISH),s===fs.Z_FINISH?(o=IE.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===fs.Z_OK):(s===fs.Z_SYNC_FLUSH&&(this.onEnd(fs.Z_OK),i.avail_out=0),!0)};fw.prototype.onData=function(t){this.chunks.push(t)};fw.prototype.onEnd=function(t){t===fs.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=I2.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function XQ(t,e){var i=new fw(e);if(i.push(t,!0),i.err)throw i.msg||GQ[i.err];return i.result}function yEt(t,e){return e=e||{},e.raw=!0,XQ(t,e)}D2.Inflate=fw;D2.inflate=XQ;D2.inflateRaw=yEt;D2.ungzip=XQ});var nMe=z((QGi,rMe)=>{"use strict";var wEt=Xm().assign,CEt=sDe(),xEt=tMe(),SEt=$Q(),iMe={};wEt(iMe,CEt,xEt,SEt);rMe.exports=iMe});var sMe=z(wV=>{"use strict";var EEt=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",TEt=nMe(),oMe=No(),yV=wd(),REt=EEt?"uint8array":"array";wV.magic="\b\0";function pw(t,e){yV.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}oMe.inherits(pw,yV);pw.prototype.processChunk=function(t){this.meta=t.meta,this._pako===null&&this._createPako(),this._pako.push(oMe.transformTo(REt,t.data),!1)};pw.prototype.flush=function(){yV.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)};pw.prototype.cleanUp=function(){yV.prototype.cleanUp.call(this),this._pako=null};pw.prototype._createPako=function(){this._pako=new TEt[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}};wV.compressWorker=function(t){return new pw("Deflate",t)};wV.uncompressWorker=function(){return new pw("Inflate",{})}});var ZQ=z(KQ=>{"use strict";var aMe=wd();KQ.STORE={magic:"\0\0",compressWorker:function(){return new aMe("STORE compression")},uncompressWorker:function(){return new aMe("STORE decompression")}};KQ.DEFLATE=sMe()});var QQ=z(mw=>{"use strict";mw.LOCAL_FILE_HEADER="PK";mw.CENTRAL_FILE_HEADER="PK";mw.CENTRAL_DIRECTORY_END="PK";mw.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07";mw.ZIP64_CENTRAL_DIRECTORY_END="PK";mw.DATA_DESCRIPTOR="PK\x07\b"});var uMe=z((iXi,dMe)=>{"use strict";var DE=No(),ME=wd(),JQ=bE(),lMe=tV(),CV=QQ(),Kn=function(t,e){var i="",r;for(r=0;r<e;r++)i+=String.fromCharCode(t&255),t=t>>>8;return i},AEt=function(t,e){var i=t;return t||(i=e?16893:33204),(i&65535)<<16},IEt=function(t){return(t||0)&63},cMe=function(t,e,i,r,n,o){var s=t.file,a=t.compression,c=o!==JQ.utf8encode,d=DE.transformTo("string",o(s.name)),u=DE.transformTo("string",JQ.utf8encode(s.name)),h=s.comment,p=DE.transformTo("string",o(h)),f=DE.transformTo("string",JQ.utf8encode(h)),m=u.length!==s.name.length,g=f.length!==h.length,y,w,x="",T="",M="",B=s.dir,G=s.date,F={crc32:0,compressedSize:0,uncompressedSize:0};(!e||i)&&(F.crc32=t.crc32,F.compressedSize=t.compressedSize,F.uncompressedSize=t.uncompressedSize);var O=0;e&&(O|=8),!c&&(m||g)&&(O|=2048);var V=0,J=0;B&&(V|=16),n==="UNIX"?(J=798,V|=AEt(s.unixPermissions,B)):(J=20,V|=IEt(s.dosPermissions,B)),y=G.getUTCHours(),y=y<<6,y=y|G.getUTCMinutes(),y=y<<5,y=y|G.getUTCSeconds()/2,w=G.getUTCFullYear()-1980,w=w<<4,w=w|G.getUTCMonth()+1,w=w<<5,w=w|G.getUTCDate(),m&&(T=Kn(1,1)+Kn(lMe(d),4)+u,x+="up"+Kn(T.length,2)+T),g&&(M=Kn(1,1)+Kn(lMe(p),4)+f,x+="uc"+Kn(M.length,2)+M);var N="";N+=`
\0`,N+=Kn(O,2),N+=a.magic,N+=Kn(y,2),N+=Kn(w,2),N+=Kn(F.crc32,4),N+=Kn(F.compressedSize,4),N+=Kn(F.uncompressedSize,4),N+=Kn(d.length,2),N+=Kn(x.length,2);var P=CV.LOCAL_FILE_HEADER+N+d+x,$=CV.CENTRAL_FILE_HEADER+Kn(J,2)+N+Kn(p.length,2)+"\0\0\0\0"+Kn(V,4)+Kn(r,4)+d+x+p;return{fileRecord:P,dirRecord:$}},DEt=function(t,e,i,r,n){var o="",s=DE.transformTo("string",n(r));return o=CV.CENTRAL_DIRECTORY_END+"\0\0\0\0"+Kn(t,2)+Kn(t,2)+Kn(e,4)+Kn(i,4)+Kn(s.length,2)+s,o},MEt=function(t){var e="";return e=CV.DATA_DESCRIPTOR+Kn(t.crc32,4)+Kn(t.compressedSize,4)+Kn(t.uncompressedSize,4),e};function Th(t,e,i,r){ME.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=i,this.encodeFileName=r,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}DE.inherits(Th,ME);Th.prototype.push=function(t){var e=t.meta.percent||0,i=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,ME.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:i?(e+100*(i-r-1))/i:100}}))};Th.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var i=cMe(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0};Th.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,i=cMe(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),e)this.push({data:MEt(t),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null};Th.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var i=this.bytesWritten-t,r=DEt(this.dirRecords.length,i,t,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})};Th.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()};Th.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",function(i){e.processChunk(i)}),t.on("end",function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()}),t.on("error",function(i){e.error(i)}),this};Th.prototype.resume=function(){if(!ME.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0};Th.prototype.error=function(t){var e=this._sources;if(!ME.prototype.error.call(this,t))return!1;for(var i=0;i<e.length;i++)try{e[i].error(t)}catch{}return!0};Th.prototype.lock=function(){ME.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()};dMe.exports=Th});var fMe=z(hMe=>{"use strict";var kEt=ZQ(),OEt=uMe(),NEt=function(t,e){var i=t||e,r=kEt[i];if(!r)throw new Error(i+" is not a valid compression method !");return r};hMe.generateWorker=function(t,e,i){var r=new OEt(e.streamFiles,i,e.platform,e.encodeFileName),n=0;try{t.forEach(function(o,s){n++;var a=NEt(s.options.compression,e.compression),c=s.options.compressionOptions||e.compressionOptions||{},d=s.dir,u=s.date;s._compressWorker(a,c).withStreamInfo("file",{name:o,dir:d,date:u,comment:s.comment||"",unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions}).pipe(r)}),r.entriesCount=n}catch(o){r.error(o)}return r}});var mMe=z((nXi,pMe)=>{"use strict";var PEt=No(),xV=wd();function M2(t,e){xV.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}PEt.inherits(M2,xV);M2.prototype._bindStream=function(t){var e=this;this._stream=t,t.pause(),t.on("data",function(i){e.push({data:i,meta:{percent:0}})}).on("error",function(i){e.isPaused?this.generatedError=i:e.error(i)}).on("end",function(){e.isPaused?e._upstreamEnded=!0:e.end()})};M2.prototype.pause=function(){return xV.prototype.pause.call(this)?(this._stream.pause(),!0):!1};M2.prototype.resume=function(){return xV.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};pMe.exports=M2});var EMe=z((oXi,SMe)=>{"use strict";var LEt=bE(),k2=No(),_Me=wd(),FEt=nQ(),yMe=oQ(),gMe=iV(),HEt=vIe(),BEt=fMe(),vMe=a2(),VEt=mMe(),wMe=function(t,e,i){var r=k2.getTypeOf(e),n,o=k2.extend(i||{},yMe);o.date=o.date||new Date,o.compression!==null&&(o.compression=o.compression.toUpperCase()),typeof o.unixPermissions=="string"&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&o.unixPermissions&16384&&(o.dir=!0),o.dosPermissions&&o.dosPermissions&16&&(o.dir=!0),o.dir&&(t=CMe(t)),o.createFolders&&(n=jEt(t))&&xMe.call(this,n,!0);var s=r==="string"&&o.binary===!1&&o.base64===!1;(!i||typeof i.binary>"u")&&(o.binary=!s);var a=e instanceof gMe&&e.uncompressedSize===0;(a||o.dir||!e||e.length===0)&&(o.base64=!1,o.binary=!0,e="",o.compression="STORE",r="string");var c=null;e instanceof gMe||e instanceof _Me?c=e:vMe.isNode&&vMe.isStream(e)?c=new VEt(t,e):c=k2.prepareContent(t,e,o.binary,o.optimizedBinaryString,o.base64);var d=new HEt(t,c,o);this.files[t]=d},jEt=function(t){t.slice(-1)==="/"&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},CMe=function(t){return t.slice(-1)!=="/"&&(t+="/"),t},xMe=function(t,e){return e=typeof e<"u"?e:yMe.createFolders,t=CMe(t),this.files[t]||wMe.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function bMe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var zEt={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,i,r;for(e in this.files)r=this.files[e],i=e.slice(this.root.length,e.length),i&&e.slice(0,this.root.length)===this.root&&t(i,r)},filter:function(t){var e=[];return this.forEach(function(i,r){t(i,r)&&e.push(r)}),e},file:function(t,e,i){if(arguments.length===1)if(bMe(t)){var r=t;return this.filter(function(o,s){return!s.dir&&r.test(o)})}else{var n=this.files[this.root+t];return n&&!n.dir?n:null}else t=this.root+t,wMe.call(this,t,e,i);return this},folder:function(t){if(!t)return this;if(bMe(t))return this.filter(function(n,o){return o.dir&&t.test(n)});var e=this.root+t,i=xMe.call(this,e),r=this.clone();return r.root=i.name,r},remove:function(t){t=this.root+t;var e=this.files[t];if(e||(t.slice(-1)!=="/"&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var i=this.filter(function(n,o){return o.name.slice(0,t.length)===t}),r=0;r<i.length;r++)delete this.files[i[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,i={};try{if(i=k2.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:LEt.utf8encode}),i.type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),i.type==="binarystring"&&(i.type="string"),!i.type)throw new Error("No output type specified.");k2.checkSupport(i.type),(i.platform==="darwin"||i.platform==="freebsd"||i.platform==="linux"||i.platform==="sunos")&&(i.platform="UNIX"),i.platform==="win32"&&(i.platform="DOS");var r=i.comment||this.comment||"";e=BEt.generateWorker(this,i,r)}catch(n){e=new _Me("error"),e.error(n)}return new FEt(e,i.type||"string",i.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return t=t||{},t.type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};SMe.exports=zEt});var eJ=z((sXi,RMe)=>{"use strict";var WEt=No();function TMe(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}TMe.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var e=0,i;for(this.checkOffset(t),i=this.index+t-1;i>=this.index;i--)e=(e<<8)+this.byteAt(i);return this.index+=t,e},readString:function(t){return WEt.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(t&31)<<1))}};RMe.exports=TMe});var tJ=z((aXi,IMe)=>{"use strict";var AMe=eJ(),UEt=No();function kE(t){AMe.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=t[e]&255}UEt.inherits(kE,AMe);kE.prototype.byteAt=function(t){return this.data[this.zero+t]};kE.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),i=t.charCodeAt(1),r=t.charCodeAt(2),n=t.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===e&&this.data[o+1]===i&&this.data[o+2]===r&&this.data[o+3]===n)return o-this.zero;return-1};kE.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),i=t.charCodeAt(1),r=t.charCodeAt(2),n=t.charCodeAt(3),o=this.readData(4);return e===o[0]&&i===o[1]&&r===o[2]&&n===o[3]};kE.prototype.readData=function(t){if(this.checkOffset(t),t===0)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};IMe.exports=kE});var kMe=z((lXi,MMe)=>{"use strict";var DMe=eJ(),qEt=No();function OE(t){DMe.call(this,t)}qEt.inherits(OE,DMe);OE.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)};OE.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero};OE.prototype.readAndCheckSignature=function(t){var e=this.readData(4);return t===e};OE.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};MMe.exports=OE});var rJ=z((cXi,NMe)=>{"use strict";var OMe=tJ(),YEt=No();function iJ(t){OMe.call(this,t)}YEt.inherits(iJ,OMe);iJ.prototype.readData=function(t){if(this.checkOffset(t),t===0)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};NMe.exports=iJ});var FMe=z((dXi,LMe)=>{"use strict";var PMe=rJ(),$Et=No();function nJ(t){PMe.call(this,t)}$Et.inherits(nJ,PMe);nJ.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};LMe.exports=nJ});var oJ=z((uXi,BMe)=>{"use strict";var SV=No(),HMe=$m(),GEt=tJ(),XEt=kMe(),KEt=FMe(),ZEt=rJ();BMe.exports=function(t){var e=SV.getTypeOf(t);return SV.checkSupport(e),e==="string"&&!HMe.uint8array?new XEt(t):e==="nodebuffer"?new KEt(t):HMe.uint8array?new ZEt(SV.transformTo("uint8array",t)):new GEt(SV.transformTo("array",t))}});var WMe=z((hXi,zMe)=>{"use strict";var sJ=oJ(),Kb=No(),QEt=iV(),VMe=tV(),EV=bE(),TV=ZQ(),JEt=$m(),eTt=0,tTt=3,iTt=function(t){for(var e in TV)if(Object.prototype.hasOwnProperty.call(TV,e)&&TV[e].magic===t)return TV[e];return null};function jMe(t,e){this.options=t,this.loadOptions=e}jMe.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(t){var e,i;if(t.skip(22),this.fileNameLength=t.readInt(2),i=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(i),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(e=iTt(this.compressionMethod),e===null)throw new Error("Corrupted zip : compression "+Kb.pretty(this.compressionMethod)+" unknown (inner file : "+Kb.transformTo("string",this.fileName)+")");this.decompressed=new QEt(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),t===eTt&&(this.dosPermissions=this.externalFileAttributes&63),t===tTt&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=sJ(this.extraFields[1].value);this.uncompressedSize===Kb.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===Kb.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===Kb.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===Kb.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var e=t.index+this.extraFieldsLength,i,r,n;for(this.extraFields||(this.extraFields={});t.index+4<e;)i=t.readInt(2),r=t.readInt(2),n=t.readData(r),this.extraFields[i]={id:i,length:r,value:n};t.setIndex(e)},handleUTF8:function(){var t=JEt.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=EV.utf8decode(this.fileName),this.fileCommentStr=EV.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(e!==null)this.fileNameStr=e;else{var i=Kb.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var r=this.findExtraFieldUnicodeComment();if(r!==null)this.fileCommentStr=r;else{var n=Kb.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(n)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=sJ(t.value);return e.readInt(1)!==1||VMe(this.fileName)!==e.readInt(4)?null:EV.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=sJ(t.value);return e.readInt(1)!==1||VMe(this.fileComment)!==e.readInt(4)?null:EV.utf8decode(e.readData(t.length-5))}return null}};zMe.exports=jMe});var YMe=z((fXi,qMe)=>{"use strict";var rTt=oJ(),Jm=No(),Rh=QQ(),nTt=WMe(),oTt=$m();function UMe(t){this.files=[],this.loadOptions=t}UMe.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+Jm.pretty(e)+", expected "+Jm.pretty(t)+")")}},isSignature:function(t,e){var i=this.reader.index;this.reader.setIndex(t);var r=this.reader.readString(4),n=r===e;return this.reader.setIndex(i),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=oTt.uint8array?"uint8array":"array",i=Jm.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t=this.zip64EndOfCentralSize-44,e=0,i,r,n;e<t;)i=this.reader.readInt(2),r=this.reader.readInt(4),n=this.reader.readData(r),this.zip64ExtensibleData[i]={id:i,length:r,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(Rh.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(Rh.CENTRAL_FILE_HEADER);)t=new nTt({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(Rh.CENTRAL_DIRECTORY_END);if(t<0){var e=!this.isSignature(0,Rh.LOCAL_FILE_HEADER);throw e?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(t);var i=t;if(this.checkSignature(Rh.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===Jm.MAX_VALUE_16BITS||this.diskWithCentralDirStart===Jm.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===Jm.MAX_VALUE_16BITS||this.centralDirRecords===Jm.MAX_VALUE_16BITS||this.centralDirSize===Jm.MAX_VALUE_32BITS||this.centralDirOffset===Jm.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(Rh.ZIP64_CENTRAL_DIRECTORY_LOCATOR),t<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(Rh.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Rh.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Rh.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(Rh.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=i-r;if(n>0)this.isSignature(i,Rh.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(t){this.reader=rTt(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};qMe.exports=UMe});var XMe=z((pXi,GMe)=>{"use strict";var aJ=No(),RV=mE(),sTt=bE(),aTt=YMe(),lTt=lQ(),$Me=a2();function cTt(t){return new RV.Promise(function(e,i){var r=t.decompressed.getContentWorker().pipe(new lTt);r.on("error",function(n){i(n)}).on("end",function(){r.streamInfo.crc32!==t.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):e()}).resume()})}GMe.exports=function(t,e){var i=this;return e=aJ.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:sTt.utf8decode}),$Me.isNode&&$Me.isStream(t)?RV.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):aJ.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then(function(r){var n=new aTt(e);return n.load(r),n}).then(function(n){var o=[RV.Promise.resolve(n)],s=n.files;if(e.checkCRC32)for(var a=0;a<s.length;a++)o.push(cTt(s[a]));return RV.Promise.all(o)}).then(function(n){for(var o=n.shift(),s=o.files,a=0;a<s.length;a++){var c=s[a],d=c.fileNameStr,u=aJ.resolve(c.fileNameStr);i.file(u,c.decompressed,{binary:!0,optimizedBinaryString:!0,date:c.date,dir:c.dir,comment:c.fileCommentStr.length?c.fileCommentStr:null,unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions,createFolders:e.createFolders}),c.dir||(i.file(u).unsafeOriginalName=d)}return o.zipComment.length&&(i.comment=o.zipComment),i})}});var lJ=z((mXi,KMe)=>{"use strict";function Su(){if(!(this instanceof Su))return new Su;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new Su;for(var e in this)typeof this[e]!="function"&&(t[e]=this[e]);return t}}Su.prototype=EMe();Su.prototype.loadAsync=XMe();Su.support=$m();Su.defaults=oQ();Su.version="3.10.1";Su.loadAsync=function(t,e){return new Su().loadAsync(t,e)};Su.external=mE();KMe.exports=Su});var cJ=z((gXi,ZMe)=>{"use strict";ZMe.exports=Ze("stream")});var rke=z((vXi,ike)=>{"use strict";function QMe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),i.push.apply(i,r)}return i}function JMe(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?QMe(Object(i),!0).forEach(function(r){dTt(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):QMe(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function dTt(t,e,i){return e=tke(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function uTt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eke(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tke(r.key),r)}}function hTt(t,e,i){return e&&eke(t.prototype,e),i&&eke(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function tke(t){var e=fTt(t,"string");return typeof e=="symbol"?e:String(e)}function fTt(t,e){if(typeof t!="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var pTt=Ze("buffer"),AV=pTt.Buffer,mTt=Ze("util"),dJ=mTt.inspect,gTt=dJ&&dJ.custom||"inspect";function vTt(t,e,i){AV.prototype.copy.call(t,e,i)}ike.exports=function(){function t(){uTt(this,t),this.head=null,this.tail=null,this.length=0}return hTt(t,[{key:"push",value:function(i){var r={data:i,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}},{key:"unshift",value:function(i){var r={data:i,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}},{key:"shift",value:function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(i){if(this.length===0)return"";for(var r=this.head,n=""+r.data;r=r.next;)n+=i+r.data;return n}},{key:"concat",value:function(i){if(this.length===0)return AV.alloc(0);for(var r=AV.allocUnsafe(i>>>0),n=this.head,o=0;n;)vTt(n.data,r,o),o+=n.data.length,n=n.next;return r}},{key:"consume",value:function(i,r){var n;return i<this.head.data.length?(n=this.head.data.slice(0,i),this.head.data=this.head.data.slice(i)):i===this.head.data.length?n=this.shift():n=r?this._getString(i):this._getBuffer(i),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(i){var r=this.head,n=1,o=r.data;for(i-=o.length;r=r.next;){var s=r.data,a=i>s.length?s.length:i;if(a===s.length?o+=s:o+=s.slice(0,i),i-=a,i===0){a===s.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=s.slice(a));break}++n}return this.length-=n,o}},{key:"_getBuffer",value:function(i){var r=AV.allocUnsafe(i),n=this.head,o=1;for(n.data.copy(r),i-=n.data.length;n=n.next;){var s=n.data,a=i>s.length?s.length:i;if(s.copy(r,r.length-i,0,a),i-=a,i===0){a===s.length?(++o,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=s.slice(a));break}++o}return this.length-=o,r}},{key:gTt,value:function(i,r){return dJ(this,JMe(JMe({},r),{},{depth:0,customInspect:!1}))}}]),t}()});var hJ=z((bXi,oke)=>{"use strict";function bTt(t,e){var i=this,r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(uJ,this,t)):process.nextTick(uJ,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?i._writableState?i._writableState.errorEmitted?process.nextTick(IV,i):(i._writableState.errorEmitted=!0,process.nextTick(nke,i,o)):process.nextTick(nke,i,o):e?(process.nextTick(IV,i),e(o)):process.nextTick(IV,i)}),this)}function nke(t,e){uJ(t,e),IV(t)}function IV(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function _Tt(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function uJ(t,e){t.emit("error",e)}function yTt(t,e){var i=t._readableState,r=t._writableState;i&&i.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}oke.exports={destroy:bTt,undestroy:_Tt,errorOrDestroy:yTt}});var Zb=z((_Xi,lke)=>{"use strict";var ake={};function Eu(t,e,i){i||(i=Error);function r(o,s,a){return typeof e=="string"?e:e(o,s,a)}class n extends i{constructor(s,a,c){super(r(s,a,c))}}n.prototype.name=i.name,n.prototype.code=t,ake[t]=n}function ske(t,e){if(Array.isArray(t)){let i=t.length;return t=t.map(r=>String(r)),i>2?`one of ${e} ${t.slice(0,i-1).join(", ")}, or `+t[i-1]:i===2?`one of ${e} ${t[0]} or ${t[1]}`:`of ${e} ${t[0]}`}else return`of ${e} ${String(t)}`}function wTt(t,e,i){return t.substr(!i||i<0?0:+i,e.length)===e}function CTt(t,e,i){return(i===void 0||i>t.length)&&(i=t.length),t.substring(i-e.length,i)===e}function xTt(t,e,i){return typeof i!="number"&&(i=0),i+e.length>t.length?!1:t.indexOf(e,i)!==-1}Eu("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Eu("ERR_INVALID_ARG_TYPE",function(t,e,i){let r;typeof e=="string"&&wTt(e,"not ")?(r="must not be",e=e.replace(/^not /,"")):r="must be";let n;if(CTt(t," argument"))n=`The ${t} ${r} ${ske(e,"type")}`;else{let o=xTt(t,".")?"property":"argument";n=`The "${t}" ${o} ${r} ${ske(e,"type")}`}return n+=`. Received type ${typeof i}`,n},TypeError);Eu("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Eu("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Eu("ERR_STREAM_PREMATURE_CLOSE","Premature close");Eu("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Eu("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Eu("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Eu("ERR_STREAM_WRITE_AFTER_END","write after end");Eu("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Eu("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Eu("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");lke.exports.codes=ake});var fJ=z((yXi,cke)=>{"use strict";var STt=Zb().codes.ERR_INVALID_OPT_VALUE;function ETt(t,e,i){return t.highWaterMark!=null?t.highWaterMark:e?t[i]:null}function TTt(t,e,i,r){var n=ETt(e,r,i);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var o=r?i:"highWaterMark";throw new STt(o,n)}return Math.floor(n)}return t.objectMode?16:16*1024}cke.exports={getHighWaterMark:TTt}});var gJ=z((wXi,mke)=>{"use strict";mke.exports=Xo;function uke(t){var e=this;this.next=null,this.entry=null,this.finish=function(){JTt(e,t)}}var NE;Xo.WritableState=N2;var RTt={deprecate:tw()},hke=cJ(),MV=Ze("buffer").Buffer,ATt=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function ITt(t){return MV.from(t)}function DTt(t){return MV.isBuffer(t)||t instanceof ATt}var mJ=hJ(),MTt=fJ(),kTt=MTt.getHighWaterMark,Qb=Zb().codes,OTt=Qb.ERR_INVALID_ARG_TYPE,NTt=Qb.ERR_METHOD_NOT_IMPLEMENTED,PTt=Qb.ERR_MULTIPLE_CALLBACK,LTt=Qb.ERR_STREAM_CANNOT_PIPE,FTt=Qb.ERR_STREAM_DESTROYED,HTt=Qb.ERR_STREAM_NULL_VALUES,BTt=Qb.ERR_STREAM_WRITE_AFTER_END,VTt=Qb.ERR_UNKNOWN_ENCODING,PE=mJ.errorOrDestroy;Vi()(Xo,hke);function jTt(){}function N2(t,e,i){NE=NE||gw(),t=t||{},typeof i!="boolean"&&(i=e instanceof NE),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=kTt(this,t,"writableHighWaterMark",i),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var r=t.decodeStrings===!1;this.decodeStrings=!r,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){GTt(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new uke(this)}N2.prototype.getBuffer=function(){for(var e=this.bufferedRequest,i=[];e;)i.push(e),e=e.next;return i};(function(){try{Object.defineProperty(N2.prototype,"buffer",{get:RTt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var DV;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(DV=Function.prototype[Symbol.hasInstance],Object.defineProperty(Xo,Symbol.hasInstance,{value:function(e){return DV.call(this,e)?!0:this!==Xo?!1:e&&e._writableState instanceof N2}})):DV=function(e){return e instanceof this};function Xo(t){NE=NE||gw();var e=this instanceof NE;if(!e&&!DV.call(Xo,this))return new Xo(t);this._writableState=new N2(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),hke.call(this)}Xo.prototype.pipe=function(){PE(this,new LTt)};function zTt(t,e){var i=new BTt;PE(t,i),process.nextTick(e,i)}function WTt(t,e,i,r){var n;return i===null?n=new HTt:typeof i!="string"&&!e.objectMode&&(n=new OTt("chunk",["string","Buffer"],i)),n?(PE(t,n),process.nextTick(r,n),!1):!0}Xo.prototype.write=function(t,e,i){var r=this._writableState,n=!1,o=!r.objectMode&&DTt(t);return o&&!MV.isBuffer(t)&&(t=ITt(t)),typeof e=="function"&&(i=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),typeof i!="function"&&(i=jTt),r.ending?zTt(this,i):(o||WTt(this,r,t,i))&&(r.pendingcb++,n=qTt(this,r,o,t,e,i)),n};Xo.prototype.cork=function(){this._writableState.corked++};Xo.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&fke(this,t))};Xo.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new VTt(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Xo.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function UTt(t,e,i){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=MV.from(e,i)),e}Object.defineProperty(Xo.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function qTt(t,e,i,r,n,o){if(!i){var s=UTt(e,r,n);r!==s&&(i=!0,n="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var d=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:o,next:null},d?d.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else pJ(t,e,!1,a,r,n,o);return c}function pJ(t,e,i,r,n,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new FTt("write")):i?t._writev(n,e.onwrite):t._write(n,o,e.onwrite),e.sync=!1}function YTt(t,e,i,r,n){--e.pendingcb,i?(process.nextTick(n,r),process.nextTick(O2,t,e),t._writableState.errorEmitted=!0,PE(t,r)):(n(r),t._writableState.errorEmitted=!0,PE(t,r),O2(t,e))}function $Tt(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function GTt(t,e){var i=t._writableState,r=i.sync,n=i.writecb;if(typeof n!="function")throw new PTt;if($Tt(i),e)YTt(t,i,r,e,n);else{var o=pke(i)||t.destroyed;!o&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest&&fke(t,i),r?process.nextTick(dke,t,i,o,n):dke(t,i,o,n)}}function dke(t,e,i,r){i||XTt(t,e),e.pendingcb--,r(),O2(t,e)}function XTt(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function fke(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,n=new Array(r),o=e.corkedRequestsFree;o.entry=i;for(var s=0,a=!0;i;)n[s]=i,i.isBuf||(a=!1),i=i.next,s+=1;n.allBuffers=a,pJ(t,e,!0,e.length,n,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new uke(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,d=i.encoding,u=i.callback,h=e.objectMode?1:c.length;if(pJ(t,e,!1,h,c,d,u),i=i.next,e.bufferedRequestCount--,e.writing)break}i===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}Xo.prototype._write=function(t,e,i){i(new NTt("_write()"))};Xo.prototype._writev=null;Xo.prototype.end=function(t,e,i){var r=this._writableState;return typeof t=="function"?(i=t,t=null,e=null):typeof e=="function"&&(i=e,e=null),t!=null&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||QTt(this,r,i),this};Object.defineProperty(Xo.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function pke(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function KTt(t,e){t._final(function(i){e.pendingcb--,i&&PE(t,i),e.prefinished=!0,t.emit("prefinish"),O2(t,e)})}function ZTt(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(KTt,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function O2(t,e){var i=pke(e);if(i&&(ZTt(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return i}function QTt(t,e,i){e.ending=!0,O2(t,e),i&&(e.finished?process.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}function JTt(t,e,i){var r=t.entry;for(t.entry=null;r;){var n=r.callback;e.pendingcb--,n(i),r=r.next}e.corkedRequestsFree.next=t}Object.defineProperty(Xo.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}});Xo.prototype.destroy=mJ.destroy;Xo.prototype._undestroy=mJ.undestroy;Xo.prototype._destroy=function(t,e){e(t)}});var gw=z((CXi,vke)=>{"use strict";var eRt=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};vke.exports=mp;var gke=_J(),bJ=gJ();Vi()(mp,gke);for(vJ=eRt(bJ.prototype),kV=0;kV<vJ.length;kV++)OV=vJ[kV],mp.prototype[OV]||(mp.prototype[OV]=bJ.prototype[OV]);var vJ,OV,kV;function mp(t){if(!(this instanceof mp))return new mp(t);gke.call(this,t),bJ.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",tRt)))}Object.defineProperty(mp.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(mp.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(mp.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function tRt(){this._writableState.ended||process.nextTick(iRt,this)}function iRt(t){t.end()}Object.defineProperty(mp.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var yke=z((yJ,_ke)=>{"use strict";var NV=Ze("buffer"),gp=NV.Buffer;function bke(t,e){for(var i in t)e[i]=t[i]}gp.from&&gp.alloc&&gp.allocUnsafe&&gp.allocUnsafeSlow?_ke.exports=NV:(bke(NV,yJ),yJ.Buffer=vw);function vw(t,e,i){return gp(t,e,i)}vw.prototype=Object.create(gp.prototype);bke(gp,vw);vw.from=function(t,e,i){if(typeof t=="number")throw new TypeError("Argument must not be a number");return gp(t,e,i)};vw.alloc=function(t,e,i){if(typeof t!="number")throw new TypeError("Argument must be a number");var r=gp(t);return e!==void 0?typeof i=="string"?r.fill(e,i):r.fill(e):r.fill(0),r};vw.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return gp(t)};vw.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return NV.SlowBuffer(t)}});var xJ=z(Cke=>{"use strict";var CJ=yke().Buffer,wke=CJ.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function rRt(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function nRt(t){var e=rRt(t);if(typeof e!="string"&&(CJ.isEncoding===wke||!wke(t)))throw new Error("Unknown encoding: "+t);return e||t}Cke.StringDecoder=P2;function P2(t){this.encoding=nRt(t);var e;switch(this.encoding){case"utf16le":this.text=dRt,this.end=uRt,e=4;break;case"utf8":this.fillLast=aRt,e=4;break;case"base64":this.text=hRt,this.end=fRt,e=3;break;default:this.write=pRt,this.end=mRt;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=CJ.allocUnsafe(e)}P2.prototype.write=function(t){if(t.length===0)return"";var e,i;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""};P2.prototype.end=cRt;P2.prototype.text=lRt;P2.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function wJ(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function oRt(t,e,i){var r=e.length-1;if(r<i)return 0;var n=wJ(e[r]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--r<i||n===-2?0:(n=wJ(e[r]),n>=0?(n>0&&(t.lastNeed=n-2),n):--r<i||n===-2?0:(n=wJ(e[r]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function sRt(t,e,i){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function aRt(t){var e=this.lastTotal-this.lastNeed,i=sRt(this,t,e);if(i!==void 0)return i;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function lRt(t,e){var i=oRt(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var r=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function cRt(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function dRt(t,e){if((t.length-e)%2===0){var i=t.toString("utf16le",e);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function uRt(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function hRt(t,e){var i=(t.length-e)%3;return i===0?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,i===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function fRt(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function pRt(t){return t.toString(this.encoding)}function mRt(t){return t&&t.length?this.write(t):""}});var PV=z((SXi,Eke)=>{"use strict";var xke=Zb().codes.ERR_STREAM_PREMATURE_CLOSE;function gRt(t){var e=!1;return function(){if(!e){e=!0;for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];t.apply(this,r)}}}function vRt(){}function bRt(t){return t.setHeader&&typeof t.abort=="function"}function Ske(t,e,i){if(typeof e=="function")return Ske(t,null,e);e||(e={}),i=gRt(i||vRt);var r=e.readable||e.readable!==!1&&t.readable,n=e.writable||e.writable!==!1&&t.writable,o=function(){t.writable||a()},s=t._writableState&&t._writableState.finished,a=function(){n=!1,s=!0,r||i.call(t)},c=t._readableState&&t._readableState.endEmitted,d=function(){r=!1,c=!0,n||i.call(t)},u=function(m){i.call(t,m)},h=function(){var m;if(r&&!c)return(!t._readableState||!t._readableState.ended)&&(m=new xke),i.call(t,m);if(n&&!s)return(!t._writableState||!t._writableState.ended)&&(m=new xke),i.call(t,m)},p=function(){t.req.on("finish",a)};return bRt(t)?(t.on("complete",a),t.on("abort",h),t.req?p():t.on("request",p)):n&&!t._writableState&&(t.on("end",o),t.on("close",o)),t.on("end",d),t.on("finish",a),e.error!==!1&&t.on("error",u),t.on("close",h),function(){t.removeListener("complete",a),t.removeListener("abort",h),t.removeListener("request",p),t.req&&t.req.removeListener("finish",a),t.removeListener("end",o),t.removeListener("close",o),t.removeListener("finish",a),t.removeListener("end",d),t.removeListener("error",u),t.removeListener("close",h)}}Eke.exports=Ske});var Rke=z((EXi,Tke)=>{"use strict";var LV;function Jb(t,e,i){return e=_Rt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _Rt(t){var e=yRt(t,"string");return typeof e=="symbol"?e:String(e)}function yRt(t,e){if(typeof t!="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wRt=PV(),e0=Symbol("lastResolve"),bw=Symbol("lastReject"),L2=Symbol("error"),FV=Symbol("ended"),_w=Symbol("lastPromise"),SJ=Symbol("handlePromise"),yw=Symbol("stream");function t0(t,e){return{value:t,done:e}}function CRt(t){var e=t[e0];if(e!==null){var i=t[yw].read();i!==null&&(t[_w]=null,t[e0]=null,t[bw]=null,e(t0(i,!1)))}}function xRt(t){process.nextTick(CRt,t)}function SRt(t,e){return function(i,r){t.then(function(){if(e[FV]){i(t0(void 0,!0));return}e[SJ](i,r)},r)}}var ERt=Object.getPrototypeOf(function(){}),TRt=Object.setPrototypeOf((LV={get stream(){return this[yw]},next:function(){var e=this,i=this[L2];if(i!==null)return Promise.reject(i);if(this[FV])return Promise.resolve(t0(void 0,!0));if(this[yw].destroyed)return new Promise(function(s,a){process.nextTick(function(){e[L2]?a(e[L2]):s(t0(void 0,!0))})});var r=this[_w],n;if(r)n=new Promise(SRt(r,this));else{var o=this[yw].read();if(o!==null)return Promise.resolve(t0(o,!1));n=new Promise(this[SJ])}return this[_w]=n,n}},Jb(LV,Symbol.asyncIterator,function(){return this}),Jb(LV,"return",function(){var e=this;return new Promise(function(i,r){e[yw].destroy(null,function(n){if(n){r(n);return}i(t0(void 0,!0))})})}),LV),ERt),RRt=function(e){var i,r=Object.create(TRt,(i={},Jb(i,yw,{value:e,writable:!0}),Jb(i,e0,{value:null,writable:!0}),Jb(i,bw,{value:null,writable:!0}),Jb(i,L2,{value:null,writable:!0}),Jb(i,FV,{value:e._readableState.endEmitted,writable:!0}),Jb(i,SJ,{value:function(o,s){var a=r[yw].read();a?(r[_w]=null,r[e0]=null,r[bw]=null,o(t0(a,!1))):(r[e0]=o,r[bw]=s)},writable:!0}),i));return r[_w]=null,wRt(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var o=r[bw];o!==null&&(r[_w]=null,r[e0]=null,r[bw]=null,o(n)),r[L2]=n;return}var s=r[e0];s!==null&&(r[_w]=null,r[e0]=null,r[bw]=null,s(t0(void 0,!0))),r[FV]=!0}),e.on("readable",xRt.bind(null,r)),r};Tke.exports=RRt});var Mke=z((TXi,Dke)=>{"use strict";function Ake(t,e,i,r,n,o,s){try{var a=t[o](s),c=a.value}catch(d){i(d);return}a.done?e(c):Promise.resolve(c).then(r,n)}function ARt(t){return function(){var e=this,i=arguments;return new Promise(function(r,n){var o=t.apply(e,i);function s(c){Ake(o,r,n,s,a,"next",c)}function a(c){Ake(o,r,n,s,a,"throw",c)}s(void 0)})}}function Ike(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),i.push.apply(i,r)}return i}function IRt(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?Ike(Object(i),!0).forEach(function(r){DRt(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ike(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function DRt(t,e,i){return e=MRt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function MRt(t){var e=kRt(t,"string");return typeof e=="symbol"?e:String(e)}function kRt(t,e){if(typeof t!="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ORt=Zb().codes.ERR_INVALID_ARG_TYPE;function NRt(t,e,i){var r;if(e&&typeof e.next=="function")r=e;else if(e&&e[Symbol.asyncIterator])r=e[Symbol.asyncIterator]();else if(e&&e[Symbol.iterator])r=e[Symbol.iterator]();else throw new ORt("iterable",["Iterable"],e);var n=new t(IRt({objectMode:!0},i)),o=!1;n._read=function(){o||(o=!0,s())};function s(){return a.apply(this,arguments)}function a(){return a=ARt(function*(){try{var c=yield r.next(),d=c.value,u=c.done;u?n.push(null):n.push(yield d)?s():o=!1}catch(h){n.destroy(h)}}),a.apply(this,arguments)}return n}Dke.exports=NRt});var _J=z((AXi,jke)=>{"use strict";jke.exports=Lr;var LE;Lr.ReadableState=Pke;var RXi=Ze("events").EventEmitter,Nke=function(e,i){return e.listeners(i).length},H2=cJ(),HV=Ze("buffer").Buffer,PRt=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function LRt(t){return HV.from(t)}function FRt(t){return HV.isBuffer(t)||t instanceof PRt}var EJ=Ze("util"),hr;EJ&&EJ.debuglog?hr=EJ.debuglog("stream"):hr=function(){};var HRt=rke(),kJ=hJ(),BRt=fJ(),VRt=BRt.getHighWaterMark,BV=Zb().codes,jRt=BV.ERR_INVALID_ARG_TYPE,zRt=BV.ERR_STREAM_PUSH_AFTER_EOF,WRt=BV.ERR_METHOD_NOT_IMPLEMENTED,URt=BV.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,FE,TJ,RJ;Vi()(Lr,H2);var F2=kJ.errorOrDestroy,AJ=["error","close","destroy","pause","resume"];function qRt(t,e,i){if(typeof t.prependListener=="function")return t.prependListener(e,i);!t._events||!t._events[e]?t.on(e,i):Array.isArray(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]}function Pke(t,e,i){LE=LE||gw(),t=t||{},typeof i!="boolean"&&(i=e instanceof LE),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=VRt(this,t,"readableHighWaterMark",i),this.buffer=new HRt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(FE||(FE=xJ().StringDecoder),this.decoder=new FE(t.encoding),this.encoding=t.encoding)}function Lr(t){if(LE=LE||gw(),!(this instanceof Lr))return new Lr(t);var e=this instanceof LE;this._readableState=new Pke(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),H2.call(this)}Object.defineProperty(Lr.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}});Lr.prototype.destroy=kJ.destroy;Lr.prototype._undestroy=kJ.undestroy;Lr.prototype._destroy=function(t,e){e(t)};Lr.prototype.push=function(t,e){var i=this._readableState,r;return i.objectMode?r=!0:typeof t=="string"&&(e=e||i.defaultEncoding,e!==i.encoding&&(t=HV.from(t,e),e=""),r=!0),Lke(this,t,e,!1,r)};Lr.prototype.unshift=function(t){return Lke(this,t,null,!0,!1)};function Lke(t,e,i,r,n){hr("readableAddChunk",e);var o=t._readableState;if(e===null)o.reading=!1,GRt(t,o);else{var s;if(n||(s=YRt(o,e)),s)F2(t,s);else if(o.objectMode||e&&e.length>0)if(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==HV.prototype&&(e=LRt(e)),r)o.endEmitted?F2(t,new URt):IJ(t,o,e,!0);else if(o.ended)F2(t,new zRt);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||e.length!==0?IJ(t,o,e,!1):MJ(t,o)):IJ(t,o,e,!1)}else r||(o.reading=!1,MJ(t,o))}return!o.ended&&(o.length<o.highWaterMark||o.length===0)}function IJ(t,e,i,r){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",i)):(e.length+=e.objectMode?1:i.length,r?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&VV(t)),MJ(t,e)}function YRt(t,e){var i;return!FRt(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(i=new jRt("chunk",["string","Buffer","Uint8Array"],e)),i}Lr.prototype.isPaused=function(){return this._readableState.flowing===!1};Lr.prototype.setEncoding=function(t){FE||(FE=xJ().StringDecoder);var e=new FE(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,r="";i!==null;)r+=e.write(i.data),i=i.next;return this._readableState.buffer.clear(),r!==""&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var kke=1073741824;function $Rt(t){return t>=kke?t=kke:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function Oke(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=$Rt(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Lr.prototype.read=function(t){hr("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return hr("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?DJ(this):VV(this),null;if(t=Oke(t,e),t===0&&e.ended)return e.length===0&&DJ(this),null;var r=e.needReadable;hr("need readable",r),(e.length===0||e.length-t<e.highWaterMark)&&(r=!0,hr("length less than watermark",r)),e.ended||e.reading?(r=!1,hr("reading or ended",r)):r&&(hr("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Oke(i,e)));var n;return t>0?n=Bke(t,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&DJ(this)),n!==null&&this.emit("data",n),n};function GRt(t,e){if(hr("onEofChunk"),!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,e.sync?VV(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Fke(t)))}}function VV(t){var e=t._readableState;hr("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(hr("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Fke,t))}function Fke(t){var e=t._readableState;hr("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,OJ(t)}function MJ(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(XRt,t,e))}function XRt(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var i=e.length;if(hr("maybeReadMore read 0"),t.read(0),i===e.length)break}e.readingMore=!1}Lr.prototype._read=function(t){F2(this,new WRt("_read()"))};Lr.prototype.pipe=function(t,e){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1,hr("pipe count=%d opts=%j",r.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=n?a:g;r.endEmitted?process.nextTick(o):i.once("end",o),t.on("unpipe",s);function s(y,w){hr("onunpipe"),y===i&&w&&w.hasUnpiped===!1&&(w.hasUnpiped=!0,u())}function a(){hr("onend"),t.end()}var c=KRt(i);t.on("drain",c);var d=!1;function u(){hr("cleanup"),t.removeListener("close",f),t.removeListener("finish",m),t.removeListener("drain",c),t.removeListener("error",p),t.removeListener("unpipe",s),i.removeListener("end",a),i.removeListener("end",g),i.removeListener("data",h),d=!0,r.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}i.on("data",h);function h(y){hr("ondata");var w=t.write(y);hr("dest.write",w),w===!1&&((r.pipesCount===1&&r.pipes===t||r.pipesCount>1&&Vke(r.pipes,t)!==-1)&&!d&&(hr("false write response, pause",r.awaitDrain),r.awaitDrain++),i.pause())}function p(y){hr("onerror",y),g(),t.removeListener("error",p),Nke(t,"error")===0&&F2(t,y)}qRt(t,"error",p);function f(){t.removeListener("finish",m),g()}t.once("close",f);function m(){hr("onfinish"),t.removeListener("close",f),g()}t.once("finish",m);function g(){hr("unpipe"),i.unpipe(t)}return t.emit("pipe",i),r.flowing||(hr("pipe resume"),i.resume()),t};function KRt(t){return function(){var i=t._readableState;hr("pipeOnDrain",i.awaitDrain),i.awaitDrain&&i.awaitDrain--,i.awaitDrain===0&&Nke(t,"data")&&(i.flowing=!0,OJ(t))}}Lr.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<n;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=Vke(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i),this)};Lr.prototype.on=function(t,e){var i=H2.prototype.on.call(this,t,e),r=this._readableState;return t==="data"?(r.readableListening=this.listenerCount("readable")>0,r.flowing!==!1&&this.resume()):t==="readable"&&!r.endEmitted&&!r.readableListening&&(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,hr("on readable",r.length,r.reading),r.length?VV(this):r.reading||process.nextTick(ZRt,this)),i};Lr.prototype.addListener=Lr.prototype.on;Lr.prototype.removeListener=function(t,e){var i=H2.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(Hke,this),i};Lr.prototype.removeAllListeners=function(t){var e=H2.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(Hke,this),e};function Hke(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function ZRt(t){hr("readable nexttick read 0"),t.read(0)}Lr.prototype.resume=function(){var t=this._readableState;return t.flowing||(hr("resume"),t.flowing=!t.readableListening,QRt(this,t)),t.paused=!1,this};function QRt(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(JRt,t,e))}function JRt(t,e){hr("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),OJ(t),e.flowing&&!e.reading&&t.read(0)}Lr.prototype.pause=function(){return hr("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(hr("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function OJ(t){var e=t._readableState;for(hr("flow",e.flowing);e.flowing&&t.read()!==null;);}Lr.prototype.wrap=function(t){var e=this,i=this._readableState,r=!1;t.on("end",function(){if(hr("wrapped end"),i.decoder&&!i.ended){var s=i.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(hr("wrapped data"),i.decoder&&(s=i.decoder.write(s)),!(i.objectMode&&s==null)&&!(!i.objectMode&&(!s||!s.length))){var a=e.push(s);a||(r=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(a){return function(){return t[a].apply(t,arguments)}}(n));for(var o=0;o<AJ.length;o++)t.on(AJ[o],this.emit.bind(this,AJ[o]));return this._read=function(s){hr("wrapped _read",s),r&&(r=!1,t.resume())},this};typeof Symbol=="function"&&(Lr.prototype[Symbol.asyncIterator]=function(){return TJ===void 0&&(TJ=Rke()),TJ(this)});Object.defineProperty(Lr.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Lr.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Lr.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Lr._fromList=Bke;Object.defineProperty(Lr.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Bke(t,e){if(e.length===0)return null;var i;return e.objectMode?i=e.buffer.shift():!t||t>=e.length?(e.decoder?i=e.buffer.join(""):e.buffer.length===1?i=e.buffer.first():i=e.buffer.concat(e.length),e.buffer.clear()):i=e.buffer.consume(t,e.decoder),i}function DJ(t){var e=t._readableState;hr("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(eAt,e,t))}function eAt(t,e){if(hr("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var i=e._writableState;(!i||i.autoDestroy&&i.finished)&&e.destroy()}}typeof Symbol=="function"&&(Lr.from=function(t,e){return RJ===void 0&&(RJ=Mke()),RJ(Lr,t,e)});function Vke(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}});var NJ=z((IXi,Wke)=>{"use strict";Wke.exports=eg;var jV=Zb().codes,tAt=jV.ERR_METHOD_NOT_IMPLEMENTED,iAt=jV.ERR_MULTIPLE_CALLBACK,rAt=jV.ERR_TRANSFORM_ALREADY_TRANSFORMING,nAt=jV.ERR_TRANSFORM_WITH_LENGTH_0,zV=gw();Vi()(eg,zV);function oAt(t,e){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(r===null)return this.emit("error",new iAt);i.writechunk=null,i.writecb=null,e!=null&&this.push(e),r(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function eg(t){if(!(this instanceof eg))return new eg(t);zV.call(this,t),this._transformState={afterTransform:oAt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",sAt)}function sAt(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,i){zke(t,e,i)}):zke(this,null,null)}eg.prototype.push=function(t,e){return this._transformState.needTransform=!1,zV.prototype.push.call(this,t,e)};eg.prototype._transform=function(t,e,i){i(new tAt("_transform()"))};eg.prototype._write=function(t,e,i){var r=this._transformState;if(r.writecb=i,r.writechunk=t,r.writeencoding=e,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};eg.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};eg.prototype._destroy=function(t,e){zV.prototype._destroy.call(this,t,function(i){e(i)})};function zke(t,e,i){if(e)return t.emit("error",e);if(i!=null&&t.push(i),t._writableState.length)throw new nAt;if(t._transformState.transforming)throw new rAt;return t.push(null)}});var Yke=z((DXi,qke)=>{"use strict";qke.exports=B2;var Uke=NJ();Vi()(B2,Uke);function B2(t){if(!(this instanceof B2))return new B2(t);Uke.call(this,t)}B2.prototype._transform=function(t,e,i){i(null,t)}});var Zke=z((MXi,Kke)=>{"use strict";var PJ;function aAt(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var Xke=Zb().codes,lAt=Xke.ERR_MISSING_ARGS,cAt=Xke.ERR_STREAM_DESTROYED;function $ke(t){if(t)throw t}function dAt(t){return t.setHeader&&typeof t.abort=="function"}function uAt(t,e,i,r){r=aAt(r);var n=!1;t.on("close",function(){n=!0}),PJ===void 0&&(PJ=PV()),PJ(t,{readable:e,writable:i},function(s){if(s)return r(s);n=!0,r()});var o=!1;return function(s){if(!n&&!o){if(o=!0,dAt(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();r(s||new cAt("pipe"))}}}function Gke(t){t()}function hAt(t,e){return t.pipe(e)}function fAt(t){return!t.length||typeof t[t.length-1]!="function"?$ke:t.pop()}function pAt(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var r=fAt(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new lAt("streams");var n,o=e.map(function(s,a){var c=a<e.length-1,d=a>0;return uAt(s,c,d,function(u){n||(n=u),u&&o.forEach(Gke),!c&&(o.forEach(Gke),r(n))})});return e.reduce(hAt)}Kke.exports=pAt});var _l=z((Tu,j2)=>{"use strict";var V2=Ze("stream");process.env.READABLE_STREAM==="disable"&&V2?(j2.exports=V2.Readable,Object.assign(j2.exports,V2),j2.exports.Stream=V2):(Tu=j2.exports=_J(),Tu.Stream=V2||Tu,Tu.Readable=Tu,Tu.Writable=gJ(),Tu.Duplex=gw(),Tu.Transform=NJ(),Tu.PassThrough=Yke(),Tu.finished=PV(),Tu.pipeline=Zke())});var yl=z((kXi,eOe)=>{"use strict";var Qke=Ze("fs"),mAt=function(t,e,i,r){t.super_=e,r||(r=i,i=null),i&&Object.keys(i).forEach(o=>{Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(i,o))});let n={constructor:{value:t,enumerable:!1,writable:!1,configurable:!0}};r&&Object.keys(r).forEach(o=>{n[o]=Object.getOwnPropertyDescriptor(r,o)}),t.prototype=Object.create(e.prototype,n)},gAt=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,Jke={nop(){},promiseImmediate(t){return new Promise(e=>{global.setImmediate?setImmediate(()=>{e(t)}):setTimeout(()=>{e(t)},1)})},inherits:mAt,dateToExcel(t,e){return 25569+t.getTime()/(24*3600*1e3)-(e?1462:0)},excelToDate(t,e){let i=Math.round((t-25569+(e?1462:0))*24*3600*1e3);return new Date(i)},parsePath(t){let e=t.lastIndexOf("/");return{path:t.substring(0,e),name:t.substring(e+1)}},getRelsPath(t){let e=Jke.parsePath(t);return`${e.path}/_rels/${e.name}.rels`},xmlEncode(t){let e=gAt.exec(t);if(!e)return t;let i="",r="",n=0,o=e.index;for(;o<t.length;o++){let s=t.charCodeAt(o);switch(s){case 34:r="&quot;";break;case 38:r="&amp;";break;case 39:r="&apos;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;case 127:r="";break;default:{if(s<=31&&(s<=8||s>=11&&s!==13)){r="";break}continue}}n!==o&&(i+=t.substring(n,o)),n=o+1,r&&(i+=r)}return n!==o?i+t.substring(n,o):i},xmlDecode(t){return t.replace(/&([a-z]*);/g,e=>{switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return e}})},validInt(t){let e=parseInt(t,10);return Number.isNaN(e)?0:e},isDateFmt(t){return t?(t=t.replace(/\[[^\]]*]/g,""),t=t.replace(/"[^"]*"/g,""),t.match(/[ymdhMsb]+/)!==null):!1},fs:{exists(t){return new Promise(e=>{Qke.access(t,Qke.constants.F_OK,i=>{e(!i)})})}},toIsoDateString(t){return t.toIsoString().subsstr(0,10)},parseBoolean(t){return t===!0||t==="true"||t===1||t==="1"}};eOe.exports=Jke});var FJ=z((OXi,tOe)=>{"use strict";var LJ=class{constructor(e){this._buf=Buffer.alloc(e&&e.size||16384),this._encoding=e&&e.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=Buffer.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(e){e=e||0,this._buffer=void 0,this._inPos=e}_grow(e){let i=this._buf.length*2;for(;i<e;)i*=2;let r=Buffer.alloc(i);this._buf.copy(r,0),this._buf=r}addText(e){this._buffer=void 0;let i=this._inPos+this._buf.write(e,this._inPos,this._encoding);for(;i>=this._buf.length-4;)this._grow(this._inPos+e.length),i=this._inPos+this._buf.write(e,this._inPos,this._encoding);this._inPos=i}addStringBuf(e){e.length&&(this._buffer=void 0,this.length+e.length>this.capacity&&this._grow(this.length+e.length),e._buf.copy(this._buf,this._inPos,0,e.length),this._inPos+=e.length)}};tOe.exports=LJ});var z2=z((NXi,nOe)=>{"use strict";var vAt=_l(),iOe=yl(),bAt=FJ(),HJ=class{constructor(e,i){this._data=e,this._encoding=i}get length(){return this.toBuffer().length}copy(e,i,r,n){return this.toBuffer().copy(e,i,r,n)}toBuffer(){return this._buffer||(this._buffer=Buffer.from(this._data,this._encoding)),this._buffer}},BJ=class{constructor(e){this._data=e}get length(){return this._data.length}copy(e,i,r,n){return this._data._buf.copy(e,i,r,n)}toBuffer(){return this._data.toBuffer()}},VJ=class{constructor(e){this._data=e}get length(){return this._data.length}copy(e,i,r,n){this._data.copy(e,i,r,n)}toBuffer(){return this._data}},jJ=class{constructor(e){this.size=e,this.buffer=Buffer.alloc(e),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;let e=Buffer.alloc(this.iWrite-this.iRead);return this.buffer.copy(e,0,this.iRead,this.iWrite),e}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(e){let i;return e===0?null:e===void 0||e>=this.length?(i=this.toBuffer(),this.iRead=this.iWrite,i):(i=Buffer.alloc(e),this.buffer.copy(i,0,this.iRead,e),this.iRead+=e,i)}write(e,i,r){let n=Math.min(r,this.size-this.iWrite);return e.copy(this.buffer,this.iWrite,i,i+n),this.iWrite+=n,n}},rOe=function(t){t=t||{},this.bufSize=t.bufSize||1024*1024,this.buffers=[],this.batch=t.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};iOe.inherits(rOe,vAt.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return Buffer.concat(this.buffers.map(t=>t.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){let e=this.buffers[this.buffers.length-1];if(!e.full)return e}let t=new jJ(this.bufSize);return this.buffers.push(t),t},_pipe(t){return Ei(this,null,function*(){let e=function(i){return new Promise(r=>{i.write(t.toBuffer(),()=>{r()})})};yield Promise.all(this.pipes.map(e))})},_writeToBuffers(t){let e=0,i=t.length;for(;e<i;){let r=this._getWritableBuffer();e+=r.write(t,e,i-e)}},write(t,e,i){return Ei(this,null,function*(){e instanceof Function&&(i=e,e="utf8"),i=i||iOe.nop;let r;if(t instanceof bAt)r=new BJ(t);else if(t instanceof Buffer)r=new VJ(t);else if(typeof t=="string"||t instanceof String||t instanceof ArrayBuffer)r=new HJ(t,e);else throw new Error("Chunk must be one of type String, Buffer or StringBuf.");if(this.pipes.length)if(this.batch)for(this._writeToBuffers(r);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(r),process.nextTick(i)):(yield this._pipe(r),i());else this.paused||this.emit("data",r.toBuffer()),this._writeToBuffers(r),this.emit("readable");return!0})},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(t,e,i){let r=n=>{n?i(n):(this._flush(),this.pipes.forEach(o=>{o.end()}),this.emit("finish"))};t?this.write(t,e,r):r()},read(t){let e;if(t){for(e=[];t&&this.buffers.length&&!this.buffers[0].eod;){let i=this.buffers[0],r=i.read(t);t-=r.length,e.push(r),i.eod&&i.full&&this.buffers.shift()}return Buffer.concat(e)}return e=this.buffers.map(i=>i.toBuffer()).filter(Boolean),this.buffers=[],Buffer.concat(e)},setEncoding(t){this.encoding=t},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(t){this.pipes.push(t),!this.paused&&this.buffers.length&&this.end()},unpipe(t){this.pipes=this.pipes.filter(e=>e!==t)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}});nOe.exports=rOe});var lOe=z(aOe=>{"use strict";var oOe=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:sOe}=Ze("buffer");function _At(t){return typeof t!="string"?t:oOe?sOe.from(oOe.encode(t).buffer):sOe.from(t)}aOe.stringToBuffer=_At});var dOe=z((FXi,cOe)=>{"use strict";var yAt=Ze("events"),wAt=lJ(),CAt=z2(),{stringToBuffer:xAt}=lOe(),zJ=class extends yAt.EventEmitter{constructor(e){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},e),this.zip=new wAt,this.stream=new CAt}append(e,i){i.hasOwnProperty("base64")&&i.base64?this.zip.file(i.name,e,{base64:!0}):(process.browser&&typeof e=="string"&&(e=xAt(e)),this.zip.file(i.name,e))}finalize(){return Ei(this,null,function*(){let e=yield this.zip.generateAsync(this.options);this.stream.end(e),this.emit("finish")})}read(e){return this.stream.read(e)}setEncoding(e){return this.stream.setEncoding(e)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(e,i){return this.stream.pipe(e,i)}unpipe(e){return this.stream.unpipe(e)}unshift(e){return this.stream.unshift(e)}wrap(e){return this.stream.wrap(e)}};cOe.exports={ZipWriter:zJ}});var Ha=z((BXi,fOe)=>{"use strict";var SAt=Go(),uOe=yl(),EAt="<",WV=">",TAt="</",RAt="/>";function hOe(t,e,i){t.push(` ${e}="${uOe.xmlEncode(i.toString())}"`)}function WJ(t,e){if(e){let i=[];SAt.each(e,(r,n)=>{r!==void 0&&hOe(i,n,r)}),t.push(i.join(""))}}var AAt=(()=>{class t{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(i){let r=this._xml;r.push("<?xml"),WJ(r,i),r.push(`?>
`)}openNode(i,r){let n=this.tos,o=this._xml;n&&this.open&&o.push(WV),this._stack.push(i),o.push(EAt),o.push(i),WJ(o,r),this.leaf=!0,this.open=!0}addAttribute(i,r){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");r!==void 0&&hOe(this._xml,i,r)}addAttributes(i){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");WJ(this._xml,i)}writeText(i){let r=this._xml;this.open&&(r.push(WV),this.open=!1),this.leaf=!1,r.push(uOe.xmlEncode(i.toString()))}writeXml(i){this.open&&(this._xml.push(WV),this.open=!1),this.leaf=!1,this._xml.push(i)}closeNode(){let i=this._stack.pop(),r=this._xml;this.leaf?r.push(RAt):(r.push(TAt),r.push(i),r.push(WV)),this.open=!1,this.leaf=!1}leafNode(i,r,n){this.openNode(i,r),n!==void 0&&this.writeText(n),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){let i=this._rollbacks.pop();this._xml.length>i.xml&&this._xml.splice(i.xml,this._xml.length-i.xml),this._stack.length>i.stack&&this._stack.splice(i.stack,this._stack.length-i.stack),this.leaf=i.leaf,this.open=i.open}get xml(){return this.closeAll(),this._xml.join("")}}return t.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},t})();fOe.exports=AAt});var UJ=z(mOe=>{"use strict";var pOe=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function IAt(t){return typeof t=="string"?t:pOe?pOe.decode(t):t.toString()}mOe.bufferToString=IAt});var vOe=z(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.CHAR=`	
\r -\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}`;oo.S=` 	\r
`;oo.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";oo.NAME_CHAR="-"+oo.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";oo.CHAR_RE=new RegExp("^["+oo.CHAR+"]$","u");oo.S_RE=new RegExp("^["+oo.S+"]+$","u");oo.NAME_START_CHAR_RE=new RegExp("^["+oo.NAME_START_CHAR+"]$","u");oo.NAME_CHAR_RE=new RegExp("^["+oo.NAME_CHAR+"]$","u");oo.NAME_RE=new RegExp("^["+oo.NAME_START_CHAR+"]["+oo.NAME_CHAR+"]*$","u");oo.NMTOKEN_RE=new RegExp("^["+oo.NAME_CHAR+"]+$","u");var qJ=9,YJ=10,$J=13,GJ=32;oo.S_LIST=[GJ,YJ,$J,qJ];function DAt(t){return t>=GJ&&t<=55295||t===YJ||t===$J||t===qJ||t>=57344&&t<=65533||t>=65536&&t<=1114111}oo.isChar=DAt;function MAt(t){return t===GJ||t===YJ||t===$J||t===qJ}oo.isS=MAt;function gOe(t){return t>=65&&t<=90||t>=97&&t<=122||t===58||t===95||t===8204||t===8205||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}oo.isNameStartChar=gOe;function kAt(t){return gOe(t)||t>=48&&t<=57||t===45||t===46||t===183||t>=768&&t<=879||t>=8255&&t<=8256}oo.isNameChar=kAt});var xOe=z(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.CHAR="-\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}";gn.RESTRICTED_CHAR="-\b\v\f-\x7F-\x84\x86-\x9F";gn.S=` 	\r
`;gn.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";gn.NAME_CHAR="-"+gn.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";gn.CHAR_RE=new RegExp("^["+gn.CHAR+"]$","u");gn.RESTRICTED_CHAR_RE=new RegExp("^["+gn.RESTRICTED_CHAR+"]$","u");gn.S_RE=new RegExp("^["+gn.S+"]+$","u");gn.NAME_START_CHAR_RE=new RegExp("^["+gn.NAME_START_CHAR+"]$","u");gn.NAME_CHAR_RE=new RegExp("^["+gn.NAME_CHAR+"]$","u");gn.NAME_RE=new RegExp("^["+gn.NAME_START_CHAR+"]["+gn.NAME_CHAR+"]*$","u");gn.NMTOKEN_RE=new RegExp("^["+gn.NAME_CHAR+"]+$","u");var bOe=9,_Oe=10,yOe=13,wOe=32;gn.S_LIST=[wOe,_Oe,yOe,bOe];function OAt(t){return t>=1&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111}gn.isChar=OAt;function NAt(t){return t>=1&&t<=8||t===11||t===12||t>=14&&t<=31||t>=127&&t<=132||t>=134&&t<=159}gn.isRestrictedChar=NAt;function PAt(t){return t===9||t===10||t===13||t>31&&t<127||t===133||t>159&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111}gn.isCharAndNotRestricted=PAt;function LAt(t){return t===wOe||t===_Oe||t===yOe||t===bOe}gn.isS=LAt;function COe(t){return t>=65&&t<=90||t>=97&&t<=122||t===58||t===95||t===8204||t===8205||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}gn.isNameStartChar=COe;function FAt(t){return COe(t)||t>=48&&t<=57||t===45||t===46||t===183||t>=768&&t<=879||t>=8255&&t<=8256}gn.isNameChar=FAt});var EOe=z(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.NC_NAME_START_CHAR="A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";Fc.NC_NAME_CHAR="-"+Fc.NC_NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";Fc.NC_NAME_START_CHAR_RE=new RegExp("^["+Fc.NC_NAME_START_CHAR+"]$","u");Fc.NC_NAME_CHAR_RE=new RegExp("^["+Fc.NC_NAME_CHAR+"]$","u");Fc.NC_NAME_RE=new RegExp("^["+Fc.NC_NAME_START_CHAR+"]["+Fc.NC_NAME_CHAR+"]*$","u");function SOe(t){return t>=65&&t<=90||t===95||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Fc.isNCNameStartChar=SOe;function HAt(t){return SOe(t)||t===45||t===46||t>=48&&t<=57||t===183||t>=768&&t<=879||t>=8255&&t<=8256}Fc.isNCNameChar=HAt});var qOe=z(KV=>{"use strict";Object.defineProperty(KV,"__esModule",{value:!0});var zE=vOe(),BAt=xOe(),lee=EOe(),Hc=zE.isS,VAt=zE.isChar,W2=zE.isNameStartChar,TOe=zE.isNameChar,VOe=zE.S_LIST,jAt=zE.NAME_RE,zAt=BAt.isChar,WAt=lee.isNCNameStartChar,UAt=lee.isNCNameChar,qAt=lee.NC_NAME_RE,XV="http://www.w3.org/XML/1998/namespace",jE="http://www.w3.org/2000/xmlns/",YAt={__proto__:null,xml:XV,xmlns:jE},$At={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},So=-1,vp=-2,ROe=0,GAt=1,XJ=2,XAt=3,HE=4,KAt=5,ZAt=6,QAt=7,KJ=8,JAt=9,eIt=10,tIt=11,iIt=12,Kl=13,UV=14,ZJ=15,rIt=16,QJ=17,nIt=18,oIt=19,JJ=20,sIt=21,aIt=22,lIt=23,AOe=24,eee=25,qV=26,IOe=27,cIt=28,dIt=29,DOe=30,uIt=31,hIt=32,ww=33,fIt=34,tee=35,U2=36,iee=37,pIt=38,MOe=39,kOe=40,mIt=41,OOe=42,gIt=43,vIt=44,ree=9,Ah=10,nee=13,NOe=32,POe=33,jOe=34,q2=38,zOe=39,YV=45,$V=47,bIt=59,i0=60,BE=61,qs=62,Ba=63,WOe=91,VE=93,LOe=133,FOe=8232,GV=t=>t===jOe||t===zOe,UOe=[jOe,zOe],_It=[...UOe,WOe,qs],yIt=[...UOe,i0,VE],wIt=[BE,Ba,...VOe],CIt=[...VOe,qs,q2,i0];function see(t,e,i){switch(e){case"xml":i!==XV&&t.fail(`xml prefix must be bound to ${XV}.`);break;case"xmlns":i!==jE&&t.fail(`xmlns prefix must be bound to ${jE}.`);break;default:}switch(i){case jE:t.fail(e===""?`the default namespace may not be set to ${i}.`:`may not assign a prefix (even "xmlns") to the URI ${jE}.`);break;case XV:switch(e){case"xml":break;case"":t.fail(`the default namespace may not be set to ${i}.`);break;default:t.fail("may not assign the xml namespace to another prefix.")}break;default:}}function xIt(t,e){for(let i of Object.keys(e))see(t,i,e[i])}var SIt=t=>qAt.test(t),EIt=t=>jAt.test(t),Cw=0,HOe=1,oee=2;KV.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];var BOe={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"},aee=class{constructor(e){this.opt=e??{},this.fragmentOpt=!!this.opt.fragment;let i=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,i){this.nameStartCheck=WAt,this.nameCheck=UAt,this.isName=SIt,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},YAt);let r=this.opt.additionalNamespaces;r!=null&&(xIt(this,r),Object.assign(this.ns,r))}else this.nameStartCheck=W2,this.nameCheck=TOe,this.isName=EIt,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var e;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=Cw,this.attribList=[];let{fragmentOpt:i}=this;this.state=i?Kl:ROe,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=i,this.xmlDeclPossible=!i,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:r}=this.opt;if(r===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");r="1.0"}this.setXMLVersion(r),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create($At),(e=this.readyHandler)===null||e===void 0||e.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(e,i){this[BOe[e]]=i}off(e){this[BOe[e]]=void 0}makeError(e){var i;let r=(i=this.fileName)!==null&&i!==void 0?i:"";return this.trackPosition&&(r.length>0&&(r+=":"),r+=`${this.line}:${this.column}`),r.length>0&&(r+=": "),new Error(r+e)}fail(e){let i=this.makeError(e),r=this.errorHandler;if(r===void 0)throw i;return r(i),this}write(e){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let i=!1;e===null?(i=!0,e=""):typeof e=="object"&&(e=e.toString()),this.carriedFromPrevious!==void 0&&(e=`${this.carriedFromPrevious}${e}`,this.carriedFromPrevious=void 0);let r=e.length,n=e.charCodeAt(r-1);!i&&(n===nee||n>=55296&&n<=56319)&&(this.carriedFromPrevious=e[r-1],r--,e=e.slice(0,r));let{stateTable:o}=this;for(this.chunk=e,this.i=0;this.i<r;)o[this.state].call(this);return this.chunkPosition+=r,i?this.end():this}close(){return this.write(null)}getCode10(){let{chunk:e,i}=this;if(this.prevI=i,this.i=i+1,i>=e.length)return So;let r=e.charCodeAt(i);if(this.column++,r<55296){if(r>=NOe||r===ree)return r;switch(r){case Ah:return this.line++,this.column=0,this.positionAtNewLine=this.position,Ah;case nee:return e.charCodeAt(i+1)===Ah&&(this.i=i+2),this.line++,this.column=0,this.positionAtNewLine=this.position,vp;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let n=65536+(r-55296)*1024+(e.charCodeAt(i+1)-56320);return this.i=i+2,n>1114111&&this.fail("disallowed character."),n}getCode11(){let{chunk:e,i}=this;if(this.prevI=i,this.i=i+1,i>=e.length)return So;let r=e.charCodeAt(i);if(this.column++,r<55296){if(r>31&&r<127||r>159&&r!==FOe||r===ree)return r;switch(r){case Ah:return this.line++,this.column=0,this.positionAtNewLine=this.position,Ah;case nee:{let o=e.charCodeAt(i+1);(o===Ah||o===LOe)&&(this.i=i+2)}case LOe:case FOe:return this.line++,this.column=0,this.positionAtNewLine=this.position,vp;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let n=65536+(r-55296)*1024+(e.charCodeAt(i+1)-56320);return this.i=i+2,n>1114111&&this.fail("disallowed character."),n}getCodeNorm(){let e=this.getCode();return e===vp?Ah:e}unget(){this.i=this.prevI,this.column--}captureTo(e){let{i}=this,{chunk:r}=this;for(;;){let n=this.getCode(),o=n===vp,s=o?Ah:n;if(s===So||e.includes(s))return this.text+=r.slice(i,this.prevI),s;o&&(this.text+=`${r.slice(i,this.prevI)}
`,i=this.i)}}captureToChar(e){let{i}=this,{chunk:r}=this;for(;;){let n=this.getCode();switch(n){case vp:this.text+=`${r.slice(i,this.prevI)}
`,i=this.i,n=Ah;break;case So:return this.text+=r.slice(i),!1;default:}if(n===e)return this.text+=r.slice(i,this.prevI),!0}}captureNameChars(){let{chunk:e,i}=this;for(;;){let r=this.getCode();if(r===So)return this.name+=e.slice(i),So;if(!TOe(r))return this.name+=e.slice(i,this.prevI),r===vp?Ah:r}}skipSpaces(){for(;;){let e=this.getCodeNorm();if(e===So||!Hc(e))return e}}setXMLVersion(e){this.currentXMLVersion=e,e==="1.0"?(this.isChar=VAt,this.getCode=this.getCode10):(this.isChar=zAt,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=GAt}sBeginWhitespace(){let e=this.i,i=this.skipSpaces();switch(this.prevI!==e&&(this.xmlDeclPossible=!1),i){case i0:if(this.state=ZJ,this.text.length!==0)throw new Error("no-empty text at start");break;case So:break;default:this.unget(),this.state=Kl,this.xmlDeclPossible=!1}}sDoctype(){var e;let i=this.captureTo(_It);switch(i){case qs:{(e=this.doctypeHandler)===null||e===void 0||e.call(this,this.text),this.text="",this.state=Kl,this.doctype=!0;break}case So:break;default:this.text+=String.fromCodePoint(i),i===WOe?this.state=HE:GV(i)&&(this.state=XAt,this.q=i)}}sDoctypeQuote(){let e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.q=null,this.state=XJ)}sDTD(){let e=this.captureTo(yIt);e!==So&&(this.text+=String.fromCodePoint(e),e===VE?this.state=XJ:e===i0?this.state=ZAt:GV(e)&&(this.state=KAt,this.q=e))}sDTDQuoted(){let e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.state=HE,this.q=null)}sDTDOpenWaka(){let e=this.getCodeNorm();switch(this.text+=String.fromCodePoint(e),e){case POe:this.state=QAt,this.openWakaBang="";break;case Ba:this.state=tIt;break;default:this.state=HE}}sDTDOpenWakaBang(){let e=String.fromCodePoint(this.getCodeNorm()),i=this.openWakaBang+=e;this.text+=e,i!=="-"&&(this.state=i==="--"?KJ:HE,this.openWakaBang="")}sDTDComment(){this.captureToChar(YV)&&(this.text+="-",this.state=JAt)}sDTDCommentEnding(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),this.state=e===YV?eIt:KJ}sDTDCommentEnded(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),e===qs?this.state=HE:(this.fail("malformed comment."),this.state=KJ)}sDTDPI(){this.captureToChar(Ba)&&(this.text+="?",this.state=iIt)}sDTDPIEnding(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),e===qs&&(this.state=HE)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:e}=this,{chunk:i}=this;e:for(;;)switch(this.getCode()){case vp:this.entity+=`${i.slice(e,this.prevI)}
`,e=this.i;break;case bIt:{let{entityReturnState:r}=this,n=this.entity+i.slice(e,this.prevI);this.state=r;let o;n===""?(this.fail("empty entity name."),o="&;"):(o=this.parseEntity(n),this.entity=""),(r!==Kl||this.textHandler!==void 0)&&(this.text+=o);break e}case So:this.entity+=i.slice(e);break e;default:}}sOpenWaka(){let e=this.getCode();if(W2(e))this.state=fIt,this.unget(),this.xmlDeclPossible=!1;else switch(e){case $V:this.state=gIt,this.xmlDeclPossible=!1;break;case POe:this.state=rIt,this.openWakaBang="",this.xmlDeclPossible=!1;break;case Ba:this.state=lIt;break;default:this.fail("disallowed character in tag name"),this.state=Kl,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=JJ,this.openWakaBang="";break;case"--":this.state=QJ,this.openWakaBang="";break;case"DOCTYPE":this.state=XJ,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(YV)&&(this.state=nIt)}sCommentEnding(){var e;let i=this.getCodeNorm();i===YV?(this.state=oIt,(e=this.commentHandler)===null||e===void 0||e.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(i)}`,this.state=QJ)}sCommentEnded(){let e=this.getCodeNorm();e!==qs?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(e)}`,this.state=QJ):this.state=Kl}sCData(){this.captureToChar(VE)&&(this.state=sIt)}sCDataEnding(){let e=this.getCodeNorm();e===VE?this.state=aIt:(this.text+=`]${String.fromCodePoint(e)}`,this.state=JJ)}sCDataEnding2(){var e;let i=this.getCodeNorm();switch(i){case qs:{(e=this.cdataHandler)===null||e===void 0||e.call(this,this.text),this.text="",this.state=Kl;break}case VE:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(i)}`,this.state=JJ}}sPIFirstChar(){let e=this.getCodeNorm();this.nameStartCheck(e)?(this.piTarget+=String.fromCodePoint(e),this.state=AOe):e===Ba||Hc(e)?(this.fail("processing instruction without a target."),this.state=e===Ba?qV:eee):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(e),this.state=AOe)}sPIRest(){let{chunk:e,i}=this;for(;;){let r=this.getCodeNorm();if(r===So){this.piTarget+=e.slice(i);return}if(!this.nameCheck(r)){this.piTarget+=e.slice(i,this.prevI);let n=r===Ba;n||Hc(r)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=n?ww:IOe):this.state=n?qV:eee:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(r));break}}}sPIBody(){if(this.text.length===0){let e=this.getCodeNorm();e===Ba?this.state=qV:Hc(e)||(this.text=String.fromCodePoint(e))}else this.captureToChar(Ba)&&(this.state=qV)}sPIEnding(){var e;let i=this.getCodeNorm();if(i===qs){let{piTarget:r}=this;r.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(e=this.piHandler)===null||e===void 0||e.call(this,{target:r,body:this.text}),this.piTarget=this.text="",this.state=Kl}else i===Ba?this.text+="?":(this.text+=`?${String.fromCodePoint(i)}`,this.state=eee);this.xmlDeclPossible=!1}sXMLDeclNameStart(){let e=this.skipSpaces();if(e===Ba){this.state=ww;return}e!==So&&(this.state=cIt,this.name=String.fromCodePoint(e))}sXMLDeclName(){let e=this.captureTo(wIt);if(e===Ba){this.state=ww,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(Hc(e)||e===BE){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=e===BE?DOe:dIt}}sXMLDeclEq(){let e=this.getCodeNorm();if(e===Ba){this.state=ww,this.fail("XML declaration is incomplete.");return}Hc(e)||(e!==BE&&this.fail("value required."),this.state=DOe)}sXMLDeclValueStart(){let e=this.getCodeNorm();if(e===Ba){this.state=ww,this.fail("XML declaration is incomplete.");return}Hc(e)||(GV(e)?this.q=e:(this.fail("value must be quoted."),this.q=NOe),this.state=uIt)}sXMLDeclValue(){let e=this.captureTo([this.q,Ba]);if(e===Ba){this.state=ww,this.text="",this.fail("XML declaration is incomplete.");return}if(e===So)return;let i=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];let r=i;this.xmlDecl.version=r,/^1\.[0-9]+$/.test(r)?this.opt.forceXMLVersion||this.setXMLVersion(r):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(i)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=i;break;case"standalone":i!=="yes"&&i!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=i;break;default:}this.name="",this.state=hIt}sXMLDeclSeparator(){let e=this.getCodeNorm();if(e===Ba){this.state=ww;return}Hc(e)||(this.fail("whitespace required."),this.unget()),this.state=IOe}sXMLDeclEnding(){var e;this.getCodeNorm()===qs?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(e=this.xmldeclHandler)===null||e===void 0||e.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=Kl):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var e;let i=this.captureNameChars();if(i===So)return;let r=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=r.ns=Object.create(null)),(e=this.openTagStartHandler)===null||e===void 0||e.call(this,r),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),i){case qs:this.openTag();break;case $V:this.state=tee;break;default:Hc(i)||this.fail("disallowed character in tag name."),this.state=U2}}sOpenTagSlash(){this.getCode()===qs?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=U2)}sAttrib(){let e=this.skipSpaces();e!==So&&(W2(e)?(this.unget(),this.state=iee):e===qs?this.openTag():e===$V?this.state=tee:this.fail("disallowed character in attribute name."))}sAttribName(){let e=this.captureNameChars();e===BE?this.state=MOe:Hc(e)?this.state=pIt:e===qs?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):e!==So&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){let e=this.skipSpaces();switch(e){case So:return;case BE:this.state=MOe;break;default:this.fail("attribute without value."),this.text="",this.name="",e===qs?this.openTag():W2(e)?(this.unget(),this.state=iee):(this.fail("disallowed character in attribute name."),this.state=U2)}}sAttribValue(){let e=this.getCodeNorm();GV(e)?(this.q=e,this.state=kOe):Hc(e)||(this.fail("unquoted attribute value."),this.state=OOe,this.unget())}sAttribValueQuoted(){let{q:e,chunk:i}=this,{i:r}=this;for(;;)switch(this.getCode()){case e:this.pushAttrib(this.name,this.text+i.slice(r,this.prevI)),this.name=this.text="",this.q=null,this.state=mIt;return;case q2:this.text+=i.slice(r,this.prevI),this.state=UV,this.entityReturnState=kOe;return;case Ah:case vp:case ree:this.text+=`${i.slice(r,this.prevI)} `,r=this.i;break;case i0:this.text+=i.slice(r,this.prevI),this.fail("disallowed character.");return;case So:this.text+=i.slice(r);return;default:}}sAttribValueClosed(){let e=this.getCodeNorm();Hc(e)?this.state=U2:e===qs?this.openTag():e===$V?this.state=tee:W2(e)?(this.fail("no whitespace between attributes."),this.unget(),this.state=iee):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){let e=this.captureTo(CIt);switch(e){case q2:this.state=UV,this.entityReturnState=OOe;break;case i0:this.fail("disallowed character.");break;case So:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",e===qs?this.openTag():this.state=U2}}sCloseTag(){let e=this.captureNameChars();e===qs?this.closeTag():Hc(e)?this.state=vIt:e!==So&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case qs:this.closeTag();break;case So:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:e,forbiddenState:i}=this,{chunk:r,textHandler:n}=this;e:for(;;)switch(this.getCode()){case i0:{if(this.state=ZJ,n!==void 0){let{text:o}=this,s=r.slice(e,this.prevI);o.length!==0?(n(o+s),this.text=""):s.length!==0&&n(s)}i=Cw;break e}case q2:this.state=UV,this.entityReturnState=Kl,n!==void 0&&(this.text+=r.slice(e,this.prevI)),i=Cw;break e;case VE:switch(i){case Cw:i=HOe;break;case HOe:i=oee;break;case oee:break;default:throw new Error("impossible state")}break;case qs:i===oee&&this.fail('the string "]]>" is disallowed in char data.'),i=Cw;break;case vp:n!==void 0&&(this.text+=`${r.slice(e,this.prevI)}
`),e=this.i,i=Cw;break;case So:n!==void 0&&(this.text+=r.slice(e));break e;default:i=Cw}this.forbiddenState=i}handleTextOutsideRoot(){let{i:e}=this,{chunk:i,textHandler:r}=this,n=!1;e:for(;;){let o=this.getCode();switch(o){case i0:{if(this.state=ZJ,r!==void 0){let{text:s}=this,a=i.slice(e,this.prevI);s.length!==0?(r(s+a),this.text=""):a.length!==0&&r(a)}break e}case q2:this.state=UV,this.entityReturnState=Kl,r!==void 0&&(this.text+=i.slice(e,this.prevI)),n=!0;break e;case vp:r!==void 0&&(this.text+=`${i.slice(e,this.prevI)}
`),e=this.i;break;case So:r!==void 0&&(this.text+=i.slice(e));break e;default:Hc(o)||(n=!0)}}n&&(!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(e,i){var r;let{prefix:n,local:o}=this.qname(e),s={name:e,prefix:n,local:o,value:i};if(this.attribList.push(s),(r=this.attributeHandler)===null||r===void 0||r.call(this,s),n==="xmlns"){let a=i.trim();this.currentXMLVersion==="1.0"&&a===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[o]=a,see(this,o,a)}else if(e==="xmlns"){let a=i.trim();this.topNS[""]=a,see(this,"",a)}}pushAttribPlain(e,i){var r;let n={name:e,value:i};this.attribList.push(n),(r=this.attributeHandler)===null||r===void 0||r.call(this,n)}end(){var e,i;this.sawRoot||this.fail("document must contain a root element.");let{tags:r}=this;for(;r.length>0;){let o=r.pop();this.fail(`unclosed tag: ${o.name}`)}this.state!==ROe&&this.state!==Kl&&this.fail("unexpected end.");let{text:n}=this;return n.length!==0&&((e=this.textHandler)===null||e===void 0||e.call(this,n),this.text=""),this._closed=!0,(i=this.endHandler)===null||i===void 0||i.call(this),this._init(),this}resolve(e){var i,r;let n=this.topNS[e];if(n!==void 0)return n;let{tags:o}=this;for(let s=o.length-1;s>=0;s--)if(n=o[s].ns[e],n!==void 0)return n;return n=this.ns[e],n!==void 0?n:(r=(i=this.opt).resolvePrefix)===null||r===void 0?void 0:r.call(i,e)}qname(e){let i=e.indexOf(":");if(i===-1)return{prefix:"",local:e};let r=e.slice(i+1),n=e.slice(0,i);return(n===""||r===""||r.includes(":"))&&this.fail(`malformed name: ${e}.`),{prefix:n,local:r}}processAttribsNS(){var e;let{attribList:i}=this,r=this.tag;{let{prefix:s,local:a}=this.qname(r.name);r.prefix=s,r.local=a;let c=r.uri=(e=this.resolve(s))!==null&&e!==void 0?e:"";s!==""&&(s==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),c===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(s)}.`),r.uri=s))}if(i.length===0)return;let{attributes:n}=r,o=new Set;for(let s of i){let{name:a,prefix:c,local:d}=s,u,h;c===""?(u=a==="xmlns"?jE:"",h=a):(u=this.resolve(c),u===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(c)}.`),u=c),h=`{${u}}${d}`),o.has(h)&&this.fail(`duplicate attribute: ${h}.`),o.add(h),s.uri=u,n[a]=s}this.attribList=[]}processAttribsPlain(){let{attribList:e}=this,i=this.tag.attributes;for(let{name:r,value:n}of e)i[r]!==void 0&&this.fail(`duplicate attribute: ${r}.`),i[r]=n;this.attribList=[]}openTag(){var e;this.processAttribs();let{tags:i}=this,r=this.tag;r.isSelfClosing=!1,(e=this.openTagHandler)===null||e===void 0||e.call(this,r),i.push(r),this.state=Kl,this.name=""}openSelfClosingTag(){var e,i,r;this.processAttribs();let{tags:n}=this,o=this.tag;o.isSelfClosing=!0,(e=this.openTagHandler)===null||e===void 0||e.call(this,o),(i=this.closeTagHandler)===null||i===void 0||i.call(this,o),(this.tag=(r=n[n.length-1])!==null&&r!==void 0?r:null)===null&&(this.closedRoot=!0),this.state=Kl,this.name=""}closeTag(){let{tags:e,name:i}=this;if(this.state=Kl,this.name="",i===""){this.fail("weird empty close tag."),this.text+="</>";return}let r=this.closeTagHandler,n=e.length;for(;n-- >0;){let o=this.tag=e.pop();if(this.topNS=o.ns,r?.(o),o.name===i)break;this.fail("unexpected close tag.")}n===0?this.closedRoot=!0:n<0&&(this.fail(`unmatched closing tag: ${i}.`),this.text+=`</${i}>`)}parseEntity(e){if(e[0]!=="#"){let r=this.ENTITIES[e];return r!==void 0?r:(this.fail(this.isName(e)?"undefined entity.":"disallowed character in entity name."),`&${e};`)}let i=NaN;return e[1]==="x"&&/^#x[0-9a-f]+$/i.test(e)?i=parseInt(e.slice(2),16):/^#[0-9]+$/.test(e)&&(i=parseInt(e.slice(1),10)),this.isChar(i)?String.fromCodePoint(i):(this.fail("malformed character entity."),`&${e};`)}};KV.SaxesParser=aee});var Y2=z((qXi,YOe)=>{"use strict";var{SaxesParser:TIt}=qOe(),{PassThrough:RIt}=_l(),{bufferToString:AIt}=UJ();YOe.exports=function(t){return dc(this,null,function*(){t.pipe&&!t[Symbol.asyncIterator]&&(t=t.pipe(new RIt));let e=new TIt,i;e.on("error",c=>{i=c});let r=[];e.on("opentag",c=>r.push({eventType:"opentag",value:c})),e.on("text",c=>r.push({eventType:"text",value:c})),e.on("closetag",c=>r.push({eventType:"closetag",value:c}));try{for(var n=Ea(t),o,s,a;o=!(s=yield new _o(n.next())).done;o=!1){let c=s.value;if(e.write(AIt(c)),i)throw i;yield r,r=[]}}catch{a=[s]}finally{try{o&&(s=n.return)&&(yield new _o(s.call(n)))}finally{if(a)throw a[0]}}})}});var mt=z(($Xi,$Oe)=>{"use strict";var IIt=Y2(),DIt=Ha(),cee=class t{prepare(){}render(){}parseOpen(e){}parseText(e){}parseClose(e){}reconcile(e,i){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(e=>{e instanceof t?e.reset():e.xform&&e.xform.reset()})}mergeModel(e){this.model=Object.assign(this.model||{},e)}parse(e){return Ei(this,null,function*(){try{for(var i=Ea(e),r,n,o;r=!(n=yield i.next()).done;r=!1){let s=n.value;for(let{eventType:a,value:c}of s)if(a==="opentag")this.parseOpen(c);else if(a==="text")this.parseText(c);else if(a==="closetag"&&!this.parseClose(c.name))return this.model}}catch{o=[n]}finally{try{r&&(n=i.return)&&(yield n.call(i))}finally{if(o)throw o[0]}}return this.model})}parseStream(e){return Ei(this,null,function*(){return this.parse(IIt(e))})}get xml(){return this.toXml(this.model)}toXml(e){let i=new DIt;return this.render(i,e),i.xml}static toAttribute(e,i,r=!1){if(e===void 0){if(r)return i}else if(r||e!==i)return e.toString()}static toStringAttribute(e,i,r=!1){return t.toAttribute(e,i,r)}static toStringValue(e,i){return e===void 0?i:e}static toBoolAttribute(e,i,r=!1){if(e===void 0){if(r)return i}else if(r||e!==i)return e?"1":"0"}static toBoolValue(e,i){return e===void 0?i:e==="1"}static toIntAttribute(e,i,r=!1){return t.toAttribute(e,i,r)}static toIntValue(e,i){return e===void 0?i:parseInt(e,10)}static toFloatAttribute(e,i,r=!1){return t.toAttribute(e,i,r)}static toFloatValue(e,i){return e===void 0?i:parseFloat(e)}};$Oe.exports=cee});var WE=z((XXi,XOe)=>{"use strict";var MIt=mt(),kIt=Ha();function GOe(t,e){t.openNode(e.tag,e.$),e.c&&e.c.forEach(i=>{GOe(t,i)}),e.t&&t.writeText(e.t),t.closeNode()}var dee=class extends MIt{constructor(e){super(),this._model=e}render(e){if(!this._xml){let i=new kIt;GOe(i,this._model),this._xml=i.xml}e.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(e){switch(e){case this._model.tag:return!1;default:return!0}}};XOe.exports=dee});var r0=z((KXi,KOe)=>{"use strict";var OIt=mt(),uee=class extends OIt{constructor(e){super(),this.tag=e.tag,this.always=!!e.always,this.count=e.count,this.empty=e.empty,this.$count=e.$count||"count",this.$=e.$,this.childXform=e.childXform,this.maxItems=e.maxItems}prepare(e,i){let{childXform:r}=this;e&&e.forEach((n,o)=>{i.index=o,r.prepare(n,i)})}render(e,i){if(this.always||i&&i.length){e.openNode(this.tag,this.$),this.count&&e.addAttribute(this.$count,i&&i.length||0);let{childXform:r}=this;(i||[]).forEach((n,o)=>{r.render(e,n,o)}),e.closeNode()}else this.empty&&e.leafNode(this.tag)}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:return this.model=[],!0;default:return this.childXform.parseOpen(e)?(this.parser=this.childXform,!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(e,i){if(e){let{childXform:r}=this;e.forEach(n=>{r.reconcile(n,i)})}}};KOe.exports=uee});var n0=z((ZXi,ZOe)=>{"use strict";var NIt=mt(),hee=class extends NIt{constructor(e){super(),this.name=e||"color"}get tag(){return this.name}render(e,i){return i?(e.openNode(this.name),i.argb?e.addAttribute("rgb",i.argb):i.theme!==void 0?(e.addAttribute("theme",i.theme),i.tint!==void 0&&e.addAttribute("tint",i.tint)):i.indexed!==void 0?e.addAttribute("indexed",i.indexed):e.addAttribute("auto","1"),e.closeNode(),!0):!1}parseOpen(e){return e.name===this.name?(e.attributes.rgb?this.model={argb:e.attributes.rgb}:e.attributes.theme?(this.model={theme:parseInt(e.attributes.theme,10)},e.attributes.tint&&(this.model.tint=parseFloat(e.attributes.tint))):e.attributes.indexed?this.model={indexed:parseInt(e.attributes.indexed,10)}:this.model=void 0,!0):!1}parseText(){}parseClose(){return!1}};ZOe.exports=hee});var JOe=z((QXi,QOe)=>{"use strict";var PIt=mt(),fee=class extends PIt{constructor(e){super(),this.tag=e.tag,this.attr=e.attr}render(e,i){i&&(e.openNode(this.tag),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}};QOe.exports=fee});var ZV=z((JXi,e2e)=>{"use strict";var LIt=mt(),pee=class extends LIt{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this.zero=e.zero}render(e,i){(i||this.zero)&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,i):e.writeText(i),e.closeNode())}parseOpen(e){return e.name===this.tag?(this.attr?this.model=parseInt(e.attributes[this.attr],10):this.text=[],!0):!1}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}};e2e.exports=pee});var QV=z((eKi,t2e)=>{"use strict";var FIt=mt(),mee=class extends FIt{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs}render(e,i){i!==void 0&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,i):e.writeText(i),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=e.attributes[this.attr]:this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}};t2e.exports=mee});var r2e=z((tKi,i2e)=>{"use strict";var HIt=mt(),BIt=(()=>{class t extends HIt{constructor(i){super(),this.model=i}get tag(){return"u"}render(i,r){if(r=r||this.model,r===!0)i.leafNode("u");else{let n=t.Attributes[r];n&&i.leafNode("u",n)}}parseOpen(i){i.name==="u"&&(this.model=i.attributes.val||!0)}parseText(){}parseClose(){return!1}}return t.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},t})();i2e.exports=BIt});var JV=z((iKi,n2e)=>{"use strict";var VIt=n0(),xw=JOe(),gee=ZV(),vee=QV(),jIt=r2e(),zIt=Go(),WIt=mt(),UIt=(()=>{class t extends WIt{constructor(i){super(),this.options=i||t.OPTIONS,this.map={b:{prop:"bold",xform:new xw({tag:"b",attr:"val"})},i:{prop:"italic",xform:new xw({tag:"i",attr:"val"})},u:{prop:"underline",xform:new jIt},charset:{prop:"charset",xform:new gee({tag:"charset",attr:"val"})},color:{prop:"color",xform:new VIt},condense:{prop:"condense",xform:new xw({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new xw({tag:"extend",attr:"val"})},family:{prop:"family",xform:new gee({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new xw({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new vee({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new vee({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new xw({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new xw({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new gee({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new vee({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(i,r){let{map:n}=this;i.openNode(this.options.tagName),zIt.each(this.map,(o,s)=>{n[s].xform.render(i,r[o.prop])}),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;if(this.map[i.name])return this.parser=this.map[i.name].xform,this.parser.parseOpen(i);switch(i.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser&&!this.parser.parseClose(i)){let r=this.map[i];return this.parser.model&&(this.model[r.prop]=this.parser.model),this.parser=void 0,!0}switch(i){case this.options.tagName:return!1;default:return!0}}}return t.OPTIONS={tagName:"font",fontNameTag:"name"},t})();n2e.exports=UIt});var _ee=z((rKi,o2e)=>{"use strict";var rj=mt(),bee=n0(),ej=class extends rj{constructor(){super(),this.map={color:new bee}}get tag(){return"stop"}render(e,i){e.openNode("stop"),e.addAttribute("position",i.position),this.map.color.render(e,i.color),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"stop":return this.model={position:parseFloat(e.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model.color=this.parser.model,this.parser=void 0),!0):!1}},tj=class extends rj{constructor(){super(),this.map={fgColor:new bee("fgColor"),bgColor:new bee("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(e,i){e.openNode("patternFill"),e.addAttribute("patternType",i.pattern),i.fgColor&&this.map.fgColor.render(e,i.fgColor),i.bgColor&&this.map.bgColor.render(e,i.bgColor),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"patternFill":return this.model={type:"pattern",pattern:e.attributes.patternType},!0;default:return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser.model&&(this.model[e]=this.parser.model),this.parser=void 0),!0):!1}},ij=class extends rj{constructor(){super(),this.map={stop:new ej}}get name(){return"gradient"}get tag(){return"gradientFill"}render(e,i){switch(e.openNode("gradientFill"),i.gradient){case"angle":e.addAttribute("degree",i.degree);break;case"path":e.addAttribute("type","path"),i.center.left&&(e.addAttribute("left",i.center.left),i.center.right===void 0&&e.addAttribute("right",i.center.left)),i.center.right&&e.addAttribute("right",i.center.right),i.center.top&&(e.addAttribute("top",i.center.top),i.center.bottom===void 0&&e.addAttribute("bottom",i.center.top)),i.center.bottom&&e.addAttribute("bottom",i.center.bottom);break;default:break}let r=this.map.stop;i.stops.forEach(n=>{r.render(e,n)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"gradientFill":{let i=this.model={stops:[]};return e.attributes.degree?(i.gradient="angle",i.degree=parseInt(e.attributes.degree,10)):e.attributes.type==="path"&&(i.gradient="path",i.center={left:e.attributes.left?parseFloat(e.attributes.left):0,top:e.attributes.top?parseFloat(e.attributes.top):0},e.attributes.right!==e.attributes.left&&(i.center.right=e.attributes.right?parseFloat(e.attributes.right):0),e.attributes.bottom!==e.attributes.top&&(i.center.bottom=e.attributes.bottom?parseFloat(e.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0):!1}},Sw=class t extends rj{constructor(){super(),this.map={patternFill:new tj,gradientFill:new ij}}get tag(){return"fill"}render(e,i){switch(e.addRollback(),e.openNode("fill"),i.type){case"pattern":this.map.patternFill.render(e,i);break;case"gradient":this.map.gradientFill.render(e,i);break;default:e.rollback();return}e.closeNode(),e.commit()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"fill":return this.model={},!0;default:return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0):!1}validStyle(e){return t.validPatternValues[e]}};Sw.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((t,e)=>(t[e]=!0,t),{});Sw.StopXform=ej;Sw.PatternFillXform=tj;Sw.GradientFillXform=ij;o2e.exports=Sw});var wee=z((nKi,l2e)=>{"use strict";var a2e=mt(),s2e=yl(),qIt=n0(),o0=class t extends a2e{constructor(e){super(),this.name=e,this.map={color:new qIt}}get tag(){return this.name}render(e,i,r){let n=i&&i.color||r||this.defaultColor;e.openNode(this.name),i&&i.style&&(e.addAttribute("style",i.style),n&&this.map.color.render(e,n)),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.name:{let{style:i}=e.attributes;return i?this.model={style:i}:this.model=void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(e===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(e){return t.validStyleValues[e]}};o0.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((t,e)=>(t[e]=!0,t),{});var yee=class extends a2e{constructor(){super(),this.map={top:new o0("top"),left:new o0("left"),bottom:new o0("bottom"),right:new o0("right"),diagonal:new o0("diagonal")}}render(e,i){let{color:r}=i;e.openNode("border"),i.diagonal&&i.diagonal.style&&(i.diagonal.up&&e.addAttribute("diagonalUp","1"),i.diagonal.down&&e.addAttribute("diagonalDown","1"));function n(o,s){o&&!o.color&&i.color&&(o=Lt(Ke({},o),{color:i.color})),s.render(e,o,r)}n(i.left,this.map.left),n(i.right,this.map.right),n(i.top,this.map.top),n(i.bottom,this.map.bottom),n(i.diagonal,this.map.diagonal),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"border":return this.reset(),this.diagonalUp=s2e.parseBoolean(e.attributes.diagonalUp),this.diagonalDown=s2e.parseBoolean(e.attributes.diagonalDown),!0;default:return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e==="border"){let i=this.model={},r=function(n,o,s){o&&(s&&Object.assign(o,s),i[n]=o)};r("left",this.map.left.model),r("right",this.map.right.model),r("top",this.map.top.model),r("bottom",this.map.bottom.model),r("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}};l2e.exports=yee});var d2e=z((sKi,c2e)=>{"use strict";c2e.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},28:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"ja-jp":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":'yyyy"\uB144" mm"\uC6D4" dd"\uC77C"'},32:{"zh-tw":'hh"\u6642"mm"\u5206"',"zh-cn":'h"\u65F6"mm"\u5206"',"ja-jp":'h"\u6642"mm"\u5206"',"ko-kr":'h"\uC2DC" mm"\uBD84"'},33:{"zh-tw":'hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'h"\u6642"mm"\u5206"ss"\u79D2"',"ko-kr":'h"\uC2DC" mm"\uBD84" ss"\uCD08"'},34:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},51:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},52:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},55:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},58:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}});var xee=z((aKi,u2e)=>{"use strict";var YIt=Go(),Cee=d2e(),$It=mt();function GIt(){let t={};return YIt.each(Cee,(e,i)=>{e.f&&(t[e.f]=parseInt(i,10))}),t}var XIt=GIt(),KIt=(()=>{class t extends $It{constructor(i,r){super(),this.id=i,this.formatCode=r}get tag(){return"numFmt"}render(i,r){i.leafNode("numFmt",{numFmtId:r.id,formatCode:r.formatCode})}parseOpen(i){switch(i.name){case"numFmt":return this.model={id:parseInt(i.attributes.numFmtId,10),formatCode:i.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}return t.getDefaultFmtId=function(i){return XIt[i]},t.getDefaultFmtCode=function(i){return Cee[i]&&Cee[i].f},t})();u2e.exports=KIt});var Eee=z((lKi,p2e)=>{"use strict";var h2e=wh(),$2=yl(),ZIt=mt(),Ew={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((t,e)=>(t[e]=!0,t),{}),horizontal(t){return this.horizontalValues[t]?t:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((t,e)=>(t[e]=!0,t),{}),vertical(t){return t==="middle"?"center":this.verticalValues[t]?t:void 0},wrapText(t){return t?!0:void 0},shrinkToFit(t){return t?!0:void 0},textRotation(t){switch(t){case"vertical":return t;default:return t=$2.validInt(t),t>=-90&&t<=90?t:void 0}},indent(t){return t=$2.validInt(t),Math.max(0,t)},readingOrder(t){switch(t){case"ltr":return h2e.ReadingOrder.LeftToRight;case"rtl":return h2e.ReadingOrder.RightToLeft;default:return}}},f2e={toXml(t){if(t=Ew.textRotation(t),t){if(t==="vertical")return 255;let e=Math.round(t);if(e>=0&&e<=90)return e;if(e<0&&e>=-90)return 90-e}},toModel(t){let e=$2.validInt(t);if(e!==void 0){if(e===255)return"vertical";if(e>=0&&e<=90)return e;if(e>90&&e<=180)return 90-e}}},See=class extends ZIt{get tag(){return"alignment"}render(e,i){e.addRollback(),e.openNode("alignment");let r=!1;function n(o,s){s&&(e.addAttribute(o,s),r=!0)}n("horizontal",Ew.horizontal(i.horizontal)),n("vertical",Ew.vertical(i.vertical)),n("wrapText",Ew.wrapText(i.wrapText)?"1":!1),n("shrinkToFit",Ew.shrinkToFit(i.shrinkToFit)?"1":!1),n("indent",Ew.indent(i.indent)),n("textRotation",f2e.toXml(i.textRotation)),n("readingOrder",Ew.readingOrder(i.readingOrder)),e.closeNode(),r?e.commit():e.rollback()}parseOpen(e){let i={},r=!1;function n(o,s,a){o&&(i[s]=a,r=!0)}n(e.attributes.horizontal,"horizontal",e.attributes.horizontal),n(e.attributes.vertical,"vertical",e.attributes.vertical==="center"?"middle":e.attributes.vertical),n(e.attributes.wrapText,"wrapText",$2.parseBoolean(e.attributes.wrapText)),n(e.attributes.shrinkToFit,"shrinkToFit",$2.parseBoolean(e.attributes.shrinkToFit)),n(e.attributes.indent,"indent",parseInt(e.attributes.indent,10)),n(e.attributes.textRotation,"textRotation",f2e.toModel(e.attributes.textRotation)),n(e.attributes.readingOrder,"readingOrder",e.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=r?i:null}parseText(){}parseClose(){return!1}};p2e.exports=See});var Ree=z((cKi,g2e)=>{"use strict";var QIt=mt(),m2e={boolean(t,e){return t===void 0?e:t}},Tee=class extends QIt{get tag(){return"protection"}render(e,i){e.addRollback(),e.openNode("protection");let r=!1;function n(o,s){s!==void 0&&(e.addAttribute(o,s),r=!0)}n("locked",m2e.boolean(i.locked,!0)?void 0:"0"),n("hidden",m2e.boolean(i.hidden,!1)?"1":void 0),e.closeNode(),r?e.commit():e.rollback()}parseOpen(e){let i={locked:e.attributes.locked!=="0",hidden:e.attributes.hidden==="1"},r=!i.locked||i.hidden;this.model=r?i:null}parseText(){}parseClose(){return!1}};g2e.exports=Tee});var b2e=z((dKi,v2e)=>{"use strict";var JIt=mt(),eDt=Eee(),tDt=Ree(),Aee=class extends JIt{constructor(e){super(),this.xfId=!!(e&&e.xfId),this.map={alignment:new eDt,protection:new tDt}}get tag(){return"xf"}render(e,i){e.openNode("xf",{numFmtId:i.numFmtId||0,fontId:i.fontId||0,fillId:i.fillId||0,borderId:i.borderId||0}),this.xfId&&e.addAttribute("xfId",i.xfId||0),i.numFmtId&&e.addAttribute("applyNumberFormat","1"),i.fontId&&e.addAttribute("applyFont","1"),i.fillId&&e.addAttribute("applyFill","1"),i.borderId&&e.addAttribute("applyBorder","1"),i.alignment&&e.addAttribute("applyAlignment","1"),i.protection&&e.addAttribute("applyProtection","1"),i.alignment&&this.map.alignment.render(e,i.alignment),i.protection&&this.map.protection.render(e,i.protection),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"xf":return this.model={numFmtId:parseInt(e.attributes.numFmtId,10),fontId:parseInt(e.attributes.fontId,10),fillId:parseInt(e.attributes.fillId,10),borderId:parseInt(e.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(e.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(e),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):e!=="xf"}};v2e.exports=Aee});var y2e=z((uKi,_2e)=>{"use strict";var iDt=mt(),rDt=Eee(),nDt=wee(),oDt=_ee(),sDt=JV(),aDt=xee(),lDt=Ree(),Iee=class extends iDt{constructor(){super(),this.map={alignment:new rDt,border:new nDt,fill:new oDt,font:new sDt,numFmt:new aDt,protection:new lDt}}get tag(){return"dxf"}render(e,i){if(e.openNode(this.tag),i.font&&this.map.font.render(e,i.font),i.numFmt&&i.numFmtId){let r={id:i.numFmtId,formatCode:i.numFmt};this.map.numFmt.render(e,r)}i.fill&&this.map.fill.render(e,i.fill),i.alignment&&this.map.alignment.render(e,i.alignment),i.border&&this.map.border.render(e,i.border),i.protection&&this.map.protection.render(e,i.protection),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e===this.tag?(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1):!0}};_2e.exports=Iee});var sj=z((hKi,S2e)=>{"use strict";var oj=wh(),cDt=Ha(),dDt=mt(),nj=WE(),Tw=r0(),w2e=JV(),C2e=_ee(),x2e=wee(),G2=xee(),Dee=b2e(),uDt=y2e(),hDt=164,Rw=class t extends dDt{constructor(e){super(),this.map={numFmts:new Tw({tag:"numFmts",count:!0,childXform:new G2}),fonts:new Tw({tag:"fonts",count:!0,childXform:new w2e,$:{"x14ac:knownFonts":1}}),fills:new Tw({tag:"fills",count:!0,childXform:new C2e}),borders:new Tw({tag:"borders",count:!0,childXform:new x2e}),cellStyleXfs:new Tw({tag:"cellStyleXfs",count:!0,childXform:new Dee}),cellXfs:new Tw({tag:"cellXfs",count:!0,childXform:new Dee({xfId:!0})}),dxfs:new Tw({tag:"dxfs",always:!0,count:!0,childXform:new uDt}),numFmt:new G2,font:new w2e,fill:new C2e,border:new x2e,style:new Dee({xfId:!0}),cellStyles:t.STATIC_XFORMS.cellStyles,tableStyles:t.STATIC_XFORMS.tableStyles,extLst:t.STATIC_XFORMS.extLst},e&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(e,i){i=i||this.model,e.openXml(cDt.StdDocAttributes),e.openNode("styleSheet",t.STYLESHEET_ATTRIBUTES),this.index?(i.numFmts&&i.numFmts.length&&(e.openNode("numFmts",{count:i.numFmts.length}),i.numFmts.forEach(r=>{e.writeXml(r)}),e.closeNode()),i.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),e.openNode("fonts",{count:i.fonts.length,"x14ac:knownFonts":1}),i.fonts.forEach(r=>{e.writeXml(r)}),e.closeNode(),e.openNode("fills",{count:i.fills.length}),i.fills.forEach(r=>{e.writeXml(r)}),e.closeNode(),e.openNode("borders",{count:i.borders.length}),i.borders.forEach(r=>{e.writeXml(r)}),e.closeNode(),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),e.openNode("cellXfs",{count:i.styles.length}),i.styles.forEach(r=>{e.writeXml(r)}),e.closeNode()):(this.map.numFmts.render(e,i.numFmts),this.map.fonts.render(e,i.fonts),this.map.fills.render(e,i.fills),this.map.borders.render(e,i.borders),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(e,i.styles)),t.STATIC_XFORMS.cellStyles.render(e),this.map.dxfs.render(e,i.dxfs),t.STATIC_XFORMS.tableStyles.render(e),t.STATIC_XFORMS.extLst.render(e),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"styleSheet":{this.model={};let i=(r,n)=>{n.model&&n.model.length&&(this.model[r]=n.model)};if(i("numFmts",this.map.numFmts),i("fonts",this.map.fonts),i("fills",this.map.fills),i("borders",this.map.borders),i("styles",this.map.cellXfs),i("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){let r=this.index.numFmt;this.model.numFmts.forEach(n=>{r[n.id]=n.formatCode})}return!1}default:return!0}}addStyleModel(e,i){if(!e)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(e))return this.weakMap.get(e);let r={};if(i=i||oj.ValueType.Number,e.numFmt)r.numFmtId=this._addNumFmtStr(e.numFmt);else switch(i){case oj.ValueType.Number:r.numFmtId=this._addNumFmtStr("General");break;case oj.ValueType.Date:r.numFmtId=this._addNumFmtStr("mm-dd-yy");break;default:break}e.font&&(r.fontId=this._addFont(e.font)),e.border&&(r.borderId=this._addBorder(e.border)),e.fill&&(r.fillId=this._addFill(e.fill)),e.alignment&&(r.alignment=e.alignment),e.protection&&(r.protection=e.protection);let n=this._addStyle(r);return this.weakMap&&this.weakMap.set(e,n),n}getStyleModel(e){let i=this.model.styles[e];if(!i)return null;let r=this.index.model[e];if(r)return r;if(r=this.index.model[e]={},i.numFmtId){let o=this.index.numFmt[i.numFmtId]||G2.getDefaultFmtCode(i.numFmtId);o&&(r.numFmt=o)}function n(o,s,a){if(a||a===0){let c=s[a];c&&(r[o]=c)}}return n("font",this.model.fonts,i.fontId),n("border",this.model.borders,i.borderId),n("fill",this.model.fills,i.fillId),i.alignment&&(r.alignment=i.alignment),i.protection&&(r.protection=i.protection),r}addDxfStyle(e){return e.numFmt&&(e.numFmtId=this._addNumFmtStr(e.numFmt)),this.model.dxfs.push(e),this.model.dxfs.length-1}getDxfStyle(e){return this.model.dxfs[e]}_addStyle(e){let i=this.map.style.toXml(e),r=this.index.style[i];return r===void 0&&(r=this.index.style[i]=this.model.styles.length,this.model.styles.push(i)),r}_addNumFmtStr(e){let i=G2.getDefaultFmtId(e);if(i!==void 0||(i=this.index.numFmt[e],i!==void 0))return i;i=this.index.numFmt[e]=hDt+this.model.numFmts.length;let r=this.map.numFmt.toXml({id:i,formatCode:e});return this.model.numFmts.push(r),i}_addFont(e){let i=this.map.font.toXml(e),r=this.index.font[i];return r===void 0&&(r=this.index.font[i]=this.model.fonts.length,this.model.fonts.push(i)),r}_addBorder(e){let i=this.map.border.toXml(e),r=this.index.border[i];return r===void 0&&(r=this.index.border[i]=this.model.borders.length,this.model.borders.push(i)),r}_addFill(e){let i=this.map.fill.toXml(e),r=this.index.fill[i];return r===void 0&&(r=this.index.fill[i]=this.model.fills.length,this.model.fills.push(i)),r}};Rw.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"};Rw.STATIC_XFORMS={cellStyles:new nj({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new nj({tag:"dxfs",$:{count:0}}),tableStyles:new nj({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new nj({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})};var Mee=class extends Rw{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(e){return e.autodrain(),Promise.resolve()}addStyleModel(e,i){switch(i){case oj.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){let e={numFmtId:G2.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(e)}return this._dateStyleId}getStyleModel(){return{}}};Rw.Mock=Mee;S2e.exports=Rw});var T2e=z((fKi,E2e)=>{"use strict";var fDt=mt(),kee=class extends fDt{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this._format=e.format||function(i){try{return Number.isNaN(i.getTime())?"":i.toISOString()}catch{return""}},this._parse=e.parse||function(i){return new Date(i)}}render(e,i){i&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,this._format(i)):e.writeText(this._format(i)),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=this._parse(e.attributes[this.attr]):this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}};E2e.exports=kee});var Nee=z((pKi,R2e)=>{"use strict";var pDt=Ha(),mDt=mt(),Oee=T2e(),Ru=QV(),gDt=ZV(),vDt=(()=>{class t extends mDt{constructor(){super(),this.map={"dc:creator":new Ru({tag:"dc:creator"}),"dc:title":new Ru({tag:"dc:title"}),"dc:subject":new Ru({tag:"dc:subject"}),"dc:description":new Ru({tag:"dc:description"}),"dc:identifier":new Ru({tag:"dc:identifier"}),"dc:language":new Ru({tag:"dc:language"}),"cp:keywords":new Ru({tag:"cp:keywords"}),"cp:category":new Ru({tag:"cp:category"}),"cp:lastModifiedBy":new Ru({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new Oee({tag:"cp:lastPrinted",format:t.DateFormat}),"cp:revision":new gDt({tag:"cp:revision"}),"cp:version":new Ru({tag:"cp:version"}),"cp:contentStatus":new Ru({tag:"cp:contentStatus"}),"cp:contentType":new Ru({tag:"cp:contentType"}),"dcterms:created":new Oee({tag:"dcterms:created",attrs:t.DateAttrs,format:t.DateFormat}),"dcterms:modified":new Oee({tag:"dcterms:modified",attrs:t.DateAttrs,format:t.DateFormat})}}render(i,r){i.openXml(pDt.StdDocAttributes),i.openNode("cp:coreProperties",t.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(i,r.creator),this.map["dc:title"].render(i,r.title),this.map["dc:subject"].render(i,r.subject),this.map["dc:description"].render(i,r.description),this.map["dc:identifier"].render(i,r.identifier),this.map["dc:language"].render(i,r.language),this.map["cp:keywords"].render(i,r.keywords),this.map["cp:category"].render(i,r.category),this.map["cp:lastModifiedBy"].render(i,r.lastModifiedBy),this.map["cp:lastPrinted"].render(i,r.lastPrinted),this.map["cp:revision"].render(i,r.revision),this.map["cp:version"].render(i,r.version),this.map["cp:contentStatus"].render(i,r.contentStatus),this.map["cp:contentType"].render(i,r.contentType),this.map["dcterms:created"].render(i,r.created),this.map["dcterms:modified"].render(i,r.modified),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[i.name],this.parser)return this.parser.parseOpen(i),!0;throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(i)}`)}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error(`Unexpected xml node in parseClose: ${i}`)}}}return t.DateFormat=function(e){return e.toISOString().replace(/[.]\d{3}/,"")},t.DateAttrs={"xsi:type":"dcterms:W3CDTF"},t.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},t})();R2e.exports=vDt});var aj=z((mKi,A2e)=>{"use strict";var bDt=mt(),Pee=class extends bDt{get tag(){return"t"}render(e,i){e.openNode("t"),/^\s|\n|\s$/.test(i)&&e.addAttribute("xml:space","preserve"),e.writeText(i),e.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(e,i)=>String.fromCharCode(parseInt(i,16)))}parseOpen(e){switch(e.name){case"t":return this._text=[],!0;default:return!1}}parseText(e){this._text.push(e)}parseClose(){return!1}};A2e.exports=Pee});var X2=z((gKi,I2e)=>{"use strict";var _Dt=aj(),yDt=JV(),wDt=mt(),CDt=(()=>{class t extends wDt{constructor(i){super(),this.model=i}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new _Dt)}get fontXform(){return this._fontXform||(this._fontXform=new yDt(t.FONT_OPTIONS))}render(i,r){r=r||this.model,i.openNode("r"),r.font&&this.fontXform.render(i,r.font),this.textXform.render(i,r.text),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(i),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(i),!0;default:return!1}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){switch(i){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(i),!0}}}return t.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},t})();I2e.exports=CDt});var M2e=z((vKi,D2e)=>{"use strict";var xDt=aj(),SDt=X2(),EDt=mt(),Lee=class extends EDt{constructor(){super(),this.map={r:new SDt,t:new xDt}}get tag(){return"rPh"}render(e,i){if(e.openNode(this.tag,{sb:i.sb||0,eb:i.eb||0}),i&&i.hasOwnProperty("richText")&&i.richText){let{r}=this.map;i.richText.forEach(n=>{r.render(e,n)})}else i&&this.map.t.render(e,i.text);e.closeNode()}parseOpen(e){let{name:i}=e;return this.parser?(this.parser.parseOpen(e),!0):i===this.tag?(this.model={sb:parseInt(e.attributes.sb,10),eb:parseInt(e.attributes.eb,10)},!0):(this.parser=this.map[i],this.parser?(this.parser.parseOpen(e),!0):!1)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let i=this.model.richText;i||(i=this.model.richText=[]),i.push(this.parser.model);break}case"t":this.model.text=this.parser.model;break;default:break}this.parser=void 0}return!0}switch(e){case this.tag:return!1;default:return!0}}};D2e.exports=Lee});var O2e=z((bKi,k2e)=>{"use strict";var TDt=aj(),RDt=X2(),ADt=M2e(),IDt=mt(),Fee=class extends IDt{constructor(e){super(),this.model=e,this.map={r:new RDt,t:new TDt,rPh:new ADt}}get tag(){return"si"}render(e,i){e.openNode(this.tag),i&&i.hasOwnProperty("richText")&&i.richText?i.richText.length?i.richText.forEach(r=>{this.map.r.render(e,r)}):this.map.t.render(e,""):i!=null&&this.map.t.render(e,i),e.closeNode()}parseOpen(e){let{name:i}=e;return this.parser?(this.parser.parseOpen(e),!0):i===this.tag?(this.model={},!0):(this.parser=this.map[i],this.parser?(this.parser.parseOpen(e),!0):!1)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let i=this.model.richText;i||(i=this.model.richText=[]),i.push(this.parser.model);break}case"t":this.model=this.parser.model;break;default:break}this.parser=void 0}return!0}switch(e){case this.tag:return!1;default:return!0}}};k2e.exports=Fee});var Bee=z((_Ki,N2e)=>{"use strict";var DDt=Ha(),MDt=mt(),kDt=O2e(),Hee=class extends MDt{constructor(e){super(),this.model=e||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new kDt)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(e){return this.model.values[e]}add(e){return e.richText?this.addRichText(e):this.addText(e)}addText(e){let i=this.hash[e];return i===void 0&&(i=this.hash[e]=this.model.values.length,this.model.values.push(e)),this.model.count++,i}addRichText(e){let i=this.sharedStringXform.toXml(e),r=this.rich[i];return r===void 0&&(r=this.rich[i]=this.model.values.length,this.model.values.push(e)),this.model.count++,r}render(e,i){i=i||this._values,e.openXml(DDt.StdDocAttributes),e.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:i.count,uniqueCount:i.values.length});let r=this.sharedStringXform;i.values.forEach(n=>{r.render(e,n)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(e),!0;default:throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(e){case"sst":return!1;default:throw new Error(`Unexpected xml node in parseClose: ${e}`)}}};N2e.exports=Hee});var L2e=z((yKi,P2e)=>{"use strict";var ODt=mt(),Vee=class extends ODt{render(e,i){e.leafNode("Relationship",i)}parseOpen(e){switch(e.name){case"Relationship":return this.model=e.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}};P2e.exports=Vee});var lj=z((wKi,F2e)=>{"use strict";var NDt=Ha(),PDt=mt(),LDt=L2e(),FDt=(()=>{class t extends PDt{constructor(){super(),this.map={Relationship:new LDt}}render(i,r){r=r||this._values,i.openXml(NDt.StdDocAttributes),i.openNode("Relationships",t.RELATIONSHIPS_ATTRIBUTES),r.forEach(n=>{this.map.Relationship.render(i,n)}),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[i.name],this.parser)return this.parser.parseOpen(i),!0;throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(i)}`)}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(i){case"Relationships":return!1;default:throw new Error(`Unexpected xml node in parseClose: ${i}`)}}}return t.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},t})();F2e.exports=FDt});var jee=z((CKi,H2e)=>{"use strict";var HDt=Ha(),BDt=mt(),VDt=(()=>{class t extends BDt{render(i,r){i.openXml(HDt.StdDocAttributes),i.openNode("Types",t.PROPERTY_ATTRIBUTES);let n={};(r.media||[]).forEach(s=>{if(s.type==="image"){let a=s.extension;n[a]||(n[a]=!0,i.leafNode("Default",{Extension:a,ContentType:`image/${a}`}))}}),i.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),i.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),i.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),r.worksheets.forEach(s=>{let a=`/xl/worksheets/sheet${s.id}.xml`;i.leafNode("Override",{PartName:a,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),i.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),i.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),r.sharedStrings&&r.sharedStrings.count&&i.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),r.tables&&r.tables.forEach(s=>{i.leafNode("Override",{PartName:`/xl/tables/${s.target}`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),r.drawings&&r.drawings.forEach(s=>{i.leafNode("Override",{PartName:`/xl/drawings/${s.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),r.commentRefs&&(i.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),r.commentRefs.forEach(({commentName:s})=>{i.leafNode("Override",{PartName:`/xl/${s}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),i.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),i.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),i.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}return t.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},t})();H2e.exports=VDt});var V2e=z((xKi,B2e)=>{"use strict";var jDt=mt(),zee=class extends jDt{render(e,i){e.openNode("HeadingPairs"),e.openNode("vt:vector",{size:2,baseType:"variant"}),e.openNode("vt:variant"),e.leafNode("vt:lpstr",void 0,"Worksheets"),e.closeNode(),e.openNode("vt:variant"),e.leafNode("vt:i4",void 0,i.length),e.closeNode(),e.closeNode(),e.closeNode()}parseOpen(e){return e.name==="HeadingPairs"}parseText(){}parseClose(e){return e!=="HeadingPairs"}};B2e.exports=zee});var z2e=z((SKi,j2e)=>{"use strict";var zDt=mt(),Wee=class extends zDt{render(e,i){e.openNode("TitlesOfParts"),e.openNode("vt:vector",{size:i.length,baseType:"lpstr"}),i.forEach(r=>{e.leafNode("vt:lpstr",void 0,r.name)}),e.closeNode(),e.closeNode()}parseOpen(e){return e.name==="TitlesOfParts"}parseText(){}parseClose(e){return e!=="TitlesOfParts"}};j2e.exports=Wee});var Uee=z((EKi,U2e)=>{"use strict";var WDt=Ha(),UDt=mt(),W2e=QV(),qDt=V2e(),YDt=z2e(),$Dt=(()=>{class t extends UDt{constructor(){super(),this.map={Company:new W2e({tag:"Company"}),Manager:new W2e({tag:"Manager"}),HeadingPairs:new qDt,TitleOfParts:new YDt}}render(i,r){i.openXml(WDt.StdDocAttributes),i.openNode("Properties",t.PROPERTY_ATTRIBUTES),i.leafNode("Application",void 0,"Microsoft Excel"),i.leafNode("DocSecurity",void 0,"0"),i.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(i,r.worksheets),this.map.TitleOfParts.render(i,r.worksheets),this.map.Company.render(i,r.company||""),this.map.Manager.render(i,r.manager),i.leafNode("LinksUpToDate",void 0,"false"),i.leafNode("SharedDoc",void 0,"false"),i.leafNode("HyperlinksChanged",void 0,"false"),i.leafNode("AppVersion",void 0,"16.0300"),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"Properties":return!0;default:return this.parser=this.map[i.name],this.parser?(this.parser.parseOpen(i),!0):!1}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}return t.DateFormat=function(e){return e.toISOString().replace(/[.]\d{3,6}/,"")},t.DateAttrs={"xsi:type":"dcterms:W3CDTF"},t.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},t})();U2e.exports=$Dt});var Y2e=z((TKi,q2e)=>{"use strict";var GDt=mt(),XDt=Oo(),Yee=class extends GDt{render(e,i){e.openNode("definedName",{name:i.name,localSheetId:i.localSheetId}),e.writeText(i.ranges.join(",")),e.closeNode()}parseOpen(e){switch(e.name){case"definedName":return this._parsedName=e.attributes.name,this._parsedLocalSheetId=e.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(e){this._parsedText.push(e)}parseClose(){return this.model={name:this._parsedName,ranges:KDt(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}};function qee(t){try{return XDt.decodeEx(t),!0}catch{return!1}}function KDt(t){let e=[],i=!1,r="";return t.split(",").forEach(n=>{if(!n)return;let o=(n.match(/'/g)||[]).length;if(!o){i?r+=`${n},`:qee(n)&&e.push(n);return}let s=o%2===0;!i&&s&&qee(n)?e.push(n):i&&!s?(i=!1,qee(r+n)&&e.push(r+n),r=""):(i=!0,r+=`${n},`)}),e}q2e.exports=Yee});var G2e=z((RKi,$2e)=>{"use strict";var ZDt=yl(),QDt=mt(),$ee=class extends QDt{render(e,i){e.leafNode("sheet",{sheetId:i.id,name:i.name,state:i.state,"r:id":i.rId})}parseOpen(e){return e.name==="sheet"?(this.model={name:ZDt.xmlDecode(e.attributes.name),id:parseInt(e.attributes.sheetId,10),state:e.attributes.state,rId:e.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}};$2e.exports=$ee});var K2e=z((AKi,X2e)=>{"use strict";var JDt=mt(),Gee=class extends JDt{render(e,i){let r={xWindow:i.x||0,yWindow:i.y||0,windowWidth:i.width||12e3,windowHeight:i.height||24e3,firstSheet:i.firstSheet,activeTab:i.activeTab};i.visibility&&i.visibility!=="visible"&&(r.visibility=i.visibility),e.leafNode("workbookView",r)}parseOpen(e){if(e.name==="workbookView"){let i=this.model={},r=function(o,s,a){let c=s!==void 0?i[o]=s:a;c!==void 0&&(i[o]=c)},n=function(o,s,a){let c=s!==void 0?i[o]=parseInt(s,10):a;c!==void 0&&(i[o]=c)};return n("x",e.attributes.xWindow,0),n("y",e.attributes.yWindow,0),n("width",e.attributes.windowWidth,25e3),n("height",e.attributes.windowHeight,1e4),r("visibility",e.attributes.visibility,"visible"),n("activeTab",e.attributes.activeTab,void 0),n("firstSheet",e.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}};X2e.exports=Gee});var Q2e=z((IKi,Z2e)=>{"use strict";var eMt=mt(),Xee=class extends eMt{render(e,i){e.leafNode("workbookPr",{date1904:i.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(e){return e.name==="workbookPr"?(this.model={date1904:e.attributes.date1904==="1"},!0):!1}parseText(){}parseClose(){return!1}};Z2e.exports=Xee});var eNe=z((DKi,J2e)=>{"use strict";var tMt=mt(),Kee=class extends tMt{render(e,i){e.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:i.fullCalcOnLoad?1:void 0})}parseOpen(e){return e.name==="calcPr"?(this.model={},!0):!1}parseText(){}parseClose(){return!1}};J2e.exports=Kee});var cj=z((MKi,tNe)=>{"use strict";var iMt=Go(),rMt=Oo(),nMt=Ha(),oMt=mt(),sMt=WE(),Zee=r0(),aMt=Y2e(),lMt=G2e(),cMt=K2e(),dMt=Q2e(),uMt=eNe(),K2=class t extends oMt{constructor(){super(),this.map={fileVersion:t.STATIC_XFORMS.fileVersion,workbookPr:new dMt,bookViews:new Zee({tag:"bookViews",count:!1,childXform:new cMt}),sheets:new Zee({tag:"sheets",count:!1,childXform:new lMt}),definedNames:new Zee({tag:"definedNames",count:!1,childXform:new aMt}),calcPr:new uMt}}prepare(e){e.sheets=e.worksheets;let i=[],r=0;e.sheets.forEach(n=>{if(n.pageSetup&&n.pageSetup.printArea&&n.pageSetup.printArea.split("&&").forEach(o=>{let s=o.split(":"),a={name:"_xlnm.Print_Area",ranges:[`'${n.name}'!$${s[0]}:$${s[1]}`],localSheetId:r};i.push(a)}),n.pageSetup&&(n.pageSetup.printTitlesRow||n.pageSetup.printTitlesColumn)){let o=[];if(n.pageSetup.printTitlesColumn){let a=n.pageSetup.printTitlesColumn.split(":");o.push(`'${n.name}'!$${a[0]}:$${a[1]}`)}if(n.pageSetup.printTitlesRow){let a=n.pageSetup.printTitlesRow.split(":");o.push(`'${n.name}'!$${a[0]}:$${a[1]}`)}let s={name:"_xlnm.Print_Titles",ranges:o,localSheetId:r};i.push(s)}r++}),i.length&&(e.definedNames=e.definedNames.concat(i)),(e.media||[]).forEach((n,o)=>{n.name=n.type+(o+1)})}render(e,i){e.openXml(nMt.StdDocAttributes),e.openNode("workbook",t.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(e),this.map.workbookPr.render(e,i.properties),this.map.bookViews.render(e,i.views),this.map.sheets.render(e,i.sheets),this.map.definedNames.render(e,i.definedNames),this.map.calcPr.render(e,i.calcProperties),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"workbook":return!0;default:return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(e){let i=(e.workbookRels||[]).reduce((a,c)=>(a[c.Id]=c,a),{}),r=[],n,o=0;(e.sheets||[]).forEach(a=>{let c=i[a.rId];c&&(n=e.worksheetHash[`xl/${c.Target.replace(/^(\s|\/xl\/)+/,"")}`],n&&(n.name=a.name,n.id=a.id,n.state=a.state,r[o++]=n))});let s=[];iMt.each(e.definedNames,a=>{if(a.name==="_xlnm.Print_Area"){if(n=r[a.localSheetId],n){n.pageSetup||(n.pageSetup={});let c=rMt.decodeEx(a.ranges[0]);n.pageSetup.printArea=n.pageSetup.printArea?`${n.pageSetup.printArea}&&${c.dimensions}`:c.dimensions}}else if(a.name==="_xlnm.Print_Titles"){if(n=r[a.localSheetId],n){n.pageSetup||(n.pageSetup={});let c=a.ranges.join(","),d=/\$/g,u=/\$\d+:\$\d+/,h=c.match(u);if(h&&h.length){let m=h[0];n.pageSetup.printTitlesRow=m.replace(d,"")}let p=/\$[A-Z]+:\$[A-Z]+/,f=c.match(p);if(f&&f.length){let m=f[0];n.pageSetup.printTitlesColumn=m.replace(d,"")}}}else s.push(a)}),e.definedNames=s,e.media.forEach((a,c)=>{a.index=c})}};K2.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"};K2.STATIC_XFORMS={fileVersion:new sMt({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})};tNe.exports=K2});var s0=z((kKi,iNe)=>{"use strict";iNe.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}});var aNe=z((OKi,sNe)=>{"use strict";var rNe=Go(),hMt=Wm(),nNe=Oo(),oNe=wh(),Qee=class{constructor(){this.merges={}}add(e){if(this.merges[e.master])this.merges[e.master].expandToAddress(e.address);else{let i=`${e.master}:${e.address}`;this.merges[e.master]=new hMt(i)}}get mergeCells(){return rNe.map(this.merges,e=>e.range)}reconcile(e,i){rNe.each(e,r=>{let n=nNe.decode(r);for(let o=n.top;o<=n.bottom;o++){let s=i[o-1];for(let a=n.left;a<=n.right;a++){let c=s.cells[a-1];c?c.type===oNe.ValueType.Merge&&(c.master=n.tl):s.cells[a]={type:oNe.ValueType.Null,address:nNe.encodeAddress(o,a)}}}})}getMasterAddress(e){let i=this.hash[e];return i&&i.tl}};sNe.exports=Qee});var dNe=z((NKi,cNe)=>{"use strict";var a0=yl(),fMt=mt(),pMt=Wm(),ki=wh(),mMt=X2();function lNe(t){if(t==null)return ki.ValueType.Null;if(t instanceof String||typeof t=="string")return ki.ValueType.String;if(typeof t=="number")return ki.ValueType.Number;if(typeof t=="boolean")return ki.ValueType.Boolean;if(t instanceof Date)return ki.ValueType.Date;if(t.text&&t.hyperlink)return ki.ValueType.Hyperlink;if(t.formula)return ki.ValueType.Formula;if(t.error)return ki.ValueType.Error;throw new Error("I could not understand type of value")}function gMt(t){switch(t.type){case ki.ValueType.Formula:return lNe(t.result);default:return t.type}}var Jee=class extends fMt{constructor(){super(),this.richTextXForm=new mMt}get tag(){return"c"}prepare(e,i){let r=i.styles.addStyleModel(e.style||{},gMt(e));switch(r&&(e.styleId=r),e.comment&&i.comments.push(Lt(Ke({},e.comment),{ref:e.address})),e.type){case ki.ValueType.String:case ki.ValueType.RichText:i.sharedStrings&&(e.ssId=i.sharedStrings.add(e.value));break;case ki.ValueType.Date:i.date1904&&(e.date1904=!0);break;case ki.ValueType.Hyperlink:i.sharedStrings&&e.text!==void 0&&e.text!==null&&(e.ssId=i.sharedStrings.add(e.text)),i.hyperlinks.push({address:e.address,target:e.hyperlink,tooltip:e.tooltip});break;case ki.ValueType.Merge:i.merges.add(e);break;case ki.ValueType.Formula:if(i.date1904&&(e.date1904=!0),e.shareType==="shared"&&(e.si=i.siFormulae++),e.formula)i.formulae[e.address]=e;else if(e.sharedFormula){let n=i.formulae[e.sharedFormula];if(!n)throw new Error(`Shared Formula master must exist above and or left of clone for cell ${e.address}`);n.si===void 0?(n.shareType="shared",n.si=i.siFormulae++,n.range=new pMt(n.address,e.address)):n.range&&n.range.expandToAddress(e.address),e.si=n.si}break;default:break}}renderFormula(e,i){let r=null;switch(i.shareType){case"shared":r={t:"shared",ref:i.ref||i.range.range,si:i.si};break;case"array":r={t:"array",ref:i.ref};break;default:i.si!==void 0&&(r={t:"shared",si:i.si});break}switch(lNe(i.result)){case ki.ValueType.Null:e.leafNode("f",r,i.formula);break;case ki.ValueType.String:e.addAttribute("t","str"),e.leafNode("f",r,i.formula),e.leafNode("v",null,i.result);break;case ki.ValueType.Number:e.leafNode("f",r,i.formula),e.leafNode("v",null,i.result);break;case ki.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("f",r,i.formula),e.leafNode("v",null,i.result?1:0);break;case ki.ValueType.Error:e.addAttribute("t","e"),e.leafNode("f",r,i.formula),e.leafNode("v",null,i.result.error);break;case ki.ValueType.Date:e.leafNode("f",r,i.formula),e.leafNode("v",null,a0.dateToExcel(i.result,i.date1904));break;default:throw new Error("I could not understand type of value")}}render(e,i){if(!(i.type===ki.ValueType.Null&&!i.styleId)){switch(e.openNode("c"),e.addAttribute("r",i.address),i.styleId&&e.addAttribute("s",i.styleId),i.type){case ki.ValueType.Null:break;case ki.ValueType.Number:e.leafNode("v",null,i.value);break;case ki.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("v",null,i.value?"1":"0");break;case ki.ValueType.Error:e.addAttribute("t","e"),e.leafNode("v",null,i.value.error);break;case ki.ValueType.String:case ki.ValueType.RichText:i.ssId!==void 0?(e.addAttribute("t","s"),e.leafNode("v",null,i.ssId)):i.value&&i.value.richText?(e.addAttribute("t","inlineStr"),e.openNode("is"),i.value.richText.forEach(r=>{this.richTextXForm.render(e,r)}),e.closeNode("is")):(e.addAttribute("t","str"),e.leafNode("v",null,i.value));break;case ki.ValueType.Date:e.leafNode("v",null,a0.dateToExcel(i.value,i.date1904));break;case ki.ValueType.Hyperlink:i.ssId!==void 0?(e.addAttribute("t","s"),e.leafNode("v",null,i.ssId)):(e.addAttribute("t","str"),e.leafNode("v",null,i.text));break;case ki.ValueType.Formula:this.renderFormula(e,i);break;case ki.ValueType.Merge:break;default:break}e.closeNode()}}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"c":return this.model={address:e.attributes.r},this.t=e.attributes.t,e.attributes.s&&(this.model.styleId=parseInt(e.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=e.attributes.si,this.model.shareType=e.attributes.t,this.model.ref=e.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){if(this.parser){this.parser.parseText(e);return}switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+e:e;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+e:e:this.model.value=this.model.value?this.model.value+e:e;break;default:break}}parseClose(e){switch(e){case"c":{let{model:i}=this;if(i.formula||i.shareType)i.type=ki.ValueType.Formula,i.value&&(this.t==="str"?i.result=a0.xmlDecode(i.value):this.t==="b"?i.result=parseInt(i.value,10)!==0:this.t==="e"?i.result={error:i.value}:i.result=parseFloat(i.value),i.value=void 0);else if(i.value!==void 0)switch(this.t){case"s":i.type=ki.ValueType.String,i.value=parseInt(i.value,10);break;case"str":i.type=ki.ValueType.String,i.value=a0.xmlDecode(i.value);break;case"inlineStr":i.type=ki.ValueType.String;break;case"b":i.type=ki.ValueType.Boolean,i.value=parseInt(i.value,10)!==0;break;case"e":i.type=ki.ValueType.Error,i.value={error:i.value};break;default:i.type=ki.ValueType.Number,i.value=parseFloat(i.value);break}else i.styleId?i.type=ki.ValueType.Null:i.type=ki.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(e),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return this.parser?(this.parser.parseClose(e),!0):!1}}reconcile(e,i){let r=e.styleId&&i.styles&&i.styles.getStyleModel(e.styleId);switch(r&&(e.style=r),e.styleId!==void 0&&(e.styleId=void 0),e.type){case ki.ValueType.String:typeof e.value=="number"&&i.sharedStrings&&(e.value=i.sharedStrings.getString(e.value)),e.value.richText&&(e.type=ki.ValueType.RichText);break;case ki.ValueType.Number:r&&a0.isDateFmt(r.numFmt)&&(e.type=ki.ValueType.Date,e.value=a0.excelToDate(e.value,i.date1904));break;case ki.ValueType.Formula:e.result!==void 0&&r&&a0.isDateFmt(r.numFmt)&&(e.result=a0.excelToDate(e.result,i.date1904)),e.shareType==="shared"&&(e.ref?i.formulae[e.si]=e.address:(e.sharedFormula=i.formulae[e.si],delete e.shareType),delete e.si);break;default:break}let n=i.hyperlinkMap[e.address];n&&(e.type===ki.ValueType.Formula?(e.text=e.result,e.result=void 0):(e.text=e.value,e.value=void 0),e.type=ki.ValueType.Hyperlink,e.hyperlink=n);let o=i.commentsMap&&i.commentsMap[e.address];o&&(e.comment=o)}};cNe.exports=Jee});var ite=z((LKi,uNe)=>{"use strict";var vMt=mt(),ete=yl(),bMt=dNe(),tte=class extends vMt{constructor(e){super(),this.maxItems=e&&e.maxItems,this.map={c:new bMt}}get tag(){return"row"}prepare(e,i){let r=i.styles.addStyleModel(e.style);r&&(e.styleId=r);let n=this.map.c;e.cells.forEach(o=>{n.prepare(o,i)})}render(e,i,r){e.openNode("row"),e.addAttribute("r",i.number),i.height&&(e.addAttribute("ht",i.height),e.addAttribute("customHeight","1")),i.hidden&&e.addAttribute("hidden","1"),i.min>0&&i.max>0&&i.min<=i.max&&e.addAttribute("spans",`${i.min}:${i.max}`),i.styleId&&(e.addAttribute("s",i.styleId),e.addAttribute("customFormat","1")),e.addAttribute("x14ac:dyDescent","0.25"),i.outlineLevel&&e.addAttribute("outlineLevel",i.outlineLevel),i.collapsed&&e.addAttribute("collapsed","1");let n=this.map.c;i.cells.forEach(o=>{n.render(e,o,r)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name==="row"){this.numRowsSeen+=1;let i=e.attributes.spans?e.attributes.spans.split(":").map(n=>parseInt(n,10)):[void 0,void 0],r=this.model={number:parseInt(e.attributes.r,10),min:i[0],max:i[1],cells:[]};return e.attributes.s&&(r.styleId=parseInt(e.attributes.s,10)),ete.parseBoolean(e.attributes.hidden)&&(r.hidden=!0),ete.parseBoolean(e.attributes.bestFit)&&(r.bestFit=!0),e.attributes.ht&&(r.height=parseFloat(e.attributes.ht)),e.attributes.outlineLevel&&(r.outlineLevel=parseInt(e.attributes.outlineLevel,10)),ete.parseBoolean(e.attributes.collapsed)&&(r.collapsed=!0),!0}return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(e,i){e.style=e.styleId?i.styles.getStyleModel(e.styleId):{},e.styleId!==void 0&&(e.styleId=void 0);let r=this.map.c;e.cells.forEach(n=>{r.reconcile(n,i)})}};uNe.exports=tte});var ote=z((FKi,hNe)=>{"use strict";var rte=yl(),_Mt=mt(),nte=class extends _Mt{get tag(){return"col"}prepare(e,i){let r=i.styles.addStyleModel(e.style||{});r&&(e.styleId=r)}render(e,i){e.openNode("col"),e.addAttribute("min",i.min),e.addAttribute("max",i.max),i.width&&e.addAttribute("width",i.width),i.styleId&&e.addAttribute("style",i.styleId),i.hidden&&e.addAttribute("hidden","1"),i.bestFit&&e.addAttribute("bestFit","1"),i.outlineLevel&&e.addAttribute("outlineLevel",i.outlineLevel),i.collapsed&&e.addAttribute("collapsed","1"),e.addAttribute("customWidth","1"),e.closeNode()}parseOpen(e){if(e.name==="col"){let i=this.model={min:parseInt(e.attributes.min||"0",10),max:parseInt(e.attributes.max||"0",10),width:e.attributes.width===void 0?void 0:parseFloat(e.attributes.width||"0")};return e.attributes.style&&(i.styleId=parseInt(e.attributes.style,10)),rte.parseBoolean(e.attributes.hidden)&&(i.hidden=!0),rte.parseBoolean(e.attributes.bestFit)&&(i.bestFit=!0),e.attributes.outlineLevel&&(i.outlineLevel=parseInt(e.attributes.outlineLevel,10)),rte.parseBoolean(e.attributes.collapsed)&&(i.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(e,i){e.styleId&&(e.style=i.styles.getStyleModel(e.styleId))}};hNe.exports=nte});var pNe=z((HKi,fNe)=>{"use strict";var yMt=mt(),ste=class extends yMt{get tag(){return"dimension"}render(e,i){i&&e.leafNode("dimension",{ref:i})}parseOpen(e){return e.name==="dimension"?(this.model=e.attributes.ref,!0):!1}parseText(){}parseClose(){return!1}};fNe.exports=ste});var lte=z((BKi,mNe)=>{"use strict";var wMt=mt(),ate=class extends wMt{get tag(){return"hyperlink"}render(e,i){this.isInternalLink(i)?e.leafNode("hyperlink",{ref:i.address,"r:id":i.rId,tooltip:i.tooltip,location:i.target}):e.leafNode("hyperlink",{ref:i.address,"r:id":i.rId,tooltip:i.tooltip})}parseOpen(e){return e.name==="hyperlink"?(this.model={address:e.attributes.ref,rId:e.attributes["r:id"],tooltip:e.attributes.tooltip},e.attributes.location&&(this.model.target=e.attributes.location),!0):!1}parseText(){}parseClose(){return!1}isInternalLink(e){return e.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(e.target)}};mNe.exports=ate});var vNe=z((VKi,gNe)=>{"use strict";var CMt=mt(),cte=class extends CMt{get tag(){return"mergeCell"}render(e,i){e.leafNode("mergeCell",{ref:i})}parseOpen(e){return e.name==="mergeCell"?(this.model=e.attributes.ref,!0):!1}parseText(){}parseClose(){return!1}};gNe.exports=cte});var fte=z((jKi,bNe)=>{"use strict";var Z2=Go(),ute=yl(),UE=Oo(),xMt=mt(),SMt=Wm();function qE(t,e,i,r){let n=e[i];n!==void 0?t[i]=n:r!==void 0&&(t[i]=r)}function dte(t,e,i,r){let n=e[i];n!==void 0?t[i]=ute.parseBoolean(n):r!==void 0&&(t[i]=r)}function EMt(t){let e=Z2.map(t,(n,o)=>({address:o,dataValidation:n,marked:!1})).sort((n,o)=>Z2.strcmp(n.address,o.address)),i=Z2.keyBy(e,"address"),r=(n,o,s)=>{for(let a=0;a<o;a++){let c=UE.encodeAddress(n.row+a,s);if(!t[c]||!Z2.isEqual(t[n.address],t[c]))return!1}return!0};return e.map(n=>{if(!n.marked){let o=UE.decodeEx(n.address);if(o.dimensions)return i[o.dimensions].marked=!0,Lt(Ke({},n.dataValidation),{sqref:n.address});let s=1,a=UE.encodeAddress(o.row+s,o.col);for(;t[a]&&Z2.isEqual(n.dataValidation,t[a]);)s++,a=UE.encodeAddress(o.row+s,o.col);let c=1;for(;r(o,s,o.col+c);)c++;for(let d=0;d<s;d++)for(let u=0;u<c;u++)a=UE.encodeAddress(o.row+d,o.col+u),i[a].marked=!0;if(s>1||c>1){let d=o.row+(s-1),u=o.col+(c-1);return Lt(Ke({},n.dataValidation),{sqref:`${n.address}:${UE.encodeAddress(d,u)}`})}return Lt(Ke({},n.dataValidation),{sqref:n.address})}return null}).filter(Boolean)}var hte=class extends xMt{get tag(){return"dataValidations"}render(e,i){let r=EMt(i);r.length&&(e.openNode("dataValidations",{count:r.length}),r.forEach(n=>{e.openNode("dataValidation"),n.type!=="any"&&(e.addAttribute("type",n.type),n.operator&&n.type!=="list"&&n.operator!=="between"&&e.addAttribute("operator",n.operator),n.allowBlank&&e.addAttribute("allowBlank","1")),n.showInputMessage&&e.addAttribute("showInputMessage","1"),n.promptTitle&&e.addAttribute("promptTitle",n.promptTitle),n.prompt&&e.addAttribute("prompt",n.prompt),n.showErrorMessage&&e.addAttribute("showErrorMessage","1"),n.errorStyle&&e.addAttribute("errorStyle",n.errorStyle),n.errorTitle&&e.addAttribute("errorTitle",n.errorTitle),n.error&&e.addAttribute("error",n.error),e.addAttribute("sqref",n.sqref),(n.formulae||[]).forEach((o,s)=>{e.openNode(`formula${s+1}`),n.type==="date"?e.writeText(ute.dateToExcel(new Date(o))):e.writeText(o),e.closeNode()}),e.closeNode()}),e.closeNode())}parseOpen(e){switch(e.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=e.attributes.sqref;let i={type:e.attributes.type||"any",formulae:[]};switch(e.attributes.type&&dte(i,e.attributes,"allowBlank"),dte(i,e.attributes,"showInputMessage"),dte(i,e.attributes,"showErrorMessage"),i.type){case"any":case"list":case"custom":break;default:qE(i,e.attributes,"operator","between");break}return qE(i,e.attributes,"promptTitle"),qE(i,e.attributes,"prompt"),qE(i,e.attributes,"errorStyle"),qE(i,e.attributes,"errorTitle"),qE(i,e.attributes,"error"),this._dataValidation=i,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(e){this._formula&&this._formula.push(e)}parseClose(e){switch(e){case"dataValidations":return!1;case"dataValidation":return(!this._dataValidation.formulae||!this._dataValidation.formulae.length)&&(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(r=>{r.includes(":")?new SMt(r).forEachAddress(o=>{this.model[o]=this._dataValidation}):this.model[r]=this._dataValidation}),!0;case"formula1":case"formula2":{let i=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":i=parseInt(i,10);break;case"decimal":i=parseFloat(i);break;case"date":i=ute.excelToDate(parseFloat(i));break;default:break}return this._dataValidation.formulae.push(i),this._formula=void 0,!0}default:return!0}}};bNe.exports=hte});var yNe=z((WKi,_Ne)=>{"use strict";var TMt=mt(),pte=class extends TMt{get tag(){return"pageSetUpPr"}render(e,i){return i&&i.fitToPage?(e.leafNode(this.tag,{fitToPage:i.fitToPage?"1":void 0}),!0):!1}parseOpen(e){return e.name===this.tag?(this.model={fitToPage:e.attributes.fitToPage==="1"},!0):!1}parseText(){}parseClose(){return!1}};_Ne.exports=pte});var CNe=z((UKi,wNe)=>{"use strict";var RMt=mt(),YE=t=>typeof t<"u",mte=class extends RMt{get tag(){return"outlinePr"}render(e,i){return i&&(YE(i.summaryBelow)||YE(i.summaryRight))?(e.leafNode(this.tag,{summaryBelow:YE(i.summaryBelow)?Number(i.summaryBelow):void 0,summaryRight:YE(i.summaryRight)?Number(i.summaryRight):void 0}),!0):!1}parseOpen(e){return e.name===this.tag?(this.model={summaryBelow:YE(e.attributes.summaryBelow)?!!Number(e.attributes.summaryBelow):void 0,summaryRight:YE(e.attributes.summaryRight)?!!Number(e.attributes.summaryRight):void 0},!0):!1}parseText(){}parseClose(){return!1}};wNe.exports=mte});var vte=z((qKi,xNe)=>{"use strict";var AMt=mt(),IMt=n0(),DMt=yNe(),MMt=CNe(),gte=class extends AMt{constructor(){super(),this.map={tabColor:new IMt("tabColor"),pageSetUpPr:new DMt,outlinePr:new MMt}}get tag(){return"sheetPr"}render(e,i){if(i){e.addRollback(),e.openNode("sheetPr");let r=!1;r=this.map.tabColor.render(e,i.tabColor)||r,r=this.map.pageSetUpPr.render(e,i.pageSetup)||r,r=this.map.outlinePr.render(e,i.outlineProperties)||r,r?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.reset(),!0):this.map[e.name]?(this.parser=this.map[e.name],this.parser.parseOpen(e),!0):!1}parseText(e){return this.parser?(this.parser.parseText(e),!0):!1}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}};xNe.exports=gte});var _te=z((YKi,SNe)=>{"use strict";var kMt=Go(),OMt=mt(),bte=class extends OMt{get tag(){return"sheetFormatPr"}render(e,i){if(i){let r={defaultRowHeight:i.defaultRowHeight,outlineLevelRow:i.outlineLevelRow,outlineLevelCol:i.outlineLevelCol,"x14ac:dyDescent":i.dyDescent};i.defaultColWidth&&(r.defaultColWidth=i.defaultColWidth),(!i.defaultRowHeight||i.defaultRowHeight!==15)&&(r.customHeight="1"),kMt.some(r,n=>n!==void 0)&&e.leafNode("sheetFormatPr",r)}}parseOpen(e){return e.name==="sheetFormatPr"?(this.model={defaultRowHeight:parseFloat(e.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(e.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(e.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(e.attributes.outlineLevelCol||"0",10)},e.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(e.attributes.defaultColWidth)),!0):!1}parseText(){}parseClose(){return!1}};SNe.exports=bte});var wte=z(($Ki,ENe)=>{"use strict";var NMt=Oo(),PMt=mt(),LMt={frozen:"frozen",frozenSplit:"frozen",split:"split"},yte=class extends PMt{get tag(){return"sheetView"}prepare(e){switch(e.state){case"frozen":case"split":break;default:e.state="normal";break}}render(e,i){e.openNode("sheetView",{workbookViewId:i.workbookViewId||0});let r=function(c,d,u){u&&e.addAttribute(c,d)};r("rightToLeft","1",i.rightToLeft===!0),r("tabSelected","1",i.tabSelected),r("showRuler","0",i.showRuler===!1),r("showRowColHeaders","0",i.showRowColHeaders===!1),r("showGridLines","0",i.showGridLines===!1),r("zoomScale",i.zoomScale,i.zoomScale),r("zoomScaleNormal",i.zoomScaleNormal,i.zoomScaleNormal),r("view",i.style,i.style);let n,o,s,a;switch(i.state){case"frozen":o=i.xSplit||0,s=i.ySplit||0,n=i.topLeftCell||NMt.getAddress(s+1,o+1).address,a=i.xSplit&&i.ySplit&&"bottomRight"||i.xSplit&&"topRight"||"bottomLeft",e.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:n,activePane:a,state:"frozen"}),e.leafNode("selection",{pane:a,activeCell:i.activeCell,sqref:i.activeCell});break;case"split":i.activePane==="topLeft"&&(i.activePane=void 0),e.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:i.topLeftCell,activePane:i.activePane}),e.leafNode("selection",{pane:i.activePane,activeCell:i.activeCell,sqref:i.activeCell});break;case"normal":i.activeCell&&e.leafNode("selection",{activeCell:i.activeCell,sqref:i.activeCell});break;default:break}e.closeNode()}parseOpen(e){switch(e.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(e.attributes.workbookViewId,10),rightToLeft:e.attributes.rightToLeft==="1",tabSelected:e.attributes.tabSelected==="1",showRuler:e.attributes.showRuler!=="0",showRowColHeaders:e.attributes.showRowColHeaders!=="0",showGridLines:e.attributes.showGridLines!=="0",zoomScale:parseInt(e.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(e.attributes.zoomScaleNormal||"100",10),style:e.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(e.attributes.xSplit||"0",10),ySplit:parseInt(e.attributes.ySplit||"0",10),topLeftCell:e.attributes.topLeftCell,activePane:e.attributes.activePane||"topLeft",state:e.attributes.state},!0;case"selection":{let i=e.attributes.pane||"topLeft";return this.selections[i]={pane:i,activeCell:e.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(e){let i,r;switch(e){case"sheetView":return this.sheetView&&this.pane?(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:LMt[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(i.activePane=this.pane.activePane),r=this.selections[this.pane.activePane],r&&r.activeCell&&(i.activeCell=r.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)):(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},r=this.selections.topLeft,r&&r.activeCell&&(i.activeCell=r.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}};ENe.exports=yte});var xte=z((GKi,TNe)=>{"use strict";var FMt=Go(),HMt=mt();function Bc(t,e){return t?e:void 0}function Au(t,e){return t===e?!0:void 0}var Cte=class extends HMt{get tag(){return"sheetProtection"}render(e,i){if(i){let r={sheet:Bc(i.sheet,"1"),selectLockedCells:i.selectLockedCells===!1?"1":void 0,selectUnlockedCells:i.selectUnlockedCells===!1?"1":void 0,formatCells:Bc(i.formatCells,"0"),formatColumns:Bc(i.formatColumns,"0"),formatRows:Bc(i.formatRows,"0"),insertColumns:Bc(i.insertColumns,"0"),insertRows:Bc(i.insertRows,"0"),insertHyperlinks:Bc(i.insertHyperlinks,"0"),deleteColumns:Bc(i.deleteColumns,"0"),deleteRows:Bc(i.deleteRows,"0"),sort:Bc(i.sort,"0"),autoFilter:Bc(i.autoFilter,"0"),pivotTables:Bc(i.pivotTables,"0")};i.sheet&&(r.algorithmName=i.algorithmName,r.hashValue=i.hashValue,r.saltValue=i.saltValue,r.spinCount=i.spinCount,r.objects=Bc(i.objects===!1,"1"),r.scenarios=Bc(i.scenarios===!1,"1")),FMt.some(r,n=>n!==void 0)&&e.leafNode(this.tag,r)}}parseOpen(e){switch(e.name){case this.tag:return this.model={sheet:Au(e.attributes.sheet,"1"),objects:e.attributes.objects==="1"?!1:void 0,scenarios:e.attributes.scenarios==="1"?!1:void 0,selectLockedCells:e.attributes.selectLockedCells==="1"?!1:void 0,selectUnlockedCells:e.attributes.selectUnlockedCells==="1"?!1:void 0,formatCells:Au(e.attributes.formatCells,"0"),formatColumns:Au(e.attributes.formatColumns,"0"),formatRows:Au(e.attributes.formatRows,"0"),insertColumns:Au(e.attributes.insertColumns,"0"),insertRows:Au(e.attributes.insertRows,"0"),insertHyperlinks:Au(e.attributes.insertHyperlinks,"0"),deleteColumns:Au(e.attributes.deleteColumns,"0"),deleteRows:Au(e.attributes.deleteRows,"0"),sort:Au(e.attributes.sort,"0"),autoFilter:Au(e.attributes.autoFilter,"0"),pivotTables:Au(e.attributes.pivotTables,"0")},e.attributes.algorithmName&&(this.model.algorithmName=e.attributes.algorithmName,this.model.hashValue=e.attributes.hashValue,this.model.saltValue=e.attributes.saltValue,this.model.spinCount=parseInt(e.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}};TNe.exports=Cte});var Ete=z((XKi,RNe)=>{"use strict";var BMt=Go(),VMt=mt(),Ste=class extends VMt{get tag(){return"pageMargins"}render(e,i){if(i){let r={left:i.left,right:i.right,top:i.top,bottom:i.bottom,header:i.header,footer:i.footer};BMt.some(r,n=>n!==void 0)&&e.leafNode(this.tag,r)}}parseOpen(e){switch(e.name){case this.tag:return this.model={left:parseFloat(e.attributes.left||.7),right:parseFloat(e.attributes.right||.7),top:parseFloat(e.attributes.top||.75),bottom:parseFloat(e.attributes.bottom||.75),header:parseFloat(e.attributes.header||.3),footer:parseFloat(e.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}};RNe.exports=Ste});var Rte=z((KKi,ANe)=>{"use strict";var jMt=Go(),zMt=mt();function dj(t){return t?"1":void 0}function WMt(t){switch(t){case"overThenDown":return t;default:return}}function UMt(t){switch(t){case"atEnd":case"asDisplyed":return t;default:return}}function qMt(t){switch(t){case"dash":case"blank":case"NA":return t;default:return}}function YMt(t){return t!==void 0?parseInt(t,10):void 0}var Tte=class extends zMt{get tag(){return"pageSetup"}render(e,i){if(i){let r={paperSize:i.paperSize,orientation:i.orientation,horizontalDpi:i.horizontalDpi,verticalDpi:i.verticalDpi,pageOrder:WMt(i.pageOrder),blackAndWhite:dj(i.blackAndWhite),draft:dj(i.draft),cellComments:UMt(i.cellComments),errors:qMt(i.errors),scale:i.scale,fitToWidth:i.fitToWidth,fitToHeight:i.fitToHeight,firstPageNumber:i.firstPageNumber,useFirstPageNumber:dj(i.firstPageNumber),usePrinterDefaults:dj(i.usePrinterDefaults),copies:i.copies};jMt.some(r,n=>n!==void 0)&&e.leafNode(this.tag,r)}}parseOpen(e){switch(e.name){case this.tag:return this.model={paperSize:YMt(e.attributes.paperSize),orientation:e.attributes.orientation||"portrait",horizontalDpi:parseInt(e.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(e.attributes.verticalDpi||"4294967295",10),pageOrder:e.attributes.pageOrder||"downThenOver",blackAndWhite:e.attributes.blackAndWhite==="1",draft:e.attributes.draft==="1",cellComments:e.attributes.cellComments||"None",errors:e.attributes.errors||"displayed",scale:parseInt(e.attributes.scale||"100",10),fitToWidth:parseInt(e.attributes.fitToWidth||"1",10),fitToHeight:parseInt(e.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(e.attributes.firstPageNumber||"1",10),useFirstPageNumber:e.attributes.useFirstPageNumber==="1",usePrinterDefaults:e.attributes.usePrinterDefaults==="1",copies:parseInt(e.attributes.copies||"1",10)},!0;default:return!1}}parseText(){}parseClose(){return!1}};ANe.exports=Tte});var DNe=z((ZKi,INe)=>{"use strict";var $Mt=Go(),GMt=mt();function uj(t){return t?"1":void 0}var Ate=class extends GMt{get tag(){return"printOptions"}render(e,i){if(i){let r={headings:uj(i.showRowColHeaders),gridLines:uj(i.showGridLines),horizontalCentered:uj(i.horizontalCentered),verticalCentered:uj(i.verticalCentered)};$Mt.some(r,n=>n!==void 0)&&e.leafNode(this.tag,r)}}parseOpen(e){switch(e.name){case this.tag:return this.model={showRowColHeaders:e.attributes.headings==="1",showGridLines:e.attributes.gridLines==="1",horizontalCentered:e.attributes.horizontalCentered==="1",verticalCentered:e.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}};INe.exports=Ate});var Dte=z((QKi,MNe)=>{"use strict";var XMt=Oo(),KMt=mt(),Ite=class extends KMt{get tag(){return"autoFilter"}render(e,i){if(i)if(typeof i=="string")e.leafNode("autoFilter",{ref:i});else{let r=function(s){return typeof s=="string"?s:XMt.getAddress(s.row,s.column).address},n=r(i.from),o=r(i.to);n&&o&&e.leafNode("autoFilter",{ref:`${n}:${o}`})}}parseOpen(e){e.name==="autoFilter"&&(this.model=e.attributes.ref)}};MNe.exports=Ite});var kte=z((JKi,kNe)=>{"use strict";var ZMt=mt(),Mte=class extends ZMt{get tag(){return"picture"}render(e,i){i&&e.leafNode(this.tag,{"r:id":i.rId})}parseOpen(e){switch(e.name){case this.tag:return this.model={rId:e.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}};kNe.exports=Mte});var NNe=z((eZi,ONe)=>{"use strict";var QMt=mt(),Ote=class extends QMt{get tag(){return"drawing"}render(e,i){i&&e.leafNode(this.tag,{"r:id":i.rId})}parseOpen(e){switch(e.name){case this.tag:return this.model={rId:e.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}};ONe.exports=Ote});var LNe=z((tZi,PNe)=>{"use strict";var JMt=mt(),Nte=class extends JMt{get tag(){return"tablePart"}render(e,i){i&&e.leafNode(this.tag,{"r:id":i.rId})}parseOpen(e){switch(e.name){case this.tag:return this.model={rId:e.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}};PNe.exports=Nte});var HNe=z((iZi,FNe)=>{"use strict";var ekt=mt(),Pte=class extends ekt{get tag(){return"brk"}render(e,i){e.leafNode("brk",i)}parseOpen(e){return e.name==="brk"?(this.model=e.attributes.ref,!0):!1}parseText(){}parseClose(){return!1}};FNe.exports=Pte});var Fte=z((rZi,BNe)=>{"use strict";var tkt=HNe(),ikt=r0(),Lte=class extends ikt{constructor(){let e={tag:"rowBreaks",count:!0,childXform:new tkt};super(e)}render(e,i){if(i&&i.length){e.openNode(this.tag,this.$),this.count&&(e.addAttribute(this.$count,i.length),e.addAttribute("manualBreakCount",i.length));let{childXform:r}=this;i.forEach(n=>{r.render(e,n)}),e.closeNode()}else this.empty&&e.leafNode(this.tag)}};BNe.exports=Lte});var Bte=z((nZi,VNe)=>{"use strict";var rkt=mt(),Hte=class extends rkt{get tag(){return"headerFooter"}render(e,i){if(i){e.addRollback();let r=!1;e.openNode("headerFooter"),i.differentFirst&&(e.addAttribute("differentFirst","1"),r=!0),i.differentOddEven&&(e.addAttribute("differentOddEven","1"),r=!0),i.oddHeader&&typeof i.oddHeader=="string"&&(e.leafNode("oddHeader",null,i.oddHeader),r=!0),i.oddFooter&&typeof i.oddFooter=="string"&&(e.leafNode("oddFooter",null,i.oddFooter),r=!0),i.evenHeader&&typeof i.evenHeader=="string"&&(e.leafNode("evenHeader",null,i.evenHeader),r=!0),i.evenFooter&&typeof i.evenFooter=="string"&&(e.leafNode("evenFooter",null,i.evenFooter),r=!0),i.firstHeader&&typeof i.firstHeader=="string"&&(e.leafNode("firstHeader",null,i.firstHeader),r=!0),i.firstFooter&&typeof i.firstFooter=="string"&&(e.leafNode("firstFooter",null,i.firstFooter),r=!0),r?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){switch(e.name){case"headerFooter":return this.model={},e.attributes.differentFirst&&(this.model.differentFirst=parseInt(e.attributes.differentFirst,0)===1),e.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(e.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(e){switch(this.currentNode){case"oddHeader":this.model.oddHeader=e;break;case"oddFooter":this.model.oddFooter=e;break;case"evenHeader":this.model.evenHeader=e;break;case"evenFooter":this.model.evenFooter=e;break;case"firstHeader":this.model.firstHeader=e;break;case"firstFooter":this.model.firstFooter=e;break;default:break}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}};VNe.exports=Hte});var Vc=z((oZi,jNe)=>{"use strict";var nkt=mt(),Vte=class extends nkt{createNewModel(e){return{}}parseOpen(e){return this.parser=this.parser||this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.model=this.createNewModel(e),!0):!1}parseText(e){this.parser&&this.parser.parseText(e)}onParserClose(e,i){this.model[e]=i.model}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.onParserClose(e,this.parser),this.parser=void 0),!0):e!==this.tag}};jNe.exports=Vte});var hj=z((sZi,WNe)=>{"use strict";var zNe=mt(),jte=class extends zNe{get tag(){return"cfvo"}render(e,i){e.leafNode(this.tag,{type:i.type,val:i.value})}parseOpen(e){this.model={type:e.attributes.type,value:zNe.toFloatValue(e.attributes.val)}}parseClose(e){return e!==this.tag}};WNe.exports=jte});var qNe=z((aZi,UNe)=>{"use strict";var okt=Vc(),skt=n0(),akt=hj(),zte=class extends okt{constructor(){super(),this.map={cfvo:this.cfvoXform=new akt,color:this.colorXform=new skt}}get tag(){return"dataBar"}render(e,i){e.openNode(this.tag),i.cfvo.forEach(r=>{this.cfvoXform.render(e,r)}),this.colorXform.render(e,i.color),e.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(e,i){switch(e){case"cfvo":this.model.cfvo.push(i.model);break;case"color":this.model.color=i.model;break}}};UNe.exports=zte});var GNe=z((lZi,$Ne)=>{"use strict";var lkt=mt(),YNe=Vc(),Wte=class extends lkt{get tag(){return"x14:id"}render(e,i){e.leafNode(this.tag,null,i)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}},Ute=class extends YNe{constructor(){super(),this.map={"x14:id":this.idXform=new Wte}}get tag(){return"ext"}render(e,i){e.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(e,i.x14Id),e.closeNode()}createNewModel(){return{}}onParserClose(e,i){this.model.x14Id=i.model}},qte=class extends YNe{constructor(){super(),this.map={ext:new Ute}}get tag(){return"extLst"}render(e,i){e.openNode(this.tag),this.map.ext.render(e,i),e.closeNode()}createNewModel(){return{}}onParserClose(e,i){Object.assign(this.model,i.model)}};$Ne.exports=qte});var KNe=z((cZi,XNe)=>{"use strict";var ckt=mt(),Yte=class extends ckt{get tag(){return"formula"}render(e,i){e.leafNode(this.tag,null,i)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}};XNe.exports=Yte});var QNe=z((dZi,ZNe)=>{"use strict";var dkt=Vc(),ukt=n0(),hkt=hj(),$te=class extends dkt{constructor(){super(),this.map={cfvo:this.cfvoXform=new hkt,color:this.colorXform=new ukt}}get tag(){return"colorScale"}render(e,i){e.openNode(this.tag),i.cfvo.forEach(r=>{this.cfvoXform.render(e,r)}),i.color.forEach(r=>{this.colorXform.render(e,r)}),e.closeNode()}createNewModel(e){return{cfvo:[],color:[]}}onParserClose(e,i){this.model[e].push(i.model)}};ZNe.exports=$te});var ePe=z((uZi,JNe)=>{"use strict";var $E=mt(),fkt=Vc(),pkt=hj(),Gte=class extends fkt{constructor(){super(),this.map={cfvo:this.cfvoXform=new pkt}}get tag(){return"iconSet"}render(e,i){e.openNode(this.tag,{iconSet:$E.toStringAttribute(i.iconSet,"3TrafficLights"),reverse:$E.toBoolAttribute(i.reverse,!1),showValue:$E.toBoolAttribute(i.showValue,!0)}),i.cfvo.forEach(r=>{this.cfvoXform.render(e,r)}),e.closeNode()}createNewModel({attributes:e}){return{iconSet:$E.toStringValue(e.iconSet,"3TrafficLights"),reverse:$E.toBoolValue(e.reverse),showValue:$E.toBoolValue(e.showValue),cfvo:[]}}onParserClose(e,i){this.model[e].push(i.model)}};JNe.exports=Gte});var rPe=z((hZi,iPe)=>{"use strict";var Ih=mt(),mkt=Vc(),tPe=Wm(),gkt=qNe(),vkt=GNe(),bkt=KNe(),_kt=QNe(),ykt=ePe(),wkt={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},Ckt=t=>{if(t.formulae&&t.formulae[0])return t.formulae[0];let e=new tPe(t.ref),{tl:i}=e;switch(t.operator){case"containsText":return`NOT(ISERROR(SEARCH("${t.text}",${i})))`;case"containsBlanks":return`LEN(TRIM(${i}))=0`;case"notContainsBlanks":return`LEN(TRIM(${i}))>0`;case"containsErrors":return`ISERROR(${i})`;case"notContainsErrors":return`NOT(ISERROR(${i}))`;default:return}},xkt=t=>{if(t.formulae&&t.formulae[0])return t.formulae[0];let e=new tPe(t.ref),{tl:i}=e;switch(t.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${i},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${i},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${i},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${i},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${i},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${i},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${i},1)=TODAY()-1`;case"today":return`FLOOR(${i},1)=TODAY()`;case"tomorrow":return`FLOOR(${i},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${i},1)<=6,FLOOR(${i},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${i})=MONTH(EDATE(TODAY(),0-1)),YEAR(${i})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${i})=MONTH(TODAY()),YEAR(${i})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${i})=MONTH(EDATE(TODAY(),0+1)),YEAR(${i})=YEAR(EDATE(TODAY(),0+1)))`;default:return}},Skt=t=>{let{type:e,operator:i}=t;switch(e){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:e};default:return{type:e,operator:i}}},Xte=class t extends mkt{constructor(){super(),this.map={dataBar:this.databarXform=new gkt,extLst:this.extLstRefXform=new vkt,formula:this.formulaXform=new bkt,colorScale:this.colorScaleXform=new _kt,iconSet:this.iconSetXform=new ykt}}get tag(){return"cfRule"}static isPrimitive(e){return!(e.type==="iconSet"&&(e.custom||wkt[e.iconSet]))}render(e,i){switch(i.type){case"expression":this.renderExpression(e,i);break;case"cellIs":this.renderCellIs(e,i);break;case"top10":this.renderTop10(e,i);break;case"aboveAverage":this.renderAboveAverage(e,i);break;case"dataBar":this.renderDataBar(e,i);break;case"colorScale":this.renderColorScale(e,i);break;case"iconSet":this.renderIconSet(e,i);break;case"containsText":this.renderText(e,i);break;case"timePeriod":this.renderTimePeriod(e,i);break}}renderExpression(e,i){e.openNode(this.tag,{type:"expression",dxfId:i.dxfId,priority:i.priority}),this.formulaXform.render(e,i.formulae[0]),e.closeNode()}renderCellIs(e,i){e.openNode(this.tag,{type:"cellIs",dxfId:i.dxfId,priority:i.priority,operator:i.operator}),i.formulae.forEach(r=>{this.formulaXform.render(e,r)}),e.closeNode()}renderTop10(e,i){e.leafNode(this.tag,{type:"top10",dxfId:i.dxfId,priority:i.priority,percent:Ih.toBoolAttribute(i.percent,!1),bottom:Ih.toBoolAttribute(i.bottom,!1),rank:Ih.toIntValue(i.rank,10,!0)})}renderAboveAverage(e,i){e.leafNode(this.tag,{type:"aboveAverage",dxfId:i.dxfId,priority:i.priority,aboveAverage:Ih.toBoolAttribute(i.aboveAverage,!0)})}renderDataBar(e,i){e.openNode(this.tag,{type:"dataBar",priority:i.priority}),this.databarXform.render(e,i),this.extLstRefXform.render(e,i),e.closeNode()}renderColorScale(e,i){e.openNode(this.tag,{type:"colorScale",priority:i.priority}),this.colorScaleXform.render(e,i),e.closeNode()}renderIconSet(e,i){t.isPrimitive(i)&&(e.openNode(this.tag,{type:"iconSet",priority:i.priority}),this.iconSetXform.render(e,i),e.closeNode())}renderText(e,i){e.openNode(this.tag,{type:i.operator,dxfId:i.dxfId,priority:i.priority,operator:Ih.toStringAttribute(i.operator,"containsText")});let r=Ckt(i);r&&this.formulaXform.render(e,r),e.closeNode()}renderTimePeriod(e,i){e.openNode(this.tag,{type:"timePeriod",dxfId:i.dxfId,priority:i.priority,timePeriod:i.timePeriod});let r=xkt(i);r&&this.formulaXform.render(e,r),e.closeNode()}createNewModel({attributes:e}){return Lt(Ke({},Skt(e)),{dxfId:Ih.toIntValue(e.dxfId),priority:Ih.toIntValue(e.priority),timePeriod:e.timePeriod,percent:Ih.toBoolValue(e.percent),bottom:Ih.toBoolValue(e.bottom),rank:Ih.toIntValue(e.rank),aboveAverage:Ih.toBoolValue(e.aboveAverage)})}onParserClose(e,i){switch(e){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,i.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(i.model);break}}};iPe.exports=Xte});var oPe=z((pZi,nPe)=>{"use strict";var Ekt=Vc(),Kte=rPe(),Zte=class extends Ekt{constructor(){super(),this.map={cfRule:new Kte}}get tag(){return"conditionalFormatting"}render(e,i){i.rules.some(Kte.isPrimitive)&&(e.openNode(this.tag,{sqref:i.ref}),i.rules.forEach(r=>{Kte.isPrimitive(r)&&(r.ref=i.ref,this.map.cfRule.render(e,r))}),e.closeNode())}createNewModel({attributes:e}){return{ref:e.sqref,rules:[]}}onParserClose(e,i){this.model.rules.push(i.model)}};nPe.exports=Zte});var Jte=z((mZi,sPe)=>{"use strict";var Tkt=mt(),Rkt=oPe(),Qte=class extends Tkt{constructor(){super(),this.cfXform=new Rkt}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(e,i){let r=e.reduce((n,o)=>Math.max(n,...o.rules.map(s=>s.priority||0)),1);e.forEach(n=>{n.rules.forEach(o=>{o.priority||(o.priority=r++),o.style&&(o.dxfId=i.styles.addDxfStyle(o.style))})})}render(e,i){i.forEach(r=>{this.cfXform.render(e,r)})}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?this.parser.parseClose(e)?!0:(this.model.push(this.parser.model),this.parser=void 0,!1):!1}reconcile(e,i){e.forEach(r=>{r.rules.forEach(n=>{n.dxfId!==void 0&&(n.style=i.styles.getDxfStyle(n.dxfId),delete n.dxfId)})})}};sPe.exports=Qte});import Akt from"crypto";function Q2(){return fj>pj.length-16&&(Akt.randomFillSync(pj),fj=0),pj.slice(fj,fj+=16)}var pj,fj,eie=Ja(()=>{"use strict";pj=new Uint8Array(256),fj=pj.length});var aPe,lPe=Ja(()=>{"use strict";aPe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function Ikt(t){return typeof t=="string"&&aPe.test(t)}var l0,J2=Ja(()=>{"use strict";lPe();l0=Ikt});function Dkt(t,e=0){let i=(Va[t[e+0]]+Va[t[e+1]]+Va[t[e+2]]+Va[t[e+3]]+"-"+Va[t[e+4]]+Va[t[e+5]]+"-"+Va[t[e+6]]+Va[t[e+7]]+"-"+Va[t[e+8]]+Va[t[e+9]]+"-"+Va[t[e+10]]+Va[t[e+11]]+Va[t[e+12]]+Va[t[e+13]]+Va[t[e+14]]+Va[t[e+15]]).toLowerCase();if(!l0(i))throw TypeError("Stringified UUID is invalid");return i}var Va,c0,eN=Ja(()=>{"use strict";J2();Va=[];for(let t=0;t<256;++t)Va.push((t+256).toString(16).substr(1));c0=Dkt});function Mkt(t,e,i){let r=e&&i||0,n=e||new Array(16);t=t||{};let o=t.node||cPe,s=t.clockseq!==void 0?t.clockseq:tie;if(o==null||s==null){let p=t.random||(t.rng||Q2)();o==null&&(o=cPe=[p[0]|1,p[1],p[2],p[3],p[4],p[5]]),s==null&&(s=tie=(p[6]<<8|p[7])&16383)}let a=t.msecs!==void 0?t.msecs:Date.now(),c=t.nsecs!==void 0?t.nsecs:rie+1,d=a-iie+(c-rie)/1e4;if(d<0&&t.clockseq===void 0&&(s=s+1&16383),(d<0||a>iie)&&t.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");iie=a,rie=c,tie=s,a+=122192928e5;let u=((a&268435455)*1e4+c)%4294967296;n[r++]=u>>>24&255,n[r++]=u>>>16&255,n[r++]=u>>>8&255,n[r++]=u&255;let h=a/4294967296*1e4&268435455;n[r++]=h>>>8&255,n[r++]=h&255,n[r++]=h>>>24&15|16,n[r++]=h>>>16&255,n[r++]=s>>>8|128,n[r++]=s&255;for(let p=0;p<6;++p)n[r+p]=o[p];return e||c0(n)}var cPe,tie,iie,rie,dPe,uPe=Ja(()=>{"use strict";eie();eN();iie=0,rie=0;dPe=Mkt});function kkt(t){if(!l0(t))throw TypeError("Invalid UUID");let e,i=new Uint8Array(16);return i[0]=(e=parseInt(t.slice(0,8),16))>>>24,i[1]=e>>>16&255,i[2]=e>>>8&255,i[3]=e&255,i[4]=(e=parseInt(t.slice(9,13),16))>>>8,i[5]=e&255,i[6]=(e=parseInt(t.slice(14,18),16))>>>8,i[7]=e&255,i[8]=(e=parseInt(t.slice(19,23),16))>>>8,i[9]=e&255,i[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,i[11]=e/4294967296&255,i[12]=e>>>24&255,i[13]=e>>>16&255,i[14]=e>>>8&255,i[15]=e&255,i}var mj,nie=Ja(()=>{"use strict";J2();mj=kkt});function Okt(t){t=unescape(encodeURIComponent(t));let e=[];for(let i=0;i<t.length;++i)e.push(t.charCodeAt(i));return e}function gj(t,e,i){function r(n,o,s,a){if(typeof n=="string"&&(n=Okt(n)),typeof o=="string"&&(o=mj(o)),o.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+n.length);if(c.set(o),c.set(n,o.length),c=i(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,s){a=a||0;for(let d=0;d<16;++d)s[a+d]=c[d];return s}return c0(c)}try{r.name=t}catch{}return r.DNS=Nkt,r.URL=Pkt,r}var Nkt,Pkt,oie=Ja(()=>{"use strict";eN();nie();Nkt="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Pkt="6ba7b811-9dad-11d1-80b4-00c04fd430c8"});import Lkt from"crypto";function Fkt(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),Lkt.createHash("md5").update(t).digest()}var hPe,fPe=Ja(()=>{"use strict";hPe=Fkt});var Hkt,pPe,mPe=Ja(()=>{"use strict";oie();fPe();Hkt=gj("v3",48,hPe),pPe=Hkt});function Bkt(t,e,i){t=t||{};let r=t.random||(t.rng||Q2)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){i=i||0;for(let n=0;n<16;++n)e[i+n]=r[n];return e}return c0(r)}var gPe,vPe=Ja(()=>{"use strict";eie();eN();gPe=Bkt});import Vkt from"crypto";function jkt(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),Vkt.createHash("sha1").update(t).digest()}var bPe,_Pe=Ja(()=>{"use strict";bPe=jkt});var zkt,yPe,wPe=Ja(()=>{"use strict";oie();_Pe();zkt=gj("v5",80,bPe),yPe=zkt});var CPe,xPe=Ja(()=>{"use strict";CPe="00000000-0000-0000-0000-000000000000"});function Wkt(t){if(!l0(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}var SPe,EPe=Ja(()=>{"use strict";J2();SPe=Wkt});var TPe={};fW(TPe,{NIL:()=>CPe,parse:()=>mj,stringify:()=>c0,v1:()=>dPe,v3:()=>pPe,v4:()=>gPe,v5:()=>yPe,validate:()=>l0,version:()=>SPe});var RPe=Ja(()=>{"use strict";uPe();mPe();vPe();wPe();xPe();EPe();J2();eN();nie()});var IPe=z((iQi,APe)=>{"use strict";var Ukt=mt(),sie=class extends Ukt{get tag(){return"xm:f"}render(e,i){e.leafNode(this.tag,null,i)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}};APe.exports=sie});var lie=z((rQi,DPe)=>{"use strict";var qkt=Vc(),Ykt=IPe(),aie=class extends qkt{constructor(){super(),this.map={"xm:f":this.fExtXform=new Ykt}}get tag(){return"x14:cfvo"}render(e,i){e.openNode(this.tag,{type:i.type}),i.value!==void 0&&this.fExtXform.render(e,i.value),e.closeNode()}createNewModel(e){return{type:e.attributes.type}}onParserClose(e,i){switch(e){case"xm:f":this.model.value=i.model?parseFloat(i.model):0;break}}};DPe.exports=aie});var kPe=z((nQi,MPe)=>{"use strict";var wl=mt(),$kt=Vc(),vj=n0(),Gkt=lie(),cie=class extends $kt{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new Gkt,"x14:borderColor":this.borderColorXform=new vj("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new vj("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new vj("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new vj("x14:axisColor")}}static isExt(e){return!e.gradient}get tag(){return"x14:dataBar"}render(e,i){e.openNode(this.tag,{minLength:wl.toIntAttribute(i.minLength,0,!0),maxLength:wl.toIntAttribute(i.maxLength,100,!0),border:wl.toBoolAttribute(i.border,!1),gradient:wl.toBoolAttribute(i.gradient,!0),negativeBarColorSameAsPositive:wl.toBoolAttribute(i.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:wl.toBoolAttribute(i.negativeBarBorderColorSameAsPositive,!0),axisPosition:wl.toAttribute(i.axisPosition,"auto"),direction:wl.toAttribute(i.direction,"leftToRight")}),i.cfvo.forEach(r=>{this.cfvoXform.render(e,r)}),this.borderColorXform.render(e,i.borderColor),this.negativeBorderColorXform.render(e,i.negativeBorderColor),this.negativeFillColorXform.render(e,i.negativeFillColor),this.axisColorXform.render(e,i.axisColor),e.closeNode()}createNewModel({attributes:e}){return{cfvo:[],minLength:wl.toIntValue(e.minLength,0),maxLength:wl.toIntValue(e.maxLength,100),border:wl.toBoolValue(e.border,!1),gradient:wl.toBoolValue(e.gradient,!0),negativeBarColorSameAsPositive:wl.toBoolValue(e.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:wl.toBoolValue(e.negativeBarBorderColorSameAsPositive,!0),axisPosition:wl.toStringValue(e.axisPosition,"auto"),direction:wl.toStringValue(e.direction,"leftToRight")}}onParserClose(e,i){let[,r]=e.split(":");switch(r){case"cfvo":this.model.cfvo.push(i.model);break;default:this.model[r]=i.model;break}}};MPe.exports=cie});var PPe=z((oQi,NPe)=>{"use strict";var OPe=mt(),die=class extends OPe{get tag(){return"x14:cfIcon"}render(e,i){e.leafNode(this.tag,{iconSet:i.iconSet,iconId:i.iconId})}parseOpen({attributes:e}){this.model={iconSet:e.iconSet,iconId:OPe.toIntValue(e.iconId)}}parseClose(e){return e!==this.tag}};NPe.exports=die});var FPe=z((sQi,LPe)=>{"use strict";var Aw=mt(),Xkt=Vc(),Kkt=lie(),Zkt=PPe(),uie=class extends Xkt{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new Kkt,"x14:cfIcon":this.cfIconXform=new Zkt}}get tag(){return"x14:iconSet"}render(e,i){e.openNode(this.tag,{iconSet:Aw.toStringAttribute(i.iconSet),reverse:Aw.toBoolAttribute(i.reverse,!1),showValue:Aw.toBoolAttribute(i.showValue,!0),custom:Aw.toBoolAttribute(i.icons,!1)}),i.cfvo.forEach(r=>{this.cfvoXform.render(e,r)}),i.icons&&i.icons.forEach((r,n)=>{r.iconId=n,this.cfIconXform.render(e,r)}),e.closeNode()}createNewModel({attributes:e}){return{cfvo:[],iconSet:Aw.toStringValue(e.iconSet,"3TrafficLights"),reverse:Aw.toBoolValue(e.reverse,!1),showValue:Aw.toBoolValue(e.showValue,!0)}}onParserClose(e,i){let[,r]=e.split(":");switch(r){case"cfvo":this.model.cfvo.push(i.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(i.model);break;default:this.model[r]=i.model;break}}};LPe.exports=uie});var fie=z((aQi,VPe)=>{"use strict";var{v4:HPe}=(RPe(),Zce(TPe)),Qkt=mt(),Jkt=Vc(),BPe=kPe(),eOt=FPe(),tOt={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},hie=class t extends Jkt{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new BPe,"x14:iconSet":this.iconSetXform=new eOt}}get tag(){return"x14:cfRule"}static isExt(e){return e.type==="dataBar"?BPe.isExt(e):!!(e.type==="iconSet"&&(e.custom||tOt[e.iconSet]))}prepare(e){t.isExt(e)&&(e.x14Id=`{${HPe()}}`.toUpperCase())}render(e,i){if(t.isExt(i))switch(i.type){case"dataBar":this.renderDataBar(e,i);break;case"iconSet":this.renderIconSet(e,i);break}}renderDataBar(e,i){e.openNode(this.tag,{type:"dataBar",id:i.x14Id}),this.databarXform.render(e,i),e.closeNode()}renderIconSet(e,i){e.openNode(this.tag,{type:"iconSet",priority:i.priority,id:i.x14Id||`{${HPe()}}`}),this.iconSetXform.render(e,i),e.closeNode()}createNewModel({attributes:e}){return{type:e.type,x14Id:e.id,priority:Qkt.toIntValue(e.priority)}}onParserClose(e,i){Object.assign(this.model,i.model)}};VPe.exports=hie});var zPe=z((lQi,jPe)=>{"use strict";var iOt=mt(),pie=class extends iOt{get tag(){return"xm:sqref"}render(e,i){e.leafNode(this.tag,null,i)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}};jPe.exports=pie});var UPe=z((cQi,WPe)=>{"use strict";var rOt=Vc(),nOt=zPe(),mie=fie(),gie=class extends rOt{constructor(){super(),this.map={"xm:sqref":this.sqRef=new nOt,"x14:cfRule":this.cfRule=new mie}}get tag(){return"x14:conditionalFormatting"}prepare(e,i){e.rules.forEach(r=>{this.cfRule.prepare(r,i)})}render(e,i){i.rules.some(mie.isExt)&&(e.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),i.rules.filter(mie.isExt).forEach(r=>this.cfRule.render(e,r)),this.sqRef.render(e,i.ref),e.closeNode())}createNewModel(){return{rules:[]}}onParserClose(e,i){switch(e){case"xm:sqref":this.model.ref=i.model;break;case"x14:cfRule":this.model.rules.push(i.model);break}}};WPe.exports=gie});var YPe=z((dQi,qPe)=>{"use strict";var oOt=Vc(),sOt=fie(),aOt=UPe(),vie=class extends oOt{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new aOt}}get tag(){return"x14:conditionalFormattings"}hasContent(e){return e.hasExtContent===void 0&&(e.hasExtContent=e.some(i=>i.rules.some(sOt.isExt))),e.hasExtContent}prepare(e,i){e.forEach(r=>{this.cfXform.prepare(r,i)})}render(e,i){this.hasContent(i)&&(e.openNode(this.tag),i.forEach(r=>this.cfXform.render(e,r)),e.closeNode())}createNewModel(){return[]}onParserClose(e,i){this.model.push(i.model)}};qPe.exports=vie});var XPe=z((uQi,GPe)=>{"use strict";var $Pe=Vc(),lOt=YPe(),bie=class extends $Pe{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new lOt}}get tag(){return"ext"}hasContent(e){return this.conditionalFormattings.hasContent(e.conditionalFormattings)}prepare(e,i){this.conditionalFormattings.prepare(e.conditionalFormattings,i)}render(e,i){e.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(e,i.conditionalFormattings),e.closeNode()}createNewModel(){return{}}onParserClose(e,i){this.model[e]=i.model}},_ie=class extends $Pe{constructor(){super(),this.map={ext:this.ext=new bie}}get tag(){return"extLst"}prepare(e,i){this.ext.prepare(e,i)}hasContent(e){return this.ext.hasContent(e)}render(e,i){this.hasContent(i)&&(e.openNode("extLst"),this.ext.render(e,i),e.closeNode())}createNewModel(){return{}}onParserClose(e,i){Object.assign(this.model,i.model)}};GPe.exports=_ie});var ZPe=z((hQi,KPe)=>{"use strict";var cOt=Go(),dOt=Oo(),uOt=Ha(),tg=s0(),hOt=aNe(),fOt=mt(),GE=r0(),pOt=ite(),mOt=ote(),gOt=pNe(),vOt=lte(),bOt=vNe(),_Ot=fte(),yOt=vte(),wOt=_te(),COt=wte(),xOt=xte(),SOt=Ete(),EOt=Rte(),TOt=DNe(),ROt=Dte(),AOt=kte(),IOt=NNe(),DOt=LNe(),MOt=Fte(),kOt=Bte(),OOt=Jte(),NOt=XPe(),POt=(t,e)=>{Object.keys(e).forEach(i=>{let r=t[i],n=e[i];r===void 0&&n!==void 0&&(t[i]=n)})},LOt=(t,e)=>{if(!e||!e.length)return t;if(!t||!t.length)return e;let i={},r={};return t.forEach(n=>{i[n.ref]=n,n.rules.forEach(o=>{let{x14Id:s}=o;s&&(r[s]=o)})}),e.forEach(n=>{n.rules.forEach(o=>{let s=r[o.x14Id];s?POt(s,o):i[n.ref]?i[n.ref].rules.push(o):t.push({ref:n.ref,rules:[o]})})}),t},FOt=(()=>{class t extends fOt{constructor(i){super();let{maxRows:r,maxCols:n,ignoreNodes:o}=i||{};this.ignoreNodes=o||[],this.map={sheetPr:new yOt,dimension:new gOt,sheetViews:new GE({tag:"sheetViews",count:!1,childXform:new COt}),sheetFormatPr:new wOt,cols:new GE({tag:"cols",count:!1,childXform:new mOt}),sheetData:new GE({tag:"sheetData",count:!1,empty:!0,childXform:new pOt({maxItems:n}),maxItems:r}),autoFilter:new ROt,mergeCells:new GE({tag:"mergeCells",count:!0,childXform:new bOt}),rowBreaks:new MOt,hyperlinks:new GE({tag:"hyperlinks",count:!1,childXform:new vOt}),pageMargins:new SOt,dataValidations:new _Ot,pageSetup:new EOt,headerFooter:new kOt,printOptions:new TOt,picture:new AOt,drawing:new IOt,sheetProtection:new xOt,tableParts:new GE({tag:"tableParts",count:!0,childXform:new DOt}),conditionalFormatting:new OOt,extLst:new NOt}}prepare(i,r){r.merges=new hOt,i.hyperlinks=r.hyperlinks=[],i.comments=r.comments=[],r.formulae={},r.siFormulae=0,this.map.cols.prepare(i.cols,r),this.map.sheetData.prepare(i.rows,r),this.map.conditionalFormatting.prepare(i.conditionalFormattings,r),i.mergeCells=r.merges.mergeCells;let n=i.rels=[];function o(c){return`rId${c.length+1}`}if(i.hyperlinks.forEach(c=>{let d=o(n);c.rId=d,n.push({Id:d,Type:tg.Hyperlink,Target:c.target,TargetMode:"External"})}),i.comments.length>0){let c={Id:o(n),Type:tg.Comments,Target:`../comments${i.id}.xml`};n.push(c);let d={Id:o(n),Type:tg.VmlDrawing,Target:`../drawings/vmlDrawing${i.id}.vml`};n.push(d),i.comments.forEach(u=>{u.refAddress=dOt.decodeAddress(u.ref)}),r.commentRefs.push({commentName:`comments${i.id}`,vmlDrawing:`vmlDrawing${i.id}`})}let s=[],a;i.media.forEach(c=>{if(c.type==="background"){let d=o(n);a=r.media[c.imageId],n.push({Id:d,Type:tg.Image,Target:`../media/${a.name}.${a.extension}`}),i.background={rId:d},i.image=r.media[c.imageId]}else if(c.type==="image"){let{drawing:d}=i;a=r.media[c.imageId],d||(d=i.drawing={rId:o(n),name:`drawing${++r.drawingsCount}`,anchors:[],rels:[]},r.drawings.push(d),n.push({Id:d.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${d.name}.xml`}));let u=this.preImageId===c.imageId?s[c.imageId]:s[d.rels.length];u||(u=o(d.rels),s[d.rels.length]=u,d.rels.push({Id:u,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${a.name}.${a.extension}`}));let h={picture:{rId:u},range:c.range};if(c.hyperlinks&&c.hyperlinks.hyperlink){let p=o(d.rels);s[d.rels.length]=p,h.picture.hyperlinks={tooltip:c.hyperlinks.tooltip,rId:p},d.rels.push({Id:p,Type:tg.Hyperlink,Target:c.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=c.imageId,d.anchors.push(h)}}),i.tables.forEach(c=>{let d=o(n);c.rId=d,n.push({Id:d,Type:tg.Table,Target:`../tables/${c.target}`}),c.columns.forEach(u=>{let{style:h}=u;h&&(u.dxfId=r.styles.addDxfStyle(h))})}),this.map.extLst.prepare(i,r)}render(i,r){i.openXml(uOt.StdDocAttributes),i.openNode("worksheet",t.WORKSHEET_ATTRIBUTES);let n=r.properties?{defaultRowHeight:r.properties.defaultRowHeight,dyDescent:r.properties.dyDescent,outlineLevelCol:r.properties.outlineLevelCol,outlineLevelRow:r.properties.outlineLevelRow}:void 0;r.properties&&r.properties.defaultColWidth&&(n.defaultColWidth=r.properties.defaultColWidth);let o={outlineProperties:r.properties&&r.properties.outlineProperties,tabColor:r.properties&&r.properties.tabColor,pageSetup:r.pageSetup&&r.pageSetup.fitToPage?{fitToPage:r.pageSetup.fitToPage}:void 0},s=r.pageSetup&&r.pageSetup.margins,a={showRowColHeaders:r.pageSetup&&r.pageSetup.showRowColHeaders,showGridLines:r.pageSetup&&r.pageSetup.showGridLines,horizontalCentered:r.pageSetup&&r.pageSetup.horizontalCentered,verticalCentered:r.pageSetup&&r.pageSetup.verticalCentered},c=r.sheetProtection;this.map.sheetPr.render(i,o),this.map.dimension.render(i,r.dimensions),this.map.sheetViews.render(i,r.views),this.map.sheetFormatPr.render(i,n),this.map.cols.render(i,r.cols),this.map.sheetData.render(i,r.rows),this.map.sheetProtection.render(i,c),this.map.autoFilter.render(i,r.autoFilter),this.map.mergeCells.render(i,r.mergeCells),this.map.conditionalFormatting.render(i,r.conditionalFormattings),this.map.dataValidations.render(i,r.dataValidations),this.map.hyperlinks.render(i,r.hyperlinks),this.map.printOptions.render(i,a),this.map.pageMargins.render(i,s),this.map.pageSetup.render(i,r.pageSetup),this.map.headerFooter.render(i,r.headerFooter),this.map.rowBreaks.render(i,r.rowBreaks),this.map.drawing.render(i,r.drawing),this.map.picture.render(i,r.background),this.map.tableParts.render(i,r.tables),this.map.extLst.render(i,r),r.rels&&r.rels.forEach(d=>{d.Type===tg.VmlDrawing&&i.leafNode("legacyDrawing",{"r:id":d.Id})}),i.closeNode()}parseOpen(i){return this.parser?(this.parser.parseOpen(i),!0):i.name==="worksheet"?(cOt.each(this.map,r=>{r.reset()}),!0):(this.map[i.name]&&!this.ignoreNodes.includes(i.name)&&(this.parser=this.map[i.name],this.parser.parseOpen(i)),!0)}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case"worksheet":{let r=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(r.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(r.outlineProperties=this.map.sheetPr.model.outlineProperties);let n={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},o=Object.assign(n,this.map.pageSetup.model,this.map.printOptions.model),s=LOt(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:r,views:this.map.sheetViews.model,pageSetup:o,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:s},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(i,r){let n=(i.relationships||[]).reduce((s,a)=>{if(s[a.Id]=a,a.Type===tg.Comments&&(i.comments=r.comments[a.Target].comments),a.Type===tg.VmlDrawing&&i.comments&&i.comments.length){let c=r.vmlDrawings[a.Target].comments;i.comments.forEach((d,u)=>{d.note=Object.assign({},d.note,c[u])})}return s},{});if(r.commentsMap=(i.comments||[]).reduce((s,a)=>(a.ref&&(s[a.ref]=a),s),{}),r.hyperlinkMap=(i.hyperlinks||[]).reduce((s,a)=>(a.rId&&(s[a.address]=n[a.rId].Target),s),{}),r.formulae={},i.rows=i.rows&&i.rows.filter(Boolean)||[],i.rows.forEach(s=>{s.cells=s.cells&&s.cells.filter(Boolean)||[]}),this.map.cols.reconcile(i.cols,r),this.map.sheetData.reconcile(i.rows,r),this.map.conditionalFormatting.reconcile(i.conditionalFormattings,r),i.media=[],i.drawing){let a=n[i.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(a){let c=a[1];r.drawings[c].anchors.forEach(u=>{if(u.medium){let h={type:"image",imageId:u.medium.index,range:u.range,hyperlinks:u.picture.hyperlinks};i.media.push(h)}})}}let o=i.background&&n[i.background.rId];if(o){let s=o.Target.split("/media/")[1],a=r.mediaIndex&&r.mediaIndex[s];a!==void 0&&i.media.push({type:"background",imageId:a})}i.tables=(i.tables||[]).map(s=>{let a=n[s.rId];return r.tables[a.Target]}),delete i.relationships,delete i.hyperlinks,delete i.comments}}return t.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},t})();KPe.exports=FOt});var wie=z((fQi,QPe)=>{"use strict";var HOt=mt(),yie=class extends HOt{parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset(),this.model={range:{editAs:e.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}reconcilePicture(e,i){if(e&&e.rId){let n=i.rels[e.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(n){let o=n[1],s=i.mediaIndex[o];return i.media[s]}}}};QPe.exports=yie});var xie=z((pQi,JPe)=>{"use strict";var BOt=mt(),bj=ZV(),Cie=class extends BOt{constructor(e){super(),this.tag=e.tag,this.map={"xdr:col":new bj({tag:"xdr:col",zero:!0}),"xdr:colOff":new bj({tag:"xdr:colOff",zero:!0}),"xdr:row":new bj({tag:"xdr:row",zero:!0}),"xdr:rowOff":new bj({tag:"xdr:rowOff",zero:!0})}}render(e,i){e.openNode(this.tag),this.map["xdr:col"].render(e,i.nativeCol),this.map["xdr:colOff"].render(e,i.nativeColOff),this.map["xdr:row"].render(e,i.nativeRow),this.map["xdr:rowOff"].render(e,i.nativeRowOff),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}};JPe.exports=Cie});var tLe=z((mQi,eLe)=>{"use strict";var VOt=mt(),Sie=class extends VOt{get tag(){return"a:blip"}render(e,i){e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":i.rId,cstate:"print"})}parseOpen(e){switch(e.name){case this.tag:return this.model={rId:e.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(e){switch(e){case this.tag:return!1;default:return!0}}};eLe.exports=Sie});var rLe=z((gQi,iLe)=>{"use strict";var jOt=mt(),zOt=tLe(),Eie=class extends jOt{constructor(){super(),this.map={"a:blip":new zOt}}get tag(){return"xdr:blipFill"}render(e,i){e.openNode(this.tag),this.map["a:blip"].render(e,i),e.openNode("a:stretch"),e.leafNode("a:fillRect"),e.closeNode(),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}};iLe.exports=Eie});var oLe=z((vQi,nLe)=>{"use strict";var WOt=mt(),Tie=class extends WOt{get tag(){return"a:hlinkClick"}render(e,i){i.hyperlinks&&i.hyperlinks.rId&&e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":i.hyperlinks.rId,tooltip:i.hyperlinks.tooltip})}parseOpen(e){switch(e.name){case this.tag:return this.model={hyperlinks:{rId:e.attributes["r:id"],tooltip:e.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}};nLe.exports=Tie});var aLe=z((bQi,sLe)=>{"use strict";var UOt=mt(),Rie=class extends UOt{get tag(){return"a:extLst"}render(e){e.openNode(this.tag),e.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),e.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),e.closeNode(),e.closeNode()}parseOpen(e){switch(e.name){case this.tag:return!0;default:return!0}}parseText(){}parseClose(e){switch(e){case this.tag:return!1;default:return!0}}};sLe.exports=Rie});var cLe=z((_Qi,lLe)=>{"use strict";var qOt=mt(),YOt=oLe(),$Ot=aLe(),Aie=class extends qOt{constructor(){super(),this.map={"a:hlinkClick":new YOt,"a:extLst":new $Ot}}get tag(){return"xdr:cNvPr"}render(e,i){e.openNode(this.tag,{id:i.index,name:`Picture ${i.index}`}),this.map["a:hlinkClick"].render(e,i),this.map["a:extLst"].render(e,i),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}};lLe.exports=Aie});var uLe=z((yQi,dLe)=>{"use strict";var GOt=mt(),Iie=class extends GOt{get tag(){return"xdr:cNvPicPr"}render(e){e.openNode(this.tag),e.leafNode("a:picLocks",{noChangeAspect:"1"}),e.closeNode()}parseOpen(e){switch(e.name){case this.tag:return!0;default:return!0}}parseText(){}parseClose(e){switch(e){case this.tag:return!1;default:return!0}}};dLe.exports=Iie});var fLe=z((wQi,hLe)=>{"use strict";var XOt=mt(),KOt=cLe(),ZOt=uLe(),Die=class extends XOt{constructor(){super(),this.map={"xdr:cNvPr":new KOt,"xdr:cNvPicPr":new ZOt}}get tag(){return"xdr:nvPicPr"}render(e,i){e.openNode(this.tag),this.map["xdr:cNvPr"].render(e,i),this.map["xdr:cNvPicPr"].render(e,i),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}};hLe.exports=Die});var mLe=z((CQi,pLe)=>{"use strict";pLe.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}});var kie=z((xQi,gLe)=>{"use strict";var QOt=mt(),JOt=WE(),e2t=rLe(),t2t=fLe(),i2t=mLe(),Mie=class extends QOt{constructor(){super(),this.map={"xdr:nvPicPr":new t2t,"xdr:blipFill":new e2t,"xdr:spPr":new JOt(i2t)}}get tag(){return"xdr:pic"}prepare(e,i){e.index=i.index+1}render(e,i){e.openNode(this.tag),this.map["xdr:nvPicPr"].render(e,i),this.map["xdr:blipFill"].render(e,i),this.map["xdr:spPr"].render(e,i),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(e){case this.tag:return!1;default:return!0}}};gLe.exports=Mie});var _Le=z((SQi,bLe)=>{"use strict";var r2t=wie(),n2t=WE(),vLe=xie(),o2t=kie(),Oie=class extends r2t{constructor(){super(),this.map={"xdr:from":new vLe({tag:"xdr:from"}),"xdr:to":new vLe({tag:"xdr:to"}),"xdr:pic":new o2t,"xdr:clientData":new n2t({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(e,i){this.map["xdr:pic"].prepare(e.picture,i)}render(e,i){e.openNode(this.tag,{editAs:i.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,i.range.tl),this.map["xdr:to"].render(e,i.range.br),this.map["xdr:pic"].render(e,i.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(e,i){e.medium=this.reconcilePicture(e.picture,i)}};bLe.exports=Oie});var wLe=z((EQi,yLe)=>{"use strict";var s2t=mt(),_j=9525,Nie=class extends s2t{constructor(e){super(),this.tag=e.tag,this.map={}}render(e,i){e.openNode(this.tag);let r=Math.floor(i.width*_j),n=Math.floor(i.height*_j);e.addAttribute("cx",r),e.addAttribute("cy",n),e.closeNode()}parseOpen(e){return e.name===this.tag?(this.model={width:parseInt(e.attributes.cx||"0",10)/_j,height:parseInt(e.attributes.cy||"0",10)/_j},!0):!1}parseText(){}parseClose(){return!1}};yLe.exports=Nie});var xLe=z((TQi,CLe)=>{"use strict";var a2t=wie(),l2t=WE(),c2t=xie(),d2t=wLe(),u2t=kie(),Pie=class extends a2t{constructor(){super(),this.map={"xdr:from":new c2t({tag:"xdr:from"}),"xdr:ext":new d2t({tag:"xdr:ext"}),"xdr:pic":new u2t,"xdr:clientData":new l2t({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(e,i){this.map["xdr:pic"].prepare(e.picture,i)}render(e,i){e.openNode(this.tag,{editAs:i.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,i.range.tl),this.map["xdr:ext"].render(e,i.range.ext),this.map["xdr:pic"].render(e,i.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(e,i){e.medium=this.reconcilePicture(e.picture,i)}};CLe.exports=Pie});var ELe=z((RQi,SLe)=>{"use strict";var h2t=Oo(),f2t=Ha(),p2t=mt(),m2t=_Le(),g2t=xLe();function v2t(t){return(typeof t.range=="string"?h2t.decode(t.range):t.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}var b2t=(()=>{class t extends p2t{constructor(){super(),this.map={"xdr:twoCellAnchor":new m2t,"xdr:oneCellAnchor":new g2t}}prepare(i){i.anchors.forEach((r,n)=>{r.anchorType=v2t(r),this.map[r.anchorType].prepare(r,{index:n})})}get tag(){return"xdr:wsDr"}render(i,r){i.openXml(f2t.StdDocAttributes),i.openNode(this.tag,t.DRAWING_ATTRIBUTES),r.anchors.forEach(n=>{this.map[n.anchorType].render(i,n)}),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[i.name],this.parser&&this.parser.parseOpen(i);break}return!0}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(i){case this.tag:return!1;default:return!0}}reconcile(i,r){i.anchors.forEach(n=>{n.br?this.map["xdr:twoCellAnchor"].reconcile(n,r):this.map["xdr:oneCellAnchor"].reconcile(n,r)})}}return t.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},t})();SLe.exports=b2t});var RLe=z((AQi,TLe)=>{"use strict";var _2t=mt(),Lie=class extends _2t{get tag(){return"customFilter"}render(e,i){e.leafNode(this.tag,{val:i.val,operator:i.operator})}parseOpen(e){return e.name===this.tag?(this.model={val:e.attributes.val,operator:e.attributes.operator},!0):!1}parseText(){}parseClose(){return!1}};TLe.exports=Lie});var ILe=z((IQi,ALe)=>{"use strict";var y2t=mt(),Fie=class extends y2t{get tag(){return"filter"}render(e,i){e.leafNode(this.tag,{val:i.val})}parseOpen(e){return e.name===this.tag?(this.model={val:e.attributes.val},!0):!1}parseText(){}parseClose(){return!1}};ALe.exports=Fie});var kLe=z((DQi,MLe)=>{"use strict";var w2t=mt(),DLe=r0(),C2t=RLe(),x2t=ILe(),Hie=class extends w2t{constructor(){super(),this.map={customFilters:new DLe({tag:"customFilters",count:!1,empty:!0,childXform:new C2t}),filters:new DLe({tag:"filters",count:!1,empty:!0,childXform:new x2t})}}get tag(){return"filterColumn"}prepare(e,i){e.colId=i.index.toString()}render(e,i){return i.customFilters?(e.openNode(this.tag,{colId:i.colId,hiddenButton:i.filterButton?"0":"1"}),this.map.customFilters.render(e,i.customFilters),e.closeNode(),!0):(e.leafNode(this.tag,{colId:i.colId,hiddenButton:i.filterButton?"0":"1"}),!0)}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;let{attributes:i}=e;switch(e.name){case this.tag:return this.model={filterButton:i.hiddenButton==="0"},!0;default:if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}};MLe.exports=Hie});var NLe=z((MQi,OLe)=>{"use strict";var S2t=mt(),E2t=kLe(),Bie=class extends S2t{constructor(){super(),this.map={filterColumn:new E2t}}get tag(){return"autoFilter"}prepare(e){e.columns.forEach((i,r)=>{this.map.filterColumn.prepare(i,{index:r})})}render(e,i){return e.openNode(this.tag,{ref:i.autoFilterRef}),i.columns.forEach(r=>{this.map.filterColumn.render(e,r)}),e.closeNode(),!0}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:return this.model={autoFilterRef:e.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(e){case this.tag:return!1;default:throw new Error(`Unexpected xml node in parseClose: ${e}`)}}};OLe.exports=Bie});var LLe=z((kQi,PLe)=>{"use strict";var T2t=mt(),Vie=class extends T2t{get tag(){return"tableColumn"}prepare(e,i){e.id=i.index+1}render(e,i){return e.leafNode(this.tag,{id:i.id.toString(),name:i.name,totalsRowLabel:i.totalsRowLabel,totalsRowFunction:i.totalsRowFunction,dxfId:i.dxfId}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:i}=e;return this.model={name:i.name,totalsRowLabel:i.totalsRowLabel,totalsRowFunction:i.totalsRowFunction,dxfId:i.dxfId},!0}return!1}parseText(){}parseClose(){return!1}};PLe.exports=Vie});var HLe=z((OQi,FLe)=>{"use strict";var R2t=mt(),jie=class extends R2t{get tag(){return"tableStyleInfo"}render(e,i){return e.leafNode(this.tag,{name:i.theme?i.theme:void 0,showFirstColumn:i.showFirstColumn?"1":"0",showLastColumn:i.showLastColumn?"1":"0",showRowStripes:i.showRowStripes?"1":"0",showColumnStripes:i.showColumnStripes?"1":"0"}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:i}=e;return this.model={theme:i.name?i.name:null,showFirstColumn:i.showFirstColumn==="1",showLastColumn:i.showLastColumn==="1",showRowStripes:i.showRowStripes==="1",showColumnStripes:i.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}};FLe.exports=jie});var VLe=z((NQi,BLe)=>{"use strict";var A2t=Ha(),I2t=mt(),D2t=r0(),M2t=NLe(),k2t=LLe(),O2t=HLe(),N2t=(()=>{class t extends I2t{constructor(){super(),this.map={autoFilter:new M2t,tableColumns:new D2t({tag:"tableColumns",count:!0,empty:!0,childXform:new k2t}),tableStyleInfo:new O2t}}prepare(i,r){this.map.autoFilter.prepare(i),this.map.tableColumns.prepare(i.columns,r)}get tag(){return"table"}render(i,r){i.openXml(A2t.StdDocAttributes),i.openNode(this.tag,Lt(Ke({},t.TABLE_ATTRIBUTES),{id:r.id,name:r.name,displayName:r.displayName||r.name,ref:r.tableRef,totalsRowCount:r.totalsRow?"1":void 0,totalsRowShown:r.totalsRow?void 0:"1",headerRowCount:r.headerRow?"1":"0"})),this.map.autoFilter.render(i,r),this.map.tableColumns.render(i,r.columns),this.map.tableStyleInfo.render(i,r.style),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;let{name:r,attributes:n}=i;switch(r){case this.tag:this.reset(),this.model={name:n.name,displayName:n.displayName||n.name,tableRef:n.ref,totalsRow:n.totalsRowCount==="1",headerRow:n.headerRowCount==="1"};break;default:this.parser=this.map[i.name],this.parser&&this.parser.parseOpen(i);break}return!0}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((r,n)=>{this.model.columns[n].filterButton=r.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(i,r){i.columns.forEach(n=>{n.dxfId!==void 0&&(n.style=r.styles.getDxfStyle(n.dxfId))})}}return t.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},t})();BLe.exports=N2t});var zie=z((LQi,jLe)=>{"use strict";var P2t=X2(),L2t=yl(),F2t=mt(),H2t=jLe.exports=function(t){this.model=t};L2t.inherits(H2t,F2t,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new P2t),this._richTextXform},render(t,e){e=e||this.model,t.openNode("comment",{ref:e.ref,authorId:0}),t.openNode("text"),e&&e.note&&e.note.texts&&e.note.texts.forEach(i=>{this.richTextXform.render(t,i)}),t.closeNode(),t.closeNode()},parseOpen(t){if(this.parser)return this.parser.parseOpen(t),!0;switch(t.name){case"comment":return this.model=Ke({type:"note",note:{texts:[]}},t.attributes),!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(t),!0;default:return!1}},parseText(t){this.parser&&this.parser.parseText(t)},parseClose(t){switch(t){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(t),!0}}})});var ULe=z((HQi,WLe)=>{"use strict";var B2t=Ha(),V2t=yl(),j2t=mt(),z2t=zie(),zLe=WLe.exports=function(){this.map={comment:new z2t}};V2t.inherits(zLe,j2t,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(t,e){e=e||this.model,t.openXml(B2t.StdDocAttributes),t.openNode("comments",zLe.COMMENTS_ATTRIBUTES),t.openNode("authors"),t.leafNode("author",null,"Author"),t.closeNode(),t.openNode("commentList"),e.comments.forEach(i=>{this.map.comment.render(t,i)}),t.closeNode(),t.closeNode()},parseOpen(t){if(this.parser)return this.parser.parseOpen(t),!0;switch(t.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(t),!0;default:return!1}},parseText(t){this.parser&&this.parser.parseText(t)},parseClose(t){switch(t){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(t),!0}}})});var YLe=z((BQi,qLe)=>{"use strict";var W2t=mt(),Wie=class extends W2t{get tag(){return"v:textbox"}conversionUnit(e,i,r){return`${parseFloat(e)*i.toFixed(2)}${r}`}reverseConversionUnit(e){return(e||"").split(",").map(i=>Number(parseFloat(this.conversionUnit(parseFloat(i),.1,"")).toFixed(2)))}render(e,i){let r={style:"mso-direction-alt:auto"};if(i&&i.note){let{inset:n}=i.note&&i.note.margins;Array.isArray(n)&&(n=n.map(o=>this.conversionUnit(o,10,"mm")).join(",")),n&&(r.inset=n)}e.openNode("v:textbox",r),e.leafNode("div",{style:"text-align:left"}),e.closeNode()}parseOpen(e){switch(e.name){case this.tag:return this.model={inset:this.reverseConversionUnit(e.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(e){switch(e){case this.tag:return!1;default:return!0}}};qLe.exports=Wie});var GLe=z((VQi,$Le)=>{"use strict";var U2t=mt(),Uie=class extends U2t{get tag(){return"x:Anchor"}getAnchorRect(e){let i=Math.floor(e.left),r=Math.floor((e.left-i)*68),n=Math.floor(e.top),o=Math.floor((e.top-n)*18),s=Math.floor(e.right),a=Math.floor((e.right-s)*68),c=Math.floor(e.bottom),d=Math.floor((e.bottom-c)*18);return[i,r,n,o,s,a,c,d]}getDefaultRect(e){let i=e.col,r=6,n=Math.max(e.row-2,0),o=14,s=i+2,a=2,c=n+4;return[i,r,n,o,s,a,c,16]}render(e,i){let r=i.anchor?this.getAnchorRect(i.anchor):this.getDefaultRect(i.refAddress);e.leafNode("x:Anchor",null,r.join(", "))}parseOpen(e){switch(e.name){case this.tag:return this.text="",!0;default:return!1}}parseText(e){this.text=e}parseClose(){return!1}};$Le.exports=Uie});var KLe=z((jQi,XLe)=>{"use strict";var q2t=mt(),qie=class extends q2t{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,i){e.leafNode(this.tag,null,i)}parseOpen(e){switch(e.name){case this.tag:return this.text="",!0;default:return!1}}parseText(e){this.text=e}parseClose(){return!1}};XLe.exports=qie});var QLe=z((zQi,ZLe)=>{"use strict";var Y2t=mt(),Yie=class extends Y2t{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,i,r){i===r[2]?e.leafNode(this.tag):this.tag==="x:SizeWithCells"&&i===r[1]&&e.leafNode(this.tag)}parseOpen(e){switch(e.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}};ZLe.exports=Yie});var iFe=z((WQi,tFe)=>{"use strict";var $2t=mt(),G2t=GLe(),JLe=KLe(),eFe=QLe(),$ie=["twoCells","oneCells","absolute"],Gie=class extends $2t{constructor(){super(),this.map={"x:Anchor":new G2t,"x:Locked":new JLe({tag:"x:Locked"}),"x:LockText":new JLe({tag:"x:LockText"}),"x:SizeWithCells":new eFe({tag:"x:SizeWithCells"}),"x:MoveWithCells":new eFe({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(e,i){let{protection:r,editAs:n}=i.note;e.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(e,n,$ie),this.map["x:SizeWithCells"].render(e,n,$ie),this.map["x:Anchor"].render(e,i),this.map["x:Locked"].render(e,r.locked),e.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(e,r.lockText),e.leafNode("x:Row",null,i.refAddress.row-1),e.leafNode("x:Column",null,i.refAddress.col-1),e.closeNode()}parseOpen(e){switch(e.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){let e=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),i=Object.keys(e).length;this.model.editAs=$ie[i],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}};tFe.exports=Gie});var Xie=z((UQi,rFe)=>{"use strict";var X2t=mt(),K2t=YLe(),Z2t=iFe(),Q2t=(()=>{class t extends X2t{constructor(){super(),this.map={"v:textbox":new K2t,"x:ClientData":new Z2t}}get tag(){return"v:shape"}render(i,r,n){i.openNode("v:shape",t.V_SHAPE_ATTRIBUTES(r,n)),i.leafNode("v:fill",{color2:"infoBackground [80]"}),i.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),i.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(i,r),this.map["x:ClientData"].render(i,r),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case this.tag:this.reset(),this.model={margins:{insetmode:i.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[i.name],this.parser&&this.parser.parseOpen(i);break}return!0}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}return t.V_SHAPE_ATTRIBUTES=(e,i)=>({id:`_x0000_s${1025+i}`,type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":e.note.margins&&e.note.margins.insetmode}),t})();rFe.exports=Q2t});var oFe=z((qQi,nFe)=>{"use strict";var J2t=Ha(),eNt=mt(),tNt=Xie(),iNt=(()=>{class t extends eNt{constructor(){super(),this.map={"v:shape":new tNt}}get tag(){return"xml"}render(i,r){i.openXml(J2t.StdDocAttributes),i.openNode(this.tag,t.DRAWING_ATTRIBUTES),i.openNode("o:shapelayout",{"v:ext":"edit"}),i.leafNode("o:idmap",{"v:ext":"edit",data:1}),i.closeNode(),i.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),i.leafNode("v:stroke",{joinstyle:"miter"}),i.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),i.closeNode(),r.comments.forEach((n,o)=>{this.map["v:shape"].render(i,n,o)}),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[i.name],this.parser&&this.parser.parseOpen(i);break}return!0}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(i){case this.tag:return!1;default:return!0}}reconcile(i,r){i.anchors.forEach(n=>{n.br?this.map["xdr:twoCellAnchor"].reconcile(n,r):this.map["xdr:oneCellAnchor"].reconcile(n,r)})}}return t.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},t})();nFe.exports=iNt});var Kie=z((YQi,sFe)=>{"use strict";sFe.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/> <a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/> <a:font script="Hans" typeface="\u5B8B\u4F53"/> <a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/> <a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/> <a:font script="Hans" typeface="\u5B8B\u4F53"/> <a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`});var nre=z(($Qi,uFe)=>{"use strict";var rre=Ze("fs"),rNt=lJ(),{PassThrough:Zie}=_l(),nNt=dOe(),Qie=z2(),oNt=yl(),yj=Ha(),{bufferToString:sNt}=UJ(),Jie=sj(),aFe=Nee(),ere=Bee(),Iw=lj(),aNt=jee(),lFe=Uee(),wj=cj(),Cj=ZPe(),tre=ELe(),ire=VLe(),cFe=ULe(),dFe=oFe(),lNt=Kie();function cNt(t,e){return new Promise((i,r)=>{rre.readFile(t,e,(n,o)=>{n?r(n):i(o)})})}var xj=class t{constructor(e){this.workbook=e}readFile(e,i){return Ei(this,null,function*(){if(!(yield oNt.fs.exists(e)))throw new Error(`File not found: ${e}`);let r=rre.createReadStream(e);try{let n=yield this.read(r,i);return r.close(),n}catch(n){throw r.close(),n}})}parseRels(e){return new Iw().parseStream(e)}parseWorkbook(e){return new wj().parseStream(e)}parseSharedStrings(e){return new ere().parseStream(e)}reconcile(e,i){let r=new wj,n=new Cj(i),o=new tre,s=new ire;r.reconcile(e);let a={media:e.media,mediaIndex:e.mediaIndex};Object.keys(e.drawings).forEach(u=>{let h=e.drawings[u],p=e.drawingRels[u];p&&(a.rels=p.reduce((f,m)=>(f[m.Id]=m,f),{}),(h.anchors||[]).forEach(f=>{let m=f.picture&&f.picture.hyperlinks;m&&a.rels[m.rId]&&(m.hyperlink=a.rels[m.rId].Target,delete m.rId)}),o.reconcile(h,a))});let c={styles:e.styles};Object.values(e.tables).forEach(u=>{s.reconcile(u,c)});let d={styles:e.styles,sharedStrings:e.sharedStrings,media:e.media,mediaIndex:e.mediaIndex,date1904:e.properties&&e.properties.date1904,drawings:e.drawings,comments:e.comments,tables:e.tables,vmlDrawings:e.vmlDrawings};e.worksheets.forEach(u=>{u.relationships=e.worksheetRels[u.sheetNo],n.reconcile(u,d)}),delete e.worksheetHash,delete e.worksheetRels,delete e.globalRels,delete e.sharedStrings,delete e.workbookRels,delete e.sheetDefs,delete e.styles,delete e.mediaIndex,delete e.drawings,delete e.drawingRels,delete e.vmlDrawings}_processWorksheetEntry(e,i,r,n,o){return Ei(this,null,function*(){let a=yield new Cj(n).parseStream(e);a.sheetNo=r,i.worksheetHash[o]=a,i.worksheets.push(a)})}_processCommentEntry(e,i,r){return Ei(this,null,function*(){let o=yield new cFe().parseStream(e);i.comments[`../${r}.xml`]=o})}_processTableEntry(e,i,r){return Ei(this,null,function*(){let o=yield new ire().parseStream(e);i.tables[`../tables/${r}.xml`]=o})}_processWorksheetRelsEntry(e,i,r){return Ei(this,null,function*(){let o=yield new Iw().parseStream(e);i.worksheetRels[r]=o})}_processMediaEntry(e,i,r){return Ei(this,null,function*(){let n=r.lastIndexOf(".");if(n>=1){let o=r.substr(n+1),s=r.substr(0,n);yield new Promise((a,c)=>{let d=new Qie;d.on("finish",()=>{i.mediaIndex[r]=i.media.length,i.mediaIndex[s]=i.media.length;let u={type:"image",name:s,extension:o,buffer:d.toBuffer()};i.media.push(u),a()}),e.on("error",u=>{c(u)}),e.pipe(d)})}})}_processDrawingEntry(e,i,r){return Ei(this,null,function*(){let o=yield new tre().parseStream(e);i.drawings[r]=o})}_processDrawingRelsEntry(e,i,r){return Ei(this,null,function*(){let o=yield new Iw().parseStream(e);i.drawingRels[r]=o})}_processVmlDrawingEntry(e,i,r){return Ei(this,null,function*(){let o=yield new dFe().parseStream(e);i.vmlDrawings[`../drawings/${r}.vml`]=o})}_processThemeEntry(e,i,r){return Ei(this,null,function*(){yield new Promise((n,o)=>{let s=new Qie;e.on("error",o),s.on("error",o),s.on("finish",()=>{i.themes[r]=s.read().toString(),n()}),e.pipe(s)})})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}read(e,i){return Ei(this,null,function*(){!e[Symbol.asyncIterator]&&e.pipe&&(e=e.pipe(new Zie));let r=[];try{for(var n=Ea(e),o,s,a;o=!(s=yield n.next()).done;o=!1){let c=s.value;r.push(c)}}catch{a=[s]}finally{try{o&&(s=n.return)&&(yield s.call(n))}finally{if(a)throw a[0]}}return this.load(Buffer.concat(r),i)})}load(e,i){return Ei(this,null,function*(){let r;i&&i.base64?r=Buffer.from(e.toString(),"base64"):r=e;let n={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},o=yield rNt.loadAsync(r);for(let s of Object.values(o.files))if(!s.dir){let a=s.name;a[0]==="/"&&(a=a.substr(1));let c;if(a.match(/xl\/media\//)||a.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))c=new Zie,c.write(yield s.async("nodebuffer"));else{c=new Zie({writableObjectMode:!0,readableObjectMode:!0});let d;process.browser?d=sNt(yield s.async("nodebuffer")):d=yield s.async("string");let u=16*1024;for(let h=0;h<d.length;h+=u)c.write(d.substring(h,h+u))}switch(c.end(),a){case"_rels/.rels":n.globalRels=yield this.parseRels(c);break;case"xl/workbook.xml":{let d=yield this.parseWorkbook(c);n.sheets=d.sheets,n.definedNames=d.definedNames,n.views=d.views,n.properties=d.properties,n.calcProperties=d.calcProperties;break}case"xl/_rels/workbook.xml.rels":n.workbookRels=yield this.parseRels(c);break;case"xl/sharedStrings.xml":n.sharedStrings=new ere,yield n.sharedStrings.parseStream(c);break;case"xl/styles.xml":n.styles=new Jie,yield n.styles.parseStream(c);break;case"docProps/app.xml":{let u=yield new lFe().parseStream(c);n.company=u.company,n.manager=u.manager;break}case"docProps/core.xml":{let u=yield new aFe().parseStream(c);Object.assign(n,u);break}default:{let d=a.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(d){yield this._processWorksheetEntry(c,n,d[1],i,a);break}if(d=a.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),d){yield this._processWorksheetRelsEntry(c,n,d[1]);break}if(d=a.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),d){yield this._processThemeEntry(c,n,d[1]);break}if(d=a.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),d){yield this._processMediaEntry(c,n,d[1]);break}if(d=a.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),d){yield this._processDrawingEntry(c,n,d[1]);break}if(d=a.match(/xl\/(comments\d+)[.]xml/),d){yield this._processCommentEntry(c,n,d[1]);break}if(d=a.match(/xl\/tables\/(table\d+)[.]xml/),d){yield this._processTableEntry(c,n,d[1]);break}if(d=a.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),d){yield this._processDrawingRelsEntry(c,n,d[1]);break}if(d=a.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),d){yield this._processVmlDrawingEntry(c,n,d[1]);break}}}}return this.reconcile(n,i),this.workbook.model=n,this.workbook})}addMedia(e,i){return Ei(this,null,function*(){yield Promise.all(i.media.map(r=>Ei(this,null,function*(){if(r.type==="image"){let n=`xl/media/${r.name}.${r.extension}`;if(r.filename){let o=yield cNt(r.filename);return e.append(o,{name:n})}if(r.buffer)return e.append(r.buffer,{name:n});if(r.base64){let o=r.base64,s=o.substring(o.indexOf(",")+1);return e.append(s,{name:n,base64:!0})}}throw new Error("Unsupported media")})))})}addDrawings(e,i){let r=new tre,n=new Iw;i.worksheets.forEach(o=>{let{drawing:s}=o;if(s){r.prepare(s,{});let a=r.toXml(s);e.append(a,{name:`xl/drawings/${s.name}.xml`}),a=n.toXml(s.rels),e.append(a,{name:`xl/drawings/_rels/${s.name}.xml.rels`})}})}addTables(e,i){let r=new ire;i.worksheets.forEach(n=>{let{tables:o}=n;o.forEach(s=>{r.prepare(s,{});let a=r.toXml(s);e.append(a,{name:`xl/tables/${s.target}`})})})}addContentTypes(e,i){return Ei(this,null,function*(){let n=new aNt().toXml(i);e.append(n,{name:"[Content_Types].xml"})})}addApp(e,i){return Ei(this,null,function*(){let n=new lFe().toXml(i);e.append(n,{name:"docProps/app.xml"})})}addCore(e,i){return Ei(this,null,function*(){let r=new aFe;e.append(r.toXml(i),{name:"docProps/core.xml"})})}addThemes(e,i){return Ei(this,null,function*(){let r=i.themes||{theme1:lNt};Object.keys(r).forEach(n=>{let o=r[n],s=`xl/theme/${n}.xml`;e.append(o,{name:s})})})}addOfficeRels(e){return Ei(this,null,function*(){let r=new Iw().toXml([{Id:"rId1",Type:t.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:t.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:t.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);e.append(r,{name:"_rels/.rels"})})}addWorkbookRels(e,i){return Ei(this,null,function*(){let r=1,n=[{Id:`rId${r++}`,Type:t.RelType.Styles,Target:"styles.xml"},{Id:`rId${r++}`,Type:t.RelType.Theme,Target:"theme/theme1.xml"}];i.sharedStrings.count&&n.push({Id:`rId${r++}`,Type:t.RelType.SharedStrings,Target:"sharedStrings.xml"}),i.worksheets.forEach(a=>{a.rId=`rId${r++}`,n.push({Id:a.rId,Type:t.RelType.Worksheet,Target:`worksheets/sheet${a.id}.xml`})});let s=new Iw().toXml(n);e.append(s,{name:"xl/_rels/workbook.xml.rels"})})}addSharedStrings(e,i){return Ei(this,null,function*(){i.sharedStrings&&i.sharedStrings.count&&e.append(i.sharedStrings.xml,{name:"xl/sharedStrings.xml"})})}addStyles(e,i){return Ei(this,null,function*(){let{xml:r}=i.styles;r&&e.append(r,{name:"xl/styles.xml"})})}addWorkbook(e,i){return Ei(this,null,function*(){let r=new wj;e.append(r.toXml(i),{name:"xl/workbook.xml"})})}addWorksheets(e,i){return Ei(this,null,function*(){let r=new Cj,n=new Iw,o=new cFe,s=new dFe;i.worksheets.forEach(a=>{let c=new yj;r.render(c,a),e.append(c.xml,{name:`xl/worksheets/sheet${a.id}.xml`}),a.rels&&a.rels.length&&(c=new yj,n.render(c,a.rels),e.append(c.xml,{name:`xl/worksheets/_rels/sheet${a.id}.xml.rels`})),a.comments.length>0&&(c=new yj,o.render(c,a),e.append(c.xml,{name:`xl/comments${a.id}.xml`}),c=new yj,s.render(c,a),e.append(c.xml,{name:`xl/drawings/vmlDrawing${a.id}.vml`}))})})}_finalize(e){return new Promise((i,r)=>{e.on("finish",()=>{i(this)}),e.on("error",r),e.finalize()})}prepareModel(e,i){e.creator=e.creator||"ExcelJS",e.lastModifiedBy=e.lastModifiedBy||"ExcelJS",e.created=e.created||new Date,e.modified=e.modified||new Date,e.useSharedStrings=i.useSharedStrings!==void 0?i.useSharedStrings:!0,e.useStyles=i.useStyles!==void 0?i.useStyles:!0,e.sharedStrings=new ere,e.styles=e.useStyles?new Jie(!0):new Jie.Mock;let r=new wj,n=new Cj;r.prepare(e);let o={sharedStrings:e.sharedStrings,styles:e.styles,date1904:e.properties.date1904,drawingsCount:0,media:e.media};o.drawings=e.drawings=[],o.commentRefs=e.commentRefs=[];let s=0;e.tables=[],e.worksheets.forEach(a=>{a.tables.forEach(c=>{s++,c.target=`table${s}.xml`,c.id=s,e.tables.push(c)}),n.prepare(a,o)})}write(e,i){return Ei(this,null,function*(){i=i||{};let{model:r}=this.workbook,n=new nNt.ZipWriter(i.zip);return n.pipe(e),this.prepareModel(r,i),yield this.addContentTypes(n,r),yield this.addOfficeRels(n,r),yield this.addWorkbookRels(n,r),yield this.addWorksheets(n,r),yield this.addSharedStrings(n,r),yield this.addDrawings(n,r),yield this.addTables(n,r),yield Promise.all([this.addThemes(n,r),this.addStyles(n,r)]),yield this.addMedia(n,r),yield Promise.all([this.addApp(n,r),this.addCore(n,r)]),yield this.addWorkbook(n,r),this._finalize(n)})}writeFile(e,i){let r=rre.createWriteStream(e);return new Promise((n,o)=>{r.on("finish",()=>{n()}),r.on("error",s=>{o(s)}),this.write(r,i).then(()=>{r.end()}).catch(s=>{o(s)})})}writeBuffer(e){return Ei(this,null,function*(){let i=new Qie;return yield this.write(i,e),i.read()})}};xj.RelType=s0();uFe.exports=xj});var sre=z(Sj=>{"use strict";Object.defineProperty(Sj,"__esModule",{value:!0});Sj.FormatterOptions=void 0;var ore=class{constructor(e={}){var i;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,e||{}),typeof e?.quoteHeaders>"u"&&(this.quoteHeaders=this.quoteColumns),e?.quote===!0?this.quote='"':e?.quote===!1&&(this.quote=""),typeof e?.escape!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((i=e.writeHeaders)!==null&&i!==void 0?i:!0),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}};Sj.FormatterOptions=ore});var Ej=z((KQi,mFe)=>{"use strict";var dNt="[object AsyncFunction]",uNt="[object Function]",hNt="[object GeneratorFunction]",fNt="[object Null]",pNt="[object Proxy]",mNt="[object Undefined]",gNt=typeof global=="object"&&global&&global.Object===Object&&global,vNt=typeof self=="object"&&self&&self.Object===Object&&self,bNt=gNt||vNt||Function("return this")(),fFe=Object.prototype,_Nt=fFe.hasOwnProperty,pFe=fFe.toString,hFe=bNt.Symbol,Dw=hFe?hFe.toStringTag:void 0;function yNt(t){return t==null?t===void 0?mNt:fNt:Dw&&Dw in Object(t)?wNt(t):CNt(t)}function wNt(t){var e=_Nt.call(t,Dw),i=t[Dw];try{t[Dw]=void 0;var r=!0}catch{}var n=pFe.call(t);return r&&(e?t[Dw]=i:delete t[Dw]),n}function CNt(t){return pFe.call(t)}function xNt(t){if(!SNt(t))return!1;var e=yNt(t);return e==uNt||e==hNt||e==dNt||e==pNt}function SNt(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}mFe.exports=xNt});var KFe=z((tN,KE)=>{"use strict";var ENt=200,vre="__lodash_hash_undefined__",Oj=1,RFe=2,AFe=9007199254740991,Tj="[object Arguments]",dre="[object Array]",TNt="[object AsyncFunction]",IFe="[object Boolean]",DFe="[object Date]",MFe="[object Error]",kFe="[object Function]",RNt="[object GeneratorFunction]",Rj="[object Map]",OFe="[object Number]",ANt="[object Null]",XE="[object Object]",gFe="[object Promise]",INt="[object Proxy]",NFe="[object RegExp]",Aj="[object Set]",PFe="[object String]",DNt="[object Symbol]",MNt="[object Undefined]",ure="[object WeakMap]",LFe="[object ArrayBuffer]",Ij="[object DataView]",kNt="[object Float32Array]",ONt="[object Float64Array]",NNt="[object Int8Array]",PNt="[object Int16Array]",LNt="[object Int32Array]",FNt="[object Uint8Array]",HNt="[object Uint8ClampedArray]",BNt="[object Uint16Array]",VNt="[object Uint32Array]",jNt=/[\\^$.*+?()[\]{}|]/g,zNt=/^\[object .+?Constructor\]$/,WNt=/^(?:0|[1-9]\d*)$/,so={};so[kNt]=so[ONt]=so[NNt]=so[PNt]=so[LNt]=so[FNt]=so[HNt]=so[BNt]=so[VNt]=!0;so[Tj]=so[dre]=so[LFe]=so[IFe]=so[Ij]=so[DFe]=so[MFe]=so[kFe]=so[Rj]=so[OFe]=so[XE]=so[NFe]=so[Aj]=so[PFe]=so[ure]=!1;var FFe=typeof global=="object"&&global&&global.Object===Object&&global,UNt=typeof self=="object"&&self&&self.Object===Object&&self,ig=FFe||UNt||Function("return this")(),HFe=typeof tN=="object"&&tN&&!tN.nodeType&&tN,vFe=HFe&&typeof KE=="object"&&KE&&!KE.nodeType&&KE,BFe=vFe&&vFe.exports===HFe,are=BFe&&FFe.process,bFe=function(){try{return are&&are.binding&&are.binding("util")}catch{}}(),_Fe=bFe&&bFe.isTypedArray;function qNt(t,e){for(var i=-1,r=t==null?0:t.length,n=0,o=[];++i<r;){var s=t[i];e(s,i,t)&&(o[n++]=s)}return o}function YNt(t,e){for(var i=-1,r=e.length,n=t.length;++i<r;)t[n+i]=e[i];return t}function $Nt(t,e){for(var i=-1,r=t==null?0:t.length;++i<r;)if(e(t[i],i,t))return!0;return!1}function GNt(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r}function XNt(t){return function(e){return t(e)}}function KNt(t,e){return t.has(e)}function ZNt(t,e){return t?.[e]}function QNt(t){var e=-1,i=Array(t.size);return t.forEach(function(r,n){i[++e]=[n,r]}),i}function JNt(t,e){return function(i){return t(e(i))}}function ePt(t){var e=-1,i=Array(t.size);return t.forEach(function(r){i[++e]=r}),i}var tPt=Array.prototype,iPt=Function.prototype,Nj=Object.prototype,lre=ig["__core-js_shared__"],VFe=iPt.toString,bp=Nj.hasOwnProperty,yFe=function(){var t=/[^.]+$/.exec(lre&&lre.keys&&lre.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),jFe=Nj.toString,rPt=RegExp("^"+VFe.call(bp).replace(jNt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wFe=BFe?ig.Buffer:void 0,Dj=ig.Symbol,CFe=ig.Uint8Array,zFe=Nj.propertyIsEnumerable,nPt=tPt.splice,Mw=Dj?Dj.toStringTag:void 0,xFe=Object.getOwnPropertySymbols,oPt=wFe?wFe.isBuffer:void 0,sPt=JNt(Object.keys,Object),hre=ZE(ig,"DataView"),iN=ZE(ig,"Map"),fre=ZE(ig,"Promise"),pre=ZE(ig,"Set"),mre=ZE(ig,"WeakMap"),rN=ZE(Object,"create"),aPt=Nw(hre),lPt=Nw(iN),cPt=Nw(fre),dPt=Nw(pre),uPt=Nw(mre),SFe=Dj?Dj.prototype:void 0,cre=SFe?SFe.valueOf:void 0;function kw(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function hPt(){this.__data__=rN?rN(null):{},this.size=0}function fPt(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function pPt(t){var e=this.__data__;if(rN){var i=e[t];return i===vre?void 0:i}return bp.call(e,t)?e[t]:void 0}function mPt(t){var e=this.__data__;return rN?e[t]!==void 0:bp.call(e,t)}function gPt(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=rN&&e===void 0?vre:e,this}kw.prototype.clear=hPt;kw.prototype.delete=fPt;kw.prototype.get=pPt;kw.prototype.has=mPt;kw.prototype.set=gPt;function rg(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function vPt(){this.__data__=[],this.size=0}function bPt(t){var e=this.__data__,i=Pj(e,t);if(i<0)return!1;var r=e.length-1;return i==r?e.pop():nPt.call(e,i,1),--this.size,!0}function _Pt(t){var e=this.__data__,i=Pj(e,t);return i<0?void 0:e[i][1]}function yPt(t){return Pj(this.__data__,t)>-1}function wPt(t,e){var i=this.__data__,r=Pj(i,t);return r<0?(++this.size,i.push([t,e])):i[r][1]=e,this}rg.prototype.clear=vPt;rg.prototype.delete=bPt;rg.prototype.get=_Pt;rg.prototype.has=yPt;rg.prototype.set=wPt;function Ow(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function CPt(){this.size=0,this.__data__={hash:new kw,map:new(iN||rg),string:new kw}}function xPt(t){var e=Lj(this,t).delete(t);return this.size-=e?1:0,e}function SPt(t){return Lj(this,t).get(t)}function EPt(t){return Lj(this,t).has(t)}function TPt(t,e){var i=Lj(this,t),r=i.size;return i.set(t,e),this.size+=i.size==r?0:1,this}Ow.prototype.clear=CPt;Ow.prototype.delete=xPt;Ow.prototype.get=SPt;Ow.prototype.has=EPt;Ow.prototype.set=TPt;function Mj(t){var e=-1,i=t==null?0:t.length;for(this.__data__=new Ow;++e<i;)this.add(t[e])}function RPt(t){return this.__data__.set(t,vre),this}function APt(t){return this.__data__.has(t)}Mj.prototype.add=Mj.prototype.push=RPt;Mj.prototype.has=APt;function u0(t){var e=this.__data__=new rg(t);this.size=e.size}function IPt(){this.__data__=new rg,this.size=0}function DPt(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}function MPt(t){return this.__data__.get(t)}function kPt(t){return this.__data__.has(t)}function OPt(t,e){var i=this.__data__;if(i instanceof rg){var r=i.__data__;if(!iN||r.length<ENt-1)return r.push([t,e]),this.size=++i.size,this;i=this.__data__=new Ow(r)}return i.set(t,e),this.size=i.size,this}u0.prototype.clear=IPt;u0.prototype.delete=DPt;u0.prototype.get=MPt;u0.prototype.has=kPt;u0.prototype.set=OPt;function NPt(t,e){var i=kj(t),r=!i&&XPt(t),n=!i&&!r&&gre(t),o=!i&&!r&&!n&&XFe(t),s=i||r||n||o,a=s?GNt(t.length,String):[],c=a.length;for(var d in t)(e||bp.call(t,d))&&!(s&&(d=="length"||n&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||UPt(d,c)))&&a.push(d);return a}function Pj(t,e){for(var i=t.length;i--;)if(qFe(t[i][0],e))return i;return-1}function PPt(t,e,i){var r=e(t);return kj(t)?r:YNt(r,i(t))}function oN(t){return t==null?t===void 0?MNt:ANt:Mw&&Mw in Object(t)?zPt(t):GPt(t)}function EFe(t){return nN(t)&&oN(t)==Tj}function WFe(t,e,i,r,n){return t===e?!0:t==null||e==null||!nN(t)&&!nN(e)?t!==t&&e!==e:LPt(t,e,i,r,WFe,n)}function LPt(t,e,i,r,n,o){var s=kj(t),a=kj(e),c=s?dre:d0(t),d=a?dre:d0(e);c=c==Tj?XE:c,d=d==Tj?XE:d;var u=c==XE,h=d==XE,p=c==d;if(p&&gre(t)){if(!gre(e))return!1;s=!0,u=!1}if(p&&!u)return o||(o=new u0),s||XFe(t)?UFe(t,e,i,r,n,o):VPt(t,e,c,i,r,n,o);if(!(i&Oj)){var f=u&&bp.call(t,"__wrapped__"),m=h&&bp.call(e,"__wrapped__");if(f||m){var g=f?t.value():t,y=m?e.value():e;return o||(o=new u0),n(g,y,i,r,o)}}return p?(o||(o=new u0),jPt(t,e,i,r,n,o)):!1}function FPt(t){if(!GFe(t)||YPt(t))return!1;var e=YFe(t)?rPt:zNt;return e.test(Nw(t))}function HPt(t){return nN(t)&&$Fe(t.length)&&!!so[oN(t)]}function BPt(t){if(!$Pt(t))return sPt(t);var e=[];for(var i in Object(t))bp.call(t,i)&&i!="constructor"&&e.push(i);return e}function UFe(t,e,i,r,n,o){var s=i&Oj,a=t.length,c=e.length;if(a!=c&&!(s&&c>a))return!1;var d=o.get(t);if(d&&o.get(e))return d==e;var u=-1,h=!0,p=i&RFe?new Mj:void 0;for(o.set(t,e),o.set(e,t);++u<a;){var f=t[u],m=e[u];if(r)var g=s?r(m,f,u,e,t,o):r(f,m,u,t,e,o);if(g!==void 0){if(g)continue;h=!1;break}if(p){if(!$Nt(e,function(y,w){if(!KNt(p,w)&&(f===y||n(f,y,i,r,o)))return p.push(w)})){h=!1;break}}else if(!(f===m||n(f,m,i,r,o))){h=!1;break}}return o.delete(t),o.delete(e),h}function VPt(t,e,i,r,n,o,s){switch(i){case Ij:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case LFe:return!(t.byteLength!=e.byteLength||!o(new CFe(t),new CFe(e)));case IFe:case DFe:case OFe:return qFe(+t,+e);case MFe:return t.name==e.name&&t.message==e.message;case NFe:case PFe:return t==e+"";case Rj:var a=QNt;case Aj:var c=r&Oj;if(a||(a=ePt),t.size!=e.size&&!c)return!1;var d=s.get(t);if(d)return d==e;r|=RFe,s.set(t,e);var u=UFe(a(t),a(e),r,n,o,s);return s.delete(t),u;case DNt:if(cre)return cre.call(t)==cre.call(e)}return!1}function jPt(t,e,i,r,n,o){var s=i&Oj,a=TFe(t),c=a.length,d=TFe(e),u=d.length;if(c!=u&&!s)return!1;for(var h=c;h--;){var p=a[h];if(!(s?p in e:bp.call(e,p)))return!1}var f=o.get(t);if(f&&o.get(e))return f==e;var m=!0;o.set(t,e),o.set(e,t);for(var g=s;++h<c;){p=a[h];var y=t[p],w=e[p];if(r)var x=s?r(w,y,p,e,t,o):r(y,w,p,t,e,o);if(!(x===void 0?y===w||n(y,w,i,r,o):x)){m=!1;break}g||(g=p=="constructor")}if(m&&!g){var T=t.constructor,M=e.constructor;T!=M&&"constructor"in t&&"constructor"in e&&!(typeof T=="function"&&T instanceof T&&typeof M=="function"&&M instanceof M)&&(m=!1)}return o.delete(t),o.delete(e),m}function TFe(t){return PPt(t,QPt,WPt)}function Lj(t,e){var i=t.__data__;return qPt(e)?i[typeof e=="string"?"string":"hash"]:i.map}function ZE(t,e){var i=ZNt(t,e);return FPt(i)?i:void 0}function zPt(t){var e=bp.call(t,Mw),i=t[Mw];try{t[Mw]=void 0;var r=!0}catch{}var n=jFe.call(t);return r&&(e?t[Mw]=i:delete t[Mw]),n}var WPt=xFe?function(t){return t==null?[]:(t=Object(t),qNt(xFe(t),function(e){return zFe.call(t,e)}))}:JPt,d0=oN;(hre&&d0(new hre(new ArrayBuffer(1)))!=Ij||iN&&d0(new iN)!=Rj||fre&&d0(fre.resolve())!=gFe||pre&&d0(new pre)!=Aj||mre&&d0(new mre)!=ure)&&(d0=function(t){var e=oN(t),i=e==XE?t.constructor:void 0,r=i?Nw(i):"";if(r)switch(r){case aPt:return Ij;case lPt:return Rj;case cPt:return gFe;case dPt:return Aj;case uPt:return ure}return e});function UPt(t,e){return e=e??AFe,!!e&&(typeof t=="number"||WNt.test(t))&&t>-1&&t%1==0&&t<e}function qPt(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function YPt(t){return!!yFe&&yFe in t}function $Pt(t){var e=t&&t.constructor,i=typeof e=="function"&&e.prototype||Nj;return t===i}function GPt(t){return jFe.call(t)}function Nw(t){if(t!=null){try{return VFe.call(t)}catch{}try{return t+""}catch{}}return""}function qFe(t,e){return t===e||t!==t&&e!==e}var XPt=EFe(function(){return arguments}())?EFe:function(t){return nN(t)&&bp.call(t,"callee")&&!zFe.call(t,"callee")},kj=Array.isArray;function KPt(t){return t!=null&&$Fe(t.length)&&!YFe(t)}var gre=oPt||eLt;function ZPt(t,e){return WFe(t,e)}function YFe(t){if(!GFe(t))return!1;var e=oN(t);return e==kFe||e==RNt||e==TNt||e==INt}function $Fe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=AFe}function GFe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function nN(t){return t!=null&&typeof t=="object"}var XFe=_Fe?XNt(_Fe):HPt;function QPt(t){return KPt(t)?NPt(t):BPt(t)}function JPt(){return[]}function eLt(){return!1}KE.exports=ZPt});var QFe=z((ZQi,ZFe)=>{"use strict";var tLt="[object Boolean]",iLt=Object.prototype,rLt=iLt.toString;function nLt(t){return t===!0||t===!1||oLt(t)&&rLt.call(t)==tLt}function oLt(t){return!!t&&typeof t=="object"}ZFe.exports=nLt});var bre=z((QQi,JFe)=>{"use strict";function sLt(t){return t==null}JFe.exports=sLt});var _re=z((JQi,n5e)=>{"use strict";var aLt=1/0,lLt="[object Symbol]",r5e=/[\\^$.*+?()[\]{}|]/g,cLt=RegExp(r5e.source),dLt=typeof global=="object"&&global&&global.Object===Object&&global,uLt=typeof self=="object"&&self&&self.Object===Object&&self,hLt=dLt||uLt||Function("return this")(),fLt=Object.prototype,pLt=fLt.toString,e5e=hLt.Symbol,t5e=e5e?e5e.prototype:void 0,i5e=t5e?t5e.toString:void 0;function mLt(t){if(typeof t=="string")return t;if(vLt(t))return i5e?i5e.call(t):"";var e=t+"";return e=="0"&&1/t==-aLt?"-0":e}function gLt(t){return!!t&&typeof t=="object"}function vLt(t){return typeof t=="symbol"||gLt(t)&&pLt.call(t)==lLt}function bLt(t){return t==null?"":mLt(t)}function _Lt(t){return t=bLt(t),t&&cLt.test(t)?t.replace(r5e,"\\$&"):t}n5e.exports=_Lt});var Cre=z(QE=>{"use strict";var wre=QE&&QE.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(QE,"__esModule",{value:!0});QE.FieldFormatter=void 0;var yLt=wre(QFe()),wLt=wre(bre()),CLt=wre(_re()),yre=class{constructor(e){this._headers=null,this.formatterOptions=e,e.headers!==null&&(this.headers=e.headers),this.REPLACE_REGEXP=new RegExp(e.quote,"g");let i=`[${e.delimiter}${CLt.default(e.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(i)}set headers(e){this._headers=e}shouldQuote(e,i){let r=i?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return yLt.default(r)?r:Array.isArray(r)?r[e]:this._headers!==null?r[this._headers[e]]:!1}format(e,i,r){let n=`${wLt.default(e)?"":e}`.replace(/\0/g,""),{formatterOptions:o}=this;return o.quote!==""&&n.indexOf(o.quote)!==-1?this.quoteField(n.replace(this.REPLACE_REGEXP,o.escapedQuote)):n.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(i,r)?this.quoteField(n):n}quoteField(e){let{quote:i}=this.formatterOptions;return`${i}${e}${i}`}};QE.FieldFormatter=yre});var xre=z(Fj=>{"use strict";Object.defineProperty(Fj,"__esModule",{value:!0});Fj.isSyncTransform=void 0;Fj.isSyncTransform=t=>t.length===1});var s5e=z(JE=>{"use strict";var o5e=JE&&JE.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(JE,"__esModule",{value:!0});JE.RowFormatter=void 0;var xLt=o5e(Ej()),SLt=o5e(KFe()),ELt=Cre(),TLt=xre(),Sre=class t{constructor(e){this.rowCount=0,this.formatterOptions=e,this.fieldFormatter=new ELt.FieldFormatter(e),this.headers=e.headers,this.shouldWriteHeaders=e.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),e.transform&&(this.rowTransform=e.transform)}static isRowHashArray(e){return Array.isArray(e)?Array.isArray(e[0])&&e[0].length===2:!1}static isRowArray(e){return Array.isArray(e)&&!this.isRowHashArray(e)}static gatherHeaders(e){return t.isRowHashArray(e)?e.map(i=>i[0]):Array.isArray(e)?e:Object.keys(e)}static createTransform(e){return TLt.isSyncTransform(e)?(i,r)=>{let n=null;try{n=e(i)}catch(o){return r(o)}return r(null,n)}:(i,r)=>{e(i,r)}}set rowTransform(e){if(!xLt.default(e))throw new TypeError("The transform should be a function");this._rowTransform=t.createTransform(e)}format(e,i){this.callTransformer(e,(r,n)=>{if(r)return i(r);if(!e)return i(null);let o=[];if(n){let{shouldFormatColumns:s,headers:a}=this.checkHeaders(n);if(this.shouldWriteHeaders&&a&&!this.hasWrittenHeaders&&(o.push(this.formatColumns(a,!0)),this.hasWrittenHeaders=!0),s){let c=this.gatherColumns(n);o.push(this.formatColumns(c,!1))}}return i(null,o)})}finish(e){let i=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return e(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));i.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&i.push(this.formatterOptions.rowDelimiter),e(null,i)}checkHeaders(e){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};let i=t.gatherHeaders(e);return this.headers=i,this.fieldFormatter.headers=i,this.shouldWriteHeaders?{shouldFormatColumns:!SLt.default(i,e),headers:i}:{shouldFormatColumns:!0,headers:null}}gatherColumns(e){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(e)?t.isRowHashArray(e)?this.headers.map((i,r)=>{let n=e[r];return n?n[1]:""}):t.isRowArray(e)&&!this.shouldWriteHeaders?e:this.headers.map((i,r)=>e[r]):this.headers.map(i=>e[i])}callTransformer(e,i){return this._rowTransform?this._rowTransform(e,i):i(null,e)}formatColumns(e,i){let r=e.map((o,s)=>this.fieldFormatter.format(o,s,i)).join(this.formatterOptions.delimiter),{rowCount:n}=this;return this.rowCount+=1,n?[this.formatterOptions.rowDelimiter,r].join(""):r}};JE.RowFormatter=Sre});var a5e=z(eT=>{"use strict";Object.defineProperty(eT,"__esModule",{value:!0});eT.FieldFormatter=eT.RowFormatter=void 0;var RLt=s5e();Object.defineProperty(eT,"RowFormatter",{enumerable:!0,get:function(){return RLt.RowFormatter}});var ALt=Cre();Object.defineProperty(eT,"FieldFormatter",{enumerable:!0,get:function(){return ALt.FieldFormatter}})});var Tre=z(Hj=>{"use strict";Object.defineProperty(Hj,"__esModule",{value:!0});Hj.CsvFormatterStream=void 0;var ILt=Ze("stream"),DLt=a5e(),Ere=class extends ILt.Transform{constructor(e){super({writableObjectMode:e.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=e,this.rowFormatter=new DLt.RowFormatter(e),this.hasWrittenBOM=!e.writeBOM}transform(e){return this.rowFormatter.rowTransform=e,this}_transform(e,i,r){let n=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(e,(o,s)=>o?(n=!0,r(o)):(s&&s.forEach(a=>{this.push(Buffer.from(a,"utf8"))}),n=!0,r()))}catch(o){if(n)throw o;r(o)}}_flush(e){this.rowFormatter.finish((i,r)=>i?e(i):(r&&r.forEach(n=>{this.push(Buffer.from(n,"utf8"))}),e()))}};Hj.CsvFormatterStream=Ere});var c5e=z(Wr=>{"use strict";var l5e=Wr&&Wr.__createBinding||(Object.create?function(t,e,i,r){r===void 0&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){r===void 0&&(r=i),t[r]=e[i]}),MLt=Wr&&Wr.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kLt=Wr&&Wr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var i in t)i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)&&l5e(e,t,i);return MLt(e,t),e},OLt=Wr&&Wr.__exportStar||function(t,e){for(var i in t)i!=="default"&&!Object.prototype.hasOwnProperty.call(e,i)&&l5e(e,t,i)};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.writeToPath=Wr.writeToString=Wr.writeToBuffer=Wr.writeToStream=Wr.write=Wr.format=Wr.FormatterOptions=Wr.CsvFormatterStream=void 0;var NLt=Ze("util"),PLt=Ze("stream"),LLt=kLt(Ze("fs")),FLt=sre(),HLt=Tre();OLt(xre(),Wr);var BLt=Tre();Object.defineProperty(Wr,"CsvFormatterStream",{enumerable:!0,get:function(){return BLt.CsvFormatterStream}});var VLt=sre();Object.defineProperty(Wr,"FormatterOptions",{enumerable:!0,get:function(){return VLt.FormatterOptions}});Wr.format=t=>new HLt.CsvFormatterStream(new FLt.FormatterOptions(t));Wr.write=(t,e)=>{let i=Wr.format(e),r=NLt.promisify((n,o)=>{i.write(n,void 0,o)});return t.reduce((n,o)=>n.then(()=>r(o)),Promise.resolve()).then(()=>i.end()).catch(n=>{i.emit("error",n)}),i};Wr.writeToStream=(t,e,i)=>Wr.write(e,i).pipe(t);Wr.writeToBuffer=(t,e={})=>{let i=[],r=new PLt.Writable({write(n,o,s){i.push(n),s()}});return new Promise((n,o)=>{r.on("error",o).on("finish",()=>n(Buffer.concat(i))),Wr.write(t,e).pipe(r)})};Wr.writeToString=(t,e)=>Wr.writeToBuffer(t,e).then(i=>i.toString());Wr.writeToPath=(t,e,i)=>{let r=LLt.createWriteStream(t,{encoding:"utf8"});return Wr.write(e,i).pipe(r)}});var Are=z(tT=>{"use strict";var d5e=tT&&tT.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(tT,"__esModule",{value:!0});tT.ParserOptions=void 0;var jLt=d5e(_re()),zLt=d5e(bre()),Rre=class{constructor(e){var i;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,e||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=jLt.default(this.delimiter),this.escapeChar=(i=this.escape)!==null&&i!==void 0?i:this.quote,this.supportsComments=!zLt.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}};tT.ParserOptions=Rre});var Ire=z(iT=>{"use strict";Object.defineProperty(iT,"__esModule",{value:!0});iT.isSyncValidate=iT.isSyncTransform=void 0;iT.isSyncTransform=t=>t.length===1;iT.isSyncValidate=t=>t.length===1});var f5e=z(rT=>{"use strict";var WLt=rT&&rT.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(rT,"__esModule",{value:!0});rT.RowTransformerValidator=void 0;var u5e=WLt(Ej()),h5e=Ire(),Dre=class t{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(e){return h5e.isSyncTransform(e)?(i,r)=>{let n=null;try{n=e(i)}catch(o){return r(o)}return r(null,n)}:e}static createValidator(e){return h5e.isSyncValidate(e)?(i,r)=>{r(null,{row:i,isValid:e(i)})}:(i,r)=>{e(i,(n,o,s)=>n?r(n):o?r(null,{row:i,isValid:o,reason:s}):r(null,{row:i,isValid:!1,reason:s}))}}set rowTransform(e){if(!u5e.default(e))throw new TypeError("The transform should be a function");this._rowTransform=t.createTransform(e)}set rowValidator(e){if(!u5e.default(e))throw new TypeError("The validate should be a function");this._rowValidator=t.createValidator(e)}transformAndValidate(e,i){return this.callTransformer(e,(r,n)=>r?i(r):n?this.callValidator(n,(o,s)=>o?i(o):s&&!s.isValid?i(null,{row:n,isValid:!1,reason:s.reason}):i(null,{row:n,isValid:!0})):i(null,{row:null,isValid:!0}))}callTransformer(e,i){return this._rowTransform?this._rowTransform(e,i):i(null,e)}callValidator(e,i){return this._rowValidator?this._rowValidator(e,i):i(null,{row:e,isValid:!0})}};rT.RowTransformerValidator=Dre});var m5e=z((cJi,p5e)=>{"use strict";function ULt(t){return t===void 0}p5e.exports=ULt});var C5e=z((dJi,w5e)=>{"use strict";var qLt=200,Ore="__lodash_hash_undefined__",YLt=1/0,$Lt="[object Function]",GLt="[object GeneratorFunction]",XLt=/[\\^$.*+?()[\]{}|]/g,KLt=/^\[object .+?Constructor\]$/,ZLt=typeof global=="object"&&global&&global.Object===Object&&global,QLt=typeof self=="object"&&self&&self.Object===Object&&self,Nre=ZLt||QLt||Function("return this")();function JLt(t,e){var i=t?t.length:0;return!!i&&iFt(t,e,0)>-1}function eFt(t,e,i){for(var r=-1,n=t?t.length:0;++r<n;)if(i(e,t[r]))return!0;return!1}function tFt(t,e,i,r){for(var n=t.length,o=i+(r?1:-1);r?o--:++o<n;)if(e(t[o],o,t))return o;return-1}function iFt(t,e,i){if(e!==e)return tFt(t,rFt,i);for(var r=i-1,n=t.length;++r<n;)if(t[r]===e)return r;return-1}function rFt(t){return t!==t}function nFt(t,e){return t.has(e)}function oFt(t,e){return t?.[e]}function sFt(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function v5e(t){var e=-1,i=Array(t.size);return t.forEach(function(r){i[++e]=r}),i}var aFt=Array.prototype,lFt=Function.prototype,b5e=Object.prototype,Mre=Nre["__core-js_shared__"],g5e=function(){var t=/[^.]+$/.exec(Mre&&Mre.keys&&Mre.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),_5e=lFt.toString,Pre=b5e.hasOwnProperty,cFt=b5e.toString,dFt=RegExp("^"+_5e.call(Pre).replace(XLt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),uFt=aFt.splice,hFt=Lre(Nre,"Map"),kre=Lre(Nre,"Set"),sN=Lre(Object,"create");function Pw(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function fFt(){this.__data__=sN?sN(null):{}}function pFt(t){return this.has(t)&&delete this.__data__[t]}function mFt(t){var e=this.__data__;if(sN){var i=e[t];return i===Ore?void 0:i}return Pre.call(e,t)?e[t]:void 0}function gFt(t){var e=this.__data__;return sN?e[t]!==void 0:Pre.call(e,t)}function vFt(t,e){var i=this.__data__;return i[t]=sN&&e===void 0?Ore:e,this}Pw.prototype.clear=fFt;Pw.prototype.delete=pFt;Pw.prototype.get=mFt;Pw.prototype.has=gFt;Pw.prototype.set=vFt;function nT(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function bFt(){this.__data__=[]}function _Ft(t){var e=this.__data__,i=Vj(e,t);if(i<0)return!1;var r=e.length-1;return i==r?e.pop():uFt.call(e,i,1),!0}function yFt(t){var e=this.__data__,i=Vj(e,t);return i<0?void 0:e[i][1]}function wFt(t){return Vj(this.__data__,t)>-1}function CFt(t,e){var i=this.__data__,r=Vj(i,t);return r<0?i.push([t,e]):i[r][1]=e,this}nT.prototype.clear=bFt;nT.prototype.delete=_Ft;nT.prototype.get=yFt;nT.prototype.has=wFt;nT.prototype.set=CFt;function oT(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function xFt(){this.__data__={hash:new Pw,map:new(hFt||nT),string:new Pw}}function SFt(t){return jj(this,t).delete(t)}function EFt(t){return jj(this,t).get(t)}function TFt(t){return jj(this,t).has(t)}function RFt(t,e){return jj(this,t).set(t,e),this}oT.prototype.clear=xFt;oT.prototype.delete=SFt;oT.prototype.get=EFt;oT.prototype.has=TFt;oT.prototype.set=RFt;function Bj(t){var e=-1,i=t?t.length:0;for(this.__data__=new oT;++e<i;)this.add(t[e])}function AFt(t){return this.__data__.set(t,Ore),this}function IFt(t){return this.__data__.has(t)}Bj.prototype.add=Bj.prototype.push=AFt;Bj.prototype.has=IFt;function Vj(t,e){for(var i=t.length;i--;)if(FFt(t[i][0],e))return i;return-1}function DFt(t){if(!y5e(t)||NFt(t))return!1;var e=HFt(t)||sFt(t)?dFt:KLt;return e.test(PFt(t))}function MFt(t,e,i){var r=-1,n=JLt,o=t.length,s=!0,a=[],c=a;if(i)s=!1,n=eFt;else if(o>=qLt){var d=e?null:kFt(t);if(d)return v5e(d);s=!1,n=nFt,c=new Bj}else c=e?[]:a;e:for(;++r<o;){var u=t[r],h=e?e(u):u;if(u=i||u!==0?u:0,s&&h===h){for(var p=c.length;p--;)if(c[p]===h)continue e;e&&c.push(h),a.push(u)}else n(c,h,i)||(c!==a&&c.push(h),a.push(u))}return a}var kFt=kre&&1/v5e(new kre([,-0]))[1]==YLt?function(t){return new kre(t)}:BFt;function jj(t,e){var i=t.__data__;return OFt(e)?i[typeof e=="string"?"string":"hash"]:i.map}function Lre(t,e){var i=oFt(t,e);return DFt(i)?i:void 0}function OFt(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function NFt(t){return!!g5e&&g5e in t}function PFt(t){if(t!=null){try{return _5e.call(t)}catch{}try{return t+""}catch{}}return""}function LFt(t){return t&&t.length?MFt(t):[]}function FFt(t,e){return t===e||t!==t&&e!==e}function HFt(t){var e=y5e(t)?cFt.call(t):"";return e==$Lt||e==GLt}function y5e(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function BFt(){}w5e.exports=LFt});var tHe=z((aN,aT)=>{"use strict";var VFt=200,jFt="Expected a function",Yre="__lodash_hash_undefined__",Xj=1,lT=2,k5e=1/0,O5e=9007199254740991,zj="[object Arguments]",Bre="[object Array]",N5e="[object Boolean]",P5e="[object Date]",L5e="[object Error]",F5e="[object Function]",zFt="[object GeneratorFunction]",Wj="[object Map]",H5e="[object Number]",sT="[object Object]",x5e="[object Promise]",B5e="[object RegExp]",Uj="[object Set]",V5e="[object String]",j5e="[object Symbol]",Vre="[object WeakMap]",z5e="[object ArrayBuffer]",qj="[object DataView]",WFt="[object Float32Array]",UFt="[object Float64Array]",qFt="[object Int8Array]",YFt="[object Int16Array]",$Ft="[object Int32Array]",GFt="[object Uint8Array]",XFt="[object Uint8ClampedArray]",KFt="[object Uint16Array]",ZFt="[object Uint32Array]",QFt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,JFt=/^\w*$/,e5t=/^\./,t5t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i5t=/[\\^$.*+?()[\]{}|]/g,r5t=/\\(\\)?/g,n5t=/^\[object .+?Constructor\]$/,o5t=/^(?:0|[1-9]\d*)$/,ao={};ao[WFt]=ao[UFt]=ao[qFt]=ao[YFt]=ao[$Ft]=ao[GFt]=ao[XFt]=ao[KFt]=ao[ZFt]=!0;ao[zj]=ao[Bre]=ao[z5e]=ao[N5e]=ao[qj]=ao[P5e]=ao[L5e]=ao[F5e]=ao[Wj]=ao[H5e]=ao[sT]=ao[B5e]=ao[Uj]=ao[V5e]=ao[Vre]=!1;var W5e=typeof global=="object"&&global&&global.Object===Object&&global,s5t=typeof self=="object"&&self&&self.Object===Object&&self,p0=W5e||s5t||Function("return this")(),U5e=typeof aN=="object"&&aN&&!aN.nodeType&&aN,S5e=U5e&&typeof aT=="object"&&aT&&!aT.nodeType&&aT,a5t=S5e&&S5e.exports===U5e,E5e=a5t&&W5e.process,T5e=function(){try{return E5e&&E5e.binding("util")}catch{}}(),R5e=T5e&&T5e.isTypedArray;function l5t(t,e,i,r){for(var n=-1,o=t?t.length:0;++n<o;){var s=t[n];e(r,s,i(s),t)}return r}function c5t(t,e){for(var i=-1,r=t?t.length:0;++i<r;)if(e(t[i],i,t))return!0;return!1}function d5t(t){return function(e){return e?.[t]}}function u5t(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r}function h5t(t){return function(e){return t(e)}}function f5t(t,e){return t?.[e]}function jre(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function p5t(t){var e=-1,i=Array(t.size);return t.forEach(function(r,n){i[++e]=[n,r]}),i}function m5t(t,e){return function(i){return t(e(i))}}function g5t(t){var e=-1,i=Array(t.size);return t.forEach(function(r){i[++e]=r}),i}var v5t=Array.prototype,b5t=Function.prototype,Kj=Object.prototype,Fre=p0["__core-js_shared__"],A5e=function(){var t=/[^.]+$/.exec(Fre&&Fre.keys&&Fre.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),q5e=b5t.toString,_p=Kj.hasOwnProperty,cT=Kj.toString,_5t=RegExp("^"+q5e.call(_p).replace(i5t,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),I5e=p0.Symbol,D5e=p0.Uint8Array,y5t=Kj.propertyIsEnumerable,w5t=v5t.splice,C5t=m5t(Object.keys,Object),zre=dT(p0,"DataView"),lN=dT(p0,"Map"),Wre=dT(p0,"Promise"),Ure=dT(p0,"Set"),qre=dT(p0,"WeakMap"),cN=dT(Object,"create"),x5t=Fw(zre),S5t=Fw(lN),E5t=Fw(Wre),T5t=Fw(Ure),R5t=Fw(qre),Yj=I5e?I5e.prototype:void 0,Hre=Yj?Yj.valueOf:void 0,M5e=Yj?Yj.toString:void 0;function Lw(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function A5t(){this.__data__=cN?cN(null):{}}function I5t(t){return this.has(t)&&delete this.__data__[t]}function D5t(t){var e=this.__data__;if(cN){var i=e[t];return i===Yre?void 0:i}return _p.call(e,t)?e[t]:void 0}function M5t(t){var e=this.__data__;return cN?e[t]!==void 0:_p.call(e,t)}function k5t(t,e){var i=this.__data__;return i[t]=cN&&e===void 0?Yre:e,this}Lw.prototype.clear=A5t;Lw.prototype.delete=I5t;Lw.prototype.get=D5t;Lw.prototype.has=M5t;Lw.prototype.set=k5t;function og(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function O5t(){this.__data__=[]}function N5t(t){var e=this.__data__,i=Zj(e,t);if(i<0)return!1;var r=e.length-1;return i==r?e.pop():w5t.call(e,i,1),!0}function P5t(t){var e=this.__data__,i=Zj(e,t);return i<0?void 0:e[i][1]}function L5t(t){return Zj(this.__data__,t)>-1}function F5t(t,e){var i=this.__data__,r=Zj(i,t);return r<0?i.push([t,e]):i[r][1]=e,this}og.prototype.clear=O5t;og.prototype.delete=N5t;og.prototype.get=P5t;og.prototype.has=L5t;og.prototype.set=F5t;function sg(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function H5t(){this.__data__={hash:new Lw,map:new(lN||og),string:new Lw}}function B5t(t){return Qj(this,t).delete(t)}function V5t(t){return Qj(this,t).get(t)}function j5t(t){return Qj(this,t).has(t)}function z5t(t,e){return Qj(this,t).set(t,e),this}sg.prototype.clear=H5t;sg.prototype.delete=B5t;sg.prototype.get=V5t;sg.prototype.has=j5t;sg.prototype.set=z5t;function $j(t){var e=-1,i=t?t.length:0;for(this.__data__=new sg;++e<i;)this.add(t[e])}function W5t(t){return this.__data__.set(t,Yre),this}function U5t(t){return this.__data__.has(t)}$j.prototype.add=$j.prototype.push=W5t;$j.prototype.has=U5t;function ng(t){this.__data__=new og(t)}function q5t(){this.__data__=new og}function Y5t(t){return this.__data__.delete(t)}function $5t(t){return this.__data__.get(t)}function G5t(t){return this.__data__.has(t)}function X5t(t,e){var i=this.__data__;if(i instanceof og){var r=i.__data__;if(!lN||r.length<VFt-1)return r.push([t,e]),this;i=this.__data__=new sg(r)}return i.set(t,e),this}ng.prototype.clear=q5t;ng.prototype.delete=Y5t;ng.prototype.get=$5t;ng.prototype.has=G5t;ng.prototype.set=X5t;function K5t(t,e){var i=f0(t)||J5e(t)?u5t(t.length,String):[],r=i.length,n=!!r;for(var o in t)(e||_p.call(t,o))&&!(n&&(o=="length"||X5e(o,r)))&&i.push(o);return i}function Zj(t,e){for(var i=t.length;i--;)if(Q5e(t[i][0],e))return i;return-1}function Z5t(t,e,i,r){return Q5t(t,function(n,o,s){e(r,n,i(n),s)}),r}var Q5t=pHt(eHt),J5t=mHt();function eHt(t,e){return t&&J5t(t,e,Gj)}function Y5e(t,e){e=Jj(e,t)?[e]:$5e(e);for(var i=0,r=e.length;t!=null&&i<r;)t=t[e6(e[i++])];return i&&i==r?t:void 0}function tHt(t){return cT.call(t)}function iHt(t,e){return t!=null&&e in Object(t)}function $re(t,e,i,r,n){return t===e?!0:t==null||e==null||!t6(t)&&!i6(e)?t!==t&&e!==e:rHt(t,e,$re,i,r,n)}function rHt(t,e,i,r,n,o){var s=f0(t),a=f0(e),c=Bre,d=Bre;s||(c=h0(t),c=c==zj?sT:c),a||(d=h0(e),d=d==zj?sT:d);var u=c==sT&&!jre(t),h=d==sT&&!jre(e),p=c==d;if(p&&!u)return o||(o=new ng),s||THt(t)?G5e(t,e,i,r,n,o):gHt(t,e,c,i,r,n,o);if(!(n&lT)){var f=u&&_p.call(t,"__wrapped__"),m=h&&_p.call(e,"__wrapped__");if(f||m){var g=f?t.value():t,y=m?e.value():e;return o||(o=new ng),i(g,y,r,n,o)}}return p?(o||(o=new ng),vHt(t,e,i,r,n,o)):!1}function nHt(t,e,i,r){var n=i.length,o=n,s=!r;if(t==null)return!o;for(t=Object(t);n--;){var a=i[n];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++n<o;){a=i[n];var c=a[0],d=t[c],u=a[1];if(s&&a[2]){if(d===void 0&&!(c in t))return!1}else{var h=new ng;if(r)var p=r(d,u,c,t,e,h);if(!(p===void 0?$re(u,d,r,Xj|lT,h):p))return!1}}return!0}function oHt(t){if(!t6(t)||wHt(t))return!1;var e=eHe(t)||jre(t)?_5t:n5t;return e.test(Fw(t))}function sHt(t){return i6(t)&&Kre(t.length)&&!!ao[cT.call(t)]}function aHt(t){return typeof t=="function"?t:t==null?DHt:typeof t=="object"?f0(t)?dHt(t[0],t[1]):cHt(t):MHt(t)}function lHt(t){if(!CHt(t))return C5t(t);var e=[];for(var i in Object(t))_p.call(t,i)&&i!="constructor"&&e.push(i);return e}function cHt(t){var e=bHt(t);return e.length==1&&e[0][2]?Z5e(e[0][0],e[0][1]):function(i){return i===t||nHt(i,t,e)}}function dHt(t,e){return Jj(t)&&K5e(e)?Z5e(e6(t),e):function(i){var r=AHt(i,t);return r===void 0&&r===e?IHt(i,t):$re(e,r,void 0,Xj|lT)}}function uHt(t){return function(e){return Y5e(e,t)}}function hHt(t){if(typeof t=="string")return t;if(Zre(t))return M5e?M5e.call(t):"";var e=t+"";return e=="0"&&1/t==-k5e?"-0":e}function $5e(t){return f0(t)?t:xHt(t)}function fHt(t,e){return function(i,r){var n=f0(i)?l5t:Z5t,o=e?e():{};return n(i,t,aHt(r,2),o)}}function pHt(t,e){return function(i,r){if(i==null)return i;if(!Xre(i))return t(i,r);for(var n=i.length,o=e?n:-1,s=Object(i);(e?o--:++o<n)&&r(s[o],o,s)!==!1;);return i}}function mHt(t){return function(e,i,r){for(var n=-1,o=Object(e),s=r(e),a=s.length;a--;){var c=s[t?a:++n];if(i(o[c],c,o)===!1)break}return e}}function G5e(t,e,i,r,n,o){var s=n&lT,a=t.length,c=e.length;if(a!=c&&!(s&&c>a))return!1;var d=o.get(t);if(d&&o.get(e))return d==e;var u=-1,h=!0,p=n&Xj?new $j:void 0;for(o.set(t,e),o.set(e,t);++u<a;){var f=t[u],m=e[u];if(r)var g=s?r(m,f,u,e,t,o):r(f,m,u,t,e,o);if(g!==void 0){if(g)continue;h=!1;break}if(p){if(!c5t(e,function(y,w){if(!p.has(w)&&(f===y||i(f,y,r,n,o)))return p.add(w)})){h=!1;break}}else if(!(f===m||i(f,m,r,n,o))){h=!1;break}}return o.delete(t),o.delete(e),h}function gHt(t,e,i,r,n,o,s){switch(i){case qj:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case z5e:return!(t.byteLength!=e.byteLength||!r(new D5e(t),new D5e(e)));case N5e:case P5e:case H5e:return Q5e(+t,+e);case L5e:return t.name==e.name&&t.message==e.message;case B5e:case V5e:return t==e+"";case Wj:var a=p5t;case Uj:var c=o&lT;if(a||(a=g5t),t.size!=e.size&&!c)return!1;var d=s.get(t);if(d)return d==e;o|=Xj,s.set(t,e);var u=G5e(a(t),a(e),r,n,o,s);return s.delete(t),u;case j5e:if(Hre)return Hre.call(t)==Hre.call(e)}return!1}function vHt(t,e,i,r,n,o){var s=n&lT,a=Gj(t),c=a.length,d=Gj(e),u=d.length;if(c!=u&&!s)return!1;for(var h=c;h--;){var p=a[h];if(!(s?p in e:_p.call(e,p)))return!1}var f=o.get(t);if(f&&o.get(e))return f==e;var m=!0;o.set(t,e),o.set(e,t);for(var g=s;++h<c;){p=a[h];var y=t[p],w=e[p];if(r)var x=s?r(w,y,p,e,t,o):r(y,w,p,t,e,o);if(!(x===void 0?y===w||i(y,w,r,n,o):x)){m=!1;break}g||(g=p=="constructor")}if(m&&!g){var T=t.constructor,M=e.constructor;T!=M&&"constructor"in t&&"constructor"in e&&!(typeof T=="function"&&T instanceof T&&typeof M=="function"&&M instanceof M)&&(m=!1)}return o.delete(t),o.delete(e),m}function Qj(t,e){var i=t.__data__;return yHt(e)?i[typeof e=="string"?"string":"hash"]:i.map}function bHt(t){for(var e=Gj(t),i=e.length;i--;){var r=e[i],n=t[r];e[i]=[r,n,K5e(n)]}return e}function dT(t,e){var i=f5t(t,e);return oHt(i)?i:void 0}var h0=tHt;(zre&&h0(new zre(new ArrayBuffer(1)))!=qj||lN&&h0(new lN)!=Wj||Wre&&h0(Wre.resolve())!=x5e||Ure&&h0(new Ure)!=Uj||qre&&h0(new qre)!=Vre)&&(h0=function(t){var e=cT.call(t),i=e==sT?t.constructor:void 0,r=i?Fw(i):void 0;if(r)switch(r){case x5t:return qj;case S5t:return Wj;case E5t:return x5e;case T5t:return Uj;case R5t:return Vre}return e});function _Ht(t,e,i){e=Jj(e,t)?[e]:$5e(e);for(var r,n=-1,s=e.length;++n<s;){var o=e6(e[n]);if(!(r=t!=null&&i(t,o)))break;t=t[o]}if(r)return r;var s=t?t.length:0;return!!s&&Kre(s)&&X5e(o,s)&&(f0(t)||J5e(t))}function X5e(t,e){return e=e??O5e,!!e&&(typeof t=="number"||o5t.test(t))&&t>-1&&t%1==0&&t<e}function Jj(t,e){if(f0(t))return!1;var i=typeof t;return i=="number"||i=="symbol"||i=="boolean"||t==null||Zre(t)?!0:JFt.test(t)||!QFt.test(t)||e!=null&&t in Object(e)}function yHt(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function wHt(t){return!!A5e&&A5e in t}function CHt(t){var e=t&&t.constructor,i=typeof e=="function"&&e.prototype||Kj;return t===i}function K5e(t){return t===t&&!t6(t)}function Z5e(t,e){return function(i){return i==null?!1:i[t]===e&&(e!==void 0||t in Object(i))}}var xHt=Gre(function(t){t=RHt(t);var e=[];return e5t.test(t)&&e.push(""),t.replace(t5t,function(i,r,n,o){e.push(n?o.replace(r5t,"$1"):r||i)}),e});function e6(t){if(typeof t=="string"||Zre(t))return t;var e=t+"";return e=="0"&&1/t==-k5e?"-0":e}function Fw(t){if(t!=null){try{return q5e.call(t)}catch{}try{return t+""}catch{}}return""}var SHt=fHt(function(t,e,i){_p.call(t,i)?t[i].push(e):t[i]=[e]});function Gre(t,e){if(typeof t!="function"||e&&typeof e!="function")throw new TypeError(jFt);var i=function(){var r=arguments,n=e?e.apply(this,r):r[0],o=i.cache;if(o.has(n))return o.get(n);var s=t.apply(this,r);return i.cache=o.set(n,s),s};return i.cache=new(Gre.Cache||sg),i}Gre.Cache=sg;function Q5e(t,e){return t===e||t!==t&&e!==e}function J5e(t){return EHt(t)&&_p.call(t,"callee")&&(!y5t.call(t,"callee")||cT.call(t)==zj)}var f0=Array.isArray;function Xre(t){return t!=null&&Kre(t.length)&&!eHe(t)}function EHt(t){return i6(t)&&Xre(t)}function eHe(t){var e=t6(t)?cT.call(t):"";return e==F5e||e==zFt}function Kre(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=O5e}function t6(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function i6(t){return!!t&&typeof t=="object"}function Zre(t){return typeof t=="symbol"||i6(t)&&cT.call(t)==j5e}var THt=R5e?h5t(R5e):sHt;function RHt(t){return t==null?"":hHt(t)}function AHt(t,e,i){var r=t==null?void 0:Y5e(t,e);return r===void 0?i:r}function IHt(t,e){return t!=null&&_Ht(t,e,iHt)}function Gj(t){return Xre(t)?K5t(t):lHt(t)}function DHt(t){return t}function MHt(t){return Jj(t)?d5t(e6(t)):uHt(t)}aT.exports=SHt});var rHe=z(uT=>{"use strict";var r6=uT&&uT.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(uT,"__esModule",{value:!0});uT.HeaderTransformer=void 0;var iHe=r6(m5e()),kHt=r6(Ej()),OHt=r6(C5e()),NHt=r6(tHe()),Qre=class{constructor(e){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=e,e.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(e.headers)?this.setHeaders(e.headers):kHt.default(e.headers)&&(this.headersTransform=e.headers)}transform(e,i){return this.shouldMapRow(e)?i(null,this.processRow(e)):i(null,{row:null,isValid:!0})}shouldMapRow(e){let{parserOptions:i}=this;if(!this.headersTransform&&i.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(e)){if(this.headersTransform)this.setHeaders(this.headersTransform(e));else if(this.shouldUseFirstRow)this.setHeaders(e);else return!0;return!1}return!0}processRow(e){if(!this.headers)return{row:e,isValid:!0};let{parserOptions:i}=this;if(!i.discardUnmappedColumns&&e.length>this.headersLength){if(!i.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${e.length}`);return{row:e,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${e.length}`}}return i.strictColumnHandling&&e.length<this.headersLength?{row:e,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${e.length}`}:{row:this.mapHeaders(e),isValid:!0}}mapHeaders(e){let i={},{headers:r,headersLength:n}=this;for(let o=0;o<n;o+=1){let s=r[o];if(!iHe.default(s)){let a=e[o];iHe.default(a)?i[s]="":i[s]=a}}return i}setHeaders(e){var i;let r=e.filter(n=>!!n);if(OHt.default(r).length!==r.length){let n=NHt.default(r),o=Object.keys(n).filter(s=>n[s].length>1);throw new Error(`Duplicate headers found ${JSON.stringify(o)}`)}this.headers=e,this.receivedHeaders=!0,this.headersLength=((i=this.headers)===null||i===void 0?void 0:i.length)||0}};uT.HeaderTransformer=Qre});var nHe=z(hT=>{"use strict";Object.defineProperty(hT,"__esModule",{value:!0});hT.HeaderTransformer=hT.RowTransformerValidator=void 0;var PHt=f5e();Object.defineProperty(hT,"RowTransformerValidator",{enumerable:!0,get:function(){return PHt.RowTransformerValidator}});var LHt=rHe();Object.defineProperty(hT,"HeaderTransformer",{enumerable:!0,get:function(){return LHt.HeaderTransformer}})});var m0=z(n6=>{"use strict";Object.defineProperty(n6,"__esModule",{value:!0});n6.Token=void 0;var Jre=class{constructor(e){this.token=e.token,this.startCursor=e.startCursor,this.endCursor=e.endCursor}static isTokenRowDelimiter(e){let i=e.token;return i==="\r"||i===`
`||i===`\r
`}static isTokenCarriageReturn(e,i){return e.token===i.carriageReturn}static isTokenComment(e,i){return i.supportsComments&&!!e&&e.token===i.comment}static isTokenEscapeCharacter(e,i){return e.token===i.escapeChar}static isTokenQuote(e,i){return e.token===i.quote}static isTokenDelimiter(e,i){return e.token===i.delimiter}};n6.Token=Jre});var tne=z(o6=>{"use strict";Object.defineProperty(o6,"__esModule",{value:!0});o6.Scanner=void 0;var oHe=m0(),FHt=/((?:\r\n)|\n|\r)/,ene=class{constructor(e){this.cursor=0,this.line=e.line,this.lineLength=this.line.length,this.parserOptions=e.parserOptions,this.hasMoreData=e.hasMoreData,this.cursor=e.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){let{lineFromCursor:e}=this,i=this.parserOptions.NEXT_TOKEN_REGEXP;if(e.search(i)===-1)return null;let r=i.exec(e);if(r==null)return null;let n=r[1],o=this.cursor+(r.index||0);return new oHe.Token({token:n,startCursor:o,endCursor:o+n.length-1})}get nextCharacterToken(){let{cursor:e,lineLength:i}=this;return i<=e?null:new oHe.Token({token:this.line[e],startCursor:e,endCursor:e})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){let e=FHt.exec(this.lineFromCursor);return e?(this.cursor+=(e.index||0)+e[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(e){return this.cursor=e,this}advanceToToken(e){return this.cursor=e.startCursor,this}advancePastToken(e){return this.cursor=e.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}};o6.Scanner=ene});var a6=z(s6=>{"use strict";Object.defineProperty(s6,"__esModule",{value:!0});s6.ColumnFormatter=void 0;var ine=class{constructor(e){e.trim?this.format=i=>i.trim():e.ltrim?this.format=i=>i.trimLeft():e.rtrim?this.format=i=>i.trimRight():this.format=i=>i}};s6.ColumnFormatter=ine});var nne=z(l6=>{"use strict";Object.defineProperty(l6,"__esModule",{value:!0});l6.NonQuotedColumnParser=void 0;var HHt=a6(),sHe=m0(),rne=class{constructor(e){this.parserOptions=e,this.columnFormatter=new HHt.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;let{parserOptions:i}=this,r=[],n=e.nextCharacterToken;for(;n&&!(sHe.Token.isTokenDelimiter(n,i)||sHe.Token.isTokenRowDelimiter(n));n=e.nextCharacterToken)r.push(n.token),e.advancePastToken(n);return this.columnFormatter.format(r.join(""))}};l6.NonQuotedColumnParser=rne});var sne=z(c6=>{"use strict";Object.defineProperty(c6,"__esModule",{value:!0});c6.QuotedColumnParser=void 0;var BHt=a6(),fT=m0(),one=class{constructor(e){this.parserOptions=e,this.columnFormatter=new BHt.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;let i=e.cursor,{foundClosingQuote:r,col:n}=this.gatherDataBetweenQuotes(e);if(!r){if(e.advanceTo(i),!e.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${e.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(e),n}gatherDataBetweenQuotes(e){let{parserOptions:i}=this,r=!1,n=!1,o=[],s=e.nextCharacterToken;for(;!n&&s!==null;s=e.nextCharacterToken){let a=fT.Token.isTokenQuote(s,i);if(!r&&a)r=!0;else if(r)if(fT.Token.isTokenEscapeCharacter(s,i)){e.advancePastToken(s);let c=e.nextCharacterToken;c!==null&&(fT.Token.isTokenQuote(c,i)||fT.Token.isTokenEscapeCharacter(c,i))?(o.push(c.token),s=c):a?n=!0:o.push(s.token)}else a?n=!0:o.push(s.token);e.advancePastToken(s)}return{col:this.columnFormatter.format(o.join("")),foundClosingQuote:n}}checkForMalformedColumn(e){let{parserOptions:i}=this,{nextNonSpaceToken:r}=e;if(r){let n=fT.Token.isTokenDelimiter(r,i),o=fT.Token.isTokenRowDelimiter(r);if(!(n||o)){let s=e.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${i.escapedDelimiter}' OR new line got: '${r.token}'. at '${s}`)}e.advanceToToken(r)}else e.hasMoreData||e.advancePastLine()}};c6.QuotedColumnParser=one});var aHe=z(d6=>{"use strict";Object.defineProperty(d6,"__esModule",{value:!0});d6.ColumnParser=void 0;var VHt=nne(),jHt=sne(),zHt=m0(),ane=class{constructor(e){this.parserOptions=e,this.quotedColumnParser=new jHt.QuotedColumnParser(e),this.nonQuotedColumnParser=new VHt.NonQuotedColumnParser(e)}parse(e){let{nextNonSpaceToken:i}=e;return i!==null&&zHt.Token.isTokenQuote(i,this.parserOptions)?(e.advanceToToken(i),this.quotedColumnParser.parse(e)):this.nonQuotedColumnParser.parse(e)}};d6.ColumnParser=ane});var lne=z(yp=>{"use strict";Object.defineProperty(yp,"__esModule",{value:!0});yp.ColumnFormatter=yp.QuotedColumnParser=yp.NonQuotedColumnParser=yp.ColumnParser=void 0;var WHt=aHe();Object.defineProperty(yp,"ColumnParser",{enumerable:!0,get:function(){return WHt.ColumnParser}});var UHt=nne();Object.defineProperty(yp,"NonQuotedColumnParser",{enumerable:!0,get:function(){return UHt.NonQuotedColumnParser}});var qHt=sne();Object.defineProperty(yp,"QuotedColumnParser",{enumerable:!0,get:function(){return qHt.QuotedColumnParser}});var YHt=a6();Object.defineProperty(yp,"ColumnFormatter",{enumerable:!0,get:function(){return YHt.ColumnFormatter}})});var une=z(u6=>{"use strict";Object.defineProperty(u6,"__esModule",{value:!0});u6.RowParser=void 0;var $Ht=lne(),pT=m0(),cne="",dne=class{constructor(e){this.parserOptions=e,this.columnParser=new $Ht.ColumnParser(e)}static isEmptyRow(e){return e.join(cne).replace(/\s+/g,cne)===cne}parse(e){let{parserOptions:i}=this,{hasMoreData:r}=e,n=e,o=[],s=this.getStartToken(n,o);for(;s;){if(pT.Token.isTokenRowDelimiter(s))return n.advancePastToken(s),!n.hasMoreCharacters&&pT.Token.isTokenCarriageReturn(s,i)&&r?null:(n.truncateToCursor(),o);if(!this.shouldSkipColumnParse(n,s,o)){let a=this.columnParser.parse(n);if(a===null)return null;o.push(a)}s=n.nextNonSpaceToken}return r?null:(n.truncateToCursor(),o)}getStartToken(e,i){let r=e.nextNonSpaceToken;return r!==null&&pT.Token.isTokenDelimiter(r,this.parserOptions)?(i.push(""),e.nextNonSpaceToken):r}shouldSkipColumnParse(e,i,r){let{parserOptions:n}=this;if(pT.Token.isTokenDelimiter(i,n)){e.advancePastToken(i);let o=e.nextCharacterToken;if(!e.hasMoreCharacters||o!==null&&pT.Token.isTokenRowDelimiter(o)||o!==null&&pT.Token.isTokenDelimiter(o,n))return r.push(""),!0}return!1}};u6.RowParser=dne});var cHe=z(h6=>{"use strict";Object.defineProperty(h6,"__esModule",{value:!0});h6.Parser=void 0;var GHt=tne(),lHe=une(),XHt=m0(),hne=class t{constructor(e){this.parserOptions=e,this.rowParser=new lHe.RowParser(this.parserOptions)}static removeBOM(e){return e&&e.charCodeAt(0)===65279?e.slice(1):e}parse(e,i){let r=new GHt.Scanner({line:t.removeBOM(e),parserOptions:this.parserOptions,hasMoreData:i});return this.parserOptions.supportsComments?this.parseWithComments(r):this.parseWithoutComments(r)}parseWithoutComments(e){let i=[],r=!0;for(;r;)r=this.parseRow(e,i);return{line:e.line,rows:i}}parseWithComments(e){let{parserOptions:i}=this,r=[];for(let n=e.nextCharacterToken;n!==null;n=e.nextCharacterToken)if(XHt.Token.isTokenComment(n,i)){if(e.advancePastLine()===null)return{line:e.lineFromCursor,rows:r};if(!e.hasMoreCharacters)return{line:e.lineFromCursor,rows:r};e.truncateToCursor()}else if(!this.parseRow(e,r))break;return{line:e.line,rows:r}}parseRow(e,i){if(!e.nextNonSpaceToken)return!1;let n=this.rowParser.parse(e);return n===null?!1:(this.parserOptions.ignoreEmpty&&lHe.RowParser.isEmptyRow(n)||i.push(n),!0)}};h6.Parser=hne});var dHe=z(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});Cl.QuotedColumnParser=Cl.NonQuotedColumnParser=Cl.ColumnParser=Cl.Token=Cl.Scanner=Cl.RowParser=Cl.Parser=void 0;var KHt=cHe();Object.defineProperty(Cl,"Parser",{enumerable:!0,get:function(){return KHt.Parser}});var ZHt=une();Object.defineProperty(Cl,"RowParser",{enumerable:!0,get:function(){return ZHt.RowParser}});var QHt=tne();Object.defineProperty(Cl,"Scanner",{enumerable:!0,get:function(){return QHt.Scanner}});var JHt=m0();Object.defineProperty(Cl,"Token",{enumerable:!0,get:function(){return JHt.Token}});var fne=lne();Object.defineProperty(Cl,"ColumnParser",{enumerable:!0,get:function(){return fne.ColumnParser}});Object.defineProperty(Cl,"NonQuotedColumnParser",{enumerable:!0,get:function(){return fne.NonQuotedColumnParser}});Object.defineProperty(Cl,"QuotedColumnParser",{enumerable:!0,get:function(){return fne.QuotedColumnParser}})});var mne=z(f6=>{"use strict";Object.defineProperty(f6,"__esModule",{value:!0});f6.CsvParserStream=void 0;var eBt=Ze("string_decoder"),tBt=Ze("stream"),uHe=nHe(),iBt=dHe(),pne=class t extends tBt.Transform{constructor(e){super({objectMode:e.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=e,this.parser=new iBt.Parser(e),this.headerTransformer=new uHe.HeaderTransformer(e),this.decoder=new eBt.StringDecoder(e.encoding),this.rowTransformerValidator=new uHe.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(e){return this.rowTransformerValidator.rowTransform=e,this}validate(e){return this.rowTransformerValidator.rowValidator=e,this}emit(e,...i){return e==="end"?(this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1):super.emit(e,...i)}_transform(e,i,r){if(this.hasHitRowLimit)return r();let n=t.wrapDoneCallback(r);try{let{lines:o}=this,s=o+this.decoder.write(e),a=this.parse(s,!0);return this.processRows(a,n)}catch(o){return n(o)}}_flush(e){let i=t.wrapDoneCallback(e);if(this.hasHitRowLimit)return i();try{let r=this.lines+this.decoder.end(),n=this.parse(r,!1);return this.processRows(n,i)}catch(r){return i(r)}}parse(e,i){if(!e)return[];let{line:r,rows:n}=this.parser.parse(e,i);return this.lines=r,n}processRows(e,i){let r=e.length,n=o=>{let s=d=>{if(d)return i(d);if(o%100===0){setImmediate(()=>n(o+1));return}return n(o+1)};if(this.checkAndEmitHeaders(),o>=r||this.hasHitRowLimit)return i();if(this.parsedLineCount+=1,this.shouldSkipLine)return s();let a=e[o];this.rowCount+=1,this.parsedRowCount+=1;let c=this.rowCount;return this.transformRow(a,(d,u)=>{if(d)return this.rowCount-=1,s(d);if(!u)return s(new Error("expected transform result"));if(!u.isValid)this.emit("data-invalid",u.row,c,u.reason);else if(u.row)return this.pushRow(u.row,s);return s()})};n(0)}transformRow(e,i){try{this.headerTransformer.transform(e,(r,n)=>r?i(r):n?n.isValid?n.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(n.row,i):this.skipRow(i):(this.rowCount-=1,this.parsedRowCount-=1,i(null,{row:null,isValid:!0})):this.shouldEmitRows?i(null,{isValid:!1,row:e}):this.skipRow(i):i(new Error("Expected result from header transform")))}catch(r){i(r)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(e){return this.rowCount-=1,e(null,{row:null,isValid:!0})}pushRow(e,i){try{this.parserOptions.objectMode?this.push(e):this.push(JSON.stringify(e)),i()}catch(r){i(r)}}static wrapDoneCallback(e){let i=!1;return(r,...n)=>{if(r){if(i)throw r;i=!0,e(r);return}e(...n)}}};f6.CsvParserStream=pne});var fHe=z(Po=>{"use strict";var hHe=Po&&Po.__createBinding||(Object.create?function(t,e,i,r){r===void 0&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){r===void 0&&(r=i),t[r]=e[i]}),rBt=Po&&Po.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),nBt=Po&&Po.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var i in t)i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)&&hHe(e,t,i);return rBt(e,t),e},oBt=Po&&Po.__exportStar||function(t,e){for(var i in t)i!=="default"&&!Object.prototype.hasOwnProperty.call(e,i)&&hHe(e,t,i)};Object.defineProperty(Po,"__esModule",{value:!0});Po.parseString=Po.parseFile=Po.parseStream=Po.parse=Po.ParserOptions=Po.CsvParserStream=void 0;var sBt=nBt(Ze("fs")),aBt=Ze("stream"),p6=Are(),m6=mne();oBt(Ire(),Po);var lBt=mne();Object.defineProperty(Po,"CsvParserStream",{enumerable:!0,get:function(){return lBt.CsvParserStream}});var cBt=Are();Object.defineProperty(Po,"ParserOptions",{enumerable:!0,get:function(){return cBt.ParserOptions}});Po.parse=t=>new m6.CsvParserStream(new p6.ParserOptions(t));Po.parseStream=(t,e)=>t.pipe(new m6.CsvParserStream(new p6.ParserOptions(e)));Po.parseFile=(t,e={})=>sBt.createReadStream(t).pipe(new m6.CsvParserStream(new p6.ParserOptions(e)));Po.parseString=(t,e)=>{let i=new aBt.Readable;return i.push(t),i.push(null),i.pipe(new m6.CsvParserStream(new p6.ParserOptions(e)))}});var pHe=z(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.CsvParserStream=vn.ParserOptions=vn.parseFile=vn.parseStream=vn.parseString=vn.parse=vn.FormatterOptions=vn.CsvFormatterStream=vn.writeToPath=vn.writeToString=vn.writeToBuffer=vn.writeToStream=vn.write=vn.format=void 0;var g0=c5e();Object.defineProperty(vn,"format",{enumerable:!0,get:function(){return g0.format}});Object.defineProperty(vn,"write",{enumerable:!0,get:function(){return g0.write}});Object.defineProperty(vn,"writeToStream",{enumerable:!0,get:function(){return g0.writeToStream}});Object.defineProperty(vn,"writeToBuffer",{enumerable:!0,get:function(){return g0.writeToBuffer}});Object.defineProperty(vn,"writeToString",{enumerable:!0,get:function(){return g0.writeToString}});Object.defineProperty(vn,"writeToPath",{enumerable:!0,get:function(){return g0.writeToPath}});Object.defineProperty(vn,"CsvFormatterStream",{enumerable:!0,get:function(){return g0.CsvFormatterStream}});Object.defineProperty(vn,"FormatterOptions",{enumerable:!0,get:function(){return g0.FormatterOptions}});var mT=fHe();Object.defineProperty(vn,"parse",{enumerable:!0,get:function(){return mT.parse}});Object.defineProperty(vn,"parseString",{enumerable:!0,get:function(){return mT.parseString}});Object.defineProperty(vn,"parseStream",{enumerable:!0,get:function(){return mT.parseStream}});Object.defineProperty(vn,"parseFile",{enumerable:!0,get:function(){return mT.parseFile}});Object.defineProperty(vn,"ParserOptions",{enumerable:!0,get:function(){return mT.ParserOptions}});Object.defineProperty(vn,"CsvParserStream",{enumerable:!0,get:function(){return mT.CsvParserStream}})});var mHe=z((gne,vne)=>{"use strict";(function(t,e){typeof gne=="object"&&typeof vne<"u"?vne.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs_plugin_customParseFormat=e()})(gne,function(){"use strict";var t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},e=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,r=/\d\d/,n=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,s={},a=function(m){return(m=+m)+(m>68?1900:2e3)},c=function(m){return function(g){this[m]=+g}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(m){(this.zone||(this.zone={})).offset=function(g){if(!g||g==="Z")return 0;var y=g.match(/([+-]|\d\d)/g),w=60*y[1]+(+y[2]||0);return w===0?0:y[0]==="+"?-w:w}(m)}],u=function(m){var g=s[m];return g&&(g.indexOf?g:g.s.concat(g.f))},h=function(m,g){var y,w=s.meridiem;if(w){for(var x=1;x<=24;x+=1)if(m.indexOf(w(x,0,g))>-1){y=x>12;break}}else y=m===(g?"pm":"PM");return y},p={A:[o,function(m){this.afternoon=h(m,!1)}],a:[o,function(m){this.afternoon=h(m,!0)}],Q:[i,function(m){this.month=3*(m-1)+1}],S:[i,function(m){this.milliseconds=100*+m}],SS:[r,function(m){this.milliseconds=10*+m}],SSS:[/\d{3}/,function(m){this.milliseconds=+m}],s:[n,c("seconds")],ss:[n,c("seconds")],m:[n,c("minutes")],mm:[n,c("minutes")],H:[n,c("hours")],h:[n,c("hours")],HH:[n,c("hours")],hh:[n,c("hours")],D:[n,c("day")],DD:[r,c("day")],Do:[o,function(m){var g=s.ordinal,y=m.match(/\d+/);if(this.day=y[0],g)for(var w=1;w<=31;w+=1)g(w).replace(/\[|\]/g,"")===m&&(this.day=w)}],w:[n,c("week")],ww:[r,c("week")],M:[n,c("month")],MM:[r,c("month")],MMM:[o,function(m){var g=u("months"),y=(u("monthsShort")||g.map(function(w){return w.slice(0,3)})).indexOf(m)+1;if(y<1)throw new Error;this.month=y%12||y}],MMMM:[o,function(m){var g=u("months").indexOf(m)+1;if(g<1)throw new Error;this.month=g%12||g}],Y:[/[+-]?\d+/,c("year")],YY:[r,function(m){this.year=a(m)}],YYYY:[/\d{4}/,c("year")],Z:d,ZZ:d};function f(m){var g,y;g=m,y=s&&s.formats;for(var w=(m=g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(O,V,J){var N=J&&J.toUpperCase();return V||y[J]||t[J]||y[N].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(P,$,K){return $||K.slice(1)})})).match(e),x=w.length,T=0;T<x;T+=1){var M=w[T],B=p[M],G=B&&B[0],F=B&&B[1];w[T]=F?{regex:G,parser:F}:M.replace(/^\[|\]$/g,"")}return function(O){for(var V={},J=0,N=0;J<x;J+=1){var P=w[J];if(typeof P=="string")N+=P.length;else{var $=P.regex,K=P.parser,ve=O.slice(N),W=$.exec(ve)[0];K.call(V,W),O=O.replace(W,"")}}return function(ee){var te=ee.afternoon;if(te!==void 0){var se=ee.hours;te?se<12&&(ee.hours+=12):se===12&&(ee.hours=0),delete ee.afternoon}}(V),V}}return function(m,g,y){y.p.customParseFormat=!0,m&&m.parseTwoDigitYear&&(a=m.parseTwoDigitYear);var w=g.prototype,x=w.parse;w.parse=function(T){var M=T.date,B=T.utc,G=T.args;this.$u=B;var F=G[1];if(typeof F=="string"){var O=G[2]===!0,V=G[3]===!0,J=O||V,N=G[2];V&&(N=G[2]),s=this.$locale(),!O&&N&&(s=y.Ls[N]),this.$d=function(ve,W,ee,te){try{if(["x","X"].indexOf(W)>-1)return new Date((W==="X"?1e3:1)*ve);var se=f(W)(ve),Ae=se.year,k=se.month,S=se.day,I=se.hours,X=se.minutes,Q=se.seconds,le=se.milliseconds,xe=se.zone,Re=se.week,Oe=new Date,We=S||(Ae||k?1:Oe.getDate()),Le=Ae||Oe.getFullYear(),Ne=0;Ae&&!k||(Ne=k>0?k-1:Oe.getMonth());var it,ct=I||0,Ue=X||0,Se=Q||0,gt=le||0;return xe?new Date(Date.UTC(Le,Ne,We,ct,Ue,Se,gt+60*xe.offset*1e3)):ee?new Date(Date.UTC(Le,Ne,We,ct,Ue,Se,gt)):(it=new Date(Le,Ne,We,ct,Ue,Se,gt),Re&&(it=te(it).week(Re).toDate()),it)}catch{return new Date("")}}(M,F,B,y),this.init(),N&&N!==!0&&(this.$L=this.locale(N).$L),J&&M!=this.format(F)&&(this.$d=new Date("")),s={}}else if(F instanceof Array)for(var P=F.length,$=1;$<=P;$+=1){G[1]=F[$-1];var K=y.apply(this,G);if(K.isValid()){this.$d=K.$d,this.$L=K.$L,this.init();break}$===P&&(this.$d=new Date(""))}else x.call(this,T)}}})});var gHe=z((bne,_ne)=>{"use strict";(function(t,e){typeof bne=="object"&&typeof _ne<"u"?_ne.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs_plugin_utc=e()})(bne,function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,i=/([+-]|\d\d)/g;return function(r,n,o){var s=n.prototype;o.utc=function(f){var m={date:f,utc:!0,args:arguments};return new n(m)},s.utc=function(f){var m=o(this.toDate(),{locale:this.$L,utc:!0});return f?m.add(this.utcOffset(),t):m},s.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var a=s.parse;s.parse=function(f){f.utc&&(this.$u=!0),this.$utils().u(f.$offset)||(this.$offset=f.$offset),a.call(this,f)};var c=s.init;s.init=function(){if(this.$u){var f=this.$d;this.$y=f.getUTCFullYear(),this.$M=f.getUTCMonth(),this.$D=f.getUTCDate(),this.$W=f.getUTCDay(),this.$H=f.getUTCHours(),this.$m=f.getUTCMinutes(),this.$s=f.getUTCSeconds(),this.$ms=f.getUTCMilliseconds()}else c.call(this)};var d=s.utcOffset;s.utcOffset=function(f,m){var g=this.$utils().u;if(g(f))return this.$u?0:g(this.$offset)?d.call(this):this.$offset;if(typeof f=="string"&&(f=function(T){T===void 0&&(T="");var M=T.match(e);if(!M)return null;var B=(""+M[0]).match(i)||["-",0,0],G=B[0],F=60*+B[1]+ +B[2];return F===0?0:G==="+"?F:-F}(f),f===null))return this;var y=Math.abs(f)<=16?60*f:f,w=this;if(m)return w.$offset=y,w.$u=f===0,w;if(f!==0){var x=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(w=this.local().add(y+x,t)).$offset=y,w.$x.$localOffset=x}else w=this.utc();return w};var u=s.format;s.format=function(f){var m=f||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,m)},s.valueOf=function(){var f=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*f},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()};var h=s.toDate;s.toDate=function(f){return f==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():h.call(this)};var p=s.diff;s.diff=function(f,m,g){if(f&&this.$u===f.$u)return p.call(this,f,m,g);var y=this.local(),w=o(f).local();return p.call(y,w,m,g)}}})});var vHe=z((yne,wne)=>{"use strict";(function(t,e){typeof yne=="object"&&typeof wne<"u"?wne.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs=e()})(yne,function(){"use strict";var t=1e3,e=6e4,i=36e5,r="millisecond",n="second",o="minute",s="hour",a="day",c="week",d="month",u="quarter",h="year",p="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var $=["th","st","nd","rd"],K=P%100;return"["+P+($[(K-20)%10]||$[K]||$[0])+"]"}},w=function(P,$,K){var ve=String(P);return!ve||ve.length>=$?P:""+Array($+1-ve.length).join(K)+P},x={s:w,z:function(P){var $=-P.utcOffset(),K=Math.abs($),ve=Math.floor(K/60),W=K%60;return($<=0?"+":"-")+w(ve,2,"0")+":"+w(W,2,"0")},m:function P($,K){if($.date()<K.date())return-P(K,$);var ve=12*(K.year()-$.year())+(K.month()-$.month()),W=$.clone().add(ve,d),ee=K-W<0,te=$.clone().add(ve+(ee?-1:1),d);return+(-(ve+(K-W)/(ee?W-te:te-W))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:d,y:h,w:c,d:a,D:p,h:s,m:o,s:n,ms:r,Q:u}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},T="en",M={};M[T]=y;var B="$isDayjsObject",G=function(P){return P instanceof J||!(!P||!P[B])},F=function P($,K,ve){var W;if(!$)return T;if(typeof $=="string"){var ee=$.toLowerCase();M[ee]&&(W=ee),K&&(M[ee]=K,W=ee);var te=$.split("-");if(!W&&te.length>1)return P(te[0])}else{var se=$.name;M[se]=$,W=se}return!ve&&W&&(T=W),W||!ve&&T},O=function(P,$){if(G(P))return P.clone();var K=typeof $=="object"?$:{};return K.date=P,K.args=arguments,new J(K)},V=x;V.l=F,V.i=G,V.w=function(P,$){return O(P,{locale:$.$L,utc:$.$u,x:$.$x,$offset:$.$offset})};var J=function(){function P(K){this.$L=F(K.locale,null,!0),this.parse(K),this.$x=this.$x||K.x||{},this[B]=!0}var $=P.prototype;return $.parse=function(K){this.$d=function(ve){var W=ve.date,ee=ve.utc;if(W===null)return new Date(NaN);if(V.u(W))return new Date;if(W instanceof Date)return new Date(W);if(typeof W=="string"&&!/Z$/i.test(W)){var te=W.match(m);if(te){var se=te[2]-1||0,Ae=(te[7]||"0").substring(0,3);return ee?new Date(Date.UTC(te[1],se,te[3]||1,te[4]||0,te[5]||0,te[6]||0,Ae)):new Date(te[1],se,te[3]||1,te[4]||0,te[5]||0,te[6]||0,Ae)}}return new Date(W)}(K),this.init()},$.init=function(){var K=this.$d;this.$y=K.getFullYear(),this.$M=K.getMonth(),this.$D=K.getDate(),this.$W=K.getDay(),this.$H=K.getHours(),this.$m=K.getMinutes(),this.$s=K.getSeconds(),this.$ms=K.getMilliseconds()},$.$utils=function(){return V},$.isValid=function(){return this.$d.toString()!==f},$.isSame=function(K,ve){var W=O(K);return this.startOf(ve)<=W&&W<=this.endOf(ve)},$.isAfter=function(K,ve){return O(K)<this.startOf(ve)},$.isBefore=function(K,ve){return this.endOf(ve)<O(K)},$.$g=function(K,ve,W){return V.u(K)?this[ve]:this.set(W,K)},$.unix=function(){return Math.floor(this.valueOf()/1e3)},$.valueOf=function(){return this.$d.getTime()},$.startOf=function(K,ve){var W=this,ee=!!V.u(ve)||ve,te=V.p(K),se=function(xe,Re){var Oe=V.w(W.$u?Date.UTC(W.$y,Re,xe):new Date(W.$y,Re,xe),W);return ee?Oe:Oe.endOf(a)},Ae=function(xe,Re){return V.w(W.toDate()[xe].apply(W.toDate("s"),(ee?[0,0,0,0]:[23,59,59,999]).slice(Re)),W)},k=this.$W,S=this.$M,I=this.$D,X="set"+(this.$u?"UTC":"");switch(te){case h:return ee?se(1,0):se(31,11);case d:return ee?se(1,S):se(0,S+1);case c:var Q=this.$locale().weekStart||0,le=(k<Q?k+7:k)-Q;return se(ee?I-le:I+(6-le),S);case a:case p:return Ae(X+"Hours",0);case s:return Ae(X+"Minutes",1);case o:return Ae(X+"Seconds",2);case n:return Ae(X+"Milliseconds",3);default:return this.clone()}},$.endOf=function(K){return this.startOf(K,!1)},$.$set=function(K,ve){var W,ee=V.p(K),te="set"+(this.$u?"UTC":""),se=(W={},W[a]=te+"Date",W[p]=te+"Date",W[d]=te+"Month",W[h]=te+"FullYear",W[s]=te+"Hours",W[o]=te+"Minutes",W[n]=te+"Seconds",W[r]=te+"Milliseconds",W)[ee],Ae=ee===a?this.$D+(ve-this.$W):ve;if(ee===d||ee===h){var k=this.clone().set(p,1);k.$d[se](Ae),k.init(),this.$d=k.set(p,Math.min(this.$D,k.daysInMonth())).$d}else se&&this.$d[se](Ae);return this.init(),this},$.set=function(K,ve){return this.clone().$set(K,ve)},$.get=function(K){return this[V.p(K)]()},$.add=function(K,ve){var W,ee=this;K=Number(K);var te=V.p(ve),se=function(S){var I=O(ee);return V.w(I.date(I.date()+Math.round(S*K)),ee)};if(te===d)return this.set(d,this.$M+K);if(te===h)return this.set(h,this.$y+K);if(te===a)return se(1);if(te===c)return se(7);var Ae=(W={},W[o]=e,W[s]=i,W[n]=t,W)[te]||1,k=this.$d.getTime()+K*Ae;return V.w(k,this)},$.subtract=function(K,ve){return this.add(-1*K,ve)},$.format=function(K){var ve=this,W=this.$locale();if(!this.isValid())return W.invalidDate||f;var ee=K||"YYYY-MM-DDTHH:mm:ssZ",te=V.z(this),se=this.$H,Ae=this.$m,k=this.$M,S=W.weekdays,I=W.months,X=W.meridiem,Q=function(Re,Oe,We,Le){return Re&&(Re[Oe]||Re(ve,ee))||We[Oe].slice(0,Le)},le=function(Re){return V.s(se%12||12,Re,"0")},xe=X||function(Re,Oe,We){var Le=Re<12?"AM":"PM";return We?Le.toLowerCase():Le};return ee.replace(g,function(Re,Oe){return Oe||function(We){switch(We){case"YY":return String(ve.$y).slice(-2);case"YYYY":return V.s(ve.$y,4,"0");case"M":return k+1;case"MM":return V.s(k+1,2,"0");case"MMM":return Q(W.monthsShort,k,I,3);case"MMMM":return Q(I,k);case"D":return ve.$D;case"DD":return V.s(ve.$D,2,"0");case"d":return String(ve.$W);case"dd":return Q(W.weekdaysMin,ve.$W,S,2);case"ddd":return Q(W.weekdaysShort,ve.$W,S,3);case"dddd":return S[ve.$W];case"H":return String(se);case"HH":return V.s(se,2,"0");case"h":return le(1);case"hh":return le(2);case"a":return xe(se,Ae,!0);case"A":return xe(se,Ae,!1);case"m":return String(Ae);case"mm":return V.s(Ae,2,"0");case"s":return String(ve.$s);case"ss":return V.s(ve.$s,2,"0");case"SSS":return V.s(ve.$ms,3,"0");case"Z":return te}return null}(Re)||te.replace(":","")})},$.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},$.diff=function(K,ve,W){var ee,te=this,se=V.p(ve),Ae=O(K),k=(Ae.utcOffset()-this.utcOffset())*e,S=this-Ae,I=function(){return V.m(te,Ae)};switch(se){case h:ee=I()/12;break;case d:ee=I();break;case u:ee=I()/3;break;case c:ee=(S-k)/6048e5;break;case a:ee=(S-k)/864e5;break;case s:ee=S/i;break;case o:ee=S/e;break;case n:ee=S/t;break;default:ee=S}return W?ee:V.a(ee)},$.daysInMonth=function(){return this.endOf(d).$D},$.$locale=function(){return M[this.$L]},$.locale=function(K,ve){if(!K)return this.$L;var W=this.clone(),ee=F(K,ve,!0);return ee&&(W.$L=ee),W},$.clone=function(){return V.w(this.$d,this)},$.toDate=function(){return new Date(this.valueOf())},$.toJSON=function(){return this.isValid()?this.toISOString():null},$.toISOString=function(){return this.$d.toISOString()},$.toString=function(){return this.$d.toUTCString()},P}(),N=J.prototype;return O.prototype=N,[["$ms",r],["$s",n],["$m",o],["$H",s],["$W",a],["$M",d],["$y",h],["$D",p]].forEach(function(P){N[P[1]]=function($){return this.$g($,P[0],P[1])}}),O.extend=function(P,$){return P.$i||(P($,J,O),P.$i=!0),O},O.locale=F,O.isDayjs=G,O.unix=function(P){return O(1e3*P)},O.en=M[T],O.Ls=M,O.p={},O})});var wHe=z((TJi,yHe)=>{"use strict";var bHe=Ze("fs"),_He=pHe(),dBt=mHe(),uBt=gHe(),dN=vHe().extend(dBt).extend(uBt),hBt=z2(),{fs:{exists:fBt}}=yl(),pBt={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}},Cne=class{constructor(e){this.workbook=e,this.worksheet=null}readFile(e,i){return Ei(this,null,function*(){if(i=i||{},!(yield fBt(e)))throw new Error(`File not found: ${e}`);let r=bHe.createReadStream(e),n=yield this.read(r,i);return r.close(),n})}read(e,i){return i=i||{},new Promise((r,n)=>{let o=this.workbook.addWorksheet(i.sheetName),s=i.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],a=i.map||function(d){if(d==="")return null;let u=Number(d);if(!Number.isNaN(u)&&u!==1/0)return u;let h=s.reduce((f,m)=>{if(f)return f;let g=dN(d,m,!0);return g.isValid()?g:null},null);if(h)return new Date(h.valueOf());let p=pBt[d];return p!==void 0?p:d},c=_He.parse(i.parserOptions).on("data",d=>{o.addRow(d.map(a))}).on("end",()=>{c.emit("worksheet",o)});c.on("worksheet",r).on("error",n),e.pipe(c)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(e,i){return new Promise((r,n)=>{i=i||{};let o=this.workbook.getWorksheet(i.sheetName||i.sheetId),s=_He.format(i.formatterOptions);e.on("finish",()=>{r()}),s.on("error",n),s.pipe(e);let{dateFormat:a,dateUTC:c}=i,d=i.map||(p=>{if(p){if(p.text||p.hyperlink)return p.hyperlink||p.text||"";if(p.formula||p.result)return p.result||"";if(p instanceof Date)return a?c?dN.utc(p).format(a):dN(p).format(a):c?dN.utc(p).format():dN(p).format();if(p.error)return p.error;if(typeof p=="object")return JSON.stringify(p)}return p}),u=i.includeEmptyRows===void 0||i.includeEmptyRows,h=1;o&&o.eachRow((p,f)=>{if(u)for(;h++<f-1;)s.write([]);let{values:m}=p;m.shift(),s.write(m.map(d)),h=f}),s.end()})}writeFile(e,i){i=i||{};let r={encoding:i.encoding||"utf8"},n=bHe.createWriteStream(e,r);return this.write(n,i)}writeBuffer(e){return Ei(this,null,function*(){let i=new hBt;return yield this.write(i,e),i.read()})}};yHe.exports=Cne});var SHe=z((AJi,xHe)=>{"use strict";var CHe=FRe(),mBt=vZ(),gBt=nre(),vBt=wHe(),xne=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new mBt}get xlsx(){return this._xlsx||(this._xlsx=new gBt(this)),this._xlsx}get csv(){return this._csv||(this._csv=new vBt(this)),this._csv}get nextId(){for(let e=1;e<this._worksheets.length;e++)if(!this._worksheets[e])return e;return this._worksheets.length||1}addWorksheet(e,i){let r=this.nextId;i&&(typeof i=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),i={properties:{tabColor:{argb:i}}}):(i.argb||i.theme||i.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),i={properties:{tabColor:i}}));let n=this._worksheets.reduce((a,c)=>(c&&c.orderNo)>a?c.orderNo:a,0),o=Object.assign({},i,{id:r,name:e,orderNo:n+1,workbook:this}),s=new CHe(o);return this._worksheets[r]=s,s}removeWorksheetEx(e){delete this._worksheets[e.id]}removeWorksheet(e){let i=this.getWorksheet(e);i&&i.destroy()}getWorksheet(e){if(e===void 0)return this._worksheets.find(Boolean);if(typeof e=="number")return this._worksheets[e];if(typeof e=="string")return this._worksheets.find(i=>i&&i.name===e)}get worksheets(){return this._worksheets.slice(1).sort((e,i)=>e.orderNo-i.orderNo).filter(Boolean)}eachSheet(e){this.worksheets.forEach(i=>{e(i,i.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(e){let i=this.media.length;return this.media.push(Object.assign({},e,{type:"image"})),i}getImage(e){return this.media[e]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(e=>e.model),sheets:this.worksheets.map(e=>e.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(e){this.creator=e.creator,this.lastModifiedBy=e.lastModifiedBy,this.lastPrinted=e.lastPrinted,this.created=e.created,this.modified=e.modified,this.company=e.company,this.manager=e.manager,this.title=e.title,this.subject=e.subject,this.keywords=e.keywords,this.category=e.category,this.description=e.description,this.language=e.language,this.revision=e.revision,this.contentStatus=e.contentStatus,this.properties=e.properties,this.calcProperties=e.calcProperties,this._worksheets=[],e.worksheets.forEach(i=>{let{id:r,name:n,state:o}=i,s=e.sheets&&e.sheets.findIndex(c=>c.id===r),a=this._worksheets[r]=new CHe({id:r,name:n,orderNo:s,state:o,workbook:this});a.model=i}),this._definedNames.model=e.definedNames,this.views=e.views,this._themes=e.themes,this.media=e.media||[]}};xHe.exports=xne});var THe=z((IJi,EHe)=>{"use strict";var bBt=nre(),Sne=class{constructor(e){this.model=e}get xlsx(){return this._xlsx||(this._xlsx=new bBt(this)),this._xlsx}};EHe.exports=Sne});var AHe=z((DJi,RHe)=>{"use strict";var _Bt=typeof process=="object"&&process&&process.platform==="win32";RHe.exports=_Bt?{sep:"\\"}:{sep:"/"}});var Ene=z((MJi,kHe)=>{"use strict";kHe.exports=DHe;function DHe(t,e,i){t instanceof RegExp&&(t=IHe(t,i)),e instanceof RegExp&&(e=IHe(e,i));var r=MHe(t,e,i);return r&&{start:r[0],end:r[1],pre:i.slice(0,r[0]),body:i.slice(r[0]+t.length,r[1]),post:i.slice(r[1]+e.length)}}function IHe(t,e){var i=e.match(t);return i?i[0]:null}DHe.range=MHe;function MHe(t,e,i){var r,n,o,s,a,c=i.indexOf(t),d=i.indexOf(e,c+1),u=c;if(c>=0&&d>0){if(t===e)return[c,d];for(r=[],o=i.length;u>=0&&!a;)u==c?(r.push(u),c=i.indexOf(t,u+1)):r.length==1?a=[r.pop(),d]:(n=r.pop(),n<o&&(o=n,s=d),d=i.indexOf(e,u+1)),u=c<d&&c>=0?c:d;r.length&&(a=[o,s])}return a}});var VHe=z((kJi,BHe)=>{"use strict";var OHe=Ene();BHe.exports=CBt;var NHe="\0SLASH"+Math.random()+"\0",PHe="\0OPEN"+Math.random()+"\0",Rne="\0CLOSE"+Math.random()+"\0",LHe="\0COMMA"+Math.random()+"\0",FHe="\0PERIOD"+Math.random()+"\0";function Tne(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function yBt(t){return t.split("\\\\").join(NHe).split("\\{").join(PHe).split("\\}").join(Rne).split("\\,").join(LHe).split("\\.").join(FHe)}function wBt(t){return t.split(NHe).join("\\").split(PHe).join("{").split(Rne).join("}").split(LHe).join(",").split(FHe).join(".")}function HHe(t){if(!t)return[""];var e=[],i=OHe("{","}",t);if(!i)return t.split(",");var r=i.pre,n=i.body,o=i.post,s=r.split(",");s[s.length-1]+="{"+n+"}";var a=HHe(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function CBt(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),uN(yBt(t),!0).map(wBt)):[]}function xBt(t){return"{"+t+"}"}function SBt(t){return/^-?0\d/.test(t)}function EBt(t,e){return t<=e}function TBt(t,e){return t>=e}function uN(t,e){var i=[],r=OHe("{","}",t);if(!r)return[t];var n=r.pre,o=r.post.length?uN(r.post,!1):[""];if(/\$$/.test(r.pre))for(var s=0;s<o.length;s++){var a=n+"{"+r.body+"}"+o[s];i.push(a)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),u=c||d,h=r.body.indexOf(",")>=0;if(!u&&!h)return r.post.match(/,.*\}/)?(t=r.pre+"{"+r.body+Rne+r.post,uN(t)):[t];var p;if(u)p=r.body.split(/\.\./);else if(p=HHe(r.body),p.length===1&&(p=uN(p[0],!1).map(xBt),p.length===1))return o.map(function(J){return r.pre+p[0]+J});var f;if(u){var m=Tne(p[0]),g=Tne(p[1]),y=Math.max(p[0].length,p[1].length),w=p.length==3?Math.abs(Tne(p[2])):1,x=EBt,T=g<m;T&&(w*=-1,x=TBt);var M=p.some(SBt);f=[];for(var B=m;x(B,g);B+=w){var G;if(d)G=String.fromCharCode(B),G==="\\"&&(G="");else if(G=String(B),M){var F=y-G.length;if(F>0){var O=new Array(F+1).join("0");B<0?G="-"+O+G.slice(1):G=O+G}}f.push(G)}}else{f=[];for(var V=0;V<p.length;V++)f.push.apply(f,uN(p[V],!1))}for(var V=0;V<f.length;V++)for(var s=0;s<o.length;s++){var a=n+f[V]+o[s];(!e||u||a)&&i.push(a)}}return i}});var YHe=z((NJi,kne)=>{"use strict";var xd=kne.exports=(t,e,i={})=>(g6(e),!i.nocomment&&e.charAt(0)==="#"?!1:new gT(e,i).match(t));kne.exports=xd;var Dne=AHe();xd.sep=Dne.sep;var Dh=Symbol("globstar **");xd.GLOBSTAR=Dh;var RBt=VHe(),jHe={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Mne="[^/]",Ane=Mne+"*?",ABt="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",IBt="(?:(?!(?:\\/|^)\\.).)*?",UHe=t=>t.split("").reduce((e,i)=>(e[i]=!0,e),{}),zHe=UHe("().*{}+?[]^$\\!"),DBt=UHe("[.("),WHe=/\/+/;xd.filter=(t,e={})=>(i,r,n)=>xd(i,t,e);var v0=(t,e={})=>{let i={};return Object.keys(t).forEach(r=>i[r]=t[r]),Object.keys(e).forEach(r=>i[r]=e[r]),i};xd.defaults=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return xd;let e=xd,i=(r,n,o)=>e(r,n,v0(t,o));return i.Minimatch=class extends e.Minimatch{constructor(n,o){super(n,v0(t,o))}},i.Minimatch.defaults=r=>e.defaults(v0(t,r)).Minimatch,i.filter=(r,n)=>e.filter(r,v0(t,n)),i.defaults=r=>e.defaults(v0(t,r)),i.makeRe=(r,n)=>e.makeRe(r,v0(t,n)),i.braceExpand=(r,n)=>e.braceExpand(r,v0(t,n)),i.match=(r,n,o)=>e.match(r,n,v0(t,o)),i};xd.braceExpand=(t,e)=>qHe(t,e);var qHe=(t,e={})=>(g6(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:RBt(t)),MBt=1024*64,g6=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>MBt)throw new TypeError("pattern is too long")},Ine=Symbol("subparse");xd.makeRe=(t,e)=>new gT(t,e||{}).makeRe();xd.match=(t,e,i={})=>{let r=new gT(e,i);return t=t.filter(n=>r.match(n)),r.options.nonull&&!t.length&&t.push(e),t};var kBt=t=>t.replace(/\\(.)/g,"$1"),OBt=t=>t.replace(/\\([^-\]])/g,"$1"),NBt=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),PBt=t=>t.replace(/[[\]\\]/g,"\\$&"),gT=class{constructor(e,i){g6(e),i||(i={}),this.options=i,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!i.windowsPathsNoEscape||i.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!i.partial,this.make()}debug(){}make(){let e=this.pattern,i=this.options;if(!i.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();i.debug&&(this.debug=(...n)=>console.error(...n)),this.debug(this.pattern,r),r=this.globParts=r.map(n=>n.split(WHe)),this.debug(this.pattern,r),r=r.map((n,o,s)=>n.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(n=>n.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,i=!1,r=0;for(let n=0;n<e.length&&e.charAt(n)==="!";n++)i=!i,r++;r&&(this.pattern=e.slice(r)),this.negate=i}matchOne(e,i,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:i}),this.debug("matchOne",e.length,i.length);for(var o=0,s=0,a=e.length,c=i.length;o<a&&s<c;o++,s++){this.debug("matchOne loop");var d=i[s],u=e[o];if(this.debug(i,d,u),d===!1)return!1;if(d===Dh){this.debug("GLOBSTAR",[i,d,u]);var h=o,p=s+1;if(p===c){for(this.debug("** at the end");o<a;o++)if(e[o]==="."||e[o]===".."||!n.dot&&e[o].charAt(0)===".")return!1;return!0}for(;h<a;){var f=e[h];if(this.debug(`
globstar while`,e,h,i,p,f),this.matchOne(e.slice(h),i.slice(p),r))return this.debug("globstar found match!",h,a,f),!0;if(f==="."||f===".."||!n.dot&&f.charAt(0)==="."){this.debug("dot detected!",e,h,i,p);break}this.debug("globstar swallow a segment, and continue"),h++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,h,i,p),h===a))}var m;if(typeof d=="string"?(m=u===d,this.debug("string match",d,u,m)):(m=u.match(d),this.debug("pattern match",d,u,m)),!m)return!1}if(o===a&&s===c)return!0;if(o===a)return r;if(s===c)return o===a-1&&e[o]==="";throw new Error("wtf?")}braceExpand(){return qHe(this.pattern,this.options)}parse(e,i){g6(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return Dh;if(e==="")return"";let n="",o=!1,s=!1,a=[],c=[],d,u=!1,h=-1,p=-1,f,m,g,y=e.charAt(0)===".",w=r.dot||y,x=()=>y?"":w?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",T=F=>F.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",M=()=>{if(d){switch(d){case"*":n+=Ane,o=!0;break;case"?":n+=Mne,o=!0;break;default:n+="\\"+d;break}this.debug("clearStateChar %j %j",d,n),d=!1}};for(let F=0,O;F<e.length&&(O=e.charAt(F));F++){if(this.debug("%s	%s %s %j",e,F,n,O),s){if(O==="/")return!1;zHe[O]&&(n+="\\"),n+=O,s=!1;continue}switch(O){case"/":return!1;case"\\":if(u&&e.charAt(F+1)==="-"){n+=O;continue}M(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,F,n,O),u){this.debug("  in class"),O==="!"&&F===p+1&&(O="^"),n+=O;continue}this.debug("call clearStateChar %j",d),M(),d=O,r.noext&&M();continue;case"(":{if(u){n+="(";continue}if(!d){n+="\\(";continue}let V={type:d,start:F-1,reStart:n.length,open:jHe[d].open,close:jHe[d].close};this.debug(this.pattern,"	",V),a.push(V),n+=V.open,V.start===0&&V.type!=="!"&&(y=!0,n+=T(e.slice(F+1))),this.debug("plType %j %j",d,n),d=!1;continue}case")":{let V=a[a.length-1];if(u||!V){n+="\\)";continue}a.pop(),M(),o=!0,m=V,n+=m.close,m.type==="!"&&c.push(Object.assign(m,{reEnd:n.length}));continue}case"|":{let V=a[a.length-1];if(u||!V){n+="\\|";continue}M(),n+="|",V.start===0&&V.type!=="!"&&(y=!0,n+=T(e.slice(F+1)));continue}case"[":if(M(),u){n+="\\"+O;continue}u=!0,p=F,h=n.length,n+=O;continue;case"]":if(F===p+1||!u){n+="\\"+O;continue}f=e.substring(p+1,F);try{RegExp("["+PBt(OBt(f))+"]"),n+=O}catch{n=n.substring(0,h)+"(?:$.)"}o=!0,u=!1;continue;default:M(),zHe[O]&&!(O==="^"&&u)&&(n+="\\"),n+=O;break}}for(u&&(f=e.slice(p+1),g=this.parse(f,Ine),n=n.substring(0,h)+"\\["+g[0],o=o||g[1]),m=a.pop();m;m=a.pop()){let F;F=n.slice(m.reStart+m.open.length),this.debug("setting tail",n,m),F=F.replace(/((?:\\{2}){0,64})(\\?)\|/g,(V,J,N)=>(N||(N="\\"),J+J+N+"|")),this.debug(`tail=%j
   %s`,F,F,m,n);let O=m.type==="*"?Ane:m.type==="?"?Mne:"\\"+m.type;o=!0,n=n.slice(0,m.reStart)+O+"\\("+F}M(),s&&(n+="\\\\");let B=DBt[n.charAt(0)];for(let F=c.length-1;F>-1;F--){let O=c[F],V=n.slice(0,O.reStart),J=n.slice(O.reStart,O.reEnd-8),N=n.slice(O.reEnd),P=n.slice(O.reEnd-8,O.reEnd)+N,$=V.split(")").length,K=V.split("(").length-$,ve=N;for(let ee=0;ee<K;ee++)ve=ve.replace(/\)[+*?]?/,"");N=ve;let W=N===""&&i!==Ine?"(?:$|\\/)":"";n=V+J+N+W+P}if(n!==""&&o&&(n="(?=.)"+n),B&&(n=x()+n),i===Ine)return[n,o];if(r.nocase&&!o&&(o=e.toUpperCase()!==e.toLowerCase()),!o)return kBt(e);let G=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+n+"$",G),{_glob:e,_src:n})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let i=this.options,r=i.noglobstar?Ane:i.dot?ABt:IBt,n=i.nocase?"i":"",o=e.map(s=>(s=s.map(a=>typeof a=="string"?NBt(a):a===Dh?Dh:a._src).reduce((a,c)=>(a[a.length-1]===Dh&&c===Dh||a.push(c),a),[]),s.forEach((a,c)=>{a!==Dh||s[c-1]===Dh||(c===0?s.length>1?s[c+1]="(?:\\/|"+r+"\\/)?"+s[c+1]:s[c]=r:c===s.length-1?s[c-1]+="(?:\\/|"+r+")?":(s[c-1]+="(?:\\/|\\/"+r+"\\/)"+s[c+1],s[c+1]=Dh))}),s.filter(a=>a!==Dh).join("/"))).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,n)}catch{this.regexp=!1}return this.regexp}match(e,i=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&i)return!0;let r=this.options;Dne.sep!=="/"&&(e=e.split(Dne.sep).join("/")),e=e.split(WHe),this.debug(this.pattern,"split",e);let n=this.set;this.debug(this.pattern,"set",n);let o;for(let s=e.length-1;s>=0&&(o=e[s],!o);s--);for(let s=0;s<n.length;s++){let a=n[s],c=e;if(r.matchBase&&a.length===1&&(c=[o]),this.matchOne(c,a,i))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return xd.defaults(e).Minimatch}};xd.Minimatch=gT});var ZHe=z((PJi,KHe)=>{"use strict";KHe.exports=XHe;var Nne=Ze("fs"),{EventEmitter:LBt}=Ze("events"),{Minimatch:One}=YHe(),{resolve:FBt}=Ze("path");function HBt(t,e){return new Promise((i,r)=>{Nne.readdir(t,{withFileTypes:!0},(n,o)=>{if(n)switch(n.code){case"ENOTDIR":e?r(n):i([]);break;case"ENOTSUP":case"ENOENT":case"ENAMETOOLONG":case"UNKNOWN":i([]);break;case"ELOOP":default:r(n);break}else i(o)})})}function $He(t,e){return new Promise((i,r)=>{(e?Nne.stat:Nne.lstat)(t,(o,s)=>{if(o)switch(o.code){case"ENOENT":i(e?$He(t,!1):null);break;default:i(null);break}else i(s)})})}function GHe(t,e,i,r,n,o){return dc(this,null,function*(){let s=yield new _o(HBt(e+t,o));for(let a of s){let c=a.name;c===void 0&&(c=a,r=!0);let d=t+"/"+c,u=d.slice(1),h=e+"/"+u,p=null;(r||i)&&(p=yield new _o($He(h,i))),!p&&a.name!==void 0&&(p=a),p===null&&(p={isDirectory:()=>!1}),p.isDirectory()?n(u)||(yield{relative:u,absolute:h,stats:p},yield*af(GHe(d,e,i,r,n,!1))):yield{relative:u,absolute:h,stats:p}}})}function BBt(t,e,i,r){return dc(this,null,function*(){yield*af(GHe("",t,e,i,r,!0))})}function VBt(t){return{pattern:t.pattern,dot:!!t.dot,noglobstar:!!t.noglobstar,matchBase:!!t.matchBase,nocase:!!t.nocase,ignore:t.ignore,skip:t.skip,follow:!!t.follow,stat:!!t.stat,nodir:!!t.nodir,mark:!!t.mark,silent:!!t.silent,absolute:!!t.absolute}}var v6=class extends LBt{constructor(e,i,r){if(super(),typeof i=="function"&&(r=i,i=null),this.options=VBt(i||{}),this.matchers=[],this.options.pattern){let n=Array.isArray(this.options.pattern)?this.options.pattern:[this.options.pattern];this.matchers=n.map(o=>new One(o,{dot:this.options.dot,noglobstar:this.options.noglobstar,matchBase:this.options.matchBase,nocase:this.options.nocase}))}if(this.ignoreMatchers=[],this.options.ignore){let n=Array.isArray(this.options.ignore)?this.options.ignore:[this.options.ignore];this.ignoreMatchers=n.map(o=>new One(o,{dot:!0}))}if(this.skipMatchers=[],this.options.skip){let n=Array.isArray(this.options.skip)?this.options.skip:[this.options.skip];this.skipMatchers=n.map(o=>new One(o,{dot:!0}))}this.iterator=BBt(FBt(e||"."),this.options.follow,this.options.stat,this._shouldSkipDirectory.bind(this)),this.paused=!1,this.inactive=!1,this.aborted=!1,r&&(this._matches=[],this.on("match",n=>this._matches.push(this.options.absolute?n.absolute:n.relative)),this.on("error",n=>r(n)),this.on("end",()=>r(null,this._matches))),setTimeout(()=>this._next(),0)}_shouldSkipDirectory(e){return this.skipMatchers.some(i=>i.match(e))}_fileMatches(e,i){let r=e+(i?"/":"");return(this.matchers.length===0||this.matchers.some(n=>n.match(r)))&&!this.ignoreMatchers.some(n=>n.match(r))&&(!this.options.nodir||!i)}_next(){!this.paused&&!this.aborted?this.iterator.next().then(e=>{if(e.done)this.emit("end");else{let i=e.value.stats.isDirectory();if(this._fileMatches(e.value.relative,i)){let r=e.value.relative,n=e.value.absolute;this.options.mark&&i&&(r+="/",n+="/"),this.options.stat?this.emit("match",{relative:r,absolute:n,stat:e.value.stats}):this.emit("match",{relative:r,absolute:n})}this._next(this.iterator)}}).catch(e=>{this.abort(),this.emit("error",e),!e.code&&!this.options.silent&&console.error(e)}):this.inactive=!0}abort(){this.aborted=!0}pause(){this.paused=!0}resume(){this.paused=!1,this.inactive&&(this.inactive=!1,this._next())}};function XHe(t,e,i){return new v6(t,e,i)}XHe.ReaddirGlob=v6});var XBe={};fW(XBe,{all:()=>Wne,allLimit:()=>Une,allSeries:()=>qne,any:()=>Qne,anyLimit:()=>Jne,anySeries:()=>eoe,apply:()=>rBe,applyEach:()=>cBe,applyEachSeries:()=>dBe,asyncify:()=>_6,auto:()=>roe,autoInject:()=>uBe,cargo:()=>hBe,cargoQueue:()=>fBe,compose:()=>pBe,concat:()=>Fne,concatLimit:()=>pN,concatSeries:()=>Hne,constant:()=>mBe,default:()=>q3t,detect:()=>Bne,detectLimit:()=>Vne,detectSeries:()=>jne,dir:()=>vBe,doDuring:()=>y6,doUntil:()=>bBe,doWhilst:()=>y6,during:()=>E6,each:()=>zne,eachLimit:()=>w6,eachOf:()=>Iu,eachOfLimit:()=>fN,eachOfSeries:()=>wp,eachSeries:()=>C6,ensureAsync:()=>soe,every:()=>Wne,everyLimit:()=>Une,everySeries:()=>qne,filter:()=>Yne,filterLimit:()=>$ne,filterSeries:()=>Gne,find:()=>Bne,findLimit:()=>Vne,findSeries:()=>jne,flatMap:()=>Fne,flatMapLimit:()=>pN,flatMapSeries:()=>Hne,foldl:()=>vT,foldr:()=>Kne,forEach:()=>zne,forEachLimit:()=>w6,forEachOf:()=>Iu,forEachOfLimit:()=>fN,forEachOfSeries:()=>wp,forEachSeries:()=>C6,forever:()=>yBe,groupBy:()=>wBe,groupByLimit:()=>D6,groupBySeries:()=>CBe,inject:()=>vT,log:()=>xBe,map:()=>A6,mapLimit:()=>vN,mapSeries:()=>ioe,mapValues:()=>SBe,mapValuesLimit:()=>M6,mapValuesSeries:()=>EBe,memoize:()=>TBe,nextTick:()=>RBe,parallel:()=>ABe,parallelLimit:()=>IBe,priorityQueue:()=>DBe,queue:()=>loe,race:()=>MBe,reduce:()=>vT,reduceRight:()=>Kne,reflect:()=>x6,reflectAll:()=>kBe,reject:()=>OBe,rejectLimit:()=>NBe,rejectSeries:()=>PBe,retry:()=>S6,retryable:()=>HBe,select:()=>Yne,selectLimit:()=>$ne,selectSeries:()=>Gne,seq:()=>ooe,series:()=>BBe,setImmediate:()=>b0,some:()=>Qne,someLimit:()=>Jne,someSeries:()=>eoe,sortBy:()=>VBe,timeout:()=>jBe,times:()=>zBe,timesLimit:()=>k6,timesSeries:()=>WBe,transform:()=>UBe,tryEach:()=>qBe,unmemoize:()=>YBe,until:()=>$Be,waterfall:()=>GBe,whilst:()=>E6,wrapSync:()=>_6});function rBe(t,...e){return(...i)=>t(...e,...i)}function mN(t){return function(...e){var i=e.pop();return t.call(this,e,i)}}function sBe(t){setTimeout(t,0)}function aBe(t){return(e,...i)=>t(()=>e(...i))}function _6(t){return gN(t)?function(...e){let i=e.pop(),r=t.apply(this,e);return QHe(r,i)}:mN(function(e,i){var r;try{r=t.apply(this,e)}catch(n){return i(n)}if(r&&typeof r.then=="function")return QHe(r,i);i(null,r)})}function QHe(t,e){return t.then(i=>{JHe(e,null,i)},i=>{JHe(e,i&&(i instanceof Error||i.message)?i:new Error(i))})}function JHe(t,e,i){try{t(e,i)}catch(r){b0(n=>{throw n},r)}}function gN(t){return t[Symbol.toStringTag]==="AsyncFunction"}function zBt(t){return t[Symbol.toStringTag]==="AsyncGenerator"}function WBt(t){return typeof t[Symbol.asyncIterator]=="function"}function fr(t){if(typeof t!="function")throw new Error("expected a function");return gN(t)?_6(t):t}function lr(t,e){if(e||(e=t.length),!e)throw new Error("arity is undefined");function i(...r){return typeof r[e-1]=="function"?t.apply(this,r):new Promise((n,o)=>{r[e-1]=(s,...a)=>{if(s)return o(s);n(a.length>1?a:a[0])},t.apply(this,r)})}return i}function lBe(t){return function(i,...r){return lr(function(o){var s=this;return t(i,(a,c)=>{fr(a).apply(s,r.concat(c))},o)})}}function toe(t,e,i,r){e=e||[];var n=[],o=0,s=fr(i);return t(e,(a,c,d)=>{var u=o++;s(a,(h,p)=>{n[u]=p,d(h)})},a=>{r(a,n)})}function T6(t){return t&&typeof t.length=="number"&&t.length>=0&&t.length%1===0}function _0(t){function e(...i){if(t!==null){var r=t;t=null,r.apply(this,i)}}return Object.assign(e,t),e}function UBt(t){return t[Symbol.iterator]&&t[Symbol.iterator]()}function qBt(t){var e=-1,i=t.length;return function(){return++e<i?{value:t[e],key:e}:null}}function YBt(t){var e=-1;return function(){var r=t.next();return r.done?null:(e++,{value:r.value,key:e})}}function $Bt(t){var e=t?Object.keys(t):[],i=-1,r=e.length;return function n(){var o=e[++i];return o==="__proto__"?n():i<r?{value:t[o],key:o}:null}}function GBt(t){if(T6(t))return qBt(t);var e=UBt(t);return e?YBt(e):$Bt(t)}function y0(t){return function(...e){if(t===null)throw new Error("Callback was already called.");var i=t;t=null,i.apply(this,e)}}function eBe(t,e,i,r){let n=!1,o=!1,s=!1,a=0,c=0;function d(){a>=e||s||n||(s=!0,t.next().then(({value:p,done:f})=>{if(!(o||n)){if(s=!1,f){n=!0,a<=0&&r(null);return}a++,i(p,c,u),c++,d()}}).catch(h))}function u(p,f){if(a-=1,!o){if(p)return h(p);if(p===!1){n=!0,o=!0;return}if(f===R6||n&&a<=0)return n=!0,r(null);d()}}function h(p){o||(s=!1,n=!0,r(p))}d()}function XBt(t,e,i,r){return Mh(e)(t,fr(i),r)}function KBt(t,e,i){i=_0(i);var r=0,n=0,{length:o}=t,s=!1;o===0&&i(null);function a(c,d){c===!1&&(s=!0),s!==!0&&(c?i(c):(++n===o||d===R6)&&i(null))}for(;r<o;r++)e(t[r],r,y0(a))}function ZBt(t,e,i){return fN(t,1/0,e,i)}function QBt(t,e,i){var r=T6(t)?KBt:ZBt;return r(t,fr(e),i)}function JBt(t,e,i){return toe(Iu,t,e,i)}function e3t(t,e,i){return fN(t,1,e,i)}function t3t(t,e,i){return toe(wp,t,e,i)}function bT(){let t,e;function i(r,...n){if(r)return e(r);t(n.length>1?n:n[0])}return i[_T]=new Promise((r,n)=>{t=r,e=n}),i}function roe(t,e,i){typeof e!="number"&&(i=e,e=null),i=_0(i||bT());var r=Object.keys(t).length;if(!r)return i(null);e||(e=r);var n={},o=0,s=!1,a=!1,c=Object.create(null),d=[],u=[],h={};Object.keys(t).forEach(T=>{var M=t[T];if(!Array.isArray(M)){p(T,[M]),u.push(T);return}var B=M.slice(0,M.length-1),G=B.length;if(G===0){p(T,M),u.push(T);return}h[T]=G,B.forEach(F=>{if(!t[F])throw new Error("async.auto task `"+T+"` has a non-existent dependency `"+F+"` in "+B.join(", "));m(F,()=>{G--,G===0&&p(T,M)})})}),w(),f();function p(T,M){d.push(()=>y(T,M))}function f(){if(!s){if(d.length===0&&o===0)return i(null,n);for(;d.length&&o<e;){var T=d.shift();T()}}}function m(T,M){var B=c[T];B||(B=c[T]=[]),B.push(M)}function g(T){var M=c[T]||[];M.forEach(B=>B()),f()}function y(T,M){if(!a){var B=y0((F,...O)=>{if(o--,F===!1){s=!0;return}if(O.length<2&&([O]=O),F){var V={};if(Object.keys(n).forEach(J=>{V[J]=n[J]}),V[T]=O,a=!0,c=Object.create(null),s)return;i(F,V)}else n[T]=O,g(T)});o++;var G=fr(M[M.length-1]);M.length>1?G(n,B):G(B)}}function w(){for(var T,M=0;u.length;)T=u.pop(),M++,x(T).forEach(B=>{--h[B]===0&&u.push(B)});if(M!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function x(T){var M=[];return Object.keys(t).forEach(B=>{let G=t[B];Array.isArray(G)&&G.indexOf(T)>=0&&M.push(B)}),M}return i[_T]}function s3t(t){let e="",i=0,r=t.indexOf("*/");for(;i<t.length;)if(t[i]==="/"&&t[i+1]==="/"){let n=t.indexOf(`
`,i);i=n===-1?t.length:n}else if(r!==-1&&t[i]==="/"&&t[i+1]==="*"){let n=t.indexOf("*/",i);n!==-1?(i=n+2,r=t.indexOf("*/",i)):(e+=t[i],i++)}else e+=t[i],i++;return e}function a3t(t){let e=s3t(t.toString()),i=e.match(i3t);if(i||(i=e.match(r3t)),!i)throw new Error(`could not parse args in autoInject
Source:
`+e);let[,r]=i;return r.replace(/\s/g,"").split(n3t).map(n=>n.replace(o3t,"").trim())}function uBe(t,e){var i={};return Object.keys(t).forEach(r=>{var n=t[r],o,s=gN(n),a=!s&&n.length===1||s&&n.length===0;if(Array.isArray(n))o=[...n],n=o.pop(),i[r]=o.concat(o.length>0?c:n);else if(a)i[r]=n;else{if(o=a3t(n),n.length===0&&!s&&o.length===0)throw new Error("autoInject task functions require explicit parameters.");s||o.pop(),i[r]=o.concat(c)}function c(d,u){var h=o.map(p=>d[p]);h.push(u),fr(n)(...h)}}),roe(i,e)}function tBe(t,e){t.length=1,t.head=t.tail=e}function noe(t,e,i){if(e==null)e=1;else if(e===0)throw new RangeError("Concurrency must not be zero");var r=fr(t),n=0,o=[];let s={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function a(x,T){s[x].push(T)}function c(x,T){let M=(...B)=>{d(x,M),T(...B)};s[x].push(M)}function d(x,T){if(!x)return Object.keys(s).forEach(M=>s[M]=[]);if(!T)return s[x]=[];s[x]=s[x].filter(M=>M!==T)}function u(x,...T){s[x].forEach(M=>M(...T))}var h=!1;function p(x,T,M,B){if(B!=null&&typeof B!="function")throw new Error("task callback must be a function");w.started=!0;var G,F;function O(J,...N){if(J)return M?F(J):G();if(N.length<=1)return G(N[0]);G(N)}var V=w._createTaskItem(x,M?O:B||O);if(T?w._tasks.unshift(V):w._tasks.push(V),h||(h=!0,b0(()=>{h=!1,w.process()})),M||!B)return new Promise((J,N)=>{G=J,F=N})}function f(x){return function(T,...M){n-=1;for(var B=0,G=x.length;B<G;B++){var F=x[B],O=o.indexOf(F);O===0?o.shift():O>0&&o.splice(O,1),F.callback(T,...M),T!=null&&u("error",T,F.data)}n<=w.concurrency-w.buffer&&u("unsaturated"),w.idle()&&u("drain"),w.process()}}function m(x){return x.length===0&&w.idle()?(b0(()=>u("drain")),!0):!1}let g=x=>T=>{if(!T)return new Promise((M,B)=>{c(x,(G,F)=>{if(G)return B(G);M(F)})});d(x),a(x,T)};var y=!1,w={_tasks:new Lne,_createTaskItem(x,T){return{data:x,callback:T}},*[Symbol.iterator](){yield*af(w._tasks[Symbol.iterator]())},concurrency:e,payload:i,buffer:e/4,started:!1,paused:!1,push(x,T){return Array.isArray(x)?m(x)?void 0:x.map(M=>p(M,!1,!1,T)):p(x,!1,!1,T)},pushAsync(x,T){return Array.isArray(x)?m(x)?void 0:x.map(M=>p(M,!1,!0,T)):p(x,!1,!0,T)},kill(){d(),w._tasks.empty()},unshift(x,T){return Array.isArray(x)?m(x)?void 0:x.map(M=>p(M,!0,!1,T)):p(x,!0,!1,T)},unshiftAsync(x,T){return Array.isArray(x)?m(x)?void 0:x.map(M=>p(M,!0,!0,T)):p(x,!0,!0,T)},remove(x){w._tasks.remove(x)},process(){if(!y){for(y=!0;!w.paused&&n<w.concurrency&&w._tasks.length;){var x=[],T=[],M=w._tasks.length;w.payload&&(M=Math.min(M,w.payload));for(var B=0;B<M;B++){var G=w._tasks.shift();x.push(G),o.push(G),T.push(G.data)}n+=1,w._tasks.length===0&&u("empty"),n===w.concurrency&&u("saturated");var F=y0(f(x));r(T,F)}y=!1}},length(){return w._tasks.length},running(){return n},workersList(){return o},idle(){return w._tasks.length+n===0},pause(){w.paused=!0},resume(){w.paused!==!1&&(w.paused=!1,b0(w.process))}};return Object.defineProperties(w,{saturated:{writable:!1,value:g("saturated")},unsaturated:{writable:!1,value:g("unsaturated")},empty:{writable:!1,value:g("empty")},drain:{writable:!1,value:g("drain")},error:{writable:!1,value:g("error")}}),w}function hBe(t,e){return noe(t,1,e)}function fBe(t,e,i){return noe(t,e,i)}function l3t(t,e,i,r){r=_0(r);var n=fr(i);return wp(t,(o,s,a)=>{n(e,o,(c,d)=>{e=d,a(c)})},o=>r(o,e))}function ooe(...t){var e=t.map(fr);return function(...i){var r=this,n=i[i.length-1];return typeof n=="function"?i.pop():n=bT(),vT(e,i,(o,s,a)=>{s.apply(r,o.concat((c,...d)=>{a(c,d)}))},(o,s)=>n(o,...s)),n[_T]}}function pBe(...t){return ooe(...t.reverse())}function c3t(t,e,i,r){return toe(Mh(e),t,i,r)}function d3t(t,e,i,r){var n=fr(i);return vN(t,e,(o,s)=>{n(o,(a,...c)=>a?s(a):s(a,c))},(o,s)=>{for(var a=[],c=0;c<s.length;c++)s[c]&&(a=a.concat(...s[c]));return r(o,a)})}function u3t(t,e,i){return pN(t,1/0,e,i)}function h3t(t,e,i){return pN(t,1,e,i)}function mBe(...t){return function(...e){var i=e.pop();return i(null,...t)}}function ag(t,e){return(i,r,n,o)=>{var s=!1,a;let c=fr(n);i(r,(d,u,h)=>{c(d,(p,f)=>{if(p||p===!1)return h(p);if(t(f)&&!a)return s=!0,a=e(!0,d),h(null,R6);h()})},d=>{if(d)return o(d);o(null,s?a:e(!1))})}}function f3t(t,e,i){return ag(r=>r,(r,n)=>n)(Iu,t,e,i)}function p3t(t,e,i,r){return ag(n=>n,(n,o)=>o)(Mh(e),t,i,r)}function m3t(t,e,i){return ag(r=>r,(r,n)=>n)(Mh(1),t,e,i)}function gBe(t){return(e,...i)=>fr(e)(...i,(r,...n)=>{typeof console=="object"&&(r?console.error&&console.error(r):console[t]&&n.forEach(o=>console[t](o)))})}function g3t(t,e,i){i=y0(i);var r=fr(t),n=fr(e),o;function s(c,...d){if(c)return i(c);c!==!1&&(o=d,n(...d,a))}function a(c,d){if(c)return i(c);if(c!==!1){if(!d)return i(null,...o);r(s)}}return a(null,!0)}function bBe(t,e,i){let r=fr(e);return y6(t,(...n)=>{let o=n.pop();r(...n,(s,a)=>o(s,!a))},i)}function _Be(t){return(e,i,r)=>t(e,r)}function v3t(t,e,i){return Iu(t,_Be(fr(e)),i)}function b3t(t,e,i,r){return Mh(e)(t,_Be(fr(i)),r)}function _3t(t,e,i){return w6(t,1,e,i)}function soe(t){return gN(t)?t:function(...e){var i=e.pop(),r=!0;e.push((...n)=>{r?b0(()=>i(...n)):i(...n)}),t.apply(this,e),r=!1}}function y3t(t,e,i){return ag(r=>!r,r=>!r)(Iu,t,e,i)}function w3t(t,e,i,r){return ag(n=>!n,n=>!n)(Mh(e),t,i,r)}function C3t(t,e,i){return ag(r=>!r,r=>!r)(wp,t,e,i)}function x3t(t,e,i,r){var n=new Array(e.length);t(e,(o,s,a)=>{i(o,(c,d)=>{n[s]=!!d,a(c)})},o=>{if(o)return r(o);for(var s=[],a=0;a<e.length;a++)n[a]&&s.push(e[a]);r(null,s)})}function S3t(t,e,i,r){var n=[];t(e,(o,s,a)=>{i(o,(c,d)=>{if(c)return a(c);d&&n.push({index:s,value:o}),a(c)})},o=>{if(o)return r(o);r(null,n.sort((s,a)=>s.index-a.index).map(s=>s.value))})}function I6(t,e,i,r){var n=T6(e)?x3t:S3t;return n(t,e,fr(i),r)}function E3t(t,e,i){return I6(Iu,t,e,i)}function T3t(t,e,i,r){return I6(Mh(e),t,i,r)}function R3t(t,e,i){return I6(wp,t,e,i)}function A3t(t,e){var i=y0(e),r=fr(soe(t));function n(o){if(o)return i(o);o!==!1&&r(n)}return n()}function I3t(t,e,i,r){var n=fr(i);return vN(t,e,(o,s)=>{n(o,(a,c)=>a?s(a):s(a,{key:c,val:o}))},(o,s)=>{for(var a={},{hasOwnProperty:c}=Object.prototype,d=0;d<s.length;d++)if(s[d]){var{key:u}=s[d],{val:h}=s[d];c.call(a,u)?a[u].push(h):a[u]=[h]}return r(o,a)})}function wBe(t,e,i){return D6(t,1/0,e,i)}function CBe(t,e,i){return D6(t,1,e,i)}function D3t(t,e,i,r){r=_0(r);var n={},o=fr(i);return Mh(e)(t,(s,a,c)=>{o(s,a,(d,u)=>{if(d)return c(d);n[a]=u,c(d)})},s=>r(s,n))}function SBe(t,e,i){return M6(t,1/0,e,i)}function EBe(t,e,i){return M6(t,1,e,i)}function TBe(t,e=i=>i){var i=Object.create(null),r=Object.create(null),n=fr(t),o=mN((s,a)=>{var c=e(...s);c in i?b0(()=>a(null,...i[c])):c in r?r[c].push(a):(r[c]=[a],n(...s,(d,...u)=>{d||(i[c]=u);var h=r[c];delete r[c];for(var p=0,f=h.length;p<f;p++)h[p](d,...u)}))});return o.memo=i,o.unmemoized=t,o}function ABe(t,e){return aoe(Iu,t,e)}function IBe(t,e,i){return aoe(Mh(e),t,i)}function loe(t,e){var i=fr(t);return noe((r,n)=>{i(r[0],n)},e,1)}function M3t(t){return(t<<1)+1}function iBe(t){return(t+1>>1)-1}function Pne(t,e){return t.priority!==e.priority?t.priority<e.priority:t.pushCount<e.pushCount}function DBe(t,e){var i=loe(t,e),{push:r,pushAsync:n}=i;i._tasks=new Xne,i._createTaskItem=({data:s,priority:a},c)=>({data:s,priority:a,callback:c});function o(s,a){return Array.isArray(s)?s.map(c=>({data:c,priority:a})):{data:s,priority:a}}return i.push=function(s,a=0,c){return r(o(s,a),c)},i.pushAsync=function(s,a=0,c){return n(o(s,a),c)},delete i.unshift,delete i.unshiftAsync,i}function k3t(t,e){if(e=_0(e),!Array.isArray(t))return e(new TypeError("First argument to race must be an array of functions"));if(!t.length)return e();for(var i=0,r=t.length;i<r;i++)fr(t[i])(e)}function Kne(t,e,i,r){var n=[...t].reverse();return vT(n,e,i,r)}function x6(t){var e=fr(t);return mN(function(r,n){return r.push((o,...s)=>{let a={};if(o&&(a.error=o),s.length>0){var c=s;s.length<=1&&([c]=s),a.value=c}n(null,a)}),e.apply(this,r)})}function kBe(t){var e;return Array.isArray(t)?e=t.map(x6):(e={},Object.keys(t).forEach(i=>{e[i]=x6.call(this,t[i])})),e}function coe(t,e,i,r){let n=fr(i);return I6(t,e,(o,s)=>{n(o,(a,c)=>{s(a,!c)})},r)}function O3t(t,e,i){return coe(Iu,t,e,i)}function N3t(t,e,i,r){return coe(Mh(e),t,i,r)}function P3t(t,e,i){return coe(wp,t,e,i)}function LBe(t){return function(){return t}}function S6(t,e,i){var r={times:Zne,intervalFunc:LBe(FBe)};if(arguments.length<3&&typeof t=="function"?(i=e||bT(),e=t):(L3t(r,t),i=i||bT()),typeof e!="function")throw new Error("Invalid arguments for async.retry");var n=fr(e),o=1;function s(){n((a,...c)=>{a!==!1&&(a&&o++<r.times&&(typeof r.errorFilter!="function"||r.errorFilter(a))?setTimeout(s,r.intervalFunc(o-1)):i(a,...c))})}return s(),i[_T]}function L3t(t,e){if(typeof e=="object")t.times=+e.times||Zne,t.intervalFunc=typeof e.interval=="function"?e.interval:LBe(+e.interval||FBe),t.errorFilter=e.errorFilter;else if(typeof e=="number"||typeof e=="string")t.times=+e||Zne;else throw new Error("Invalid arguments for async.retry")}function HBe(t,e){e||(e=t,t=null);let i=t&&t.arity||e.length;gN(e)&&(i+=1);var r=fr(e);return mN((n,o)=>{(n.length<i-1||o==null)&&(n.push(o),o=bT());function s(a){r(...n,a)}return t?S6(t,s,o):S6(s,o),o[_T]})}function BBe(t,e){return aoe(wp,t,e)}function F3t(t,e,i){return ag(Boolean,r=>r)(Iu,t,e,i)}function H3t(t,e,i,r){return ag(Boolean,n=>n)(Mh(e),t,i,r)}function B3t(t,e,i){return ag(Boolean,r=>r)(wp,t,e,i)}function V3t(t,e,i){var r=fr(e);return A6(t,(o,s)=>{r(o,(a,c)=>{if(a)return s(a);s(a,{value:o,criteria:c})})},(o,s)=>{if(o)return i(o);i(null,s.sort(n).map(a=>a.value))});function n(o,s){var a=o.criteria,c=s.criteria;return a<c?-1:a>c?1:0}}function jBe(t,e,i){var r=fr(t);return mN((n,o)=>{var s=!1,a;function c(){var d=t.name||"anonymous",u=new Error('Callback function "'+d+'" timed out.');u.code="ETIMEDOUT",i&&(u.info=i),s=!0,o(u)}n.push((...d)=>{s||(o(...d),clearTimeout(a))}),a=setTimeout(c,e),r(...n)})}function j3t(t){for(var e=Array(t);t--;)e[t]=t;return e}function k6(t,e,i,r){var n=fr(i);return vN(j3t(t),e,n,r)}function zBe(t,e,i){return k6(t,1/0,e,i)}function WBe(t,e,i){return k6(t,1,e,i)}function UBe(t,e,i,r){arguments.length<=3&&typeof e=="function"&&(r=i,i=e,e=Array.isArray(t)?[]:{}),r=_0(r||bT());var n=fr(i);return Iu(t,(o,s,a)=>{n(e,o,s,a)},o=>r(o,e)),r[_T]}function z3t(t,e){var i=null,r;return C6(t,(n,o)=>{fr(n)((s,...a)=>{if(s===!1)return o(s);a.length<2?[r]=a:r=a,i=s,o(s?null:{})})},()=>e(i,r))}function YBe(t){return(...e)=>(t.unmemoized||t)(...e)}function W3t(t,e,i){i=y0(i);var r=fr(e),n=fr(t),o=[];function s(c,...d){if(c)return i(c);o=d,c!==!1&&n(a)}function a(c,d){if(c)return i(c);if(c!==!1){if(!d)return i(null,...o);r(s)}}return n(a)}function $Be(t,e,i){let r=fr(t);return E6(n=>r((o,s)=>n(o,!s)),e,i)}function U3t(t,e){if(e=_0(e),!Array.isArray(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var i=0;function r(o){var s=fr(t[i++]);s(...o,y0(n))}function n(o,...s){if(o!==!1){if(o||i===t.length)return e(o,...s);r(s)}}r([])}var jBt,nBe,oBe,hN,b0,R6,Mh,fN,Iu,A6,cBe,wp,ioe,dBe,_T,i3t,r3t,n3t,o3t,Lne,vT,vN,pN,Fne,Hne,Bne,Vne,jne,vBe,y6,zne,w6,C6,Wne,Une,qne,Yne,$ne,Gne,yBe,D6,xBe,M6,b6,RBe,aoe,Xne,MBe,OBe,NBe,PBe,Zne,FBe,Qne,Jne,eoe,VBe,qBe,E6,GBe,q3t,KBe=Ja(()=>{"use strict";jBt=typeof queueMicrotask=="function"&&queueMicrotask,nBe=typeof setImmediate=="function"&&setImmediate,oBe=typeof process=="object"&&typeof process.nextTick=="function";jBt?hN=queueMicrotask:nBe?hN=setImmediate:oBe?hN=process.nextTick:hN=sBe;b0=aBe(hN);R6={};Mh=t=>(e,i,r)=>{if(r=_0(r),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return r(null);if(zBt(e))return eBe(e,t,i,r);if(WBt(e))return eBe(e[Symbol.asyncIterator](),t,i,r);var n=GBt(e),o=!1,s=!1,a=0,c=!1;function d(h,p){if(!s)if(a-=1,h)o=!0,r(h);else if(h===!1)o=!0,s=!0;else{if(p===R6||o&&a<=0)return o=!0,r(null);c||u()}}function u(){for(c=!0;a<t&&!o;){var h=n();if(h===null){o=!0,a<=0&&r(null);return}a+=1,i(h.value,h.key,y0(d))}c=!1}u()};fN=lr(XBt,4);Iu=lr(QBt,3);A6=lr(JBt,3),cBe=lBe(A6);wp=lr(e3t,3);ioe=lr(t3t,3),dBe=lBe(ioe),_T=Symbol("promiseCallback");i3t=/^(?:async\s)?(?:function)?\s*(?:\w+\s*)?\(([^)]+)\)(?:\s*{)/,r3t=/^(?:async\s)?\s*(?:\(\s*)?((?:[^)=\s]\s*)*)(?:\)\s*)?=>/,n3t=/,/,o3t=/(=.+)?(\s*)$/;Lne=class{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,i){i.prev=e,i.next=e.next,e.next?e.next.prev=i:this.tail=i,e.next=i,this.length+=1}insertBefore(e,i){i.prev=e.prev,i.next=e,e.prev?e.prev.next=i:this.head=i,e.prev=i,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):tBe(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):tBe(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var i=this.head;i;){var{next:r}=i;e(i)&&this.removeLink(i),i=r}return this}};vT=lr(l3t,4);vN=lr(c3t,4);pN=lr(d3t,4);Fne=lr(u3t,3);Hne=lr(h3t,3);Bne=lr(f3t,3);Vne=lr(p3t,4);jne=lr(m3t,3);vBe=gBe("dir");y6=lr(g3t,3);zne=lr(v3t,3);w6=lr(b3t,4);C6=lr(_3t,3);Wne=lr(y3t,3);Une=lr(w3t,4);qne=lr(C3t,3);Yne=lr(E3t,3);$ne=lr(T3t,4);Gne=lr(R3t,3);yBe=lr(A3t,2);D6=lr(I3t,4);xBe=gBe("log");M6=lr(D3t,4);oBe?b6=process.nextTick:nBe?b6=setImmediate:b6=sBe;RBe=aBe(b6),aoe=lr((t,e,i)=>{var r=T6(e)?[]:{};t(e,(n,o,s)=>{fr(n)((a,...c)=>{c.length<2&&([c]=c),r[o]=c,s(a)})},n=>i(n,r))},3);Xne=class{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(e){let i;for(;e>0&&Pne(this.heap[e],this.heap[i=iBe(e)]);){let r=this.heap[e];this.heap[e]=this.heap[i],this.heap[i]=r,e=i}}percDown(e){let i;for(;(i=M3t(e))<this.heap.length&&(i+1<this.heap.length&&Pne(this.heap[i+1],this.heap[i])&&(i=i+1),!Pne(this.heap[e],this.heap[i]));){let r=this.heap[e];this.heap[e]=this.heap[i],this.heap[i]=r,e=i}}push(e){e.pushCount=++this.pushCount,this.heap.push(e),this.percUp(this.heap.length-1)}unshift(e){return this.heap.push(e)}shift(){let[e]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),e}toArray(){return[...this]}*[Symbol.iterator](){for(let e=0;e<this.heap.length;e++)yield this.heap[e].data}remove(e){let i=0;for(let r=0;r<this.heap.length;r++)e(this.heap[r])||(this.heap[i]=this.heap[r],i++);this.heap.splice(i);for(let r=iBe(this.heap.length-1);r>=0;r--)this.percDown(r);return this}};MBe=lr(k3t,2);OBe=lr(O3t,3);NBe=lr(N3t,4);PBe=lr(P3t,3);Zne=5,FBe=0;Qne=lr(F3t,3);Jne=lr(H3t,4);eoe=lr(B3t,3);VBe=lr(V3t,3);qBe=lr(z3t);E6=lr(W3t,3);GBe=lr(U3t),q3t={apply:rBe,applyEach:cBe,applyEachSeries:dBe,asyncify:_6,auto:roe,autoInject:uBe,cargo:hBe,cargoQueue:fBe,compose:pBe,concat:Fne,concatLimit:pN,concatSeries:Hne,constant:mBe,detect:Bne,detectLimit:Vne,detectSeries:jne,dir:vBe,doUntil:bBe,doWhilst:y6,each:zne,eachLimit:w6,eachOf:Iu,eachOfLimit:fN,eachOfSeries:wp,eachSeries:C6,ensureAsync:soe,every:Wne,everyLimit:Une,everySeries:qne,filter:Yne,filterLimit:$ne,filterSeries:Gne,forever:yBe,groupBy:wBe,groupByLimit:D6,groupBySeries:CBe,log:xBe,map:A6,mapLimit:vN,mapSeries:ioe,mapValues:SBe,mapValuesLimit:M6,mapValuesSeries:EBe,memoize:TBe,nextTick:RBe,parallel:ABe,parallelLimit:IBe,priorityQueue:DBe,queue:loe,race:MBe,reduce:vT,reduceRight:Kne,reflect:x6,reflectAll:kBe,reject:OBe,rejectLimit:NBe,rejectSeries:PBe,retry:S6,retryable:HBe,seq:ooe,series:BBe,setImmediate:b0,some:Qne,someLimit:Jne,someSeries:eoe,sortBy:VBe,timeout:jBe,times:zBe,timesLimit:k6,timesSeries:WBe,transform:UBe,tryEach:qBe,unmemoize:YBe,until:$Be,waterfall:GBe,whilst:E6,all:Wne,allLimit:Une,allSeries:qne,any:Qne,anyLimit:Jne,anySeries:eoe,find:Bne,findLimit:Vne,findSeries:jne,flatMap:Fne,flatMapLimit:pN,flatMapSeries:Hne,forEach:zne,forEachSeries:C6,forEachLimit:w6,forEachOf:Iu,forEachOfSeries:wp,forEachOfLimit:fN,inject:vT,foldl:vT,foldr:Kne,select:Yne,selectLimit:$ne,selectSeries:Gne,wrapSync:_6,during:E6,doDuring:y6}});var QBe=z((HJi,ZBe)=>{"use strict";var w0=Ze("constants"),Y3t=process.cwd,O6=null,$3t=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return O6||(O6=Y3t.call(process)),O6};try{process.cwd()}catch{}typeof process.chdir=="function"&&(doe=process.chdir,process.chdir=function(t){O6=null,doe.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,doe));var doe;ZBe.exports=G3t;function G3t(t){w0.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||i(t),t.chown=o(t.chown),t.fchown=o(t.fchown),t.lchown=o(t.lchown),t.chmod=r(t.chmod),t.fchmod=r(t.fchmod),t.lchmod=r(t.lchmod),t.chownSync=s(t.chownSync),t.fchownSync=s(t.fchownSync),t.lchownSync=s(t.lchownSync),t.chmodSync=n(t.chmodSync),t.fchmodSync=n(t.fchmodSync),t.lchmodSync=n(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=c(t.statSync),t.fstatSync=c(t.fstatSync),t.lstatSync=c(t.lstatSync),t.chmod&&!t.lchmod&&(t.lchmod=function(u,h,p){p&&process.nextTick(p)},t.lchmodSync=function(){}),t.chown&&!t.lchown&&(t.lchown=function(u,h,p,f){f&&process.nextTick(f)},t.lchownSync=function(){}),$3t==="win32"&&(t.rename=typeof t.rename!="function"?t.rename:function(u){function h(p,f,m){var g=Date.now(),y=0;u(p,f,function w(x){if(x&&(x.code==="EACCES"||x.code==="EPERM"||x.code==="EBUSY")&&Date.now()-g<6e4){setTimeout(function(){t.stat(f,function(T,M){T&&T.code==="ENOENT"?u(p,f,w):m(x)})},y),y<100&&(y+=10);return}m&&m(x)})}return Object.setPrototypeOf&&Object.setPrototypeOf(h,u),h}(t.rename)),t.read=typeof t.read!="function"?t.read:function(u){function h(p,f,m,g,y,w){var x;if(w&&typeof w=="function"){var T=0;x=function(M,B,G){if(M&&M.code==="EAGAIN"&&T<10)return T++,u.call(t,p,f,m,g,y,x);w.apply(this,arguments)}}return u.call(t,p,f,m,g,y,x)}return Object.setPrototypeOf&&Object.setPrototypeOf(h,u),h}(t.read),t.readSync=typeof t.readSync!="function"?t.readSync:function(u){return function(h,p,f,m,g){for(var y=0;;)try{return u.call(t,h,p,f,m,g)}catch(w){if(w.code==="EAGAIN"&&y<10){y++;continue}throw w}}}(t.readSync);function e(u){u.lchmod=function(h,p,f){u.open(h,w0.O_WRONLY|w0.O_SYMLINK,p,function(m,g){if(m){f&&f(m);return}u.fchmod(g,p,function(y){u.close(g,function(w){f&&f(y||w)})})})},u.lchmodSync=function(h,p){var f=u.openSync(h,w0.O_WRONLY|w0.O_SYMLINK,p),m=!0,g;try{g=u.fchmodSync(f,p),m=!1}finally{if(m)try{u.closeSync(f)}catch{}else u.closeSync(f)}return g}}function i(u){w0.hasOwnProperty("O_SYMLINK")&&u.futimes?(u.lutimes=function(h,p,f,m){u.open(h,w0.O_SYMLINK,function(g,y){if(g){m&&m(g);return}u.futimes(y,p,f,function(w){u.close(y,function(x){m&&m(w||x)})})})},u.lutimesSync=function(h,p,f){var m=u.openSync(h,w0.O_SYMLINK),g,y=!0;try{g=u.futimesSync(m,p,f),y=!1}finally{if(y)try{u.closeSync(m)}catch{}else u.closeSync(m)}return g}):u.futimes&&(u.lutimes=function(h,p,f,m){m&&process.nextTick(m)},u.lutimesSync=function(){})}function r(u){return u&&function(h,p,f){return u.call(t,h,p,function(m){d(m)&&(m=null),f&&f.apply(this,arguments)})}}function n(u){return u&&function(h,p){try{return u.call(t,h,p)}catch(f){if(!d(f))throw f}}}function o(u){return u&&function(h,p,f,m){return u.call(t,h,p,f,function(g){d(g)&&(g=null),m&&m.apply(this,arguments)})}}function s(u){return u&&function(h,p,f){try{return u.call(t,h,p,f)}catch(m){if(!d(m))throw m}}}function a(u){return u&&function(h,p,f){typeof p=="function"&&(f=p,p=null);function m(g,y){y&&(y.uid<0&&(y.uid+=4294967296),y.gid<0&&(y.gid+=4294967296)),f&&f.apply(this,arguments)}return p?u.call(t,h,p,m):u.call(t,h,m)}}function c(u){return u&&function(h,p){var f=p?u.call(t,h,p):u.call(t,h);return f&&(f.uid<0&&(f.uid+=4294967296),f.gid<0&&(f.gid+=4294967296)),f}}function d(u){if(!u||u.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(u.code==="EINVAL"||u.code==="EPERM"))}}});var t3e=z((BJi,e3e)=>{"use strict";var JBe=Ze("stream").Stream;e3e.exports=X3t;function X3t(t){return{ReadStream:e,WriteStream:i};function e(r,n){if(!(this instanceof e))return new e(r,n);JBe.call(this);var o=this;this.path=r,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,n=n||{};for(var s=Object.keys(n),a=0,c=s.length;a<c;a++){var d=s[a];this[d]=n[d]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}t.open(this.path,this.flags,this.mode,function(u,h){if(u){o.emit("error",u),o.readable=!1;return}o.fd=h,o.emit("open",h),o._read()})}function i(r,n){if(!(this instanceof i))return new i(r,n);JBe.call(this),this.path=r,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var o=Object.keys(n),s=0,a=o.length;s<a;s++){var c=o[s];this[c]=n[c]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var r3e=z((VJi,i3e)=>{"use strict";i3e.exports=Z3t;var K3t=Object.getPrototypeOf||function(t){return t.__proto__};function Z3t(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:K3t(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}),e}});var jc=z((jJi,foe)=>{"use strict";var Lo=Ze("fs"),Q3t=QBe(),J3t=t3e(),e4t=r3e(),N6=Ze("util"),ja,L6;typeof Symbol=="function"&&typeof Symbol.for=="function"?(ja=Symbol.for("graceful-fs.queue"),L6=Symbol.for("graceful-fs.previous")):(ja="___graceful-fs.queue",L6="___graceful-fs.previous");function t4t(){}function s3e(t,e){Object.defineProperty(t,ja,{get:function(){return e}})}var Hw=t4t;N6.debuglog?Hw=N6.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Hw=function(){var t=N6.format.apply(N6,arguments);t="GFS4: "+t.split(/\n/).join(`
GFS4: `),console.error(t)});Lo[ja]||(n3e=global[ja]||[],s3e(Lo,n3e),Lo.close=function(t){function e(i,r){return t.call(Lo,i,function(n){n||o3e(),typeof r=="function"&&r.apply(this,arguments)})}return Object.defineProperty(e,L6,{value:t}),e}(Lo.close),Lo.closeSync=function(t){function e(i){t.apply(Lo,arguments),o3e()}return Object.defineProperty(e,L6,{value:t}),e}(Lo.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Hw(Lo[ja]),Ze("assert").equal(Lo[ja].length,0)}));var n3e;global[ja]||s3e(global,Lo[ja]);foe.exports=uoe(e4t(Lo));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!Lo.__patched&&(foe.exports=uoe(Lo),Lo.__patched=!0);function uoe(t){Q3t(t),t.gracefulify=uoe,t.createReadStream=B,t.createWriteStream=G;var e=t.readFile;t.readFile=i;function i(V,J,N){return typeof J=="function"&&(N=J,J=null),P(V,J,N);function P($,K,ve,W){return e($,K,function(ee){ee&&(ee.code==="EMFILE"||ee.code==="ENFILE")?yT([P,[$,K,ve],ee,W||Date.now(),Date.now()]):typeof ve=="function"&&ve.apply(this,arguments)})}}var r=t.writeFile;t.writeFile=n;function n(V,J,N,P){return typeof N=="function"&&(P=N,N=null),$(V,J,N,P);function $(K,ve,W,ee,te){return r(K,ve,W,function(se){se&&(se.code==="EMFILE"||se.code==="ENFILE")?yT([$,[K,ve,W,ee],se,te||Date.now(),Date.now()]):typeof ee=="function"&&ee.apply(this,arguments)})}}var o=t.appendFile;o&&(t.appendFile=s);function s(V,J,N,P){return typeof N=="function"&&(P=N,N=null),$(V,J,N,P);function $(K,ve,W,ee,te){return o(K,ve,W,function(se){se&&(se.code==="EMFILE"||se.code==="ENFILE")?yT([$,[K,ve,W,ee],se,te||Date.now(),Date.now()]):typeof ee=="function"&&ee.apply(this,arguments)})}}var a=t.copyFile;a&&(t.copyFile=c);function c(V,J,N,P){return typeof N=="function"&&(P=N,N=0),$(V,J,N,P);function $(K,ve,W,ee,te){return a(K,ve,W,function(se){se&&(se.code==="EMFILE"||se.code==="ENFILE")?yT([$,[K,ve,W,ee],se,te||Date.now(),Date.now()]):typeof ee=="function"&&ee.apply(this,arguments)})}}var d=t.readdir;t.readdir=h;var u=/^v[0-5]\./;function h(V,J,N){typeof J=="function"&&(N=J,J=null);var P=u.test(process.version)?function(ve,W,ee,te){return d(ve,$(ve,W,ee,te))}:function(ve,W,ee,te){return d(ve,W,$(ve,W,ee,te))};return P(V,J,N);function $(K,ve,W,ee){return function(te,se){te&&(te.code==="EMFILE"||te.code==="ENFILE")?yT([P,[K,ve,W],te,ee||Date.now(),Date.now()]):(se&&se.sort&&se.sort(),typeof W=="function"&&W.call(this,te,se))}}}if(process.version.substr(0,4)==="v0.8"){var p=J3t(t);w=p.ReadStream,T=p.WriteStream}var f=t.ReadStream;f&&(w.prototype=Object.create(f.prototype),w.prototype.open=x);var m=t.WriteStream;m&&(T.prototype=Object.create(m.prototype),T.prototype.open=M),Object.defineProperty(t,"ReadStream",{get:function(){return w},set:function(V){w=V},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return T},set:function(V){T=V},enumerable:!0,configurable:!0});var g=w;Object.defineProperty(t,"FileReadStream",{get:function(){return g},set:function(V){g=V},enumerable:!0,configurable:!0});var y=T;Object.defineProperty(t,"FileWriteStream",{get:function(){return y},set:function(V){y=V},enumerable:!0,configurable:!0});function w(V,J){return this instanceof w?(f.apply(this,arguments),this):w.apply(Object.create(w.prototype),arguments)}function x(){var V=this;O(V.path,V.flags,V.mode,function(J,N){J?(V.autoClose&&V.destroy(),V.emit("error",J)):(V.fd=N,V.emit("open",N),V.read())})}function T(V,J){return this instanceof T?(m.apply(this,arguments),this):T.apply(Object.create(T.prototype),arguments)}function M(){var V=this;O(V.path,V.flags,V.mode,function(J,N){J?(V.destroy(),V.emit("error",J)):(V.fd=N,V.emit("open",N))})}function B(V,J){return new t.ReadStream(V,J)}function G(V,J){return new t.WriteStream(V,J)}var F=t.open;t.open=O;function O(V,J,N,P){return typeof N=="function"&&(P=N,N=null),$(V,J,N,P);function $(K,ve,W,ee,te){return F(K,ve,W,function(se,Ae){se&&(se.code==="EMFILE"||se.code==="ENFILE")?yT([$,[K,ve,W,ee],se,te||Date.now(),Date.now()]):typeof ee=="function"&&ee.apply(this,arguments)})}}return t}function yT(t){Hw("ENQUEUE",t[0].name,t[1]),Lo[ja].push(t),hoe()}var P6;function o3e(){for(var t=Date.now(),e=0;e<Lo[ja].length;++e)Lo[ja][e].length>2&&(Lo[ja][e][3]=t,Lo[ja][e][4]=t);hoe()}function hoe(){if(clearTimeout(P6),P6=void 0,Lo[ja].length!==0){var t=Lo[ja].shift(),e=t[0],i=t[1],r=t[2],n=t[3],o=t[4];if(n===void 0)Hw("RETRY",e.name,i),e.apply(null,i);else if(Date.now()-n>=6e4){Hw("TIMEOUT",e.name,i);var s=i.pop();typeof s=="function"&&s.call(null,r)}else{var a=Date.now()-o,c=Math.max(o-n,1),d=Math.min(c*1.2,100);a>=d?(Hw("RETRY",e.name,i),e.apply(null,i.concat([n]))):Lo[ja].push(t)}P6===void 0&&(P6=setTimeout(hoe,0))}}});var poe=z((zJi,a3e)=>{"use strict";a3e.exports=Ze("stream")});var bN=z((moe,c3e)=>{"use strict";var F6=Ze("buffer"),lg=F6.Buffer;function l3e(t,e){for(var i in t)e[i]=t[i]}lg.from&&lg.alloc&&lg.allocUnsafe&&lg.allocUnsafeSlow?c3e.exports=F6:(l3e(F6,moe),moe.Buffer=wT);function wT(t,e,i){return lg(t,e,i)}l3e(lg,wT);wT.from=function(t,e,i){if(typeof t=="number")throw new TypeError("Argument must not be a number");return lg(t,e,i)};wT.alloc=function(t,e,i){if(typeof t!="number")throw new TypeError("Argument must be a number");var r=lg(t);return e!==void 0?typeof i=="string"?r.fill(e,i):r.fill(e):r.fill(0),r};wT.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return lg(t)};wT.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return F6.SlowBuffer(t)}});var u3e=z((WJi,goe)=>{"use strict";function i4t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var d3e=bN().Buffer,_N=Ze("util");function r4t(t,e,i){t.copy(e,i)}goe.exports=function(){function t(){i4t(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(i){var r={data:i,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length},t.prototype.unshift=function(i){var r={data:i,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length},t.prototype.shift=function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(i){if(this.length===0)return"";for(var r=this.head,n=""+r.data;r=r.next;)n+=i+r.data;return n},t.prototype.concat=function(i){if(this.length===0)return d3e.alloc(0);for(var r=d3e.allocUnsafe(i>>>0),n=this.head,o=0;n;)r4t(n.data,r,o),o+=n.data.length,n=n.next;return r},t}();_N&&_N.inspect&&_N.inspect.custom&&(goe.exports.prototype[_N.inspect.custom]=function(){var t=_N.inspect({length:this.length});return this.constructor.name+" "+t})});var voe=z((UJi,h3e)=>{"use strict";var H6=hs();function n4t(t,e){var i=this,r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,H6.nextTick(B6,this,t)):H6.nextTick(B6,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,H6.nextTick(B6,i,o)):H6.nextTick(B6,i,o):e&&e(o)}),this)}function o4t(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function B6(t,e){t.emit("error",e)}h3e.exports={destroy:n4t,undestroy:o4t}});var _oe=z((qJi,y3e)=>{"use strict";var Bw=hs();y3e.exports=Rs;function p3e(t){var e=this;this.next=null,this.entry=null,this.finish=function(){x4t(e,t)}}var s4t=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:Bw.nextTick,CT;Rs.WritableState=wN;var m3e=Object.create(Xn());m3e.inherits=Vi();var a4t={deprecate:tw()},g3e=poe(),j6=bN().Buffer,l4t=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function c4t(t){return j6.from(t)}function d4t(t){return j6.isBuffer(t)||t instanceof l4t}var v3e=voe();m3e.inherits(Rs,g3e);function u4t(){}function wN(t,e){CT=CT||Vw(),t=t||{};var i=e instanceof CT;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,n=t.writableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=t.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){b4t(e,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new p3e(this)}wN.prototype.getBuffer=function(){for(var e=this.bufferedRequest,i=[];e;)i.push(e),e=e.next;return i};(function(){try{Object.defineProperty(wN.prototype,"buffer",{get:a4t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var V6;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(V6=Function.prototype[Symbol.hasInstance],Object.defineProperty(Rs,Symbol.hasInstance,{value:function(t){return V6.call(this,t)?!0:this!==Rs?!1:t&&t._writableState instanceof wN}})):V6=function(t){return t instanceof this};function Rs(t){if(CT=CT||Vw(),!V6.call(Rs,this)&&!(this instanceof CT))return new Rs(t);this._writableState=new wN(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),g3e.call(this)}Rs.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function h4t(t,e){var i=new Error("write after end");t.emit("error",i),Bw.nextTick(e,i)}function f4t(t,e,i,r){var n=!0,o=!1;return i===null?o=new TypeError("May not write null values to stream"):typeof i!="string"&&i!==void 0&&!e.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),Bw.nextTick(r,o),n=!1),n}Rs.prototype.write=function(t,e,i){var r=this._writableState,n=!1,o=!r.objectMode&&d4t(t);return o&&!j6.isBuffer(t)&&(t=c4t(t)),typeof e=="function"&&(i=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),typeof i!="function"&&(i=u4t),r.ended?h4t(this,i):(o||f4t(this,r,t,i))&&(r.pendingcb++,n=m4t(this,r,o,t,e,i)),n};Rs.prototype.cork=function(){var t=this._writableState;t.corked++};Rs.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&b3e(this,t))};Rs.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function p4t(t,e,i){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=j6.from(e,i)),e}Object.defineProperty(Rs.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function m4t(t,e,i,r,n,o){if(!i){var s=p4t(e,r,n);r!==s&&(i=!0,n="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var d=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:o,next:null},d?d.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else boe(t,e,!1,a,r,n,o);return c}function boe(t,e,i,r,n,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,i?t._writev(n,e.onwrite):t._write(n,o,e.onwrite),e.sync=!1}function g4t(t,e,i,r,n){--e.pendingcb,i?(Bw.nextTick(n,r),Bw.nextTick(yN,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(n(r),t._writableState.errorEmitted=!0,t.emit("error",r),yN(t,e))}function v4t(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function b4t(t,e){var i=t._writableState,r=i.sync,n=i.writecb;if(v4t(i),e)g4t(t,i,r,e,n);else{var o=_3e(i);!o&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest&&b3e(t,i),r?s4t(f3e,t,i,o,n):f3e(t,i,o,n)}}function f3e(t,e,i,r){i||_4t(t,e),e.pendingcb--,r(),yN(t,e)}function _4t(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function b3e(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,n=new Array(r),o=e.corkedRequestsFree;o.entry=i;for(var s=0,a=!0;i;)n[s]=i,i.isBuf||(a=!1),i=i.next,s+=1;n.allBuffers=a,boe(t,e,!0,e.length,n,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new p3e(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,d=i.encoding,u=i.callback,h=e.objectMode?1:c.length;if(boe(t,e,!1,h,c,d,u),i=i.next,e.bufferedRequestCount--,e.writing)break}i===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}Rs.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))};Rs.prototype._writev=null;Rs.prototype.end=function(t,e,i){var r=this._writableState;typeof t=="function"?(i=t,t=null,e=null):typeof e=="function"&&(i=e,e=null),t!=null&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||C4t(this,r,i)};function _3e(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function y4t(t,e){t._final(function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),yN(t,e)})}function w4t(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,Bw.nextTick(y4t,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function yN(t,e){var i=_3e(e);return i&&(w4t(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),i}function C4t(t,e,i){e.ending=!0,yN(t,e),i&&(e.finished?Bw.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}function x4t(t,e,i){var r=t.entry;for(t.entry=null;r;){var n=r.callback;e.pendingcb--,n(i),r=r.next}e.corkedRequestsFree.next=t}Object.defineProperty(Rs.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}});Rs.prototype.destroy=v3e.destroy;Rs.prototype._undestroy=v3e.undestroy;Rs.prototype._destroy=function(t,e){this.end(),e(t)}});var Vw=z((YJi,S3e)=>{"use strict";var w3e=hs(),S4t=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};S3e.exports=cg;var C3e=Object.create(Xn());C3e.inherits=Vi();var x3e=Coe(),woe=_oe();C3e.inherits(cg,x3e);for(yoe=S4t(woe.prototype),z6=0;z6<yoe.length;z6++)W6=yoe[z6],cg.prototype[W6]||(cg.prototype[W6]=woe.prototype[W6]);var yoe,W6,z6;function cg(t){if(!(this instanceof cg))return new cg(t);x3e.call(this,t),woe.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",E4t)}Object.defineProperty(cg.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function E4t(){this.allowHalfOpen||this._writableState.ended||w3e.nextTick(T4t,this)}function T4t(t){t.end()}Object.defineProperty(cg.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});cg.prototype._destroy=function(t,e){this.push(null),this.end(),w3e.nextTick(e,t)}});var Eoe=z(T3e=>{"use strict";var Soe=bN().Buffer,E3e=Soe.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function R4t(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function A4t(t){var e=R4t(t);if(typeof e!="string"&&(Soe.isEncoding===E3e||!E3e(t)))throw new Error("Unknown encoding: "+t);return e||t}T3e.StringDecoder=CN;function CN(t){this.encoding=A4t(t);var e;switch(this.encoding){case"utf16le":this.text=N4t,this.end=P4t,e=4;break;case"utf8":this.fillLast=M4t,e=4;break;case"base64":this.text=L4t,this.end=F4t,e=3;break;default:this.write=H4t,this.end=B4t;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Soe.allocUnsafe(e)}CN.prototype.write=function(t){if(t.length===0)return"";var e,i;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""};CN.prototype.end=O4t;CN.prototype.text=k4t;CN.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function xoe(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function I4t(t,e,i){var r=e.length-1;if(r<i)return 0;var n=xoe(e[r]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--r<i||n===-2?0:(n=xoe(e[r]),n>=0?(n>0&&(t.lastNeed=n-2),n):--r<i||n===-2?0:(n=xoe(e[r]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function D4t(t,e,i){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function M4t(t){var e=this.lastTotal-this.lastNeed,i=D4t(this,t,e);if(i!==void 0)return i;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function k4t(t,e){var i=I4t(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var r=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function O4t(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function N4t(t,e){if((t.length-e)%2===0){var i=t.toString("utf16le",e);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function P4t(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function L4t(t,e){var i=(t.length-e)%3;return i===0?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,i===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function F4t(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function H4t(t){return t.toString(this.encoding)}function B4t(t){return t&&t.length?this.write(t):""}});var Coe=z((XJi,H3e)=>{"use strict";var ST=hs();H3e.exports=lo;var V4t=lE(),xN;lo.ReadableState=O3e;var GJi=Ze("events").EventEmitter,D3e=function(t,e){return t.listeners(e).length},Doe=poe(),SN=bN().Buffer,j4t=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function z4t(t){return SN.from(t)}function W4t(t){return SN.isBuffer(t)||t instanceof j4t}var M3e=Object.create(Xn());M3e.inherits=Vi();var Toe=Ze("util"),Zr=void 0;Toe&&Toe.debuglog?Zr=Toe.debuglog("stream"):Zr=function(){};var U4t=u3e(),k3e=voe(),xT;M3e.inherits(lo,Doe);var Roe=["error","close","destroy","pause","resume"];function q4t(t,e,i){if(typeof t.prependListener=="function")return t.prependListener(e,i);!t._events||!t._events[e]?t.on(e,i):V4t(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]}function O3e(t,e){xN=xN||Vw(),t=t||{};var i=e instanceof xN;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,n=t.readableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new U4t,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(xT||(xT=Eoe().StringDecoder),this.decoder=new xT(t.encoding),this.encoding=t.encoding)}function lo(t){if(xN=xN||Vw(),!(this instanceof lo))return new lo(t);this._readableState=new O3e(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),Doe.call(this)}Object.defineProperty(lo.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}});lo.prototype.destroy=k3e.destroy;lo.prototype._undestroy=k3e.undestroy;lo.prototype._destroy=function(t,e){this.push(null),e(t)};lo.prototype.push=function(t,e){var i=this._readableState,r;return i.objectMode?r=!0:typeof t=="string"&&(e=e||i.defaultEncoding,e!==i.encoding&&(t=SN.from(t,e),e=""),r=!0),N3e(this,t,e,!1,r)};lo.prototype.unshift=function(t){return N3e(this,t,null,!0,!1)};function N3e(t,e,i,r,n){var o=t._readableState;if(e===null)o.reading=!1,X4t(t,o);else{var s;n||(s=Y4t(o,e)),s?t.emit("error",s):o.objectMode||e&&e.length>0?(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==SN.prototype&&(e=z4t(e)),r?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):Aoe(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||e.length!==0?Aoe(t,o,e,!1):P3e(t,o)):Aoe(t,o,e,!1))):r||(o.reading=!1)}return $4t(o)}function Aoe(t,e,i,r){e.flowing&&e.length===0&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,r?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&U6(t)),P3e(t,e)}function Y4t(t,e){var i;return!W4t(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(i=new TypeError("Invalid non-string/buffer chunk")),i}function $4t(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}lo.prototype.isPaused=function(){return this._readableState.flowing===!1};lo.prototype.setEncoding=function(t){return xT||(xT=Eoe().StringDecoder),this._readableState.decoder=new xT(t),this._readableState.encoding=t,this};var R3e=8388608;function G4t(t){return t>=R3e?t=R3e:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function A3e(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=G4t(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}lo.prototype.read=function(t){Zr("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Zr("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Ioe(this):U6(this),null;if(t=A3e(t,e),t===0&&e.ended)return e.length===0&&Ioe(this),null;var r=e.needReadable;Zr("need readable",r),(e.length===0||e.length-t<e.highWaterMark)&&(r=!0,Zr("length less than watermark",r)),e.ended||e.reading?(r=!1,Zr("reading or ended",r)):r&&(Zr("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=A3e(i,e)));var n;return t>0?n=L3e(t,e):n=null,n===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&Ioe(this)),n!==null&&this.emit("data",n),n};function X4t(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,U6(t)}}function U6(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(Zr("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?ST.nextTick(I3e,t):I3e(t))}function I3e(t){Zr("emit readable"),t.emit("readable"),Moe(t)}function P3e(t,e){e.readingMore||(e.readingMore=!0,ST.nextTick(K4t,t,e))}function K4t(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Zr("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}lo.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};lo.prototype.pipe=function(t,e){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1,Zr("pipe count=%d opts=%j",r.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=n?a:y;r.endEmitted?ST.nextTick(o):i.once("end",o),t.on("unpipe",s);function s(w,x){Zr("onunpipe"),w===i&&x&&x.hasUnpiped===!1&&(x.hasUnpiped=!0,u())}function a(){Zr("onend"),t.end()}var c=Z4t(i);t.on("drain",c);var d=!1;function u(){Zr("cleanup"),t.removeListener("close",m),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",f),t.removeListener("unpipe",s),i.removeListener("end",a),i.removeListener("end",y),i.removeListener("data",p),d=!0,r.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}var h=!1;i.on("data",p);function p(w){Zr("ondata"),h=!1;var x=t.write(w);x===!1&&!h&&((r.pipesCount===1&&r.pipes===t||r.pipesCount>1&&F3e(r.pipes,t)!==-1)&&!d&&(Zr("false write response, pause",r.awaitDrain),r.awaitDrain++,h=!0),i.pause())}function f(w){Zr("onerror",w),y(),t.removeListener("error",f),D3e(t,"error")===0&&t.emit("error",w)}q4t(t,"error",f);function m(){t.removeListener("finish",g),y()}t.once("close",m);function g(){Zr("onfinish"),t.removeListener("close",m),y()}t.once("finish",g);function y(){Zr("unpipe"),i.unpipe(t)}return t.emit("pipe",i),r.flowing||(Zr("pipe resume"),i.resume()),t};function Z4t(t){return function(){var e=t._readableState;Zr("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&D3e(t,"data")&&(e.flowing=!0,Moe(t))}}lo.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<n;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=F3e(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i),this)};lo.prototype.on=function(t,e){var i=Doe.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var r=this._readableState;!r.endEmitted&&!r.readableListening&&(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&U6(this):ST.nextTick(Q4t,this))}return i};lo.prototype.addListener=lo.prototype.on;function Q4t(t){Zr("readable nexttick read 0"),t.read(0)}lo.prototype.resume=function(){var t=this._readableState;return t.flowing||(Zr("resume"),t.flowing=!0,J4t(this,t)),this};function J4t(t,e){e.resumeScheduled||(e.resumeScheduled=!0,ST.nextTick(eVt,t,e))}function eVt(t,e){e.reading||(Zr("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),Moe(t),e.flowing&&!e.reading&&t.read(0)}lo.prototype.pause=function(){return Zr("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Zr("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function Moe(t){var e=t._readableState;for(Zr("flow",e.flowing);e.flowing&&t.read()!==null;);}lo.prototype.wrap=function(t){var e=this,i=this._readableState,r=!1;t.on("end",function(){if(Zr("wrapped end"),i.decoder&&!i.ended){var s=i.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(Zr("wrapped data"),i.decoder&&(s=i.decoder.write(s)),!(i.objectMode&&s==null)&&!(!i.objectMode&&(!s||!s.length))){var a=e.push(s);a||(r=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(s){return function(){return t[s].apply(t,arguments)}}(n));for(var o=0;o<Roe.length;o++)t.on(Roe[o],this.emit.bind(this,Roe[o]));return this._read=function(s){Zr("wrapped _read",s),r&&(r=!1,t.resume())},this};Object.defineProperty(lo.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});lo._fromList=L3e;function L3e(t,e){if(e.length===0)return null;var i;return e.objectMode?i=e.buffer.shift():!t||t>=e.length?(e.decoder?i=e.buffer.join(""):e.buffer.length===1?i=e.buffer.head.data:i=e.buffer.concat(e.length),e.buffer.clear()):i=tVt(t,e.buffer,e.decoder),i}function tVt(t,e,i){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?r=e.shift():r=i?iVt(t,e):rVt(t,e),r}function iVt(t,e){var i=e.head,r=1,n=i.data;for(t-=n.length;i=i.next;){var o=i.data,s=t>o.length?o.length:t;if(s===o.length?n+=o:n+=o.slice(0,t),t-=s,t===0){s===o.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=o.slice(s));break}++r}return e.length-=r,n}function rVt(t,e){var i=SN.allocUnsafe(t),r=e.head,n=1;for(r.data.copy(i),t-=r.data.length;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,s),t-=s,t===0){s===o.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++n}return e.length-=n,i}function Ioe(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,ST.nextTick(nVt,e,t))}function nVt(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function F3e(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}});var koe=z((KJi,j3e)=>{"use strict";j3e.exports=dg;var q6=Vw(),V3e=Object.create(Xn());V3e.inherits=Vi();V3e.inherits(dg,q6);function oVt(t,e){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,e!=null&&this.push(e),r(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function dg(t){if(!(this instanceof dg))return new dg(t);q6.call(this,t),this._transformState={afterTransform:oVt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",sVt)}function sVt(){var t=this;typeof this._flush=="function"?this._flush(function(e,i){B3e(t,e,i)}):B3e(this,null,null)}dg.prototype.push=function(t,e){return this._transformState.needTransform=!1,q6.prototype.push.call(this,t,e)};dg.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")};dg.prototype._write=function(t,e,i){var r=this._transformState;if(r.writecb=i,r.writechunk=t,r.writeencoding=e,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};dg.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};dg.prototype._destroy=function(t,e){var i=this;q6.prototype._destroy.call(this,t,function(r){e(r),i.emit("close")})};function B3e(t,e,i){if(e)return t.emit("error",e);if(i!=null&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var q3e=z((ZJi,U3e)=>{"use strict";U3e.exports=EN;var z3e=koe(),W3e=Object.create(Xn());W3e.inherits=Vi();W3e.inherits(EN,z3e);function EN(t){if(!(this instanceof EN))return new EN(t);z3e.call(this,t)}EN.prototype._transform=function(t,e,i){i(null,t)}});var Y3e=z((za,Y6)=>{"use strict";var Cp=Ze("stream");process.env.READABLE_STREAM==="disable"&&Cp?(Y6.exports=Cp,za=Y6.exports=Cp.Readable,za.Readable=Cp.Readable,za.Writable=Cp.Writable,za.Duplex=Cp.Duplex,za.Transform=Cp.Transform,za.PassThrough=Cp.PassThrough,za.Stream=Cp):(za=Y6.exports=Coe(),za.Stream=Cp||za,za.Readable=za,za.Writable=_oe(),za.Duplex=Vw(),za.Transform=koe(),za.PassThrough=q3e())});var G3e=z((QJi,$3e)=>{"use strict";$3e.exports=Y3e().PassThrough});var Ooe=z((JJi,Z3e)=>{"use strict";var X3e=Ze("util"),X6=G3e();Z3e.exports={Readable:$6,Writable:G6};X3e.inherits($6,X6);X3e.inherits(G6,X6);function K3e(t,e,i){t[e]=function(){return delete t[e],i.apply(this,arguments),this[e].apply(this,arguments)}}function $6(t,e){if(!(this instanceof $6))return new $6(t,e);X6.call(this,e),K3e(this,"_read",function(){var i=t.call(this,e),r=this.emit.bind(this,"error");i.on("error",r),i.pipe(this)}),this.emit("readable")}function G6(t,e){if(!(this instanceof G6))return new G6(t,e);X6.call(this,e),K3e(this,"_write",function(){var i=t.call(this,e),r=this.emit.bind(this,"error");i.on("error",r),this.pipe(i)}),this.emit("writable")}});var K6=z((eer,Q3e)=>{"use strict";Q3e.exports=function(t,e){if(typeof t!="string")throw new TypeError("expected path to be a string");if(t==="\\"||t==="/")return"/";var i=t.length;if(i<=1)return t;var r="";if(i>4&&t[3]==="\\"){var n=t[2];(n==="?"||n===".")&&t.slice(0,2)==="\\\\"&&(t=t.slice(2),r="//")}var o=t.split(/[/\\]+/);return e!==!1&&o[o.length-1]===""&&o.pop(),r+o.join("/")}});var Foe=z((ter,o4e)=>{"use strict";var e4e=9007199254740991,aVt="[object Arguments]",lVt="[object Function]",cVt="[object GeneratorFunction]",dVt=/^(?:0|[1-9]\d*)$/;function t4e(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function uVt(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r}var TN=Object.prototype,RN=TN.hasOwnProperty,i4e=TN.toString,hVt=TN.propertyIsEnumerable,J3e=Math.max;function fVt(t,e){var i=xVt(t)||CVt(t)?uVt(t.length,String):[],r=i.length,n=!!r;for(var o in t)(e||RN.call(t,o))&&!(n&&(o=="length"||n4e(o,r)))&&i.push(o);return i}function pVt(t,e,i,r){return t===void 0||Noe(t,TN[i])&&!RN.call(r,i)?e:t}function mVt(t,e,i){var r=t[e];(!(RN.call(t,e)&&Noe(r,i))||i===void 0&&!(e in t))&&(t[e]=i)}function gVt(t){if(!Loe(t))return wVt(t);var e=yVt(t),i=[];for(var r in t)r=="constructor"&&(e||!RN.call(t,r))||i.push(r);return i}function r4e(t,e){return e=J3e(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,n=J3e(i.length-e,0),o=Array(n);++r<n;)o[r]=i[e+r];r=-1;for(var s=Array(e+1);++r<e;)s[r]=i[r];return s[e]=o,t4e(t,this,s)}}function vVt(t,e,i,r){i||(i={});for(var n=-1,o=e.length;++n<o;){var s=e[n],a=r?r(i[s],t[s],s,i,t):void 0;mVt(i,s,a===void 0?t[s]:a)}return i}function bVt(t){return r4e(function(e,i){var r=-1,n=i.length,o=n>1?i[n-1]:void 0,s=n>2?i[2]:void 0;for(o=t.length>3&&typeof o=="function"?(n--,o):void 0,s&&_Vt(i[0],i[1],s)&&(o=n<3?void 0:o,n=1),e=Object(e);++r<n;){var a=i[r];a&&t(e,a,r,o)}return e})}function n4e(t,e){return e=e??e4e,!!e&&(typeof t=="number"||dVt.test(t))&&t>-1&&t%1==0&&t<e}function _Vt(t,e,i){if(!Loe(i))return!1;var r=typeof e;return(r=="number"?Poe(i)&&n4e(e,i.length):r=="string"&&e in i)?Noe(i[e],t):!1}function yVt(t){var e=t&&t.constructor,i=typeof e=="function"&&e.prototype||TN;return t===i}function wVt(t){var e=[];if(t!=null)for(var i in Object(t))e.push(i);return e}function Noe(t,e){return t===e||t!==t&&e!==e}function CVt(t){return SVt(t)&&RN.call(t,"callee")&&(!hVt.call(t,"callee")||i4e.call(t)==aVt)}var xVt=Array.isArray;function Poe(t){return t!=null&&TVt(t.length)&&!EVt(t)}function SVt(t){return RVt(t)&&Poe(t)}function EVt(t){var e=Loe(t)?i4e.call(t):"";return e==lVt||e==cVt}function TVt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=e4e}function Loe(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function RVt(t){return!!t&&typeof t=="object"}var AVt=bVt(function(t,e,i,r){vVt(e,DVt(e),t,r)}),IVt=r4e(function(t){return t.push(void 0,pVt),t4e(AVt,void 0,t)});function DVt(t){return Poe(t)?fVt(t,!0):gVt(t)}o4e.exports=IVt});var Hoe=z((ier,s4e)=>{"use strict";s4e.exports=Ze("stream")});var AN=z((Boe,l4e)=>{"use strict";var Z6=Ze("buffer"),ug=Z6.Buffer;function a4e(t,e){for(var i in t)e[i]=t[i]}ug.from&&ug.alloc&&ug.allocUnsafe&&ug.allocUnsafeSlow?l4e.exports=Z6:(a4e(Z6,Boe),Boe.Buffer=ET);function ET(t,e,i){return ug(t,e,i)}a4e(ug,ET);ET.from=function(t,e,i){if(typeof t=="number")throw new TypeError("Argument must not be a number");return ug(t,e,i)};ET.alloc=function(t,e,i){if(typeof t!="number")throw new TypeError("Argument must be a number");var r=ug(t);return e!==void 0?typeof i=="string"?r.fill(e,i):r.fill(e):r.fill(0),r};ET.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return ug(t)};ET.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Z6.SlowBuffer(t)}});var d4e=z((rer,Voe)=>{"use strict";function MVt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c4e=AN().Buffer,IN=Ze("util");function kVt(t,e,i){t.copy(e,i)}Voe.exports=function(){function t(){MVt(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(i){var r={data:i,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length},t.prototype.unshift=function(i){var r={data:i,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length},t.prototype.shift=function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(i){if(this.length===0)return"";for(var r=this.head,n=""+r.data;r=r.next;)n+=i+r.data;return n},t.prototype.concat=function(i){if(this.length===0)return c4e.alloc(0);for(var r=c4e.allocUnsafe(i>>>0),n=this.head,o=0;n;)kVt(n.data,r,o),o+=n.data.length,n=n.next;return r},t}();IN&&IN.inspect&&IN.inspect.custom&&(Voe.exports.prototype[IN.inspect.custom]=function(){var t=IN.inspect({length:this.length});return this.constructor.name+" "+t})});var joe=z((ner,u4e)=>{"use strict";var Q6=hs();function OVt(t,e){var i=this,r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Q6.nextTick(J6,this,t)):Q6.nextTick(J6,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,Q6.nextTick(J6,i,o)):Q6.nextTick(J6,i,o):e&&e(o)}),this)}function NVt(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function J6(t,e){t.emit("error",e)}u4e.exports={destroy:OVt,undestroy:NVt}});var Woe=z((oer,_4e)=>{"use strict";var jw=hs();_4e.exports=As;function f4e(t){var e=this;this.next=null,this.entry=null,this.finish=function(){QVt(e,t)}}var PVt=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:jw.nextTick,TT;As.WritableState=MN;var p4e=Object.create(Xn());p4e.inherits=Vi();var LVt={deprecate:tw()},m4e=Hoe(),t8=AN().Buffer,FVt=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function HVt(t){return t8.from(t)}function BVt(t){return t8.isBuffer(t)||t instanceof FVt}var g4e=joe();p4e.inherits(As,m4e);function VVt(){}function MN(t,e){TT=TT||zw(),t=t||{};var i=e instanceof TT;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,n=t.writableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=t.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){$Vt(e,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new f4e(this)}MN.prototype.getBuffer=function(){for(var e=this.bufferedRequest,i=[];e;)i.push(e),e=e.next;return i};(function(){try{Object.defineProperty(MN.prototype,"buffer",{get:LVt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var e8;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(e8=Function.prototype[Symbol.hasInstance],Object.defineProperty(As,Symbol.hasInstance,{value:function(t){return e8.call(this,t)?!0:this!==As?!1:t&&t._writableState instanceof MN}})):e8=function(t){return t instanceof this};function As(t){if(TT=TT||zw(),!e8.call(As,this)&&!(this instanceof TT))return new As(t);this._writableState=new MN(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),m4e.call(this)}As.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function jVt(t,e){var i=new Error("write after end");t.emit("error",i),jw.nextTick(e,i)}function zVt(t,e,i,r){var n=!0,o=!1;return i===null?o=new TypeError("May not write null values to stream"):typeof i!="string"&&i!==void 0&&!e.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),jw.nextTick(r,o),n=!1),n}As.prototype.write=function(t,e,i){var r=this._writableState,n=!1,o=!r.objectMode&&BVt(t);return o&&!t8.isBuffer(t)&&(t=HVt(t)),typeof e=="function"&&(i=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),typeof i!="function"&&(i=VVt),r.ended?jVt(this,i):(o||zVt(this,r,t,i))&&(r.pendingcb++,n=UVt(this,r,o,t,e,i)),n};As.prototype.cork=function(){var t=this._writableState;t.corked++};As.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&v4e(this,t))};As.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function WVt(t,e,i){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=t8.from(e,i)),e}Object.defineProperty(As.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function UVt(t,e,i,r,n,o){if(!i){var s=WVt(e,r,n);r!==s&&(i=!0,n="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var d=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:o,next:null},d?d.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else zoe(t,e,!1,a,r,n,o);return c}function zoe(t,e,i,r,n,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,i?t._writev(n,e.onwrite):t._write(n,o,e.onwrite),e.sync=!1}function qVt(t,e,i,r,n){--e.pendingcb,i?(jw.nextTick(n,r),jw.nextTick(DN,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(n(r),t._writableState.errorEmitted=!0,t.emit("error",r),DN(t,e))}function YVt(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function $Vt(t,e){var i=t._writableState,r=i.sync,n=i.writecb;if(YVt(i),e)qVt(t,i,r,e,n);else{var o=b4e(i);!o&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest&&v4e(t,i),r?PVt(h4e,t,i,o,n):h4e(t,i,o,n)}}function h4e(t,e,i,r){i||GVt(t,e),e.pendingcb--,r(),DN(t,e)}function GVt(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function v4e(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,n=new Array(r),o=e.corkedRequestsFree;o.entry=i;for(var s=0,a=!0;i;)n[s]=i,i.isBuf||(a=!1),i=i.next,s+=1;n.allBuffers=a,zoe(t,e,!0,e.length,n,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new f4e(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,d=i.encoding,u=i.callback,h=e.objectMode?1:c.length;if(zoe(t,e,!1,h,c,d,u),i=i.next,e.bufferedRequestCount--,e.writing)break}i===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}As.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))};As.prototype._writev=null;As.prototype.end=function(t,e,i){var r=this._writableState;typeof t=="function"?(i=t,t=null,e=null):typeof e=="function"&&(i=e,e=null),t!=null&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||ZVt(this,r,i)};function b4e(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function XVt(t,e){t._final(function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),DN(t,e)})}function KVt(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,jw.nextTick(XVt,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function DN(t,e){var i=b4e(e);return i&&(KVt(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),i}function ZVt(t,e,i){e.ending=!0,DN(t,e),i&&(e.finished?jw.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}function QVt(t,e,i){var r=t.entry;for(t.entry=null;r;){var n=r.callback;e.pendingcb--,n(i),r=r.next}e.corkedRequestsFree.next=t}Object.defineProperty(As.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}});As.prototype.destroy=g4e.destroy;As.prototype._undestroy=g4e.undestroy;As.prototype._destroy=function(t,e){this.end(),e(t)}});var zw=z((ser,x4e)=>{"use strict";var y4e=hs(),JVt=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};x4e.exports=hg;var w4e=Object.create(Xn());w4e.inherits=Vi();var C4e=Yoe(),qoe=Woe();w4e.inherits(hg,C4e);for(Uoe=JVt(qoe.prototype),i8=0;i8<Uoe.length;i8++)r8=Uoe[i8],hg.prototype[r8]||(hg.prototype[r8]=qoe.prototype[r8]);var Uoe,r8,i8;function hg(t){if(!(this instanceof hg))return new hg(t);C4e.call(this,t),qoe.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",ejt)}Object.defineProperty(hg.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ejt(){this.allowHalfOpen||this._writableState.ended||y4e.nextTick(tjt,this)}function tjt(t){t.end()}Object.defineProperty(hg.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});hg.prototype._destroy=function(t,e){this.push(null),this.end(),y4e.nextTick(e,t)}});var Xoe=z(E4e=>{"use strict";var Goe=AN().Buffer,S4e=Goe.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function ijt(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function rjt(t){var e=ijt(t);if(typeof e!="string"&&(Goe.isEncoding===S4e||!S4e(t)))throw new Error("Unknown encoding: "+t);return e||t}E4e.StringDecoder=kN;function kN(t){this.encoding=rjt(t);var e;switch(this.encoding){case"utf16le":this.text=cjt,this.end=djt,e=4;break;case"utf8":this.fillLast=sjt,e=4;break;case"base64":this.text=ujt,this.end=hjt,e=3;break;default:this.write=fjt,this.end=pjt;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Goe.allocUnsafe(e)}kN.prototype.write=function(t){if(t.length===0)return"";var e,i;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""};kN.prototype.end=ljt;kN.prototype.text=ajt;kN.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function $oe(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function njt(t,e,i){var r=e.length-1;if(r<i)return 0;var n=$oe(e[r]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--r<i||n===-2?0:(n=$oe(e[r]),n>=0?(n>0&&(t.lastNeed=n-2),n):--r<i||n===-2?0:(n=$oe(e[r]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function ojt(t,e,i){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function sjt(t){var e=this.lastTotal-this.lastNeed,i=ojt(this,t,e);if(i!==void 0)return i;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function ajt(t,e){var i=njt(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var r=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function ljt(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function cjt(t,e){if((t.length-e)%2===0){var i=t.toString("utf16le",e);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function djt(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function ujt(t,e){var i=(t.length-e)%3;return i===0?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,i===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function hjt(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function fjt(t){return t.toString(this.encoding)}function pjt(t){return t&&t.length?this.write(t):""}});var Yoe=z((cer,F4e)=>{"use strict";var AT=hs();F4e.exports=co;var mjt=lE(),ON;co.ReadableState=k4e;var ler=Ze("events").EventEmitter,I4e=function(t,e){return t.listeners(e).length},ese=Hoe(),NN=AN().Buffer,gjt=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function vjt(t){return NN.from(t)}function bjt(t){return NN.isBuffer(t)||t instanceof gjt}var D4e=Object.create(Xn());D4e.inherits=Vi();var Koe=Ze("util"),Qr=void 0;Koe&&Koe.debuglog?Qr=Koe.debuglog("stream"):Qr=function(){};var _jt=d4e(),M4e=joe(),RT;D4e.inherits(co,ese);var Zoe=["error","close","destroy","pause","resume"];function yjt(t,e,i){if(typeof t.prependListener=="function")return t.prependListener(e,i);!t._events||!t._events[e]?t.on(e,i):mjt(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]}function k4e(t,e){ON=ON||zw(),t=t||{};var i=e instanceof ON;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,n=t.readableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new _jt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(RT||(RT=Xoe().StringDecoder),this.decoder=new RT(t.encoding),this.encoding=t.encoding)}function co(t){if(ON=ON||zw(),!(this instanceof co))return new co(t);this._readableState=new k4e(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),ese.call(this)}Object.defineProperty(co.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}});co.prototype.destroy=M4e.destroy;co.prototype._undestroy=M4e.undestroy;co.prototype._destroy=function(t,e){this.push(null),e(t)};co.prototype.push=function(t,e){var i=this._readableState,r;return i.objectMode?r=!0:typeof t=="string"&&(e=e||i.defaultEncoding,e!==i.encoding&&(t=NN.from(t,e),e=""),r=!0),O4e(this,t,e,!1,r)};co.prototype.unshift=function(t){return O4e(this,t,null,!0,!1)};function O4e(t,e,i,r,n){var o=t._readableState;if(e===null)o.reading=!1,Sjt(t,o);else{var s;n||(s=wjt(o,e)),s?t.emit("error",s):o.objectMode||e&&e.length>0?(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==NN.prototype&&(e=vjt(e)),r?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):Qoe(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||e.length!==0?Qoe(t,o,e,!1):N4e(t,o)):Qoe(t,o,e,!1))):r||(o.reading=!1)}return Cjt(o)}function Qoe(t,e,i,r){e.flowing&&e.length===0&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,r?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&n8(t)),N4e(t,e)}function wjt(t,e){var i;return!bjt(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(i=new TypeError("Invalid non-string/buffer chunk")),i}function Cjt(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}co.prototype.isPaused=function(){return this._readableState.flowing===!1};co.prototype.setEncoding=function(t){return RT||(RT=Xoe().StringDecoder),this._readableState.decoder=new RT(t),this._readableState.encoding=t,this};var T4e=8388608;function xjt(t){return t>=T4e?t=T4e:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function R4e(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=xjt(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}co.prototype.read=function(t){Qr("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Qr("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Joe(this):n8(this),null;if(t=R4e(t,e),t===0&&e.ended)return e.length===0&&Joe(this),null;var r=e.needReadable;Qr("need readable",r),(e.length===0||e.length-t<e.highWaterMark)&&(r=!0,Qr("length less than watermark",r)),e.ended||e.reading?(r=!1,Qr("reading or ended",r)):r&&(Qr("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=R4e(i,e)));var n;return t>0?n=P4e(t,e):n=null,n===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&Joe(this)),n!==null&&this.emit("data",n),n};function Sjt(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,n8(t)}}function n8(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(Qr("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?AT.nextTick(A4e,t):A4e(t))}function A4e(t){Qr("emit readable"),t.emit("readable"),tse(t)}function N4e(t,e){e.readingMore||(e.readingMore=!0,AT.nextTick(Ejt,t,e))}function Ejt(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Qr("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}co.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};co.prototype.pipe=function(t,e){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1,Qr("pipe count=%d opts=%j",r.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=n?a:y;r.endEmitted?AT.nextTick(o):i.once("end",o),t.on("unpipe",s);function s(w,x){Qr("onunpipe"),w===i&&x&&x.hasUnpiped===!1&&(x.hasUnpiped=!0,u())}function a(){Qr("onend"),t.end()}var c=Tjt(i);t.on("drain",c);var d=!1;function u(){Qr("cleanup"),t.removeListener("close",m),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",f),t.removeListener("unpipe",s),i.removeListener("end",a),i.removeListener("end",y),i.removeListener("data",p),d=!0,r.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}var h=!1;i.on("data",p);function p(w){Qr("ondata"),h=!1;var x=t.write(w);x===!1&&!h&&((r.pipesCount===1&&r.pipes===t||r.pipesCount>1&&L4e(r.pipes,t)!==-1)&&!d&&(Qr("false write response, pause",r.awaitDrain),r.awaitDrain++,h=!0),i.pause())}function f(w){Qr("onerror",w),y(),t.removeListener("error",f),I4e(t,"error")===0&&t.emit("error",w)}yjt(t,"error",f);function m(){t.removeListener("finish",g),y()}t.once("close",m);function g(){Qr("onfinish"),t.removeListener("close",m),y()}t.once("finish",g);function y(){Qr("unpipe"),i.unpipe(t)}return t.emit("pipe",i),r.flowing||(Qr("pipe resume"),i.resume()),t};function Tjt(t){return function(){var e=t._readableState;Qr("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&I4e(t,"data")&&(e.flowing=!0,tse(t))}}co.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<n;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=L4e(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i),this)};co.prototype.on=function(t,e){var i=ese.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var r=this._readableState;!r.endEmitted&&!r.readableListening&&(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&n8(this):AT.nextTick(Rjt,this))}return i};co.prototype.addListener=co.prototype.on;function Rjt(t){Qr("readable nexttick read 0"),t.read(0)}co.prototype.resume=function(){var t=this._readableState;return t.flowing||(Qr("resume"),t.flowing=!0,Ajt(this,t)),this};function Ajt(t,e){e.resumeScheduled||(e.resumeScheduled=!0,AT.nextTick(Ijt,t,e))}function Ijt(t,e){e.reading||(Qr("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),tse(t),e.flowing&&!e.reading&&t.read(0)}co.prototype.pause=function(){return Qr("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Qr("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function tse(t){var e=t._readableState;for(Qr("flow",e.flowing);e.flowing&&t.read()!==null;);}co.prototype.wrap=function(t){var e=this,i=this._readableState,r=!1;t.on("end",function(){if(Qr("wrapped end"),i.decoder&&!i.ended){var s=i.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(Qr("wrapped data"),i.decoder&&(s=i.decoder.write(s)),!(i.objectMode&&s==null)&&!(!i.objectMode&&(!s||!s.length))){var a=e.push(s);a||(r=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(s){return function(){return t[s].apply(t,arguments)}}(n));for(var o=0;o<Zoe.length;o++)t.on(Zoe[o],this.emit.bind(this,Zoe[o]));return this._read=function(s){Qr("wrapped _read",s),r&&(r=!1,t.resume())},this};Object.defineProperty(co.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});co._fromList=P4e;function P4e(t,e){if(e.length===0)return null;var i;return e.objectMode?i=e.buffer.shift():!t||t>=e.length?(e.decoder?i=e.buffer.join(""):e.buffer.length===1?i=e.buffer.head.data:i=e.buffer.concat(e.length),e.buffer.clear()):i=Djt(t,e.buffer,e.decoder),i}function Djt(t,e,i){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?r=e.shift():r=i?Mjt(t,e):kjt(t,e),r}function Mjt(t,e){var i=e.head,r=1,n=i.data;for(t-=n.length;i=i.next;){var o=i.data,s=t>o.length?o.length:t;if(s===o.length?n+=o:n+=o.slice(0,t),t-=s,t===0){s===o.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=o.slice(s));break}++r}return e.length-=r,n}function kjt(t,e){var i=NN.allocUnsafe(t),r=e.head,n=1;for(r.data.copy(i),t-=r.data.length;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,s),t-=s,t===0){s===o.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++n}return e.length-=n,i}function Joe(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,AT.nextTick(Ojt,e,t))}function Ojt(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function L4e(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}});var ise=z((der,V4e)=>{"use strict";V4e.exports=fg;var o8=zw(),B4e=Object.create(Xn());B4e.inherits=Vi();B4e.inherits(fg,o8);function Njt(t,e){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,e!=null&&this.push(e),r(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function fg(t){if(!(this instanceof fg))return new fg(t);o8.call(this,t),this._transformState={afterTransform:Njt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",Pjt)}function Pjt(){var t=this;typeof this._flush=="function"?this._flush(function(e,i){H4e(t,e,i)}):H4e(this,null,null)}fg.prototype.push=function(t,e){return this._transformState.needTransform=!1,o8.prototype.push.call(this,t,e)};fg.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")};fg.prototype._write=function(t,e,i){var r=this._transformState;if(r.writecb=i,r.writechunk=t,r.writeencoding=e,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};fg.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};fg.prototype._destroy=function(t,e){var i=this;o8.prototype._destroy.call(this,t,function(r){e(r),i.emit("close")})};function H4e(t,e,i){if(e)return t.emit("error",e);if(i!=null&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var U4e=z((uer,W4e)=>{"use strict";W4e.exports=PN;var j4e=ise(),z4e=Object.create(Xn());z4e.inherits=Vi();z4e.inherits(PN,j4e);function PN(t){if(!(this instanceof PN))return new PN(t);j4e.call(this,t)}PN.prototype._transform=function(t,e,i){i(null,t)}});var q4e=z((Wa,s8)=>{"use strict";var xp=Ze("stream");process.env.READABLE_STREAM==="disable"&&xp?(s8.exports=xp,Wa=s8.exports=xp.Readable,Wa.Readable=xp.Readable,Wa.Writable=xp.Writable,Wa.Duplex=xp.Duplex,Wa.Transform=xp.Transform,Wa.PassThrough=xp.PassThrough,Wa.Stream=xp):(Wa=s8.exports=Yoe(),Wa.Stream=xp||Wa,Wa.Readable=Wa,Wa.Writable=Woe(),Wa.Duplex=zw(),Wa.Transform=ise(),Wa.PassThrough=U4e())});var nse=z((her,K4e)=>{"use strict";var Ljt=9007199254740991,Fjt="[object Arguments]",Hjt="[object Function]",Bjt="[object GeneratorFunction]",Vjt=typeof global=="object"&&global&&global.Object===Object&&global,jjt=typeof self=="object"&&self&&self.Object===Object&&self,zjt=Vjt||jjt||Function("return this")();function Wjt(t,e){for(var i=-1,r=e.length,n=t.length;++i<r;)t[n+i]=e[i];return t}var rse=Object.prototype,Ujt=rse.hasOwnProperty,G4e=rse.toString,Y4e=zjt.Symbol,qjt=rse.propertyIsEnumerable,$4e=Y4e?Y4e.isConcatSpreadable:void 0;function X4e(t,e,i,r,n){var o=-1,s=t.length;for(i||(i=Yjt),n||(n=[]);++o<s;){var a=t[o];e>0&&i(a)?e>1?X4e(a,e-1,i,r,n):Wjt(n,a):r||(n[n.length]=a)}return n}function Yjt(t){return Xjt(t)||Gjt(t)||!!($4e&&t&&t[$4e])}function $jt(t){var e=t?t.length:0;return e?X4e(t,1):[]}function Gjt(t){return Zjt(t)&&Ujt.call(t,"callee")&&(!qjt.call(t,"callee")||G4e.call(t)==Fjt)}var Xjt=Array.isArray;function Kjt(t){return t!=null&&Jjt(t.length)&&!Qjt(t)}function Zjt(t){return t6t(t)&&Kjt(t)}function Qjt(t){var e=e6t(t)?G4e.call(t):"";return e==Hjt||e==Bjt}function Jjt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ljt}function e6t(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function t6t(t){return!!t&&typeof t=="object"}K4e.exports=$jt});var dse=z((fer,aVe)=>{"use strict";var i6t=200,ase="__lodash_hash_undefined__",r6t=9007199254740991,n6t="[object Arguments]",o6t="[object Function]",s6t="[object GeneratorFunction]",a6t=/[\\^$.*+?()[\]{}|]/g,l6t=/^\[object .+?Constructor\]$/,c6t=typeof global=="object"&&global&&global.Object===Object&&global,d6t=typeof self=="object"&&self&&self.Object===Object&&self,lse=c6t||d6t||Function("return this")();function u6t(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function h6t(t,e){var i=t?t.length:0;return!!i&&v6t(t,e,0)>-1}function f6t(t,e,i){for(var r=-1,n=t?t.length:0;++r<n;)if(i(e,t[r]))return!0;return!1}function p6t(t,e){for(var i=-1,r=t?t.length:0,n=Array(r);++i<r;)n[i]=e(t[i],i,t);return n}function m6t(t,e){for(var i=-1,r=e.length,n=t.length;++i<r;)t[n+i]=e[i];return t}function g6t(t,e,i,r){for(var n=t.length,o=i+(r?1:-1);r?o--:++o<n;)if(e(t[o],o,t))return o;return-1}function v6t(t,e,i){if(e!==e)return g6t(t,b6t,i);for(var r=i-1,n=t.length;++r<n;)if(t[r]===e)return r;return-1}function b6t(t){return t!==t}function _6t(t){return function(e){return t(e)}}function y6t(t,e){return t.has(e)}function w6t(t,e){return t?.[e]}function C6t(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}var x6t=Array.prototype,S6t=Function.prototype,cse=Object.prototype,ose=lse["__core-js_shared__"],Z4e=function(){var t=/[^.]+$/.exec(ose&&ose.keys&&ose.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),tVe=S6t.toString,l8=cse.hasOwnProperty,iVe=cse.toString,E6t=RegExp("^"+tVe.call(l8).replace(a6t,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Q4e=lse.Symbol,T6t=cse.propertyIsEnumerable,R6t=x6t.splice,J4e=Q4e?Q4e.isConcatSpreadable:void 0,eVe=Math.max,A6t=nVe(lse,"Map"),LN=nVe(Object,"create");function Ww(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function I6t(){this.__data__=LN?LN(null):{}}function D6t(t){return this.has(t)&&delete this.__data__[t]}function M6t(t){var e=this.__data__;if(LN){var i=e[t];return i===ase?void 0:i}return l8.call(e,t)?e[t]:void 0}function k6t(t){var e=this.__data__;return LN?e[t]!==void 0:l8.call(e,t)}function O6t(t,e){var i=this.__data__;return i[t]=LN&&e===void 0?ase:e,this}Ww.prototype.clear=I6t;Ww.prototype.delete=D6t;Ww.prototype.get=M6t;Ww.prototype.has=k6t;Ww.prototype.set=O6t;function IT(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function N6t(){this.__data__=[]}function P6t(t){var e=this.__data__,i=c8(e,t);if(i<0)return!1;var r=e.length-1;return i==r?e.pop():R6t.call(e,i,1),!0}function L6t(t){var e=this.__data__,i=c8(e,t);return i<0?void 0:e[i][1]}function F6t(t){return c8(this.__data__,t)>-1}function H6t(t,e){var i=this.__data__,r=c8(i,t);return r<0?i.push([t,e]):i[r][1]=e,this}IT.prototype.clear=N6t;IT.prototype.delete=P6t;IT.prototype.get=L6t;IT.prototype.has=F6t;IT.prototype.set=H6t;function DT(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function B6t(){this.__data__={hash:new Ww,map:new(A6t||IT),string:new Ww}}function V6t(t){return d8(this,t).delete(t)}function j6t(t){return d8(this,t).get(t)}function z6t(t){return d8(this,t).has(t)}function W6t(t,e){return d8(this,t).set(t,e),this}DT.prototype.clear=B6t;DT.prototype.delete=V6t;DT.prototype.get=j6t;DT.prototype.has=z6t;DT.prototype.set=W6t;function a8(t){var e=-1,i=t?t.length:0;for(this.__data__=new DT;++e<i;)this.add(t[e])}function U6t(t){return this.__data__.set(t,ase),this}function q6t(t){return this.__data__.has(t)}a8.prototype.add=a8.prototype.push=U6t;a8.prototype.has=q6t;function c8(t,e){for(var i=t.length;i--;)if(e8t(t[i][0],e))return i;return-1}function Y6t(t,e,i,r){var n=-1,o=h6t,s=!0,a=t.length,c=[],d=e.length;if(!a)return c;i&&(e=p6t(e,_6t(i))),r?(o=f6t,s=!1):e.length>=i6t&&(o=y6t,s=!1,e=new a8(e));e:for(;++n<a;){var u=t[n],h=i?i(u):u;if(u=r||u!==0?u:0,s&&h===h){for(var p=d;p--;)if(e[p]===h)continue e;c.push(u)}else o(e,h,r)||c.push(u)}return c}function rVe(t,e,i,r,n){var o=-1,s=t.length;for(i||(i=X6t),n||(n=[]);++o<s;){var a=t[o];e>0&&i(a)?e>1?rVe(a,e-1,i,r,n):m6t(n,a):r||(n[n.length]=a)}return n}function $6t(t){if(!sVe(t)||Z6t(t))return!1;var e=oVe(t)||C6t(t)?E6t:l6t;return e.test(Q6t(t))}function G6t(t,e){return e=eVe(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,n=eVe(i.length-e,0),o=Array(n);++r<n;)o[r]=i[e+r];r=-1;for(var s=Array(e+1);++r<e;)s[r]=i[r];return s[e]=o,u6t(t,this,s)}}function d8(t,e){var i=t.__data__;return K6t(e)?i[typeof e=="string"?"string":"hash"]:i.map}function nVe(t,e){var i=w6t(t,e);return $6t(i)?i:void 0}function X6t(t){return i8t(t)||t8t(t)||!!(J4e&&t&&t[J4e])}function K6t(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Z6t(t){return!!Z4e&&Z4e in t}function Q6t(t){if(t!=null){try{return tVe.call(t)}catch{}try{return t+""}catch{}}return""}var J6t=G6t(function(t,e){return sse(t)?Y6t(t,rVe(e,1,sse,!0)):[]});function e8t(t,e){return t===e||t!==t&&e!==e}function t8t(t){return sse(t)&&l8.call(t,"callee")&&(!T6t.call(t,"callee")||iVe.call(t)==n6t)}var i8t=Array.isArray;function r8t(t){return t!=null&&n8t(t.length)&&!oVe(t)}function sse(t){return o8t(t)&&r8t(t)}function oVe(t){var e=sVe(t)?iVe.call(t):"";return e==o6t||e==s6t}function n8t(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r6t}function sVe(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function o8t(t){return!!t&&typeof t=="object"}aVe.exports=J6t});var gse=z((per,_Ve)=>{"use strict";var s8t=200,fse="__lodash_hash_undefined__",a8t=1/0,l8t=9007199254740991,c8t="[object Arguments]",d8t="[object Function]",u8t="[object GeneratorFunction]",h8t=/[\\^$.*+?()[\]{}|]/g,f8t=/^\[object .+?Constructor\]$/,p8t=typeof global=="object"&&global&&global.Object===Object&&global,m8t=typeof self=="object"&&self&&self.Object===Object&&self,h8=p8t||m8t||Function("return this")();function g8t(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function v8t(t,e){var i=t?t.length:0;return!!i&&w8t(t,e,0)>-1}function b8t(t,e,i){for(var r=-1,n=t?t.length:0;++r<n;)if(i(e,t[r]))return!0;return!1}function _8t(t,e){for(var i=-1,r=e.length,n=t.length;++i<r;)t[n+i]=e[i];return t}function y8t(t,e,i,r){for(var n=t.length,o=i+(r?1:-1);r?o--:++o<n;)if(e(t[o],o,t))return o;return-1}function w8t(t,e,i){if(e!==e)return y8t(t,C8t,i);for(var r=i-1,n=t.length;++r<n;)if(t[r]===e)return r;return-1}function C8t(t){return t!==t}function x8t(t,e){return t.has(e)}function S8t(t,e){return t?.[e]}function E8t(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function hVe(t){var e=-1,i=Array(t.size);return t.forEach(function(r){i[++e]=r}),i}var T8t=Array.prototype,R8t=Function.prototype,pse=Object.prototype,use=h8["__core-js_shared__"],lVe=function(){var t=/[^.]+$/.exec(use&&use.keys&&use.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),fVe=R8t.toString,f8=pse.hasOwnProperty,pVe=pse.toString,A8t=RegExp("^"+fVe.call(f8).replace(h8t,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cVe=h8.Symbol,I8t=pse.propertyIsEnumerable,D8t=T8t.splice,dVe=cVe?cVe.isConcatSpreadable:void 0,uVe=Math.max,M8t=mse(h8,"Map"),hse=mse(h8,"Set"),FN=mse(Object,"create");function Uw(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function k8t(){this.__data__=FN?FN(null):{}}function O8t(t){return this.has(t)&&delete this.__data__[t]}function N8t(t){var e=this.__data__;if(FN){var i=e[t];return i===fse?void 0:i}return f8.call(e,t)?e[t]:void 0}function P8t(t){var e=this.__data__;return FN?e[t]!==void 0:f8.call(e,t)}function L8t(t,e){var i=this.__data__;return i[t]=FN&&e===void 0?fse:e,this}Uw.prototype.clear=k8t;Uw.prototype.delete=O8t;Uw.prototype.get=N8t;Uw.prototype.has=P8t;Uw.prototype.set=L8t;function MT(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function F8t(){this.__data__=[]}function H8t(t){var e=this.__data__,i=p8(e,t);if(i<0)return!1;var r=e.length-1;return i==r?e.pop():D8t.call(e,i,1),!0}function B8t(t){var e=this.__data__,i=p8(e,t);return i<0?void 0:e[i][1]}function V8t(t){return p8(this.__data__,t)>-1}function j8t(t,e){var i=this.__data__,r=p8(i,t);return r<0?i.push([t,e]):i[r][1]=e,this}MT.prototype.clear=F8t;MT.prototype.delete=H8t;MT.prototype.get=B8t;MT.prototype.has=V8t;MT.prototype.set=j8t;function kT(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function z8t(){this.__data__={hash:new Uw,map:new(M8t||MT),string:new Uw}}function W8t(t){return m8(this,t).delete(t)}function U8t(t){return m8(this,t).get(t)}function q8t(t){return m8(this,t).has(t)}function Y8t(t,e){return m8(this,t).set(t,e),this}kT.prototype.clear=z8t;kT.prototype.delete=W8t;kT.prototype.get=U8t;kT.prototype.has=q8t;kT.prototype.set=Y8t;function u8(t){var e=-1,i=t?t.length:0;for(this.__data__=new kT;++e<i;)this.add(t[e])}function $8t(t){return this.__data__.set(t,fse),this}function G8t(t){return this.__data__.has(t)}u8.prototype.add=u8.prototype.push=$8t;u8.prototype.has=G8t;function p8(t,e){for(var i=t.length;i--;)if(nzt(t[i][0],e))return i;return-1}function mVe(t,e,i,r,n){var o=-1,s=t.length;for(i||(i=J8t),n||(n=[]);++o<s;){var a=t[o];e>0&&i(a)?e>1?mVe(a,e-1,i,r,n):_8t(n,a):r||(n[n.length]=a)}return n}function X8t(t){if(!bVe(t)||tzt(t))return!1;var e=vVe(t)||E8t(t)?A8t:f8t;return e.test(izt(t))}function K8t(t,e){return e=uVe(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,n=uVe(i.length-e,0),o=Array(n);++r<n;)o[r]=i[e+r];r=-1;for(var s=Array(e+1);++r<e;)s[r]=i[r];return s[e]=o,g8t(t,this,s)}}function Z8t(t,e,i){var r=-1,n=v8t,o=t.length,s=!0,a=[],c=a;if(i)s=!1,n=b8t;else if(o>=s8t){var d=e?null:Q8t(t);if(d)return hVe(d);s=!1,n=x8t,c=new u8}else c=e?[]:a;e:for(;++r<o;){var u=t[r],h=e?e(u):u;if(u=i||u!==0?u:0,s&&h===h){for(var p=c.length;p--;)if(c[p]===h)continue e;e&&c.push(h),a.push(u)}else n(c,h,i)||(c!==a&&c.push(h),a.push(u))}return a}var Q8t=hse&&1/hVe(new hse([,-0]))[1]==a8t?function(t){return new hse(t)}:dzt;function m8(t,e){var i=t.__data__;return ezt(e)?i[typeof e=="string"?"string":"hash"]:i.map}function mse(t,e){var i=S8t(t,e);return X8t(i)?i:void 0}function J8t(t){return szt(t)||ozt(t)||!!(dVe&&t&&t[dVe])}function ezt(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function tzt(t){return!!lVe&&lVe in t}function izt(t){if(t!=null){try{return fVe.call(t)}catch{}try{return t+""}catch{}}return""}var rzt=K8t(function(t){return Z8t(mVe(t,1,gVe,!0))});function nzt(t,e){return t===e||t!==t&&e!==e}function ozt(t){return gVe(t)&&f8.call(t,"callee")&&(!I8t.call(t,"callee")||pVe.call(t)==c8t)}var szt=Array.isArray;function azt(t){return t!=null&&lzt(t.length)&&!vVe(t)}function gVe(t){return czt(t)&&azt(t)}function vVe(t){var e=bVe(t)?pVe.call(t):"";return e==d8t||e==u8t}function lzt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=l8t}function bVe(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function czt(t){return!!t&&typeof t=="object"}function dzt(){}_Ve.exports=rzt});var vse=z((mer,CVe)=>{"use strict";var uzt="[object Object]";function hzt(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function fzt(t,e){return function(i){return t(e(i))}}var pzt=Function.prototype,yVe=Object.prototype,wVe=pzt.toString,mzt=yVe.hasOwnProperty,gzt=wVe.call(Object),vzt=yVe.toString,bzt=fzt(Object.getPrototypeOf,Object);function _zt(t){return!!t&&typeof t=="object"}function yzt(t){if(!_zt(t)||vzt.call(t)!=uzt||hzt(t))return!1;var e=bzt(t);if(e===null)return!0;var i=mzt.call(e,"constructor")&&e.constructor;return typeof i=="function"&&i instanceof i&&wVe.call(i)==gzt}CVe.exports=yzt});var xVe=z(bse=>{"use strict";var qw=Ze("path"),x0=process.platform==="win32",C0=Ze("fs"),wzt=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function Czt(){var t;if(wzt){var e=new Error;t=i}else t=r;return t;function i(n){n&&(e.message=n.message,n=e,r(n))}function r(n){if(n){if(process.throwDeprecation)throw n;if(!process.noDeprecation){var o="fs: missing callback "+(n.stack||n.message);process.traceDeprecation?console.trace(o):console.error(o)}}}}function xzt(t){return typeof t=="function"?t:Czt()}var ger=qw.normalize;x0?pg=/(.*?)(?:[\/\\]+|$)/g:pg=/(.*?)(?:[\/]+|$)/g;var pg;x0?HN=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:HN=/^[\/]*/;var HN;bse.realpathSync=function(e,i){if(e=qw.resolve(e),i&&Object.prototype.hasOwnProperty.call(i,e))return i[e];var r=e,n={},o={},s,a,c,d;u();function u(){var y=HN.exec(e);s=y[0].length,a=y[0],c=y[0],d="",x0&&!o[c]&&(C0.lstatSync(c),o[c]=!0)}for(;s<e.length;){pg.lastIndex=s;var h=pg.exec(e);if(d=a,a+=h[0],c=d+h[1],s=pg.lastIndex,!(o[c]||i&&i[c]===c)){var p;if(i&&Object.prototype.hasOwnProperty.call(i,c))p=i[c];else{var f=C0.lstatSync(c);if(!f.isSymbolicLink()){o[c]=!0,i&&(i[c]=c);continue}var m=null;if(!x0){var g=f.dev.toString(32)+":"+f.ino.toString(32);n.hasOwnProperty(g)&&(m=n[g])}m===null&&(C0.statSync(c),m=C0.readlinkSync(c)),p=qw.resolve(d,m),i&&(i[c]=p),x0||(n[g]=m)}e=qw.resolve(p,e.slice(s)),u()}}return i&&(i[r]=e),e};bse.realpath=function(e,i,r){if(typeof r!="function"&&(r=xzt(i),i=null),e=qw.resolve(e),i&&Object.prototype.hasOwnProperty.call(i,e))return process.nextTick(r.bind(null,null,i[e]));var n=e,o={},s={},a,c,d,u;h();function h(){var y=HN.exec(e);a=y[0].length,c=y[0],d=y[0],u="",x0&&!s[d]?C0.lstat(d,function(w){if(w)return r(w);s[d]=!0,p()}):process.nextTick(p)}function p(){if(a>=e.length)return i&&(i[n]=e),r(null,e);pg.lastIndex=a;var y=pg.exec(e);return u=c,c+=y[0],d=u+y[1],a=pg.lastIndex,s[d]||i&&i[d]===d?process.nextTick(p):i&&Object.prototype.hasOwnProperty.call(i,d)?g(i[d]):C0.lstat(d,f)}function f(y,w){if(y)return r(y);if(!w.isSymbolicLink())return s[d]=!0,i&&(i[d]=d),process.nextTick(p);if(!x0){var x=w.dev.toString(32)+":"+w.ino.toString(32);if(o.hasOwnProperty(x))return m(null,o[x],d)}C0.stat(d,function(T){if(T)return r(T);C0.readlink(d,function(M,B){x0||(o[x]=B),m(M,B)})})}function m(y,w,x){if(y)return r(y);var T=qw.resolve(u,w);i&&(i[x]=T),g(T)}function g(y){e=qw.resolve(y,e.slice(a)),h()}}});var Cse=z((ber,RVe)=>{"use strict";RVe.exports=S0;S0.realpath=S0;S0.sync=wse;S0.realpathSync=wse;S0.monkeypatch=Ezt;S0.unmonkeypatch=Tzt;var OT=Ze("fs"),_se=OT.realpath,yse=OT.realpathSync,Szt=process.version,SVe=/^v[0-5]\./.test(Szt),EVe=xVe();function TVe(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function S0(t,e,i){if(SVe)return _se(t,e,i);typeof e=="function"&&(i=e,e=null),_se(t,e,function(r,n){TVe(r)?EVe.realpath(t,e,i):i(r,n)})}function wse(t,e){if(SVe)return yse(t,e);try{return yse(t,e)}catch(i){if(TVe(i))return EVe.realpathSync(t,e);throw i}}function Ezt(){OT.realpath=S0,OT.realpathSync=wse}function Tzt(){OT.realpath=_se,OT.realpathSync=yse}});var IVe=z((_er,AVe)=>{"use strict";AVe.exports=function(t,e){for(var i=[],r=0;r<t.length;r++){var n=e(t[r],r);Rzt(n)?i.push.apply(i,n):i.push(n)}return i};var Rzt=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"}});var FVe=z((yer,LVe)=>{"use strict";var Azt=IVe(),DVe=Ene();LVe.exports=Mzt;var MVe="\0SLASH"+Math.random()+"\0",kVe="\0OPEN"+Math.random()+"\0",Sse="\0CLOSE"+Math.random()+"\0",OVe="\0COMMA"+Math.random()+"\0",NVe="\0PERIOD"+Math.random()+"\0";function xse(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function Izt(t){return t.split("\\\\").join(MVe).split("\\{").join(kVe).split("\\}").join(Sse).split("\\,").join(OVe).split("\\.").join(NVe)}function Dzt(t){return t.split(MVe).join("\\").split(kVe).join("{").split(Sse).join("}").split(OVe).join(",").split(NVe).join(".")}function PVe(t){if(!t)return[""];var e=[],i=DVe("{","}",t);if(!i)return t.split(",");var r=i.pre,n=i.body,o=i.post,s=r.split(",");s[s.length-1]+="{"+n+"}";var a=PVe(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function Mzt(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),NT(Izt(t),!0).map(Dzt)):[]}function kzt(t){return"{"+t+"}"}function Ozt(t){return/^-?0\d/.test(t)}function Nzt(t,e){return t<=e}function Pzt(t,e){return t>=e}function NT(t,e){var i=[],r=DVe("{","}",t);if(!r||/\$$/.test(r.pre))return[t];var n=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),o=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),s=n||o,a=r.body.indexOf(",")>=0;if(!s&&!a)return r.post.match(/,.*\}/)?(t=r.pre+"{"+r.body+Sse+r.post,NT(t)):[t];var c;if(s)c=r.body.split(/\.\./);else if(c=PVe(r.body),c.length===1&&(c=NT(c[0],!1).map(kzt),c.length===1)){var u=r.post.length?NT(r.post,!1):[""];return u.map(function(N){return r.pre+c[0]+N})}var d=r.pre,u=r.post.length?NT(r.post,!1):[""],h;if(s){var p=xse(c[0]),f=xse(c[1]),m=Math.max(c[0].length,c[1].length),g=c.length==3?Math.abs(xse(c[2])):1,y=Nzt,w=f<p;w&&(g*=-1,y=Pzt);var x=c.some(Ozt);h=[];for(var T=p;y(T,f);T+=g){var M;if(o)M=String.fromCharCode(T),M==="\\"&&(M="");else if(M=String(T),x){var B=m-M.length;if(B>0){var G=new Array(B+1).join("0");T<0?M="-"+G+M.slice(1):M=G+M}}h.push(M)}}else h=Azt(c,function(J){return NT(J,!1)});for(var F=0;F<h.length;F++)for(var O=0;O<u.length;O++){var V=d+h[F]+u[O];(!e||s||V)&&i.push(V)}return i}});var b8=z((wer,zVe)=>{"use strict";zVe.exports=Sd;Sd.Minimatch=Ua;var BN=function(){try{return Ze("path")}catch{}}()||{sep:"/"};Sd.sep=BN.sep;var Rse=Sd.GLOBSTAR=Ua.GLOBSTAR={},Lzt=FVe(),HVe={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Ese="[^/]",Tse=Ese+"*?",Fzt="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Hzt="(?:(?!(?:\\/|^)\\.).)*?",BVe=Bzt("().*{}+?[]^$\\!");function Bzt(t){return t.split("").reduce(function(e,i){return e[i]=!0,e},{})}var VVe=/\/+/;Sd.filter=Vzt;function Vzt(t,e){return e=e||{},function(i,r,n){return Sd(i,t,e)}}function E0(t,e){e=e||{};var i={};return Object.keys(t).forEach(function(r){i[r]=t[r]}),Object.keys(e).forEach(function(r){i[r]=e[r]}),i}Sd.defaults=function(t){if(!t||typeof t!="object"||!Object.keys(t).length)return Sd;var e=Sd,i=function(n,o,s){return e(n,o,E0(t,s))};return i.Minimatch=function(n,o){return new e.Minimatch(n,E0(t,o))},i.Minimatch.defaults=function(n){return e.defaults(E0(t,n)).Minimatch},i.filter=function(n,o){return e.filter(n,E0(t,o))},i.defaults=function(n){return e.defaults(E0(t,n))},i.makeRe=function(n,o){return e.makeRe(n,E0(t,o))},i.braceExpand=function(n,o){return e.braceExpand(n,E0(t,o))},i.match=function(r,n,o){return e.match(r,n,E0(t,o))},i};Ua.defaults=function(t){return Sd.defaults(t).Minimatch};function Sd(t,e,i){return v8(e),i||(i={}),!i.nocomment&&e.charAt(0)==="#"?!1:new Ua(e,i).match(t)}function Ua(t,e){if(!(this instanceof Ua))return new Ua(t,e);v8(t),e||(e={}),t=t.trim(),!e.allowWindowsEscape&&BN.sep!=="/"&&(t=t.split(BN.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}Ua.prototype.debug=function(){};Ua.prototype.make=jzt;function jzt(){var t=this.pattern,e=this.options;if(!e.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();var i=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,i),i=this.globParts=i.map(function(r){return r.split(VVe)}),this.debug(this.pattern,i),i=i.map(function(r,n,o){return r.map(this.parse,this)},this),this.debug(this.pattern,i),i=i.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,i),this.set=i}Ua.prototype.parseNegate=zzt;function zzt(){var t=this.pattern,e=!1,i=this.options,r=0;if(!i.nonegate){for(var n=0,o=t.length;n<o&&t.charAt(n)==="!";n++)e=!e,r++;r&&(this.pattern=t.substr(r)),this.negate=e}}Sd.braceExpand=function(t,e){return jVe(t,e)};Ua.prototype.braceExpand=jVe;function jVe(t,e){return e||(this instanceof Ua?e=this.options:e={}),t=typeof t>"u"?this.pattern:t,v8(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:Lzt(t)}var Wzt=1024*64,v8=function(t){if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>Wzt)throw new TypeError("pattern is too long")};Ua.prototype.parse=Uzt;var g8={};function Uzt(t,e){v8(t);var i=this.options;if(t==="**")if(i.noglobstar)t="*";else return Rse;if(t==="")return"";var r="",n=!!i.nocase,o=!1,s=[],a=[],c,d=!1,u=-1,h=-1,p=t.charAt(0)==="."?"":i.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",f=this;function m(){if(c){switch(c){case"*":r+=Tse,n=!0;break;case"?":r+=Ese,n=!0;break;default:r+="\\"+c;break}f.debug("clearStateChar %j %j",c,r),c=!1}}for(var g=0,y=t.length,w;g<y&&(w=t.charAt(g));g++){if(this.debug("%s	%s %s %j",t,g,r,w),o&&BVe[w]){r+="\\"+w,o=!1;continue}switch(w){case"/":return!1;case"\\":m(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,g,r,w),d){this.debug("  in class"),w==="!"&&g===h+1&&(w="^"),r+=w;continue}f.debug("call clearStateChar %j",c),m(),c=w,i.noext&&m();continue;case"(":if(d){r+="(";continue}if(!c){r+="\\(";continue}s.push({type:c,start:g-1,reStart:r.length,open:HVe[c].open,close:HVe[c].close}),r+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,r),c=!1;continue;case")":if(d||!s.length){r+="\\)";continue}m(),n=!0;var x=s.pop();r+=x.close,x.type==="!"&&a.push(x),x.reEnd=r.length;continue;case"|":if(d||!s.length||o){r+="\\|",o=!1;continue}m(),r+="|";continue;case"[":if(m(),d){r+="\\"+w;continue}d=!0,h=g,u=r.length,r+=w;continue;case"]":if(g===h+1||!d){r+="\\"+w,o=!1;continue}var T=t.substring(h+1,g);try{RegExp("["+T+"]")}catch{var M=this.parse(T,g8);r=r.substr(0,u)+"\\["+M[0]+"\\]",n=n||M[1],d=!1;continue}n=!0,d=!1,r+=w;continue;default:m(),o?o=!1:BVe[w]&&!(w==="^"&&d)&&(r+="\\"),r+=w}}for(d&&(T=t.substr(h+1),M=this.parse(T,g8),r=r.substr(0,u)+"\\["+M[0],n=n||M[1]),x=s.pop();x;x=s.pop()){var B=r.slice(x.reStart+x.open.length);this.debug("setting tail",r,x),B=B.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Ae,k,S){return S||(S="\\"),k+k+S+"|"}),this.debug(`tail=%j
   %s`,B,B,x,r);var G=x.type==="*"?Tse:x.type==="?"?Ese:"\\"+x.type;n=!0,r=r.slice(0,x.reStart)+G+"\\("+B}m(),o&&(r+="\\\\");var F=!1;switch(r.charAt(0)){case"[":case".":case"(":F=!0}for(var O=a.length-1;O>-1;O--){var V=a[O],J=r.slice(0,V.reStart),N=r.slice(V.reStart,V.reEnd-8),P=r.slice(V.reEnd-8,V.reEnd),$=r.slice(V.reEnd);P+=$;var K=J.split("(").length-1,ve=$;for(g=0;g<K;g++)ve=ve.replace(/\)[+*?]?/,"");$=ve;var W="";$===""&&e!==g8&&(W="$");var ee=J+N+$+W+P;r=ee}if(r!==""&&n&&(r="(?=.)"+r),F&&(r=p+r),e===g8)return[r,n];if(!n)return Yzt(t);var te=i.nocase?"i":"";try{var se=new RegExp("^"+r+"$",te)}catch{return new RegExp("$.")}return se._glob=t,se._src=r,se}Sd.makeRe=function(t,e){return new Ua(t,e||{}).makeRe()};Ua.prototype.makeRe=qzt;function qzt(){if(this.regexp||this.regexp===!1)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,i=e.noglobstar?Tse:e.dot?Fzt:Hzt,r=e.nocase?"i":"",n=t.map(function(o){return o.map(function(s){return s===Rse?i:typeof s=="string"?$zt(s):s._src}).join("\\/")}).join("|");n="^(?:"+n+")$",this.negate&&(n="^(?!"+n+").*$");try{this.regexp=new RegExp(n,r)}catch{this.regexp=!1}return this.regexp}Sd.match=function(t,e,i){i=i||{};var r=new Ua(e,i);return t=t.filter(function(n){return r.match(n)}),r.options.nonull&&!t.length&&t.push(e),t};Ua.prototype.match=function(e,i){if(typeof i>"u"&&(i=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&i)return!0;var r=this.options;BN.sep!=="/"&&(e=e.split(BN.sep).join("/")),e=e.split(VVe),this.debug(this.pattern,"split",e);var n=this.set;this.debug(this.pattern,"set",n);var o,s;for(s=e.length-1;s>=0&&(o=e[s],!o);s--);for(s=0;s<n.length;s++){var a=n[s],c=e;r.matchBase&&a.length===1&&(c=[o]);var d=this.matchOne(c,a,i);if(d)return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate};Ua.prototype.matchOne=function(t,e,i){var r=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var n=0,o=0,s=t.length,a=e.length;n<s&&o<a;n++,o++){this.debug("matchOne loop");var c=e[o],d=t[n];if(this.debug(e,c,d),c===!1)return!1;if(c===Rse){this.debug("GLOBSTAR",[e,c,d]);var u=n,h=o+1;if(h===a){for(this.debug("** at the end");n<s;n++)if(t[n]==="."||t[n]===".."||!r.dot&&t[n].charAt(0)===".")return!1;return!0}for(;u<s;){var p=t[u];if(this.debug(`
globstar while`,t,u,e,h,p),this.matchOne(t.slice(u),e.slice(h),i))return this.debug("globstar found match!",u,s,p),!0;if(p==="."||p===".."||!r.dot&&p.charAt(0)==="."){this.debug("dot detected!",t,u,e,h);break}this.debug("globstar swallow a segment, and continue"),u++}return!!(i&&(this.debug(`
>>> no match, partial?`,t,u,e,h),u===s))}var f;if(typeof c=="string"?(f=d===c,this.debug("string match",c,d,f)):(f=d.match(c),this.debug("pattern match",c,d,f)),!f)return!1}if(n===s&&o===a)return!0;if(n===s)return i;if(o===a)return n===s-1&&t[n]==="";throw new Error("wtf?")};function Yzt(t){return t.replace(/\\(.)/g,"$1")}function $zt(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var y8=z((Cer,_8)=>{"use strict";function WVe(t){return t.charAt(0)==="/"}function UVe(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,i=e.exec(t),r=i[1]||"",n=!!(r&&r.charAt(1)!==":");return!!(i[2]||n)}_8.exports=process.platform==="win32"?UVe:WVe;_8.exports.posix=WVe;_8.exports.win32=UVe});var Ise=z(T0=>{"use strict";T0.setopts=Jzt;T0.ownProp=qVe;T0.makeAbs=VN;T0.finish=eWt;T0.mark=tWt;T0.isIgnored=$Ve;T0.childrenIgnored=iWt;function qVe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Gzt=Ze("fs"),PT=Ze("path"),Xzt=b8(),YVe=y8(),Ase=Xzt.Minimatch;function Kzt(t,e){return t.localeCompare(e,"en")}function Zzt(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(Qzt))}function Qzt(t){var e=null;if(t.slice(-3)==="/**"){var i=t.replace(/(\/\*\*)+$/,"");e=new Ase(i,{dot:!0})}return{matcher:new Ase(t,{dot:!0}),gmatcher:e}}function Jzt(t,e,i){if(i||(i={}),i.matchBase&&e.indexOf("/")===-1){if(i.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!i.silent,t.pattern=e,t.strict=i.strict!==!1,t.realpath=!!i.realpath,t.realpathCache=i.realpathCache||Object.create(null),t.follow=!!i.follow,t.dot=!!i.dot,t.mark=!!i.mark,t.nodir=!!i.nodir,t.nodir&&(t.mark=!0),t.sync=!!i.sync,t.nounique=!!i.nounique,t.nonull=!!i.nonull,t.nosort=!!i.nosort,t.nocase=!!i.nocase,t.stat=!!i.stat,t.noprocess=!!i.noprocess,t.absolute=!!i.absolute,t.fs=i.fs||Gzt,t.maxLength=i.maxLength||1/0,t.cache=i.cache||Object.create(null),t.statCache=i.statCache||Object.create(null),t.symlinks=i.symlinks||Object.create(null),Zzt(t,i),t.changedCwd=!1;var r=process.cwd();qVe(i,"cwd")?(t.cwd=PT.resolve(i.cwd),t.changedCwd=t.cwd!==r):t.cwd=r,t.root=i.root||PT.resolve(t.cwd,"/"),t.root=PT.resolve(t.root),process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=YVe(t.cwd)?t.cwd:VN(t,t.cwd),process.platform==="win32"&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!i.nomount,i.nonegate=!0,i.nocomment=!0,i.allowWindowsEscape=!1,t.minimatch=new Ase(e,i),t.options=t.minimatch.options}function eWt(t){for(var e=t.nounique,i=e?[]:Object.create(null),r=0,n=t.matches.length;r<n;r++){var o=t.matches[r];if(!o||Object.keys(o).length===0){if(t.nonull){var s=t.minimatch.globSet[r];e?i.push(s):i[s]=!0}}else{var a=Object.keys(o);e?i.push.apply(i,a):a.forEach(function(c){i[c]=!0})}}if(e||(i=Object.keys(i)),t.nosort||(i=i.sort(Kzt)),t.mark){for(var r=0;r<i.length;r++)i[r]=t._mark(i[r]);t.nodir&&(i=i.filter(function(c){var d=!/\/$/.test(c),u=t.cache[c]||t.cache[VN(t,c)];return d&&u&&(d=u!=="DIR"&&!Array.isArray(u)),d}))}t.ignore.length&&(i=i.filter(function(c){return!$Ve(t,c)})),t.found=i}function tWt(t,e){var i=VN(t,e),r=t.cache[i],n=e;if(r){var o=r==="DIR"||Array.isArray(r),s=e.slice(-1)==="/";if(o&&!s?n+="/":!o&&s&&(n=n.slice(0,-1)),n!==e){var a=VN(t,n);t.statCache[a]=t.statCache[i],t.cache[a]=t.cache[i]}}return n}function VN(t,e){var i=e;return e.charAt(0)==="/"?i=PT.join(t.root,e):YVe(e)||e===""?i=e:t.changedCwd?i=PT.resolve(t.cwd,e):i=PT.resolve(e),process.platform==="win32"&&(i=i.replace(/\\/g,"/")),i}function $Ve(t,e){return t.ignore.length?t.ignore.some(function(i){return i.matcher.match(e)||!!(i.gmatcher&&i.gmatcher.match(e))}):!1}function iWt(t,e){return t.ignore.length?t.ignore.some(function(i){return!!(i.gmatcher&&i.gmatcher.match(e))}):!1}});var QVe=z((Rer,ZVe)=>{"use strict";ZVe.exports=KVe;KVe.GlobSync=Ys;var rWt=Cse(),GVe=b8(),Ser=GVe.Minimatch,Eer=jN().Glob,Ter=Ze("util"),Dse=Ze("path"),XVe=Ze("assert"),w8=y8(),Yw=Ise(),nWt=Yw.setopts,Mse=Yw.ownProp,oWt=Yw.childrenIgnored,sWt=Yw.isIgnored;function KVe(t,e){if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new Ys(t,e).found}function Ys(t,e){if(!t)throw new Error("must provide pattern");if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof Ys))return new Ys(t,e);if(nWt(this,t,e),this.noprocess)return this;var i=this.minimatch.set.length;this.matches=new Array(i);for(var r=0;r<i;r++)this._process(this.minimatch.set[r],r,!1);this._finish()}Ys.prototype._finish=function(){if(XVe.ok(this instanceof Ys),this.realpath){var t=this;this.matches.forEach(function(e,i){var r=t.matches[i]=Object.create(null);for(var n in e)try{n=t._makeAbs(n);var o=rWt.realpathSync(n,t.realpathCache);r[o]=!0}catch(s){if(s.syscall==="stat")r[t._makeAbs(n)]=!0;else throw s}})}Yw.finish(this)};Ys.prototype._process=function(t,e,i){XVe.ok(this instanceof Ys);for(var r=0;typeof t[r]=="string";)r++;var n;switch(r){case t.length:this._processSimple(t.join("/"),e);return;case 0:n=null;break;default:n=t.slice(0,r).join("/");break}var o=t.slice(r),s;n===null?s=".":((w8(n)||w8(t.map(function(d){return typeof d=="string"?d:"[*]"}).join("/")))&&(!n||!w8(n))&&(n="/"+n),s=n);var a=this._makeAbs(s);if(!oWt(this,s)){var c=o[0]===GVe.GLOBSTAR;c?this._processGlobStar(n,s,a,o,e,i):this._processReaddir(n,s,a,o,e,i)}};Ys.prototype._processReaddir=function(t,e,i,r,n,o){var s=this._readdir(i,o);if(s){for(var a=r[0],c=!!this.minimatch.negate,d=a._glob,u=this.dot||d.charAt(0)===".",h=[],p=0;p<s.length;p++){var f=s[p];if(f.charAt(0)!=="."||u){var m;c&&!t?m=!f.match(a):m=f.match(a),m&&h.push(f)}}var g=h.length;if(g!==0){if(r.length===1&&!this.mark&&!this.stat){this.matches[n]||(this.matches[n]=Object.create(null));for(var p=0;p<g;p++){var f=h[p];t&&(t.slice(-1)!=="/"?f=t+"/"+f:f=t+f),f.charAt(0)==="/"&&!this.nomount&&(f=Dse.join(this.root,f)),this._emitMatch(n,f)}return}r.shift();for(var p=0;p<g;p++){var f=h[p],y;t?y=[t,f]:y=[f],this._process(y.concat(r),n,o)}}}};Ys.prototype._emitMatch=function(t,e){if(!sWt(this,e)){var i=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=i),!this.matches[t][e]){if(this.nodir){var r=this.cache[i];if(r==="DIR"||Array.isArray(r))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}};Ys.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,i,r;try{i=this.fs.lstatSync(t)}catch(o){if(o.code==="ENOENT")return null}var n=i&&i.isSymbolicLink();return this.symlinks[t]=n,!n&&i&&!i.isDirectory()?this.cache[t]="FILE":e=this._readdir(t,!1),e};Ys.prototype._readdir=function(t,e){var i;if(e&&!Mse(this.symlinks,t))return this._readdirInGlobStar(t);if(Mse(this.cache,t)){var r=this.cache[t];if(!r||r==="FILE")return null;if(Array.isArray(r))return r}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(n){return this._readdirError(t,n),null}};Ys.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var i=0;i<e.length;i++){var r=e[i];t==="/"?r=t+r:r=t+"/"+r,this.cache[r]=!0}return this.cache[t]=e,e};Ys.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var i=this._makeAbs(t);if(this.cache[i]="FILE",i===this.cwdAbs){var r=new Error(e.code+" invalid cwd "+this.cwd);throw r.path=this.cwd,r.code=e.code,r}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e);break}};Ys.prototype._processGlobStar=function(t,e,i,r,n,o){var s=this._readdir(i,o);if(s){var a=r.slice(1),c=t?[t]:[],d=c.concat(a);this._process(d,n,!1);var u=s.length,h=this.symlinks[i];if(!(h&&o))for(var p=0;p<u;p++){var f=s[p];if(!(f.charAt(0)==="."&&!this.dot)){var m=c.concat(s[p],a);this._process(m,n,!0);var g=c.concat(s[p],r);this._process(g,n,!0)}}}};Ys.prototype._processSimple=function(t,e){var i=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),!!i){if(t&&w8(t)&&!this.nomount){var r=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=Dse.join(this.root,t):(t=Dse.resolve(this.root,t),r&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}};Ys.prototype._stat=function(t){var e=this._makeAbs(t),i=t.slice(-1)==="/";if(t.length>this.maxLength)return!1;if(!this.stat&&Mse(this.cache,e)){var s=this.cache[e];if(Array.isArray(s)&&(s="DIR"),!i||s==="DIR")return s;if(i&&s==="FILE")return!1}var r,n=this.statCache[e];if(!n){var o;try{o=this.fs.lstatSync(e)}catch(a){if(a&&(a.code==="ENOENT"||a.code==="ENOTDIR"))return this.statCache[e]=!1,!1}if(o&&o.isSymbolicLink())try{n=this.fs.statSync(e)}catch{n=o}else n=o}this.statCache[e]=n;var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,i&&s==="FILE"?!1:s};Ys.prototype._mark=function(t){return Yw.mark(this,t)};Ys.prototype._makeAbs=function(t){return Yw.makeAbs(this,t)}});var kse=z((Aer,eje)=>{"use strict";eje.exports=JVe;function JVe(t,e){if(t&&e)return JVe(t)(e);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(r){i[r]=t[r]}),i;function i(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];var o=t.apply(this,r),s=r[r.length-1];return typeof o=="function"&&o!==s&&Object.keys(s).forEach(function(a){o[a]=s[a]}),o}}});var x8=z((Ier,Ose)=>{"use strict";var tje=kse();Ose.exports=tje(C8);Ose.exports.strict=tje(ije);C8.proto=C8(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return C8(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return ije(this)},configurable:!0})});function C8(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function ije(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},i=t.name||"Function wrapped with `once`";return e.onceError=i+" shouldn't be called more than once",e.called=!1,e}});var nje=z((Der,rje)=>{"use strict";var aWt=kse(),zN=Object.create(null),lWt=x8();rje.exports=aWt(cWt);function cWt(t,e){return zN[t]?(zN[t].push(e),null):(zN[t]=[e],dWt(t))}function dWt(t){return lWt(function e(){var i=zN[t],r=i.length,n=uWt(arguments);try{for(var o=0;o<r;o++)i[o].apply(null,n)}finally{i.length>r?(i.splice(0,r),process.nextTick(function(){e.apply(null,n)})):delete zN[t]}})}function uWt(t){for(var e=t.length,i=[],r=0;r<e;r++)i[r]=t[r];return i}});var jN=z((Oer,sje)=>{"use strict";sje.exports=$w;var hWt=Cse(),oje=b8(),Mer=oje.Minimatch,fWt=Vi(),pWt=Ze("events").EventEmitter,Nse=Ze("path"),Pse=Ze("assert"),WN=y8(),Fse=QVe(),Gw=Ise(),mWt=Gw.setopts,Lse=Gw.ownProp,Hse=nje(),ker=Ze("util"),gWt=Gw.childrenIgnored,vWt=Gw.isIgnored,bWt=x8();function $w(t,e,i){if(typeof e=="function"&&(i=e,e={}),e||(e={}),e.sync){if(i)throw new TypeError("callback provided to sync glob");return Fse(t,e)}return new bn(t,e,i)}$w.sync=Fse;var _Wt=$w.GlobSync=Fse.GlobSync;$w.glob=$w;function yWt(t,e){if(e===null||typeof e!="object")return t;for(var i=Object.keys(e),r=i.length;r--;)t[i[r]]=e[i[r]];return t}$w.hasMagic=function(t,e){var i=yWt({},e);i.noprocess=!0;var r=new bn(t,i),n=r.minimatch.set;if(!t)return!1;if(n.length>1)return!0;for(var o=0;o<n[0].length;o++)if(typeof n[0][o]!="string")return!0;return!1};$w.Glob=bn;fWt(bn,pWt);function bn(t,e,i){if(typeof e=="function"&&(i=e,e=null),e&&e.sync){if(i)throw new TypeError("callback provided to sync glob");return new _Wt(t,e)}if(!(this instanceof bn))return new bn(t,e,i);mWt(this,t,e),this._didRealPath=!1;var r=this.minimatch.set.length;this.matches=new Array(r),typeof i=="function"&&(i=bWt(i),this.on("error",i),this.on("end",function(c){i(null,c)}));var n=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(r===0)return a();for(var o=!0,s=0;s<r;s++)this._process(this.minimatch.set[s],s,!1,a);o=!1;function a(){--n._processing,n._processing<=0&&(o?process.nextTick(function(){n._finish()}):n._finish())}}bn.prototype._finish=function(){if(Pse(this instanceof bn),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Gw.finish(this),this.emit("end",this.found)}};bn.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var t=this.matches.length;if(t===0)return this._finish();for(var e=this,i=0;i<this.matches.length;i++)this._realpathSet(i,r);function r(){--t===0&&e._finish()}};bn.prototype._realpathSet=function(t,e){var i=this.matches[t];if(!i)return e();var r=Object.keys(i),n=this,o=r.length;if(o===0)return e();var s=this.matches[t]=Object.create(null);r.forEach(function(a,c){a=n._makeAbs(a),hWt.realpath(a,n.realpathCache,function(d,u){d?d.syscall==="stat"?s[a]=!0:n.emit("error",d):s[u]=!0,--o===0&&(n.matches[t]=s,e())})})};bn.prototype._mark=function(t){return Gw.mark(this,t)};bn.prototype._makeAbs=function(t){return Gw.makeAbs(this,t)};bn.prototype.abort=function(){this.aborted=!0,this.emit("abort")};bn.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};bn.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var i=t[e];this._emitMatch(i[0],i[1])}}if(this._processQueue.length){var r=this._processQueue.slice(0);this._processQueue.length=0;for(var e=0;e<r.length;e++){var n=r[e];this._processing--,this._process(n[0],n[1],n[2],n[3])}}}};bn.prototype._process=function(t,e,i,r){if(Pse(this instanceof bn),Pse(typeof r=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([t,e,i,r]);return}for(var n=0;typeof t[n]=="string";)n++;var o;switch(n){case t.length:this._processSimple(t.join("/"),e,r);return;case 0:o=null;break;default:o=t.slice(0,n).join("/");break}var s=t.slice(n),a;o===null?a=".":((WN(o)||WN(t.map(function(u){return typeof u=="string"?u:"[*]"}).join("/")))&&(!o||!WN(o))&&(o="/"+o),a=o);var c=this._makeAbs(a);if(gWt(this,a))return r();var d=s[0]===oje.GLOBSTAR;d?this._processGlobStar(o,a,c,s,e,i,r):this._processReaddir(o,a,c,s,e,i,r)}};bn.prototype._processReaddir=function(t,e,i,r,n,o,s){var a=this;this._readdir(i,o,function(c,d){return a._processReaddir2(t,e,i,r,n,o,d,s)})};bn.prototype._processReaddir2=function(t,e,i,r,n,o,s,a){if(!s)return a();for(var c=r[0],d=!!this.minimatch.negate,u=c._glob,h=this.dot||u.charAt(0)===".",p=[],f=0;f<s.length;f++){var m=s[f];if(m.charAt(0)!=="."||h){var g;d&&!t?g=!m.match(c):g=m.match(c),g&&p.push(m)}}var y=p.length;if(y===0)return a();if(r.length===1&&!this.mark&&!this.stat){this.matches[n]||(this.matches[n]=Object.create(null));for(var f=0;f<y;f++){var m=p[f];t&&(t!=="/"?m=t+"/"+m:m=t+m),m.charAt(0)==="/"&&!this.nomount&&(m=Nse.join(this.root,m)),this._emitMatch(n,m)}return a()}r.shift();for(var f=0;f<y;f++){var m=p[f],w;t&&(t!=="/"?m=t+"/"+m:m=t+m),this._process([m].concat(r),n,o,a)}a()};bn.prototype._emitMatch=function(t,e){if(!this.aborted&&!vWt(this,e)){if(this.paused){this._emitQueue.push([t,e]);return}var i=WN(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=i),!this.matches[t][e]){if(this.nodir){var r=this.cache[i];if(r==="DIR"||Array.isArray(r))return}this.matches[t][e]=!0;var n=this.statCache[i];n&&this.emit("stat",e,n),this.emit("match",e)}}};bn.prototype._readdirInGlobStar=function(t,e){if(this.aborted)return;if(this.follow)return this._readdir(t,!1,e);var i="lstat\0"+t,r=this,n=Hse(i,o);n&&r.fs.lstat(t,n);function o(s,a){if(s&&s.code==="ENOENT")return e();var c=a&&a.isSymbolicLink();r.symlinks[t]=c,!c&&a&&!a.isDirectory()?(r.cache[t]="FILE",e()):r._readdir(t,!1,e)}};bn.prototype._readdir=function(t,e,i){if(!this.aborted&&(i=Hse("readdir\0"+t+"\0"+e,i),!!i)){if(e&&!Lse(this.symlinks,t))return this._readdirInGlobStar(t,i);if(Lse(this.cache,t)){var r=this.cache[t];if(!r||r==="FILE")return i();if(Array.isArray(r))return i(null,r)}var n=this;n.fs.readdir(t,wWt(this,t,i))}};function wWt(t,e,i){return function(r,n){r?t._readdirError(e,r,i):t._readdirEntries(e,n,i)}}bn.prototype._readdirEntries=function(t,e,i){if(!this.aborted){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];t==="/"?n=t+n:n=t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,i(null,e)}};bn.prototype._readdirError=function(t,e,i){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);n.path=this.cwd,n.code=e.code,this.emit("error",n),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e);break}return i()}};bn.prototype._processGlobStar=function(t,e,i,r,n,o,s){var a=this;this._readdir(i,o,function(c,d){a._processGlobStar2(t,e,i,r,n,o,d,s)})};bn.prototype._processGlobStar2=function(t,e,i,r,n,o,s,a){if(!s)return a();var c=r.slice(1),d=t?[t]:[],u=d.concat(c);this._process(u,n,!1,a);var h=this.symlinks[i],p=s.length;if(h&&o)return a();for(var f=0;f<p;f++){var m=s[f];if(!(m.charAt(0)==="."&&!this.dot)){var g=d.concat(s[f],c);this._process(g,n,!0,a);var y=d.concat(s[f],r);this._process(y,n,!0,a)}}a()};bn.prototype._processSimple=function(t,e,i){var r=this;this._stat(t,function(n,o){r._processSimple2(t,e,n,o,i)})};bn.prototype._processSimple2=function(t,e,i,r,n){if(this.matches[e]||(this.matches[e]=Object.create(null)),!r)return n();if(t&&WN(t)&&!this.nomount){var o=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=Nse.join(this.root,t):(t=Nse.resolve(this.root,t),o&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),n()};bn.prototype._stat=function(t,e){var i=this._makeAbs(t),r=t.slice(-1)==="/";if(t.length>this.maxLength)return e();if(!this.stat&&Lse(this.cache,i)){var n=this.cache[i];if(Array.isArray(n)&&(n="DIR"),!r||n==="DIR")return e(null,n);if(r&&n==="FILE")return e()}var o,s=this.statCache[i];if(s!==void 0){if(s===!1)return e(null,s);var a=s.isDirectory()?"DIR":"FILE";return r&&a==="FILE"?e():e(null,a,s)}var c=this,d=Hse("stat\0"+i,u);d&&c.fs.lstat(i,d);function u(h,p){if(p&&p.isSymbolicLink())return c.fs.stat(i,function(f,m){f?c._stat2(t,i,null,p,e):c._stat2(t,i,f,m,e)});c._stat2(t,i,h,p,e)}};bn.prototype._stat2=function(t,e,i,r,n){if(i&&(i.code==="ENOENT"||i.code==="ENOTDIR"))return this.statCache[e]=!1,n();var o=t.slice(-1)==="/";if(this.statCache[e]=r,e.slice(-1)==="/"&&r&&!r.isDirectory())return n(null,!1,r);var s=!0;return r&&(s=r.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,o&&s==="FILE"?n():n(null,s,r)}});var dje=z((Ner,cje)=>{"use strict";var lje=jc(),LT=Ze("path"),Bse=nse(),CWt=dse(),xWt=gse(),SWt=vse(),EWt=jN(),Xw=cje.exports={},aje=/[\/\\]/g,TWt=function(t,e){var i=[];return Bse(t).forEach(function(r){var n=r.indexOf("!")===0;n&&(r=r.slice(1));var o=e(r);n?i=CWt(i,o):i=xWt(i,o)}),i};Xw.exists=function(){var t=LT.join.apply(LT,arguments);return lje.existsSync(t)};Xw.expand=function(...t){var e=SWt(t[0])?t.shift():{},i=Array.isArray(t[0])?t[0]:t;if(i.length===0)return[];var r=TWt(i,function(n){return EWt.sync(n,e)});return e.filter&&(r=r.filter(function(n){n=LT.join(e.cwd||"",n);try{return typeof e.filter=="function"?e.filter(n):lje.statSync(n)[e.filter]()}catch{return!1}})),r};Xw.expandMapping=function(t,e,i){i=Object.assign({rename:function(o,s){return LT.join(o||"",s)}},i);var r=[],n={};return Xw.expand(i,t).forEach(function(o){var s=o;i.flatten&&(s=LT.basename(s)),i.ext&&(s=s.replace(/(\.[^\/]*)?$/,i.ext));var a=i.rename(e,s,i);i.cwd&&(o=LT.join(i.cwd,o)),a=a.replace(aje,"/"),o=o.replace(aje,"/"),n[a]?n[a].src.push(o):(r.push({src:[o],dest:a}),n[a]=r[r.length-1])}),r};Xw.normalizeFilesArray=function(t){var e=[];return t.forEach(function(i){var r;("src"in i||"dest"in i)&&e.push(i)}),e.length===0?[]:(e=_(e).chain().forEach(function(i){!("src"in i)||!i.src||(Array.isArray(i.src)?i.src=Bse(i.src):i.src=[i.src])}).map(function(i){var r=Object.assign({},i);if(delete r.src,delete r.dest,i.expand)return Xw.expandMapping(i.src,i.dest,r).map(function(o){var s=Object.assign({},i);return s.orig=Object.assign({},i),s.src=o.src,s.dest=o.dest,["expand","cwd","flatten","rename","ext"].forEach(function(a){delete s[a]}),s});var n=Object.assign({},i);return n.orig=Object.assign({},i),"src"in n&&Object.defineProperty(n,"src",{enumerable:!0,get:function o(){var s;return"result"in o||(s=i.src,s=Array.isArray(s)?Bse(s):[s],o.result=Xw.expand(r,s)),o.result}}),"dest"in n&&(n.dest=i.dest),n}).flatten().value(),e)}});var UN=z((Ler,fje)=>{"use strict";var Vse=jc(),uje=Ze("path"),Per=Ze("util"),RWt=Ooe(),hje=K6(),AWt=Foe(),IWt=Ze("stream").Stream,DWt=q4e().PassThrough,Ed=fje.exports={};Ed.file=dje();Ed.collectStream=function(t,e){var i=[],r=0;t.on("error",e),t.on("data",function(n){i.push(n),r+=n.length}),t.on("end",function(){var n=new Buffer(r),o=0;i.forEach(function(s){s.copy(n,o),o+=s.length}),e(null,n)})};Ed.dateify=function(t){return t=t||new Date,t instanceof Date?t=t:typeof t=="string"?t=new Date(t):t=new Date,t};Ed.defaults=function(t,e,i){var r=arguments;return r[0]=r[0]||{},AWt(...r)};Ed.isStream=function(t){return t instanceof IWt};Ed.lazyReadStream=function(t){return new RWt.Readable(function(){return Vse.createReadStream(t)})};Ed.normalizeInputSource=function(t){if(t===null)return new Buffer(0);if(typeof t=="string")return new Buffer(t);if(Ed.isStream(t)&&!t._readableState){var e=new DWt;return t.pipe(e),e}return t};Ed.sanitizePath=function(t){return hje(t,!1).replace(/^\w+:/,"").replace(/^(\.\.\/|\/)+/,"")};Ed.trailingSlashIt=function(t){return t.slice(-1)!=="/"?t+"/":t};Ed.unixifyPath=function(t){return hje(t,!1).replace(/^\w+:/,"")};Ed.walkdir=function(t,e,i){var r=[];typeof e=="function"&&(i=e,e=t),Vse.readdir(t,function(n,o){var s=0,a,c;if(n)return i(n);(function d(){if(a=o[s++],!a)return i(null,r);c=uje.join(t,a),Vse.stat(c,function(u,h){r.push({path:c,relative:uje.relative(e,c).replace(/\\/g,"/"),stats:h}),h&&h.isDirectory()?Ed.walkdir(c,e,function(p,f){f.forEach(function(m){r.push(m)}),d()}):d()})})()})}});var vje=z((mje,gje)=>{"use strict";var MWt=Ze("util"),kWt={ABORTED:"archive was aborted",DIRECTORYDIRPATHREQUIRED:"diretory dirpath argument must be a non-empty string value",DIRECTORYFUNCTIONINVALIDDATA:"invalid data returned by directory custom data function",ENTRYNAMEREQUIRED:"entry name must be a non-empty string value",FILEFILEPATHREQUIRED:"file filepath argument must be a non-empty string value",FINALIZING:"archive already finalizing",QUEUECLOSED:"queue closed",NOENDMETHOD:"no suitable finalize/end method defined by module",DIRECTORYNOTSUPPORTED:"support for directory entries not defined by module",FORMATSET:"archive format already set",INPUTSTEAMBUFFERREQUIRED:"input source must be valid Stream or Buffer instance",MODULESET:"module already set",SYMLINKNOTSUPPORTED:"support for symlink entries not defined by module",SYMLINKFILEPATHREQUIRED:"symlink filepath argument must be a non-empty string value",SYMLINKTARGETREQUIRED:"symlink target argument must be a non-empty string value",ENTRYNOTSUPPORTED:"entry not supported"};function pje(t,e){Error.captureStackTrace(this,this.constructor),this.message=kWt[t]||t,this.code=t,this.data=e}MWt.inherits(pje,Error);mje=gje.exports=pje});var Cje=z((Fer,wje)=>{"use strict";var Wse=Ze("fs"),_je=ZHe(),bje=(KBe(),Zce(XBe)),jse=Ze("path"),Sp=UN(),OWt=Ze("util").inherits,Ko=vje(),yje=_l().Transform,zse=process.platform==="win32",Ur=function(t,e){if(!(this instanceof Ur))return new Ur(t,e);typeof t!="string"&&(e=t,t="zip"),e=this.options=Sp.defaults(e,{highWaterMark:1024*1024,statConcurrency:4}),yje.call(this,e),this._format=!1,this._module=!1,this._pending=0,this._pointer=0,this._entriesCount=0,this._entriesProcessedCount=0,this._fsEntriesTotalBytes=0,this._fsEntriesProcessedBytes=0,this._queue=bje.queue(this._onQueueTask.bind(this),1),this._queue.drain(this._onQueueDrain.bind(this)),this._statQueue=bje.queue(this._onStatQueueTask.bind(this),e.statConcurrency),this._statQueue.drain(this._onQueueDrain.bind(this)),this._state={aborted:!1,finalize:!1,finalizing:!1,finalized:!1,modulePiped:!1},this._streams=[]};OWt(Ur,yje);Ur.prototype._abort=function(){this._state.aborted=!0,this._queue.kill(),this._statQueue.kill(),this._queue.idle()&&this._shutdown()};Ur.prototype._append=function(t,e){e=e||{};var i={source:null,filepath:t};e.name||(e.name=t),e.sourcePath=t,i.data=e,this._entriesCount++,e.stats&&e.stats instanceof Wse.Stats?(i=this._updateQueueTaskWithStats(i,e.stats),i&&(e.stats.size&&(this._fsEntriesTotalBytes+=e.stats.size),this._queue.push(i))):this._statQueue.push(i)};Ur.prototype._finalize=function(){this._state.finalizing||this._state.finalized||this._state.aborted||(this._state.finalizing=!0,this._moduleFinalize(),this._state.finalizing=!1,this._state.finalized=!0)};Ur.prototype._maybeFinalize=function(){return this._state.finalizing||this._state.finalized||this._state.aborted?!1:this._state.finalize&&this._pending===0&&this._queue.idle()&&this._statQueue.idle()?(this._finalize(),!0):!1};Ur.prototype._moduleAppend=function(t,e,i){if(this._state.aborted){i();return}this._module.append(t,e,(function(r){if(this._task=null,this._state.aborted){this._shutdown();return}if(r){this.emit("error",r),setImmediate(i);return}this.emit("entry",e),this._entriesProcessedCount++,e.stats&&e.stats.size&&(this._fsEntriesProcessedBytes+=e.stats.size),this.emit("progress",{entries:{total:this._entriesCount,processed:this._entriesProcessedCount},fs:{totalBytes:this._fsEntriesTotalBytes,processedBytes:this._fsEntriesProcessedBytes}}),setImmediate(i)}).bind(this))};Ur.prototype._moduleFinalize=function(){typeof this._module.finalize=="function"?this._module.finalize():typeof this._module.end=="function"?this._module.end():this.emit("error",new Ko("NOENDMETHOD"))};Ur.prototype._modulePipe=function(){this._module.on("error",this._onModuleError.bind(this)),this._module.pipe(this),this._state.modulePiped=!0};Ur.prototype._moduleSupports=function(t){return!this._module.supports||!this._module.supports[t]?!1:this._module.supports[t]};Ur.prototype._moduleUnpipe=function(){this._module.unpipe(this),this._state.modulePiped=!1};Ur.prototype._normalizeEntryData=function(t,e){t=Sp.defaults(t,{type:"file",name:null,date:null,mode:null,prefix:null,sourcePath:null,stats:!1}),e&&t.stats===!1&&(t.stats=e);var i=t.type==="directory";return t.name&&(typeof t.prefix=="string"&&t.prefix!==""&&(t.name=t.prefix+"/"+t.name,t.prefix=null),t.name=Sp.sanitizePath(t.name),t.type!=="symlink"&&t.name.slice(-1)==="/"?(i=!0,t.type="directory"):i&&(t.name+="/")),typeof t.mode=="number"?zse?t.mode&=511:t.mode&=4095:t.stats&&t.mode===null?(zse?t.mode=t.stats.mode&511:t.mode=t.stats.mode&4095,zse&&i&&(t.mode=493)):t.mode===null&&(t.mode=i?493:420),t.stats&&t.date===null?t.date=t.stats.mtime:t.date=Sp.dateify(t.date),t};Ur.prototype._onModuleError=function(t){this.emit("error",t)};Ur.prototype._onQueueDrain=function(){this._state.finalizing||this._state.finalized||this._state.aborted||this._state.finalize&&this._pending===0&&this._queue.idle()&&this._statQueue.idle()&&this._finalize()};Ur.prototype._onQueueTask=function(t,e){var i=()=>{t.data.callback&&t.data.callback(),e()};if(this._state.finalizing||this._state.finalized||this._state.aborted){i();return}this._task=t,this._moduleAppend(t.source,t.data,i)};Ur.prototype._onStatQueueTask=function(t,e){if(this._state.finalizing||this._state.finalized||this._state.aborted){e();return}Wse.lstat(t.filepath,(function(i,r){if(this._state.aborted){setImmediate(e);return}if(i){this._entriesCount--,this.emit("warning",i),setImmediate(e);return}t=this._updateQueueTaskWithStats(t,r),t&&(r.size&&(this._fsEntriesTotalBytes+=r.size),this._queue.push(t)),setImmediate(e)}).bind(this))};Ur.prototype._shutdown=function(){this._moduleUnpipe(),this.end()};Ur.prototype._transform=function(t,e,i){t&&(this._pointer+=t.length),i(null,t)};Ur.prototype._updateQueueTaskWithStats=function(t,e){if(e.isFile())t.data.type="file",t.data.sourceType="stream",t.source=Sp.lazyReadStream(t.filepath);else if(e.isDirectory()&&this._moduleSupports("directory"))t.data.name=Sp.trailingSlashIt(t.data.name),t.data.type="directory",t.data.sourcePath=Sp.trailingSlashIt(t.filepath),t.data.sourceType="buffer",t.source=Buffer.concat([]);else if(e.isSymbolicLink()&&this._moduleSupports("symlink")){var i=Wse.readlinkSync(t.filepath),r=jse.dirname(t.filepath);t.data.type="symlink",t.data.linkname=jse.relative(r,jse.resolve(r,i)),t.data.sourceType="buffer",t.source=Buffer.concat([])}else return e.isDirectory()?this.emit("warning",new Ko("DIRECTORYNOTSUPPORTED",t.data)):e.isSymbolicLink()?this.emit("warning",new Ko("SYMLINKNOTSUPPORTED",t.data)):this.emit("warning",new Ko("ENTRYNOTSUPPORTED",t.data)),null;return t.data=this._normalizeEntryData(t.data,e),t};Ur.prototype.abort=function(){return this._state.aborted||this._state.finalized?this:(this._abort(),this)};Ur.prototype.append=function(t,e){if(this._state.finalize||this._state.aborted)return this.emit("error",new Ko("QUEUECLOSED")),this;if(e=this._normalizeEntryData(e),typeof e.name!="string"||e.name.length===0)return this.emit("error",new Ko("ENTRYNAMEREQUIRED")),this;if(e.type==="directory"&&!this._moduleSupports("directory"))return this.emit("error",new Ko("DIRECTORYNOTSUPPORTED",{name:e.name})),this;if(t=Sp.normalizeInputSource(t),Buffer.isBuffer(t))e.sourceType="buffer";else if(Sp.isStream(t))e.sourceType="stream";else return this.emit("error",new Ko("INPUTSTEAMBUFFERREQUIRED",{name:e.name})),this;return this._entriesCount++,this._queue.push({data:e,source:t}),this};Ur.prototype.directory=function(t,e,i){if(this._state.finalize||this._state.aborted)return this.emit("error",new Ko("QUEUECLOSED")),this;if(typeof t!="string"||t.length===0)return this.emit("error",new Ko("DIRECTORYDIRPATHREQUIRED")),this;this._pending++,e===!1?e="":typeof e!="string"&&(e=t);var r=!1;typeof i=="function"?(r=i,i={}):typeof i!="object"&&(i={});var n={stat:!0,dot:!0};function o(){this._pending--,this._maybeFinalize()}function s(d){this.emit("error",d)}function a(d){c.pause();var u=!1,h=Object.assign({},i);h.name=d.relative,h.prefix=e,h.stats=d.stat,h.callback=c.resume.bind(c);try{if(r){if(h=r(h),h===!1)u=!0;else if(typeof h!="object")throw new Ko("DIRECTORYFUNCTIONINVALIDDATA",{dirpath:t})}}catch(p){this.emit("error",p);return}if(u){c.resume();return}this._append(d.absolute,h)}var c=_je(t,n);return c.on("error",s.bind(this)),c.on("match",a.bind(this)),c.on("end",o.bind(this)),this};Ur.prototype.file=function(t,e){return this._state.finalize||this._state.aborted?(this.emit("error",new Ko("QUEUECLOSED")),this):typeof t!="string"||t.length===0?(this.emit("error",new Ko("FILEFILEPATHREQUIRED")),this):(this._append(t,e),this)};Ur.prototype.glob=function(t,e,i){this._pending++,e=Sp.defaults(e,{stat:!0,pattern:t});function r(){this._pending--,this._maybeFinalize()}function n(a){this.emit("error",a)}function o(a){s.pause();var c=Object.assign({},i);c.callback=s.resume.bind(s),c.stats=a.stat,c.name=a.relative,this._append(a.absolute,c)}var s=_je(e.cwd||".",e);return s.on("error",n.bind(this)),s.on("match",o.bind(this)),s.on("end",r.bind(this)),this};Ur.prototype.finalize=function(){if(this._state.aborted){var t=new Ko("ABORTED");return this.emit("error",t),Promise.reject(t)}if(this._state.finalize){var e=new Ko("FINALIZING");return this.emit("error",e),Promise.reject(e)}this._state.finalize=!0,this._pending===0&&this._queue.idle()&&this._statQueue.idle()&&this._finalize();var i=this;return new Promise(function(r,n){var o;i._module.on("end",function(){o||r()}),i._module.on("error",function(s){o=!0,n(s)})})};Ur.prototype.setFormat=function(t){return this._format?(this.emit("error",new Ko("FORMATSET")),this):(this._format=t,this)};Ur.prototype.setModule=function(t){return this._state.aborted?(this.emit("error",new Ko("ABORTED")),this):this._state.module?(this.emit("error",new Ko("MODULESET")),this):(this._module=t,this._modulePipe(),this)};Ur.prototype.symlink=function(t,e,i){if(this._state.finalize||this._state.aborted)return this.emit("error",new Ko("QUEUECLOSED")),this;if(typeof t!="string"||t.length===0)return this.emit("error",new Ko("SYMLINKFILEPATHREQUIRED")),this;if(typeof e!="string"||e.length===0)return this.emit("error",new Ko("SYMLINKTARGETREQUIRED",{filepath:t})),this;if(!this._moduleSupports("symlink"))return this.emit("error",new Ko("SYMLINKNOTSUPPORTED",{filepath:t})),this;var r={};return r.type="symlink",r.name=t.replace(/\\/g,"/"),r.linkname=e.replace(/\\/g,"/"),r.sourceType="buffer",typeof i=="number"&&(r.mode=i),this._entriesCount++,this._queue.push({data:r,source:Buffer.concat([])}),this};Ur.prototype.pointer=function(){return this._pointer};Ur.prototype.use=function(t){return this._streams.push(t),this};wje.exports=Ur});var E8=z((Her,xje)=>{"use strict";var S8=xje.exports=function(){};S8.prototype.getName=function(){};S8.prototype.getSize=function(){};S8.prototype.getLastModifiedDate=function(){};S8.prototype.isDirectory=function(){}});var T8=z((Ber,Sje)=>{"use strict";var Du=Sje.exports={};Du.dateToDos=function(t,e){e=e||!1;var i=e?t.getFullYear():t.getUTCFullYear();if(i<1980)return 2162688;if(i>=2044)return 2141175677;var r={year:i,month:e?t.getMonth():t.getUTCMonth(),date:e?t.getDate():t.getUTCDate(),hours:e?t.getHours():t.getUTCHours(),minutes:e?t.getMinutes():t.getUTCMinutes(),seconds:e?t.getSeconds():t.getUTCSeconds()};return r.year-1980<<25|r.month+1<<21|r.date<<16|r.hours<<11|r.minutes<<5|r.seconds/2};Du.dosToDate=function(t){return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(t&31)<<1)};Du.fromDosTime=function(t){return Du.dosToDate(t.readUInt32LE(0))};Du.getEightBytes=function(t){var e=Buffer.alloc(8);return e.writeUInt32LE(t%4294967296,0),e.writeUInt32LE(t/4294967296|0,4),e};Du.getShortBytes=function(t){var e=Buffer.alloc(2);return e.writeUInt16LE((t&65535)>>>0,0),e};Du.getShortBytesValue=function(t,e){return t.readUInt16LE(e)};Du.getLongBytes=function(t){var e=Buffer.alloc(4);return e.writeUInt32LE((t&4294967295)>>>0,0),e};Du.getLongBytesValue=function(t,e){return t.readUInt32LE(e)};Du.toDosTime=function(t){return Du.getLongBytes(Du.dateToDos(t))}});var Use=z((Ver,Dje)=>{"use strict";var Eje=T8(),Tje=8,Rje=1,NWt=4,PWt=2,Aje=64,Ije=2048,qa=Dje.exports=function(){return this instanceof qa?(this.descriptor=!1,this.encryption=!1,this.utf8=!1,this.numberOfShannonFanoTrees=0,this.strongEncryption=!1,this.slidingDictionarySize=0,this):new qa};qa.prototype.encode=function(){return Eje.getShortBytes((this.descriptor?Tje:0)|(this.utf8?Ije:0)|(this.encryption?Rje:0)|(this.strongEncryption?Aje:0))};qa.prototype.parse=function(t,e){var i=Eje.getShortBytesValue(t,e),r=new qa;return r.useDataDescriptor((i&Tje)!==0),r.useUTF8ForNames((i&Ije)!==0),r.useStrongEncryption((i&Aje)!==0),r.useEncryption((i&Rje)!==0),r.setSlidingDictionarySize(i&PWt?8192:4096),r.setNumberOfShannonFanoTrees(i&NWt?3:2),r};qa.prototype.setNumberOfShannonFanoTrees=function(t){this.numberOfShannonFanoTrees=t};qa.prototype.getNumberOfShannonFanoTrees=function(){return this.numberOfShannonFanoTrees};qa.prototype.setSlidingDictionarySize=function(t){this.slidingDictionarySize=t};qa.prototype.getSlidingDictionarySize=function(){return this.slidingDictionarySize};qa.prototype.useDataDescriptor=function(t){this.descriptor=t};qa.prototype.usesDataDescriptor=function(){return this.descriptor};qa.prototype.useEncryption=function(t){this.encryption=t};qa.prototype.usesEncryption=function(){return this.encryption};qa.prototype.useStrongEncryption=function(t){this.strongEncryption=t};qa.prototype.usesStrongEncryption=function(){return this.strongEncryption};qa.prototype.useUTF8ForNames=function(t){this.utf8=t};qa.prototype.usesUTF8ForNames=function(){return this.utf8}});var kje=z((jer,Mje)=>{"use strict";Mje.exports={PERM_MASK:4095,FILE_TYPE_FLAG:61440,LINK_FLAG:40960,FILE_FLAG:32768,DIR_FLAG:16384,DEFAULT_LINK_PERM:511,DEFAULT_DIR_PERM:493,DEFAULT_FILE_PERM:420}});var qse=z((zer,Oje)=>{"use strict";Oje.exports={WORD:4,DWORD:8,EMPTY:Buffer.alloc(0),SHORT:2,SHORT_MASK:65535,SHORT_SHIFT:16,SHORT_ZERO:Buffer.from(Array(2)),LONG:4,LONG_ZERO:Buffer.from(Array(4)),MIN_VERSION_INITIAL:10,MIN_VERSION_DATA_DESCRIPTOR:20,MIN_VERSION_ZIP64:45,VERSION_MADEBY:45,METHOD_STORED:0,METHOD_DEFLATED:8,PLATFORM_UNIX:3,PLATFORM_FAT:0,SIG_LFH:67324752,SIG_DD:134695760,SIG_CFH:33639248,SIG_EOCD:101010256,SIG_ZIP64_EOCD:101075792,SIG_ZIP64_EOCD_LOC:117853008,ZIP64_MAGIC_SHORT:65535,ZIP64_MAGIC:4294967295,ZIP64_EXTRA_ID:1,ZLIB_NO_COMPRESSION:0,ZLIB_BEST_SPEED:1,ZLIB_BEST_COMPRESSION:9,ZLIB_DEFAULT_COMPRESSION:-1,MODE_MASK:4095,DEFAULT_FILE_MODE:33188,DEFAULT_DIR_MODE:16877,EXT_FILE_ATTR_DIR:1106051088,EXT_FILE_ATTR_FILE:2175008800,S_IFMT:61440,S_IFIFO:4096,S_IFCHR:8192,S_IFDIR:16384,S_IFBLK:24576,S_IFREG:32768,S_IFLNK:40960,S_IFSOCK:49152,S_DOS_A:32,S_DOS_D:16,S_DOS_V:8,S_DOS_S:4,S_DOS_H:2,S_DOS_R:1}});var Yse=z((Wer,Hje)=>{"use strict";var LWt=Ze("util").inherits,FWt=K6(),Pje=E8(),Lje=Use(),Nje=kje(),Zl=qse(),Fje=T8(),pr=Hje.exports=function(t){if(!(this instanceof pr))return new pr(t);Pje.call(this),this.platform=Zl.PLATFORM_FAT,this.method=-1,this.name=null,this.size=0,this.csize=0,this.gpb=new Lje,this.crc=0,this.time=-1,this.minver=Zl.MIN_VERSION_INITIAL,this.mode=-1,this.extra=null,this.exattr=0,this.inattr=0,this.comment=null,t&&this.setName(t)};LWt(pr,Pje);pr.prototype.getCentralDirectoryExtra=function(){return this.getExtra()};pr.prototype.getComment=function(){return this.comment!==null?this.comment:""};pr.prototype.getCompressedSize=function(){return this.csize};pr.prototype.getCrc=function(){return this.crc};pr.prototype.getExternalAttributes=function(){return this.exattr};pr.prototype.getExtra=function(){return this.extra!==null?this.extra:Zl.EMPTY};pr.prototype.getGeneralPurposeBit=function(){return this.gpb};pr.prototype.getInternalAttributes=function(){return this.inattr};pr.prototype.getLastModifiedDate=function(){return this.getTime()};pr.prototype.getLocalFileDataExtra=function(){return this.getExtra()};pr.prototype.getMethod=function(){return this.method};pr.prototype.getName=function(){return this.name};pr.prototype.getPlatform=function(){return this.platform};pr.prototype.getSize=function(){return this.size};pr.prototype.getTime=function(){return this.time!==-1?Fje.dosToDate(this.time):-1};pr.prototype.getTimeDos=function(){return this.time!==-1?this.time:0};pr.prototype.getUnixMode=function(){return this.platform!==Zl.PLATFORM_UNIX?0:this.getExternalAttributes()>>Zl.SHORT_SHIFT&Zl.SHORT_MASK};pr.prototype.getVersionNeededToExtract=function(){return this.minver};pr.prototype.setComment=function(t){Buffer.byteLength(t)!==t.length&&this.getGeneralPurposeBit().useUTF8ForNames(!0),this.comment=t};pr.prototype.setCompressedSize=function(t){if(t<0)throw new Error("invalid entry compressed size");this.csize=t};pr.prototype.setCrc=function(t){if(t<0)throw new Error("invalid entry crc32");this.crc=t};pr.prototype.setExternalAttributes=function(t){this.exattr=t>>>0};pr.prototype.setExtra=function(t){this.extra=t};pr.prototype.setGeneralPurposeBit=function(t){if(!(t instanceof Lje))throw new Error("invalid entry GeneralPurposeBit");this.gpb=t};pr.prototype.setInternalAttributes=function(t){this.inattr=t};pr.prototype.setMethod=function(t){if(t<0)throw new Error("invalid entry compression method");this.method=t};pr.prototype.setName=function(t,e=!1){t=FWt(t,!1).replace(/^\w+:/,"").replace(/^(\.\.\/|\/)+/,""),e&&(t=`/${t}`),Buffer.byteLength(t)!==t.length&&this.getGeneralPurposeBit().useUTF8ForNames(!0),this.name=t};pr.prototype.setPlatform=function(t){this.platform=t};pr.prototype.setSize=function(t){if(t<0)throw new Error("invalid entry size");this.size=t};pr.prototype.setTime=function(t,e){if(!(t instanceof Date))throw new Error("invalid entry time");this.time=Fje.dateToDos(t,e)};pr.prototype.setUnixMode=function(t){t|=this.isDirectory()?Zl.S_IFDIR:Zl.S_IFREG;var e=0;e|=t<<Zl.SHORT_SHIFT|(this.isDirectory()?Zl.S_DOS_D:Zl.S_DOS_A),this.setExternalAttributes(e),this.mode=t&Zl.MODE_MASK,this.platform=Zl.PLATFORM_UNIX};pr.prototype.setVersionNeededToExtract=function(t){this.minver=t};pr.prototype.isDirectory=function(){return this.getName().slice(-1)==="/"};pr.prototype.isUnixSymlink=function(){return(this.getUnixMode()&Nje.FILE_TYPE_FLAG)===Nje.LINK_FLAG};pr.prototype.isZip64=function(){return this.csize>Zl.ZIP64_MAGIC||this.size>Zl.ZIP64_MAGIC}});var Gse=z((Uer,Bje)=>{"use strict";var HWt=Ze("stream").Stream,BWt=_l().PassThrough,$se=Bje.exports={};$se.isStream=function(t){return t instanceof HWt};$se.normalizeInputSource=function(t){if(t===null)return Buffer.alloc(0);if(typeof t=="string")return Buffer.from(t);if($se.isStream(t)&&!t._readableState){var e=new BWt;return t.pipe(e),e}return t}});var Kse=z((qer,jje)=>{"use strict";var VWt=Ze("util").inherits,Xse=_l().Transform,jWt=E8(),Vje=Gse(),Td=jje.exports=function(t){if(!(this instanceof Td))return new Td(t);Xse.call(this,t),this.offset=0,this._archive={finish:!1,finished:!1,processing:!1}};VWt(Td,Xse);Td.prototype._appendBuffer=function(t,e,i){};Td.prototype._appendStream=function(t,e,i){};Td.prototype._emitErrorCallback=function(t){t&&this.emit("error",t)};Td.prototype._finish=function(t){};Td.prototype._normalizeEntry=function(t){};Td.prototype._transform=function(t,e,i){i(null,t)};Td.prototype.entry=function(t,e,i){if(e=e||null,typeof i!="function"&&(i=this._emitErrorCallback.bind(this)),!(t instanceof jWt)){i(new Error("not a valid instance of ArchiveEntry"));return}if(this._archive.finish||this._archive.finished){i(new Error("unacceptable entry after finish"));return}if(this._archive.processing){i(new Error("already processing an entry"));return}if(this._archive.processing=!0,this._normalizeEntry(t),this._entry=t,e=Vje.normalizeInputSource(e),Buffer.isBuffer(e))this._appendBuffer(t,e,i);else if(Vje.isStream(e))this._appendStream(t,e,i);else{this._archive.processing=!1,i(new Error("input source must be valid Stream or Buffer instance"));return}return this};Td.prototype.finish=function(){if(this._archive.processing){this._archive.finish=!0;return}this._finish()};Td.prototype.getBytesWritten=function(){return this.offset};Td.prototype.write=function(t,e){return t&&(this.offset+=t.length),Xse.prototype.write.call(this,t,e)}});var eae=z((Yer,Wje)=>{"use strict";var R0=Ze("buffer").Buffer,Zse=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(Zse=new Int32Array(Zse));function zje(t){if(R0.isBuffer(t))return t;var e=typeof R0.alloc=="function"&&typeof R0.from=="function";if(typeof t=="number")return e?R0.alloc(t):new R0(t);if(typeof t=="string")return e?R0.from(t):new R0(t);throw new Error("input must be buffer, number, or string, received "+typeof t)}function zWt(t){var e=zje(4);return e.writeInt32BE(t,0),e}function Qse(t,e){t=zje(t),R0.isBuffer(e)&&(e=e.readUInt32BE(0));for(var i=~~e^-1,r=0;r<t.length;r++)i=Zse[(i^t[r])&255]^i>>>8;return i^-1}function Jse(){return zWt(Qse.apply(null,arguments))}Jse.signed=function(){return Qse.apply(null,arguments)};Jse.unsigned=function(){return Qse.apply(null,arguments)>>>0};Wje.exports=Jse});var iae=z(tae=>{"use strict";var Uje;(function(t){typeof DO_NOT_EXPORT_CRC>"u"?typeof tae=="object"?t(tae):typeof define=="function"&&define.amd?define(function(){var e={};return t(e),e}):t(Uje={}):t(Uje={})})(function(t){t.version="1.2.2";function e(){for(var F=0,O=new Array(256),V=0;V!=256;++V)F=V,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,O[V]=F;return typeof Int32Array<"u"?new Int32Array(O):O}var i=e();function r(F){var O=0,V=0,J=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(J=0;J!=256;++J)N[J]=F[J];for(J=0;J!=256;++J)for(V=F[J],O=256+J;O<4096;O+=256)V=N[O]=V>>>8^F[V&255];var P=[];for(J=1;J!=16;++J)P[J-1]=typeof Int32Array<"u"?N.subarray(J*256,J*256+256):N.slice(J*256,J*256+256);return P}var n=r(i),o=n[0],s=n[1],a=n[2],c=n[3],d=n[4],u=n[5],h=n[6],p=n[7],f=n[8],m=n[9],g=n[10],y=n[11],w=n[12],x=n[13],T=n[14];function M(F,O){for(var V=O^-1,J=0,N=F.length;J<N;)V=V>>>8^i[(V^F.charCodeAt(J++))&255];return~V}function B(F,O){for(var V=O^-1,J=F.length-15,N=0;N<J;)V=T[F[N++]^V&255]^x[F[N++]^V>>8&255]^w[F[N++]^V>>16&255]^y[F[N++]^V>>>24]^g[F[N++]]^m[F[N++]]^f[F[N++]]^p[F[N++]]^h[F[N++]]^u[F[N++]]^d[F[N++]]^c[F[N++]]^a[F[N++]]^s[F[N++]]^o[F[N++]]^i[F[N++]];for(J+=15;N<J;)V=V>>>8^i[(V^F[N++])&255];return~V}function G(F,O){for(var V=O^-1,J=0,N=F.length,P=0,$=0;J<N;)P=F.charCodeAt(J++),P<128?V=V>>>8^i[(V^P)&255]:P<2048?(V=V>>>8^i[(V^(192|P>>6&31))&255],V=V>>>8^i[(V^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,$=F.charCodeAt(J++)&1023,V=V>>>8^i[(V^(240|P>>8&7))&255],V=V>>>8^i[(V^(128|P>>2&63))&255],V=V>>>8^i[(V^(128|$>>6&15|(P&3)<<4))&255],V=V>>>8^i[(V^(128|$&63))&255]):(V=V>>>8^i[(V^(224|P>>12&15))&255],V=V>>>8^i[(V^(128|P>>6&63))&255],V=V>>>8^i[(V^(128|P&63))&255]);return~V}t.table=i,t.bstr=M,t.buf=B,t.str=G})});var Yje=z((Ger,qje)=>{"use strict";var{Transform:WWt}=_l(),UWt=iae(),rae=class extends WWt{constructor(e){super(e),this.checksum=Buffer.allocUnsafe(4),this.checksum.writeInt32BE(0,0),this.rawSize=0}_transform(e,i,r){e&&(this.checksum=UWt.buf(e,this.checksum)>>>0,this.rawSize+=e.length),r(null,e)}digest(e){let i=Buffer.allocUnsafe(4);return i.writeUInt32BE(this.checksum>>>0,0),e?i.toString(e):i}hex(){return this.digest("hex").toUpperCase()}size(){return this.rawSize}};qje.exports=rae});var Gje=z((Xer,$je)=>{"use strict";var{DeflateRaw:qWt}=Ze("zlib"),YWt=iae(),nae=class extends qWt{constructor(e){super(e),this.checksum=Buffer.allocUnsafe(4),this.checksum.writeInt32BE(0,0),this.rawSize=0,this.compressedSize=0}push(e,i){return e&&(this.compressedSize+=e.length),super.push(e,i)}_transform(e,i,r){e&&(this.checksum=YWt.buf(e,this.checksum)>>>0,this.rawSize+=e.length),super._transform(e,i,r)}digest(e){let i=Buffer.allocUnsafe(4);return i.writeUInt32BE(this.checksum>>>0,0),e?i.toString(e):i}hex(){return this.digest("hex").toUpperCase()}size(e=!1){return e?this.compressedSize:this.rawSize}};$je.exports=nae});var oae=z((Ker,Xje)=>{"use strict";Xje.exports={CRC32Stream:Yje(),DeflateCRC32Stream:Gje()}});var Qje=z((etr,Zje)=>{"use strict";var $Wt=Ze("util").inherits,GWt=eae(),{CRC32Stream:XWt}=oae(),{DeflateCRC32Stream:KWt}=oae(),Kje=Kse(),Zer=Yse(),Qer=Use(),tr=qse(),Jer=Gse(),Si=T8(),ha=Zje.exports=function(t){if(!(this instanceof ha))return new ha(t);t=this.options=this._defaults(t),Kje.call(this,t),this._entry=null,this._entries=[],this._archive={centralLength:0,centralOffset:0,comment:"",finish:!1,finished:!1,processing:!1,forceZip64:t.forceZip64,forceLocalTime:t.forceLocalTime}};$Wt(ha,Kje);ha.prototype._afterAppend=function(t){this._entries.push(t),t.getGeneralPurposeBit().usesDataDescriptor()&&this._writeDataDescriptor(t),this._archive.processing=!1,this._entry=null,this._archive.finish&&!this._archive.finished&&this._finish()};ha.prototype._appendBuffer=function(t,e,i){e.length===0&&t.setMethod(tr.METHOD_STORED);var r=t.getMethod();if(r===tr.METHOD_STORED&&(t.setSize(e.length),t.setCompressedSize(e.length),t.setCrc(GWt.unsigned(e))),this._writeLocalFileHeader(t),r===tr.METHOD_STORED){this.write(e),this._afterAppend(t),i(null,t);return}else if(r===tr.METHOD_DEFLATED){this._smartStream(t,i).end(e);return}else{i(new Error("compression method "+r+" not implemented"));return}};ha.prototype._appendStream=function(t,e,i){t.getGeneralPurposeBit().useDataDescriptor(!0),t.setVersionNeededToExtract(tr.MIN_VERSION_DATA_DESCRIPTOR),this._writeLocalFileHeader(t);var r=this._smartStream(t,i);e.once("error",function(n){r.emit("error",n),r.end()}),e.pipe(r)};ha.prototype._defaults=function(t){return typeof t!="object"&&(t={}),typeof t.zlib!="object"&&(t.zlib={}),typeof t.zlib.level!="number"&&(t.zlib.level=tr.ZLIB_BEST_SPEED),t.forceZip64=!!t.forceZip64,t.forceLocalTime=!!t.forceLocalTime,t};ha.prototype._finish=function(){this._archive.centralOffset=this.offset,this._entries.forEach((function(t){this._writeCentralFileHeader(t)}).bind(this)),this._archive.centralLength=this.offset-this._archive.centralOffset,this.isZip64()&&this._writeCentralDirectoryZip64(),this._writeCentralDirectoryEnd(),this._archive.processing=!1,this._archive.finish=!0,this._archive.finished=!0,this.end()};ha.prototype._normalizeEntry=function(t){t.getMethod()===-1&&t.setMethod(tr.METHOD_DEFLATED),t.getMethod()===tr.METHOD_DEFLATED&&(t.getGeneralPurposeBit().useDataDescriptor(!0),t.setVersionNeededToExtract(tr.MIN_VERSION_DATA_DESCRIPTOR)),t.getTime()===-1&&t.setTime(new Date,this._archive.forceLocalTime),t._offsets={file:0,data:0,contents:0}};ha.prototype._smartStream=function(t,e){var i=t.getMethod()===tr.METHOD_DEFLATED,r=i?new KWt(this.options.zlib):new XWt,n=null;function o(){var s=r.digest().readUInt32BE(0);t.setCrc(s),t.setSize(r.size()),t.setCompressedSize(r.size(!0)),this._afterAppend(t),e(n,t)}return r.once("end",o.bind(this)),r.once("error",function(s){n=s}),r.pipe(this,{end:!1}),r};ha.prototype._writeCentralDirectoryEnd=function(){var t=this._entries.length,e=this._archive.centralLength,i=this._archive.centralOffset;this.isZip64()&&(t=tr.ZIP64_MAGIC_SHORT,e=tr.ZIP64_MAGIC,i=tr.ZIP64_MAGIC),this.write(Si.getLongBytes(tr.SIG_EOCD)),this.write(tr.SHORT_ZERO),this.write(tr.SHORT_ZERO),this.write(Si.getShortBytes(t)),this.write(Si.getShortBytes(t)),this.write(Si.getLongBytes(e)),this.write(Si.getLongBytes(i));var r=this.getComment(),n=Buffer.byteLength(r);this.write(Si.getShortBytes(n)),this.write(r)};ha.prototype._writeCentralDirectoryZip64=function(){this.write(Si.getLongBytes(tr.SIG_ZIP64_EOCD)),this.write(Si.getEightBytes(44)),this.write(Si.getShortBytes(tr.MIN_VERSION_ZIP64)),this.write(Si.getShortBytes(tr.MIN_VERSION_ZIP64)),this.write(tr.LONG_ZERO),this.write(tr.LONG_ZERO),this.write(Si.getEightBytes(this._entries.length)),this.write(Si.getEightBytes(this._entries.length)),this.write(Si.getEightBytes(this._archive.centralLength)),this.write(Si.getEightBytes(this._archive.centralOffset)),this.write(Si.getLongBytes(tr.SIG_ZIP64_EOCD_LOC)),this.write(tr.LONG_ZERO),this.write(Si.getEightBytes(this._archive.centralOffset+this._archive.centralLength)),this.write(Si.getLongBytes(1))};ha.prototype._writeCentralFileHeader=function(t){var e=t.getGeneralPurposeBit(),i=t.getMethod(),r=t._offsets,n=t.getSize(),o=t.getCompressedSize();if(t.isZip64()||r.file>tr.ZIP64_MAGIC){n=tr.ZIP64_MAGIC,o=tr.ZIP64_MAGIC,t.setVersionNeededToExtract(tr.MIN_VERSION_ZIP64);var s=Buffer.concat([Si.getShortBytes(tr.ZIP64_EXTRA_ID),Si.getShortBytes(24),Si.getEightBytes(t.getSize()),Si.getEightBytes(t.getCompressedSize()),Si.getEightBytes(r.file)],28);t.setExtra(s)}this.write(Si.getLongBytes(tr.SIG_CFH)),this.write(Si.getShortBytes(t.getPlatform()<<8|tr.VERSION_MADEBY)),this.write(Si.getShortBytes(t.getVersionNeededToExtract())),this.write(e.encode()),this.write(Si.getShortBytes(i)),this.write(Si.getLongBytes(t.getTimeDos())),this.write(Si.getLongBytes(t.getCrc())),this.write(Si.getLongBytes(o)),this.write(Si.getLongBytes(n));var a=t.getName(),c=t.getComment(),d=t.getCentralDirectoryExtra();e.usesUTF8ForNames()&&(a=Buffer.from(a),c=Buffer.from(c)),this.write(Si.getShortBytes(a.length)),this.write(Si.getShortBytes(d.length)),this.write(Si.getShortBytes(c.length)),this.write(tr.SHORT_ZERO),this.write(Si.getShortBytes(t.getInternalAttributes())),this.write(Si.getLongBytes(t.getExternalAttributes())),r.file>tr.ZIP64_MAGIC?this.write(Si.getLongBytes(tr.ZIP64_MAGIC)):this.write(Si.getLongBytes(r.file)),this.write(a),this.write(d),this.write(c)};ha.prototype._writeDataDescriptor=function(t){this.write(Si.getLongBytes(tr.SIG_DD)),this.write(Si.getLongBytes(t.getCrc())),t.isZip64()?(this.write(Si.getEightBytes(t.getCompressedSize())),this.write(Si.getEightBytes(t.getSize()))):(this.write(Si.getLongBytes(t.getCompressedSize())),this.write(Si.getLongBytes(t.getSize())))};ha.prototype._writeLocalFileHeader=function(t){var e=t.getGeneralPurposeBit(),i=t.getMethod(),r=t.getName(),n=t.getLocalFileDataExtra();t.isZip64()&&(e.useDataDescriptor(!0),t.setVersionNeededToExtract(tr.MIN_VERSION_ZIP64)),e.usesUTF8ForNames()&&(r=Buffer.from(r)),t._offsets.file=this.offset,this.write(Si.getLongBytes(tr.SIG_LFH)),this.write(Si.getShortBytes(t.getVersionNeededToExtract())),this.write(e.encode()),this.write(Si.getShortBytes(i)),this.write(Si.getLongBytes(t.getTimeDos())),t._offsets.data=this.offset,e.usesDataDescriptor()?(this.write(tr.LONG_ZERO),this.write(tr.LONG_ZERO),this.write(tr.LONG_ZERO)):(this.write(Si.getLongBytes(t.getCrc())),this.write(Si.getLongBytes(t.getCompressedSize())),this.write(Si.getLongBytes(t.getSize()))),this.write(Si.getShortBytes(r.length)),this.write(Si.getShortBytes(n.length)),this.write(r),this.write(n),t._offsets.contents=this.offset};ha.prototype.getComment=function(t){return this._archive.comment!==null?this._archive.comment:""};ha.prototype.isZip64=function(){return this._archive.forceZip64||this._entries.length>tr.ZIP64_MAGIC_SHORT||this._archive.centralLength>tr.ZIP64_MAGIC||this._archive.centralOffset>tr.ZIP64_MAGIC};ha.prototype.setComment=function(t){this._archive.comment=t}});var sae=z((ttr,Jje)=>{"use strict";Jje.exports={ArchiveEntry:E8(),ZipArchiveEntry:Yse(),ArchiveOutputStream:Kse(),ZipArchiveOutputStream:Qje()}});var r6e=z((itr,i6e)=>{"use strict";var t6e=jc(),FT=Ze("path"),aae=nse(),ZWt=dse(),QWt=gse(),JWt=vse(),eUt=jN(),Kw=i6e.exports={},e6e=/[\/\\]/g,tUt=function(t,e){var i=[];return aae(t).forEach(function(r){var n=r.indexOf("!")===0;n&&(r=r.slice(1));var o=e(r);n?i=ZWt(i,o):i=QWt(i,o)}),i};Kw.exists=function(){var t=FT.join.apply(FT,arguments);return t6e.existsSync(t)};Kw.expand=function(...t){var e=JWt(t[0])?t.shift():{},i=Array.isArray(t[0])?t[0]:t;if(i.length===0)return[];var r=tUt(i,function(n){return eUt.sync(n,e)});return e.filter&&(r=r.filter(function(n){n=FT.join(e.cwd||"",n);try{return typeof e.filter=="function"?e.filter(n):t6e.statSync(n)[e.filter]()}catch{return!1}})),r};Kw.expandMapping=function(t,e,i){i=Object.assign({rename:function(o,s){return FT.join(o||"",s)}},i);var r=[],n={};return Kw.expand(i,t).forEach(function(o){var s=o;i.flatten&&(s=FT.basename(s)),i.ext&&(s=s.replace(/(\.[^\/]*)?$/,i.ext));var a=i.rename(e,s,i);i.cwd&&(o=FT.join(i.cwd,o)),a=a.replace(e6e,"/"),o=o.replace(e6e,"/"),n[a]?n[a].src.push(o):(r.push({src:[o],dest:a}),n[a]=r[r.length-1])}),r};Kw.normalizeFilesArray=function(t){var e=[];return t.forEach(function(i){var r;("src"in i||"dest"in i)&&e.push(i)}),e.length===0?[]:(e=_(e).chain().forEach(function(i){!("src"in i)||!i.src||(Array.isArray(i.src)?i.src=aae(i.src):i.src=[i.src])}).map(function(i){var r=Object.assign({},i);if(delete r.src,delete r.dest,i.expand)return Kw.expandMapping(i.src,i.dest,r).map(function(o){var s=Object.assign({},i);return s.orig=Object.assign({},i),s.src=o.src,s.dest=o.dest,["expand","cwd","flatten","rename","ext"].forEach(function(a){delete s[a]}),s});var n=Object.assign({},i);return n.orig=Object.assign({},i),"src"in n&&Object.defineProperty(n,"src",{enumerable:!0,get:function o(){var s;return"result"in o||(s=i.src,s=Array.isArray(s)?aae(s):[s],o.result=Kw.expand(r,s)),o.result}}),"dest"in n&&(n.dest=i.dest),n}).flatten().value(),e)}});var a6e=z((rtr,s6e)=>{"use strict";var lae=jc(),n6e=Ze("path"),iUt=Ooe(),o6e=K6(),rUt=Foe(),nUt=Ze("stream").Stream,oUt=_l().PassThrough,Rd=s6e.exports={};Rd.file=r6e();Rd.collectStream=function(t,e){var i=[],r=0;t.on("error",e),t.on("data",function(n){i.push(n),r+=n.length}),t.on("end",function(){var n=Buffer.alloc(r),o=0;i.forEach(function(s){s.copy(n,o),o+=s.length}),e(null,n)})};Rd.dateify=function(t){return t=t||new Date,t instanceof Date?t=t:typeof t=="string"?t=new Date(t):t=new Date,t};Rd.defaults=function(t,e,i){var r=arguments;return r[0]=r[0]||{},rUt(...r)};Rd.isStream=function(t){return t instanceof nUt};Rd.lazyReadStream=function(t){return new iUt.Readable(function(){return lae.createReadStream(t)})};Rd.normalizeInputSource=function(t){return t===null?Buffer.alloc(0):typeof t=="string"?Buffer.from(t):Rd.isStream(t)?t.pipe(new oUt):t};Rd.sanitizePath=function(t){return o6e(t,!1).replace(/^\w+:/,"").replace(/^(\.\.\/|\/)+/,"")};Rd.trailingSlashIt=function(t){return t.slice(-1)!=="/"?t+"/":t};Rd.unixifyPath=function(t){return o6e(t,!1).replace(/^\w+:/,"")};Rd.walkdir=function(t,e,i){var r=[];typeof e=="function"&&(i=e,e=t),lae.readdir(t,function(n,o){var s=0,a,c;if(n)return i(n);(function d(){if(a=o[s++],!a)return i(null,r);c=n6e.join(t,a),lae.stat(c,function(u,h){r.push({path:c,relative:n6e.relative(e,c).replace(/\\/g,"/"),stats:h}),h&&h.isDirectory()?Rd.walkdir(c,e,function(p,f){f.forEach(function(m){r.push(m)}),d()}):d()})})()})}});var c6e=z((ntr,l6e)=>{"use strict";var sUt=Ze("util").inherits,dae=sae().ZipArchiveOutputStream,aUt=sae().ZipArchiveEntry,cae=a6e(),HT=l6e.exports=function(t){if(!(this instanceof HT))return new HT(t);t=this.options=t||{},t.zlib=t.zlib||{},dae.call(this,t),typeof t.level=="number"&&t.level>=0&&(t.zlib.level=t.level,delete t.level),!t.forceZip64&&typeof t.zlib.level=="number"&&t.zlib.level===0&&(t.store=!0),t.namePrependSlash=t.namePrependSlash||!1,t.comment&&t.comment.length>0&&this.setComment(t.comment)};sUt(HT,dae);HT.prototype._normalizeFileData=function(t){t=cae.defaults(t,{type:"file",name:null,namePrependSlash:this.options.namePrependSlash,linkname:null,date:null,mode:null,store:this.options.store,comment:""});var e=t.type==="directory",i=t.type==="symlink";return t.name&&(t.name=cae.sanitizePath(t.name),!i&&t.name.slice(-1)==="/"?(e=!0,t.type="directory"):e&&(t.name+="/")),(e||i)&&(t.store=!0),t.date=cae.dateify(t.date),t};HT.prototype.entry=function(t,e,i){if(typeof i!="function"&&(i=this._emitErrorCallback.bind(this)),e=this._normalizeFileData(e),e.type!=="file"&&e.type!=="directory"&&e.type!=="symlink"){i(new Error(e.type+" entries not currently supported"));return}if(typeof e.name!="string"||e.name.length===0){i(new Error("entry name must be a non-empty string value"));return}if(e.type==="symlink"&&typeof e.linkname!="string"){i(new Error("entry linkname must be a non-empty string value when type equals symlink"));return}var r=new aUt(e.name);return r.setTime(e.date,this.options.forceLocalTime),e.namePrependSlash&&r.setName(e.name,!0),e.store&&r.setMethod(0),e.comment.length>0&&r.setComment(e.comment),e.type==="symlink"&&typeof e.mode!="number"&&(e.mode=40960),typeof e.mode=="number"&&(e.type==="symlink"&&(e.mode|=40960),r.setUnixMode(e.mode)),e.type==="symlink"&&typeof e.linkname=="string"&&(t=Buffer.from(e.linkname)),dae.prototype.entry.call(this,r,t,i)};HT.prototype.finalize=function(){this.finish()}});var u6e=z((otr,d6e)=>{"use strict";var lUt=c6e(),cUt=UN(),A0=function(t){if(!(this instanceof A0))return new A0(t);t=this.options=cUt.defaults(t,{comment:"",forceUTC:!1,namePrependSlash:!1,store:!1}),this.supports={directory:!0,symlink:!0},this.engine=new lUt(t)};A0.prototype.append=function(t,e,i){this.engine.entry(t,e,i)};A0.prototype.finalize=function(){this.engine.finalize()};A0.prototype.on=function(){return this.engine.on.apply(this.engine,arguments)};A0.prototype.pipe=function(){return this.engine.pipe.apply(this.engine,arguments)};A0.prototype.unpipe=function(){return this.engine.unpipe.apply(this.engine,arguments)};d6e.exports=A0});var p6e=z((str,f6e)=>{"use strict";var{Buffer:kh}=Ze("buffer"),h6e=Symbol.for("BufferList");function Zn(t){if(!(this instanceof Zn))return new Zn(t);Zn._init.call(this,t)}Zn._init=function(e){Object.defineProperty(this,h6e,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Zn.prototype._new=function(e){return new Zn(e)};Zn.prototype._offset=function(e){if(e===0)return[0,0];let i=0;for(let r=0;r<this._bufs.length;r++){let n=i+this._bufs[r].length;if(e<n||r===this._bufs.length-1)return[r,e-i];i=n}};Zn.prototype._reverseOffset=function(t){let e=t[0],i=t[1];for(let r=0;r<e;r++)i+=this._bufs[r].length;return i};Zn.prototype.get=function(e){if(e>this.length||e<0)return;let i=this._offset(e);return this._bufs[i[0]][i[1]]};Zn.prototype.slice=function(e,i){return typeof e=="number"&&e<0&&(e+=this.length),typeof i=="number"&&i<0&&(i+=this.length),this.copy(null,0,e,i)};Zn.prototype.copy=function(e,i,r,n){if((typeof r!="number"||r<0)&&(r=0),(typeof n!="number"||n>this.length)&&(n=this.length),r>=this.length||n<=0)return e||kh.alloc(0);let o=!!e,s=this._offset(r),a=n-r,c=a,d=o&&i||0,u=s[1];if(r===0&&n===this.length){if(!o)return this._bufs.length===1?this._bufs[0]:kh.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,d),d+=this._bufs[h].length;return e}if(c<=this._bufs[s[0]].length-u)return o?this._bufs[s[0]].copy(e,i,u,u+c):this._bufs[s[0]].slice(u,u+c);o||(e=kh.allocUnsafe(a));for(let h=s[0];h<this._bufs.length;h++){let p=this._bufs[h].length-u;if(c>p)this._bufs[h].copy(e,d,u),d+=p;else{this._bufs[h].copy(e,d,u,u+c),d+=p;break}c-=p,u&&(u=0)}return e.length>d?e.slice(0,d):e};Zn.prototype.shallowSlice=function(e,i){if(e=e||0,i=typeof i!="number"?this.length:i,e<0&&(e+=this.length),i<0&&(i+=this.length),e===i)return this._new();let r=this._offset(e),n=this._offset(i),o=this._bufs.slice(r[0],n[0]+1);return n[1]===0?o.pop():o[o.length-1]=o[o.length-1].slice(0,n[1]),r[1]!==0&&(o[0]=o[0].slice(r[1])),this._new(o)};Zn.prototype.toString=function(e,i,r){return this.slice(i,r).toString(e)};Zn.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Zn.prototype.duplicate=function(){let e=this._new();for(let i=0;i<this._bufs.length;i++)e.append(this._bufs[i]);return e};Zn.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(kh.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let i=0;i<e.length;i++)this.append(e[i]);else if(this._isBufferList(e))for(let i=0;i<e._bufs.length;i++)this.append(e._bufs[i]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(kh.from(e));return this};Zn.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Zn.prototype.indexOf=function(t,e,i){if(i===void 0&&typeof e=="string"&&(i=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=kh.from([t]):typeof t=="string"?t=kh.from(t,i):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=kh.from(t.buffer,t.byteOffset,t.byteLength):kh.isBuffer(t)||(t=kh.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let r=this._offset(e),n=r[0],o=r[1];for(;n<this._bufs.length;n++){let s=this._bufs[n];for(;o<s.length;)if(s.length-o>=t.length){let c=s.indexOf(t,o);if(c!==-1)return this._reverseOffset([n,c]);o=s.length-t.length+1}else{let c=this._reverseOffset([n,o]);if(this._match(c,t))return c;o++}o=0}return-1};Zn.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let i=0;i<e.length;i++)if(this.get(t+i)!==e[i])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(i){t[i]===null?Zn.prototype[i]=function(r,n){return this.slice(r,r+n)[i](0,n)}:Zn.prototype[i]=function(r=0){return this.slice(r,r+t[i])[i](0)}})(e)})();Zn.prototype._isBufferList=function(e){return e instanceof Zn||Zn.isBufferList(e)};Zn.isBufferList=function(e){return e!=null&&e[h6e]};f6e.exports=Zn});var m6e=z((atr,R8)=>{"use strict";var uae=_l().Duplex,dUt=Vi(),qN=p6e();function xl(t){if(!(this instanceof xl))return new xl(t);if(typeof t=="function"){this._callback=t;let e=(function(r){this._callback&&(this._callback(r),this._callback=null)}).bind(this);this.on("pipe",function(r){r.on("error",e)}),this.on("unpipe",function(r){r.removeListener("error",e)}),t=null}qN._init.call(this,t),uae.call(this)}dUt(xl,uae);Object.assign(xl.prototype,qN.prototype);xl.prototype._new=function(e){return new xl(e)};xl.prototype._write=function(e,i,r){this._appendBuffer(e),typeof r=="function"&&r()};xl.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)};xl.prototype.end=function(e){uae.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)};xl.prototype._destroy=function(e,i){this._bufs.length=0,this.length=0,i(e)};xl.prototype._isBufferList=function(e){return e instanceof xl||e instanceof qN||xl.isBufferList(e)};xl.isBufferList=qN.isBufferList;R8.exports=xl;R8.exports.BufferListStream=xl;R8.exports.BufferList=qN});var pae=z(VT=>{"use strict";var uUt=Buffer.alloc,hUt="0000000000000000000",fUt="7777777777777777777",g6e=48,v6e=Buffer.from("ustar\0","binary"),pUt=Buffer.from("00","binary"),mUt=Buffer.from("ustar ","binary"),gUt=Buffer.from(" \0","binary"),vUt=parseInt("7777",8),YN=257,fae=263,bUt=function(t,e,i){return typeof t!="number"?i:(t=~~t,t>=e?e:t>=0||(t+=e,t>=0)?t:0)},_Ut=function(t){switch(t){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},yUt=function(t){switch(t){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},b6e=function(t,e,i,r){for(;i<r;i++)if(t[i]===e)return i;return r},_6e=function(t){for(var e=256,i=0;i<148;i++)e+=t[i];for(var r=156;r<512;r++)e+=t[r];return e},I0=function(t,e){return t=t.toString(8),t.length>e?fUt.slice(0,e)+" ":hUt.slice(0,e-t.length)+t+" "};function wUt(t){var e;if(t[0]===128)e=!0;else if(t[0]===255)e=!1;else return null;for(var i=[],r=t.length-1;r>0;r--){var n=t[r];e?i.push(n):i.push(255-n)}var o=0,s=i.length;for(r=0;r<s;r++)o+=i[r]*Math.pow(256,r);return e?o:-1*o}var D0=function(t,e,i){if(t=t.slice(e,e+i),e=0,t[e]&128)return wUt(t);for(;e<t.length&&t[e]===32;)e++;for(var r=bUt(b6e(t,32,e,t.length),t.length,t.length);e<r&&t[e]===0;)e++;return r===e?0:parseInt(t.slice(e,r).toString(),8)},BT=function(t,e,i,r){return t.slice(e,b6e(t,0,e,e+i)).toString(r)},hae=function(t){var e=Buffer.byteLength(t),i=Math.floor(Math.log(e)/Math.log(10))+1;return e+i>=Math.pow(10,i)&&i++,e+i+t};VT.decodeLongPath=function(t,e){return BT(t,0,t.length,e)};VT.encodePax=function(t){var e="";t.name&&(e+=hae(" path="+t.name+`
`)),t.linkname&&(e+=hae(" linkpath="+t.linkname+`
`));var i=t.pax;if(i)for(var r in i)e+=hae(" "+r+"="+i[r]+`
`);return Buffer.from(e)};VT.decodePax=function(t){for(var e={};t.length;){for(var i=0;i<t.length&&t[i]!==32;)i++;var r=parseInt(t.slice(0,i).toString(),10);if(!r)return e;var n=t.slice(i+1,r-1).toString(),o=n.indexOf("=");if(o===-1)return e;e[n.slice(0,o)]=n.slice(o+1),t=t.slice(r)}return e};VT.encode=function(t){var e=uUt(512),i=t.name,r="";if(t.typeflag===5&&i[i.length-1]!=="/"&&(i+="/"),Buffer.byteLength(i)!==i.length)return null;for(;Buffer.byteLength(i)>100;){var n=i.indexOf("/");if(n===-1)return null;r+=r?"/"+i.slice(0,n):i.slice(0,n),i=i.slice(n+1)}return Buffer.byteLength(i)>100||Buffer.byteLength(r)>155||t.linkname&&Buffer.byteLength(t.linkname)>100?null:(e.write(i),e.write(I0(t.mode&vUt,6),100),e.write(I0(t.uid,6),108),e.write(I0(t.gid,6),116),e.write(I0(t.size,11),124),e.write(I0(t.mtime.getTime()/1e3|0,11),136),e[156]=g6e+yUt(t.type),t.linkname&&e.write(t.linkname,157),v6e.copy(e,YN),pUt.copy(e,fae),t.uname&&e.write(t.uname,265),t.gname&&e.write(t.gname,297),e.write(I0(t.devmajor||0,6),329),e.write(I0(t.devminor||0,6),337),r&&e.write(r,345),e.write(I0(_6e(e),6),148),e)};VT.decode=function(t,e,i){var r=t[156]===0?0:t[156]-g6e,n=BT(t,0,100,e),o=D0(t,100,8),s=D0(t,108,8),a=D0(t,116,8),c=D0(t,124,12),d=D0(t,136,12),u=_Ut(r),h=t[157]===0?null:BT(t,157,100,e),p=BT(t,265,32),f=BT(t,297,32),m=D0(t,329,8),g=D0(t,337,8),y=_6e(t);if(y===8*32)return null;if(y!==D0(t,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(v6e.compare(t,YN,YN+6)===0)t[345]&&(n=BT(t,345,155,e)+"/"+n);else if(!(mUt.compare(t,YN,YN+6)===0&&gUt.compare(t,fae,fae+2)===0)){if(!i)throw new Error("Invalid tar header: unknown format.")}return r===0&&n&&n[n.length-1]==="/"&&(r=5),{name:n,mode:o,uid:s,gid:a,size:c,mtime:new Date(1e3*d),type:u,linkname:h,uname:p,gname:f,devmajor:m,devminor:g}}});var T6e=z((ctr,E6e)=>{"use strict";var w6e=Ze("util"),CUt=m6e(),$N=pae(),C6e=_l().Writable,x6e=_l().PassThrough,S6e=function(){},y6e=function(t){return t&=511,t&&512-t},xUt=function(t,e){var i=new A8(t,e);return i.end(),i},SUt=function(t,e){return e.path&&(t.name=e.path),e.linkpath&&(t.linkname=e.linkpath),e.size&&(t.size=parseInt(e.size,10)),t.pax=e,t},A8=function(t,e){this._parent=t,this.offset=e,x6e.call(this,{autoDestroy:!1})};w6e.inherits(A8,x6e);A8.prototype.destroy=function(t){this._parent.destroy(t)};var mg=function(t){if(!(this instanceof mg))return new mg(t);C6e.call(this,t),t=t||{},this._offset=0,this._buffer=CUt(),this._missing=0,this._partial=!1,this._onparse=S6e,this._header=null,this._stream=null,this._overflow=null,this._cb=null,this._locked=!1,this._destroyed=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null;var e=this,i=e._buffer,r=function(){e._continue()},n=function(p){if(e._locked=!1,p)return e.destroy(p);e._stream||r()},o=function(){e._stream=null;var p=y6e(e._header.size);p?e._parse(p,s):e._parse(512,h),e._locked||r()},s=function(){e._buffer.consume(y6e(e._header.size)),e._parse(512,h),r()},a=function(){var p=e._header.size;e._paxGlobal=$N.decodePax(i.slice(0,p)),i.consume(p),o()},c=function(){var p=e._header.size;e._pax=$N.decodePax(i.slice(0,p)),e._paxGlobal&&(e._pax=Object.assign({},e._paxGlobal,e._pax)),i.consume(p),o()},d=function(){var p=e._header.size;this._gnuLongPath=$N.decodeLongPath(i.slice(0,p),t.filenameEncoding),i.consume(p),o()},u=function(){var p=e._header.size;this._gnuLongLinkPath=$N.decodeLongPath(i.slice(0,p),t.filenameEncoding),i.consume(p),o()},h=function(){var p=e._offset,f;try{f=e._header=$N.decode(i.slice(0,512),t.filenameEncoding,t.allowUnknownFormat)}catch(m){e.emit("error",m)}if(i.consume(512),!f){e._parse(512,h),r();return}if(f.type==="gnu-long-path"){e._parse(f.size,d),r();return}if(f.type==="gnu-long-link-path"){e._parse(f.size,u),r();return}if(f.type==="pax-global-header"){e._parse(f.size,a),r();return}if(f.type==="pax-header"){e._parse(f.size,c),r();return}if(e._gnuLongPath&&(f.name=e._gnuLongPath,e._gnuLongPath=null),e._gnuLongLinkPath&&(f.linkname=e._gnuLongLinkPath,e._gnuLongLinkPath=null),e._pax&&(e._header=f=SUt(f,e._pax),e._pax=null),e._locked=!0,!f.size||f.type==="directory"){e._parse(512,h),e.emit("entry",f,xUt(e,p),n);return}e._stream=new A8(e,p),e.emit("entry",f,e._stream,n),e._parse(f.size,o),r()};this._onheader=h,this._parse(512,h)};w6e.inherits(mg,C6e);mg.prototype.destroy=function(t){this._destroyed||(this._destroyed=!0,t&&this.emit("error",t),this.emit("close"),this._stream&&this._stream.emit("close"))};mg.prototype._parse=function(t,e){this._destroyed||(this._offset+=t,this._missing=t,e===this._onheader&&(this._partial=!1),this._onparse=e)};mg.prototype._continue=function(){if(!this._destroyed){var t=this._cb;this._cb=S6e,this._overflow?this._write(this._overflow,void 0,t):t()}};mg.prototype._write=function(t,e,i){if(!this._destroyed){var r=this._stream,n=this._buffer,o=this._missing;if(t.length&&(this._partial=!0),t.length<o)return this._missing-=t.length,this._overflow=null,r?r.write(t,i):(n.append(t),i());this._cb=i,this._missing=0;var s=null;t.length>o&&(s=t.slice(o),t=t.slice(0,o)),r?r.end(t):n.append(t),this._overflow=s,this._onparse()}};mg.prototype._final=function(t){if(this._partial)return this.destroy(new Error("Unexpected end of data"));t()};E6e.exports=mg});var A6e=z((dtr,R6e)=>{"use strict";R6e.exports=Ze("fs").constants||Ze("constants")});var M6e=z((utr,D6e)=>{"use strict";var EUt=x8(),TUt=function(){},RUt=function(t){return t.setHeader&&typeof t.abort=="function"},AUt=function(t){return t.stdio&&Array.isArray(t.stdio)&&t.stdio.length===3},I6e=function(t,e,i){if(typeof e=="function")return I6e(t,null,e);e||(e={}),i=EUt(i||TUt);var r=t._writableState,n=t._readableState,o=e.readable||e.readable!==!1&&t.readable,s=e.writable||e.writable!==!1&&t.writable,a=!1,c=function(){t.writable||d()},d=function(){s=!1,o||i.call(t)},u=function(){o=!1,s||i.call(t)},h=function(y){i.call(t,y?new Error("exited with error code: "+y):null)},p=function(y){i.call(t,y)},f=function(){process.nextTick(m)},m=function(){if(!a){if(o&&!(n&&n.ended&&!n.destroyed))return i.call(t,new Error("premature close"));if(s&&!(r&&r.ended&&!r.destroyed))return i.call(t,new Error("premature close"))}},g=function(){t.req.on("finish",d)};return RUt(t)?(t.on("complete",d),t.on("abort",f),t.req?g():t.on("request",g)):s&&!r&&(t.on("end",c),t.on("close",c)),AUt(t)&&t.on("exit",h),t.on("end",u),t.on("finish",d),e.error!==!1&&t.on("error",p),t.on("close",f),function(){a=!0,t.removeListener("complete",d),t.removeListener("abort",f),t.removeListener("request",g),t.req&&t.req.removeListener("finish",d),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",d),t.removeListener("exit",h),t.removeListener("end",u),t.removeListener("error",p),t.removeListener("close",f)}};D6e.exports=I6e});var L6e=z((htr,P6e)=>{"use strict";var jT=A6e(),k6e=M6e(),D8=Vi(),IUt=Buffer.alloc,O6e=_l().Readable,zT=_l().Writable,DUt=Ze("string_decoder").StringDecoder,I8=pae(),MUt=parseInt("755",8),kUt=parseInt("644",8),N6e=IUt(1024),gae=function(){},mae=function(t,e){e&=511,e&&t.push(N6e.slice(0,512-e))};function OUt(t){switch(t&jT.S_IFMT){case jT.S_IFBLK:return"block-device";case jT.S_IFCHR:return"character-device";case jT.S_IFDIR:return"directory";case jT.S_IFIFO:return"fifo";case jT.S_IFLNK:return"symlink"}return"file"}var M8=function(t){zT.call(this),this.written=0,this._to=t,this._destroyed=!1};D8(M8,zT);M8.prototype._write=function(t,e,i){if(this.written+=t.length,this._to.push(t))return i();this._to._drain=i};M8.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var k8=function(){zT.call(this),this.linkname="",this._decoder=new DUt("utf-8"),this._destroyed=!1};D8(k8,zT);k8.prototype._write=function(t,e,i){this.linkname+=this._decoder.write(t),i()};k8.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var GN=function(){zT.call(this),this._destroyed=!1};D8(GN,zT);GN.prototype._write=function(t,e,i){i(new Error("No body allowed for this entry"))};GN.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var Ep=function(t){if(!(this instanceof Ep))return new Ep(t);O6e.call(this,t),this._drain=gae,this._finalized=!1,this._finalizing=!1,this._destroyed=!1,this._stream=null};D8(Ep,O6e);Ep.prototype.entry=function(t,e,i){if(this._stream)throw new Error("already piping an entry");if(!(this._finalized||this._destroyed)){typeof e=="function"&&(i=e,e=null),i||(i=gae);var r=this;if((!t.size||t.type==="symlink")&&(t.size=0),t.type||(t.type=OUt(t.mode)),t.mode||(t.mode=t.type==="directory"?MUt:kUt),t.uid||(t.uid=0),t.gid||(t.gid=0),t.mtime||(t.mtime=new Date),typeof e=="string"&&(e=Buffer.from(e)),Buffer.isBuffer(e)){t.size=e.length,this._encode(t);var n=this.push(e);return mae(r,t.size),n?process.nextTick(i):this._drain=i,new GN}if(t.type==="symlink"&&!t.linkname){var o=new k8;return k6e(o,function(a){if(a)return r.destroy(),i(a);t.linkname=o.linkname,r._encode(t),i()}),o}if(this._encode(t),t.type!=="file"&&t.type!=="contiguous-file")return process.nextTick(i),new GN;var s=new M8(this);return this._stream=s,k6e(s,function(a){if(r._stream=null,a)return r.destroy(),i(a);if(s.written!==t.size)return r.destroy(),i(new Error("size mismatch"));mae(r,t.size),r._finalizing&&r.finalize(),i()}),s}};Ep.prototype.finalize=function(){if(this._stream){this._finalizing=!0;return}this._finalized||(this._finalized=!0,this.push(N6e),this.push(null))};Ep.prototype.destroy=function(t){this._destroyed||(this._destroyed=!0,t&&this.emit("error",t),this.emit("close"),this._stream&&this._stream.destroy&&this._stream.destroy())};Ep.prototype._encode=function(t){if(!t.pax){var e=I8.encode(t);if(e){this.push(e);return}}this._encodePax(t)};Ep.prototype._encodePax=function(t){var e=I8.encodePax({name:t.name,linkname:t.linkname,pax:t.pax}),i={name:"PaxHeader",mode:t.mode,uid:t.uid,gid:t.gid,size:e.length,mtime:t.mtime,type:"pax-header",linkname:t.linkname&&"PaxHeader",uname:t.uname,gname:t.gname,devmajor:t.devmajor,devminor:t.devminor};this.push(I8.encode(i)),this.push(e),mae(this,e.length),i.size=t.size,i.type=t.type,this.push(I8.encode(i))};Ep.prototype._read=function(t){var e=this._drain;this._drain=gae,e()};P6e.exports=Ep});var F6e=z(vae=>{"use strict";vae.extract=T6e();vae.pack=L6e()});var V6e=z((ptr,B6e)=>{"use strict";var NUt=Ze("zlib"),PUt=F6e(),H6e=UN(),gg=function(t){if(!(this instanceof gg))return new gg(t);t=this.options=H6e.defaults(t,{gzip:!1}),typeof t.gzipOptions!="object"&&(t.gzipOptions={}),this.supports={directory:!0,symlink:!0},this.engine=PUt.pack(t),this.compressor=!1,t.gzip&&(this.compressor=NUt.createGzip(t.gzipOptions),this.compressor.on("error",this._onCompressorError.bind(this)))};gg.prototype._onCompressorError=function(t){this.engine.emit("error",t)};gg.prototype.append=function(t,e,i){var r=this;e.mtime=e.date;function n(s,a){if(s){i(s);return}r.engine.entry(e,a,function(c){i(c,e)})}if(e.sourceType==="buffer")n(null,t);else if(e.sourceType==="stream"&&e.stats){e.size=e.stats.size;var o=r.engine.entry(e,function(s){i(s,e)});t.pipe(o)}else e.sourceType==="stream"&&H6e.collectStream(t,n)};gg.prototype.finalize=function(){this.engine.finalize()};gg.prototype.on=function(){return this.engine.on.apply(this.engine,arguments)};gg.prototype.pipe=function(t,e){return this.compressor?this.engine.pipe.apply(this.engine,[this.compressor]).pipe(t,e):this.engine.pipe.apply(this.engine,arguments)};gg.prototype.unpipe=function(){return this.compressor?this.compressor.unpipe.apply(this.compressor,arguments):this.engine.unpipe.apply(this.engine,arguments)};B6e.exports=gg});var U6e=z((mtr,W6e)=>{"use strict";var LUt=Ze("util").inherits,j6e=_l().Transform,FUt=eae(),z6e=UN(),M0=function(t){if(!(this instanceof M0))return new M0(t);t=this.options=z6e.defaults(t,{}),j6e.call(this,t),this.supports={directory:!0,symlink:!0},this.files=[]};LUt(M0,j6e);M0.prototype._transform=function(t,e,i){i(null,t)};M0.prototype._writeStringified=function(){var t=JSON.stringify(this.files);this.write(t)};M0.prototype.append=function(t,e,i){var r=this;e.crc32=0;function n(o,s){if(o){i(o);return}e.size=s.length||0,e.crc32=FUt.unsigned(s),r.files.push(e),i(null,e)}e.sourceType==="buffer"?n(null,t):e.sourceType==="stream"&&z6e.collectStream(t,n)};M0.prototype.finalize=function(){this._writeStringified(),this.end()};W6e.exports=M0});var Y6e=z((gtr,q6e)=>{"use strict";var HUt=Cje(),XN={},k0=function(t,e){return k0.create(t,e)};k0.create=function(t,e){if(XN[t]){var i=new HUt(t,e);return i.setFormat(t),i.setModule(new XN[t](e)),i}else throw new Error("create("+t+"): format not registered")};k0.registerFormat=function(t,e){if(XN[t])throw new Error("register("+t+"): format already registered");if(typeof e!="function")throw new Error("register("+t+"): format module invalid");if(typeof e.prototype.append!="function"||typeof e.prototype.finalize!="function")throw new Error("register("+t+"): format module missing methods");XN[t]=e};k0.isRegisteredFormat=function(t){return!!XN[t]};k0.registerFormat("zip",u6e());k0.registerFormat("tar",V6e());k0.registerFormat("json",U6e());q6e.exports=k0});var G6e=z((vtr,$6e)=>{"use strict";var bae=class{constructor(){this._values=[],this._totalRefs=0,this._hash=Object.create(null)}get count(){return this._values.length}get values(){return this._values}get totalRefs(){return this._totalRefs}getString(e){return this._values[e]}add(e){let i=this._hash[e];return i===void 0&&(i=this._hash[e]=this._values.length,this._values.push(e)),this._totalRefs++,i}};$6e.exports=bae});var K6e=z((btr,X6e)=>{"use strict";var BUt=yl(),VUt=s0(),_ae=class{constructor(e){this.writer=e}push(e){this.writer.addHyperlink(e)}},yae=class{constructor(e){this.id=e.id,this.count=0,this._hyperlinks=[],this._workbook=e.workbook}get stream(){return this._stream||(this._stream=this._workbook._openStream(`/xl/worksheets/_rels/sheet${this.id}.xml.rels`)),this._stream}get length(){return this._hyperlinks.length}each(e){return this._hyperlinks.forEach(e)}get hyperlinksProxy(){return this._hyperlinksProxy||(this._hyperlinksProxy=new _ae(this))}addHyperlink(e){let i={Target:e.target,Type:VUt.Hyperlink,TargetMode:"External"},r=this._writeRelationship(i);this._hyperlinks.push({rId:r,address:e.address})}addMedia(e){return this._writeRelationship(e)}addRelationship(e){return this._writeRelationship(e)}commit(){this.count&&(this._writeClose(),this.stream.end())}_writeOpen(){this.stream.write(`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
       <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">`)}_writeRelationship(e){this.count||this._writeOpen();let i=`rId${++this.count}`;return e.TargetMode?this.stream.write(`<Relationship Id="${i}" Type="${e.Type}" Target="${BUt.xmlEncode(e.Target)}" TargetMode="${e.TargetMode}"/>`):this.stream.write(`<Relationship Id="${i}" Type="${e.Type}" Target="${e.Target}"/>`),i}_writeClose(){this.stream.write("</Relationships>")}};X6e.exports=yae});var e8e=z((_tr,J6e)=>{"use strict";var Z6e=Ha(),Q6e=s0(),jUt=Oo(),zUt=zie(),WUt=Xie(),wae=class{constructor(e,i,r){this.id=r.id,this.count=0,this._worksheet=e,this._workbook=r.workbook,this._sheetRelsWriter=i}get commentsStream(){return this._commentsStream||(this._commentsStream=this._workbook._openStream(`/xl/comments${this.id}.xml`)),this._commentsStream}get vmlStream(){return this._vmlStream||(this._vmlStream=this._workbook._openStream(`xl/drawings/vmlDrawing${this.id}.vml`)),this._vmlStream}_addRelationships(){let e={Type:Q6e.Comments,Target:`../comments${this.id}.xml`};this._sheetRelsWriter.addRelationship(e);let i={Type:Q6e.VmlDrawing,Target:`../drawings/vmlDrawing${this.id}.vml`};this.vmlRelId=this._sheetRelsWriter.addRelationship(i)}_addCommentRefs(){this._workbook.commentRefs.push({commentName:`comments${this.id}`,vmlDrawing:`vmlDrawing${this.id}`})}_writeOpen(){this.commentsStream.write('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><comments xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><authors><author>Author</author></authors><commentList>'),this.vmlStream.write('<?xml version="1.0" encoding="UTF-8"?><xml xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:x="urn:schemas-microsoft-com:office:excel"><o:shapelayout v:ext="edit"><o:idmap v:ext="edit" data="1" /></o:shapelayout><v:shapetype id="_x0000_t202" coordsize="21600,21600" o:spt="202" path="m,l,21600r21600,l21600,xe"><v:stroke joinstyle="miter" /><v:path gradientshapeok="t" o:connecttype="rect" /></v:shapetype>')}_writeComment(e,i){let r=new zUt,n=new Z6e;r.render(n,e),this.commentsStream.write(n.xml);let o=new WUt,s=new Z6e;o.render(s,e,i),this.vmlStream.write(s.xml)}_writeClose(){this.commentsStream.write("</commentList></comments>"),this.vmlStream.write("</xml>")}addComments(e){e&&e.length&&(this.startedData||(this._worksheet.comments=[],this._writeOpen(),this._addRelationships(),this._addCommentRefs(),this.startedData=!0),e.forEach(i=>{i.refAddress=jUt.decodeAddress(i.ref)}),e.forEach(i=>{this._writeComment(i,this.count),this.count+=1}))}commit(){this.count&&(this._writeClose(),this.commentsStream.end(),this.vmlStream.end())}};J6e.exports=wae});var o8e=z((ytr,n8e)=>{"use strict";var UUt=Go(),qUt=s0(),Cae=Oo(),t8e=hZ(),i8e=Wm(),YUt=FJ(),r8e=M4(),xae=k4(),$Ut=K6e(),GUt=e8e(),XUt=dZ(),fa=new YUt,Sae=r0(),KUt=fte(),ZUt=vte(),QUt=_te(),JUt=ote(),eqt=ite(),tqt=lte(),iqt=wte(),rqt=xte(),nqt=Ete(),oqt=Rte(),sqt=Dte(),aqt=kte(),lqt=Jte(),cqt=Bte(),dqt=Fte(),pa={dataValidations:new KUt,sheetProperties:new ZUt,sheetFormatProperties:new QUt,columns:new Sae({tag:"cols",length:!1,childXform:new JUt}),row:new eqt,hyperlinks:new Sae({tag:"hyperlinks",length:!1,childXform:new tqt}),sheetViews:new Sae({tag:"sheetViews",length:!1,childXform:new iqt}),sheetProtection:new rqt,pageMargins:new nqt,pageSeteup:new oqt,autoFilter:new sqt,picture:new aqt,conditionalFormattings:new lqt,headerFooter:new cqt,rowBreaks:new dqt},Eae=class{constructor(e){this.id=e.id,this.name=e.name||`Sheet${this.id}`,this.state=e.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges=[],this._merges.add=function(){},this._sheetRelsWriter=new $Ut(e),this._sheetCommentsWriter=new GUt(this,this._sheetRelsWriter,e),this._dimensions=new i8e,this._rowZero=1,this.committed=!1,this.dataValidations=new XUt,this._formulae={},this._siFormulae=0,this.conditionalFormatting=[],this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},e.properties),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},e.headerFooter),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!!(e.pageSetup&&(e.pageSetup.fitToWidth||e.pageSetup.fitToHeight)&&!e.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},e.pageSetup),this.useSharedStrings=e.useSharedStrings||!1,this._workbook=e.workbook,this.hasComments=!1,this._views=e.views||[],this.autoFilter=e.autoFilter||null,this._media=[],this.sheetProtection=null,this._writeOpenWorksheet(),this.startedData=!1}get workbook(){return this._workbook}get stream(){return this._stream||(this._stream=this._workbook._openStream(`/xl/worksheets/sheet${this.id}.xml`),this._stream.pause()),this._stream}destroy(){throw new Error("Invalid Operation: destroy")}commit(){this.committed||(this._rows.forEach(e=>{e&&this._writeRow(e)}),this._rows=null,this.startedData||this._writeOpenSheetData(),this._writeCloseSheetData(),this._writeAutoFilter(),this._writeMergeCells(),this._writeHyperlinks(),this._writeConditionalFormatting(),this._writeDataValidations(),this._writeSheetProtection(),this._writePageMargins(),this._writePageSetup(),this._writeBackground(),this._writeHeaderFooter(),this._writeRowBreaks(),this._writeLegacyData(),this._writeCloseWorksheet(),this.stream.end(),this._sheetCommentsWriter.commit(),this._sheetRelsWriter.commit(),this.committed=!0)}get dimensions(){return this._dimensions}get views(){return this._views}get columns(){return this._columns}set columns(e){this._headerRowCount=e.reduce((n,o)=>{let s=o.header&&1||o.headers&&o.headers.length||0;return Math.max(n,s)},0);let i=1,r=this._columns=[];e.forEach(n=>{let o=new xae(this,i++,!1);r.push(o),o.defn=n})}getColumnKey(e){return this._keys[e]}setColumnKey(e,i){this._keys[e]=i}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){UUt.each(this._keys,e)}getColumn(e){if(typeof e=="string"){let i=this._keys[e];if(i)return i;e=Cae.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let i=this._columns.length+1;for(;i<=e;)this._columns.push(new xae(this,i++))}return this._columns[e-1]}get _nextRow(){return this._rowZero+this._rows.length}eachRow(e,i){if(i||(i=e,e=void 0),e&&e.includeEmpty){let r=this._nextRow;for(let n=this._rowZero;n<r;n++)i(this.getRow(n),n)}else this._rows.forEach(r=>{r.hasValues&&i(r,r.number)})}_commitRow(e){let i=!1;for(;this._rows.length&&!i;){let r=this._rows.shift();this._rowZero++,r&&(this._writeRow(r),i=r.number===e.number,this._rowZero=r.number+1)}}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(e){let i=e-this._rowZero;return this._rows[i]}getRow(e){let i=e-this._rowZero;if(i<0)throw new Error("Out of bounds: this row has been committed");let r=this._rows[i];return r||(this._rows[i]=r=new r8e(this,e)),r}addRow(e){let i=new r8e(this,this._nextRow);return this._rows[i.number-this._rowZero]=i,i.values=e,i}findCell(e,i){let r=Cae.getAddress(e,i),n=this.findRow(r.row);return n?n.findCell(r.column):void 0}getCell(e,i){let r=Cae.getAddress(e,i);return this.getRow(r.row).getCellEx(r)}mergeCells(...e){let i=new i8e(e);this._merges.forEach(n=>{if(n.intersects(i))throw new Error("Cannot merge already merged cells")});let r=this.getCell(i.top,i.left);for(let n=i.top;n<=i.bottom;n++)for(let o=i.left;o<=i.right;o++)(n>i.top||o>i.left)&&this.getCell(n,o).merge(r);this._merges.push(i)}addConditionalFormatting(e){this.conditionalFormatting.push(e)}removeConditionalFormatting(e){typeof e=="number"?this.conditionalFormatting.splice(e,1):e instanceof Function?this.conditionalFormatting=this.conditionalFormatting.filter(e):this.conditionalFormatting=[]}addBackgroundImage(e){this._background={imageId:e}}getBackgroundImageId(){return this._background&&this._background.imageId}protect(e,i){return new Promise(r=>{this.sheetProtection={sheet:!0},i&&"spinCount"in i&&(i.spinCount=Number.isFinite(i.spinCount)?Math.round(Math.max(0,i.spinCount)):1e5),e&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=t8e.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=i&&"spinCount"in i?i.spinCount:1e5,this.sheetProtection.hashValue=t8e.convertPasswordToHash(e,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),i&&(this.sheetProtection=Object.assign(this.sheetProtection,i),!e&&"spinCount"in i&&delete this.sheetProtection.spinCount),r()})}unprotect(){this.sheetProtection=null}_write(e){fa.reset(),fa.addText(e),this.stream.write(fa)}_writeSheetProperties(e,i,r){let n={outlineProperties:i&&i.outlineProperties,tabColor:i&&i.tabColor,pageSetup:r&&r.fitToPage?{fitToPage:r.fitToPage}:void 0};e.addText(pa.sheetProperties.toXml(n))}_writeSheetFormatProperties(e,i){let r=i?{defaultRowHeight:i.defaultRowHeight,dyDescent:i.dyDescent,outlineLevelCol:i.outlineLevelCol,outlineLevelRow:i.outlineLevelRow}:void 0;i.defaultColWidth&&(r.defaultColWidth=i.defaultColWidth),e.addText(pa.sheetFormatProperties.toXml(r))}_writeOpenWorksheet(){fa.reset(),fa.addText('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'),fa.addText('<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'),this._writeSheetProperties(fa,this.properties,this.pageSetup),fa.addText(pa.sheetViews.toXml(this.views)),this._writeSheetFormatProperties(fa,this.properties),this.stream.write(fa)}_writeColumns(){let e=xae.toModel(this.columns);e&&(pa.columns.prepare(e,{styles:this._workbook.styles}),this.stream.write(pa.columns.toXml(e)))}_writeOpenSheetData(){this._write("<sheetData>")}_writeRow(e){if(this.startedData||(this._writeColumns(),this._writeOpenSheetData(),this.startedData=!0),e.hasValues||e.height){let{model:i}=e,r={styles:this._workbook.styles,sharedStrings:this.useSharedStrings?this._workbook.sharedStrings:void 0,hyperlinks:this._sheetRelsWriter.hyperlinksProxy,merges:this._merges,formulae:this._formulae,siFormulae:this._siFormulae,comments:[]};pa.row.prepare(i,r),this.stream.write(pa.row.toXml(i)),r.comments.length&&(this.hasComments=!0,this._sheetCommentsWriter.addComments(r.comments))}}_writeCloseSheetData(){this._write("</sheetData>")}_writeMergeCells(){this._merges.length&&(fa.reset(),fa.addText(`<mergeCells count="${this._merges.length}">`),this._merges.forEach(e=>{fa.addText(`<mergeCell ref="${e}"/>`)}),fa.addText("</mergeCells>"),this.stream.write(fa))}_writeHyperlinks(){this.stream.write(pa.hyperlinks.toXml(this._sheetRelsWriter._hyperlinks))}_writeConditionalFormatting(){let e={styles:this._workbook.styles};pa.conditionalFormattings.prepare(this.conditionalFormatting,e),this.stream.write(pa.conditionalFormattings.toXml(this.conditionalFormatting))}_writeRowBreaks(){this.stream.write(pa.rowBreaks.toXml(this.rowBreaks))}_writeDataValidations(){this.stream.write(pa.dataValidations.toXml(this.dataValidations.model))}_writeSheetProtection(){this.stream.write(pa.sheetProtection.toXml(this.sheetProtection))}_writePageMargins(){this.stream.write(pa.pageMargins.toXml(this.pageSetup.margins))}_writePageSetup(){this.stream.write(pa.pageSeteup.toXml(this.pageSetup))}_writeHeaderFooter(){this.stream.write(pa.headerFooter.toXml(this.headerFooter))}_writeAutoFilter(){this.stream.write(pa.autoFilter.toXml(this.autoFilter))}_writeBackground(){if(this._background){if(this._background.imageId!==void 0){let e=this._workbook.getImage(this._background.imageId),i=this._sheetRelsWriter.addMedia({Target:`../media/${e.name}`,Type:qUt.Image});this._background=Lt(Ke({},this._background),{rId:i})}this.stream.write(pa.picture.toXml({rId:this._background.rId}))}}_writeLegacyData(){this.hasComments&&(fa.reset(),fa.addText(`<legacyDrawing r:id="${this._sheetCommentsWriter.vmlRelId}"/>`),this.stream.write(fa))}_writeDimensions(){}_writeCloseWorksheet(){this._write("</worksheet>")}};n8e.exports=Eae});var d8e=z((Ctr,c8e)=>{"use strict";var uqt=Ze("fs"),hqt=Y6e(),s8e=z2(),Zw=s0(),a8e=sj(),fqt=G6e(),pqt=vZ(),mqt=Nee(),l8e=lj(),gqt=jee(),vqt=Uee(),bqt=cj(),_qt=Bee(),yqt=o8e(),wqt=Kie(),Tae=class{constructor(e){e=e||{},this.created=e.created||new Date,this.modified=e.modified||this.created,this.creator=e.creator||"ExcelJS",this.lastModifiedBy=e.lastModifiedBy||"ExcelJS",this.lastPrinted=e.lastPrinted,this.useSharedStrings=e.useSharedStrings||!1,this.sharedStrings=new fqt,this.styles=e.useStyles?new a8e(!0):new a8e.Mock(!0),this._definedNames=new pqt,this._worksheets=[],this.views=[],this.zipOptions=e.zip,this.media=[],this.commentRefs=[],this.zip=hqt("zip",this.zipOptions),e.stream?this.stream=e.stream:e.filename?this.stream=uqt.createWriteStream(e.filename):this.stream=new s8e,this.zip.pipe(this.stream),this.promise=Promise.all([this.addThemes(),this.addOfficeRels()])}get definedNames(){return this._definedNames}_openStream(e){let i=new s8e({bufSize:65536,batch:!0});return this.zip.append(i,{name:e}),i.on("finish",()=>{i.emit("zipped")}),i}_commitWorksheets(){let e=function(r){return r.committed?Promise.resolve():new Promise(n=>{r.stream.on("zipped",()=>{n()}),r.commit()})},i=this._worksheets.map(e);return i.length?Promise.all(i):Promise.resolve()}commit(){return Ei(this,null,function*(){return yield this.promise,yield this.addMedia(),yield this._commitWorksheets(),yield Promise.all([this.addContentTypes(),this.addApp(),this.addCore(),this.addSharedStrings(),this.addStyles(),this.addWorkbookRels()]),yield this.addWorkbook(),this._finalize()})}get nextId(){let e;for(e=1;e<this._worksheets.length;e++)if(!this._worksheets[e])return e;return this._worksheets.length||1}addImage(e){let i=this.media.length,r=Object.assign({},e,{type:"image",name:`image${i}.${e.extension}`});return this.media.push(r),i}getImage(e){return this.media[e]}addWorksheet(e,i){i=i||{};let r=i.useSharedStrings!==void 0?i.useSharedStrings:this.useSharedStrings;i.tabColor&&(console.trace("tabColor option has moved to { properties: tabColor: {...} }"),i.properties=Object.assign({tabColor:i.tabColor},i.properties));let n=this.nextId;e=e||`sheet${n}`;let o=new yqt({id:n,name:e,workbook:this,useSharedStrings:r,properties:i.properties,state:i.state,pageSetup:i.pageSetup,views:i.views,autoFilter:i.autoFilter,headerFooter:i.headerFooter});return this._worksheets[n]=o,o}getWorksheet(e){if(e===void 0)return this._worksheets.find(()=>!0);if(typeof e=="number")return this._worksheets[e];if(typeof e=="string")return this._worksheets.find(i=>i&&i.name===e)}addStyles(){return new Promise(e=>{this.zip.append(this.styles.xml,{name:"xl/styles.xml"}),e()})}addThemes(){return new Promise(e=>{this.zip.append(wqt,{name:"xl/theme/theme1.xml"}),e()})}addOfficeRels(){return new Promise(e=>{let r=new l8e().toXml([{Id:"rId1",Type:Zw.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:Zw.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:Zw.ExtenderProperties,Target:"docProps/app.xml"}]);this.zip.append(r,{name:"/_rels/.rels"}),e()})}addContentTypes(){return new Promise(e=>{let i={worksheets:this._worksheets.filter(Boolean),sharedStrings:this.sharedStrings,commentRefs:this.commentRefs,media:this.media},n=new gqt().toXml(i);this.zip.append(n,{name:"[Content_Types].xml"}),e()})}addMedia(){return Promise.all(this.media.map(e=>{if(e.type==="image"){let i=`xl/media/${e.name}`;if(e.filename)return this.zip.file(e.filename,{name:i});if(e.buffer)return this.zip.append(e.buffer,{name:i});if(e.base64){let r=e.base64,n=r.substring(r.indexOf(",")+1);return this.zip.append(n,{name:i,base64:!0})}}throw new Error("Unsupported media")}))}addApp(){return new Promise(e=>{let i={worksheets:this._worksheets.filter(Boolean)},n=new vqt().toXml(i);this.zip.append(n,{name:"docProps/app.xml"}),e()})}addCore(){return new Promise(e=>{let r=new mqt().toXml(this);this.zip.append(r,{name:"docProps/core.xml"}),e()})}addSharedStrings(){return this.sharedStrings.count?new Promise(e=>{let r=new _qt().toXml(this.sharedStrings);this.zip.append(r,{name:"/xl/sharedStrings.xml"}),e()}):Promise.resolve()}addWorkbookRels(){let e=1,i=[{Id:`rId${e++}`,Type:Zw.Styles,Target:"styles.xml"},{Id:`rId${e++}`,Type:Zw.Theme,Target:"theme/theme1.xml"}];return this.sharedStrings.count&&i.push({Id:`rId${e++}`,Type:Zw.SharedStrings,Target:"sharedStrings.xml"}),this._worksheets.forEach(r=>{r&&(r.rId=`rId${e++}`,i.push({Id:r.rId,Type:Zw.Worksheet,Target:`worksheets/sheet${r.id}.xml`}))}),new Promise(r=>{let o=new l8e().toXml(i);this.zip.append(o,{name:"/xl/_rels/workbook.xml.rels"}),r()})}addWorkbook(){let{zip:e}=this,i={worksheets:this._worksheets.filter(Boolean),definedNames:this._definedNames.model,views:this.views,properties:{},calcProperties:{}};return new Promise(r=>{let n=new bqt;n.prepare(i),e.append(n.toXml(i),{name:"/xl/workbook.xml"}),r()})}_finalize(){return new Promise((e,i)=>{this.stream.on("error",i),this.stream.on("finish",()=>{e(this)}),this.zip.on("error",i),this.zip.finalize()})}};c8e.exports=Tae});var h8e=z((Str,u8e)=>{"use strict";var Rae=Ze("events").listenerCount;Rae=Rae||function(t,e){var i=t&&t._events&&t._events[e];return Array.isArray(i)?i.length:typeof i=="function"?1:0};u8e.exports=Rae});var p8e=z((Etr,f8e)=>{"use strict";f8e.exports=function(e){var i=process&&process.version?process.version:"v5.0.0",r=i.split(".")[0].replace("v","");return r<6?new Buffer(e):Buffer.from(e)}});var g8e=z(()=>{"use strict";var KN=p8e();Buffer.prototype.indexOf||(Buffer.prototype.indexOf=function(t,e){e=e||0,typeof t=="string"||t instanceof String?t=KN(t):(typeof t=="number"||t instanceof Number)&&(t=KN([t]));for(var i=t.length,r=e;r<=this.length-i;r++){for(var n=!1,o=0;o<i;o++)if(this[r+o]!=t[o]){n=!0;break}if(!n)return r}return-1});function m8e(t,e){typeof t=="string"||t instanceof String?t=KN(t):(typeof t=="number"||t instanceof Number)&&(t=KN([t]));var i=t.length;e=e||this.length-i;for(var r=e;r>=0;r--){for(var n=!1,o=0;o<i;o++)if(this[r+o]!=t[o]){n=!0;break}if(!n)return r}return-1}Buffer.prototype.lastIndexOf?KN("ABC").lastIndexOf("ABC")===-1&&(Buffer.prototype.lastIndexOf=m8e):Buffer.prototype.lastIndexOf=m8e});var y8e=z((Atr,_8e)=>{"use strict";_8e.exports=Sl;function Sl(t){if(!(this instanceof Sl))return new Sl(t);this.value=t}Sl.prototype.get=function(t){for(var e=this.value,i=0;i<t.length;i++){var r=t[i];if(!Object.hasOwnProperty.call(e,r)){e=void 0;break}e=e[r]}return e};Sl.prototype.set=function(t,e){for(var i=this.value,r=0;r<t.length-1;r++){var n=t[r];Object.hasOwnProperty.call(i,n)||(i[n]={}),i=i[n]}return i[t[r]]=e,e};Sl.prototype.map=function(t){return v8e(this.value,t,!0)};Sl.prototype.forEach=function(t){return this.value=v8e(this.value,t,!1),this.value};Sl.prototype.reduce=function(t,e){var i=arguments.length===1,r=i?this.value:e;return this.forEach(function(n){(!this.isRoot||!i)&&(r=t.call(this,r,n))}),r};Sl.prototype.deepEqual=function(t){if(arguments.length!==1)throw new Error("deepEqual requires exactly one object to compare against");var e=!0,i=t;return this.forEach(function(r){var n=(function(){e=!1}).bind(this);if(!this.isRoot){if(typeof i!="object")return n();i=i[this.key]}var o=i;this.post(function(){i=o});var s=function(h){return Object.prototype.toString.call(h)};if(this.circular)Sl(t).get(this.circular.path)!==o&&n();else if(typeof o!=typeof r)n();else if(o===null||r===null||o===void 0||r===void 0)o!==r&&n();else if(o.__proto__!==r.__proto__)n();else if(o!==r){if(typeof o=="function")o instanceof RegExp?o.toString()!=r.toString()&&n():o!==r&&n();else if(typeof o=="object")if(s(r)==="[object Arguments]"||s(o)==="[object Arguments]")s(o)!==s(r)&&n();else if(o instanceof Date||r instanceof Date)(!(o instanceof Date)||!(r instanceof Date)||o.getTime()!==r.getTime())&&n();else{var a=Object.keys(o),c=Object.keys(r);if(a.length!==c.length)return n();for(var d=0;d<a.length;d++){var u=a[d];Object.hasOwnProperty.call(r,u)||n()}}}}),e};Sl.prototype.paths=function(){var t=[];return this.forEach(function(e){t.push(this.path)}),t};Sl.prototype.nodes=function(){var t=[];return this.forEach(function(e){t.push(this.node)}),t};Sl.prototype.clone=function(){var t=[],e=[];return function i(r){for(var n=0;n<t.length;n++)if(t[n]===r)return e[n];if(typeof r=="object"&&r!==null){var o=b8e(r);return t.push(r),e.push(o),Object.keys(r).forEach(function(s){o[s]=i(r[s])}),t.pop(),e.pop(),o}else return r}(this.value)};function v8e(t,e,i){var r=[],n=[],o=!0;return function s(a){var c=i?b8e(a):a,d={},u={node:c,node_:a,path:[].concat(r),parent:n.slice(-1)[0],key:r.slice(-1)[0],isRoot:r.length===0,level:r.length,circular:null,update:function(m){u.isRoot||(u.parent.node[u.key]=m),u.node=m},delete:function(){delete u.parent.node[u.key]},remove:function(){Array.isArray(u.parent.node)?u.parent.node.splice(u.key,1):delete u.parent.node[u.key]},before:function(m){d.before=m},after:function(m){d.after=m},pre:function(m){d.pre=m},post:function(m){d.post=m},stop:function(){o=!1}};if(!o)return u;if(typeof c=="object"&&c!==null){u.isLeaf=Object.keys(c).length==0;for(var h=0;h<n.length;h++)if(n[h].node_===a){u.circular=n[h];break}}else u.isLeaf=!0;u.notLeaf=!u.isLeaf,u.notRoot=!u.isRoot;var p=e.call(u,u.node);if(p!==void 0&&u.update&&u.update(p),d.before&&d.before.call(u,u.node),typeof u.node=="object"&&u.node!==null&&!u.circular){n.push(u);var f=Object.keys(u.node);f.forEach(function(m,g){r.push(m),d.pre&&d.pre.call(u,u.node[m],m);var y=s(u.node[m]);i&&Object.hasOwnProperty.call(u.node,m)&&(u.node[m]=y.node),y.isLast=g==f.length-1,y.isFirst=g==0,d.post&&d.post.call(u,y),r.pop()}),n.pop()}return d.after&&d.after.call(u,u.node),u}(t).node}Object.keys(Sl.prototype).forEach(function(t){Sl[t]=function(e){var i=[].slice.call(arguments,1),r=Sl(e);return r[t].apply(r,i)}});function b8e(t){if(typeof t=="object"&&t!==null){var e;return Array.isArray(t)?e=[]:t instanceof Date?e=new Date(t):t instanceof Boolean?e=new Boolean(t):t instanceof Number?e=new Number(t):t instanceof String?e=new String(t):e=Object.create(Object.getPrototypeOf(t)),Object.keys(t).forEach(function(i){e[i]=t[i]}),e}else return t}});var C8e=z((Itr,w8e)=>{"use strict";var Cqt=y8e(),xqt=Ze("events").EventEmitter;w8e.exports=WT;function WT(t){var e=WT.saw(t,{}),i=t.call(e.handlers,e);return i!==void 0&&(e.handlers=i),e.record(),e.chain()}WT.light=function(e){var i=WT.saw(e,{}),r=e.call(i.handlers,i);return r!==void 0&&(i.handlers=r),i.chain()};WT.saw=function(t,e){var i=new xqt;return i.handlers=e,i.actions=[],i.chain=function(){var r=Cqt(i.handlers).map(function(n){if(this.isRoot)return n;var o=this.path;typeof n=="function"&&this.update(function(){return i.actions.push({path:o,args:[].slice.call(arguments)}),r})});return process.nextTick(function(){i.emit("begin"),i.next()}),r},i.pop=function(){return i.actions.shift()},i.next=function(){var r=i.pop();if(!r)i.emit("end");else if(!r.trap){var n=i.handlers;r.path.forEach(function(o){n=n[o]}),n.apply(i.handlers,r.args)}},i.nest=function(r){var n=[].slice.call(arguments,1),o=!0;if(typeof r=="boolean"){var o=r;r=n.shift()}var s=WT.saw(t,{}),a=t.call(s.handlers,s);a!==void 0&&(s.handlers=a),typeof i.step<"u"&&s.record(),r.apply(s.chain(),n),o!==!1&&s.on("end",i.next)},i.record=function(){Sqt(i)},["trap","down","jump"].forEach(function(r){i[r]=function(){throw new Error("To use the trap, down and jump features, please call record() first to start recording actions.")}}),i};function Sqt(t){t.step=0,t.pop=function(){return t.actions[t.step++]},t.trap=function(e,i){var r=Array.isArray(e)?e:[e];t.actions.push({path:r,step:t.step,cb:i,trap:!0})},t.down=function(e){var i=(Array.isArray(e)?e:[e]).join("/"),r=t.actions.slice(t.step).map(function(o){return o.trap&&o.step<=t.step?!1:o.path.join("/")==i}).indexOf(!0);r>=0?t.step+=r:t.step=t.actions.length;var n=t.actions[t.step-1];n&&n.trap?(t.step=n.step,n.cb()):t.next()},t.jump=function(e){t.step=e,t.next()}}});var S8e=z((Dtr,x8e)=>{"use strict";x8e.exports=Ql;function Ql(t){if(!(this instanceof Ql))return new Ql(t);this.buffers=t||[],this.length=this.buffers.reduce(function(e,i){return e+i.length},0)}Ql.prototype.push=function(){for(var t=0;t<arguments.length;t++)if(!Buffer.isBuffer(arguments[t]))throw new TypeError("Tried to push a non-buffer");for(var t=0;t<arguments.length;t++){var e=arguments[t];this.buffers.push(e),this.length+=e.length}return this.length};Ql.prototype.unshift=function(){for(var t=0;t<arguments.length;t++)if(!Buffer.isBuffer(arguments[t]))throw new TypeError("Tried to unshift a non-buffer");for(var t=0;t<arguments.length;t++){var e=arguments[t];this.buffers.unshift(e),this.length+=e.length}return this.length};Ql.prototype.copy=function(t,e,i,r){return this.slice(i,r).copy(t,e,0,r-i)};Ql.prototype.splice=function(t,e){var i=this.buffers,r=t>=0?t:this.length-t,n=[].slice.call(arguments,2);e===void 0?e=this.length-r:e>this.length-r&&(e=this.length-r);for(var t=0;t<n.length;t++)this.length+=n[t].length;for(var o=new Ql,s=0,a=0,c=0;c<i.length&&a+i[c].length<r;c++)a+=i[c].length;if(r-a>0){var d=r-a;if(d+e<i[c].length){o.push(i[c].slice(d,d+e));for(var u=i[c],h=new Buffer(d),t=0;t<d;t++)h[t]=u[t];for(var p=new Buffer(u.length-d-e),t=d+e;t<u.length;t++)p[t-e-d]=u[t];if(n.length>0){var f=n.slice();f.unshift(h),f.push(p),i.splice.apply(i,[c,1].concat(f)),c+=f.length,n=[]}else i.splice(c,1,h,p),c+=2}else o.push(i[c].slice(d)),i[c]=i[c].slice(0,d),c++}for(n.length>0&&(i.splice.apply(i,[c,0].concat(n)),c+=n.length);o.length<e;){var m=i[c],g=m.length,y=Math.min(g,e-o.length);y===g?(o.push(m),i.splice(c,1)):(o.push(m.slice(0,y)),i[c]=i[c].slice(y))}return this.length-=o.length,o};Ql.prototype.slice=function(t,e){var i=this.buffers;e===void 0&&(e=this.length),t===void 0&&(t=0),e>this.length&&(e=this.length);for(var r=0,n=0;n<i.length&&r+i[n].length<=t;n++)r+=i[n].length;for(var o=new Buffer(e-t),s=0,a=n;s<e-t&&a<i.length;a++){var c=i[a].length,d=s===0?t-r:0,u=s+c>=e-t?Math.min(d+(e-t)-s,c):c;i[a].copy(o,s,d,u),s+=u-d}return o};Ql.prototype.pos=function(t){if(t<0||t>=this.length)throw new Error("oob");for(var e=t,i=0,r=null;;){if(r=this.buffers[i],e<r.length)return{buf:i,offset:e};e-=r.length,i++}};Ql.prototype.get=function(e){var i=this.pos(e);return this.buffers[i.buf].get(i.offset)};Ql.prototype.set=function(e,i){var r=this.pos(e);return this.buffers[r.buf].set(r.offset,i)};Ql.prototype.indexOf=function(t,e){if(typeof t=="string")t=new Buffer(t);else if(!(t instanceof Buffer))throw new Error("Invalid type for a search string");if(!t.length)return 0;if(!this.length)return-1;var i=0,r=0,n=0,o,s=0;if(e){var a=this.pos(e);i=a.buf,r=a.offset,s=e}for(;;){for(;r>=this.buffers[i].length;)if(r=0,i++,i>=this.buffers.length)return-1;var c=this.buffers[i][r];if(c==t[n]){if(n==0&&(o={i,j:r,pos:s}),n++,n==t.length)return o.pos}else n!=0&&(i=o.i,r=o.j,s=o.pos,n=0);r++,s++}};Ql.prototype.toBuffer=function(){return this.slice()};Ql.prototype.toString=function(t,e,i){return this.slice(e,i).toString(t)}});var T8e=z((Mtr,E8e)=>{"use strict";E8e.exports=function(t){function e(r,n){var o=i.store,s=r.split(".");s.slice(0,-1).forEach(function(c){o[c]===void 0&&(o[c]={}),o=o[c]});var a=s[s.length-1];return arguments.length==1?o[a]:o[a]=n}var i={get:function(r){return e(r)},set:function(r,n){return e(r,n)},store:t||{}};return i}});var ZN=z((Qw,M8e)=>{"use strict";var Eqt=C8e(),R8e=Ze("events").EventEmitter,Tqt=S8e(),O8=T8e(),Rqt=Ze("stream").Stream;Qw=M8e.exports=function(t,e){if(Buffer.isBuffer(t))return Qw.parse(t);var i=Qw.stream();return t&&t.pipe?t.pipe(i):t&&(t.on(e||"data",function(r){i.write(r)}),t.on("end",function(){i.end()})),i};Qw.stream=function(t){if(t)return Qw.apply(null,arguments);var e=null;function i(h,p,f){e={bytes:h,skip:f,cb:function(m){e=null,p(m)}},n()}var r=null;function n(){if(!e){u&&(d=!0);return}if(typeof e=="function")e();else{var h=r+e.bytes;if(a.length>=h){var p;r==null?(p=a.splice(0,h),e.skip||(p=p.slice())):(e.skip||(p=a.slice(r,h)),r=h),e.skip?e.cb():e.cb(p)}}}function o(h){function p(){d||h.next()}var f=D8e(function(m,g){return function(y){i(m,function(w){c.set(y,g(w)),p()})}});return f.tap=function(m){h.nest(m,c.store)},f.into=function(m,g){c.get(m)||c.set(m,{});var y=c;c=O8(y.get(m)),h.nest(function(){g.apply(this,arguments),this.tap(function(){c=y})},c.store)},f.flush=function(){c.store={},p()},f.loop=function(m){var g=!1;h.nest(!1,function y(){this.vars=c.store,m.call(this,function(){g=!0,p()},c.store),this.tap((function(){g?h.next():y.call(this)}).bind(this))},c.store)},f.buffer=function(m,g){typeof g=="string"&&(g=c.get(g)),i(g,function(y){c.set(m,y),p()})},f.skip=function(m){typeof m=="string"&&(m=c.get(m)),i(m,function(){p()})},f.scan=function(g,y){if(typeof y=="string")y=new Buffer(y);else if(!Buffer.isBuffer(y))throw new Error("search must be a Buffer or a string");var w=0;e=function(){var x=a.indexOf(y,r+w),T=x-r-w;x!==-1?(e=null,r!=null?(c.set(g,a.slice(r,r+w+T)),r+=w+T+y.length):(c.set(g,a.slice(0,w+T)),a.splice(0,w+T+y.length)),p(),n()):T=Math.max(a.length-y.length-r-w,0),w+=T},n()},f.peek=function(m){r=0,h.nest(function(){m.call(this,c.store),this.tap(function(){r=null})})},f}var s=Eqt.light(o);s.writable=!0;var a=Tqt();s.write=function(h){a.push(h),n()};var c=O8(),d=!1,u=!1;return s.end=function(){u=!0},s.pipe=Rqt.prototype.pipe,Object.getOwnPropertyNames(R8e.prototype).forEach(function(h){s[h]=R8e.prototype[h]}),s};Qw.parse=function(e){var i=D8e(function(o,s){return function(a){if(r+o<=e.length){var c=e.slice(r,r+o);r+=o,n.set(a,s(c))}else n.set(a,null);return i}}),r=0,n=O8();return i.vars=n.store,i.tap=function(o){return o.call(i,n.store),i},i.into=function(o,s){n.get(o)||n.set(o,{});var a=n;return n=O8(a.get(o)),s.call(i,n.store),n=a,i},i.loop=function(o){for(var s=!1,a=function(){s=!0};s===!1;)o.call(i,a,n.store);return i},i.buffer=function(o,s){typeof s=="string"&&(s=n.get(s));var a=e.slice(r,Math.min(e.length,r+s));return r+=s,n.set(o,a),i},i.skip=function(o){return typeof o=="string"&&(o=n.get(o)),r+=o,i},i.scan=function(o,s){if(typeof s=="string")s=new Buffer(s);else if(!Buffer.isBuffer(s))throw new Error("search must be a Buffer or a string");n.set(o,null);for(var a=0;a+r<=e.length-s.length+1;a++){for(var c=0;c<s.length&&e[r+a+c]===s[c];c++);if(c===s.length)break}return n.set(o,e.slice(r,r+a)),r+=a+s.length,i},i.peek=function(o){var s=r;return o.call(i,n.store),r=s,i},i.flush=function(){return n.store={},i},i.eof=function(){return r>=e.length},i};function A8e(t){for(var e=0,i=0;i<t.length;i++)e+=Math.pow(256,i)*t[i];return e}function I8e(t){for(var e=0,i=0;i<t.length;i++)e+=Math.pow(256,t.length-i-1)*t[i];return e}function Aqt(t){var e=I8e(t);return(t[0]&128)==128&&(e-=Math.pow(256,t.length)),e}function Iqt(t){var e=A8e(t);return(t[t.length-1]&128)==128&&(e-=Math.pow(256,t.length)),e}function D8e(t){var e={};return[1,2,4,8].forEach(function(i){var r=i*8;e["word"+r+"le"]=e["word"+r+"lu"]=t(i,A8e),e["word"+r+"ls"]=t(i,Iqt),e["word"+r+"be"]=e["word"+r+"bu"]=t(i,I8e),e["word"+r+"bs"]=t(i,Aqt)}),e.word8=e.word8u=e.word8be,e.word8s=e.word8bs,e}});var Jw=z((ktr,Dae)=>{"use strict";var Aae=function(){"use strict";return this===void 0}();Aae?Dae.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:Aae,propertyIsWritable:function(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return!!(!i||i.writable||i.set)}}:(k8e={}.hasOwnProperty,O8e={}.toString,N8e={}.constructor.prototype,Iae=function(t){var e=[];for(var i in t)k8e.call(t,i)&&e.push(i);return e},P8e=function(t,e){return{value:t[e]}},L8e=function(t,e,i){return t[e]=i.value,t},F8e=function(t){return t},H8e=function(t){try{return Object(t).constructor.prototype}catch{return N8e}},B8e=function(t){try{return O8e.call(t)==="[object Array]"}catch{return!1}},Dae.exports={isArray:B8e,keys:Iae,names:Iae,defineProperty:L8e,getDescriptor:P8e,freeze:F8e,getPrototypeOf:H8e,isES5:Aae,propertyIsWritable:function(){return!0}});var k8e,O8e,N8e,Iae,P8e,L8e,F8e,H8e,B8e});var Fn=z((exports,module)=>{"use strict";var es5=Jw(),canEvaluate=typeof navigator>"u",errorObj={e:{}},tryCatchTarget,globalObject=typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:exports!==void 0?exports:null;function tryCatcher(){try{var t=tryCatchTarget;return tryCatchTarget=null,t.apply(this,arguments)}catch(e){return errorObj.e=e,errorObj}}function tryCatch(t){return tryCatchTarget=t,tryCatcher}var inherits=function(t,e){var i={}.hasOwnProperty;function r(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)i.call(e.prototype,n)&&n.charAt(n.length-1)!=="$"&&(this[n+"$"]=e.prototype[n])}return r.prototype=e.prototype,t.prototype=new r,t.prototype};function isPrimitive(t){return t==null||t===!0||t===!1||typeof t=="string"||typeof t=="number"}function isObject(t){return typeof t=="function"||typeof t=="object"&&t!==null}function maybeWrapAsError(t){return isPrimitive(t)?new Error(safeToString(t)):t}function withAppended(t,e){var i=t.length,r=new Array(i+1),n;for(n=0;n<i;++n)r[n]=t[n];return r[n]=e,r}function getDataPropertyOrDefault(t,e,i){if(es5.isES5){var r=Object.getOwnPropertyDescriptor(t,e);if(r!=null)return r.get==null&&r.set==null?r.value:i}else return{}.hasOwnProperty.call(t,e)?t[e]:void 0}function notEnumerableProp(t,e,i){if(isPrimitive(t))return t;var r={value:i,configurable:!0,enumerable:!1,writable:!0};return es5.defineProperty(t,e,r),t}function thrower(t){throw t}var inheritedDataKeys=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(n){for(var o=0;o<t.length;++o)if(t[o]===n)return!0;return!1};if(es5.isES5){var i=Object.getOwnPropertyNames;return function(n){for(var o=[],s=Object.create(null);n!=null&&!e(n);){var a;try{a=i(n)}catch{return o}for(var c=0;c<a.length;++c){var d=a[c];if(!s[d]){s[d]=!0;var u=Object.getOwnPropertyDescriptor(n,d);u!=null&&u.get==null&&u.set==null&&o.push(d)}}n=es5.getPrototypeOf(n)}return o}}else{var r={}.hasOwnProperty;return function(n){if(e(n))return[];var o=[];e:for(var s in n)if(r.call(n,s))o.push(s);else{for(var a=0;a<t.length;++a)if(r.call(t[a],s))continue e;o.push(s)}return o}}}(),thisAssignmentPattern=/this\s*\.\s*\S+\s*=/;function isClass(t){try{if(typeof t=="function"){var e=es5.names(t.prototype),i=es5.isES5&&e.length>1,r=e.length>0&&!(e.length===1&&e[0]==="constructor"),n=thisAssignmentPattern.test(t+"")&&es5.names(t).length>0;if(i||r||n)return!0}return!1}catch{return!1}}function toFastProperties(obj){function FakeConstructor(){}FakeConstructor.prototype=obj;for(var l=8;l--;)new FakeConstructor;return obj}var rident=/^[a-z$_][a-z$_0-9]*$/i;function isIdentifier(t){return rident.test(t)}function filledRange(t,e,i){for(var r=new Array(t),n=0;n<t;++n)r[n]=e+n+i;return r}function safeToString(t){try{return t+""}catch{return"[no string representation]"}}function isError(t){return t!==null&&typeof t=="object"&&typeof t.message=="string"&&typeof t.name=="string"}function markAsOriginatingFromRejection(t){try{notEnumerableProp(t,"isOperational",!0)}catch{}}function originatesFromRejection(t){return t==null?!1:t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0}function canAttachTrace(t){return isError(t)&&es5.propertyIsWritable(t,"stack")}var ensureErrorObject=function(){return"stack"in new Error?function(t){return canAttachTrace(t)?t:new Error(safeToString(t))}:function(t){if(canAttachTrace(t))return t;try{throw new Error(safeToString(t))}catch(e){return e}}}();function classString(t){return{}.toString.call(t)}function copyDescriptors(t,e,i){for(var r=es5.names(t),n=0;n<r.length;++n){var o=r[n];if(i(o))try{es5.defineProperty(e,o,es5.getDescriptor(t,o))}catch{}}}var asArray=function(t){return es5.isArray(t)?t:null};typeof Symbol<"u"&&Symbol.iterator&&(ArrayFrom=typeof Array.from=="function"?function(t){return Array.from(t)}:function(t){for(var e=[],i=t[Symbol.iterator](),r;!(r=i.next()).done;)e.push(r.value);return e},asArray=function(t){return es5.isArray(t)?t:t!=null&&typeof t[Symbol.iterator]=="function"?ArrayFrom(t):null});var ArrayFrom,isNode=typeof process<"u"&&classString(process).toLowerCase()==="[object process]",hasEnvVariables=typeof process<"u"&&typeof process.env<"u";function env(t){return hasEnvVariables?process.env[t]:void 0}function getNativePromise(){if(typeof Promise=="function")try{var t=new Promise(function(){});if({}.toString.call(t)==="[object Promise]")return Promise}catch{}}function domainBind(t,e){return t.bind(e)}var ret={isClass,isIdentifier,inheritedDataKeys,getDataPropertyOrDefault,thrower,isArray:es5.isArray,asArray,notEnumerableProp,isPrimitive,isObject,isError,canEvaluate,errorObj,tryCatch,inherits,withAppended,maybeWrapAsError,toFastProperties,filledRange,toString:safeToString,canAttachTrace,ensureErrorObject,originatesFromRejection,markAsOriginatingFromRejection,classString,copyDescriptors,hasDevTools:typeof chrome<"u"&&chrome&&typeof chrome.loadTimes=="function",isNode,hasEnvVariables,env,global:globalObject,getNativePromise,domainBind};ret.isRecentNode=ret.isNode&&function(){var t=process.versions.node.split(".").map(Number);return t[0]===0&&t[1]>10||t[0]>0}();ret.isNode&&ret.toFastProperties(process);try{throw new Error}catch(t){ret.lastLineError=t}module.exports=ret});var U8e=z((Otr,W8e)=>{"use strict";var kae=Fn(),eC,Dqt=function(){throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)},Mae=kae.getNativePromise();kae.isNode&&typeof MutationObserver>"u"?(V8e=global.setImmediate,j8e=process.nextTick,eC=kae.isRecentNode?function(t){V8e.call(global,t)}:function(t){j8e.call(process,t)}):typeof Mae=="function"&&typeof Mae.resolve=="function"?(z8e=Mae.resolve(),eC=function(t){z8e.then(t)}):typeof MutationObserver<"u"&&!(typeof window<"u"&&window.navigator&&(window.navigator.standalone||window.cordova))?eC=function(){var t=document.createElement("div"),e={attributes:!0},i=!1,r=document.createElement("div"),n=new MutationObserver(function(){t.classList.toggle("foo"),i=!1});n.observe(r,e);var o=function(){i||(i=!0,r.classList.toggle("foo"))};return function(a){var c=new MutationObserver(function(){c.disconnect(),a()});c.observe(t,e),o()}}():typeof setImmediate<"u"?eC=function(t){setImmediate(t)}:typeof setTimeout<"u"?eC=function(t){setTimeout(t,0)}:eC=Dqt;var V8e,j8e,z8e;W8e.exports=eC});var Y8e=z((Ntr,q8e)=>{"use strict";function Mqt(t,e,i,r,n){for(var o=0;o<n;++o)i[o+r]=t[o+e],t[o+e]=void 0}function O0(t){this._capacity=t,this._length=0,this._front=0}O0.prototype._willBeOverCapacity=function(t){return this._capacity<t};O0.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var i=this._front+e&this._capacity-1;this[i]=t,this._length=e+1};O0.prototype.push=function(t,e,i){var r=this.length()+3;if(this._willBeOverCapacity(r)){this._pushOne(t),this._pushOne(e),this._pushOne(i);return}var n=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[n+0&o]=t,this[n+1&o]=e,this[n+2&o]=i,this._length=r};O0.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e};O0.prototype.length=function(){return this._length};O0.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)};O0.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var i=this._front,r=this._length,n=i+r&e-1;Mqt(this,0,this,e,n)};q8e.exports=O0});var J8e=z((Ptr,Oae)=>{"use strict";var Z8e;try{throw new Error}catch(t){Z8e=t}var kqt=U8e(),$8e=Y8e(),Q8e=Fn();function ma(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new $8e(16),this._normalQueue=new $8e(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=kqt}ma.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e};ma.prototype.hasCustomScheduler=function(){return this._customScheduler};ma.prototype.enableTrampoline=function(){this._trampolineEnabled=!0};ma.prototype.disableTrampolineIfNecessary=function(){Q8e.hasDevTools&&(this._trampolineEnabled=!1)};ma.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues};ma.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+`
`),process.exit(2)):this.throwLater(t)};ma.prototype.throwLater=function(t,e){if(arguments.length===1&&(e=t,t=function(){throw e}),typeof setTimeout<"u")setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch{throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)}};function G8e(t,e,i){this._lateQueue.push(t,e,i),this._queueTick()}function X8e(t,e,i){this._normalQueue.push(t,e,i),this._queueTick()}function K8e(t){this._normalQueue._pushOne(t),this._queueTick()}Q8e.hasDevTools?(ma.prototype.invokeLater=function(t,e,i){this._trampolineEnabled?G8e.call(this,t,e,i):this._schedule(function(){setTimeout(function(){t.call(e,i)},100)})},ma.prototype.invoke=function(t,e,i){this._trampolineEnabled?X8e.call(this,t,e,i):this._schedule(function(){t.call(e,i)})},ma.prototype.settlePromises=function(t){this._trampolineEnabled?K8e.call(this,t):this._schedule(function(){t._settlePromises()})}):(ma.prototype.invokeLater=G8e,ma.prototype.invoke=X8e,ma.prototype.settlePromises=K8e);ma.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if(typeof e!="function"){e._settlePromises();continue}var i=t.shift(),r=t.shift();e.call(i,r)}};ma.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)};ma.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))};ma.prototype._reset=function(){this._isTickUsed=!1};Oae.exports=ma;Oae.exports.firstLineError=Z8e});var vg=z((Ltr,ize)=>{"use strict";var Lae=Jw(),Oqt=Lae.freeze,eze=Fn(),tze=eze.inherits,qT=eze.notEnumerableProp;function YT(t,e){function i(r){if(!(this instanceof i))return new i(r);qT(this,"message",typeof r=="string"?r:e),qT(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return tze(i,Error),i}var Nae,Pae,Nqt=YT("Warning","warning"),Pqt=YT("CancellationError","cancellation error"),Lqt=YT("TimeoutError","timeout error"),JN=YT("AggregateError","aggregate error");try{Nae=TypeError,Pae=RangeError}catch{Nae=YT("TypeError","type error"),Pae=YT("RangeError","range error")}var N8="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" ");for(UT=0;UT<N8.length;++UT)typeof Array.prototype[N8[UT]]=="function"&&(JN.prototype[N8[UT]]=Array.prototype[N8[UT]]);var UT;Lae.defineProperty(JN.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0});JN.prototype.isOperational=!0;var P8=0;JN.prototype.toString=function(){var t=Array(P8*4+1).join(" "),e=`
`+t+`AggregateError of:
`;P8++,t=Array(P8*4+1).join(" ");for(var i=0;i<this.length;++i){for(var r=this[i]===this?"[Circular AggregateError]":this[i]+"",n=r.split(`
`),o=0;o<n.length;++o)n[o]=t+n[o];r=n.join(`
`),e+=r+`
`}return P8--,e};function QN(t){if(!(this instanceof QN))return new QN(t);qT(this,"name","OperationalError"),qT(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(qT(this,"message",t.message),qT(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}tze(QN,Error);var tC=Error.__BluebirdErrorTypes__;tC||(tC=Oqt({CancellationError:Pqt,TimeoutError:Lqt,OperationalError:QN,RejectionError:QN,AggregateError:JN}),Lae.defineProperty(Error,"__BluebirdErrorTypes__",{value:tC,writable:!1,enumerable:!1,configurable:!1}));ize.exports={Error,TypeError:Nae,RangeError:Pae,CancellationError:tC.CancellationError,OperationalError:tC.OperationalError,TimeoutError:tC.TimeoutError,AggregateError:tC.AggregateError,Warning:Nqt}});var nze=z((Ftr,rze)=>{"use strict";rze.exports=function(t,e){var i=Fn(),r=i.errorObj,n=i.isObject;function o(h,p){if(n(h)){if(h instanceof t)return h;var f=a(h);if(f===r){p&&p._pushContext();var m=t.reject(f.e);return p&&p._popContext(),m}else if(typeof f=="function"){if(d(h)){var m=new t(e);return h._then(m._fulfill,m._reject,void 0,m,null),m}return u(h,f,p)}}return h}function s(h){return h.then}function a(h){try{return s(h)}catch(p){return r.e=p,r}}var c={}.hasOwnProperty;function d(h){try{return c.call(h,"_promise0")}catch{return!1}}function u(h,p,f){var m=new t(e),g=m;f&&f._pushContext(),m._captureStackTrace(),f&&f._popContext();var y=!0,w=i.tryCatch(p).call(h,x,T);y=!1,m&&w===r&&(m._rejectCallback(w.e,!0,!0),m=null);function x(M){m&&(m._resolveCallback(M),m=null)}function T(M){m&&(m._rejectCallback(M,y,!0),m=null)}return g}return o}});var sze=z((Htr,oze)=>{"use strict";oze.exports=function(t,e,i,r,n){var o=Fn(),s=o.isArray;function a(d){switch(d){case-2:return[];case-3:return{}}}function c(d){var u=this._promise=new t(e);d instanceof t&&u._propagateFrom(d,3),u._setOnCancel(this),this._values=d,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return o.inherits(c,n),c.prototype.length=function(){return this._length},c.prototype.promise=function(){return this._promise},c.prototype._init=function d(u,h){var p=i(this._values,this._promise);if(p instanceof t){p=p._target();var f=p._bitField;if(this._values=p,f&50397184)if(f&33554432)p=p._value();else return f&16777216?this._reject(p._reason()):this._cancel();else return this._promise._setAsyncGuaranteed(),p._then(d,this._reject,void 0,this,h)}if(p=o.asArray(p),p===null){var m=r("expecting an array or an iterable object but got "+o.classString(p)).reason();this._promise._rejectCallback(m,!1);return}if(p.length===0){h===-5?this._resolveEmptyArray():this._resolve(a(h));return}this._iterate(p)},c.prototype._iterate=function(d){var u=this.getActualLength(d.length);this._length=u,this._values=this.shouldCopyValues()?new Array(u):this._values;for(var h=this._promise,p=!1,f=null,m=0;m<u;++m){var g=i(d[m],h);g instanceof t?(g=g._target(),f=g._bitField):f=null,p?f!==null&&g.suppressUnhandledRejections():f!==null?f&50397184?f&33554432?p=this._promiseFulfilled(g._value(),m):f&16777216?p=this._promiseRejected(g._reason(),m):p=this._promiseCancelled(m):(g._proxy(this,m),this._values[m]=g):p=this._promiseFulfilled(g,m)}p||h._setAsyncGuaranteed()},c.prototype._isResolved=function(){return this._values===null},c.prototype._resolve=function(d){this._values=null,this._promise._fulfill(d)},c.prototype._cancel=function(){this._isResolved()||!this._promise._isCancellable()||(this._values=null,this._promise._cancel())},c.prototype._reject=function(d){this._values=null,this._promise._rejectCallback(d,!1)},c.prototype._promiseFulfilled=function(d,u){this._values[u]=d;var h=++this._totalResolved;return h>=this._length?(this._resolve(this._values),!0):!1},c.prototype._promiseCancelled=function(){return this._cancel(),!0},c.prototype._promiseRejected=function(d){return this._totalResolved++,this._reject(d),!0},c.prototype._resultCancelled=function(){if(!this._isResolved()){var d=this._values;if(this._cancel(),d instanceof t)d.cancel();else for(var u=0;u<d.length;++u)d[u]instanceof t&&d[u].cancel()}},c.prototype.shouldCopyValues=function(){return!0},c.prototype.getActualLength=function(d){return d},c}});var lze=z((Btr,aze)=>{"use strict";aze.exports=function(t){var e=!1,i=[];t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){};function r(){this._trace=new r.CapturedTrace(o())}r.prototype._pushContext=function(){this._trace!==void 0&&(this._trace._promiseCreated=null,i.push(this._trace))},r.prototype._popContext=function(){if(this._trace!==void 0){var s=i.pop(),a=s._promiseCreated;return s._promiseCreated=null,a}return null};function n(){if(e)return new r}function o(){var s=i.length-1;if(s>=0)return i[s]}return r.CapturedTrace=null,r.create=n,r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var s=t.prototype._pushContext,a=t.prototype._popContext,c=t._peekContext,d=t.prototype._peekContext,u=t.prototype._promiseCreated;r.deactivateLongStackTraces=function(){t.prototype._pushContext=s,t.prototype._popContext=a,t._peekContext=c,t.prototype._peekContext=d,t.prototype._promiseCreated=u,e=!1},e=!0,t.prototype._pushContext=r.prototype._pushContext,t.prototype._popContext=r.prototype._popContext,t._peekContext=t.prototype._peekContext=o,t.prototype._promiseCreated=function(){var h=this._peekContext();h&&h._promiseCreated==null&&(h._promiseCreated=this)}},r}});var dze=z((Vtr,cze)=>{"use strict";cze.exports=function(t,e){var i=t._getDomain,r=t._async,n=vg().Warning,o=Fn(),s=o.canAttachTrace,a,c,d=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,u=/\((?:timers\.js):\d+:\d+\)/,h=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,p=null,f=null,m=!1,g,y=!!(o.env("BLUEBIRD_DEBUG")!=0&&(o.env("BLUEBIRD_DEBUG")||o.env("NODE_ENV")==="development")),w=!!(o.env("BLUEBIRD_WARNINGS")!=0&&(y||o.env("BLUEBIRD_WARNINGS"))),x=!!(o.env("BLUEBIRD_LONG_STACK_TRACES")!=0&&(y||o.env("BLUEBIRD_LONG_STACK_TRACES"))),T=o.env("BLUEBIRD_W_FORGOTTEN_RETURN")!=0&&(w||!!o.env("BLUEBIRD_W_FORGOTTEN_RETURN"));t.prototype.suppressUnhandledRejections=function(){var ue=this._target();ue._bitField=ue._bitField&-1048577|524288},t.prototype._ensurePossibleRejectionHandled=function(){this._bitField&524288||(this._setRejectionIsUnhandled(),r.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){Ne("rejectionHandled",a,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=this._bitField|268435456},t.prototype._returnedNonUndefined=function(){return(this._bitField&268435456)!==0},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var ue=this._settledValue();this._setUnhandledRejectionIsNotified(),Ne("unhandledRejection",c,ue,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|262144},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},t.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&262144)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|1048576},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(this._bitField&1048576)>0},t.prototype._warn=function(ue,A,L){return X(ue,A,L||this)},t.onPossiblyUnhandledRejection=function(ue){var A=i();c=typeof ue=="function"?A===null?ue:o.domainBind(A,ue):void 0},t.onUnhandledRejectionHandled=function(ue){var A=i();a=typeof ue=="function"?A===null?ue:o.domainBind(A,ue):void 0};var M=function(){};t.longStackTraces=function(){if(r.haveItemsQueued()&&!pe.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);if(!pe.longStackTraces&&Ue()){var ue=t.prototype._captureStackTrace,A=t.prototype._attachExtraTrace;pe.longStackTraces=!0,M=function(){if(r.haveItemsQueued()&&!pe.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);t.prototype._captureStackTrace=ue,t.prototype._attachExtraTrace=A,e.deactivateLongStackTraces(),r.enableTrampoline(),pe.longStackTraces=!1},t.prototype._captureStackTrace=Ae,t.prototype._attachExtraTrace=k,e.activateLongStackTraces(),r.disableTrampolineIfNecessary()}},t.hasLongStackTraces=function(){return pe.longStackTraces&&Ue()};var B=function(){try{if(typeof CustomEvent=="function"){var ue=new CustomEvent("CustomEvent");return o.global.dispatchEvent(ue),function(A,L){var Y=new CustomEvent(A.toLowerCase(),{detail:L,cancelable:!0});return!o.global.dispatchEvent(Y)}}else if(typeof Event=="function"){var ue=new Event("CustomEvent");return o.global.dispatchEvent(ue),function(L,Y){var Z=new Event(L.toLowerCase(),{cancelable:!0});return Z.detail=Y,!o.global.dispatchEvent(Z)}}else{var ue=document.createEvent("CustomEvent");return ue.initCustomEvent("testingtheevent",!1,!0,{}),o.global.dispatchEvent(ue),function(L,Y){var Z=document.createEvent("CustomEvent");return Z.initCustomEvent(L.toLowerCase(),!1,!0,Y),!o.global.dispatchEvent(Z)}}}catch{}return function(){return!1}}(),G=function(){return o.isNode?function(){return process.emit.apply(process,arguments)}:o.global?function(ue){var A="on"+ue.toLowerCase(),L=o.global[A];return L?(L.apply(o.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}();function F(ue,A){return{promise:A}}var O={promiseCreated:F,promiseFulfilled:F,promiseRejected:F,promiseResolved:F,promiseCancelled:F,promiseChained:function(ue,A,L){return{promise:A,child:L}},warning:function(ue,A){return{warning:A}},unhandledRejection:function(ue,A,L){return{reason:A,promise:L}},rejectionHandled:F},V=function(ue){var A=!1;try{A=G.apply(null,arguments)}catch(Y){r.throwLater(Y),A=!0}var L=!1;try{L=B(ue,O[ue].apply(null,arguments))}catch(Y){r.throwLater(Y),L=!0}return L||A};t.config=function(ue){if(ue=Object(ue),"longStackTraces"in ue&&(ue.longStackTraces?t.longStackTraces():!ue.longStackTraces&&t.hasLongStackTraces()&&M()),"warnings"in ue){var A=ue.warnings;pe.warnings=!!A,T=pe.warnings,o.isObject(A)&&"wForgottenReturn"in A&&(T=!!A.wForgottenReturn)}if("cancellation"in ue&&ue.cancellation&&!pe.cancellation){if(r.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=ve,t.prototype._propagateFrom=W,t.prototype._onCancel=$,t.prototype._setOnCancel=K,t.prototype._attachCancellationCallback=P,t.prototype._execute=N,te=W,pe.cancellation=!0}return"monitoring"in ue&&(ue.monitoring&&!pe.monitoring?(pe.monitoring=!0,t.prototype._fireEvent=V):!ue.monitoring&&pe.monitoring&&(pe.monitoring=!1,t.prototype._fireEvent=J)),t};function J(){return!1}t.prototype._fireEvent=J,t.prototype._execute=function(ue,A,L){try{ue(A,L)}catch(Y){return Y}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(ue){},t.prototype._attachCancellationCallback=function(ue){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(ue,A){};function N(ue,A,L){var Y=this;try{ue(A,L,function(Z){if(typeof Z!="function")throw new TypeError("onCancel must be a function, got: "+o.toString(Z));Y._attachCancellationCallback(Z)})}catch(Z){return Z}}function P(ue){if(!this._isCancellable())return this;var A=this._onCancel();A!==void 0?o.isArray(A)?A.push(ue):this._setOnCancel([A,ue]):this._setOnCancel(ue)}function $(){return this._onCancelField}function K(ue){this._onCancelField=ue}function ve(){this._cancellationParent=void 0,this._onCancelField=void 0}function W(ue,A){if(A&1){this._cancellationParent=ue;var L=ue._branchesRemainingToCancel;L===void 0&&(L=0),ue._branchesRemainingToCancel=L+1}A&2&&ue._isBound()&&this._setBoundTo(ue._boundTo)}function ee(ue,A){A&2&&ue._isBound()&&this._setBoundTo(ue._boundTo)}var te=ee;function se(){var ue=this._boundTo;return ue!==void 0&&ue instanceof t?ue.isFulfilled()?ue.value():void 0:ue}function Ae(){this._trace=new ye(this._peekContext())}function k(ue,A){if(s(ue)){var L=this._trace;if(L!==void 0&&A&&(L=L._parent),L!==void 0)L.attachExtraTrace(ue);else if(!ue.__stackCleaned__){var Y=We(ue);o.notEnumerableProp(ue,"stack",Y.message+`
`+Y.stack.join(`
`)),o.notEnumerableProp(ue,"__stackCleaned__",!0)}}}function S(ue,A,L,Y,Z){if(ue===void 0&&A!==null&&T){if(Z!==void 0&&Z._returnedNonUndefined()||!(Y._bitField&65535))return;L&&(L=L+" ");var fe="",we="";if(A._trace){for(var ke=A._trace.stack.split(`
`),Ie=Re(ke),ze=Ie.length-1;ze>=0;--ze){var rt=Ie[ze];if(!u.test(rt)){var yt=rt.match(h);yt&&(fe="at "+yt[1]+":"+yt[2]+":"+yt[3]+" ");break}}if(Ie.length>0){for(var st=Ie[0],ze=0;ze<ke.length;++ze)if(ke[ze]===st){ze>0&&(we=`
`+ke[ze-1]);break}}}var vt="a promise was created in a "+L+"handler "+fe+"but was not returned from it, see http://goo.gl/rRqMUw"+we;Y._warn(vt,!0,A)}}function I(ue,A){var L=ue+" is deprecated and will be removed in a future version.";return A&&(L+=" Use "+A+" instead."),X(L)}function X(ue,A,L){if(pe.warnings){var Y=new n(ue),Z;if(A)L._attachExtraTrace(Y);else if(pe.longStackTraces&&(Z=t._peekContext()))Z.attachExtraTrace(Y);else{var fe=We(Y);Y.stack=fe.message+`
`+fe.stack.join(`
`)}V("warning",Y)||Le(Y,"",!0)}}function Q(ue,A){for(var L=0;L<A.length-1;++L)A[L].push("From previous event:"),A[L]=A[L].join(`
`);return L<A.length&&(A[L]=A[L].join(`
`)),ue+`
`+A.join(`
`)}function le(ue){for(var A=0;A<ue.length;++A)(ue[A].length===0||A+1<ue.length&&ue[A][0]===ue[A+1][0])&&(ue.splice(A,1),A--)}function xe(ue){for(var A=ue[0],L=1;L<ue.length;++L){for(var Y=ue[L],Z=A.length-1,fe=A[Z],we=-1,ke=Y.length-1;ke>=0;--ke)if(Y[ke]===fe){we=ke;break}for(var ke=we;ke>=0;--ke){var Ie=Y[ke];if(A[Z]===Ie)A.pop(),Z--;else break}A=Y}}function Re(ue){for(var A=[],L=0;L<ue.length;++L){var Y=ue[L],Z=Y==="    (No stack trace)"||p.test(Y),fe=Z&&Se(Y);Z&&!fe&&(m&&Y.charAt(0)!==" "&&(Y="    "+Y),A.push(Y))}return A}function Oe(ue){for(var A=ue.stack.replace(/\s+$/g,"").split(`
`),L=0;L<A.length;++L){var Y=A[L];if(Y==="    (No stack trace)"||p.test(Y))break}return L>0&&ue.name!="SyntaxError"&&(A=A.slice(L)),A}function We(ue){var A=ue.stack,L=ue.toString();return A=typeof A=="string"&&A.length>0?Oe(ue):["    (No stack trace)"],{message:L,stack:ue.name=="SyntaxError"?A:Re(A)}}function Le(ue,A,L){if(typeof console<"u"){var Y;if(o.isObject(ue)){var Z=ue.stack;Y=A+f(Z,ue)}else Y=A+String(ue);typeof g=="function"?g(Y,L):(typeof console.log=="function"||typeof console.log=="object")&&console.log(Y)}}function Ne(ue,A,L,Y){var Z=!1;try{typeof A=="function"&&(Z=!0,ue==="rejectionHandled"?A(Y):A(L,Y))}catch(fe){r.throwLater(fe)}ue==="unhandledRejection"?!V(ue,L,Y)&&!Z&&Le(L,"Unhandled rejection "):V(ue,Y)}function it(ue){var A;if(typeof ue=="function")A="[function "+(ue.name||"anonymous")+"]";else{A=ue&&typeof ue.toString=="function"?ue.toString():o.toString(ue);var L=/\[object [a-zA-Z0-9$_]+\]/;if(L.test(A))try{var Y=JSON.stringify(ue);A=Y}catch{}A.length===0&&(A="(empty array)")}return"(<"+ct(A)+">, no stack trace)"}function ct(ue){var A=41;return ue.length<A?ue:ue.substr(0,A-3)+"..."}function Ue(){return typeof Me=="function"}var Se=function(){return!1},gt=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function ce(ue){var A=ue.match(gt);if(A)return{fileName:A[1],line:parseInt(A[2],10)}}function de(ue,A){if(Ue()){for(var L=ue.stack.split(`
`),Y=A.stack.split(`
`),Z=-1,fe=-1,we,ke,Ie=0;Ie<L.length;++Ie){var ze=ce(L[Ie]);if(ze){we=ze.fileName,Z=ze.line;break}}for(var Ie=0;Ie<Y.length;++Ie){var ze=ce(Y[Ie]);if(ze){ke=ze.fileName,fe=ze.line;break}}Z<0||fe<0||!we||!ke||we!==ke||Z>=fe||(Se=function(rt){if(d.test(rt))return!0;var yt=ce(rt);return!!(yt&&yt.fileName===we&&Z<=yt.line&&yt.line<=fe)})}}function ye(ue){this._parent=ue,this._promisesCreated=0;var A=this._length=1+(ue===void 0?0:ue._length);Me(this,ye),A>32&&this.uncycle()}o.inherits(ye,Error),e.CapturedTrace=ye,ye.prototype.uncycle=function(){var ue=this._length;if(!(ue<2)){for(var A=[],L={},Y=0,Z=this;Z!==void 0;++Y)A.push(Z),Z=Z._parent;ue=this._length=Y;for(var Y=ue-1;Y>=0;--Y){var fe=A[Y].stack;L[fe]===void 0&&(L[fe]=Y)}for(var Y=0;Y<ue;++Y){var we=A[Y].stack,ke=L[we];if(ke!==void 0&&ke!==Y){ke>0&&(A[ke-1]._parent=void 0,A[ke-1]._length=1),A[Y]._parent=void 0,A[Y]._length=1;var Ie=Y>0?A[Y-1]:this;ke<ue-1?(Ie._parent=A[ke+1],Ie._parent.uncycle(),Ie._length=Ie._parent._length+1):(Ie._parent=void 0,Ie._length=1);for(var ze=Ie._length+1,rt=Y-2;rt>=0;--rt)A[rt]._length=ze,ze++;return}}}},ye.prototype.attachExtraTrace=function(ue){if(!ue.__stackCleaned__){this.uncycle();for(var A=We(ue),L=A.message,Y=[A.stack],Z=this;Z!==void 0;)Y.push(Re(Z.stack.split(`
`))),Z=Z._parent;xe(Y),le(Y),o.notEnumerableProp(ue,"stack",Q(L,Y)),o.notEnumerableProp(ue,"__stackCleaned__",!0)}};var Me=function(){var A=/^\s*at\s*/,L=function(we,ke){return typeof we=="string"?we:ke.name!==void 0&&ke.message!==void 0?ke.toString():it(ke)};if(typeof Error.stackTraceLimit=="number"&&typeof Error.captureStackTrace=="function"){Error.stackTraceLimit+=6,p=A,f=L;var Y=Error.captureStackTrace;return Se=function(we){return d.test(we)},function(we,ke){Error.stackTraceLimit+=6,Y(we,ke),Error.stackTraceLimit-=6}}var Z=new Error;if(typeof Z.stack=="string"&&Z.stack.split(`
`)[0].indexOf("stackDetection@")>=0)return p=/@/,f=L,m=!0,function(ke){ke.stack=new Error().stack};var fe;try{throw new Error}catch(we){fe="stack"in we}return!("stack"in Z)&&fe&&typeof Error.stackTraceLimit=="number"?(p=A,f=L,function(ke){Error.stackTraceLimit+=6;try{throw new Error}catch(Ie){ke.stack=Ie.stack}Error.stackTraceLimit-=6}):(f=function(we,ke){return typeof we=="string"?we:(typeof ke=="object"||typeof ke=="function")&&ke.name!==void 0&&ke.message!==void 0?ke.toString():it(ke)},null)}([]);typeof console<"u"&&typeof console.warn<"u"&&(g=function(ue){console.warn(ue)},o.isNode&&process.stderr.isTTY?g=function(ue,A){var L=A?"\x1B[33m":"\x1B[31m";console.warn(L+ue+`\x1B[0m
`)}:!o.isNode&&typeof new Error().stack=="string"&&(g=function(ue,A){console.warn("%c"+ue,A?"color: darkorange":"color: red")}));var pe={warnings:w,longStackTraces:!1,cancellation:!1,monitoring:!1};return x&&t.longStackTraces(),{longStackTraces:function(){return pe.longStackTraces},warnings:function(){return pe.warnings},cancellation:function(){return pe.cancellation},monitoring:function(){return pe.monitoring},propagateFromFunction:function(){return te},boundValueFunction:function(){return se},checkForgottenReturns:S,setBounds:de,warn:X,deprecated:I,CapturedTrace:ye,fireDomEvent:B,fireGlobalEvent:G}}});var hze=z((jtr,uze)=>{"use strict";uze.exports=function(t,e){var i=Fn(),r=t.CancellationError,n=i.errorObj;function o(h,p,f){this.promise=h,this.type=p,this.handler=f,this.called=!1,this.cancelPromise=null}o.prototype.isFinallyHandler=function(){return this.type===0};function s(h){this.finallyHandler=h}s.prototype._resultCancelled=function(){a(this.finallyHandler)};function a(h,p){return h.cancelPromise!=null?(arguments.length>1?h.cancelPromise._reject(p):h.cancelPromise._cancel(),h.cancelPromise=null,!0):!1}function c(){return u.call(this,this.promise._target()._settledValue())}function d(h){if(!a(this,h))return n.e=h,n}function u(h){var p=this.promise,f=this.handler;if(!this.called){this.called=!0;var m=this.isFinallyHandler()?f.call(p._boundValue()):f.call(p._boundValue(),h);if(m!==void 0){p._setReturnedNonUndefined();var g=e(m,p);if(g instanceof t){if(this.cancelPromise!=null)if(g._isCancelled()){var y=new r("late cancellation observer");return p._attachExtraTrace(y),n.e=y,n}else g.isPending()&&g._attachCancellationCallback(new s(this));return g._then(c,d,void 0,this,void 0)}}}return p.isRejected()?(a(this),n.e=h,n):(a(this),h)}return t.prototype._passThrough=function(h,p,f,m){return typeof h!="function"?this.then():this._then(f,m,void 0,new o(this,p,h),void 0)},t.prototype.lastly=t.prototype.finally=function(h){return this._passThrough(h,0,u,u)},t.prototype.tap=function(h){return this._passThrough(h,1,u)},o}});var pze=z((ztr,fze)=>{"use strict";fze.exports=function(t){var e=Fn(),i=Jw().keys,r=e.tryCatch,n=e.errorObj;function o(s,a,c){return function(d){var u=c._boundValue();e:for(var h=0;h<s.length;++h){var p=s[h];if(p===Error||p!=null&&p.prototype instanceof Error){if(d instanceof p)return r(a).call(u,d)}else if(typeof p=="function"){var f=r(p).call(u,d);if(f===n)return f;if(f)return r(a).call(u,d)}else if(e.isObject(d)){for(var m=i(p),g=0;g<m.length;++g){var y=m[g];if(p[y]!=d[y])continue e}return r(a).call(u,d)}}return t}}return o}});var Fae=z((Wtr,vze)=>{"use strict";var mze=Fn(),Fqt=mze.maybeWrapAsError,Hqt=vg(),Bqt=Hqt.OperationalError,gze=Jw();function Vqt(t){return t instanceof Error&&gze.getPrototypeOf(t)===Error.prototype}var jqt=/^(?:name|message|stack|cause)$/;function zqt(t){var e;if(Vqt(t)){e=new Bqt(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var i=gze.keys(t),r=0;r<i.length;++r){var n=i[r];jqt.test(n)||(e[n]=t[n])}return e}return mze.markAsOriginatingFromRejection(t),t}function Wqt(t,e){return function(i,r){if(t!==null){if(i){var n=zqt(Fqt(i));t._attachExtraTrace(n),t._reject(n)}else if(!e)t._fulfill(r);else{for(var o=arguments.length,s=new Array(Math.max(o-1,0)),a=1;a<o;++a)s[a-1]=arguments[a];t._fulfill(s)}t=null}}}vze.exports=Wqt});var _ze=z((Utr,bze)=>{"use strict";bze.exports=function(t,e,i,r,n){var o=Fn(),s=o.tryCatch;t.method=function(a){if(typeof a!="function")throw new t.TypeError("expecting a function but got "+o.classString(a));return function(){var c=new t(e);c._captureStackTrace(),c._pushContext();var d=s(a).apply(this,arguments),u=c._popContext();return n.checkForgottenReturns(d,u,"Promise.method",c),c._resolveFromSyncValue(d),c}},t.attempt=t.try=function(a){if(typeof a!="function")return r("expecting a function but got "+o.classString(a));var c=new t(e);c._captureStackTrace(),c._pushContext();var d;if(arguments.length>1){n.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],h=arguments[2];d=o.isArray(u)?s(a).apply(h,u):s(a).call(h,u)}else d=s(a)();var p=c._popContext();return n.checkForgottenReturns(d,p,"Promise.try",c),c._resolveFromSyncValue(d),c},t.prototype._resolveFromSyncValue=function(a){a===o.errorObj?this._rejectCallback(a.e,!1):this._resolveCallback(a,!0)}}});var wze=z((qtr,yze)=>{"use strict";yze.exports=function(t,e,i,r){var n=!1,o=function(d,u){this._reject(u)},s=function(d,u){u.promiseRejectionQueued=!0,u.bindingPromise._then(o,o,null,this,d)},a=function(d,u){this._bitField&50397184||this._resolveCallback(u.target)},c=function(d,u){u.promiseRejectionQueued||this._reject(d)};t.prototype.bind=function(d){n||(n=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var u=i(d),h=new t(e);h._propagateFrom(this,1);var p=this._target();if(h._setBoundTo(u),u instanceof t){var f={promiseRejectionQueued:!1,promise:h,target:p,bindingPromise:u};p._then(e,s,void 0,h,f),u._then(a,c,void 0,h,f),h._setOnCancel(u)}else h._resolveCallback(p);return h},t.prototype._setBoundTo=function(d){d!==void 0?(this._bitField=this._bitField|2097152,this._boundTo=d):this._bitField=this._bitField&-2097153},t.prototype._isBound=function(){return(this._bitField&2097152)===2097152},t.bind=function(d,u){return t.resolve(u).bind(d)}}});var xze=z((Ytr,Cze)=>{"use strict";Cze.exports=function(t,e,i,r){var n=Fn(),o=n.tryCatch,s=n.errorObj,a=t._async;t.prototype.break=t.prototype.cancel=function(){if(!r.cancellation())return this._warn("cancellation is disabled");for(var c=this,d=c;c._isCancellable();){if(!c._cancelBy(d)){d._isFollowing()?d._followee().cancel():d._cancelBranched();break}var u=c._cancellationParent;if(u==null||!u._isCancellable()){c._isFollowing()?c._followee().cancel():c._cancelBranched();break}else c._isFollowing()&&c._followee().cancel(),c._setWillBeCancelled(),d=c,c=u}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return this._branchesRemainingToCancel===void 0||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(c){return c===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),a.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(c,d){if(n.isArray(c))for(var u=0;u<c.length;++u)this._doInvokeOnCancel(c[u],d);else if(c!==void 0)if(typeof c=="function"){if(!d){var h=o(c).call(this._boundValue());h===s&&(this._attachExtraTrace(h.e),a.throwLater(h.e))}}else c._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var c=this._onCancel();this._unsetOnCancel(),a.invoke(this._doInvokeOnCancel,this,c)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}});var Eze=z(($tr,Sze)=>{"use strict";Sze.exports=function(t){function e(){return this.value}function i(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(r){return r instanceof t&&r.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:r},void 0)},t.prototype.throw=t.prototype.thenThrow=function(r){return this._then(i,void 0,void 0,{reason:r},void 0)},t.prototype.catchThrow=function(r){if(arguments.length<=1)return this._then(void 0,i,void 0,{reason:r},void 0);var n=arguments[1],o=function(){throw n};return this.caught(r,o)},t.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof t&&r.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:r},void 0);var n=arguments[1];n instanceof t&&n.suppressUnhandledRejections();var o=function(){return n};return this.caught(r,o)}}});var Rze=z((Gtr,Tze)=>{"use strict";Tze.exports=function(t){function e(c){c!==void 0?(c=c._target(),this._bitField=c._bitField,this._settledValueField=c._isFateSealed()?c._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var i=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError(`cannot get fulfillment value of a non-fulfilled promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError(`cannot get rejection reason of a non-rejected promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},n=e.prototype.isFulfilled=function(){return(this._bitField&33554432)!==0},o=e.prototype.isRejected=function(){return(this._bitField&16777216)!==0},s=e.prototype.isPending=function(){return(this._bitField&50397184)===0},a=e.prototype.isResolved=function(){return(this._bitField&50331648)!==0};e.prototype.isCancelled=function(){return(this._bitField&8454144)!==0},t.prototype.__isCancelled=function(){return(this._bitField&65536)===65536},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return(this._target()._bitField&8454144)!==0},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return n.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return i.call(this._target())},t.prototype.reason=function(){var c=this._target();return c._unsetRejectionIsUnhandled(),r.call(c)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}});var Ize=z((Xtr,Aze)=>{"use strict";Aze.exports=function(t,e,i,r,n,o){var s=Fn(),a=s.canEvaluate,c=s.tryCatch,d=s.errorObj,u;if(a){for(var h=function(x){return new Function("value","holder",`                             
            'use strict';                                                    
            holder.pIndex = value;                                           
            holder.checkFulfillment(this);                                   
            `.replace(/Index/g,x))},p=function(x){return new Function("promise","holder",`                           
            'use strict';                                                    
            holder.pIndex = promise;                                         
            `.replace(/Index/g,x))},f=function(x){for(var T=new Array(x),M=0;M<T.length;++M)T[M]="this.p"+(M+1);var B=T.join(" = ")+" = null;",G=`var promise;
`+T.map(function(J){return`                                                         
                promise = `+J+`;                                      
                if (promise instanceof Promise) {                            
                    promise.cancel();                                        
                }                                                            
            `}).join(`
`),F=T.join(", "),O="Holder$"+x,V=`return function(tryCatch, errorObj, Promise, async) {    
            'use strict';                                                    
            function [TheName](fn) {                                         
                [TheProperties]                                              
                this.fn = fn;                                                
                this.asyncNeeded = true;                                     
                this.now = 0;                                                
            }                                                                
                                                                             
            [TheName].prototype._callFunction = function(promise) {          
                promise._pushContext();                                      
                var ret = tryCatch(this.fn)([ThePassedArguments]);           
                promise._popContext();                                       
                if (ret === errorObj) {                                      
                    promise._rejectCallback(ret.e, false);                   
                } else {                                                     
                    promise._resolveCallback(ret);                           
                }                                                            
            };                                                               
                                                                             
            [TheName].prototype.checkFulfillment = function(promise) {       
                var now = ++this.now;                                        
                if (now === [TheTotal]) {                                    
                    if (this.asyncNeeded) {                                  
                        async.invoke(this._callFunction, this, promise);     
                    } else {                                                 
                        this._callFunction(promise);                         
                    }                                                        
                                                                             
                }                                                            
            };                                                               
                                                                             
            [TheName].prototype._resultCancelled = function() {              
                [CancellationCode]                                           
            };                                                               
                                                                             
            return [TheName];                                                
        }(tryCatch, errorObj, Promise, async);                               
        `;return V=V.replace(/\[TheName\]/g,O).replace(/\[TheTotal\]/g,x).replace(/\[ThePassedArguments\]/g,F).replace(/\[TheProperties\]/g,B).replace(/\[CancellationCode\]/g,G),new Function("tryCatch","errorObj","Promise","async",V)(c,d,t,n)},m=[],g=[],y=[],w=0;w<8;++w)m.push(f(w+1)),g.push(h(w+1)),y.push(p(w+1));u=function(x){this._reject(x)}}t.join=function(){var x=arguments.length-1,T;if(x>0&&typeof arguments[x]=="function"&&(T=arguments[x],x<=8&&a)){var K=new t(r);K._captureStackTrace();for(var M=m[x-1],B=new M(T),G=g,F=0;F<x;++F){var O=i(arguments[F],K);if(O instanceof t){O=O._target();var V=O._bitField;V&50397184?V&33554432?G[F].call(K,O._value(),B):V&16777216?K._reject(O._reason()):K._cancel():(O._then(G[F],u,void 0,K,B),y[F](O,B),B.asyncNeeded=!1)}else G[F].call(K,O,B)}if(!K._isFateSealed()){if(B.asyncNeeded){var J=o();J!==null&&(B.fn=s.domainBind(J,B.fn))}K._setAsyncGuaranteed(),K._setOnCancel(B)}return K}for(var N=arguments.length,P=new Array(N),$=0;$<N;++$)P[$]=arguments[$];T&&P.pop();var K=new e(P).promise();return T!==void 0?K.spread(T):K}}});var Mze=z((Ktr,Dze)=>{"use strict";Dze.exports=function(t,e,i,r,n,o){var s=t._getDomain,a=Fn(),c=a.tryCatch,d=a.errorObj,u=t._async;function h(f,m,g,y){this.constructor$(f),this._promise._captureStackTrace();var w=s();this._callback=w===null?m:a.domainBind(w,m),this._preservedValues=y===n?new Array(this.length()):null,this._limit=g,this._inFlight=0,this._queue=[],u.invoke(this._asyncInit,this,void 0)}a.inherits(h,e),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(f,m){var g=this._values,y=this.length(),w=this._preservedValues,x=this._limit;if(m<0){if(m=m*-1-1,g[m]=f,x>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(x>=1&&this._inFlight>=x)return g[m]=f,this._queue.push(m),!1;w!==null&&(w[m]=f);var T=this._promise,M=this._callback,B=T._boundValue();T._pushContext();var G=c(M).call(B,f,m,y),F=T._popContext();if(o.checkForgottenReturns(G,F,w!==null?"Promise.filter":"Promise.map",T),G===d)return this._reject(G.e),!0;var O=r(G,this._promise);if(O instanceof t){O=O._target();var V=O._bitField;if(V&50397184)if(V&33554432)G=O._value();else return V&16777216?(this._reject(O._reason()),!0):(this._cancel(),!0);else return x>=1&&this._inFlight++,g[m]=O,O._proxy(this,(m+1)*-1),!1}g[m]=G}var J=++this._totalResolved;return J>=y?(w!==null?this._filter(g,w):this._resolve(g),!0):!1},h.prototype._drainQueue=function(){for(var f=this._queue,m=this._limit,g=this._values;f.length>0&&this._inFlight<m;){if(this._isResolved())return;var y=f.pop();this._promiseFulfilled(g[y],y)}},h.prototype._filter=function(f,m){for(var g=m.length,y=new Array(g),w=0,x=0;x<g;++x)f[x]&&(y[w++]=m[x]);y.length=w,this._resolve(y)},h.prototype.preservedValues=function(){return this._preservedValues};function p(f,m,g,y){if(typeof m!="function")return i("expecting a function but got "+a.classString(m));var w=0;if(g!==void 0)if(typeof g=="object"&&g!==null){if(typeof g.concurrency!="number")return t.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(g.concurrency)));w=g.concurrency}else return t.reject(new TypeError("options argument must be an object but it is "+a.classString(g)));return w=typeof w=="number"&&isFinite(w)&&w>=1?w:0,new h(f,m,w,y).promise()}t.prototype.map=function(f,m){return p(this,f,m,null)},t.map=function(f,m,g,y){return p(f,m,g,y)}}});var Oze=z((Ztr,kze)=>{"use strict";var Hae=Object.create;Hae&&(Bae=Hae(null),Vae=Hae(null),Bae[" size"]=Vae[" size"]=0);var Bae,Vae;kze.exports=function(t){var e=Fn(),i=e.canEvaluate,r=e.isIdentifier,n,o,s=function(f){return new Function("ensureMethod",`                                    
        return function(obj) {                                               
            'use strict'                                                     
            var len = this.length;                                           
            ensureMethod(obj, 'methodName');                                 
            switch(len) {                                                    
                case 1: return obj.methodName(this[0]);                      
                case 2: return obj.methodName(this[0], this[1]);             
                case 3: return obj.methodName(this[0], this[1], this[2]);    
                case 0: return obj.methodName();                             
                default:                                                     
                    return obj.methodName.apply(obj, this);                  
            }                                                                
        };                                                                   
        `.replace(/methodName/g,f))(d)},a=function(f){return new Function("obj",`                                             
        'use strict';                                                        
        return obj.propertyName;                                             
        `.replace("propertyName",f))},c=function(f,m,g){var y=g[f];if(typeof y!="function"){if(!r(f))return null;if(y=m(f),g[f]=y,g[" size"]++,g[" size"]>512){for(var w=Object.keys(g),x=0;x<256;++x)delete g[w[x]];g[" size"]=w.length-256}}return y};n=function(f){return c(f,s,Bae)},o=function(f){return c(f,a,Vae)};function d(f,m){var g;if(f!=null&&(g=f[m]),typeof g!="function"){var y="Object "+e.classString(f)+" has no method '"+e.toString(m)+"'";throw new t.TypeError(y)}return g}function u(f){var m=this.pop(),g=d(f,m);return g.apply(f,this)}t.prototype.call=function(f){for(var m=arguments.length,g=new Array(Math.max(m-1,0)),y=1;y<m;++y)g[y-1]=arguments[y];if(i){var w=n(f);if(w!==null)return this._then(w,void 0,void 0,g,void 0)}return g.push(f),this._then(u,void 0,void 0,g,void 0)};function h(f){return f[this]}function p(f){var m=+this;return m<0&&(m=Math.max(0,m+f.length)),f[m]}t.prototype.get=function(f){var m=typeof f=="number",g;if(m)g=p;else if(i){var y=o(f);g=y!==null?y:h}else g=h;return this._then(g,void 0,void 0,f,void 0)}}});var Pze=z((Qtr,Nze)=>{"use strict";Nze.exports=function(t,e,i,r,n,o){var s=Fn(),a=vg().TypeError,c=Fn().inherits,d=s.errorObj,u=s.tryCatch,h={};function p(T){setTimeout(function(){throw T},0)}function f(T){var M=i(T);return M!==T&&typeof T._isDisposable=="function"&&typeof T._getDisposer=="function"&&T._isDisposable()&&M._setDisposable(T._getDisposer()),M}function m(T,M){var B=0,G=T.length,F=new t(n);function O(){if(B>=G)return F._fulfill();var V=f(T[B++]);if(V instanceof t&&V._isDisposable()){try{V=i(V._getDisposer().tryDispose(M),T.promise)}catch(J){return p(J)}if(V instanceof t)return V._then(O,p,null,null,null)}O()}return O(),F}function g(T,M,B){this._data=T,this._promise=M,this._context=B}g.prototype.data=function(){return this._data},g.prototype.promise=function(){return this._promise},g.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():h},g.prototype.tryDispose=function(T){var M=this.resource(),B=this._context;B!==void 0&&B._pushContext();var G=M!==h?this.doDispose(M,T):null;return B!==void 0&&B._popContext(),this._promise._unsetDisposable(),this._data=null,G},g.isDisposer=function(T){return T!=null&&typeof T.resource=="function"&&typeof T.tryDispose=="function"};function y(T,M,B){this.constructor$(T,M,B)}c(y,g),y.prototype.doDispose=function(T,M){var B=this.data();return B.call(T,T,M)};function w(T){return g.isDisposer(T)?(this.resources[this.index]._setDisposable(T),T.promise()):T}function x(T){this.length=T,this.promise=null,this[T-1]=null}x.prototype._resultCancelled=function(){for(var T=this.length,M=0;M<T;++M){var B=this[M];B instanceof t&&B.cancel()}},t.using=function(){var T=arguments.length;if(T<2)return e("you must pass at least 2 arguments to Promise.using");var M=arguments[T-1];if(typeof M!="function")return e("expecting a function but got "+s.classString(M));var B,G=!0;T===2&&Array.isArray(arguments[0])?(B=arguments[0],T=B.length,G=!1):(B=arguments,T--);for(var F=new x(T),O=0;O<T;++O){var V=B[O];if(g.isDisposer(V)){var J=V;V=V.promise(),V._setDisposable(J)}else{var N=i(V);N instanceof t&&(V=N._then(w,null,null,{resources:F,index:O},void 0))}F[O]=V}for(var P=new Array(F.length),O=0;O<P.length;++O)P[O]=t.resolve(F[O]).reflect();var $=t.all(P).then(function(ve){for(var W=0;W<ve.length;++W){var ee=ve[W];if(ee.isRejected())return d.e=ee.error(),d;if(!ee.isFulfilled()){$.cancel();return}ve[W]=ee.value()}K._pushContext(),M=u(M);var te=G?M.apply(void 0,ve):M(ve),se=K._popContext();return o.checkForgottenReturns(te,se,"Promise.using",K),te}),K=$.lastly(function(){var ve=new t.PromiseInspection($);return m(F,ve)});return F.promise=K,K._setOnCancel(F),K},t.prototype._setDisposable=function(T){this._bitField=this._bitField|131072,this._disposer=T},t.prototype._isDisposable=function(){return(this._bitField&131072)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},t.prototype.disposer=function(T){if(typeof T=="function")return new y(T,this,r());throw new a}}});var Fze=z((Jtr,Lze)=>{"use strict";Lze.exports=function(t,e,i){var r=Fn(),n=t.TimeoutError;function o(h){this.handle=h}o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var s=function(h){return a(+this).thenReturn(h)},a=t.delay=function(h,p){var f,m;return p!==void 0?(f=t.resolve(p)._then(s,null,null,h,void 0),i.cancellation()&&p instanceof t&&f._setOnCancel(p)):(f=new t(e),m=setTimeout(function(){f._fulfill()},+h),i.cancellation()&&f._setOnCancel(new o(m)),f._captureStackTrace()),f._setAsyncGuaranteed(),f};t.prototype.delay=function(h){return a(h,this)};var c=function(h,p,f){var m;typeof p!="string"?p instanceof Error?m=p:m=new n("operation timed out"):m=new n(p),r.markAsOriginatingFromRejection(m),h._attachExtraTrace(m),h._reject(m),f?.cancel()};function d(h){return clearTimeout(this.handle),h}function u(h){throw clearTimeout(this.handle),h}t.prototype.timeout=function(h,p){h=+h;var f,m,g=new o(setTimeout(function(){f.isPending()&&c(f,p,m)},h));return i.cancellation()?(m=this.then(),f=m._then(d,u,void 0,g,void 0),f._setOnCancel(g)):f=this._then(d,u,void 0,g,void 0),f}}});var Bze=z((eir,Hze)=>{"use strict";Hze.exports=function(t,e,i,r,n,o){var s=vg(),a=s.TypeError,c=Fn(),d=c.errorObj,u=c.tryCatch,h=[];function p(m,g,y){for(var w=0;w<g.length;++w){y._pushContext();var x=u(g[w])(m);if(y._popContext(),x===d){y._pushContext();var T=t.reject(d.e);return y._popContext(),T}var M=r(x,y);if(M instanceof t)return M}return null}function f(m,g,y,w){if(o.cancellation()){var x=new t(i),T=this._finallyPromise=new t(i);this._promise=x.lastly(function(){return T}),x._captureStackTrace(),x._setOnCancel(this)}else{var M=this._promise=new t(i);M._captureStackTrace()}this._stack=w,this._generatorFunction=m,this._receiver=g,this._generator=void 0,this._yieldHandlers=typeof y=="function"?[y].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}c.inherits(f,n),f.prototype._isResolved=function(){return this._promise===null},f.prototype._cleanup=function(){this._promise=this._generator=null,o.cancellation()&&this._finallyPromise!==null&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},f.prototype._promiseCancelled=function(){if(!this._isResolved()){var m=typeof this._generator.return<"u",g;if(m)this._promise._pushContext(),g=u(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var y=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=y,this._promise._attachExtraTrace(y),this._promise._pushContext(),g=u(this._generator.throw).call(this._generator,y),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(g)}},f.prototype._promiseFulfilled=function(m){this._yieldedPromise=null,this._promise._pushContext();var g=u(this._generator.next).call(this._generator,m);this._promise._popContext(),this._continue(g)},f.prototype._promiseRejected=function(m){this._yieldedPromise=null,this._promise._attachExtraTrace(m),this._promise._pushContext();var g=u(this._generator.throw).call(this._generator,m);this._promise._popContext(),this._continue(g)},f.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var m=this._yieldedPromise;this._yieldedPromise=null,m.cancel()}},f.prototype.promise=function(){return this._promise},f.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},f.prototype._continue=function(m){var g=this._promise;if(m===d)return this._cleanup(),this._cancellationPhase?g.cancel():g._rejectCallback(m.e,!1);var y=m.value;if(m.done===!0)return this._cleanup(),this._cancellationPhase?g.cancel():g._resolveCallback(y);var w=r(y,this._promise);if(!(w instanceof t)&&(w=p(w,this._yieldHandlers,this._promise),w===null)){this._promiseRejected(new a(`A value %s was yielded that could not be treated as a promise

    See http://goo.gl/MqrFmX

`.replace("%s",y)+`From coroutine:
`+this._stack.split(`
`).slice(1,-7).join(`
`)));return}w=w._target();var x=w._bitField;x&50397184?x&33554432?t._async.invoke(this._promiseFulfilled,this,w._value()):x&16777216?t._async.invoke(this._promiseRejected,this,w._reason()):this._promiseCancelled():(this._yieldedPromise=w,w._proxy(this,null))},t.coroutine=function(m,g){if(typeof m!="function")throw new a(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var y=Object(g).yieldHandler,w=f,x=new Error().stack;return function(){var T=m.apply(this,arguments),M=new w(void 0,void 0,y,x),B=M.promise();return M._generator=T,M._promiseFulfilled(void 0),B}},t.coroutine.addYieldHandler=function(m){if(typeof m!="function")throw new a("expecting a function but got "+c.classString(m));h.push(m)},t.spawn=function(m){if(o.deprecated("Promise.spawn()","Promise.coroutine()"),typeof m!="function")return e(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var g=new f(m,this),y=g.promise();return g._run(t.spawn),y}}});var jze=z((tir,Vze)=>{"use strict";Vze.exports=function(t){var e=Fn(),i=t._async,r=e.tryCatch,n=e.errorObj;function o(c,d){var u=this;if(!e.isArray(c))return s.call(u,c,d);var h=r(d).apply(u._boundValue(),[null].concat(c));h===n&&i.throwLater(h.e)}function s(c,d){var u=this,h=u._boundValue(),p=c===void 0?r(d).call(h,null):r(d).call(h,null,c);p===n&&i.throwLater(p.e)}function a(c,d){var u=this;if(!c){var h=new Error(c+"");h.cause=c,c=h}var p=r(d).call(u._boundValue(),c);p===n&&i.throwLater(p.e)}t.prototype.asCallback=t.prototype.nodeify=function(c,d){if(typeof c=="function"){var u=s;d!==void 0&&Object(d).spread&&(u=o),this._then(u,a,void 0,this,c)}return this}}});var Wze=z((iir,zze)=>{"use strict";zze.exports=function(t,e){var i={},r=Fn(),n=Fae(),o=r.withAppended,s=r.maybeWrapAsError,a=r.canEvaluate,c=vg().TypeError,d="Async",u={__isPromisified__:!0},h=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],p=new RegExp("^(?:"+h.join("|")+")$"),f=function($){return r.isIdentifier($)&&$.charAt(0)!=="_"&&$!=="constructor"};function m($){return!p.test($)}function g($){try{return $.__isPromisified__===!0}catch{return!1}}function y($,K,ve){var W=r.getDataPropertyOrDefault($,K+ve,u);return W?g(W):!1}function w($,K,ve){for(var W=0;W<$.length;W+=2){var ee=$[W];if(ve.test(ee)){for(var te=ee.replace(ve,""),se=0;se<$.length;se+=2)if($[se]===te)throw new c(`Cannot promisify an API that has normal methods with '%s'-suffix

    See http://goo.gl/MqrFmX
`.replace("%s",K))}}}function x($,K,ve,W){for(var ee=r.inheritedDataKeys($),te=[],se=0;se<ee.length;++se){var Ae=ee[se],k=$[Ae],S=W===f?!0:f(Ae,k,$);typeof k=="function"&&!g(k)&&!y($,Ae,K)&&W(Ae,k,$,S)&&te.push(Ae,k)}return w(te,K,ve),te}var T=function($){return $.replace(/([$])/,"\\$")},M,B=function($){for(var K=[$],ve=Math.max(0,$-1-3),W=$-1;W>=ve;--W)K.push(W);for(var W=$+1;W<=3;++W)K.push(W);return K},G=function($){return r.filledRange($,"_arg","")},F=function($){return r.filledRange(Math.max($,3),"_arg","")},O=function($){return typeof $.length=="number"?Math.max(Math.min($.length,1024),0):0};M=function($,K,ve,W,ee,te){var se=Math.max(0,O(W)-1),Ae=B(se),k=typeof $=="string"||K===i;function S(le){var xe=G(le).join(", "),Re=le>0?", ":"",Oe;return k?Oe=`ret = callback.call(this, {{args}}, nodeback); break;
`:Oe=K===void 0?`ret = callback({{args}}, nodeback); break;
`:`ret = callback.call(receiver, {{args}}, nodeback); break;
`,Oe.replace("{{args}}",xe).replace(", ",Re)}function I(){for(var le="",xe=0;xe<Ae.length;++xe)le+="case "+Ae[xe]+":"+S(Ae[xe]);return le+=`                                                             
        default:                                                             
            var args = new Array(len + 1);                                   
            var i = 0;                                                       
            for (var i = 0; i < len; ++i) {                                  
               args[i] = arguments[i];                                       
            }                                                                
            args[i] = nodeback;                                              
            [CodeForCall]                                                    
            break;                                                           
        `.replace("[CodeForCall]",k?`ret = callback.apply(this, args);
`:`ret = callback.apply(receiver, args);
`),le}var X=typeof $=="string"?"this != null ? this['"+$+"'] : fn":"fn",Q=`'use strict';                                                
        var ret = function (Parameters) {                                    
            'use strict';                                                    
            var len = arguments.length;                                      
            var promise = new Promise(INTERNAL);                             
            promise._captureStackTrace();                                    
            var nodeback = nodebackForPromise(promise, `+te+`);   
            var ret;                                                         
            var callback = tryCatch([GetFunctionCode]);                      
            switch(len) {                                                    
                [CodeForSwitchCase]                                          
            }                                                                
            if (ret === errorObj) {                                          
                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);
            }                                                                
            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     
            return promise;                                                  
        };                                                                   
        notEnumerableProp(ret, '__isPromisified__', true);                   
        return ret;                                                          
    `.replace("[CodeForSwitchCase]",I()).replace("[GetFunctionCode]",X);return Q=Q.replace("Parameters",F(se)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",Q)(t,W,K,o,s,n,r.tryCatch,r.errorObj,r.notEnumerableProp,e)};function V($,K,ve,W,ee,te){var se=function(){return this}(),Ae=$;typeof Ae=="string"&&($=W);function k(){var S=K;K===i&&(S=this);var I=new t(e);I._captureStackTrace();var X=typeof Ae=="string"&&this!==se?this[Ae]:$,Q=n(I,te);try{X.apply(S,o(arguments,Q))}catch(le){I._rejectCallback(s(le),!0,!0)}return I._isFateSealed()||I._setAsyncGuaranteed(),I}return r.notEnumerableProp(k,"__isPromisified__",!0),k}var J=a?M:V;function N($,K,ve,W,ee){for(var te=new RegExp(T(K)+"$"),se=x($,K,te,ve),Ae=0,k=se.length;Ae<k;Ae+=2){var S=se[Ae],I=se[Ae+1],X=S+K;if(W===J)$[X]=J(S,i,S,I,K,ee);else{var Q=W(I,function(){return J(S,i,S,I,K,ee)});r.notEnumerableProp(Q,"__isPromisified__",!0),$[X]=Q}}return r.toFastProperties($),$}function P($,K,ve){return J($,K,void 0,$,null,ve)}t.promisify=function($,K){if(typeof $!="function")throw new c("expecting a function but got "+r.classString($));if(g($))return $;K=Object(K);var ve=K.context===void 0?i:K.context,W=!!K.multiArgs,ee=P($,ve,W);return r.copyDescriptors($,ee,m),ee},t.promisifyAll=function($,K){if(typeof $!="function"&&typeof $!="object")throw new c(`the target of promisifyAll must be an object or a function

    See http://goo.gl/MqrFmX
`);K=Object(K);var ve=!!K.multiArgs,W=K.suffix;typeof W!="string"&&(W=d);var ee=K.filter;typeof ee!="function"&&(ee=f);var te=K.promisifier;if(typeof te!="function"&&(te=J),!r.isIdentifier(W))throw new RangeError(`suffix must be a valid identifier

    See http://goo.gl/MqrFmX
`);for(var se=r.inheritedDataKeys($),Ae=0;Ae<se.length;++Ae){var k=$[se[Ae]];se[Ae]!=="constructor"&&r.isClass(k)&&(N(k.prototype,W,ee,te,ve),N(k,W,ee,te,ve))}return N($,W,ee,te,ve)}}});var qze=z((rir,Uze)=>{"use strict";Uze.exports=function(t,e,i,r){var n=Fn(),o=n.isObject,s=Jw(),a;typeof Map=="function"&&(a=Map);var c=function(){var p=0,f=0;function m(g,y){this[p]=g,this[p+f]=y,p++}return function(y){f=y.size,p=0;var w=new Array(y.size*2);return y.forEach(m,w),w}}(),d=function(p){for(var f=new a,m=p.length/2|0,g=0;g<m;++g){var y=p[m+g],w=p[g];f.set(y,w)}return f};function u(p){var f=!1,m;if(a!==void 0&&p instanceof a)m=c(p),f=!0;else{var g=s.keys(p),y=g.length;m=new Array(y*2);for(var w=0;w<y;++w){var x=g[w];m[w]=p[x],m[w+y]=x}}this.constructor$(m),this._isMap=f,this._init$(void 0,-3)}n.inherits(u,e),u.prototype._init=function(){},u.prototype._promiseFulfilled=function(p,f){this._values[f]=p;var m=++this._totalResolved;if(m>=this._length){var g;if(this._isMap)g=d(this._values);else{g={};for(var y=this.length(),w=0,x=this.length();w<x;++w)g[this._values[w+y]]=this._values[w]}return this._resolve(g),!0}return!1},u.prototype.shouldCopyValues=function(){return!1},u.prototype.getActualLength=function(p){return p>>1};function h(p){var f,m=i(p);if(o(m))m instanceof t?f=m._then(t.props,void 0,void 0,void 0,void 0):f=new u(m).promise();else return r(`cannot await properties of a non-object

    See http://goo.gl/MqrFmX
`);return m instanceof t&&f._propagateFrom(m,2),f}t.prototype.props=function(){return h(this)},t.props=function(p){return h(p)}}});var $ze=z((nir,Yze)=>{"use strict";Yze.exports=function(t,e,i,r){var n=Fn(),o=function(a){return a.then(function(c){return s(c,a)})};function s(a,c){var d=i(a);if(d instanceof t)return o(d);if(a=n.asArray(a),a===null)return r("expecting an array or an iterable object but got "+n.classString(a));var u=new t(e);c!==void 0&&u._propagateFrom(c,3);for(var h=u._fulfill,p=u._reject,f=0,m=a.length;f<m;++f){var g=a[f];g===void 0&&!(f in a)||t.cast(g)._then(h,p,void 0,u,null)}return u}t.race=function(a){return s(a,void 0)},t.prototype.race=function(){return s(this,void 0)}}});var Xze=z((oir,Gze)=>{"use strict";Gze.exports=function(t,e,i,r,n,o){var s=t._getDomain,a=Fn(),c=a.tryCatch;function d(m,g,y,w){this.constructor$(m);var x=s();this._fn=x===null?g:a.domainBind(x,g),y!==void 0&&(y=t.resolve(y),y._attachCancellationCallback(this)),this._initialValue=y,this._currentCancellable=null,w===n?this._eachValues=Array(this._length):w===0?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}a.inherits(d,e),d.prototype._gotAccum=function(m){this._eachValues!==void 0&&this._eachValues!==null&&m!==n&&this._eachValues.push(m)},d.prototype._eachComplete=function(m){return this._eachValues!==null&&this._eachValues.push(m),this._eachValues},d.prototype._init=function(){},d.prototype._resolveEmptyArray=function(){this._resolve(this._eachValues!==void 0?this._eachValues:this._initialValue)},d.prototype.shouldCopyValues=function(){return!1},d.prototype._resolve=function(m){this._promise._resolveCallback(m),this._values=null},d.prototype._resultCancelled=function(m){if(m===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},d.prototype._iterate=function(m){this._values=m;var g,y,w=m.length;if(this._initialValue!==void 0?(g=this._initialValue,y=0):(g=t.resolve(m[0]),y=1),this._currentCancellable=g,!g.isRejected())for(;y<w;++y){var x={accum:null,value:m[y],index:y,length:w,array:this};g=g._then(p,void 0,void 0,x,void 0)}this._eachValues!==void 0&&(g=g._then(this._eachComplete,void 0,void 0,this,void 0)),g._then(u,u,void 0,g,this)},t.prototype.reduce=function(m,g){return h(this,m,g,null)},t.reduce=function(m,g,y,w){return h(m,g,y,w)};function u(m,g){this.isFulfilled()?g._resolve(m):g._reject(m)}function h(m,g,y,w){if(typeof g!="function")return i("expecting a function but got "+a.classString(g));var x=new d(m,g,y,w);return x.promise()}function p(m){this.accum=m,this.array._gotAccum(m);var g=r(this.value,this.array._promise);return g instanceof t?(this.array._currentCancellable=g,g._then(f,void 0,void 0,this,void 0)):f.call(this,g)}function f(m){var g=this.array,y=g._promise,w=c(g._fn);y._pushContext();var x;g._eachValues!==void 0?x=w.call(y._boundValue(),m,this.index,this.length):x=w.call(y._boundValue(),this.accum,m,this.index,this.length),x instanceof t&&(g._currentCancellable=x);var T=y._popContext();return o.checkForgottenReturns(x,T,g._eachValues!==void 0?"Promise.each":"Promise.reduce",y),x}}});var Zze=z((sir,Kze)=>{"use strict";Kze.exports=function(t,e,i){var r=t.PromiseInspection,n=Fn();function o(s){this.constructor$(s)}n.inherits(o,e),o.prototype._promiseResolved=function(s,a){this._values[s]=a;var c=++this._totalResolved;return c>=this._length?(this._resolve(this._values),!0):!1},o.prototype._promiseFulfilled=function(s,a){var c=new r;return c._bitField=33554432,c._settledValueField=s,this._promiseResolved(a,c)},o.prototype._promiseRejected=function(s,a){var c=new r;return c._bitField=16777216,c._settledValueField=s,this._promiseResolved(a,c)},t.settle=function(s){return i.deprecated(".settle()",".reflect()"),new o(s).promise()},t.prototype.settle=function(){return t.settle(this)}}});var Jze=z((air,Qze)=>{"use strict";Qze.exports=function(t,e,i){var r=Fn(),n=vg().RangeError,o=vg().AggregateError,s=r.isArray,a={};function c(u){this.constructor$(u),this._howMany=0,this._unwrap=!1,this._initialized=!1}r.inherits(c,e),c.prototype._init=function(){if(this._initialized){if(this._howMany===0){this._resolve([]);return}this._init$(void 0,-5);var u=s(this._values);!this._isResolved()&&u&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(u){this._howMany=u},c.prototype._promiseFulfilled=function(u){return this._addFulfilled(u),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},c.prototype._promiseRejected=function(u){return this._addRejected(u),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof t||this._values==null?this._cancel():(this._addRejected(a),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var u=new o,h=this.length();h<this._values.length;++h)this._values[h]!==a&&u.push(this._values[h]);return u.length>0?this._reject(u):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(u){this._values.push(u)},c.prototype._addFulfilled=function(u){this._values[this._totalResolved++]=u},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(u){var h="Input array must contain at least "+this._howMany+" items but contains only "+u+" items";return new n(h)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function d(u,h){if((h|0)!==h||h<0)return i(`expecting a positive integer

    See http://goo.gl/MqrFmX
`);var p=new c(u),f=p.promise();return p.setHowMany(h),p.init(),f}t.some=function(u,h){return d(u,h)},t.prototype.some=function(u){return d(this,u)},t._SomePromiseArray=c}});var tWe=z((lir,eWe)=>{"use strict";eWe.exports=function(t,e){var i=t.map;t.prototype.filter=function(r,n){return i(this,r,n,e)},t.filter=function(r,n,o){return i(r,n,o,e)}}});var rWe=z((cir,iWe)=>{"use strict";iWe.exports=function(t,e){var i=t.reduce,r=t.all;function n(){return r(this)}function o(s,a){return i(s,a,e,e)}t.prototype.each=function(s){return i(this,s,e,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(s){return i(this,s,e,e)},t.each=function(s,a){return i(s,a,e,0)._then(n,void 0,void 0,s,void 0)},t.mapSeries=o}});var oWe=z((dir,nWe)=>{"use strict";nWe.exports=function(t){var e=t._SomePromiseArray;function i(r){var n=new e(r),o=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),o}t.any=function(r){return i(r)},t.prototype.any=function(){return i(this)}}});var sWe=z((uir,jae)=>{"use strict";jae.exports=function(){var t=function(){return new h(`circular promise resolution chain

    See http://goo.gl/MqrFmX
`)},e=function(){return new P.PromiseInspection(this._target())},i=function(W){return P.reject(new h(W))};function r(){}var n={},o=Fn(),s;o.isNode?s=function(){var W=process.domain;return W===void 0&&(W=null),W}:s=function(){return null},o.notEnumerableProp(P,"_getDomain",s);var a=Jw(),c=J8e(),d=new c;a.defineProperty(P,"_async",{value:d});var u=vg(),h=P.TypeError=u.TypeError;P.RangeError=u.RangeError;var p=P.CancellationError=u.CancellationError;P.TimeoutError=u.TimeoutError,P.OperationalError=u.OperationalError,P.RejectionError=u.OperationalError,P.AggregateError=u.AggregateError;var f=function(){},m={},g={},y=nze()(P,f),w=sze()(P,f,y,i,r),x=lze()(P),T=x.create,M=dze()(P,x),B=M.CapturedTrace,G=hze()(P,y),F=pze()(g),O=Fae(),V=o.errorObj,J=o.tryCatch;function N(W,ee){if(typeof ee!="function")throw new h("expecting a function but got "+o.classString(ee));if(W.constructor!==P)throw new h(`the promise constructor cannot be invoked directly

    See http://goo.gl/MqrFmX
`)}function P(W){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,W!==f&&(N(this,W),this._resolveFromExecutor(W)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}P.prototype.toString=function(){return"[object Promise]"},P.prototype.caught=P.prototype.catch=function(W){var ee=arguments.length;if(ee>1){var te=new Array(ee-1),se=0,Ae;for(Ae=0;Ae<ee-1;++Ae){var k=arguments[Ae];if(o.isObject(k))te[se++]=k;else return i("expecting an object but got A catch statement predicate "+o.classString(k))}return te.length=se,W=arguments[Ae],this.then(void 0,F(te,W,this))}return this.then(void 0,W)},P.prototype.reflect=function(){return this._then(e,e,void 0,this,void 0)},P.prototype.then=function(W,ee){if(M.warnings()&&arguments.length>0&&typeof W!="function"&&typeof ee!="function"){var te=".then() only accepts functions but was passed: "+o.classString(W);arguments.length>1&&(te+=", "+o.classString(ee)),this._warn(te)}return this._then(W,ee,void 0,void 0,void 0)},P.prototype.done=function(W,ee){var te=this._then(W,ee,void 0,void 0,void 0);te._setIsFinal()},P.prototype.spread=function(W){return typeof W!="function"?i("expecting a function but got "+o.classString(W)):this.all()._then(W,void 0,void 0,m,void 0)},P.prototype.toJSON=function(){var W={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(W.fulfillmentValue=this.value(),W.isFulfilled=!0):this.isRejected()&&(W.rejectionReason=this.reason(),W.isRejected=!0),W},P.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new w(this).promise()},P.prototype.error=function(W){return this.caught(o.originatesFromRejection,W)},P.getNewLibraryCopy=jae.exports,P.is=function(W){return W instanceof P},P.fromNode=P.fromCallback=function(W){var ee=new P(f);ee._captureStackTrace();var te=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,se=J(W)(O(ee,te));return se===V&&ee._rejectCallback(se.e,!0),ee._isFateSealed()||ee._setAsyncGuaranteed(),ee},P.all=function(W){return new w(W).promise()},P.cast=function(W){var ee=y(W);return ee instanceof P||(ee=new P(f),ee._captureStackTrace(),ee._setFulfilled(),ee._rejectionHandler0=W),ee},P.resolve=P.fulfilled=P.cast,P.reject=P.rejected=function(W){var ee=new P(f);return ee._captureStackTrace(),ee._rejectCallback(W,!0),ee},P.setScheduler=function(W){if(typeof W!="function")throw new h("expecting a function but got "+o.classString(W));return d.setScheduler(W)},P.prototype._then=function(W,ee,te,se,Ae){var k=Ae!==void 0,S=k?Ae:new P(f),I=this._target(),X=I._bitField;k||(S._propagateFrom(this,3),S._captureStackTrace(),se===void 0&&this._bitField&2097152&&(X&50397184?se=this._boundValue():se=I===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,S));var Q=s();if(X&50397184){var le,xe,Re=I._settlePromiseCtx;X&33554432?(xe=I._rejectionHandler0,le=W):X&16777216?(xe=I._fulfillmentHandler0,le=ee,I._unsetRejectionIsUnhandled()):(Re=I._settlePromiseLateCancellationObserver,xe=new p("late cancellation observer"),I._attachExtraTrace(xe),le=ee),d.invoke(Re,I,{handler:Q===null?le:typeof le=="function"&&o.domainBind(Q,le),promise:S,receiver:se,value:xe})}else I._addCallbacks(W,ee,S,se,Q);return S},P.prototype._length=function(){return this._bitField&65535},P.prototype._isFateSealed=function(){return(this._bitField&117506048)!==0},P.prototype._isFollowing=function(){return(this._bitField&67108864)===67108864},P.prototype._setLength=function(W){this._bitField=this._bitField&-65536|W&65535},P.prototype._setFulfilled=function(){this._bitField=this._bitField|33554432,this._fireEvent("promiseFulfilled",this)},P.prototype._setRejected=function(){this._bitField=this._bitField|16777216,this._fireEvent("promiseRejected",this)},P.prototype._setFollowing=function(){this._bitField=this._bitField|67108864,this._fireEvent("promiseResolved",this)},P.prototype._setIsFinal=function(){this._bitField=this._bitField|4194304},P.prototype._isFinal=function(){return(this._bitField&4194304)>0},P.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},P.prototype._setCancelled=function(){this._bitField=this._bitField|65536,this._fireEvent("promiseCancelled",this)},P.prototype._setWillBeCancelled=function(){this._bitField=this._bitField|8388608},P.prototype._setAsyncGuaranteed=function(){d.hasCustomScheduler()||(this._bitField=this._bitField|134217728)},P.prototype._receiverAt=function(W){var ee=W===0?this._receiver0:this[W*4-4+3];if(ee!==n)return ee===void 0&&this._isBound()?this._boundValue():ee},P.prototype._promiseAt=function(W){return this[W*4-4+2]},P.prototype._fulfillmentHandlerAt=function(W){return this[W*4-4+0]},P.prototype._rejectionHandlerAt=function(W){return this[W*4-4+1]},P.prototype._boundValue=function(){},P.prototype._migrateCallback0=function(W){var ee=W._bitField,te=W._fulfillmentHandler0,se=W._rejectionHandler0,Ae=W._promise0,k=W._receiverAt(0);k===void 0&&(k=n),this._addCallbacks(te,se,Ae,k,null)},P.prototype._migrateCallbackAt=function(W,ee){var te=W._fulfillmentHandlerAt(ee),se=W._rejectionHandlerAt(ee),Ae=W._promiseAt(ee),k=W._receiverAt(ee);k===void 0&&(k=n),this._addCallbacks(te,se,Ae,k,null)},P.prototype._addCallbacks=function(W,ee,te,se,Ae){var k=this._length();if(k>=65531&&(k=0,this._setLength(0)),k===0)this._promise0=te,this._receiver0=se,typeof W=="function"&&(this._fulfillmentHandler0=Ae===null?W:o.domainBind(Ae,W)),typeof ee=="function"&&(this._rejectionHandler0=Ae===null?ee:o.domainBind(Ae,ee));else{var S=k*4-4;this[S+2]=te,this[S+3]=se,typeof W=="function"&&(this[S+0]=Ae===null?W:o.domainBind(Ae,W)),typeof ee=="function"&&(this[S+1]=Ae===null?ee:o.domainBind(Ae,ee))}return this._setLength(k+1),k},P.prototype._proxy=function(W,ee){this._addCallbacks(void 0,void 0,ee,W,null)},P.prototype._resolveCallback=function(W,ee){if(!(this._bitField&117506048)){if(W===this)return this._rejectCallback(t(),!1);var te=y(W,this);if(!(te instanceof P))return this._fulfill(W);ee&&this._propagateFrom(te,2);var se=te._target();if(se===this){this._reject(t());return}var Ae=se._bitField;if(Ae&50397184)if(Ae&33554432)this._fulfill(se._value());else if(Ae&16777216)this._reject(se._reason());else{var I=new p("late cancellation observer");se._attachExtraTrace(I),this._reject(I)}else{var k=this._length();k>0&&se._migrateCallback0(this);for(var S=1;S<k;++S)se._migrateCallbackAt(this,S);this._setFollowing(),this._setLength(0),this._setFollowee(se)}}},P.prototype._rejectCallback=function(W,ee,te){var se=o.ensureErrorObject(W),Ae=se===W;if(!Ae&&!te&&M.warnings()){var k="a promise was rejected with a non-error: "+o.classString(W);this._warn(k,!0)}this._attachExtraTrace(se,ee?Ae:!1),this._reject(W)},P.prototype._resolveFromExecutor=function(W){var ee=this;this._captureStackTrace(),this._pushContext();var te=!0,se=this._execute(W,function(Ae){ee._resolveCallback(Ae)},function(Ae){ee._rejectCallback(Ae,te)});te=!1,this._popContext(),se!==void 0&&ee._rejectCallback(se,!0)},P.prototype._settlePromiseFromHandler=function(W,ee,te,se){var Ae=se._bitField;if(!(Ae&65536)){se._pushContext();var k;ee===m?!te||typeof te.length!="number"?(k=V,k.e=new h("cannot .spread() a non-array: "+o.classString(te))):k=J(W).apply(this._boundValue(),te):k=J(W).call(ee,te);var S=se._popContext();Ae=se._bitField,!(Ae&65536)&&(k===g?se._reject(te):k===V?se._rejectCallback(k.e,!1):(M.checkForgottenReturns(k,S,"",se,this),se._resolveCallback(k)))}},P.prototype._target=function(){for(var W=this;W._isFollowing();)W=W._followee();return W},P.prototype._followee=function(){return this._rejectionHandler0},P.prototype._setFollowee=function(W){this._rejectionHandler0=W},P.prototype._settlePromise=function(W,ee,te,se){var Ae=W instanceof P,k=this._bitField,S=(k&134217728)!==0;k&65536?(Ae&&W._invokeInternalOnCancel(),te instanceof G&&te.isFinallyHandler()?(te.cancelPromise=W,J(ee).call(te,se)===V&&W._reject(V.e)):ee===e?W._fulfill(e.call(te)):te instanceof r?te._promiseCancelled(W):Ae||W instanceof w?W._cancel():te.cancel()):typeof ee=="function"?Ae?(S&&W._setAsyncGuaranteed(),this._settlePromiseFromHandler(ee,te,se,W)):ee.call(te,se,W):te instanceof r?te._isResolved()||(k&33554432?te._promiseFulfilled(se,W):te._promiseRejected(se,W)):Ae&&(S&&W._setAsyncGuaranteed(),k&33554432?W._fulfill(se):W._reject(se))},P.prototype._settlePromiseLateCancellationObserver=function(W){var ee=W.handler,te=W.promise,se=W.receiver,Ae=W.value;typeof ee=="function"?te instanceof P?this._settlePromiseFromHandler(ee,se,Ae,te):ee.call(se,Ae,te):te instanceof P&&te._reject(Ae)},P.prototype._settlePromiseCtx=function(W){this._settlePromise(W.promise,W.handler,W.receiver,W.value)},P.prototype._settlePromise0=function(W,ee,te){var se=this._promise0,Ae=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(se,W,Ae,ee)},P.prototype._clearCallbackDataAtIndex=function(W){var ee=W*4-4;this[ee+2]=this[ee+3]=this[ee+0]=this[ee+1]=void 0},P.prototype._fulfill=function(W){var ee=this._bitField;if(!((ee&117506048)>>>16)){if(W===this){var te=t();return this._attachExtraTrace(te),this._reject(te)}this._setFulfilled(),this._rejectionHandler0=W,(ee&65535)>0&&(ee&134217728?this._settlePromises():d.settlePromises(this))}},P.prototype._reject=function(W){var ee=this._bitField;if(!((ee&117506048)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=W,this._isFinal())return d.fatalError(W,o.isNode);(ee&65535)>0?d.settlePromises(this):this._ensurePossibleRejectionHandled()}},P.prototype._fulfillPromises=function(W,ee){for(var te=1;te<W;te++){var se=this._fulfillmentHandlerAt(te),Ae=this._promiseAt(te),k=this._receiverAt(te);this._clearCallbackDataAtIndex(te),this._settlePromise(Ae,se,k,ee)}},P.prototype._rejectPromises=function(W,ee){for(var te=1;te<W;te++){var se=this._rejectionHandlerAt(te),Ae=this._promiseAt(te),k=this._receiverAt(te);this._clearCallbackDataAtIndex(te),this._settlePromise(Ae,se,k,ee)}},P.prototype._settlePromises=function(){var W=this._bitField,ee=W&65535;if(ee>0){if(W&16842752){var te=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,te,W),this._rejectPromises(ee,te)}else{var se=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,se,W),this._fulfillPromises(ee,se)}this._setLength(0)}this._clearCancellationData()},P.prototype._settledValue=function(){var W=this._bitField;if(W&33554432)return this._rejectionHandler0;if(W&16777216)return this._fulfillmentHandler0};function $(W){this.promise._resolveCallback(W)}function K(W){this.promise._rejectCallback(W,!1)}P.defer=P.pending=function(){M.deprecated("Promise.defer","new Promise");var W=new P(f);return{promise:W,resolve:$,reject:K}},o.notEnumerableProp(P,"_makeSelfResolutionError",t),_ze()(P,f,y,i,M),wze()(P,f,y,M),xze()(P,w,i,M),Eze()(P),Rze()(P),Ize()(P,w,y,f,d,s),P.Promise=P,P.version="3.4.7",Mze()(P,w,i,y,f,M),Oze()(P),Pze()(P,i,y,T,f,M),Fze()(P,f,M),Bze()(P,i,f,y,r,M),jze()(P),Wze()(P,f),qze()(P,w,y,i),$ze()(P,f,y,i),Xze()(P,w,i,y,f,M),Zze()(P,w,M),Jze()(P,w,i),tWe()(P,f),rWe()(P,f),oWe()(P),o.toFastProperties(P),o.toFastProperties(P.prototype);function ve(W){var ee=new P(f);ee._fulfillmentHandler0=W,ee._rejectionHandler0=W,ee._promise0=W,ee._receiver0=W}return ve({a:1}),ve({b:2}),ve({c:3}),ve(1),ve(function(){}),ve(void 0),ve(!1),ve(new P(f)),M.setBounds(c.firstLineError,o.lastLineError),P}});var N0=z((hir,lWe)=>{"use strict";var aWe;typeof Promise<"u"&&(aWe=Promise);function Uqt(){try{Promise===L8&&(Promise=aWe)}catch{}return L8}var L8=sWe()();L8.noConflict=Uqt;lWe.exports=L8});var GT=z((fir,cWe)=>{"use strict";var $T=Ze("buffer").Buffer;$T.from===void 0&&($T.from=function(t,e,i){return new $T(t,e,i)},$T.alloc=$T.from);cWe.exports=$T});var zae=z((pir,dWe)=>{"use strict";dWe.exports=Ze("stream")});var eP=z((Wae,hWe)=>{"use strict";var F8=Ze("buffer"),bg=F8.Buffer;function uWe(t,e){for(var i in t)e[i]=t[i]}bg.from&&bg.alloc&&bg.allocUnsafe&&bg.allocUnsafeSlow?hWe.exports=F8:(uWe(F8,Wae),Wae.Buffer=XT);function XT(t,e,i){return bg(t,e,i)}uWe(bg,XT);XT.from=function(t,e,i){if(typeof t=="number")throw new TypeError("Argument must not be a number");return bg(t,e,i)};XT.alloc=function(t,e,i){if(typeof t!="number")throw new TypeError("Argument must be a number");var r=bg(t);return e!==void 0?typeof i=="string"?r.fill(e,i):r.fill(e):r.fill(0),r};XT.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return bg(t)};XT.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return F8.SlowBuffer(t)}});var pWe=z((mir,Uae)=>{"use strict";function qqt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var fWe=eP().Buffer,tP=Ze("util");function Yqt(t,e,i){t.copy(e,i)}Uae.exports=function(){function t(){qqt(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(i){var r={data:i,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length},t.prototype.unshift=function(i){var r={data:i,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length},t.prototype.shift=function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(i){if(this.length===0)return"";for(var r=this.head,n=""+r.data;r=r.next;)n+=i+r.data;return n},t.prototype.concat=function(i){if(this.length===0)return fWe.alloc(0);for(var r=fWe.allocUnsafe(i>>>0),n=this.head,o=0;n;)Yqt(n.data,r,o),o+=n.data.length,n=n.next;return r},t}();tP&&tP.inspect&&tP.inspect.custom&&(Uae.exports.prototype[tP.inspect.custom]=function(){var t=tP.inspect({length:this.length});return this.constructor.name+" "+t})});var qae=z((gir,mWe)=>{"use strict";var H8=hs();function $qt(t,e){var i=this,r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,H8.nextTick(B8,this,t)):H8.nextTick(B8,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,H8.nextTick(B8,i,o)):H8.nextTick(B8,i,o):e&&e(o)}),this)}function Gqt(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function B8(t,e){t.emit("error",e)}mWe.exports={destroy:$qt,undestroy:Gqt}});var $ae=z((vir,xWe)=>{"use strict";var iC=hs();xWe.exports=Is;function vWe(t){var e=this;this.next=null,this.entry=null,this.finish=function(){h7t(e,t)}}var Xqt=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:iC.nextTick,KT;Is.WritableState=rP;var bWe=Object.create(Xn());bWe.inherits=Vi();var Kqt={deprecate:tw()},_We=zae(),j8=eP().Buffer,Zqt=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Qqt(t){return j8.from(t)}function Jqt(t){return j8.isBuffer(t)||t instanceof Zqt}var yWe=qae();bWe.inherits(Is,_We);function e7t(){}function rP(t,e){KT=KT||rC(),t=t||{};var i=e instanceof KT;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,n=t.writableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=t.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){a7t(e,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new vWe(this)}rP.prototype.getBuffer=function(){for(var e=this.bufferedRequest,i=[];e;)i.push(e),e=e.next;return i};(function(){try{Object.defineProperty(rP.prototype,"buffer",{get:Kqt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var V8;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(V8=Function.prototype[Symbol.hasInstance],Object.defineProperty(Is,Symbol.hasInstance,{value:function(t){return V8.call(this,t)?!0:this!==Is?!1:t&&t._writableState instanceof rP}})):V8=function(t){return t instanceof this};function Is(t){if(KT=KT||rC(),!V8.call(Is,this)&&!(this instanceof KT))return new Is(t);this._writableState=new rP(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),_We.call(this)}Is.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function t7t(t,e){var i=new Error("write after end");t.emit("error",i),iC.nextTick(e,i)}function i7t(t,e,i,r){var n=!0,o=!1;return i===null?o=new TypeError("May not write null values to stream"):typeof i!="string"&&i!==void 0&&!e.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),iC.nextTick(r,o),n=!1),n}Is.prototype.write=function(t,e,i){var r=this._writableState,n=!1,o=!r.objectMode&&Jqt(t);return o&&!j8.isBuffer(t)&&(t=Qqt(t)),typeof e=="function"&&(i=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),typeof i!="function"&&(i=e7t),r.ended?t7t(this,i):(o||i7t(this,r,t,i))&&(r.pendingcb++,n=n7t(this,r,o,t,e,i)),n};Is.prototype.cork=function(){var t=this._writableState;t.corked++};Is.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&wWe(this,t))};Is.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function r7t(t,e,i){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=j8.from(e,i)),e}Object.defineProperty(Is.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function n7t(t,e,i,r,n,o){if(!i){var s=r7t(e,r,n);r!==s&&(i=!0,n="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var d=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:o,next:null},d?d.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Yae(t,e,!1,a,r,n,o);return c}function Yae(t,e,i,r,n,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,i?t._writev(n,e.onwrite):t._write(n,o,e.onwrite),e.sync=!1}function o7t(t,e,i,r,n){--e.pendingcb,i?(iC.nextTick(n,r),iC.nextTick(iP,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(n(r),t._writableState.errorEmitted=!0,t.emit("error",r),iP(t,e))}function s7t(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function a7t(t,e){var i=t._writableState,r=i.sync,n=i.writecb;if(s7t(i),e)o7t(t,i,r,e,n);else{var o=CWe(i);!o&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest&&wWe(t,i),r?Xqt(gWe,t,i,o,n):gWe(t,i,o,n)}}function gWe(t,e,i,r){i||l7t(t,e),e.pendingcb--,r(),iP(t,e)}function l7t(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function wWe(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,n=new Array(r),o=e.corkedRequestsFree;o.entry=i;for(var s=0,a=!0;i;)n[s]=i,i.isBuf||(a=!1),i=i.next,s+=1;n.allBuffers=a,Yae(t,e,!0,e.length,n,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new vWe(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,d=i.encoding,u=i.callback,h=e.objectMode?1:c.length;if(Yae(t,e,!1,h,c,d,u),i=i.next,e.bufferedRequestCount--,e.writing)break}i===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}Is.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))};Is.prototype._writev=null;Is.prototype.end=function(t,e,i){var r=this._writableState;typeof t=="function"?(i=t,t=null,e=null):typeof e=="function"&&(i=e,e=null),t!=null&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||u7t(this,r,i)};function CWe(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function c7t(t,e){t._final(function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),iP(t,e)})}function d7t(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,iC.nextTick(c7t,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function iP(t,e){var i=CWe(e);return i&&(d7t(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),i}function u7t(t,e,i){e.ending=!0,iP(t,e),i&&(e.finished?iC.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}function h7t(t,e,i){var r=t.entry;for(t.entry=null;r;){var n=r.callback;e.pendingcb--,n(i),r=r.next}e.corkedRequestsFree.next=t}Object.defineProperty(Is.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}});Is.prototype.destroy=yWe.destroy;Is.prototype._undestroy=yWe.undestroy;Is.prototype._destroy=function(t,e){this.end(),e(t)}});var rC=z((bir,RWe)=>{"use strict";var SWe=hs(),f7t=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};RWe.exports=_g;var EWe=Object.create(Xn());EWe.inherits=Vi();var TWe=Kae(),Xae=$ae();EWe.inherits(_g,TWe);for(Gae=f7t(Xae.prototype),z8=0;z8<Gae.length;z8++)W8=Gae[z8],_g.prototype[W8]||(_g.prototype[W8]=Xae.prototype[W8]);var Gae,W8,z8;function _g(t){if(!(this instanceof _g))return new _g(t);TWe.call(this,t),Xae.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",p7t)}Object.defineProperty(_g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function p7t(){this.allowHalfOpen||this._writableState.ended||SWe.nextTick(m7t,this)}function m7t(t){t.end()}Object.defineProperty(_g.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});_g.prototype._destroy=function(t,e){this.push(null),this.end(),SWe.nextTick(e,t)}});var Jae=z(IWe=>{"use strict";var Qae=eP().Buffer,AWe=Qae.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function g7t(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function v7t(t){var e=g7t(t);if(typeof e!="string"&&(Qae.isEncoding===AWe||!AWe(t)))throw new Error("Unknown encoding: "+t);return e||t}IWe.StringDecoder=nP;function nP(t){this.encoding=v7t(t);var e;switch(this.encoding){case"utf16le":this.text=x7t,this.end=S7t,e=4;break;case"utf8":this.fillLast=y7t,e=4;break;case"base64":this.text=E7t,this.end=T7t,e=3;break;default:this.write=R7t,this.end=A7t;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Qae.allocUnsafe(e)}nP.prototype.write=function(t){if(t.length===0)return"";var e,i;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""};nP.prototype.end=C7t;nP.prototype.text=w7t;nP.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function Zae(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function b7t(t,e,i){var r=e.length-1;if(r<i)return 0;var n=Zae(e[r]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--r<i||n===-2?0:(n=Zae(e[r]),n>=0?(n>0&&(t.lastNeed=n-2),n):--r<i||n===-2?0:(n=Zae(e[r]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function _7t(t,e,i){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function y7t(t){var e=this.lastTotal-this.lastNeed,i=_7t(this,t,e);if(i!==void 0)return i;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function w7t(t,e){var i=b7t(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var r=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function C7t(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function x7t(t,e){if((t.length-e)%2===0){var i=t.toString("utf16le",e);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function S7t(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function E7t(t,e){var i=(t.length-e)%3;return i===0?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,i===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function T7t(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function R7t(t){return t.toString(this.encoding)}function A7t(t){return t&&t.length?this.write(t):""}});var Kae=z((wir,jWe)=>{"use strict";var QT=hs();jWe.exports=uo;var I7t=lE(),oP;uo.ReadableState=LWe;var yir=Ze("events").EventEmitter,OWe=function(t,e){return t.listeners(e).length},nle=zae(),sP=eP().Buffer,D7t=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function M7t(t){return sP.from(t)}function k7t(t){return sP.isBuffer(t)||t instanceof D7t}var NWe=Object.create(Xn());NWe.inherits=Vi();var ele=Ze("util"),Jr=void 0;ele&&ele.debuglog?Jr=ele.debuglog("stream"):Jr=function(){};var O7t=pWe(),PWe=qae(),ZT;NWe.inherits(uo,nle);var tle=["error","close","destroy","pause","resume"];function N7t(t,e,i){if(typeof t.prependListener=="function")return t.prependListener(e,i);!t._events||!t._events[e]?t.on(e,i):I7t(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]}function LWe(t,e){oP=oP||rC(),t=t||{};var i=e instanceof oP;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,n=t.readableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new O7t,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(ZT||(ZT=Jae().StringDecoder),this.decoder=new ZT(t.encoding),this.encoding=t.encoding)}function uo(t){if(oP=oP||rC(),!(this instanceof uo))return new uo(t);this._readableState=new LWe(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),nle.call(this)}Object.defineProperty(uo.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}});uo.prototype.destroy=PWe.destroy;uo.prototype._undestroy=PWe.undestroy;uo.prototype._destroy=function(t,e){this.push(null),e(t)};uo.prototype.push=function(t,e){var i=this._readableState,r;return i.objectMode?r=!0:typeof t=="string"&&(e=e||i.defaultEncoding,e!==i.encoding&&(t=sP.from(t,e),e=""),r=!0),FWe(this,t,e,!1,r)};uo.prototype.unshift=function(t){return FWe(this,t,null,!0,!1)};function FWe(t,e,i,r,n){var o=t._readableState;if(e===null)o.reading=!1,H7t(t,o);else{var s;n||(s=P7t(o,e)),s?t.emit("error",s):o.objectMode||e&&e.length>0?(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==sP.prototype&&(e=M7t(e)),r?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):ile(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||e.length!==0?ile(t,o,e,!1):HWe(t,o)):ile(t,o,e,!1))):r||(o.reading=!1)}return L7t(o)}function ile(t,e,i,r){e.flowing&&e.length===0&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,r?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&U8(t)),HWe(t,e)}function P7t(t,e){var i;return!k7t(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(i=new TypeError("Invalid non-string/buffer chunk")),i}function L7t(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}uo.prototype.isPaused=function(){return this._readableState.flowing===!1};uo.prototype.setEncoding=function(t){return ZT||(ZT=Jae().StringDecoder),this._readableState.decoder=new ZT(t),this._readableState.encoding=t,this};var DWe=8388608;function F7t(t){return t>=DWe?t=DWe:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function MWe(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=F7t(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}uo.prototype.read=function(t){Jr("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Jr("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?rle(this):U8(this),null;if(t=MWe(t,e),t===0&&e.ended)return e.length===0&&rle(this),null;var r=e.needReadable;Jr("need readable",r),(e.length===0||e.length-t<e.highWaterMark)&&(r=!0,Jr("length less than watermark",r)),e.ended||e.reading?(r=!1,Jr("reading or ended",r)):r&&(Jr("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=MWe(i,e)));var n;return t>0?n=BWe(t,e):n=null,n===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&rle(this)),n!==null&&this.emit("data",n),n};function H7t(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,U8(t)}}function U8(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(Jr("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?QT.nextTick(kWe,t):kWe(t))}function kWe(t){Jr("emit readable"),t.emit("readable"),ole(t)}function HWe(t,e){e.readingMore||(e.readingMore=!0,QT.nextTick(B7t,t,e))}function B7t(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Jr("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}uo.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};uo.prototype.pipe=function(t,e){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1,Jr("pipe count=%d opts=%j",r.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=n?a:y;r.endEmitted?QT.nextTick(o):i.once("end",o),t.on("unpipe",s);function s(w,x){Jr("onunpipe"),w===i&&x&&x.hasUnpiped===!1&&(x.hasUnpiped=!0,u())}function a(){Jr("onend"),t.end()}var c=V7t(i);t.on("drain",c);var d=!1;function u(){Jr("cleanup"),t.removeListener("close",m),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",f),t.removeListener("unpipe",s),i.removeListener("end",a),i.removeListener("end",y),i.removeListener("data",p),d=!0,r.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}var h=!1;i.on("data",p);function p(w){Jr("ondata"),h=!1;var x=t.write(w);x===!1&&!h&&((r.pipesCount===1&&r.pipes===t||r.pipesCount>1&&VWe(r.pipes,t)!==-1)&&!d&&(Jr("false write response, pause",r.awaitDrain),r.awaitDrain++,h=!0),i.pause())}function f(w){Jr("onerror",w),y(),t.removeListener("error",f),OWe(t,"error")===0&&t.emit("error",w)}N7t(t,"error",f);function m(){t.removeListener("finish",g),y()}t.once("close",m);function g(){Jr("onfinish"),t.removeListener("close",m),y()}t.once("finish",g);function y(){Jr("unpipe"),i.unpipe(t)}return t.emit("pipe",i),r.flowing||(Jr("pipe resume"),i.resume()),t};function V7t(t){return function(){var e=t._readableState;Jr("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&OWe(t,"data")&&(e.flowing=!0,ole(t))}}uo.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<n;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=VWe(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i),this)};uo.prototype.on=function(t,e){var i=nle.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var r=this._readableState;!r.endEmitted&&!r.readableListening&&(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&U8(this):QT.nextTick(j7t,this))}return i};uo.prototype.addListener=uo.prototype.on;function j7t(t){Jr("readable nexttick read 0"),t.read(0)}uo.prototype.resume=function(){var t=this._readableState;return t.flowing||(Jr("resume"),t.flowing=!0,z7t(this,t)),this};function z7t(t,e){e.resumeScheduled||(e.resumeScheduled=!0,QT.nextTick(W7t,t,e))}function W7t(t,e){e.reading||(Jr("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),ole(t),e.flowing&&!e.reading&&t.read(0)}uo.prototype.pause=function(){return Jr("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Jr("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function ole(t){var e=t._readableState;for(Jr("flow",e.flowing);e.flowing&&t.read()!==null;);}uo.prototype.wrap=function(t){var e=this,i=this._readableState,r=!1;t.on("end",function(){if(Jr("wrapped end"),i.decoder&&!i.ended){var s=i.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(Jr("wrapped data"),i.decoder&&(s=i.decoder.write(s)),!(i.objectMode&&s==null)&&!(!i.objectMode&&(!s||!s.length))){var a=e.push(s);a||(r=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(s){return function(){return t[s].apply(t,arguments)}}(n));for(var o=0;o<tle.length;o++)t.on(tle[o],this.emit.bind(this,tle[o]));return this._read=function(s){Jr("wrapped _read",s),r&&(r=!1,t.resume())},this};Object.defineProperty(uo.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});uo._fromList=BWe;function BWe(t,e){if(e.length===0)return null;var i;return e.objectMode?i=e.buffer.shift():!t||t>=e.length?(e.decoder?i=e.buffer.join(""):e.buffer.length===1?i=e.buffer.head.data:i=e.buffer.concat(e.length),e.buffer.clear()):i=U7t(t,e.buffer,e.decoder),i}function U7t(t,e,i){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?r=e.shift():r=i?q7t(t,e):Y7t(t,e),r}function q7t(t,e){var i=e.head,r=1,n=i.data;for(t-=n.length;i=i.next;){var o=i.data,s=t>o.length?o.length:t;if(s===o.length?n+=o:n+=o.slice(0,t),t-=s,t===0){s===o.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=o.slice(s));break}++r}return e.length-=r,n}function Y7t(t,e){var i=sP.allocUnsafe(t),r=e.head,n=1;for(r.data.copy(i),t-=r.data.length;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,s),t-=s,t===0){s===o.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++n}return e.length-=n,i}function rle(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,QT.nextTick($7t,e,t))}function $7t(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function VWe(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}});var sle=z((Cir,UWe)=>{"use strict";UWe.exports=yg;var q8=rC(),WWe=Object.create(Xn());WWe.inherits=Vi();WWe.inherits(yg,q8);function G7t(t,e){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,e!=null&&this.push(e),r(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function yg(t){if(!(this instanceof yg))return new yg(t);q8.call(this,t),this._transformState={afterTransform:G7t.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",X7t)}function X7t(){var t=this;typeof this._flush=="function"?this._flush(function(e,i){zWe(t,e,i)}):zWe(this,null,null)}yg.prototype.push=function(t,e){return this._transformState.needTransform=!1,q8.prototype.push.call(this,t,e)};yg.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")};yg.prototype._write=function(t,e,i){var r=this._transformState;if(r.writecb=i,r.writechunk=t,r.writeencoding=e,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};yg.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};yg.prototype._destroy=function(t,e){var i=this;q8.prototype._destroy.call(this,t,function(r){e(r),i.emit("close")})};function zWe(t,e,i){if(e)return t.emit("error",e);if(i!=null&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var GWe=z((xir,$We)=>{"use strict";$We.exports=aP;var qWe=sle(),YWe=Object.create(Xn());YWe.inherits=Vi();YWe.inherits(aP,qWe);function aP(t){if(!(this instanceof aP))return new aP(t);qWe.call(this,t)}aP.prototype._transform=function(t,e,i){i(null,t)}});var wg=z((Ya,Y8)=>{"use strict";var Tp=Ze("stream");process.env.READABLE_STREAM==="disable"&&Tp?(Y8.exports=Tp,Ya=Y8.exports=Tp.Readable,Ya.Readable=Tp.Readable,Ya.Writable=Tp.Writable,Ya.Duplex=Tp.Duplex,Ya.Transform=Tp.Transform,Ya.PassThrough=Tp.PassThrough,Ya.Stream=Tp):(Ya=Y8.exports=Kae(),Ya.Stream=Tp||Ya,Ya.Readable=Ya,Ya.Writable=$ae(),Ya.Duplex=rC(),Ya.Transform=sle(),Ya.PassThrough=GWe())});var G8=z((Sir,XWe)=>{"use strict";var nC=Ze("stream"),ale=N0(),K7t=Ze("util"),$8=GT(),Z7t="function";(!nC.Writable||!nC.Writable.prototype.destroy)&&(nC=wg());function P0(){if(!(this instanceof P0))return new P0;nC.Duplex.call(this,{decodeStrings:!1,objectMode:!0}),this.buffer=$8.from("");var t=this;t.on("finish",function(){t.finished=!0,t.emit("chunk",!1)})}K7t.inherits(P0,nC.Duplex);P0.prototype._write=function(t,e,i){this.buffer=$8.concat([this.buffer,t]),this.cb=i,this.emit("chunk")};P0.prototype.stream=function(t,e){var i=nC.PassThrough(),r,n=this;function o(){if(typeof n.cb===Z7t){var a=n.cb;return n.cb=void 0,a()}}function s(){var a;if(n.buffer&&n.buffer.length){if(typeof t=="number")a=n.buffer.slice(0,t),n.buffer=n.buffer.slice(t),t-=a.length,r=!t;else{var c=n.buffer.indexOf(t);if(c!==-1)n.match=c,e&&(c=c+t.length),a=n.buffer.slice(0,c),n.buffer=n.buffer.slice(c),r=!0;else{var d=n.buffer.length-t.length;d<=0?o():(a=n.buffer.slice(0,d),n.buffer=n.buffer.slice(d))}}a&&i.write(a,function(){(n.buffer.length===0||t.length&&n.buffer.length<=t.length)&&o()})}if(r)n.removeListener("chunk",s),i.end();else if(n.finished){n.removeListener("chunk",s),n.emit("error",new Error("FILE_ENDED"));return}}return n.on("chunk",s),s(),i};P0.prototype.pull=function(t,e){if(t===0)return ale.resolve("");if(!isNaN(t)&&this.buffer.length>t){var i=this.buffer.slice(0,t);return this.buffer=this.buffer.slice(t),ale.resolve(i)}var r=$8.from(""),n=this,o=nC.Transform();o._transform=function(c,d,u){r=$8.concat([r,c]),u()};var s,a;return new ale(function(c,d){if(s=d,a=function(u){n.__emittedError=u,d(u)},n.finished)return d(new Error("FILE_ENDED"));n.once("error",a),n.stream(t,e).on("error",d).pipe(o).on("finish",function(){c(r)}).on("error",d)}).finally(function(){n.removeListener("error",s),n.removeListener("error",a)})};P0.prototype._read=function(){};XWe.exports=P0});var ZWe=z((Eir,KWe)=>{"use strict";var lP=Ze("stream"),Q7t=Ze("util");(!lP.Writable||!lP.Writable.prototype.destroy)&&(lP=wg());function cP(){if(!(this instanceof cP))return new cP;lP.Transform.call(this)}Q7t.inherits(cP,lP.Transform);cP.prototype._transform=function(t,e,i){i()};KWe.exports=cP});var K8=z((Tir,QWe)=>{"use strict";var J7t=N0(),X8=Ze("stream"),e9t=GT();(!X8.Writable||!X8.Writable.prototype.destroy)&&(X8=wg());QWe.exports=function(t){return new J7t(function(e,i){var r=[],n=X8.Transform().on("finish",function(){e(e9t.concat(r))}).on("error",i);n._transform=function(o,s,a){r.push(o),a()},t.on("error",i).pipe(n)})}});var Z8=z((Rir,JWe)=>{"use strict";var t9t=ZN();JWe.exports=function(t,e){for(var i;!i&&t&&t.length;){var r=t9t.parse(t).word16lu("signature").word16lu("partsize").word64lu("uncompressedSize").word64lu("compressedSize").word64lu("offset").word64lu("disknum").vars;r.signature===1?i=r:t=t.slice(r.partsize+4)}return i=i||{},e.compressedSize===4294967295&&(e.compressedSize=i.compressedSize),e.uncompressedSize===4294967295&&(e.uncompressedSize=i.uncompressedSize),e.offsetToLocalFileHeader===4294967295&&(e.offsetToLocalFileHeader=i.offset),i}});var Q8=z((Air,eUe)=>{"use strict";eUe.exports=function(e,i){let r=e&31,n=e>>5&15,o=(e>>9&127)+1980,s=i?(i&31)*2:0,a=i?i>>5&63:0,c=i?i>>11:0;return new Date(Date.UTC(o,n-1,r,c,a,s))}});var J8=z((Iir,nUe)=>{"use strict";var i9t=Ze("util"),r9t=Ze("zlib"),dP=Ze("stream"),uP=ZN(),lle=N0(),tUe=G8(),n9t=ZWe(),o9t=K8(),s9t=Z8(),iUe=GT(),a9t=Q8();(!dP.Writable||!dP.Writable.prototype.destroy)&&(dP=wg());var rUe=iUe.alloc(4);rUe.writeUInt32LE(101010256,0);function Oh(t){if(!(this instanceof Oh))return new Oh(t);var e=this;e._opts=t||{verbose:!1},tUe.call(e,e._opts),e.on("finish",function(){e.emit("end"),e.emit("close")}),e._readRecord().catch(function(i){(!e.__emittedError||e.__emittedError!==i)&&e.emit("error",i)})}i9t.inherits(Oh,tUe);Oh.prototype._readRecord=function(){var t=this;return t.pull(4).then(function(e){if(e.length!==0){var i=e.readUInt32LE(0);if(i===875721283)return t._readCrxHeader();if(i===67324752)return t._readFile();if(i===33639248)return t.reachedCD=!0,t._readCentralDirectoryFileHeader();if(i===101010256)return t._readEndOfCentralDirectoryRecord();if(t.reachedCD){var r=!0;return t.pull(rUe,r).then(function(){return t._readEndOfCentralDirectoryRecord()})}else t.emit("error",new Error("invalid signature: 0x"+i.toString(16)))}})};Oh.prototype._readCrxHeader=function(){var t=this;return t.pull(12).then(function(e){return t.crxHeader=uP.parse(e).word32lu("version").word32lu("pubKeyLength").word32lu("signatureLength").vars,t.pull(t.crxHeader.pubKeyLength+t.crxHeader.signatureLength)}).then(function(e){return t.crxHeader.publicKey=e.slice(0,t.crxHeader.pubKeyLength),t.crxHeader.signature=e.slice(t.crxHeader.pubKeyLength),t.emit("crx-header",t.crxHeader),t._readRecord()})};Oh.prototype._readFile=function(){var t=this;return t.pull(26).then(function(e){var i=uP.parse(e).word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;return i.lastModifiedDateTime=a9t(i.lastModifiedDate,i.lastModifiedTime),t.crxHeader&&(i.crxHeader=t.crxHeader),t.pull(i.fileNameLength).then(function(r){var n=r.toString("utf8"),o=dP.PassThrough(),s=!1;return o.autodrain=function(){s=!0;var a=o.pipe(n9t());return a.promise=function(){return new lle(function(c,d){a.on("finish",c),a.on("error",d)})},a},o.buffer=function(){return o9t(o)},o.path=n,o.props={},o.props.path=n,o.props.pathBuffer=r,o.props.flags={isUnicode:(i.flags&2048)!=0},o.type=i.uncompressedSize===0&&/[\/\\]$/.test(n)?"Directory":"File",t._opts.verbose&&(o.type==="Directory"?console.log("   creating:",n):o.type==="File"&&(i.compressionMethod===0?console.log(" extracting:",n):console.log("  inflating:",n))),t.pull(i.extraFieldLength).then(function(a){var c=s9t(a,i);o.vars=i,o.extra=c,t._opts.forceStream?t.push(o):(t.emit("entry",o),(t._readableState.pipesCount||t._readableState.pipes&&t._readableState.pipes.length)&&t.push(o)),t._opts.verbose&&console.log({filename:n,vars:i,extra:c});var d=!(i.flags&8)||i.compressedSize>0,u;o.__autodraining=s;var h=i.compressionMethod&&!s?r9t.createInflateRaw():dP.PassThrough();return d?(o.size=i.uncompressedSize,u=i.compressedSize):(u=iUe.alloc(4),u.writeUInt32LE(134695760,0)),new lle(function(p,f){t.stream(u).pipe(h).on("error",function(m){t.emit("error",m)}).pipe(o).on("finish",function(){return d?t._readRecord().then(p).catch(f):t._processDataDescriptor(o).then(p).catch(f)})})})})})};Oh.prototype._processDataDescriptor=function(t){var e=this;return e.pull(16).then(function(i){var r=uP.parse(i).word32lu("dataDescriptorSignature").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").vars;return t.size=r.uncompressedSize,e._readRecord()})};Oh.prototype._readCentralDirectoryFileHeader=function(){var t=this;return t.pull(42).then(function(e){var i=uP.parse(e).word16lu("versionMadeBy").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumber").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("offsetToLocalFileHeader").vars;return t.pull(i.fileNameLength).then(function(r){return i.fileName=r.toString("utf8"),t.pull(i.extraFieldLength)}).then(function(r){return t.pull(i.fileCommentLength)}).then(function(r){return t._readRecord()})})};Oh.prototype._readEndOfCentralDirectoryRecord=function(){var t=this;return t.pull(18).then(function(e){var i=uP.parse(e).word16lu("diskNumber").word16lu("diskStart").word16lu("numberOfRecordsOnDisk").word16lu("numberOfRecords").word32lu("sizeOfCentralDirectory").word32lu("offsetToStartOfCentralDirectory").word16lu("commentLength").vars;return t.pull(i.commentLength).then(function(r){r=r.toString("utf8"),t.end(),t.push(null)})})};Oh.prototype.promise=function(){var t=this;return new lle(function(e,i){t.on("finish",e),t.on("error",i)})};nUe.exports=Oh});var cle=z((Dir,oUe)=>{"use strict";oUe.exports=Ze("stream")});var hP=z((dle,aUe)=>{"use strict";var ez=Ze("buffer"),Cg=ez.Buffer;function sUe(t,e){for(var i in t)e[i]=t[i]}Cg.from&&Cg.alloc&&Cg.allocUnsafe&&Cg.allocUnsafeSlow?aUe.exports=ez:(sUe(ez,dle),dle.Buffer=JT);function JT(t,e,i){return Cg(t,e,i)}sUe(Cg,JT);JT.from=function(t,e,i){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Cg(t,e,i)};JT.alloc=function(t,e,i){if(typeof t!="number")throw new TypeError("Argument must be a number");var r=Cg(t);return e!==void 0?typeof i=="string"?r.fill(e,i):r.fill(e):r.fill(0),r};JT.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Cg(t)};JT.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return ez.SlowBuffer(t)}});var cUe=z((Mir,ule)=>{"use strict";function l9t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var lUe=hP().Buffer,fP=Ze("util");function c9t(t,e,i){t.copy(e,i)}ule.exports=function(){function t(){l9t(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(i){var r={data:i,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length},t.prototype.unshift=function(i){var r={data:i,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length},t.prototype.shift=function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(i){if(this.length===0)return"";for(var r=this.head,n=""+r.data;r=r.next;)n+=i+r.data;return n},t.prototype.concat=function(i){if(this.length===0)return lUe.alloc(0);for(var r=lUe.allocUnsafe(i>>>0),n=this.head,o=0;n;)c9t(n.data,r,o),o+=n.data.length,n=n.next;return r},t}();fP&&fP.inspect&&fP.inspect.custom&&(ule.exports.prototype[fP.inspect.custom]=function(){var t=fP.inspect({length:this.length});return this.constructor.name+" "+t})});var hle=z((kir,dUe)=>{"use strict";var tz=hs();function d9t(t,e){var i=this,r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,tz.nextTick(iz,this,t)):tz.nextTick(iz,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,tz.nextTick(iz,i,o)):tz.nextTick(iz,i,o):e&&e(o)}),this)}function u9t(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function iz(t,e){t.emit("error",e)}dUe.exports={destroy:d9t,undestroy:u9t}});var ple=z((Oir,bUe)=>{"use strict";var oC=hs();bUe.exports=Ds;function hUe(t){var e=this;this.next=null,this.entry=null,this.finish=function(){I9t(e,t)}}var h9t=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:oC.nextTick,eR;Ds.WritableState=mP;var fUe=Object.create(Xn());fUe.inherits=Vi();var f9t={deprecate:tw()},pUe=cle(),nz=hP().Buffer,p9t=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function m9t(t){return nz.from(t)}function g9t(t){return nz.isBuffer(t)||t instanceof p9t}var mUe=hle();fUe.inherits(Ds,pUe);function v9t(){}function mP(t,e){eR=eR||sC(),t=t||{};var i=e instanceof eR;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,n=t.writableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=t.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){S9t(e,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new hUe(this)}mP.prototype.getBuffer=function(){for(var e=this.bufferedRequest,i=[];e;)i.push(e),e=e.next;return i};(function(){try{Object.defineProperty(mP.prototype,"buffer",{get:f9t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var rz;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(rz=Function.prototype[Symbol.hasInstance],Object.defineProperty(Ds,Symbol.hasInstance,{value:function(t){return rz.call(this,t)?!0:this!==Ds?!1:t&&t._writableState instanceof mP}})):rz=function(t){return t instanceof this};function Ds(t){if(eR=eR||sC(),!rz.call(Ds,this)&&!(this instanceof eR))return new Ds(t);this._writableState=new mP(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),pUe.call(this)}Ds.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function b9t(t,e){var i=new Error("write after end");t.emit("error",i),oC.nextTick(e,i)}function _9t(t,e,i,r){var n=!0,o=!1;return i===null?o=new TypeError("May not write null values to stream"):typeof i!="string"&&i!==void 0&&!e.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),oC.nextTick(r,o),n=!1),n}Ds.prototype.write=function(t,e,i){var r=this._writableState,n=!1,o=!r.objectMode&&g9t(t);return o&&!nz.isBuffer(t)&&(t=m9t(t)),typeof e=="function"&&(i=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),typeof i!="function"&&(i=v9t),r.ended?b9t(this,i):(o||_9t(this,r,t,i))&&(r.pendingcb++,n=w9t(this,r,o,t,e,i)),n};Ds.prototype.cork=function(){var t=this._writableState;t.corked++};Ds.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&gUe(this,t))};Ds.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function y9t(t,e,i){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=nz.from(e,i)),e}Object.defineProperty(Ds.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function w9t(t,e,i,r,n,o){if(!i){var s=y9t(e,r,n);r!==s&&(i=!0,n="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var d=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:o,next:null},d?d.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else fle(t,e,!1,a,r,n,o);return c}function fle(t,e,i,r,n,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,i?t._writev(n,e.onwrite):t._write(n,o,e.onwrite),e.sync=!1}function C9t(t,e,i,r,n){--e.pendingcb,i?(oC.nextTick(n,r),oC.nextTick(pP,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(n(r),t._writableState.errorEmitted=!0,t.emit("error",r),pP(t,e))}function x9t(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function S9t(t,e){var i=t._writableState,r=i.sync,n=i.writecb;if(x9t(i),e)C9t(t,i,r,e,n);else{var o=vUe(i);!o&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest&&gUe(t,i),r?h9t(uUe,t,i,o,n):uUe(t,i,o,n)}}function uUe(t,e,i,r){i||E9t(t,e),e.pendingcb--,r(),pP(t,e)}function E9t(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function gUe(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,n=new Array(r),o=e.corkedRequestsFree;o.entry=i;for(var s=0,a=!0;i;)n[s]=i,i.isBuf||(a=!1),i=i.next,s+=1;n.allBuffers=a,fle(t,e,!0,e.length,n,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new hUe(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,d=i.encoding,u=i.callback,h=e.objectMode?1:c.length;if(fle(t,e,!1,h,c,d,u),i=i.next,e.bufferedRequestCount--,e.writing)break}i===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}Ds.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))};Ds.prototype._writev=null;Ds.prototype.end=function(t,e,i){var r=this._writableState;typeof t=="function"?(i=t,t=null,e=null):typeof e=="function"&&(i=e,e=null),t!=null&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||A9t(this,r,i)};function vUe(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function T9t(t,e){t._final(function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),pP(t,e)})}function R9t(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,oC.nextTick(T9t,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function pP(t,e){var i=vUe(e);return i&&(R9t(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),i}function A9t(t,e,i){e.ending=!0,pP(t,e),i&&(e.finished?oC.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}function I9t(t,e,i){var r=t.entry;for(t.entry=null;r;){var n=r.callback;e.pendingcb--,n(i),r=r.next}e.corkedRequestsFree.next=t}Object.defineProperty(Ds.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}});Ds.prototype.destroy=mUe.destroy;Ds.prototype._undestroy=mUe.undestroy;Ds.prototype._destroy=function(t,e){this.end(),e(t)}});var sC=z((Nir,CUe)=>{"use strict";var _Ue=hs(),D9t=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};CUe.exports=xg;var yUe=Object.create(Xn());yUe.inherits=Vi();var wUe=vle(),gle=ple();yUe.inherits(xg,wUe);for(mle=D9t(gle.prototype),oz=0;oz<mle.length;oz++)sz=mle[oz],xg.prototype[sz]||(xg.prototype[sz]=gle.prototype[sz]);var mle,sz,oz;function xg(t){if(!(this instanceof xg))return new xg(t);wUe.call(this,t),gle.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",M9t)}Object.defineProperty(xg.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function M9t(){this.allowHalfOpen||this._writableState.ended||_Ue.nextTick(k9t,this)}function k9t(t){t.end()}Object.defineProperty(xg.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});xg.prototype._destroy=function(t,e){this.push(null),this.end(),_Ue.nextTick(e,t)}});var yle=z(SUe=>{"use strict";var _le=hP().Buffer,xUe=_le.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function O9t(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function N9t(t){var e=O9t(t);if(typeof e!="string"&&(_le.isEncoding===xUe||!xUe(t)))throw new Error("Unknown encoding: "+t);return e||t}SUe.StringDecoder=gP;function gP(t){this.encoding=N9t(t);var e;switch(this.encoding){case"utf16le":this.text=V9t,this.end=j9t,e=4;break;case"utf8":this.fillLast=F9t,e=4;break;case"base64":this.text=z9t,this.end=W9t,e=3;break;default:this.write=U9t,this.end=q9t;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=_le.allocUnsafe(e)}gP.prototype.write=function(t){if(t.length===0)return"";var e,i;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""};gP.prototype.end=B9t;gP.prototype.text=H9t;gP.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function ble(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function P9t(t,e,i){var r=e.length-1;if(r<i)return 0;var n=ble(e[r]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--r<i||n===-2?0:(n=ble(e[r]),n>=0?(n>0&&(t.lastNeed=n-2),n):--r<i||n===-2?0:(n=ble(e[r]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function L9t(t,e,i){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function F9t(t){var e=this.lastTotal-this.lastNeed,i=L9t(this,t,e);if(i!==void 0)return i;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function H9t(t,e){var i=P9t(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var r=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function B9t(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function V9t(t,e){if((t.length-e)%2===0){var i=t.toString("utf16le",e);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function j9t(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function z9t(t,e){var i=(t.length-e)%3;return i===0?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,i===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function W9t(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function U9t(t){return t.toString(this.encoding)}function q9t(t){return t&&t.length?this.write(t):""}});var vle=z((Fir,LUe)=>{"use strict";var iR=hs();LUe.exports=ho;var Y9t=lE(),vP;ho.ReadableState=MUe;var Lir=Ze("events").EventEmitter,AUe=function(t,e){return t.listeners(e).length},Ele=cle(),bP=hP().Buffer,$9t=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function G9t(t){return bP.from(t)}function X9t(t){return bP.isBuffer(t)||t instanceof $9t}var IUe=Object.create(Xn());IUe.inherits=Vi();var wle=Ze("util"),en=void 0;wle&&wle.debuglog?en=wle.debuglog("stream"):en=function(){};var K9t=cUe(),DUe=hle(),tR;IUe.inherits(ho,Ele);var Cle=["error","close","destroy","pause","resume"];function Z9t(t,e,i){if(typeof t.prependListener=="function")return t.prependListener(e,i);!t._events||!t._events[e]?t.on(e,i):Y9t(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]}function MUe(t,e){vP=vP||sC(),t=t||{};var i=e instanceof vP;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,n=t.readableHighWaterMark,o=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new K9t,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(tR||(tR=yle().StringDecoder),this.decoder=new tR(t.encoding),this.encoding=t.encoding)}function ho(t){if(vP=vP||sC(),!(this instanceof ho))return new ho(t);this._readableState=new MUe(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),Ele.call(this)}Object.defineProperty(ho.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}});ho.prototype.destroy=DUe.destroy;ho.prototype._undestroy=DUe.undestroy;ho.prototype._destroy=function(t,e){this.push(null),e(t)};ho.prototype.push=function(t,e){var i=this._readableState,r;return i.objectMode?r=!0:typeof t=="string"&&(e=e||i.defaultEncoding,e!==i.encoding&&(t=bP.from(t,e),e=""),r=!0),kUe(this,t,e,!1,r)};ho.prototype.unshift=function(t){return kUe(this,t,null,!0,!1)};function kUe(t,e,i,r,n){var o=t._readableState;if(e===null)o.reading=!1,tYt(t,o);else{var s;n||(s=Q9t(o,e)),s?t.emit("error",s):o.objectMode||e&&e.length>0?(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==bP.prototype&&(e=G9t(e)),r?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):xle(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||e.length!==0?xle(t,o,e,!1):OUe(t,o)):xle(t,o,e,!1))):r||(o.reading=!1)}return J9t(o)}function xle(t,e,i,r){e.flowing&&e.length===0&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,r?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&az(t)),OUe(t,e)}function Q9t(t,e){var i;return!X9t(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(i=new TypeError("Invalid non-string/buffer chunk")),i}function J9t(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}ho.prototype.isPaused=function(){return this._readableState.flowing===!1};ho.prototype.setEncoding=function(t){return tR||(tR=yle().StringDecoder),this._readableState.decoder=new tR(t),this._readableState.encoding=t,this};var EUe=8388608;function eYt(t){return t>=EUe?t=EUe:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function TUe(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=eYt(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}ho.prototype.read=function(t){en("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return en("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Sle(this):az(this),null;if(t=TUe(t,e),t===0&&e.ended)return e.length===0&&Sle(this),null;var r=e.needReadable;en("need readable",r),(e.length===0||e.length-t<e.highWaterMark)&&(r=!0,en("length less than watermark",r)),e.ended||e.reading?(r=!1,en("reading or ended",r)):r&&(en("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=TUe(i,e)));var n;return t>0?n=NUe(t,e):n=null,n===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&Sle(this)),n!==null&&this.emit("data",n),n};function tYt(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,az(t)}}function az(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(en("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?iR.nextTick(RUe,t):RUe(t))}function RUe(t){en("emit readable"),t.emit("readable"),Tle(t)}function OUe(t,e){e.readingMore||(e.readingMore=!0,iR.nextTick(iYt,t,e))}function iYt(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(en("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}ho.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};ho.prototype.pipe=function(t,e){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1,en("pipe count=%d opts=%j",r.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=n?a:y;r.endEmitted?iR.nextTick(o):i.once("end",o),t.on("unpipe",s);function s(w,x){en("onunpipe"),w===i&&x&&x.hasUnpiped===!1&&(x.hasUnpiped=!0,u())}function a(){en("onend"),t.end()}var c=rYt(i);t.on("drain",c);var d=!1;function u(){en("cleanup"),t.removeListener("close",m),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",f),t.removeListener("unpipe",s),i.removeListener("end",a),i.removeListener("end",y),i.removeListener("data",p),d=!0,r.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}var h=!1;i.on("data",p);function p(w){en("ondata"),h=!1;var x=t.write(w);x===!1&&!h&&((r.pipesCount===1&&r.pipes===t||r.pipesCount>1&&PUe(r.pipes,t)!==-1)&&!d&&(en("false write response, pause",r.awaitDrain),r.awaitDrain++,h=!0),i.pause())}function f(w){en("onerror",w),y(),t.removeListener("error",f),AUe(t,"error")===0&&t.emit("error",w)}Z9t(t,"error",f);function m(){t.removeListener("finish",g),y()}t.once("close",m);function g(){en("onfinish"),t.removeListener("close",m),y()}t.once("finish",g);function y(){en("unpipe"),i.unpipe(t)}return t.emit("pipe",i),r.flowing||(en("pipe resume"),i.resume()),t};function rYt(t){return function(){var e=t._readableState;en("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&AUe(t,"data")&&(e.flowing=!0,Tle(t))}}ho.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<n;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=PUe(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i),this)};ho.prototype.on=function(t,e){var i=Ele.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var r=this._readableState;!r.endEmitted&&!r.readableListening&&(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&az(this):iR.nextTick(nYt,this))}return i};ho.prototype.addListener=ho.prototype.on;function nYt(t){en("readable nexttick read 0"),t.read(0)}ho.prototype.resume=function(){var t=this._readableState;return t.flowing||(en("resume"),t.flowing=!0,oYt(this,t)),this};function oYt(t,e){e.resumeScheduled||(e.resumeScheduled=!0,iR.nextTick(sYt,t,e))}function sYt(t,e){e.reading||(en("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),Tle(t),e.flowing&&!e.reading&&t.read(0)}ho.prototype.pause=function(){return en("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(en("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function Tle(t){var e=t._readableState;for(en("flow",e.flowing);e.flowing&&t.read()!==null;);}ho.prototype.wrap=function(t){var e=this,i=this._readableState,r=!1;t.on("end",function(){if(en("wrapped end"),i.decoder&&!i.ended){var s=i.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(en("wrapped data"),i.decoder&&(s=i.decoder.write(s)),!(i.objectMode&&s==null)&&!(!i.objectMode&&(!s||!s.length))){var a=e.push(s);a||(r=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(s){return function(){return t[s].apply(t,arguments)}}(n));for(var o=0;o<Cle.length;o++)t.on(Cle[o],this.emit.bind(this,Cle[o]));return this._read=function(s){en("wrapped _read",s),r&&(r=!1,t.resume())},this};Object.defineProperty(ho.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});ho._fromList=NUe;function NUe(t,e){if(e.length===0)return null;var i;return e.objectMode?i=e.buffer.shift():!t||t>=e.length?(e.decoder?i=e.buffer.join(""):e.buffer.length===1?i=e.buffer.head.data:i=e.buffer.concat(e.length),e.buffer.clear()):i=aYt(t,e.buffer,e.decoder),i}function aYt(t,e,i){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?r=e.shift():r=i?lYt(t,e):cYt(t,e),r}function lYt(t,e){var i=e.head,r=1,n=i.data;for(t-=n.length;i=i.next;){var o=i.data,s=t>o.length?o.length:t;if(s===o.length?n+=o:n+=o.slice(0,t),t-=s,t===0){s===o.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=o.slice(s));break}++r}return e.length-=r,n}function cYt(t,e){var i=bP.allocUnsafe(t),r=e.head,n=1;for(r.data.copy(i),t-=r.data.length;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,s),t-=s,t===0){s===o.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++n}return e.length-=n,i}function Sle(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,iR.nextTick(dYt,e,t))}function dYt(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function PUe(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}});var Rle=z((Hir,BUe)=>{"use strict";BUe.exports=Sg;var lz=sC(),HUe=Object.create(Xn());HUe.inherits=Vi();HUe.inherits(Sg,lz);function uYt(t,e){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,e!=null&&this.push(e),r(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function Sg(t){if(!(this instanceof Sg))return new Sg(t);lz.call(this,t),this._transformState={afterTransform:uYt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",hYt)}function hYt(){var t=this;typeof this._flush=="function"?this._flush(function(e,i){FUe(t,e,i)}):FUe(this,null,null)}Sg.prototype.push=function(t,e){return this._transformState.needTransform=!1,lz.prototype.push.call(this,t,e)};Sg.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")};Sg.prototype._write=function(t,e,i){var r=this._transformState;if(r.writecb=i,r.writechunk=t,r.writeencoding=e,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};Sg.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Sg.prototype._destroy=function(t,e){var i=this;lz.prototype._destroy.call(this,t,function(r){e(r),i.emit("close")})};function FUe(t,e,i){if(e)return t.emit("error",e);if(i!=null&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var WUe=z((Bir,zUe)=>{"use strict";zUe.exports=_P;var VUe=Rle(),jUe=Object.create(Xn());jUe.inherits=Vi();jUe.inherits(_P,VUe);function _P(t){if(!(this instanceof _P))return new _P(t);VUe.call(this,t)}_P.prototype._transform=function(t,e,i){i(null,t)}});var UUe=z(($a,cz)=>{"use strict";var Rp=Ze("stream");process.env.READABLE_STREAM==="disable"&&Rp?(cz.exports=Rp,$a=cz.exports=Rp.Readable,$a.Readable=Rp.Readable,$a.Writable=Rp.Writable,$a.Duplex=Rp.Duplex,$a.Transform=Rp.Transform,$a.PassThrough=Rp.PassThrough,$a.Stream=Rp):($a=cz.exports=vle(),$a.Stream=Rp||$a,$a.Readable=$a,$a.Writable=ple(),$a.Duplex=sC(),$a.Transform=Rle(),$a.PassThrough=WUe())});var Dle=z((Vir,Ile)=>{"use strict";var Ale=UUe();function rR(t,e,i){typeof i>"u"&&(i=e,e=t,t=null),Ale.Duplex.call(this,t),typeof i.read!="function"&&(i=new Ale.Readable(t).wrap(i)),this._writable=e,this._readable=i,this._waiting=!1;var r=this;e.once("finish",function(){r.end()}),this.once("finish",function(){e.end()}),i.on("readable",function(){r._waiting&&(r._waiting=!1,r._read())}),i.once("end",function(){r.push(null)}),(!t||typeof t.bubbleErrors>"u"||t.bubbleErrors)&&(e.on("error",function(n){r.emit("error",n)}),i.on("error",function(n){r.emit("error",n)}))}rR.prototype=Object.create(Ale.Duplex.prototype,{constructor:{value:rR}});rR.prototype._write=function(e,i,r){this._writable.write(e,i,r)};rR.prototype._read=function(){for(var e,i=0;(e=this._readable.read())!==null;)this.push(e),i++;i===0&&(this._waiting=!0)};Ile.exports=function(e,i,r){return new rR(e,i,r)};Ile.exports.DuplexWrapper=rR});var YUe=z((jir,qUe)=>{"use strict";var nR=Ze("stream"),fYt=J8(),pYt=Dle(),mYt=K8();(!nR.Writable||!nR.Writable.prototype.destroy)&&(nR=wg());function gYt(t,e){var i=nR.PassThrough({objectMode:!0}),r=nR.PassThrough(),n=nR.Transform({objectMode:!0}),o=t instanceof RegExp?t:t&&new RegExp(t),s;n._transform=function(c,d,u){if(s||o&&!o.exec(c.path))return c.autodrain(),u();s=!0,a.emit("entry",c),c.on("error",function(h){r.emit("error",h)}),c.pipe(r).on("error",function(h){u(h)}).on("finish",function(h){u(null,h)})},i.pipe(fYt(e)).on("error",function(c){r.emit("error",c)}).pipe(n).on("error",Object).on("finish",function(){s?r.end():r.emit("error",new Error("PATTERN_NOT_FOUND"))});var a=pYt(i,r);return a.buffer=function(){return mYt(r)},a}qUe.exports=gYt});var dz=z((zir,GUe)=>{"use strict";GUe.exports=L0;var Mle=Ze("stream").Stream,vYt=Vi();function L0(){Mle.call(this)}vYt(L0,Mle);L0.prototype.on=function(t,e){return t==="ready"&&this.ready?process.nextTick(e.bind(this)):Mle.prototype.on.call(this,t,e),this};L0.prototype.abort=function(){this._aborted=!0,this.emit("abort")};L0.prototype.destroy=function(){};L0.prototype.warn=function(t,e){var i=this,r=$Ue(t,e,i);i.listeners("warn")?i.emit("warn",r):console.error(`%s %s
path = %s
syscall = %s
fstream_type = %s
fstream_path = %s
fstream_unc_path = %s
fstream_class = %s
fstream_stack =
%s
`,e||"UNKNOWN",r.stack,r.path,r.syscall,r.fstream_type,r.fstream_path,r.fstream_unc_path,r.fstream_class,r.fstream_stack.join(`
`))};L0.prototype.info=function(t,e){this.emit("info",t,e)};L0.prototype.error=function(t,e,i){var r=$Ue(t,e,this);if(i)throw r;this.emit("error",r)};function $Ue(t,e,i){return t instanceof Error||(t=new Error(t)),t.code=t.code||e,t.path=t.path||i.path,t.fstream_type=t.fstream_type||i.type,t.fstream_path=t.fstream_path||i.path,i._path!==i.path&&(t.fstream_unc_path=t.fstream_unc_path||i._path),i.linkpath&&(t.fstream_linkpath=t.fstream_linkpath||i.linkpath),t.fstream_class=t.fstream_class||i.constructor.name,t.fstream_stack=t.fstream_stack||new Error().stack.split(/\n/).slice(3).map(function(r){return r.replace(/^ {4}at /,"")}),t}});var yP=z((Wir,XUe)=>{"use strict";XUe.exports=bYt;function bYt(t){var e=["Directory","File","SymbolicLink","Link","BlockDevice","CharacterDevice","FIFO","Socket"],i;if(t.type&&e.indexOf(t.type)!==-1)return t[t.type]=!0,t.type;for(var r=0,n=e.length;r<n;r++){i=e[r];var o=t[i]||t["is"+i];if(typeof o=="function"&&(o=o.call(t)),o)return t[i]=!0,t.type=i,i}return null}});var Ole=z((Uir,KUe)=>{"use strict";KUe.exports=wP;var _Yt=jc(),yYt=Vi(),kle=aC();yYt(wP,kle);function wP(t){var e=this;if(!(e instanceof wP))throw new Error("LinkReader must be called as constructor.");if(!(t.type==="Link"&&t.Link||t.type==="SymbolicLink"&&t.SymbolicLink))throw new Error("Non-link type "+t.type);kle.call(e,t)}wP.prototype._stat=function(t){var e=this;_Yt.readlink(e._path,function(i,r){if(i)return e.error(i);e.linkpath=e.props.linkpath=r,e.emit("linkpath",r),kle.prototype._stat.call(e,t)})};wP.prototype._read=function(){var t=this;t._paused||t._ended||(t.emit("end"),t.emit("close"),t._ended=!0)}});var Ple=z((qir,JUe)=>{"use strict";JUe.exports=Ap;var QUe=jc(),wYt=Vi(),CP=Ze("path"),Nle=aC(),ZUe=Ze("assert").ok;wYt(Ap,Nle);function Ap(t){var e=this;if(!(e instanceof Ap))throw new Error("DirReader must be called as constructor.");if(t.type!=="Directory"||!t.Directory)throw new Error("Non-directory type "+t.type);e.entries=null,e._index=-1,e._paused=!1,e._length=-1,t.sort&&(this.sort=t.sort),Nle.call(this,t)}Ap.prototype._getEntries=function(){var t=this;t._gotEntries||(t._gotEntries=!0,QUe.readdir(t._path,function(e,i){if(e)return t.error(e);t.entries=i,t.emit("entries",i),t._paused?t.once("resume",r):r();function r(){t._length=t.entries.length,typeof t.sort=="function"&&(t.entries=t.entries.sort(t.sort.bind(t))),t._read()}}))};Ap.prototype._read=function(){var t=this;if(!t.entries)return t._getEntries();if(!(t._paused||t._currentEntry||t._aborted)){if(t._index++,t._index>=t.entries.length){t._ended||(t._ended=!0,t.emit("end"),t.emit("close"));return}var e=CP.resolve(t._path,t.entries[t._index]);ZUe(e!==t._path),ZUe(t.entries[t._index]),t._currentEntry=e,QUe[t.props.follow?"stat":"lstat"](e,function(i,r){if(i)return t.error(i);var n=t._proxy||t;r.path=e,r.basename=CP.basename(e),r.dirname=CP.dirname(e);var o=t.getChildProps.call(n,r);o.path=e,o.basename=CP.basename(e),o.dirname=CP.dirname(e);var s=Nle(o,r);t._currentEntry=s,s.on("pause",function(d){!t._paused&&!s._disowned&&t.pause(d)}),s.on("resume",function(d){t._paused&&!s._disowned&&t.resume(d)}),s.on("stat",function(d){t.emit("_entryStat",s,d),!s._aborted&&(s._paused?s.once("resume",function(){t.emit("entryStat",s,d)}):t.emit("entryStat",s,d))}),s.on("ready",function d(){if(t._paused)return s.pause(t),t.once("resume",d);s.type==="Socket"?t.emit("socket",s):t.emitEntry(s)});var a=!1;s.on("close",c),s.on("disown",c);function c(){a||(a=!0,t.emit("childEnd",s),t.emit("entryEnd",s),t._currentEntry=null,t._paused||t._read())}s.on("error",function(d){s._swallowErrors?(t.warn(d),s.emit("end"),s.emit("close")):t.emit("error",d)}),["child","childEnd","warn"].forEach(function(d){s.on(d,t.emit.bind(t,d))})})}};Ap.prototype.disown=function(t){t.emit("beforeDisown"),t._disowned=!0,t.parent=t.root=null,t===this._currentEntry&&(this._currentEntry=null),t.emit("disown")};Ap.prototype.getChildProps=function(){return{depth:this.depth+1,root:this.root||this,parent:this,follow:this.follow,filter:this.filter,sort:this.props.sort,hardlinks:this.props.hardlinks}};Ap.prototype.pause=function(t){var e=this;e._paused||(t=t||e,e._paused=!0,e._currentEntry&&e._currentEntry.pause&&e._currentEntry.pause(t),e.emit("pause",t))};Ap.prototype.resume=function(t){var e=this;e._paused&&(t=t||e,e._paused=!1,e.emit("resume",t),!e._paused&&(e._currentEntry?e._currentEntry.resume&&e._currentEntry.resume(t):e._read()))};Ap.prototype.emitEntry=function(t){this.emit("entry",t),this.emit("child",t)}});var Lle=z((Yir,rqe)=>{"use strict";rqe.exports=lC;var CYt=jc(),xYt=Vi(),eqe=aC(),tqe={EOF:!0},iqe={CLOSE:!0};xYt(lC,eqe);function lC(t){var e=this;if(!(e instanceof lC))throw new Error("FileReader must be called as constructor.");if(!(t.type==="Link"&&t.Link||t.type==="File"&&t.File))throw new Error("Non-file type "+t.type);e._buffer=[],e._bytesEmitted=0,eqe.call(e,t)}lC.prototype._getStream=function(){var t=this,e=t._stream=CYt.createReadStream(t._path,t.props);t.props.blksize&&(e.bufferSize=t.props.blksize),e.on("open",t.emit.bind(t,"open")),e.on("data",function(i){if(t._bytesEmitted+=i.length,i.length)t._paused||t._buffer.length?(t._buffer.push(i),t._read()):t.emit("data",i);else return}),e.on("end",function(){t._paused||t._buffer.length?(t._buffer.push(tqe),t._read()):t.emit("end"),t._bytesEmitted!==t.props.size&&t.error(`Didn't get expected byte count
expect: `+t.props.size+`
actual: `+t._bytesEmitted)}),e.on("close",function(){t._paused||t._buffer.length?(t._buffer.push(iqe),t._read()):t.emit("close")}),e.on("error",function(i){t.emit("error",i)}),t._read()};lC.prototype._read=function(){var t=this;if(!t._paused){if(!t._stream)return t._getStream();if(t._buffer.length){for(var e=t._buffer,i=0,r=e.length;i<r;i++){var n=e[i];if(n===tqe?t.emit("end"):n===iqe?t.emit("close"):t.emit("data",n),t._paused){t._buffer=e.slice(i);return}}t._buffer.length=0}}};lC.prototype.pause=function(t){var e=this;e._paused||(t=t||e,e._paused=!0,e._stream&&e._stream.pause(),e.emit("pause",t))};lC.prototype.resume=function(t){var e=this;e._paused&&(t=t||e,e.emit("resume",t),e._paused=!1,e._stream&&e._stream.resume(),e._read())}});var sqe=z(($ir,oqe)=>{"use strict";oqe.exports=uz;var SYt=Vi(),nqe=aC();SYt(uz,nqe);function uz(t){var e=this;if(!(e instanceof uz))throw new Error("SocketReader must be called as constructor.");if(!(t.type==="Socket"&&t.Socket))throw new Error("Non-socket type "+t.type);nqe.call(e,t)}uz.prototype._read=function(){var t=this;t._paused||t._ended||(t.emit("end"),t.emit("close"),t._ended=!0)}});var Hle=z((Gir,aqe)=>{"use strict";aqe.exports=cC;var Fle=aC(),EYt=yP(),TYt=Vi(),RYt=jc();TYt(cC,Fle);function cC(t){var e=this;if(!(e instanceof cC))throw new Error("ProxyReader must be called as constructor.");e.props=t,e._buffer=[],e.ready=!1,Fle.call(e,t)}cC.prototype._stat=function(){var t=this,e=t.props,i=e.follow?"stat":"lstat";RYt[i](e.path,function(r,n){var o;r||!n?o="File":o=EYt(n),e[o]=!0,e.type=t.type=o,t._old=n,t._addProxy(Fle(e,n))})};cC.prototype._addProxy=function(t){var e=this;if(e._proxyTarget)return e.error("proxy already set");e._proxyTarget=t,t._proxy=e,["error","data","end","close","linkpath","entry","entryEnd","child","childEnd","warn","stat"].forEach(function(r){t.on(r,e.emit.bind(e,r))}),e.emit("proxy",t),t.on("ready",function(){e.ready=!0,e.emit("ready")});var i=e._buffer;e._buffer.length=0,i.forEach(function(r){t[r[0]].apply(t,r[1])})};cC.prototype.pause=function(){return this._proxyTarget?this._proxyTarget.pause():!1};cC.prototype.resume=function(){return this._proxyTarget?this._proxyTarget.resume():!1}});var aC=z((Xir,dqe)=>{"use strict";dqe.exports=Nh;var AYt=jc(),IYt=Ze("stream").Stream,DYt=Vi(),Ble=Ze("path"),Vle=yP(),hz=Nh.hardLinks={},lqe=dz();DYt(Nh,lqe);var cqe=Ole();function Nh(t,e){var i=this;if(!(i instanceof Nh))return new Nh(t,e);typeof t=="string"&&(t={path:t});var r,n;switch(t.type&&typeof t.type=="function"?(r=t.type,n=r):(r=Vle(t),n=Nh),e&&!r&&(r=Vle(e),t[r]=!0,t.type=r),r){case"Directory":n=Ple();break;case"Link":case"File":n=Lle();break;case"SymbolicLink":n=cqe;break;case"Socket":n=sqe();break;case null:n=Hle();break}if(!(i instanceof n))return new n(t);lqe.call(i),t.path||i.error("Must provide a path",null,!0),i.readable=!0,i.writable=!1,i.type=r,i.props=t,i.depth=t.depth=t.depth||0,i.parent=t.parent||null,i.root=t.root||t.parent&&t.parent.root||i,i._path=i.path=Ble.resolve(t.path),process.platform==="win32"&&(i.path=i._path=i.path.replace(/\?/g,"_"),i._path.length>=260&&(i._swallowErrors=!0,i._path="\\\\?\\"+i.path.replace(/\//g,"\\"))),i.basename=t.basename=Ble.basename(i.path),i.dirname=t.dirname=Ble.dirname(i.path),t.parent=t.root=null,i.size=t.size,i.filter=typeof t.filter=="function"?t.filter:null,t.sort==="alpha"&&(t.sort=MYt),i._stat(e)}function MYt(t,e){return t===e?0:t.toLowerCase()>e.toLowerCase()?1:t.toLowerCase()<e.toLowerCase()?-1:t>e?1:-1}Nh.prototype._stat=function(t){var e=this,i=e.props,r=i.follow?"stat":"lstat";t?process.nextTick(n.bind(null,null,t)):AYt[r](e._path,n);function n(o,s){if(o)return e.error(o);if(Object.keys(s).forEach(function(f){i[f]=s[f]}),e.size!==void 0&&i.size!==e.size)return e.error("incorrect size");e.size=i.size;var a=Vle(i),c=i.hardlinks!==!1;if(c&&a!=="Directory"&&i.nlink&&i.nlink>1){var d=i.dev+":"+i.ino;hz[d]===e._path||!hz[d]?hz[d]=e._path:(a=e.type=e.props.type="Link",e.Link=e.props.Link=!0,e.linkpath=e.props.linkpath=hz[d],e._stat=e._read=cqe.prototype._read)}if(e.type&&e.type!==a&&e.error("Unexpected type: "+a),e.filter){var u=e._proxy||e;if(!e.filter.call(u,u,i)){e._disowned||(e.abort(),e.emit("end"),e.emit("close"));return}}var h=["_stat","stat","ready"],p=0;(function f(){if(e._aborted){e.emit("end"),e.emit("close");return}if(e._paused&&e.type!=="Directory"){e.once("resume",f);return}var m=h[p++];if(!m)return e._read();e.emit(m,i),f()})()}};Nh.prototype.pipe=function(t){var e=this;return typeof t.add=="function"&&e.on("entry",function(i){var r=t.add(i);r===!1&&e.pause()}),IYt.prototype.pipe.apply(this,arguments)};Nh.prototype.pause=function(t){this._paused=!0,t=t||this,this.emit("pause",t),this._stream&&this._stream.pause(t)};Nh.prototype.resume=function(t){this._paused=!1,t=t||this,this.emit("resume",t),this._stream&&this._stream.resume(t),this._read()};Nh.prototype._read=function(){this.error("Cannot read unknown type: "+this.type)}});var Ule=z((Kir,bqe)=>{"use strict";bqe.exports=Wle;Wle.sync=vqe;var tn=Ze("assert"),pqe=Ze("path"),uqe=Ze("fs"),oR=void 0;try{oR=jN()}catch{}var mqe=parseInt("666",8),kYt={nosort:!0,silent:!0},jle=0,xP=process.platform==="win32";function gqe(t){var e=["unlink","chmod","stat","lstat","rmdir","readdir"];if(e.forEach(function(i){t[i]=t[i]||uqe[i],i=i+"Sync",t[i]=t[i]||uqe[i]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob!==!0&&oR===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||kYt}function Wle(t,e,i){typeof e=="function"&&(i=e,e={}),tn(t,"rimraf: missing path"),tn.equal(typeof t,"string","rimraf: path should be a string"),tn.equal(typeof i,"function","rimraf: callback function required"),tn(e,"rimraf: invalid options argument provided"),tn.equal(typeof e,"object","rimraf: options should be object"),gqe(e);var r=0,n=null,o=0;if(e.disableGlob||!oR.hasMagic(t))return a(null,[t]);e.lstat(t,function(c,d){if(!c)return a(null,[t]);oR(t,e.glob,a)});function s(c){n=n||c,--o===0&&i(n)}function a(c,d){if(c)return i(c);if(o=d.length,o===0)return i();d.forEach(function(u){zle(u,e,function h(p){if(p){if((p.code==="EBUSY"||p.code==="ENOTEMPTY"||p.code==="EPERM")&&r<e.maxBusyTries){r++;var f=r*100;return setTimeout(function(){zle(u,e,h)},f)}if(p.code==="EMFILE"&&jle<e.emfileWait)return setTimeout(function(){zle(u,e,h)},jle++);p.code==="ENOENT"&&(p=null)}jle=0,s(p)})})}}function zle(t,e,i){tn(t),tn(e),tn(typeof i=="function"),e.lstat(t,function(r,n){if(r&&r.code==="ENOENT")return i(null);if(r&&r.code==="EPERM"&&xP&&hqe(t,e,r,i),n&&n.isDirectory())return fz(t,e,r,i);e.unlink(t,function(o){if(o){if(o.code==="ENOENT")return i(null);if(o.code==="EPERM")return xP?hqe(t,e,o,i):fz(t,e,o,i);if(o.code==="EISDIR")return fz(t,e,o,i)}return i(o)})})}function hqe(t,e,i,r){tn(t),tn(e),tn(typeof r=="function"),i&&tn(i instanceof Error),e.chmod(t,mqe,function(n){n?r(n.code==="ENOENT"?null:i):e.stat(t,function(o,s){o?r(o.code==="ENOENT"?null:i):s.isDirectory()?fz(t,e,i,r):e.unlink(t,r)})})}function fqe(t,e,i){tn(t),tn(e),i&&tn(i instanceof Error);try{e.chmodSync(t,mqe)}catch(n){if(n.code==="ENOENT")return;throw i}try{var r=e.statSync(t)}catch(n){if(n.code==="ENOENT")return;throw i}r.isDirectory()?pz(t,e,i):e.unlinkSync(t)}function fz(t,e,i,r){tn(t),tn(e),i&&tn(i instanceof Error),tn(typeof r=="function"),e.rmdir(t,function(n){n&&(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")?OYt(t,e,r):n&&n.code==="ENOTDIR"?r(i):r(n)})}function OYt(t,e,i){tn(t),tn(e),tn(typeof i=="function"),e.readdir(t,function(r,n){if(r)return i(r);var o=n.length;if(o===0)return e.rmdir(t,i);var s;n.forEach(function(a){Wle(pqe.join(t,a),e,function(c){if(!s){if(c)return i(s=c);--o===0&&e.rmdir(t,i)}})})})}function vqe(t,e){e=e||{},gqe(e),tn(t,"rimraf: missing path"),tn.equal(typeof t,"string","rimraf: path should be a string"),tn(e,"rimraf: missing options"),tn.equal(typeof e,"object","rimraf: options should be object");var i;if(e.disableGlob||!oR.hasMagic(t))i=[t];else try{e.lstatSync(t),i=[t]}catch{i=oR.sync(t,e.glob)}if(i.length)for(var r=0;r<i.length;r++){var t=i[r];try{var n=e.lstatSync(t)}catch(s){if(s.code==="ENOENT")return;s.code==="EPERM"&&xP&&fqe(t,e,s)}try{n&&n.isDirectory()?pz(t,e,null):e.unlinkSync(t)}catch(s){if(s.code==="ENOENT")return;if(s.code==="EPERM")return xP?fqe(t,e,s):pz(t,e,s);if(s.code!=="EISDIR")throw s;pz(t,e,s)}}}function pz(t,e,i){tn(t),tn(e),i&&tn(i instanceof Error);try{e.rmdirSync(t)}catch(r){if(r.code==="ENOENT")return;if(r.code==="ENOTDIR")throw i;(r.code==="ENOTEMPTY"||r.code==="EEXIST"||r.code==="EPERM")&&NYt(t,e)}}function NYt(t,e){tn(t),tn(e),e.readdirSync(t).forEach(function(s){vqe(pqe.join(t,s),e)});var i=xP?100:1,r=0;do{var n=!0;try{var o=e.rmdirSync(t,e);return n=!1,o}finally{if(++r<i&&n)continue}}while(!0)}});var qle=z((Zir,wqe)=>{"use strict";var SP=Ze("path"),_qe=Ze("fs"),yqe=parseInt("0777",8);wqe.exports=sR.mkdirp=sR.mkdirP=sR;function sR(t,e,i,r){typeof e=="function"?(i=e,e={}):(!e||typeof e!="object")&&(e={mode:e});var n=e.mode,o=e.fs||_qe;n===void 0&&(n=yqe),r||(r=null);var s=i||function(){};t=SP.resolve(t),o.mkdir(t,n,function(a){if(!a)return r=r||t,s(null,r);switch(a.code){case"ENOENT":if(SP.dirname(t)===t)return s(a);sR(SP.dirname(t),e,function(c,d){c?s(c,d):sR(t,e,s,d)});break;default:o.stat(t,function(c,d){c||!d.isDirectory()?s(a,r):s(null,r)});break}})}sR.sync=function t(e,i,r){(!i||typeof i!="object")&&(i={mode:i});var n=i.mode,o=i.fs||_qe;n===void 0&&(n=yqe),r||(r=null),e=SP.resolve(e);try{o.mkdirSync(e,n),r=r||e}catch(a){switch(a.code){case"ENOENT":r=t(SP.dirname(e),i,r),t(e,i,r);break;default:var s;try{s=o.statSync(e)}catch{throw a}if(!s.isDirectory())throw a;break}}return r}});var mz=z((Qir,Cqe)=>{"use strict";Cqe.exports=Yle;function Yle(t){if(t._collected)return;if(t._paused)return t.on("resume",Yle.bind(null,t));t._collected=!0,t.pause(),t.on("data",i),t.on("end",i);var e=[];function i(s){typeof s=="string"&&(s=new Buffer(s)),!(Buffer.isBuffer(s)&&!s.length)&&e.push(s)}t.on("entry",n);var r=[];function n(s){Yle(s),r.push(s)}t.on("proxy",o);function o(s){s.pause()}t.pipe=function(s){return function(a){var c=0;(function u(){var h=r[c++];if(!h)return d();h.on("end",u),a?a.add(h):t.emit("entry",h)})();function d(){t.removeListener("entry",n),t.removeListener("data",i),t.removeListener("end",i),t.pipe=s,a&&t.pipe(a),e.forEach(function(u){u?t.emit("data",u):t.emit("end")}),t.resume()}return a}}(t.pipe)}});var $le=z((Jir,Sqe)=>{"use strict";Sqe.exports=F0;var gz=aR(),PYt=Vi(),LYt=qle(),xqe=Ze("path"),FYt=mz();PYt(F0,gz);function F0(t){var e=this;e instanceof F0||e.error("DirWriter must be called as constructor.",null,!0),(t.type!=="Directory"||!t.Directory)&&e.error("Non-directory type "+t.type+" "+JSON.stringify(t),null,!0),gz.call(this,t)}F0.prototype._create=function(){var t=this;LYt(t._path,gz.dirmode,function(e){if(e)return t.error(e);t.ready=!0,t.emit("ready"),t._process()})};F0.prototype.write=function(){return!0};F0.prototype.end=function(){this._ended=!0,this._process()};F0.prototype.add=function(t){var e=this;return FYt(t),!e.ready||e._currentEntry?(e._buffer.push(t),!1):e._ended?e.error("add after end"):(e._buffer.push(t),e._process(),this._buffer.length===0)};F0.prototype._process=function(){var t=this;if(t._processing)return;var e=t._buffer.shift();if(!e){t.emit("drain"),t._ended&&t._finish();return}t._processing=!0,t.emit("entry",e);var i=e,r;do{if(r=i._path||i.path,r===t.root._path||r===t._path||r&&r.indexOf(t._path)===0)return t._processing=!1,e._collected&&e.pipe(),t._process();i=i.parent}while(i);var n={parent:t,root:t.root||t,type:e.type,depth:t.depth+1};r=e._path||e.path||e.props.path,e.parent&&(r=r.substr(e.parent._path.length+1)),n.path=xqe.join(t.path,xqe.join("/",r)),n.filter=t.filter,Object.keys(e.props).forEach(function(c){n.hasOwnProperty(c)||(n[c]=e.props[c])});var o=t._currentChild=new gz(n);o.on("ready",function(){e.pipe(o),e.resume()}),o.on("error",function(c){o._swallowErrors?(t.warn(c),o.emit("end"),o.emit("close")):t.emit("error",c)}),o.on("close",a);var s=!1;function a(){s||(s=!0,t._currentChild=null,t._processing=!1,t._process())}}});var Gle=z((err,Iqe)=>{"use strict";Iqe.exports=EP;var Tqe=jc(),Rqe=aR(),HYt=Vi(),BYt=Ze("path"),VYt=Ule();HYt(EP,Rqe);function EP(t){var e=this;if(!(e instanceof EP))throw new Error("LinkWriter must be called as constructor.");if(!(t.type==="Link"&&t.Link||t.type==="SymbolicLink"&&t.SymbolicLink))throw new Error("Non-link type "+t.type);t.linkpath===""&&(t.linkpath="."),t.linkpath||e.error("Need linkpath property to create "+t.type),Rqe.call(this,t)}EP.prototype._create=function(){var t=this,e=t.type==="Link"||process.platform==="win32",i=e?"link":"symlink",r=e?BYt.resolve(t.dirname,t.linkpath):t.linkpath;if(e)return Eqe(t,r,i);Tqe.readlink(t._path,function(n,o){if(o&&o===r)return Aqe(t);Eqe(t,r,i)})};function Eqe(t,e,i){VYt(t._path,function(r){if(r)return t.error(r);jYt(t,e,i)})}function jYt(t,e,i){Tqe[i](e,t._path,function(r){if(r)if((r.code==="ENOENT"||r.code==="EACCES"||r.code==="EPERM")&&process.platform==="win32")t.ready=!0,t.emit("ready"),t.emit("end"),t.emit("close"),t.end=t._finish=function(){};else return t.error(r);Aqe(t)})}function Aqe(t){t.ready=!0,t.emit("ready"),t._ended&&!t._finished&&t._finish()}EP.prototype.end=function(){this._ended=!0,this.ready&&(this._finished=!0,this._finish())}});var Xle=z((trr,Mqe)=>{"use strict";Mqe.exports=dC;var zYt=jc(),vz=aR(),WYt=Vi(),Dqe={};WYt(dC,vz);function dC(t){var e=this;if(!(e instanceof dC))throw new Error("FileWriter must be called as constructor.");if(t.type!=="File"||!t.File)throw new Error("Non-file type "+t.type);e._buffer=[],e._bytesWritten=0,vz.call(this,t)}dC.prototype._create=function(){var t=this;if(!t._stream){var e={};t.props.flags&&(e.flags=t.props.flags),e.mode=vz.filemode,t._old&&t._old.blksize&&(e.bufferSize=t._old.blksize),t._stream=zYt.createWriteStream(t._path,e),t._stream.on("open",function(){t.ready=!0,t._buffer.forEach(function(i){i===Dqe?t._stream.end():t._stream.write(i)}),t.emit("ready"),t.emit("drain")}),t._stream.on("error",function(i){t.emit("error",i)}),t._stream.on("drain",function(){t.emit("drain")}),t._stream.on("close",function(){t._finish()})}};dC.prototype.write=function(t){var e=this;if(e._bytesWritten+=t.length,!e.ready){if(!Buffer.isBuffer(t)&&typeof t!="string")throw new Error("invalid write data");return e._buffer.push(t),!1}var i=e._stream.write(t);return i===!1&&e._stream._queue?e._stream._queue.length<=2:i};dC.prototype.end=function(t){var e=this;return t&&e.write(t),e.ready?e._stream.end():(e._buffer.push(Dqe),!1)};dC.prototype._finish=function(){var t=this;typeof t.size=="number"&&t._bytesWritten!==t.size&&t.error(`Did not get expected byte count.
expect: `+t.size+`
actual: `+t._bytesWritten),vz.prototype._finish.call(t)}});var Zle=z((irr,kqe)=>{"use strict";kqe.exports=H0;var Kle=aR(),UYt=yP(),qYt=Vi(),YYt=mz(),$Yt=Ze("fs");qYt(H0,Kle);function H0(t){var e=this;if(!(e instanceof H0))throw new Error("ProxyWriter must be called as constructor.");e.props=t,e._needDrain=!1,Kle.call(e,t)}H0.prototype._stat=function(){var t=this,e=t.props,i=e.follow?"stat":"lstat";$Yt[i](e.path,function(r,n){var o;r||!n?o="File":o=UYt(n),e[o]=!0,e.type=t.type=o,t._old=n,t._addProxy(Kle(e,n))})};H0.prototype._addProxy=function(t){var e=this;if(e._proxy)return e.error("proxy already set");e._proxy=t,["ready","error","close","pipe","drain","warn"].forEach(function(r){t.on(r,e.emit.bind(e,r))}),e.emit("proxy",t);var i=e._buffer;i.forEach(function(r){t[r[0]].apply(t,r[1])}),e._buffer.length=0,e._needsDrain&&e.emit("drain")};H0.prototype.add=function(t){return YYt(t),this._proxy?this._proxy.add(t):(this._buffer.push(["add",[t]]),this._needDrain=!0,!1)};H0.prototype.write=function(t){return this._proxy?this._proxy.write(t):(this._buffer.push(["write",[t]]),this._needDrain=!0,!1)};H0.prototype.end=function(t){return this._proxy?this._proxy.end(t):(this._buffer.push(["end",[t]]),!1)}});var aR=z((rrr,jqe)=>{"use strict";jqe.exports=ku;var Mu=jc(),GYt=Vi(),XYt=Ule(),KYt=qle(),TP=Ze("path"),Nqe=process.platform==="win32"?0:process.umask(),Pqe=yP(),Lqe=dz();GYt(ku,Lqe);ku.dirmode=parseInt("0777",8)&~Nqe;ku.filemode=parseInt("0666",8)&~Nqe;var ZYt=$le(),QYt=Gle(),JYt=Xle(),e$t=Zle();function ku(t,e){var i=this;typeof t=="string"&&(t={path:t});var r=Pqe(t),n=ku;switch(r){case"Directory":n=ZYt;break;case"File":n=JYt;break;case"Link":case"SymbolicLink":n=QYt;break;case null:default:n=e$t;break}if(!(i instanceof n))return new n(t);Lqe.call(i),t.path||i.error("Must provide a path",null,!0),i.type=t.type,i.props=t,i.depth=t.depth||0,i.clobber=t.clobber===!1?t.clobber:!0,i.parent=t.parent||null,i.root=t.root||t.parent&&t.parent.root||i,i._path=i.path=TP.resolve(t.path),process.platform==="win32"&&(i.path=i._path=i.path.replace(/\?/g,"_"),i._path.length>=260&&(i._swallowErrors=!0,i._path="\\\\?\\"+i.path.replace(/\//g,"\\"))),i.basename=TP.basename(t.path),i.dirname=TP.dirname(t.path),i.linkpath=t.linkpath||null,t.parent=t.root=null,i.size=t.size,typeof t.mode=="string"&&(t.mode=parseInt(t.mode,8)),i.readable=!1,i.writable=!0,i._buffer=[],i.ready=!1,i.filter=typeof t.filter=="function"?t.filter:null,i._stat(e)}ku.prototype._create=function(){var t=this;Mu[t.props.follow?"stat":"lstat"](t._path,function(e){if(e)return t.warn("Cannot create "+t._path+`
Unsupported type: `+t.type,"ENOTSUP");t._finish()})};ku.prototype._stat=function(t){var e=this,i=e.props,r=i.follow?"stat":"lstat",n=e._proxy||e;t?o(null,t):Mu[r](e._path,o);function o(s,a){if(e.filter&&!e.filter.call(n,n,a)){e._aborted=!0,e.emit("end"),e.emit("close");return}if(s||!a)return Qle(e);e._old=a;var c=Pqe(a);if(c!==e.type||e.type==="File"&&a.nlink>1)return XYt(e._path,function(d){if(d)return e.error(d);e._old=null,Qle(e)});Qle(e)}};function Qle(t){KYt(TP.dirname(t._path),ku.dirmode,function(e,i){return e?t.error(e):(t._madeDir=i,t._create())})}function Fqe(t,e,i,r,n){var o=e.mode,s=e.follow||t.type!=="SymbolicLink"?"chmod":"lchmod";if(!Mu[s]||typeof o!="number")return n();var a=i.mode&parseInt("0777",8);if(o=o&parseInt("0777",8),o===a)return n();Mu[s](r,o,n)}function Hqe(t,e,i,r,n){if(process.platform==="win32"||!process.getuid||process.getuid()!==0||typeof e.uid!="number"&&typeof e.gid!="number"||i.uid===e.uid&&i.gid===e.gid)return n();var o=t.props.follow||t.type!=="SymbolicLink"?"chown":"lchown";if(!Mu[o])return n();typeof e.uid!="number"&&(e.uid=i.uid),typeof e.gid!="number"&&(e.gid=i.gid),Mu[o](r,e.uid,e.gid,n)}function Bqe(t,e,i,r,n){if(!Mu.utimes||process.platform==="win32")return n();var o=e.follow||t.type!=="SymbolicLink"?"utimes":"lutimes";if(o==="lutimes"&&!Mu[o]&&(o="utimes"),!Mu[o])return n();var s=i.atime,a=i.mtime,c=e.atime,d=e.mtime;if(c===void 0&&(c=s),d===void 0&&(d=a),Oqe(c)||(c=new Date(c)),Oqe(d)||(c=new Date(d)),c.getTime()===s.getTime()&&d.getTime()===a.getTime())return n();Mu[o](r,c,d,n)}ku.prototype._finish=function(){var t=this;if(t._finishing)return;t._finishing=!0;var e=0,i=null,r=!1;if(t._old)t._old.atime=new Date(0),t._old.mtime=new Date(0),o(t._old);else{var n=t.props.follow?"stat":"lstat";Mu[n](t._path,function(a,c){if(a)if(a.code==="ENOENT"&&(t.type==="Link"||t.type==="SymbolicLink")&&process.platform==="win32"){t.ready=!0,t.emit("ready"),t.emit("end"),t.emit("close"),t.end=t._finish=function(){};return}else return t.error(a);o(t._old=c)})}return;function o(a){e+=3,Fqe(t,t.props,a,t._path,s("chmod")),Hqe(t,t.props,a,t._path,s("chown")),Bqe(t,t.props,a,t._path,s("utimes"))}function s(a){return function(c){if(i)return;if(c)return c.fstream_finish_call=a,t.error(i=c);if(--e>0||r)return;if(r=!0,t._madeDir)Vqe(t,t._path,d);else return d();function d(u){if(u)return u.fstream_finish_call="setupMadeDir",t.error(u);t.emit("end"),t.emit("close")}}}};function Vqe(t,e,i){var r=t._madeDir,n=TP.dirname(e);t$t(t,n,function(o){if(o)return i(o);if(n===r)return i();Vqe(t,n,i)})}function t$t(t,e,i){var r={};Object.keys(t.props).forEach(function(a){r[a]=t.props[a],a==="mode"&&t.type!=="Directory"&&(r[a]=r[a]|parseInt("0111",8))});var n=3,o=null;Mu.stat(e,function(a,c){if(a)return i(o=a);Fqe(t,r,c,e,s),Hqe(t,r,c,e,s),Bqe(t,r,c,e,s)});function s(a){if(!o){if(a)return i(o=a);if(--n===0)return i()}}}ku.prototype.pipe=function(){this.error("Can't pipe from writable stream")};ku.prototype.add=function(){this.error("Can't add to non-Directory type")};ku.prototype.write=function(){return!0};function i$t(t){return Object.prototype.toString.call(t)}function Oqe(t){return typeof t=="object"&&i$t(t)==="[object Date]"}});var Jle=z(Fr=>{"use strict";Fr.Abstract=dz();Fr.Reader=aC();Fr.Writer=aR();Fr.File={Reader:Lle(),Writer:Xle()};Fr.Dir={Reader:Ple(),Writer:$le()};Fr.Link={Reader:Ole(),Writer:Gle()};Fr.Proxy={Reader:Hle(),Writer:Zle()};Fr.Reader.Dir=Fr.DirReader=Fr.Dir.Reader;Fr.Reader.File=Fr.FileReader=Fr.File.Reader;Fr.Reader.Link=Fr.LinkReader=Fr.Link.Reader;Fr.Reader.Proxy=Fr.ProxyReader=Fr.Proxy.Reader;Fr.Writer.Dir=Fr.DirWriter=Fr.Dir.Writer;Fr.Writer.File=Fr.FileWriter=Fr.File.Writer;Fr.Writer.Link=Fr.LinkWriter=Fr.Link.Writer;Fr.Writer.Proxy=Fr.ProxyWriter=Fr.Proxy.Writer;Fr.collect=mz()});var Wqe=z((orr,zqe)=>{"use strict";zqe.exports=l$t;var r$t=J8(),n$t=Jle().Writer,ece=Ze("path"),o$t=Ze("stream"),s$t=Dle(),a$t=N0();function l$t(t){t.path=ece.resolve(ece.normalize(t.path));var e=new r$t(t),i=new o$t.Writable({objectMode:!0});i._write=function(n,o,s){if(n.type=="Directory")return s();var a=ece.join(t.path,n.path);if(a.indexOf(t.path)!=0)return s();let c=t.getWriter?t.getWriter({path:a}):n$t({path:a});n.pipe(c).on("error",s).on("close",s)};var r=s$t(e,i);return e.once("crx-header",function(n){r.crxHeader=n}),e.pipe(i).on("finish",function(){r.emit("close")}),r.promise=function(){return new a$t(function(n,o){r.on("close",n),r.on("error",o)})},r}});var Uqe=z((srr,bz)=>{"use strict";var $s=function(t){"use strict";var e=1e7,i=7,r=9007199254740992,n=p(r),o="0123456789abcdefghijklmnopqrstuvwxyz",s=typeof BigInt=="function";function a(A,L,Y,Z){return typeof A>"u"?a[0]:typeof L<"u"?+L==10&&!Y?pe(A):Ue(A,L,Y,Z):pe(A)}function c(A,L){this.value=A,this.sign=L,this.isSmall=!1}c.prototype=Object.create(a.prototype);function d(A){this.value=A,this.sign=A<0,this.isSmall=!0}d.prototype=Object.create(a.prototype);function u(A){this.value=A}u.prototype=Object.create(a.prototype);function h(A){return-r<A&&A<r}function p(A){return A<1e7?[A]:A<1e14?[A%1e7,Math.floor(A/1e7)]:[A%1e7,Math.floor(A/1e7)%1e7,Math.floor(A/1e14)]}function f(A){m(A);var L=A.length;if(L<4&&te(A,n)<0)switch(L){case 0:return 0;case 1:return A[0];case 2:return A[0]+A[1]*e;default:return A[0]+(A[1]+A[2]*e)*e}return A}function m(A){for(var L=A.length;A[--L]===0;);A.length=L+1}function g(A){for(var L=new Array(A),Y=-1;++Y<A;)L[Y]=0;return L}function y(A){return A>0?Math.floor(A):Math.ceil(A)}function w(A,L){var Y=A.length,Z=L.length,fe=new Array(Y),we=0,ke=e,Ie,ze;for(ze=0;ze<Z;ze++)Ie=A[ze]+L[ze]+we,we=Ie>=ke?1:0,fe[ze]=Ie-we*ke;for(;ze<Y;)Ie=A[ze]+we,we=Ie===ke?1:0,fe[ze++]=Ie-we*ke;return we>0&&fe.push(we),fe}function x(A,L){return A.length>=L.length?w(A,L):w(L,A)}function T(A,L){var Y=A.length,Z=new Array(Y),fe=e,we,ke;for(ke=0;ke<Y;ke++)we=A[ke]-fe+L,L=Math.floor(we/fe),Z[ke]=we-L*fe,L+=1;for(;L>0;)Z[ke++]=L%fe,L=Math.floor(L/fe);return Z}c.prototype.add=function(A){var L=pe(A);if(this.sign!==L.sign)return this.subtract(L.negate());var Y=this.value,Z=L.value;return L.isSmall?new c(T(Y,Math.abs(Z)),this.sign):new c(x(Y,Z),this.sign)},c.prototype.plus=c.prototype.add,d.prototype.add=function(A){var L=pe(A),Y=this.value;if(Y<0!==L.sign)return this.subtract(L.negate());var Z=L.value;if(L.isSmall){if(h(Y+Z))return new d(Y+Z);Z=p(Math.abs(Z))}return new c(T(Z,Math.abs(Y)),Y<0)},d.prototype.plus=d.prototype.add,u.prototype.add=function(A){return new u(this.value+pe(A).value)},u.prototype.plus=u.prototype.add;function M(A,L){var Y=A.length,Z=L.length,fe=new Array(Y),we=0,ke=e,Ie,ze;for(Ie=0;Ie<Z;Ie++)ze=A[Ie]-we-L[Ie],ze<0?(ze+=ke,we=1):we=0,fe[Ie]=ze;for(Ie=Z;Ie<Y;Ie++){if(ze=A[Ie]-we,ze<0)ze+=ke;else{fe[Ie++]=ze;break}fe[Ie]=ze}for(;Ie<Y;Ie++)fe[Ie]=A[Ie];return m(fe),fe}function B(A,L,Y){var Z;return te(A,L)>=0?Z=M(A,L):(Z=M(L,A),Y=!Y),Z=f(Z),typeof Z=="number"?(Y&&(Z=-Z),new d(Z)):new c(Z,Y)}function G(A,L,Y){var Z=A.length,fe=new Array(Z),we=-L,ke=e,Ie,ze;for(Ie=0;Ie<Z;Ie++)ze=A[Ie]+we,we=Math.floor(ze/ke),ze%=ke,fe[Ie]=ze<0?ze+ke:ze;return fe=f(fe),typeof fe=="number"?(Y&&(fe=-fe),new d(fe)):new c(fe,Y)}c.prototype.subtract=function(A){var L=pe(A);if(this.sign!==L.sign)return this.add(L.negate());var Y=this.value,Z=L.value;return L.isSmall?G(Y,Math.abs(Z),this.sign):B(Y,Z,this.sign)},c.prototype.minus=c.prototype.subtract,d.prototype.subtract=function(A){var L=pe(A),Y=this.value;if(Y<0!==L.sign)return this.add(L.negate());var Z=L.value;return L.isSmall?new d(Y-Z):G(Z,Math.abs(Y),Y>=0)},d.prototype.minus=d.prototype.subtract,u.prototype.subtract=function(A){return new u(this.value-pe(A).value)},u.prototype.minus=u.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},d.prototype.negate=function(){var A=this.sign,L=new d(-this.value);return L.sign=!A,L},u.prototype.negate=function(){return new u(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},d.prototype.abs=function(){return new d(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)};function F(A,L){var Y=A.length,Z=L.length,fe=Y+Z,we=g(fe),ke=e,Ie,ze,rt,yt,st;for(rt=0;rt<Y;++rt){yt=A[rt];for(var vt=0;vt<Z;++vt)st=L[vt],Ie=yt*st+we[rt+vt],ze=Math.floor(Ie/ke),we[rt+vt]=Ie-ze*ke,we[rt+vt+1]+=ze}return m(we),we}function O(A,L){var Y=A.length,Z=new Array(Y),fe=e,we=0,ke,Ie;for(Ie=0;Ie<Y;Ie++)ke=A[Ie]*L+we,we=Math.floor(ke/fe),Z[Ie]=ke-we*fe;for(;we>0;)Z[Ie++]=we%fe,we=Math.floor(we/fe);return Z}function V(A,L){for(var Y=[];L-- >0;)Y.push(0);return Y.concat(A)}function J(A,L){var Y=Math.max(A.length,L.length);if(Y<=30)return F(A,L);Y=Math.ceil(Y/2);var Z=A.slice(Y),fe=A.slice(0,Y),we=L.slice(Y),ke=L.slice(0,Y),Ie=J(fe,ke),ze=J(Z,we),rt=J(x(fe,Z),x(ke,we)),yt=x(x(Ie,V(M(M(rt,Ie),ze),Y)),V(ze,2*Y));return m(yt),yt}function N(A,L){return-.012*A-.012*L+15e-6*A*L>0}c.prototype.multiply=function(A){var L=pe(A),Y=this.value,Z=L.value,fe=this.sign!==L.sign,we;if(L.isSmall){if(Z===0)return a[0];if(Z===1)return this;if(Z===-1)return this.negate();if(we=Math.abs(Z),we<e)return new c(O(Y,we),fe);Z=p(we)}return N(Y.length,Z.length)?new c(J(Y,Z),fe):new c(F(Y,Z),fe)},c.prototype.times=c.prototype.multiply;function P(A,L,Y){return A<e?new c(O(L,A),Y):new c(F(L,p(A)),Y)}d.prototype._multiplyBySmall=function(A){return h(A.value*this.value)?new d(A.value*this.value):P(Math.abs(A.value),p(Math.abs(this.value)),this.sign!==A.sign)},c.prototype._multiplyBySmall=function(A){return A.value===0?a[0]:A.value===1?this:A.value===-1?this.negate():P(Math.abs(A.value),this.value,this.sign!==A.sign)},d.prototype.multiply=function(A){return pe(A)._multiplyBySmall(this)},d.prototype.times=d.prototype.multiply,u.prototype.multiply=function(A){return new u(this.value*pe(A).value)},u.prototype.times=u.prototype.multiply;function $(A){var L=A.length,Y=g(L+L),Z=e,fe,we,ke,Ie,ze;for(ke=0;ke<L;ke++){Ie=A[ke],we=0-Ie*Ie;for(var rt=ke;rt<L;rt++)ze=A[rt],fe=2*(Ie*ze)+Y[ke+rt]+we,we=Math.floor(fe/Z),Y[ke+rt]=fe-we*Z;Y[ke+L]=we}return m(Y),Y}c.prototype.square=function(){return new c($(this.value),!1)},d.prototype.square=function(){var A=this.value*this.value;return h(A)?new d(A):new c($(p(Math.abs(this.value))),!1)},u.prototype.square=function(A){return new u(this.value*this.value)};function K(A,L){var Y=A.length,Z=L.length,fe=e,we=g(L.length),ke=L[Z-1],Ie=Math.ceil(fe/(2*ke)),ze=O(A,Ie),rt=O(L,Ie),yt,st,vt,di,fi,fo,mr;for(ze.length<=Y&&ze.push(0),rt.push(0),ke=rt[Z-1],st=Y-Z;st>=0;st--){for(yt=fe-1,ze[st+Z]!==ke&&(yt=Math.floor((ze[st+Z]*fe+ze[st+Z-1])/ke)),vt=0,di=0,fo=rt.length,fi=0;fi<fo;fi++)vt+=yt*rt[fi],mr=Math.floor(vt/fe),di+=ze[st+fi]-(vt-mr*fe),vt=mr,di<0?(ze[st+fi]=di+fe,di=-1):(ze[st+fi]=di,di=0);for(;di!==0;){for(yt-=1,vt=0,fi=0;fi<fo;fi++)vt+=ze[st+fi]-fe+rt[fi],vt<0?(ze[st+fi]=vt+fe,vt=0):(ze[st+fi]=vt,vt=1);di+=vt}we[st]=yt}return ze=W(ze,Ie)[0],[f(we),f(ze)]}function ve(A,L){for(var Y=A.length,Z=L.length,fe=[],we=[],ke=e,Ie,ze,rt,yt,st;Y;){if(we.unshift(A[--Y]),m(we),te(we,L)<0){fe.push(0);continue}ze=we.length,rt=we[ze-1]*ke+we[ze-2],yt=L[Z-1]*ke+L[Z-2],ze>Z&&(rt=(rt+1)*ke),Ie=Math.ceil(rt/yt);do{if(st=O(L,Ie),te(st,we)<=0)break;Ie--}while(Ie);fe.push(Ie),we=M(we,st)}return fe.reverse(),[f(fe),f(we)]}function W(A,L){var Y=A.length,Z=g(Y),fe=e,we,ke,Ie,ze;for(Ie=0,we=Y-1;we>=0;--we)ze=Ie*fe+A[we],ke=y(ze/L),Ie=ze-ke*L,Z[we]=ke|0;return[Z,Ie|0]}function ee(A,L){var Y,Z=pe(L);if(s)return[new u(A.value/Z.value),new u(A.value%Z.value)];var fe=A.value,we=Z.value,ke;if(we===0)throw new Error("Cannot divide by zero");if(A.isSmall)return Z.isSmall?[new d(y(fe/we)),new d(fe%we)]:[a[0],A];if(Z.isSmall){if(we===1)return[A,a[0]];if(we==-1)return[A.negate(),a[0]];var Ie=Math.abs(we);if(Ie<e){Y=W(fe,Ie),ke=f(Y[0]);var ze=Y[1];return A.sign&&(ze=-ze),typeof ke=="number"?(A.sign!==Z.sign&&(ke=-ke),[new d(ke),new d(ze)]):[new c(ke,A.sign!==Z.sign),new d(ze)]}we=p(Ie)}var rt=te(fe,we);if(rt===-1)return[a[0],A];if(rt===0)return[a[A.sign===Z.sign?1:-1],a[0]];fe.length+we.length<=200?Y=K(fe,we):Y=ve(fe,we),ke=Y[0];var yt=A.sign!==Z.sign,st=Y[1],vt=A.sign;return typeof ke=="number"?(yt&&(ke=-ke),ke=new d(ke)):ke=new c(ke,yt),typeof st=="number"?(vt&&(st=-st),st=new d(st)):st=new c(st,vt),[ke,st]}c.prototype.divmod=function(A){var L=ee(this,A);return{quotient:L[0],remainder:L[1]}},u.prototype.divmod=d.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(A){return ee(this,A)[0]},u.prototype.over=u.prototype.divide=function(A){return new u(this.value/pe(A).value)},d.prototype.over=d.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(A){return ee(this,A)[1]},u.prototype.mod=u.prototype.remainder=function(A){return new u(this.value%pe(A).value)},d.prototype.remainder=d.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(A){var L=pe(A),Y=this.value,Z=L.value,fe,we,ke;if(Z===0)return a[1];if(Y===0)return a[0];if(Y===1)return a[1];if(Y===-1)return L.isEven()?a[1]:a[-1];if(L.sign)return a[0];if(!L.isSmall)throw new Error("The exponent "+L.toString()+" is too large.");if(this.isSmall&&h(fe=Math.pow(Y,Z)))return new d(y(fe));for(we=this,ke=a[1];Z&!0&&(ke=ke.times(we),--Z),Z!==0;)Z/=2,we=we.square();return ke},d.prototype.pow=c.prototype.pow,u.prototype.pow=function(A){var L=pe(A),Y=this.value,Z=L.value,fe=BigInt(0),we=BigInt(1),ke=BigInt(2);if(Z===fe)return a[1];if(Y===fe)return a[0];if(Y===we)return a[1];if(Y===BigInt(-1))return L.isEven()?a[1]:a[-1];if(L.isNegative())return new u(fe);for(var Ie=this,ze=a[1];(Z&we)===we&&(ze=ze.times(Ie),--Z),Z!==fe;)Z/=ke,Ie=Ie.square();return ze},c.prototype.modPow=function(A,L){if(A=pe(A),L=pe(L),L.isZero())throw new Error("Cannot take modPow with modulus 0");var Y=a[1],Z=this.mod(L);for(A.isNegative()&&(A=A.multiply(a[-1]),Z=Z.modInv(L));A.isPositive();){if(Z.isZero())return a[0];A.isOdd()&&(Y=Y.multiply(Z).mod(L)),A=A.divide(2),Z=Z.square().mod(L)}return Y},u.prototype.modPow=d.prototype.modPow=c.prototype.modPow;function te(A,L){if(A.length!==L.length)return A.length>L.length?1:-1;for(var Y=A.length-1;Y>=0;Y--)if(A[Y]!==L[Y])return A[Y]>L[Y]?1:-1;return 0}c.prototype.compareAbs=function(A){var L=pe(A),Y=this.value,Z=L.value;return L.isSmall?1:te(Y,Z)},d.prototype.compareAbs=function(A){var L=pe(A),Y=Math.abs(this.value),Z=L.value;return L.isSmall?(Z=Math.abs(Z),Y===Z?0:Y>Z?1:-1):-1},u.prototype.compareAbs=function(A){var L=this.value,Y=pe(A).value;return L=L>=0?L:-L,Y=Y>=0?Y:-Y,L===Y?0:L>Y?1:-1},c.prototype.compare=function(A){if(A===1/0)return-1;if(A===-1/0)return 1;var L=pe(A),Y=this.value,Z=L.value;return this.sign!==L.sign?L.sign?1:-1:L.isSmall?this.sign?-1:1:te(Y,Z)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,d.prototype.compare=function(A){if(A===1/0)return-1;if(A===-1/0)return 1;var L=pe(A),Y=this.value,Z=L.value;return L.isSmall?Y==Z?0:Y>Z?1:-1:Y<0!==L.sign?Y<0?-1:1:Y<0?1:-1},d.prototype.compareTo=d.prototype.compare,u.prototype.compare=function(A){if(A===1/0)return-1;if(A===-1/0)return 1;var L=this.value,Y=pe(A).value;return L===Y?0:L>Y?1:-1},u.prototype.compareTo=u.prototype.compare,c.prototype.equals=function(A){return this.compare(A)===0},u.prototype.eq=u.prototype.equals=d.prototype.eq=d.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(A){return this.compare(A)!==0},u.prototype.neq=u.prototype.notEquals=d.prototype.neq=d.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(A){return this.compare(A)>0},u.prototype.gt=u.prototype.greater=d.prototype.gt=d.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(A){return this.compare(A)<0},u.prototype.lt=u.prototype.lesser=d.prototype.lt=d.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(A){return this.compare(A)>=0},u.prototype.geq=u.prototype.greaterOrEquals=d.prototype.geq=d.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(A){return this.compare(A)<=0},u.prototype.leq=u.prototype.lesserOrEquals=d.prototype.leq=d.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)===0},d.prototype.isEven=function(){return(this.value&1)===0},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)===1},d.prototype.isOdd=function(){return(this.value&1)===1},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},d.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=d.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},d.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=d.prototype.isNegative,c.prototype.isUnit=function(){return!1},d.prototype.isUnit=function(){return Math.abs(this.value)===1},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},d.prototype.isZero=function(){return this.value===0},u.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(A){var L=pe(A);return L.isZero()?!1:L.isUnit()?!0:L.compareAbs(2)===0?this.isEven():this.mod(L).isZero()},u.prototype.isDivisibleBy=d.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function se(A){var L=A.abs();if(L.isUnit())return!1;if(L.equals(2)||L.equals(3)||L.equals(5))return!0;if(L.isEven()||L.isDivisibleBy(3)||L.isDivisibleBy(5))return!1;if(L.lesser(49))return!0}function Ae(A,L){for(var Y=A.prev(),Z=Y,fe=0,we,ke,Ie,ze;Z.isEven();)Z=Z.divide(2),fe++;e:for(Ie=0;Ie<L.length;Ie++)if(!A.lesser(L[Ie])&&(ze=$s(L[Ie]).modPow(Z,A),!(ze.isUnit()||ze.equals(Y)))){for(we=fe-1;we!=0;we--){if(ze=ze.square().mod(A),ze.isUnit())return!1;if(ze.equals(Y))continue e}return!1}return!0}c.prototype.isPrime=function(A){var L=se(this);if(L!==t)return L;var Y=this.abs(),Z=Y.bitLength();if(Z<=64)return Ae(Y,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var fe=Math.log(2)*Z.toJSNumber(),we=Math.ceil(A===!0?2*Math.pow(fe,2):fe),ke=[],Ie=0;Ie<we;Ie++)ke.push($s(Ie+2));return Ae(Y,ke)},u.prototype.isPrime=d.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(A,L){var Y=se(this);if(Y!==t)return Y;for(var Z=this.abs(),fe=A===t?5:A,we=[],ke=0;ke<fe;ke++)we.push($s.randBetween(2,Z.minus(2),L));return Ae(Z,we)},u.prototype.isProbablePrime=d.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(A){for(var L=$s.zero,Y=$s.one,Z=pe(A),fe=this.abs(),we,ke,Ie;!fe.isZero();)we=Z.divide(fe),ke=L,Ie=Z,L=Y,Z=fe,Y=ke.subtract(we.multiply(Y)),fe=Ie.subtract(we.multiply(fe));if(!Z.isUnit())throw new Error(this.toString()+" and "+A.toString()+" are not co-prime");return L.compare(0)===-1&&(L=L.add(A)),this.isNegative()?L.negate():L},u.prototype.modInv=d.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var A=this.value;return this.sign?G(A,1,this.sign):new c(T(A,1),this.sign)},d.prototype.next=function(){var A=this.value;return A+1<r?new d(A+1):new c(n,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},c.prototype.prev=function(){var A=this.value;return this.sign?new c(T(A,1),!0):G(A,1,this.sign)},d.prototype.prev=function(){var A=this.value;return A-1>-r?new d(A-1):new c(n,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var k=[1];2*k[k.length-1]<=e;)k.push(2*k[k.length-1]);var S=k.length,I=k[S-1];function X(A){return Math.abs(A)<=e}c.prototype.shiftLeft=function(A){var L=pe(A).toJSNumber();if(!X(L))throw new Error(String(L)+" is too large for shifting.");if(L<0)return this.shiftRight(-L);var Y=this;if(Y.isZero())return Y;for(;L>=S;)Y=Y.multiply(I),L-=S-1;return Y.multiply(k[L])},u.prototype.shiftLeft=d.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(A){var L,Y=pe(A).toJSNumber();if(!X(Y))throw new Error(String(Y)+" is too large for shifting.");if(Y<0)return this.shiftLeft(-Y);for(var Z=this;Y>=S;){if(Z.isZero()||Z.isNegative()&&Z.isUnit())return Z;L=ee(Z,I),Z=L[1].isNegative()?L[0].prev():L[0],Y-=S-1}return L=ee(Z,k[Y]),L[1].isNegative()?L[0].prev():L[0]},u.prototype.shiftRight=d.prototype.shiftRight=c.prototype.shiftRight;function Q(A,L,Y){L=pe(L);for(var Z=A.isNegative(),fe=L.isNegative(),we=Z?A.not():A,ke=fe?L.not():L,Ie=0,ze=0,rt=null,yt=null,st=[];!we.isZero()||!ke.isZero();)rt=ee(we,I),Ie=rt[1].toJSNumber(),Z&&(Ie=I-1-Ie),yt=ee(ke,I),ze=yt[1].toJSNumber(),fe&&(ze=I-1-ze),we=rt[0],ke=yt[0],st.push(Y(Ie,ze));for(var vt=Y(Z?1:0,fe?1:0)!==0?$s(-1):$s(0),di=st.length-1;di>=0;di-=1)vt=vt.multiply(I).add($s(st[di]));return vt}c.prototype.not=function(){return this.negate().prev()},u.prototype.not=d.prototype.not=c.prototype.not,c.prototype.and=function(A){return Q(this,A,function(L,Y){return L&Y})},u.prototype.and=d.prototype.and=c.prototype.and,c.prototype.or=function(A){return Q(this,A,function(L,Y){return L|Y})},u.prototype.or=d.prototype.or=c.prototype.or,c.prototype.xor=function(A){return Q(this,A,function(L,Y){return L^Y})},u.prototype.xor=d.prototype.xor=c.prototype.xor;var le=1<<30,xe=(e&-e)*(e&-e)|le;function Re(A){var L=A.value,Y=typeof L=="number"?L|le:typeof L=="bigint"?L|BigInt(le):L[0]+L[1]*e|xe;return Y&-Y}function Oe(A,L){if(L.compareTo(A)<=0){var Y=Oe(A,L.square(L)),Z=Y.p,fe=Y.e,we=Z.multiply(L);return we.compareTo(A)<=0?{p:we,e:fe*2+1}:{p:Z,e:fe*2}}return{p:$s(1),e:0}}c.prototype.bitLength=function(){var A=this;return A.compareTo($s(0))<0&&(A=A.negate().subtract($s(1))),A.compareTo($s(0))===0?$s(0):$s(Oe(A,$s(2)).e).add($s(1))},u.prototype.bitLength=d.prototype.bitLength=c.prototype.bitLength;function We(A,L){return A=pe(A),L=pe(L),A.greater(L)?A:L}function Le(A,L){return A=pe(A),L=pe(L),A.lesser(L)?A:L}function Ne(A,L){if(A=pe(A).abs(),L=pe(L).abs(),A.equals(L))return A;if(A.isZero())return L;if(L.isZero())return A;for(var Y=a[1],Z,fe;A.isEven()&&L.isEven();)Z=Le(Re(A),Re(L)),A=A.divide(Z),L=L.divide(Z),Y=Y.multiply(Z);for(;A.isEven();)A=A.divide(Re(A));do{for(;L.isEven();)L=L.divide(Re(L));A.greater(L)&&(fe=L,L=A,A=fe),L=L.subtract(A)}while(!L.isZero());return Y.isUnit()?A:A.multiply(Y)}function it(A,L){return A=pe(A).abs(),L=pe(L).abs(),A.divide(Ne(A,L)).multiply(L)}function ct(A,L,Y){A=pe(A),L=pe(L);var Z=Y||Math.random,fe=Le(A,L),we=We(A,L),ke=we.subtract(fe).add(1);if(ke.isSmall)return fe.add(Math.floor(Z()*ke));for(var Ie=ce(ke,e).value,ze=[],rt=!0,yt=0;yt<Ie.length;yt++){var st=rt?Ie[yt]+(yt+1<Ie.length?Ie[yt+1]/e:0):e,vt=y(Z()*st);ze.push(vt),vt<Ie[yt]&&(rt=!1)}return fe.add(a.fromArray(ze,e,!1))}var Ue=function(A,L,Y,Z){Y=Y||o,A=String(A),Z||(A=A.toLowerCase(),Y=Y.toLowerCase());var fe=A.length,we,ke=Math.abs(L),Ie={};for(we=0;we<Y.length;we++)Ie[Y[we]]=we;for(we=0;we<fe;we++){var ze=A[we];if(ze!=="-"&&ze in Ie&&Ie[ze]>=ke){if(ze==="1"&&ke===1)continue;throw new Error(ze+" is not a valid digit in base "+L+".")}}L=pe(L);var rt=[],yt=A[0]==="-";for(we=yt?1:0;we<A.length;we++){var ze=A[we];if(ze in Ie)rt.push(pe(Ie[ze]));else if(ze==="<"){var st=we;do we++;while(A[we]!==">"&&we<A.length);rt.push(pe(A.slice(st+1,we)))}else throw new Error(ze+" is not a valid character")}return Se(rt,L,yt)};function Se(A,L,Y){var Z=a[0],fe=a[1],we;for(we=A.length-1;we>=0;we--)Z=Z.add(A[we].times(fe)),fe=fe.times(L);return Y?Z.negate():Z}function gt(A,L){return L=L||o,A<L.length?L[A]:"<"+A+">"}function ce(A,L){if(L=$s(L),L.isZero()){if(A.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(L.equals(-1)){if(A.isZero())return{value:[0],isNegative:!1};if(A.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-A.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var Y=Array.apply(null,Array(A.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return Y.unshift([1]),{value:[].concat.apply([],Y),isNegative:!1}}var Z=!1;if(A.isNegative()&&L.isPositive()&&(Z=!0,A=A.abs()),L.isUnit())return A.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(A.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:Z};for(var fe=[],we=A,ke;we.isNegative()||we.compareAbs(L)>=0;){ke=we.divmod(L),we=ke.quotient;var Ie=ke.remainder;Ie.isNegative()&&(Ie=L.minus(Ie).abs(),we=we.next()),fe.push(Ie.toJSNumber())}return fe.push(we.toJSNumber()),{value:fe.reverse(),isNegative:Z}}function de(A,L,Y){var Z=ce(A,L);return(Z.isNegative?"-":"")+Z.value.map(function(fe){return gt(fe,Y)}).join("")}c.prototype.toArray=function(A){return ce(this,A)},d.prototype.toArray=function(A){return ce(this,A)},u.prototype.toArray=function(A){return ce(this,A)},c.prototype.toString=function(A,L){if(A===t&&(A=10),A!==10||L)return de(this,A,L);for(var Y=this.value,Z=Y.length,fe=String(Y[--Z]),we="0000000",ke;--Z>=0;)ke=String(Y[Z]),fe+=we.slice(ke.length)+ke;var Ie=this.sign?"-":"";return Ie+fe},d.prototype.toString=function(A,L){return A===t&&(A=10),A!=10||L?de(this,A,L):String(this.value)},u.prototype.toString=d.prototype.toString,u.prototype.toJSON=c.prototype.toJSON=d.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,d.prototype.valueOf=function(){return this.value},d.prototype.toJSNumber=d.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function ye(A){if(h(+A)){var L=+A;if(L===y(L))return s?new u(BigInt(L)):new d(L);throw new Error("Invalid integer: "+A)}var Y=A[0]==="-";Y&&(A=A.slice(1));var Z=A.split(/e/i);if(Z.length>2)throw new Error("Invalid integer: "+Z.join("e"));if(Z.length===2){var fe=Z[1];if(fe[0]==="+"&&(fe=fe.slice(1)),fe=+fe,fe!==y(fe)||!h(fe))throw new Error("Invalid integer: "+fe+" is not a valid exponent.");var we=Z[0],ke=we.indexOf(".");if(ke>=0&&(fe-=we.length-ke-1,we=we.slice(0,ke)+we.slice(ke+1)),fe<0)throw new Error("Cannot include negative exponent part for integers");we+=new Array(fe+1).join("0"),A=we}var Ie=/^([0-9][0-9]*)$/.test(A);if(!Ie)throw new Error("Invalid integer: "+A);if(s)return new u(BigInt(Y?"-"+A:A));for(var ze=[],rt=A.length,yt=i,st=rt-yt;rt>0;)ze.push(+A.slice(st,rt)),st-=yt,st<0&&(st=0),rt-=yt;return m(ze),new c(ze,Y)}function Me(A){if(s)return new u(BigInt(A));if(h(A)){if(A!==y(A))throw new Error(A+" is not an integer.");return new d(A)}return ye(A.toString())}function pe(A){return typeof A=="number"?Me(A):typeof A=="string"?ye(A):typeof A=="bigint"?new u(A):A}for(var ue=0;ue<1e3;ue++)a[ue]=pe(ue),ue>0&&(a[-ue]=pe(-ue));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=We,a.min=Le,a.gcd=Ne,a.lcm=it,a.isInstance=function(A){return A instanceof c||A instanceof d||A instanceof u},a.randBetween=ct,a.fromArray=function(A,L,Y){return Se(A.map(pe),pe(L||10),Y)},a}();typeof bz<"u"&&bz.hasOwnProperty("exports")&&(bz.exports=$s);typeof define=="function"&&define.amd&&define(function(){return $s})});var $qe=z((arr,Yqe)=>{"use strict";var B0=Uqe(),_z=Ze("stream");(!_z.Writable||!_z.Writable.prototype.destroy)&&(_z=wg());var yz;function c$t(){var t=3988292384,e,i,r;for(yz=[],i=0;i<256;i++){for(e=i,r=0;r<8;r++)e=e&1?t^e>>>1:e=e>>>1;yz[i]=e>>>0}}function qqe(t,e){return yz||c$t(),t.charCodeAt&&(t=t.charCodeAt(0)),B0(e).shiftRight(8).and(16777215).xor(yz[B0(e).xor(t).and(255)]).value}function lR(){if(!(this instanceof lR))return new lR;this.key0=305419896,this.key1=591751049,this.key2=878082192}lR.prototype.update=function(t){this.key0=qqe(t,this.key0),this.key1=B0(this.key0).and(255).and(4294967295).add(this.key1),this.key1=B0(this.key1).multiply(134775813).add(1).and(4294967295).value,this.key2=qqe(B0(this.key1).shiftRight(24).and(255),this.key2)};lR.prototype.decryptByte=function(t){var e=B0(this.key2).or(2);return t=t^B0(e).multiply(B0(e^1)).shiftRight(8).and(255),this.update(t),t};lR.prototype.stream=function(){var t=_z.Transform(),e=this;return t._transform=function(i,r,n){for(var o=0;o<i.length;o++)i[o]=e.decryptByte(i[o]);this.push(i),n()},t};Yqe.exports=lR});var Xqe=z((lrr,Gqe)=>{"use strict";var d$t=N0(),u$t=$qe(),h$t=G8(),RP=Ze("stream"),f$t=ZN(),p$t=Ze("zlib"),m$t=Z8(),g$t=GT(),v$t=Q8();(!RP.Writable||!RP.Writable.prototype.destroy)&&(RP=wg());Gqe.exports=function(e,i,r,n){var o=h$t(),s=RP.PassThrough(),a=e.stream(i);return a.pipe(o).on("error",function(c){s.emit("error",c)}),s.vars=o.pull(30).then(function(c){var d=f$t.parse(c).word32lu("signature").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;return d.lastModifiedDateTime=v$t(d.lastModifiedDate,d.lastModifiedTime),o.pull(d.fileNameLength).then(function(u){return d.fileName=u.toString("utf8"),o.pull(d.extraFieldLength)}).then(function(u){var h;return d.extra=m$t(u,d),n&&n.compressedSize&&(d=n),d.flags&1&&(h=o.pull(12).then(function(p){if(!r)throw new Error("MISSING_PASSWORD");var f=u$t();String(r).split("").forEach(function(y){f.update(y)});for(var m=0;m<p.length;m++)p[m]=f.decryptByte(p[m]);d.decrypt=f,d.compressedSize-=12;var g=d.flags&8?d.lastModifiedTime>>8&255:d.crc32>>24&255;if(p[11]!==g)throw new Error("BAD_PASSWORD");return d})),d$t.resolve(h).then(function(){return s.emit("vars",d),d})})}),s.vars.then(function(c){var d=!(c.flags&8)||c.compressedSize>0,u,h=c.compressionMethod?p$t.createInflateRaw():RP.PassThrough();d?(s.size=c.uncompressedSize,u=c.compressedSize):(u=g$t.alloc(4),u.writeUInt32LE(134695760,0));var p=o.stream(u);c.decrypt&&(p=p.pipe(c.decrypt.stream())),p.pipe(h).on("error",function(f){s.emit("error",f)}).pipe(s).on("finish",function(){a.destroy?a.destroy():a.abort?a.abort():a.close?a.close():a.push?a.push():console.log("warning - unable to close stream")})}).catch(function(c){s.emit("error",c)}),s}});var Qqe=z((crr,Zqe)=>{"use strict";var DP=ZN(),IP=G8(),b$t=Xqe(),AP=N0(),_$t=K8(),y$t=Z8(),w$t=GT(),tce=Ze("path"),C$t=Jle().Writer,x$t=Q8(),Kqe=w$t.alloc(4);Kqe.writeUInt32LE(101010256,0);function S$t(t){var e=t.stream(0).pipe(IP());return e.pull(4).then(function(i){var r=i.readUInt32LE(0);if(r===875721283){var n;return e.pull(12).then(function(o){n=DP.parse(o).word32lu("version").word32lu("pubKeyLength").word32lu("signatureLength").vars}).then(function(){return e.pull(n.pubKeyLength+n.signatureLength)}).then(function(o){return n.publicKey=o.slice(0,n.pubKeyLength),n.signature=o.slice(n.pubKeyLength),n.size=16+n.pubKeyLength+n.signatureLength,n})}})}function E$t(t,e){var i=DP.parse(e).word32lu("signature").word32lu("diskNumber").word64lu("offsetToStartOfCentralDirectory").word32lu("numberOfDisks").vars;if(i.signature!=117853008)throw new Error("invalid zip64 end of central dir locator signature (0x07064b50): 0x"+i.signature.toString(16));var r=IP();return t.stream(i.offsetToStartOfCentralDirectory).pipe(r),r.pull(56)}function T$t(t){var e=DP.parse(t).word32lu("signature").word64lu("sizeOfCentralDirectory").word16lu("version").word16lu("versionsNeededToExtract").word32lu("diskNumber").word32lu("diskStart").word64lu("numberOfRecordsOnDisk").word64lu("numberOfRecords").word64lu("sizeOfCentralDirectory").word64lu("offsetToStartOfCentralDirectory").vars;if(e.signature!=101075792)throw new Error("invalid zip64 end of central dir locator signature (0x06064b50): 0x0"+e.signature.toString(16));return e}Zqe.exports=function(e,i){var r=IP(),n=IP(),o=i&&i.tailSize||80,s,a,c,d;return i&&i.crx&&(a=S$t(e)),e.size().then(function(u){return s=u,e.stream(Math.max(0,u-o)).on("error",function(h){r.emit("error",h)}).pipe(r),r.pull(Kqe)}).then(function(){return AP.props({directory:r.pull(22),crxHeader:a})}).then(function(u){var h=u.directory;if(c=u.crxHeader&&u.crxHeader.size||0,d=DP.parse(h).word32lu("signature").word16lu("diskNumber").word16lu("diskStart").word16lu("numberOfRecordsOnDisk").word16lu("numberOfRecords").word32lu("sizeOfCentralDirectory").word32lu("offsetToStartOfCentralDirectory").word16lu("commentLength").vars,d.numberOfRecords==65535||d.numberOfRecords==65535||d.offsetToStartOfCentralDirectory==4294967295){let f=s-(o-r.match+20),m=IP();return e.stream(f).pipe(m),m.pull(20).then(function(g){return E$t(e,g)}).then(function(g){d=T$t(g)})}else d.offsetToStartOfCentralDirectory+=c}).then(function(){if(d.commentLength)return r.pull(d.commentLength).then(function(u){d.comment=u.toString("utf8")})}).then(function(){return e.stream(d.offsetToStartOfCentralDirectory).pipe(n),d.extract=function(u){if(!u||!u.path)throw new Error("PATH_MISSING");return u.path=tce.resolve(tce.normalize(u.path)),d.files.then(function(h){return AP.map(h,function(p){if(p.type!="Directory"){var f=tce.join(u.path,p.path);if(f.indexOf(u.path)==0){var m=u.getWriter?u.getWriter({path:f}):C$t({path:f});return new AP(function(g,y){p.stream(u.password).on("error",y).pipe(m).on("close",g).on("error",y)})}}},{concurrency:u.concurrency>1?u.concurrency:1})})},d.files=AP.mapSeries(Array(d.numberOfRecords),function(){return n.pull(46).then(function(u){var h=DP.parse(u).word32lu("signature").word16lu("versionMadeBy").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumber").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("offsetToLocalFileHeader").vars;return h.offsetToLocalFileHeader+=c,h.lastModifiedDateTime=x$t(h.lastModifiedDate,h.lastModifiedTime),n.pull(h.fileNameLength).then(function(p){return h.pathBuffer=p,h.path=p.toString("utf8"),h.isUnicode=(h.flags&2048)!=0,n.pull(h.extraFieldLength)}).then(function(p){return h.extra=y$t(p,h),n.pull(h.fileCommentLength)}).then(function(p){return h.comment=p,h.type=h.uncompressedSize===0&&/[\/\\]$/.test(h.path)?"Directory":"File",h.stream=function(f){return b$t(e,h.offsetToLocalFileHeader,f,h)},h.buffer=function(f){return _$t(h.stream(f))},h})})}),AP.props(d)})}});var t7e=z((drr,e7e)=>{"use strict";var Jqe=jc(),wz=N0(),MP=Qqe(),Cz=Ze("stream");(!Cz.Writable||!Cz.Writable.prototype.destroy)&&(Cz=wg());e7e.exports={buffer:function(t,e){var i={stream:function(r,n){var o=Cz.PassThrough();return o.end(t.slice(r,n)),o},size:function(){return wz.resolve(t.length)}};return MP(i,e)},file:function(t,e){var i={stream:function(r,n){return Jqe.createReadStream(t,{start:r,end:n&&r+n})},size:function(){return new wz(function(r,n){Jqe.stat(t,function(o,s){o?n(o):r(s.size)})})}};return MP(i,e)},url:function(t,e,i){if(typeof e=="string"&&(e={url:e}),!e.url)throw"URL missing";e.headers=e.headers||{};var r={stream:function(n,o){var s=Object.create(e);return s.headers=Object.create(e.headers),s.headers.range="bytes="+n+"-"+(o||""),t(s)},size:function(){return new wz(function(n,o){var s=t(e);s.on("response",function(a){s.abort(),a.headers["content-length"]?n(a.headers["content-length"]):o(new Error("Missing content length header"))}).on("error",o)})}};return MP(r,i)},s3:function(t,e,i){var r={size:function(){return new wz(function(n,o){t.headObject(e,function(s,a){s?o(s):n(a.ContentLength)})})},stream:function(n,o){var s={};for(var a in e)s[a]=e[a];return s.Range="bytes="+n+"-"+(o||""),t.getObject(s).createReadStream()}};return MP(r,i)},custom:function(t,e){return MP(t,e)}}});var i7e=z(kP=>{"use strict";h8e();g8e();JZ();kP.Parse=J8();kP.ParseOne=YUe();kP.Extract=Wqe();kP.Open=t7e()});var b7e=z((hrr,Eg)=>{"use strict";var Ms=Ze("fs"),sce=Ze("os"),Ad=Ze("path"),r7e=Ze("crypto"),Ip={fs:Ms.constants,os:sce.constants},n7e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",s7e=/XXXXXX/,R$t=3,a7e=(Ip.O_CREAT||Ip.fs.O_CREAT)|(Ip.O_EXCL||Ip.fs.O_EXCL)|(Ip.O_RDWR||Ip.fs.O_RDWR),A$t=sce.platform()==="win32",I$t=Ip.EBADF||Ip.os.errno.EBADF,D$t=Ip.ENOENT||Ip.os.errno.ENOENT,l7e=448,c7e=384,M$t="exit",cR=[],d7e=Ms.rmdirSync.bind(Ms),u7e=!1;function k$t(t,e){return Ms.rm(t,{recursive:!0},e)}function h7e(t){return Ms.rmSync(t,{recursive:!0})}function ace(t,e){let i=dR(t,e),r=i[0],n=i[1];try{m7e(r)}catch(s){return n(s)}let o=r.tries;(function s(){try{let a=p7e(r);Ms.stat(a,function(c){if(!c)return o-- >0?s():n(new Error("Could not get a unique tmp filename, max tries reached "+a));n(null,a)})}catch(a){n(a)}})()}function lce(t){let e=dR(t),i=e[0];m7e(i);let r=i.tries;do{let n=p7e(i);try{Ms.statSync(n)}catch{return n}}while(r-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function O$t(t,e){let i=dR(t,e),r=i[0],n=i[1];ace(r,function(s,a){if(s)return n(s);Ms.open(a,a7e,r.mode||c7e,function(d,u){if(d)return n(d);if(r.discardDescriptor)return Ms.close(u,function(p){return n(p,a,void 0,rce(a,-1,r,!1))});{let h=r.discardDescriptor||r.detachDescriptor;n(null,a,u,rce(a,h?-1:u,r,!1))}})})}function N$t(t){let e=dR(t),i=e[0],r=i.discardDescriptor||i.detachDescriptor,n=lce(i);var o=Ms.openSync(n,a7e,i.mode||c7e);return i.discardDescriptor&&(Ms.closeSync(o),o=void 0),{name:n,fd:o,removeCallback:rce(n,r?-1:o,i,!0)}}function P$t(t,e){let i=dR(t,e),r=i[0],n=i[1];ace(r,function(s,a){if(s)return n(s);Ms.mkdir(a,r.mode||l7e,function(d){if(d)return n(d);n(null,a,f7e(a,r,!1))})})}function L$t(t){let e=dR(t),i=e[0],r=lce(i);return Ms.mkdirSync(r,i.mode||l7e),{name:r,removeCallback:f7e(r,i,!0)}}function F$t(t,e){let i=function(r){if(r&&!oce(r))return e(r);e()};0<=t[0]?Ms.close(t[0],function(){Ms.unlink(t[1],i)}):Ms.unlink(t[1],i)}function H$t(t){let e=null;try{0<=t[0]&&Ms.closeSync(t[0])}catch(i){if(!j$t(i)&&!oce(i))throw i}finally{try{Ms.unlinkSync(t[1])}catch(i){oce(i)||(e=i)}}if(e!==null)throw e}function rce(t,e,i,r){let n=xz(H$t,[e,t],r),o=xz(F$t,[e,t],r,n);return i.keep||cR.unshift(n),r?n:o}function f7e(t,e,i){let r=e.unsafeCleanup?k$t:Ms.rmdir.bind(Ms),n=e.unsafeCleanup?h7e:d7e,o=xz(n,t,i),s=xz(r,t,i,o);return e.keep||cR.unshift(o),i?o:s}function xz(t,e,i,r){let n=!1;return function o(s){if(!n){let a=r||o,c=cR.indexOf(a);return c>=0&&cR.splice(c,1),n=!0,i||t===d7e||t===h7e?t(e):t(e,s||function(){})}}}function B$t(){if(u7e)for(;cR.length;)try{cR[0]()}catch{}}function o7e(t){let e=[],i=null;try{i=r7e.randomBytes(t)}catch{i=r7e.pseudoRandomBytes(t)}for(var r=0;r<t;r++)e.push(n7e[i[r]%n7e.length]);return e.join("")}function V$t(t){return t===null||zc(t)||!t.trim()}function zc(t){return typeof t>"u"}function dR(t,e){if(typeof t=="function")return[{},t];if(zc(t))return[{},e];let i={};for(let r of Object.getOwnPropertyNames(t))i[r]=t[r];return[i,e]}function p7e(t){let e=t.tmpdir;if(!zc(t.name))return Ad.join(e,t.dir,t.name);if(!zc(t.template))return Ad.join(e,t.dir,t.template).replace(s7e,o7e(6));let i=[t.prefix?t.prefix:"tmp","-",process.pid,"-",o7e(12),t.postfix?"-"+t.postfix:""].join("");return Ad.join(e,t.dir,i)}function m7e(t){t.tmpdir=v7e(t);let e=t.tmpdir;if(zc(t.name)||ice(t.name,"name",e),zc(t.dir)||ice(t.dir,"dir",e),!zc(t.template)&&(ice(t.template,"template",e),!t.template.match(s7e)))throw new Error(`Invalid template, found "${t.template}".`);if(!zc(t.tries)&&isNaN(t.tries)||t.tries<0)throw new Error(`Invalid tries, found "${t.tries}".`);t.tries=zc(t.name)?t.tries||R$t:1,t.keep=!!t.keep,t.detachDescriptor=!!t.detachDescriptor,t.discardDescriptor=!!t.discardDescriptor,t.unsafeCleanup=!!t.unsafeCleanup,t.dir=zc(t.dir)?"":Ad.relative(e,nce(t.dir,e)),t.template=zc(t.template)?void 0:Ad.relative(e,nce(t.template,e)),t.template=V$t(t.template)?void 0:Ad.relative(t.dir,t.template),t.name=zc(t.name)?void 0:t.name,t.prefix=zc(t.prefix)?"":t.prefix,t.postfix=zc(t.postfix)?"":t.postfix}function nce(t,e){return t.startsWith(e)?Ad.resolve(t):Ad.resolve(Ad.join(e,t))}function ice(t,e,i){if(e==="name"){if(Ad.isAbsolute(t))throw new Error(`${e} option must not contain an absolute path, found "${t}".`);let r=Ad.basename(t);if(r===".."||r==="."||r!==t)throw new Error(`${e} option must not contain a path, found "${t}".`)}else{if(Ad.isAbsolute(t)&&!t.startsWith(i))throw new Error(`${e} option must be relative to "${i}", found "${t}".`);let r=nce(t,i);if(!r.startsWith(i))throw new Error(`${e} option must be relative to "${i}", found "${r}".`)}}function j$t(t){return g7e(t,-I$t,"EBADF")}function oce(t){return g7e(t,-D$t,"ENOENT")}function g7e(t,e,i){return A$t?t.code===i:t.code===i&&t.errno===e}function z$t(){u7e=!0}function v7e(t){return Ad.resolve(t&&t.tmpdir||sce.tmpdir())}process.addListener(M$t,B$t);Object.defineProperty(Eg.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return v7e()}});Eg.exports.dir=P$t;Eg.exports.dirSync=L$t;Eg.exports.file=O$t;Eg.exports.fileSync=N$t;Eg.exports.tmpName=ace;Eg.exports.tmpNameSync=lce;Eg.exports.setGracefulCleanup=z$t});var y7e=z((frr,_7e)=>{"use strict";_7e.exports=function(e){return dc(this,null,function*(){let i=[];e.on("data",a=>i.push(a));let r,n=new Promise(a=>r=a),o=!1;e.on("end",()=>{o=!0,r()});let s=!1;for(e.on("error",a=>{s=a,r()});!o||i.length>0;)if(i.length===0?(e.resume(),yield new _o(Promise.race([W$t(e,"data"),n]))):(e.pause(),yield i.shift()),s)throw s;r()})};function W$t(t,e){return new Promise(i=>{let r=!1,n=()=>{r||(r=!0,t.removeListener(e,n),i())};t.addListener(e,n)})}});var S7e=z((mrr,x7e)=>{"use strict";var{EventEmitter:U$t}=Ze("events"),q$t=Y2(),Y$t=Go(),Sz=yl(),w7e=Oo(),$$t=Wm(),G$t=M4(),C7e=k4(),cce=class extends U$t{constructor({workbook:e,id:i,iterator:r,options:n}){super(),this.workbook=e,this.id=i,this.iterator=r,this.options=n||{},this.name=`Sheet${this.id}`,this._columns=null,this._keys={},this._dimensions=new $$t}destroy(){throw new Error("Invalid Operation: destroy")}get dimensions(){return this._dimensions}get columns(){return this._columns}getColumn(e){if(typeof e=="string"){let i=this._keys[e];if(i)return i;e=w7e.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let i=this._columns.length+1;for(;i<=e;)this._columns.push(new C7e(this,i++))}return this._columns[e-1]}getColumnKey(e){return this._keys[e]}setColumnKey(e,i){this._keys[e]=i}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){Y$t.each(this._keys,e)}read(){return Ei(this,null,function*(){try{try{for(var e=Ea(this.parse()),i,r,n;i=!(r=yield e.next()).done;i=!1){let o=r.value;for(let{eventType:s,value:a}of o)this.emit(s,a)}}catch{n=[r]}finally{try{i&&(r=e.return)&&(yield r.call(e))}finally{if(n)throw n[0]}}this.emit("finished")}catch(o){this.emit("error",o)}})}[Symbol.asyncIterator](){return dc(this,null,function*(){try{for(var e=Ea(this.parse()),i,r,n;i=!(r=yield new _o(e.next())).done;i=!1){let o=r.value;for(let{eventType:s,value:a}of o)s==="row"&&(yield a)}}catch{n=[r]}finally{try{i&&(r=e.return)&&(yield new _o(r.call(e)))}finally{if(n)throw n[0]}}})}parse(){return dc(this,null,function*(){let{iterator:e,options:i}=this,r=!1,n=!1,o=null;switch(i.worksheets){case"emit":r=!0;break;case"prep":break;default:break}switch(i.hyperlinks){case"emit":n=!0;break;case"cache":this.hyperlinks=o={};break;default:break}if(!r&&!n&&!o)return;let{sharedStrings:s,styles:a,properties:c}=this.workbook,d=!1,u=!1,h=!1,p=null,f=null,m=null,g=null;try{for(var y=Ea(q$t(e)),w,x,T;w=!(x=yield new _o(y.next())).done;w=!1){let M=x.value;let B=[];for(let{eventType:G,value:F}of M)if(G==="opentag"){let O=F;if(r)switch(O.name){case"cols":d=!0,p=[];break;case"sheetData":u=!0;break;case"col":d&&p.push({min:parseInt(O.attributes.min,10),max:parseInt(O.attributes.max,10),width:parseFloat(O.attributes.width),styleId:parseInt(O.attributes.style||"0",10)});break;case"row":if(u){let V=parseInt(O.attributes.r,10);if(f=new G$t(this,V),O.attributes.ht&&(f.height=parseFloat(O.attributes.ht)),O.attributes.s){let J=parseInt(O.attributes.s,10),N=a.getStyleModel(J);N&&(f.style=N)}}break;case"c":f&&(m={ref:O.attributes.r,s:parseInt(O.attributes.s,10),t:O.attributes.t});break;case"f":m&&(g=m.f={text:""});break;case"v":m&&(g=m.v={text:""});break;case"is":case"t":m&&(g=m.v={text:""});break;case"mergeCell":break;default:break}if(n||o)switch(O.name){case"hyperlinks":h=!0;break;case"hyperlink":if(h){let V={ref:O.attributes.ref,rId:O.attributes["r:id"]};n?B.push({eventType:"hyperlink",value:V}):o[V.ref]=V}break;default:break}}else if(G==="text")r&&g&&(g.text+=F);else if(G==="closetag"){let O=F;if(r)switch(O.name){case"cols":d=!1,this._columns=C7e.fromModel(p);break;case"sheetData":u=!1;break;case"row":this._dimensions.expandRow(f),B.push({eventType:"row",value:f}),f=null;break;case"c":if(f&&m){let V=w7e.decodeAddress(m.ref),J=f.getCell(V.col);if(m.s){let N=a.getStyleModel(m.s);N&&(J.style=N)}if(m.f){let N={formula:m.f.text};m.v&&(m.t==="str"?N.result=Sz.xmlDecode(m.v.text):N.result=parseFloat(m.v.text)),J.value=N}else if(m.v)switch(m.t){case"s":{let N=parseInt(m.v.text,10);s?J.value=s[N]:J.value={sharedString:N};break}case"inlineStr":case"str":J.value=Sz.xmlDecode(m.v.text);break;case"e":J.value={error:m.v.text};break;case"b":J.value=parseInt(m.v.text,10)!==0;break;default:Sz.isDateFmt(J.numFmt)?J.value=Sz.excelToDate(parseFloat(m.v.text),c.model&&c.model.date1904):J.value=parseFloat(m.v.text);break}if(o){let N=o[m.ref];N&&(J.text=J.value,J.value=void 0,J.hyperlink=N)}m=null}break;default:break}if(n||o)switch(O.name){case"hyperlinks":h=!1;break;default:break}}B.length>0&&(yield B)}}catch{T=[x]}finally{try{w&&(x=y.return)&&(yield new _o(x.call(y)))}finally{if(T)throw T[0]}}})}};x7e.exports=cce});var T7e=z((vrr,E7e)=>{"use strict";var{EventEmitter:X$t}=Ze("events"),K$t=Y2(),Z$t=wh(),Q$t=s0(),dce=class extends X$t{constructor({workbook:e,id:i,iterator:r,options:n}){super(),this.workbook=e,this.id=i,this.iterator=r,this.options=n}get count(){return this.hyperlinks&&this.hyperlinks.length||0}each(e){return this.hyperlinks.forEach(e)}read(){return Ei(this,null,function*(){let{iterator:e,options:i}=this,r=!1,n=null;switch(i.hyperlinks){case"emit":r=!0;break;case"cache":this.hyperlinks=n={};break;default:break}if(!r&&!n){this.emit("finished");return}try{try{for(var o=Ea(K$t(e)),s,a,c;s=!(a=yield o.next()).done;s=!1){let d=a.value;for(let{eventType:u,value:h}of d)if(u==="opentag"){let p=h;if(p.name==="Relationship"){let f=p.attributes.Id;switch(p.attributes.Type){case Q$t.Hyperlink:{let m={type:Z$t.RelationshipType.Styles,rId:f,target:p.attributes.Target,targetMode:p.attributes.TargetMode};r?this.emit("hyperlink",m):n[m.rId]=m}break;default:break}}}}}catch{c=[a]}finally{try{s&&(a=o.return)&&(yield a.call(o))}finally{if(c)throw c[0]}}this.emit("finished")}catch(d){this.emit("error",d)}})}};E7e.exports=dce});var D7e=z((_rr,I7e)=>{"use strict";var uce=Ze("fs"),{EventEmitter:J$t}=Ze("events"),{PassThrough:eGt,Readable:tGt}=_l(),iGt=Ze("stream"),rGt=i7e(),A7e=b7e(),uC=y7e(),nGt=Y2(),R7e=sj(),oGt=cj(),sGt=lj(),aGt=S7e(),lGt=T7e();A7e.setGracefulCleanup();var cGt=(()=>{class t extends J$t{constructor(i,r={}){super(),this.input=i,this.options=Ke({worksheets:"emit",sharedStrings:"cache",hyperlinks:"ignore",styles:"ignore",entries:"ignore"},r),this.styles=new R7e,this.styles.init()}_getStream(i){if(i instanceof iGt.Readable||i instanceof tGt)return i;if(typeof i=="string")return uce.createReadStream(i);throw new Error(`Could not recognise input: ${i}`)}read(i,r){return Ei(this,null,function*(){try{try{for(var n=Ea(this.parse(i,r)),o,s,a;o=!(s=yield n.next()).done;o=!1){let{eventType:c,value:d}=s.value;switch(c){case"shared-strings":this.emit(c,d);break;case"worksheet":this.emit(c,d),yield d.read();break;case"hyperlinks":this.emit(c,d);break}}}catch{a=[s]}finally{try{o&&(s=n.return)&&(yield s.call(n))}finally{if(a)throw a[0]}}this.emit("end"),this.emit("finished")}catch(c){this.emit("error",c)}})}[Symbol.asyncIterator](){return dc(this,null,function*(){try{for(var i=Ea(this.parse()),r,n,o;r=!(n=yield new _o(i.next())).done;r=!1){let{eventType:s,value:a}=n.value;s==="worksheet"&&(yield a)}}catch{o=[n]}finally{try{r&&(n=i.return)&&(yield new _o(n.call(i)))}finally{if(o)throw o[0]}}})}parse(i,r){return dc(this,null,function*(){r&&(this.options=r);let n=this.stream=this._getStream(i||this.input),o=rGt.Parse({forceStream:!0});n.pipe(o);let s=[];try{for(var a=Ea(uC(o)),c,d,u;c=!(d=yield new _o(a.next())).done;c=!1){let h=d.value;let p,f;switch(h.path){case"_rels/.rels":break;case"xl/_rels/workbook.xml.rels":yield new _o(this._parseRels(h));break;case"xl/workbook.xml":yield new _o(this._parseWorkbook(h));break;case"xl/sharedStrings.xml":yield*af(this._parseSharedStrings(h));break;case"xl/styles.xml":yield new _o(this._parseStyles(h));break;default:h.path.match(/xl\/worksheets\/sheet\d+[.]xml/)?(p=h.path.match(/xl\/worksheets\/sheet(\d+)[.]xml/),f=p[1],this.sharedStrings&&this.workbookRels?yield*af(this._parseWorksheet(uC(h),f)):yield new _o(new Promise((m,g)=>{A7e.file((y,w,x,T)=>{if(y)return g(y);s.push({sheetNo:f,path:w,tempFileCleanupCallback:T});let M=uce.createWriteStream(w);return M.on("error",g),h.pipe(M),M.on("finish",()=>m())})}))):h.path.match(/xl\/worksheets\/_rels\/sheet\d+[.]xml.rels/)&&(p=h.path.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),f=p[1],yield*af(this._parseHyperlinks(uC(h),f)));break}h.autodrain()}}catch{u=[d]}finally{try{c&&(d=a.return)&&(yield new _o(d.call(a)))}finally{if(u)throw u[0]}}for(let{sheetNo:h,path:p,tempFileCleanupCallback:f}of s){let m=uce.createReadStream(p);m[Symbol.asyncIterator]||(m=m.pipe(new eGt)),yield*af(this._parseWorksheet(m,h)),f()}})}_emitEntry(i){this.options.entries==="emit"&&this.emit("entry",i)}_parseRels(i){return Ei(this,null,function*(){let r=new sGt;this.workbookRels=yield r.parseStream(uC(i))})}_parseWorkbook(i){return Ei(this,null,function*(){this._emitEntry({type:"workbook"});let r=new oGt;yield r.parseStream(uC(i)),this.properties=r.map.workbookPr,this.model=r.model})}_parseSharedStrings(i){return dc(this,null,function*(){switch(this._emitEntry({type:"shared-strings"}),this.options.sharedStrings){case"cache":this.sharedStrings=[];break;case"emit":break;default:return}let r=null,n=[],o=0,s=null;try{for(var a=Ea(nGt(uC(i))),c,d,u;c=!(d=yield new _o(a.next())).done;c=!1){let h=d.value;for(let{eventType:p,value:f}of h)if(p==="opentag"){let m=f;switch(m.name){case"b":s=s||{},s.bold=!0;break;case"charset":s=s||{},s.charset=parseInt(m.attributes.charset,10);break;case"color":s=s||{},s.color={},m.attributes.rgb&&(s.color.argb=m.attributes.argb),m.attributes.val&&(s.color.argb=m.attributes.val),m.attributes.theme&&(s.color.theme=m.attributes.theme);break;case"family":s=s||{},s.family=parseInt(m.attributes.val,10);break;case"i":s=s||{},s.italic=!0;break;case"outline":s=s||{},s.outline=!0;break;case"rFont":s=s||{},s.name=m.value;break;case"si":s=null,n=[],r=null;break;case"sz":s=s||{},s.size=parseInt(m.attributes.val,10);break;case"strike":break;case"t":r=null;break;case"u":s=s||{},s.underline=!0;break;case"vertAlign":s=s||{},s.vertAlign=m.attributes.val;break}}else if(p==="text")r=r?r+f:f;else if(p==="closetag")switch(f.name){case"r":n.push({font:s,text:r}),s=null,r=null;break;case"si":this.options.sharedStrings==="cache"?this.sharedStrings.push(n.length?{richText:n}:r):this.options.sharedStrings==="emit"&&(yield{index:o++,text:n.length?{richText:n}:r}),n=[],s=null,r=null;break}}}catch{u=[d]}finally{try{c&&(d=a.return)&&(yield new _o(d.call(a)))}finally{if(u)throw u[0]}}})}_parseStyles(i){return Ei(this,null,function*(){this._emitEntry({type:"styles"}),this.options.styles==="cache"&&(this.styles=new R7e,yield this.styles.parseStream(uC(i)))})}*_parseWorksheet(i,r){this._emitEntry({type:"worksheet",id:r});let n=new aGt({workbook:this,id:r,iterator:i,options:this.options}),o=(this.workbookRels||[]).find(a=>a.Target===`worksheets/sheet${r}.xml`),s=o&&(this.model.sheets||[]).find(a=>a.rId===o.Id);s&&(n.id=s.id,n.name=s.name,n.state=s.state),this.options.worksheets==="emit"&&(yield{eventType:"worksheet",value:n})}*_parseHyperlinks(i,r){this._emitEntry({type:"hyperlinks",id:r});let n=new lGt({workbook:this,id:r,iterator:i,options:this.options});this.options.hyperlinks==="emit"&&(yield{eventType:"hyperlinks",value:n})}}return t.Options={worksheets:["emit","ignore"],sharedStrings:["cache","emit","ignore"],hyperlinks:["cache","emit","ignore"],styles:["cache","ignore"],entries:["emit","ignore"]},t})();I7e.exports=cGt});var O7e=z((wrr,k7e)=>{"use strict";var M7e={Workbook:SHe(),ModelContainer:THe(),stream:{xlsx:{WorkbookWriter:d8e(),WorkbookReader:D7e()}}};Object.assign(M7e,wh());k7e.exports=M7e});var P7e=z((Crr,N7e)=>{"use strict";if(parseInt(process.versions.node.split(".")[0],10)<10)throw new Error("For node versions older than 10, please use the ES5 Import: https://github.com/exceljs/exceljs#es5-imports");N7e.exports=O7e()});var L7e=z((hce,fce)=>{"use strict";(function(t,e){typeof define=="function"&&define.amd?define([],e):typeof hce<"u"?e():(e(),t.FileSaver={})})(hce,function(){"use strict";function t(a,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function e(a,c,d){var u=new XMLHttpRequest;u.open("GET",a),u.responseType="blob",u.onload=function(){s(u.response,c,d)},u.onerror=function(){console.error("could not download file")},u.send()}function i(a){var c=new XMLHttpRequest;c.open("HEAD",a,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function r(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(c)}}var n=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,o=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=n.saveAs||(typeof window!="object"||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(a,c,d){var u=n.URL||n.webkitURL,h=document.createElement("a");c=c||a.name||"download",h.download=c,h.rel="noopener",typeof a=="string"?(h.href=a,h.origin===location.origin?r(h):i(h.href)?e(a,c,d):r(h,h.target="_blank")):(h.href=u.createObjectURL(a),setTimeout(function(){u.revokeObjectURL(h.href)},4e4),setTimeout(function(){r(h)},0))}:"msSaveOrOpenBlob"in navigator?function(a,c,d){if(c=c||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(t(a,d),c);else if(i(a))e(a,c,d);else{var u=document.createElement("a");u.href=a,u.target="_blank",setTimeout(function(){r(u)})}}:function(a,c,d,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof a=="string")return e(a,c,d);var h=a.type==="application/octet-stream",p=/constructor/i.test(n.HTMLElement)||n.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent);if((f||h&&p||o)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var w=m.result;w=f?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=w:location=w,u=null},m.readAsDataURL(a)}else{var g=n.URL||n.webkitURL,y=g.createObjectURL(a);u?u.location=y:location.href=y,u=null,setTimeout(function(){g.revokeObjectURL(y)},4e4)}});n.saveAs=s.saveAs=s,typeof fce<"u"&&(fce.exports=s)})});var NW;try{NW=typeof Intl<"u"&&Intl.v8BreakIterator}catch{NW=!1}var yr=(()=>{let e=class e{constructor(r){this._platformId=r,this.isBrowser=this._platformId?Ede(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||NW)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(n){return new(n||e)(lt(lde))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ix,$de=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function PW(){if(ix)return ix;if(typeof document!="object"||!document)return ix=new Set($de),ix;let t=document.createElement("input");return ix=new Set($de.filter(e=>(t.setAttribute("type",e),t.type===e))),ix}var lA;function RYe(){if(lA==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>lA=!0}))}finally{lA=lA||!1}return lA}function pc(t){return RYe()?t:!!t.capture}var __;function Gde(){if(__==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return __=!1,__;if("scrollBehavior"in document.documentElement.style)__=!0;else{let t=Element.prototype.scrollTo;t?__=!/\{\s*\[native code\]\s*\}/.test(t.toString()):__=!1}}return __}var OW;function AYe(){if(OW==null){let t=typeof document<"u"?document.head:null;OW=!!(t&&(t.createShadowRoot||t.attachShadow))}return OW}function Xde(t){if(AYe()){let e=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function tv(){let t=typeof document<"u"&&document?document.activeElement:null;for(;t&&t.shadowRoot;){let e=t.shadowRoot.activeElement;if(e===t)break;t=e}return t}function td(t){return t.composedPath?t.composedPath()[0]:t.target}function cA(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function jo(t,...e){return e.length?e.some(i=>t[i]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}function y_(t){return Qg(t)?t:qi(t)}function hf(t){return t!=null&&`${t}`!="false"}function Zp(t,e=0){return IYe(t)?Number(t):arguments.length===2?e:0}function IYe(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}function rx(t){return Array.isArray(t)?t:[t]}function os(t){return t==null?"":typeof t=="string"?t:`${t}px`}function Hd(t){return t instanceof qt?t.nativeElement:t}function Kde(t,e=/\s+/){let i=[];if(t!=null){let r=Array.isArray(t)?t:`${t}`.split(e);for(let n of r){let o=`${n}`.trim();o&&i.push(o)}}return i}var DYe=(()=>{let e=class e{create(r){return typeof MutationObserver>"u"?null:new MutationObserver(r)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var nx=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({providers:[DYe]});let t=e;return t})();var Zde=new Set,w_,MYe=(()=>{let e=class e{constructor(r,n){this._platform=r,this._nonce=n,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):OYe}matchMedia(r){return(this._platform.WEBKIT||this._platform.BLINK)&&kYe(r,this._nonce),this._matchMedia(r)}};e.\u0275fac=function(n){return new(n||e)(lt(yr),lt(cde,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kYe(t,e){if(!Zde.has(t))try{w_||(w_=document.createElement("style"),e&&w_.setAttribute("nonce",e),w_.setAttribute("type","text/css"),document.head.appendChild(w_)),w_.sheet&&(w_.sheet.insertRule(`@media ${t} {body{ }}`,0),Zde.add(t))}catch(i){console.error(i)}}function OYe(t){return{matches:t==="all"||t==="",media:t,addListener:()=>{},removeListener:()=>{}}}var Jde=(()=>{let e=class e{constructor(r,n){this._mediaMatcher=r,this._zone=n,this._queries=new Map,this._destroySubject=new Ft}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(r){return Qde(rx(r)).some(o=>this._registerQuery(o).mql.matches)}observe(r){let o=Qde(rx(r)).map(a=>this._registerQuery(a).observable),s=Jg(o);return s=KR(s.pipe(Vo(1)),s.pipe(cL(1),lL(0))),s.pipe(Gi(a=>{let c={matches:!1,breakpoints:{}};return a.forEach(({matches:d,query:u})=>{c.matches=c.matches||d,c.breakpoints[u]=d}),c}))}_registerQuery(r){if(this._queries.has(r))return this._queries.get(r);let n=this._mediaMatcher.matchMedia(r),s={observable:new m_(a=>{let c=d=>this._zone.run(()=>a.next(d));return n.addListener(c),()=>{n.removeListener(c)}}).pipe(Fs(n),Gi(({matches:a})=>({query:r,matches:a})),Hr(this._destroySubject)),mql:n};return this._queries.set(r,s),s}};e.\u0275fac=function(n){return new(n||e)(lt(MYe),lt(ni))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Qde(t){return t.map(e=>e.split(",")).reduce((e,i)=>e.concat(i)).map(e=>e.trim())}var nue=" ";function WW(t,e,i){let r=EL(t,e);i=i.trim(),!r.some(n=>n.trim()===i)&&(r.push(i),t.setAttribute(e,r.join(nue)))}function AL(t,e,i){let r=EL(t,e);i=i.trim();let n=r.filter(o=>o!==i);n.length?t.setAttribute(e,n.join(nue)):t.removeAttribute(e)}function EL(t,e){return t.getAttribute(e)?.match(/\S+/g)??[]}var oue="cdk-describedby-message",CL="cdk-describedby-host",HW=0,sue=(()=>{let e=class e{constructor(r,n){this._platform=n,this._messageRegistry=new Map,this._messagesContainer=null,this._id=`${HW++}`,this._document=r,this._id=Jt(ade)+"-"+HW++}describe(r,n,o){if(!this._canBeDescribed(r,n))return;let s=LW(n,o);typeof n!="string"?(eue(n,this._id),this._messageRegistry.set(s,{messageElement:n,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(n,o),this._isElementDescribedByMessage(r,s)||this._addMessageReference(r,s)}removeDescription(r,n,o){if(!n||!this._isElementNode(r))return;let s=LW(n,o);if(this._isElementDescribedByMessage(r,s)&&this._removeMessageReference(r,s),typeof n=="string"){let a=this._messageRegistry.get(s);a&&a.referenceCount===0&&this._deleteMessageElement(s)}this._messagesContainer?.childNodes.length===0&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){let r=this._document.querySelectorAll(`[${CL}="${this._id}"]`);for(let n=0;n<r.length;n++)this._removeCdkDescribedByReferenceIds(r[n]),r[n].removeAttribute(CL);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(r,n){let o=this._document.createElement("div");eue(o,this._id),o.textContent=r,n&&o.setAttribute("role",n),this._createMessagesContainer(),this._messagesContainer.appendChild(o),this._messageRegistry.set(LW(r,n),{messageElement:o,referenceCount:0})}_deleteMessageElement(r){this._messageRegistry.get(r)?.messageElement?.remove(),this._messageRegistry.delete(r)}_createMessagesContainer(){if(this._messagesContainer)return;let r="cdk-describedby-message-container",n=this._document.querySelectorAll(`.${r}[platform="server"]`);for(let s=0;s<n.length;s++)n[s].remove();let o=this._document.createElement("div");o.style.visibility="hidden",o.classList.add(r),o.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&o.setAttribute("platform","server"),this._document.body.appendChild(o),this._messagesContainer=o}_removeCdkDescribedByReferenceIds(r){let n=EL(r,"aria-describedby").filter(o=>o.indexOf(oue)!=0);r.setAttribute("aria-describedby",n.join(" "))}_addMessageReference(r,n){let o=this._messageRegistry.get(n);WW(r,"aria-describedby",o.messageElement.id),r.setAttribute(CL,this._id),o.referenceCount++}_removeMessageReference(r,n){let o=this._messageRegistry.get(n);o.referenceCount--,AL(r,"aria-describedby",o.messageElement.id),r.removeAttribute(CL)}_isElementDescribedByMessage(r,n){let o=EL(r,"aria-describedby"),s=this._messageRegistry.get(n),a=s&&s.messageElement.id;return!!a&&o.indexOf(a)!=-1}_canBeDescribed(r,n){if(!this._isElementNode(r))return!1;if(n&&typeof n=="object")return!0;let o=n==null?"":`${n}`.trim(),s=r.getAttribute("aria-label");return o?!s||s.trim()!==o:!1}_isElementNode(r){return r.nodeType===this._document.ELEMENT_NODE}};e.\u0275fac=function(n){return new(n||e)(lt(ir),lt(yr))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function LW(t,e){return typeof t=="string"?`${e||""}/${t}`:t}function eue(t,e){t.id||(t.id=`${oue}-${e}-${HW++}`)}var WYe=200,TL=class{constructor(e,i){this._letterKeyStream=new Ft,this._items=[],this._selectedItemIndex=-1,this._pressedLetters=[],this._selectedItem=new Ft,this.selectedItem=this._selectedItem;let r=typeof i?.debounceInterval=="number"?i.debounceInterval:WYe;i?.skipPredicate&&(this._skipPredicateFn=i.skipPredicate),this.setItems(e),this._setupKeyHandler(r)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(e){this._selectedItemIndex=e}setItems(e){this._items=e}handleKey(e){let i=e.keyCode;e.key&&e.key.length===1?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(i>=65&&i<=90||i>=48&&i<=57)&&this._letterKeyStream.next(String.fromCharCode(i))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(e){this._letterKeyStream.pipe(Qc(i=>this._pressedLetters.push(i)),lL(e),Ls(()=>this._pressedLetters.length>0),Gi(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(i=>{for(let r=1;r<this._items.length+1;r++){let n=(this._selectedItemIndex+r)%this._items.length,o=this._items[n];if(!this._skipPredicateFn?.(o)&&o.getLabel?.().toLocaleUpperCase().trim().indexOf(i)===0){this._selectedItem.next(o);break}}this._pressedLetters=[]})}},BW=class{constructor(e,i){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._typeaheadSubscription=jn.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=r=>r.disabled,this.tabOut=new Ft,this.change=new Ft,e instanceof eA?this._itemChangesSubscription=e.changes.subscribe(r=>this._itemsChanged(r.toArray())):bW(e)&&(this._effectRef=xde(()=>this._itemsChanged(e()),{injector:i}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){this._typeaheadSubscription.unsubscribe();let i=this._getItemsArray();return this._typeahead=new TL(i,{debounceInterval:typeof e=="number"?e:void 0,skipPredicate:r=>this._skipPredicateFn(r)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(r=>{this.setActiveItem(r)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,i=10){return this._pageUpAndDown={enabled:e,delta:i},this}setActiveItem(e){let i=this._activeItem;this.updateActiveItem(e),this._activeItem!==i&&this.change.next(this._activeItemIndex)}onKeydown(e){let i=e.keyCode,n=["altKey","ctrlKey","metaKey","shiftKey"].every(o=>!e[o]||this._allowedModifierKeys.indexOf(o)>-1);switch(i){case 9:this.tabOut.next();return;case 40:if(this._vertical&&n){this.setNextItemActive();break}else return;case 38:if(this._vertical&&n){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&n){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&n){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&n){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&n){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&n){let o=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(o>0?o:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&n){let o=this._activeItemIndex+this._pageUpAndDown.delta,s=this._getItemsArray().length;this._setActiveItemByIndex(o<s?o:s-1,-1);break}else return;default:(n||jo(e,"shiftKey"))&&this._typeahead?.handleKey(e);return}this._typeahead?.reset(),e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){let i=this._getItemsArray(),r=typeof e=="number"?e:i.indexOf(e),n=i[r];this._activeItem=n??null,this._activeItemIndex=r,this._typeahead?.setCurrentSelectedItemIndex(r)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){let i=this._getItemsArray();for(let r=1;r<=i.length;r++){let n=(this._activeItemIndex+e*r+i.length)%i.length,o=i[n];if(!this._skipPredicateFn(o)){this.setActiveItem(n);return}}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,i){let r=this._getItemsArray();if(r[e]){for(;this._skipPredicateFn(r[e]);)if(e+=i,!r[e])return;this.setActiveItem(e)}}_getItemsArray(){return bW(this._items)?this._items():this._items instanceof eA?this._items.toArray():this._items}_itemsChanged(e){if(this._typeahead?.setItems(e),this._activeItem){let i=e.indexOf(this._activeItem);i>-1&&i!==this._activeItemIndex&&(this._activeItemIndex=i,this._typeahead?.setCurrentSelectedItemIndex(i))}}},RL=class extends BW{setActiveItem(e){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(e),this.activeItem&&this.activeItem.setActiveStyles()}};var VW=class{_initializeFocus(){if(this._hasInitialFocused||this._items.length===0)return;let e=0;for(let r=0;r<this._items.length;r++)if(!this._skipPredicateFn(this._items[r])&&!this._isItemDisabled(this._items[r])){e=r;break}let i=this._items[e];i.makeFocusable?(this._activeItem?.unfocus(),this._activeItemIndex=e,this._activeItem=i,this._typeahead?.setCurrentSelectedItemIndex(e),i.makeFocusable()):this.focusItem(e),this._hasInitialFocused=!0}constructor(e,i){this._activeItemIndex=-1,this._activeItem=null,this._shouldActivationFollowFocus=!1,this._horizontalOrientation="ltr",this._skipPredicateFn=r=>!1,this._trackByFn=r=>r,this._items=[],this._typeaheadSubscription=jn.EMPTY,this._hasInitialFocused=!1,this.change=new Ft,e instanceof eA?(this._items=e.toArray(),e.changes.subscribe(r=>{this._items=r.toArray(),this._typeahead?.setItems(this._items),this._updateActiveItemIndex(this._items),this._initializeFocus()})):Qg(e)?e.subscribe(r=>{this._items=r,this._typeahead?.setItems(r),this._updateActiveItemIndex(r),this._initializeFocus()}):(this._items=e,this._initializeFocus()),typeof i.shouldActivationFollowFocus=="boolean"&&(this._shouldActivationFollowFocus=i.shouldActivationFollowFocus),i.horizontalOrientation&&(this._horizontalOrientation=i.horizontalOrientation),i.skipPredicate&&(this._skipPredicateFn=i.skipPredicate),i.trackBy&&(this._trackByFn=i.trackBy),typeof i.typeAheadDebounceInterval<"u"&&this._setTypeAhead(i.typeAheadDebounceInterval)}destroy(){this._typeaheadSubscription.unsubscribe(),this._typeahead?.destroy(),this.change.complete()}onKeydown(e){switch(e.key){case"Tab":return;case"ArrowDown":this._focusNextItem();break;case"ArrowUp":this._focusPreviousItem();break;case"ArrowRight":this._horizontalOrientation==="rtl"?this._collapseCurrentItem():this._expandCurrentItem();break;case"ArrowLeft":this._horizontalOrientation==="rtl"?this._expandCurrentItem():this._collapseCurrentItem();break;case"Home":this._focusFirstItem();break;case"End":this._focusLastItem();break;case"Enter":case" ":this._activateCurrentItem();break;default:if(e.key==="*"){this._expandAllItemsAtCurrentItemLevel();break}this._typeahead?.handleKey(e);return}this._typeahead?.reset(),e.preventDefault()}getActiveItemIndex(){return this._activeItemIndex}getActiveItem(){return this._activeItem}_focusFirstItem(){this.focusItem(this._findNextAvailableItemIndex(-1))}_focusLastItem(){this.focusItem(this._findPreviousAvailableItemIndex(this._items.length))}_focusNextItem(){this.focusItem(this._findNextAvailableItemIndex(this._activeItemIndex))}_focusPreviousItem(){this.focusItem(this._findPreviousAvailableItemIndex(this._activeItemIndex))}focusItem(e,i={}){i.emitChangeEvent??=!0;let r=typeof e=="number"?e:this._items.findIndex(s=>this._trackByFn(s)===this._trackByFn(e));if(r<0||r>=this._items.length)return;let n=this._items[r];if(this._activeItem!==null&&this._trackByFn(n)===this._trackByFn(this._activeItem))return;let o=this._activeItem;this._activeItem=n??null,this._activeItemIndex=r,this._typeahead?.setCurrentSelectedItemIndex(r),this._activeItem?.focus(),o?.unfocus(),i.emitChangeEvent&&this.change.next(this._activeItem),this._shouldActivationFollowFocus&&this._activateCurrentItem()}_updateActiveItemIndex(e){let i=this._activeItem;if(!i)return;let r=e.findIndex(n=>this._trackByFn(n)===this._trackByFn(i));r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r,this._typeahead?.setCurrentSelectedItemIndex(r))}_setTypeAhead(e){this._typeahead=new TL(this._items,{debounceInterval:typeof e=="number"?e:void 0,skipPredicate:i=>this._skipPredicateFn(i)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(i=>{this.focusItem(i)})}_findNextAvailableItemIndex(e){for(let i=e+1;i<this._items.length;i++)if(!this._skipPredicateFn(this._items[i]))return i;return e}_findPreviousAvailableItemIndex(e){for(let i=e-1;i>=0;i--)if(!this._skipPredicateFn(this._items[i]))return i;return e}_collapseCurrentItem(){if(this._activeItem)if(this._isCurrentItemExpanded())this._activeItem.collapse();else{let e=this._activeItem.getParent();if(!e||this._skipPredicateFn(e))return;this.focusItem(e)}}_expandCurrentItem(){this._activeItem&&(this._isCurrentItemExpanded()?y_(this._activeItem.getChildren()).pipe(Vo(1)).subscribe(e=>{let i=e.find(r=>!this._skipPredicateFn(r));i&&this.focusItem(i)}):this._activeItem.expand())}_isCurrentItemExpanded(){return this._activeItem?typeof this._activeItem.isExpanded=="boolean"?this._activeItem.isExpanded:this._activeItem.isExpanded():!1}_isItemDisabled(e){return typeof e.isDisabled=="boolean"?e.isDisabled:e.isDisabled?.()}_expandAllItemsAtCurrentItemLevel(){if(!this._activeItem)return;let e=this._activeItem.getParent(),i;e?i=y_(e.getChildren()):i=qi(this._items.filter(r=>r.getParent()===null)),i.pipe(Vo(1)).subscribe(r=>{for(let n of r)n.expand()})}_activateCurrentItem(){this._activeItem?.activate()}};function UYe(){return(t,e)=>new VW(t,e)}var aue=new St("tree-key-manager",{providedIn:"root",factory:UYe});var hA=(()=>{let e=class e{constructor(r){this._platform=r}isDisabled(r){return r.hasAttribute("disabled")}isVisible(r){return YYe(r)&&getComputedStyle(r).visibility==="visible"}isTabbable(r){if(!this._platform.isBrowser)return!1;let n=qYe(e$e(r));if(n&&(tue(n)===-1||!this.isVisible(n)))return!1;let o=r.nodeName.toLowerCase(),s=tue(r);return r.hasAttribute("contenteditable")?s!==-1:o==="iframe"||o==="object"||this._platform.WEBKIT&&this._platform.IOS&&!QYe(r)?!1:o==="audio"?r.hasAttribute("controls")?s!==-1:!1:o==="video"?s===-1?!1:s!==null?!0:this._platform.FIREFOX||r.hasAttribute("controls"):r.tabIndex>=0}isFocusable(r,n){return JYe(r)&&!this.isDisabled(r)&&(n?.ignoreVisibility||this.isVisible(r))}};e.\u0275fac=function(n){return new(n||e)(lt(yr))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function qYe(t){try{return t.frameElement}catch{return null}}function YYe(t){return!!(t.offsetWidth||t.offsetHeight||typeof t.getClientRects=="function"&&t.getClientRects().length)}function $Ye(t){let e=t.nodeName.toLowerCase();return e==="input"||e==="select"||e==="button"||e==="textarea"}function GYe(t){return KYe(t)&&t.type=="hidden"}function XYe(t){return ZYe(t)&&t.hasAttribute("href")}function KYe(t){return t.nodeName.toLowerCase()=="input"}function ZYe(t){return t.nodeName.toLowerCase()=="a"}function lue(t){if(!t.hasAttribute("tabindex")||t.tabIndex===void 0)return!1;let e=t.getAttribute("tabindex");return!!(e&&!isNaN(parseInt(e,10)))}function tue(t){if(!lue(t))return null;let e=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}function QYe(t){let e=t.nodeName.toLowerCase(),i=e==="input"&&t.type;return i==="text"||i==="password"||e==="select"||e==="textarea"}function JYe(t){return GYe(t)?!1:$Ye(t)||XYe(t)||t.hasAttribute("contenteditable")||lue(t)}function e$e(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}var jW=class{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,i,r,n,o=!1,s){this._element=e,this._checker=i,this._ngZone=r,this._document=n,this._injector=s,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,o||this.attachAnchors()}destroy(){let e=this._startAnchor,i=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),i&&(i.removeEventListener("focus",this.endAnchorListener),i.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(i=>{this._executeOnStable(()=>i(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(i=>{this._executeOnStable(()=>i(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(i=>{this._executeOnStable(()=>i(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let i=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return e=="start"?i.length?i[0]:this._getFirstTabbableElement(this._element):i.length?i[i.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){let i=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(i){if(!this._checker.isFocusable(i)){let r=this._getFirstTabbableElement(i);return r?.focus(e),!!r}return i.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){let i=this._getRegionBoundary("start");return i&&i.focus(e),!!i}focusLastTabbableElement(e){let i=this._getRegionBoundary("end");return i&&i.focus(e),!!i}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let i=e.children;for(let r=0;r<i.length;r++){let n=i[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(i[r]):null;if(n)return n}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let i=e.children;for(let r=i.length-1;r>=0;r--){let n=i[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(i[r]):null;if(n)return n}return null}_createAnchor(){let e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,i){e?i.setAttribute("tabindex","0"):i.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._injector?ed(e,{injector:this._injector}):setTimeout(e)}},fA=(()=>{let e=class e{constructor(r,n,o){this._checker=r,this._ngZone=n,this._injector=Jt(kn),this._document=o}create(r,n=!1){return new jW(r,this._checker,this._ngZone,this._document,n,this._injector)}};e.\u0275fac=function(n){return new(n||e)(lt(hA),lt(ni),lt(ir))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),cue=(()=>{let e=class e{get enabled(){return this.focusTrap?.enabled||!1}set enabled(r){this.focusTrap&&(this.focusTrap.enabled=r)}constructor(r,n,o){this._elementRef=r,this._focusTrapFactory=n,this._previouslyFocusedElement=null,Jt(yr).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(r){let n=r.autoCapture;n&&!n.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=tv(),this.focusTrap?.focusInitialElementWhenReady()}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(fA),Te(ir))},e.\u0275dir=Ot({type:e,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[2,"cdkTrapFocus","enabled",bi],autoCapture:[2,"cdkTrapFocusAutoCapture","autoCapture",bi]},exportAs:["cdkTrapFocus"],standalone:!0,features:[ar,Li]});let t=e;return t})();function UW(t){return t.buttons===0||t.detail===0}function qW(t){let e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var t$e=new St("cdk-input-modality-detector-options"),i$e={ignoreKeys:[18,17,224,91,16]},due=650,ox=pc({passive:!0,capture:!0}),r$e=(()=>{let e=class e{get mostRecentModality(){return this._modality.value}constructor(r,n,o,s){this._platform=r,this._mostRecentTarget=null,this._modality=new Ta(null),this._lastTouchMs=0,this._onKeydown=a=>{this._options?.ignoreKeys?.some(c=>c===a.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=td(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<due||(this._modality.next(UW(a)?"keyboard":"mouse"),this._mostRecentTarget=td(a))},this._onTouchstart=a=>{if(qW(a)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=td(a)},this._options=Ke(Ke({},i$e),s),this.modalityDetected=this._modality.pipe(cL(1)),this.modalityChanged=this.modalityDetected.pipe(Kp()),r.isBrowser&&n.runOutsideAngular(()=>{o.addEventListener("keydown",this._onKeydown,ox),o.addEventListener("mousedown",this._onMousedown,ox),o.addEventListener("touchstart",this._onTouchstart,ox)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,ox),document.removeEventListener("mousedown",this._onMousedown,ox),document.removeEventListener("touchstart",this._onTouchstart,ox))}};e.\u0275fac=function(n){return new(n||e)(lt(yr),lt(ni),lt(ir),lt(t$e,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),n$e=new St("liveAnnouncerElement",{providedIn:"root",factory:o$e});function o$e(){return null}var s$e=new St("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),a$e=0,IL=(()=>{let e=class e{constructor(r,n,o,s){this._ngZone=n,this._defaultOptions=s,this._document=o,this._liveElement=r||this._createLiveElement()}announce(r,...n){let o=this._defaultOptions,s,a;return n.length===1&&typeof n[0]=="number"?a=n[0]:[s,a]=n,this.clear(),clearTimeout(this._previousTimeout),s||(s=o&&o.politeness?o.politeness:"polite"),a==null&&o&&(a=o.duration),this._liveElement.setAttribute("aria-live",s),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(c=>this._currentResolve=c)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=r,typeof a=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let r="cdk-live-announcer-element",n=this._document.getElementsByClassName(r),o=this._document.createElement("div");for(let s=0;s<n.length;s++)n[s].remove();return o.classList.add(r),o.classList.add("cdk-visually-hidden"),o.setAttribute("aria-atomic","true"),o.setAttribute("aria-live","polite"),o.id=`cdk-live-announcer-${a$e++}`,this._document.body.appendChild(o),o}_exposeAnnouncerToModals(r){let n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let o=0;o<n.length;o++){let s=n[o],a=s.getAttribute("aria-owns");a?a.indexOf(r)===-1&&s.setAttribute("aria-owns",a+" "+r):s.setAttribute("aria-owns",r)}}};e.\u0275fac=function(n){return new(n||e)(lt(n$e,8),lt(ni),lt(ir),lt(s$e,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var SL=function(t){return t[t.IMMEDIATE=0]="IMMEDIATE",t[t.EVENTUAL=1]="EVENTUAL",t}(SL||{}),l$e=new St("cdk-focus-monitor-default-options"),xL=pc({passive:!0,capture:!0}),Qp=(()=>{let e=class e{constructor(r,n,o,s,a){this._ngZone=r,this._platform=n,this._inputModalityDetector=o,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Ft,this._rootNodeFocusAndBlurListener=c=>{let d=td(c);for(let u=d;u;u=u.parentElement)c.type==="focus"?this._onFocus(c,u):this._onBlur(c,u)},this._document=s,this._detectionMode=a?.detectionMode||SL.IMMEDIATE}monitor(r,n=!1){let o=Hd(r);if(!this._platform.isBrowser||o.nodeType!==1)return qi();let s=Xde(o)||this._getDocument(),a=this._elementInfo.get(o);if(a)return n&&(a.checkChildren=!0),a.subject;let c={checkChildren:n,subject:new Ft,rootNode:s};return this._elementInfo.set(o,c),this._registerGlobalListeners(c),c.subject}stopMonitoring(r){let n=Hd(r),o=this._elementInfo.get(n);o&&(o.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(o))}focusVia(r,n,o){let s=Hd(r),a=this._getDocument().activeElement;s===a?this._getClosestElementsInfo(s).forEach(([c,d])=>this._originChanged(c,n,d)):(this._setOrigin(n),typeof s.focus=="function"&&s.focus(o))}ngOnDestroy(){this._elementInfo.forEach((r,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(r){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(r)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:r&&this._isLastInteractionFromInputLabel(r)?"mouse":"program"}_shouldBeAttributedToTouch(r){return this._detectionMode===SL.EVENTUAL||!!r?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(r,n){r.classList.toggle("cdk-focused",!!n),r.classList.toggle("cdk-touch-focused",n==="touch"),r.classList.toggle("cdk-keyboard-focused",n==="keyboard"),r.classList.toggle("cdk-mouse-focused",n==="mouse"),r.classList.toggle("cdk-program-focused",n==="program")}_setOrigin(r,n=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=r,this._originFromTouchInteraction=r==="touch"&&n,this._detectionMode===SL.IMMEDIATE){clearTimeout(this._originTimeoutId);let o=this._originFromTouchInteraction?due:1;this._originTimeoutId=setTimeout(()=>this._origin=null,o)}})}_onFocus(r,n){let o=this._elementInfo.get(n),s=td(r);!o||!o.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),o)}_onBlur(r,n){let o=this._elementInfo.get(n);!o||o.checkChildren&&r.relatedTarget instanceof Node&&n.contains(r.relatedTarget)||(this._setClasses(n),this._emitOrigin(o,null))}_emitOrigin(r,n){r.subject.observers.length&&this._ngZone.run(()=>r.subject.next(n))}_registerGlobalListeners(r){if(!this._platform.isBrowser)return;let n=r.rootNode,o=this._rootNodeFocusListenerCount.get(n)||0;o||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,xL),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,xL)}),this._rootNodeFocusListenerCount.set(n,o+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Hr(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(r){let n=r.rootNode;if(this._rootNodeFocusListenerCount.has(n)){let o=this._rootNodeFocusListenerCount.get(n);o>1?this._rootNodeFocusListenerCount.set(n,o-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,xL),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,xL),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(r,n,o){this._setClasses(r,n),this._emitOrigin(o,n),this._lastFocusOrigin=n}_getClosestElementsInfo(r){let n=[];return this._elementInfo.forEach((o,s)=>{(s===r||o.checkChildren&&s.contains(r))&&n.push([s,o])}),n}_isLastInteractionFromInputLabel(r){let{_mostRecentTarget:n,mostRecentModality:o}=this._inputModalityDetector;if(o!=="mouse"||!n||n===r||r.nodeName!=="INPUT"&&r.nodeName!=="TEXTAREA"||r.disabled)return!1;let s=r.labels;if(s){for(let a=0;a<s.length;a++)if(s[a].contains(n))return!0}return!1}};e.\u0275fac=function(n){return new(n||e)(lt(ni),lt(yr),lt(r$e),lt(ir,8),lt(l$e,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),uue=(()=>{let e=class e{constructor(r,n){this._elementRef=r,this._focusMonitor=n,this._focusOrigin=null,this.cdkFocusChange=new Nt}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){let r=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(r,r.nodeType===1&&r.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>{this._focusOrigin=n,this.cdkFocusChange.emit(n)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(Qp))},e.\u0275dir=Ot({type:e,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"],standalone:!0});let t=e;return t})(),C_=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(C_||{}),iue="cdk-high-contrast-black-on-white",rue="cdk-high-contrast-white-on-black",FW="cdk-high-contrast-active",YW=(()=>{let e=class e{constructor(r,n){this._platform=r,this._document=n,this._breakpointSubscription=Jt(Jde).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return C_.NONE;let r=this._document.createElement("div");r.style.backgroundColor="rgb(1,2,3)",r.style.position="absolute",this._document.body.appendChild(r);let n=this._document.defaultView||window,o=n&&n.getComputedStyle?n.getComputedStyle(r):null,s=(o&&o.backgroundColor||"").replace(/ /g,"");switch(r.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return C_.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return C_.BLACK_ON_WHITE}return C_.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let r=this._document.body.classList;r.remove(FW,iue,rue),this._hasCheckedHighContrastMode=!0;let n=this.getHighContrastMode();n===C_.BLACK_ON_WHITE?r.add(FW,iue):n===C_.WHITE_ON_BLACK&&r.add(FW,rue)}}};e.\u0275fac=function(n){return new(n||e)(lt(yr),lt(ir))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),DL=(()=>{let e=class e{constructor(r){r._applyBodyHighContrastModeCssClasses()}};e.\u0275fac=function(n){return new(n||e)(lt(YW))},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[nx]});let t=e;return t})();var c$e=new St("cdk-dir-doc",{providedIn:"root",factory:d$e});function d$e(){return Jt(ir)}var u$e=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function h$e(t){let e=t?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?u$e.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var ss=(()=>{let e=class e{constructor(r){if(this.value="ltr",this.change=new Nt,r){let n=r.body?r.body.dir:null,o=r.documentElement?r.documentElement.dir:null;this.value=h$e(n||o||"ltr")}}ngOnDestroy(){this.change.complete()}};e.\u0275fac=function(n){return new(n||e)(lt(c$e,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var nv=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({});let t=e;return t})();var p$e=["text"],m$e=[[["mat-icon"]],"*"],g$e=["mat-icon","*"];function v$e(t,e){if(t&1&&bt(0,"mat-pseudo-checkbox",1),t&2){let i=$t();ht("disabled",i.disabled)("state",i.selected?"checked":"unchecked")}}function b$e(t,e){if(t&1&&bt(0,"mat-pseudo-checkbox",3),t&2){let i=$t();ht("disabled",i.disabled)}}function _$e(t,e){if(t&1&&(ae(0,"span",4),_e(1),ne()),t&2){let i=$t();Ye(),ji("(",i.group.label,")")}}var y$e=["mat-internal-form-field",""],w$e=["*"];var yue=(()=>{let e=class e{};e.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)",e.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)",e.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)",e.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)";let t=e;return t})(),wue=(()=>{let e=class e{};e.COMPLEX="375ms",e.ENTERING="225ms",e.EXITING="195ms";let t=e;return t})();function C$e(){return!0}var x$e=new St("mat-sanity-checks",{providedIn:"root",factory:C$e}),oi=(()=>{let e=class e{constructor(r,n,o){this._sanityChecks=n,this._document=o,this._hasDoneGlobalChecks=!1,r._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(r){return cA()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[r]}};e.\u0275fac=function(n){return new(n||e)(lt(YW),lt(x$e,8),lt(ir))},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[nv,nv]});let t=e;return t})();var x_=class{constructor(e,i,r,n,o){this._defaultMatcher=e,this.ngControl=i,this._parentFormGroup=r,this._parentForm=n,this._stateChanges=o,this.errorState=!1}updateErrorState(){let e=this.errorState,i=this._parentFormGroup||this._parentForm,r=this.matcher||this._defaultMatcher,n=this.ngControl?this.ngControl.control:null,o=r?.isErrorState(n,i)??!1;o!==e&&(this.errorState=o,this._stateChanges.next())}};var ZW=new St("MAT_DATE_LOCALE",{providedIn:"root",factory:S$e});function S$e(){return Jt(yde)}var ea=class{constructor(){this._localeChanges=new Ft,this.localeChanges=this._localeChanges}getValidDateOrNull(e){return this.isDateInstance(e)&&this.isValid(e)?e:null}deserialize(e){return e==null||this.isDateInstance(e)&&this.isValid(e)?e:this.invalid()}setLocale(e){this.locale=e,this._localeChanges.next()}compareDate(e,i){return this.getYear(e)-this.getYear(i)||this.getMonth(e)-this.getMonth(i)||this.getDate(e)-this.getDate(i)}sameDate(e,i){if(e&&i){let r=this.isValid(e),n=this.isValid(i);return r&&n?!this.compareDate(e,i):r==n}return e==i}clampDate(e,i,r){return i&&this.compareDate(e,i)<0?i:r&&this.compareDate(e,r)>0?r:e}},Jp=new St("mat-date-formats");var mA=(()=>{let e=class e{isErrorState(r,n){return!!(r&&r.invalid&&(r.touched||n&&n.submitted))}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var QW=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,oi]});let t=e;return t})(),Bd=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Bd||{}),XW=class{constructor(e,i,r,n=!1){this._renderer=e,this.element=i,this.config=r,this._animationForciblyDisabledThroughCss=n,this.state=Bd.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},hue=pc({passive:!0,capture:!0}),KW=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let i=td(e);i&&this._events.get(e.type)?.forEach((r,n)=>{(n===i||n.contains(i))&&r.forEach(o=>o.handleEvent(e))})}}addHandler(e,i,r,n){let o=this._events.get(i);if(o){let s=o.get(r);s?s.add(n):o.set(r,new Set([n]))}else this._events.set(i,new Map([[r,new Set([n])]])),e.runOutsideAngular(()=>{document.addEventListener(i,this._delegateEventHandler,hue)})}removeHandler(e,i,r){let n=this._events.get(e);if(!n)return;let o=n.get(i);o&&(o.delete(r),o.size===0&&n.delete(i),n.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,hue)))}},fue={enterDuration:225,exitDuration:150},E$e=800,pue=pc({passive:!0,capture:!0}),mue=["mousedown","touchstart"],gue=["mouseup","mouseleave","touchend","touchcancel"],pA=class pA{constructor(e,i,r,n){this._target=e,this._ngZone=i,this._platform=n,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,n.isBrowser&&(this._containerElement=Hd(r))}fadeInRipple(e,i,r={}){let n=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o=Ke(Ke({},fue),r.animation);r.centered&&(e=n.left+n.width/2,i=n.top+n.height/2);let s=r.radius||T$e(e,i,n),a=e-n.left,c=i-n.top,d=o.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=`${a-s}px`,u.style.top=`${c-s}px`,u.style.height=`${s*2}px`,u.style.width=`${s*2}px`,r.color!=null&&(u.style.backgroundColor=r.color),u.style.transitionDuration=`${d}ms`,this._containerElement.appendChild(u);let h=window.getComputedStyle(u),p=h.transitionProperty,f=h.transitionDuration,m=p==="none"||f==="0s"||f==="0s, 0s"||n.width===0&&n.height===0,g=new XW(this,u,r,m);u.style.transform="scale3d(1, 1, 1)",g.state=Bd.FADING_IN,r.persistent||(this._mostRecentTransientRipple=g);let y=null;return!m&&(d||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let w=()=>{y&&(y.fallbackTimer=null),clearTimeout(T),this._finishRippleTransition(g)},x=()=>this._destroyRipple(g),T=setTimeout(x,d+100);u.addEventListener("transitionend",w),u.addEventListener("transitioncancel",x),y={onTransitionEnd:w,onTransitionCancel:x,fallbackTimer:T}}),this._activeRipples.set(g,y),(m||!d)&&this._finishRippleTransition(g),g}fadeOutRipple(e){if(e.state===Bd.FADING_OUT||e.state===Bd.HIDDEN)return;let i=e.element,r=Ke(Ke({},fue),e.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",e.state=Bd.FADING_OUT,(e._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let i=Hd(e);!this._platform.isBrowser||!i||i===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=i,mue.forEach(r=>{pA._eventManager.addHandler(this._ngZone,r,i,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{gue.forEach(i=>{this._triggerElement.addEventListener(i,this,pue)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Bd.FADING_IN?this._startFadeOutTransition(e):e.state===Bd.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let i=e===this._mostRecentTransientRipple,{persistent:r}=e.config;e.state=Bd.VISIBLE,!r&&(!i||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let i=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Bd.HIDDEN,i!==null&&(e.element.removeEventListener("transitionend",i.onTransitionEnd),e.element.removeEventListener("transitioncancel",i.onTransitionCancel),i.fallbackTimer!==null&&clearTimeout(i.fallbackTimer)),e.element.remove()}_onMousedown(e){let i=UW(e),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+E$e;!this._target.rippleDisabled&&!i&&!r&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!qW(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let i=e.changedTouches;if(i)for(let r=0;r<i.length;r++)this.fadeInRipple(i[r].clientX,i[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let i=e.state===Bd.VISIBLE||e.config.terminateOnPointerUp&&e.state===Bd.FADING_IN;!e.config.persistent&&i&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(mue.forEach(i=>pA._eventManager.removeHandler(i,e,this)),this._pointerUpEventsRegistered&&(gue.forEach(i=>e.removeEventListener(i,this,pue)),this._pointerUpEventsRegistered=!1))}};pA._eventManager=new KW;var kL=pA;function T$e(t,e,i){let r=Math.max(Math.abs(t-i.left),Math.abs(t-i.right)),n=Math.max(Math.abs(e-i.top),Math.abs(e-i.bottom));return Math.sqrt(r*r+n*n)}var NL=new St("mat-ripple-global-options"),S_=(()=>{let e=class e{get disabled(){return this._disabled}set disabled(r){r&&this.fadeOutAllNonPersistent(),this._disabled=r,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(r){this._trigger=r,this._setupTriggerEventsIfEnabled()}constructor(r,n,o,s,a){this._elementRef=r,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new kL(this,n,r,o)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Ke(Ke(Ke({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(r,n=0,o){return typeof r=="number"?this._rippleRenderer.fadeInRipple(r,n,Ke(Ke({},this.rippleConfig),o)):this._rippleRenderer.fadeInRipple(0,0,Ke(Ke({},this.rippleConfig),r))}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(ni),Te(yr),Te(NL,8),Te(rs,8))},e.\u0275dir=Ot({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(n,o){n&2&&hi("mat-ripple-unbounded",o.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0});let t=e;return t})(),E_=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,oi]});let t=e;return t})(),R$e=(()=>{let e=class e{constructor(r){this._animationMode=r,this.state="unchecked",this.disabled=!1,this.appearance="full"}};e.\u0275fac=function(n){return new(n||e)(Te(rs,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(n,o){n&2&&hi("mat-pseudo-checkbox-indeterminate",o.state==="indeterminate")("mat-pseudo-checkbox-checked",o.state==="checked")("mat-pseudo-checkbox-disabled",o.disabled)("mat-pseudo-checkbox-minimal",o.appearance==="minimal")("mat-pseudo-checkbox-full",o.appearance==="full")("_mat-animation-noopable",o._animationMode==="NoopAnimations")},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},standalone:!0,features:[zt],decls:0,vars:0,template:function(n,o){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color, var(--mat-app-primary))}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color)}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color, var(--mat-app-on-surface-variant));border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color, var(--mat-app-primary));border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color, var(--mat-app-on-primary))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color, var(--mat-app-surface))}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0});let t=e;return t})(),JW=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi]});let t=e;return t})(),PL=new St("MAT_OPTION_PARENT_COMPONENT");var LL=new St("MatOptgroup");var A$e=0,OL=class{constructor(e,i=!1){this.source=e,this.isUserInput=i}},gA=(()=>{let e=class e{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(r){this._disabled=r}get disableRipple(){return!!(this._parent&&this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}constructor(r,n,o,s){this._element=r,this._changeDetectorRef=n,this._parent=o,this.group=s,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id=`mat-option-${A$e++}`,this.onSelectionChange=new Nt,this._stateChanges=new Ft}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(r=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),r&&this._emitSelectionChangeEvent())}deselect(r=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),r&&this._emitSelectionChangeEvent())}focus(r,n){let o=this._getHostElement();typeof o.focus=="function"&&o.focus(n)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(r){(r.keyCode===13||r.keyCode===32)&&!jo(r)&&(this._selectViaInteraction(),r.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let r=this.viewValue;r!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=r)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(r=!1){this.onSelectionChange.emit(new OL(this,r))}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(Xi),Te(PL,8),Te(LL,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-option"]],viewQuery:function(n,o){if(n&1&&Ii(p$e,7),n&2){let s;ai(s=li())&&(o._text=s.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(n,o){n&1&&At("click",function(){return o._selectViaInteraction()})("keydown",function(a){return o._handleKeydown(a)}),n&2&&(il("id",o.id),mi("aria-selected",o.selected)("aria-disabled",o.disabled.toString()),hi("mdc-list-item--selected",o.selected)("mat-mdc-option-multiple",o.multiple)("mat-mdc-option-active",o.active)("mdc-list-item--disabled",o.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",bi]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],standalone:!0,features:[ar,zt],ngContentSelectors:g$e,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(n,o){n&1&&(Br(m$e),wi(0,v$e,1,2,"mat-pseudo-checkbox",1),Ri(1),ae(2,"span",2,0),Ri(4,1),ne(),wi(5,b$e,1,1,"mat-pseudo-checkbox",3)(6,_$e,2,1,"span",4),bt(7,"div",5)),n&2&&(Mr(o.multiple?0:-1),Ye(5),Mr(!o.multiple&&o.selected&&!o.hideSingleSelectionIndicator?5:-1),Ye(),Mr(o.group&&o.group._inert?6:-1),Ye(),ht("matRippleTrigger",o._getHostElement())("matRippleDisabled",o.disabled||o.disableRipple))},dependencies:[R$e,S_],styles:['.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color, var(--mat-app-on-surface));font-family:var(--mat-option-label-text-font, var(--mat-app-label-large-font));line-height:var(--mat-option-label-text-line-height, var(--mat-app-label-large-line-height));font-size:var(--mat-option-label-text-size, var(--mat-app-body-large-size));letter-spacing:var(--mat-option-label-text-tracking, var(--mat-app-label-large-tracking));font-weight:var(--mat-option-label-text-weight, var(--mat-app-body-large-weight))}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color)}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color);outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color, var(--mat-app-on-secondary-container))}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color, var(--mat-app-secondary-container))}.mat-mdc-option .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-option-selected-state-label-text-color, var(--mat-app-on-secondary-container))}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0});let t=e;return t})();function eU(t,e,i){if(i.length){let r=e.toArray(),n=i.toArray(),o=0;for(let s=0;s<t+1;s++)r[s].group&&r[s].group===n[o]&&o++;return o}return 0}function tU(t,e,i,r){return t<i?t:t+e>i+r?Math.max(0,t-r+e):i}var dx=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[E_,oi,JW]});let t=e;return t})(),vue={capture:!0},bue=["focus","mousedown","mouseenter","touchstart"],$W="mat-ripple-loader-uninitialized",GW="mat-ripple-loader-class-name",_ue="mat-ripple-loader-centered",ML="mat-ripple-loader-disabled",Cue=(()=>{let e=class e{constructor(){this._document=Jt(ir,{optional:!0}),this._animationMode=Jt(rs,{optional:!0}),this._globalRippleOptions=Jt(NL,{optional:!0}),this._platform=Jt(yr),this._ngZone=Jt(ni),this._hosts=new Map,this._onInteraction=r=>{let n=td(r);if(n instanceof HTMLElement){let o=n.closest(`[${$W}="${this._globalRippleOptions?.namespace??""}"]`);o&&this._createRipple(o)}},this._ngZone.runOutsideAngular(()=>{for(let r of bue)this._document?.addEventListener(r,this._onInteraction,vue)})}ngOnDestroy(){let r=this._hosts.keys();for(let n of r)this.destroyRipple(n);for(let n of bue)this._document?.removeEventListener(n,this._onInteraction,vue)}configureRipple(r,n){r.setAttribute($W,this._globalRippleOptions?.namespace??""),(n.className||!r.hasAttribute(GW))&&r.setAttribute(GW,n.className||""),n.centered&&r.setAttribute(_ue,""),n.disabled&&r.setAttribute(ML,"")}getRipple(r){return this._hosts.get(r)||this._createRipple(r)}setDisabled(r,n){let o=this._hosts.get(r);if(o){o.disabled=n;return}n?r.setAttribute(ML,""):r.removeAttribute(ML)}_createRipple(r){if(!this._document)return;let n=this._hosts.get(r);if(n)return n;r.querySelector(".mat-ripple")?.remove();let o=this._document.createElement("span");o.classList.add("mat-ripple",r.getAttribute(GW)),r.append(o);let s=new S_(new qt(o),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return s._isInitialized=!0,s.trigger=r,s.centered=r.hasAttribute(_ue),s.disabled=r.hasAttribute(ML),this.attachRipple(r,s),s}attachRipple(r,n){r.removeAttribute($W),this._hosts.set(r,n)}destroyRipple(r){let n=this._hosts.get(r);n&&(n.ngOnDestroy(),this._hosts.delete(r))}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),xue=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Tt({type:e,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(n,o){n&2&&hi("mdc-form-field--align-end",o.labelPosition==="before")},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[zt],attrs:y$e,ngContentSelectors:w$e,decls:1,vars:0,template:function(n,o){n&1&&(Br(),Ri(0))},styles:[".mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-flex;align-items:center;vertical-align:middle}.mat-internal-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mat-internal-form-field>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end .mdc-form-field--align-end label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0}"],encapsulation:2,changeDetection:0});let t=e;return t})();var vA=class{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;e!=null&&(this._attachedHost=null,e.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},qu=class extends vA{constructor(e,i,r,n,o){super(),this.component=e,this.viewContainerRef=i,this.injector=r,this.componentFactoryResolver=n,this.projectableNodes=o}},ov=class extends vA{constructor(e,i,r,n){super(),this.templateRef=e,this.viewContainerRef=i,this.context=r,this.injector=n}get origin(){return this.templateRef.elementRef}attach(e,i=this.context){return this.context=i,super.attach(e)}detach(){return this.context=void 0,super.detach()}},iU=class extends vA{constructor(e){super(),this.element=e instanceof qt?e.nativeElement:e}},ux=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){if(e instanceof qu)return this._attachedPortal=e,this.attachComponentPortal(e);if(e instanceof ov)return this._attachedPortal=e,this.attachTemplatePortal(e);if(this.attachDomPortal&&e instanceof iU)return this._attachedPortal=e,this.attachDomPortal(e)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var HL=class extends ux{constructor(e,i,r,n,o){super(),this.outletElement=e,this._componentFactoryResolver=i,this._appRef=r,this._defaultInjector=n,this.attachDomPortal=s=>{this._document;let a=s.element;a.parentNode;let c=this._document.createComment("dom-portal");a.parentNode.insertBefore(c,a),this.outletElement.appendChild(a),this._attachedPortal=s,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=o}attachComponentPortal(e){let r=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),n;return e.viewContainerRef?(n=e.viewContainerRef.createComponent(r,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>n.destroy())):(n=r.create(e.injector||this._defaultInjector||kn.NULL),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),this._attachedPortal=e,n}attachTemplatePortal(e){let i=e.viewContainerRef,r=i.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return r.rootNodes.forEach(n=>this.outletElement.appendChild(n)),r.detectChanges(),this.setDisposeFn(()=>{let n=i.indexOf(r);n!==-1&&i.remove(n)}),this._attachedPortal=e,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}};var sv=(()=>{let e=class e extends ux{constructor(r,n,o){super(),this._componentFactoryResolver=r,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new Nt,this.attachDomPortal=s=>{this._document;let a=s.element;a.parentNode;let c=this._document.createComment("dom-portal");s.setAttachedHost(this),a.parentNode.insertBefore(c,a),this._getRootNode().appendChild(a),this._attachedPortal=s,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=o}get portal(){return this._attachedPortal}set portal(r){this.hasAttached()&&!r&&!this._isInitialized||(this.hasAttached()&&super.detach(),r&&super.attach(r),this._attachedPortal=r||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(r){r.setAttachedHost(this);let n=r.viewContainerRef!=null?r.viewContainerRef:this._viewContainerRef,s=(r.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(r.component),a=n.createComponent(s,n.length,r.injector||n.injector,r.projectableNodes||void 0);return n!==this._viewContainerRef&&this._getRootNode().appendChild(a.hostView.rootNodes[0]),super.setDisposeFn(()=>a.destroy()),this._attachedPortal=r,this._attachedRef=a,this.attached.emit(a),a}attachTemplatePortal(r){r.setAttachedHost(this);let n=this._viewContainerRef.createEmbeddedView(r.templateRef,r.context,{injector:r.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=r,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){let r=this._viewContainerRef.element.nativeElement;return r.nodeType===r.ELEMENT_NODE?r:r.parentNode}};e.\u0275fac=function(n){return new(n||e)(Te(XC),Te(Qs),Te(ir))},e.\u0275dir=Ot({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[vr]});let t=e;return t})();var hx=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({});let t=e;return t})();function Sue(t){return t&&typeof t.connect=="function"&&!(t instanceof Qce)}var T_=class{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(e=!1,i,r=!0,n){this._multiple=e,this._emitChanges=r,this.compareWith=n,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new Ft,i&&i.length&&(e?i.forEach(o=>this._markSelected(o)):this._markSelected(i[0]),this._selectedToEmit.length=0)}select(...e){this._verifyValueAssignment(e),e.forEach(r=>this._markSelected(r));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}deselect(...e){this._verifyValueAssignment(e),e.forEach(r=>this._unmarkSelected(r));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}setSelection(...e){this._verifyValueAssignment(e);let i=this.selected,r=new Set(e);e.forEach(o=>this._markSelected(o)),i.filter(o=>!r.has(this._getConcreteValue(o,r))).forEach(o=>this._unmarkSelected(o));let n=this._hasQueuedChanges();return this._emitChangeEvent(),n}toggle(e){return this.isSelected(e)?this.deselect(e):this.select(e)}clear(e=!0){this._unmarkAll();let i=this._hasQueuedChanges();return e&&this._emitChangeEvent(),i}isSelected(e){return this._selection.has(this._getConcreteValue(e))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(e){this._multiple&&this.selected&&this._selected.sort(e)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(e){e=this._getConcreteValue(e),this.isSelected(e)||(this._multiple||this._unmarkAll(),this.isSelected(e)||this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}_unmarkSelected(e){e=this._getConcreteValue(e),this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}_unmarkAll(){this.isEmpty()||this._selection.forEach(e=>this._unmarkSelected(e))}_verifyValueAssignment(e){e.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(e,i){if(this.compareWith){i=i??this._selection;for(let r of i)if(this.compareWith(e,r))return r;return e}else return e}};var I$e=20,bA=(()=>{let e=class e{constructor(r,n,o){this._ngZone=r,this._platform=n,this._scrolled=new Ft,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=o}register(r){this.scrollContainers.has(r)||this.scrollContainers.set(r,r.elementScrolled().subscribe(()=>this._scrolled.next(r)))}deregister(r){let n=this.scrollContainers.get(r);n&&(n.unsubscribe(),this.scrollContainers.delete(r))}scrolled(r=I$e){return this._platform.isBrowser?new m_(n=>{this._globalSubscription||this._addGlobalListener();let o=r>0?this._scrolled.pipe(mW(r)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{o.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):qi()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((r,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(r,n){let o=this.getAncestorScrollContainers(r);return this.scrolled(n).pipe(Ls(s=>!s||o.indexOf(s)>-1))}getAncestorScrollContainers(r){let n=[];return this.scrollContainers.forEach((o,s)=>{this._scrollableContainsElement(s,r)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(r,n){let o=Hd(n),s=r.getElementRef().nativeElement;do if(o==s)return!0;while(o=o.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let r=this._getWindow();return pW(r.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}};e.\u0275fac=function(n){return new(n||e)(lt(ni),lt(yr),lt(ir,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var D$e=20,fx=(()=>{let e=class e{constructor(r,n,o){this._platform=r,this._change=new Ft,this._changeListener=s=>{this._change.next(s)},this._document=o,n.runOutsideAngular(()=>{if(r.isBrowser){let s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let r=this._getWindow();r.removeEventListener("resize",this._changeListener),r.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let r={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),r}getViewportRect(){let r=this.getViewportScrollPosition(),{width:n,height:o}=this.getViewportSize();return{top:r.top,left:r.left,bottom:r.top+o,right:r.left+n,height:o,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let r=this._document,n=this._getWindow(),o=r.documentElement,s=o.getBoundingClientRect(),a=-s.top||r.body.scrollTop||n.scrollY||o.scrollTop||0,c=-s.left||r.body.scrollLeft||n.scrollX||o.scrollLeft||0;return{top:a,left:c}}change(r=D$e){return r>0?this._change.pipe(mW(r)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let r=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:r.innerWidth,height:r.innerHeight}:{width:0,height:0}}};e.\u0275fac=function(n){return new(n||e)(lt(yr),lt(ni),lt(ir,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Vd=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({});let t=e;return t})(),_A=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[nv,Vd,nv,Vd]});let t=e;return t})();var rU=class{constructor(e){this._box=e,this._destroyed=new Ft,this._resizeSubject=new Ft,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(i=>this._resizeSubject.next(i)))}observe(e){return this._elementObservables.has(e)||this._elementObservables.set(e,new m_(i=>{let r=this._resizeSubject.subscribe(i);return this._resizeObserver?.observe(e,{box:this._box}),()=>{this._resizeObserver?.unobserve(e),r.unsubscribe(),this._elementObservables.delete(e)}}).pipe(Ls(i=>i.some(r=>r.target===e)),ZR({bufferSize:1,refCount:!0}),Hr(this._destroyed))),this._elementObservables.get(e)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},Tue=(()=>{let e=class e{constructor(){this._observers=new Map,this._ngZone=Jt(ni),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,r]of this._observers)r.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(r,n){let o=n?.box||"content-box";return this._observers.has(o)||this._observers.set(o,new rU(o)),this._observers.get(o).observe(r)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Rue=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,oi]});let t=e;return t})();var Aue=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[_A]});let t=e;return t})();var Iue=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,Aue,oi]});let t=e;return t})();var Fue=(()=>{let e=class e{constructor(r,n){this._renderer=r,this._elementRef=n,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(r,n){this._renderer.setProperty(this._elementRef.nativeElement,r,n)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(n){return new(n||e)(Te(hL),Te(qt))},e.\u0275dir=Ot({type:e});let t=e;return t})(),O$e=(()=>{let e=class e extends Fue{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=el(e)))(o||e)}})(),e.\u0275dir=Ot({type:e,features:[vr]});let t=e;return t})(),R_=new St("");var N$e={provide:R_,useExisting:hc(()=>A_),multi:!0};function P$e(){let t=xW()?xW().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var L$e=new St(""),A_=(()=>{let e=class e extends Fue{constructor(r,n,o){super(r,n),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!P$e())}writeValue(r){let n=r??"";this.setProperty("value",n)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(n){return new(n||e)(Te(hL),Te(qt),Te(L$e,8))},e.\u0275dir=Ot({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,o){n&1&&At("input",function(a){return o._handleInput(a.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(a){return o._compositionEnd(a.target.value)})},features:[zi([N$e]),vr]});let t=e;return t})();function av(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function Hue(t){return t!=null&&typeof t.length=="number"}var em=new St(""),GL=new St(""),F$e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,lv=class{static min(e){return H$e(e)}static max(e){return B$e(e)}static required(e){return Bue(e)}static requiredTrue(e){return V$e(e)}static email(e){return j$e(e)}static minLength(e){return z$e(e)}static maxLength(e){return W$e(e)}static pattern(e){return U$e(e)}static nullValidator(e){return VL(e)}static compose(e){return que(e)}static composeAsync(e){return Yue(e)}};function H$e(t){return e=>{if(av(e.value)||av(t))return null;let i=parseFloat(e.value);return!isNaN(i)&&i<t?{min:{min:t,actual:e.value}}:null}}function B$e(t){return e=>{if(av(e.value)||av(t))return null;let i=parseFloat(e.value);return!isNaN(i)&&i>t?{max:{max:t,actual:e.value}}:null}}function Bue(t){return av(t.value)?{required:!0}:null}function V$e(t){return t.value===!0?null:{required:!0}}function j$e(t){return av(t.value)||F$e.test(t.value)?null:{email:!0}}function z$e(t){return e=>av(e.value)||!Hue(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function W$e(t){return e=>Hue(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function U$e(t){if(!t)return VL;let e,i;return typeof t=="string"?(i="",t.charAt(0)!=="^"&&(i+="^"),i+=t,t.charAt(t.length-1)!=="$"&&(i+="$"),e=new RegExp(i)):(i=t.toString(),e=t),r=>{if(av(r.value))return null;let n=r.value;return e.test(n)?null:{pattern:{requiredPattern:i,actualValue:n}}}}function VL(t){return null}function Vue(t){return t!=null}function jue(t){return bde(t)?XR(t):t}function zue(t){let e={};return t.forEach(i=>{e=i!=null?Ke(Ke({},e),i):e}),Object.keys(e).length===0?null:e}function Wue(t,e){return e.map(i=>i(t))}function q$e(t){return!t.validate}function Uue(t){return t.map(e=>q$e(e)?e:i=>e.validate(i))}function que(t){if(!t)return null;let e=t.filter(Vue);return e.length==0?null:function(i){return zue(Wue(i,e))}}function cU(t){return t!=null?que(Uue(t)):null}function Yue(t){if(!t)return null;let e=t.filter(Vue);return e.length==0?null:function(i){let r=Wue(i,e).map(jue);return lf(r).pipe(Gi(zue))}}function dU(t){return t!=null?Yue(Uue(t)):null}function Due(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function $ue(t){return t._rawValidators}function Gue(t){return t._rawAsyncValidators}function nU(t){return t?Array.isArray(t)?t:[t]:[]}function jL(t,e){return Array.isArray(t)?t.includes(e):t===e}function Mue(t,e){let i=nU(e);return nU(t).forEach(n=>{jL(i,n)||i.push(n)}),i}function kue(t,e){return nU(e).filter(i=>!jL(t,i))}var zL=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=cU(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=dU(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,i){return this.control?this.control.hasError(e,i):!1}getError(e,i){return this.control?this.control.getError(e,i):null}},cv=class extends zL{get formDirective(){return null}get path(){return null}},zd=class extends zL{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},WL=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},Y$e={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},BQt=Lt(Ke({},Y$e),{"[class.ng-submitted]":"isSubmitted"}),TA=(()=>{let e=class e extends WL{constructor(r){super(r)}};e.\u0275fac=function(n){return new(n||e)(Te(zd,2))},e.\u0275dir=Ot({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,o){n&2&&hi("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[vr]});let t=e;return t})(),Xue=(()=>{let e=class e extends WL{constructor(r){super(r)}};e.\u0275fac=function(n){return new(n||e)(Te(cv,10))},e.\u0275dir=Ot({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,o){n&2&&hi("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[vr]});let t=e;return t})();var yA="VALID",BL="INVALID",px="PENDING",wA="DISABLED",dv=class{},UL=class extends dv{constructor(e,i){super(),this.value=e,this.source=i}},xA=class extends dv{constructor(e,i){super(),this.pristine=e,this.source=i}},SA=class extends dv{constructor(e,i){super(),this.touched=e,this.source=i}},mx=class extends dv{constructor(e,i){super(),this.status=e,this.source=i}},oU=class extends dv{constructor(e){super(),this.source=e}},sU=class extends dv{constructor(e){super(),this.source=e}};function uU(t){return(XL(t)?t.validators:t)||null}function $$e(t){return Array.isArray(t)?cU(t):t||null}function hU(t,e){return(XL(e)?e.asyncValidators:t)||null}function G$e(t){return Array.isArray(t)?dU(t):t||null}function XL(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function Kue(t,e,i){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new dL(1e3,"");if(!r[i])throw new dL(1001,"")}function Zue(t,e,i){t._forEachChild((r,n)=>{if(i[n]===void 0)throw new dL(1002,"")})}var gx=class{constructor(e,i){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._events=new Ft,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(i)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===yA}get invalid(){return this.status===BL}get pending(){return this.status==px}get disabled(){return this.status===wA}get enabled(){return this.status!==wA}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Mue(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Mue(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(kue(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(kue(e,this._rawAsyncValidators))}hasValidator(e){return jL(this._rawValidators,e)}hasAsyncValidator(e){return jL(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let i=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Lt(Ke({},e),{sourceControl:r})),i&&e.emitEvent!==!1&&this._events.next(new SA(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(i=>i.markAllAsTouched(e))}markAsUntouched(e={}){let i=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),i&&e.emitEvent!==!1&&this._events.next(new SA(!1,r))}markAsDirty(e={}){let i=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Lt(Ke({},e),{sourceControl:r})),i&&e.emitEvent!==!1&&this._events.next(new xA(!1,r))}markAsPristine(e={}){let i=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(n=>{n.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),i&&e.emitEvent!==!1&&this._events.next(new xA(!0,r))}markAsPending(e={}){this.status=px;let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new mx(this.status,i)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Lt(Ke({},e),{sourceControl:i}))}disable(e={}){let i=this._parentMarkedDirty(e.onlySelf);this.status=wA,this.errors=null,this._forEachChild(n=>{n.disable(Lt(Ke({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new UL(this.value,r)),this._events.next(new mx(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Lt(Ke({},e),{skipPristineCheck:i}),this),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let i=this._parentMarkedDirty(e.onlySelf);this.status=yA,this._forEachChild(r=>{r.enable(Lt(Ke({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Lt(Ke({},e),{skipPristineCheck:i}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,i){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},i),this._parent._updateTouched({},i))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===yA||this.status===px)&&this._runAsyncValidator(r,e.emitEvent)}let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new UL(this.value,i)),this._events.next(new mx(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Lt(Ke({},e),{sourceControl:i}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?wA:yA}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,i){if(this.asyncValidator){this.status=px,this._hasOwnPendingAsyncValidator={emitEvent:i!==!1};let r=jue(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(n=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(n,{emitEvent:i,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,i={}){this.errors=e,this._updateControlsErrors(i.emitEvent!==!1,this,i.shouldHaveEmitted)}get(e){let i=e;return i==null||(Array.isArray(i)||(i=i.split(".")),i.length===0)?null:i.reduce((r,n)=>r&&r._find(n),this)}getError(e,i){let r=i?this.get(i):this;return r&&r.errors?r.errors[e]:null}hasError(e,i){return!!this.getError(e,i)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,i,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new mx(this.status,i)),this._parent&&this._parent._updateControlsErrors(e,i,r)}_initObservables(){this.valueChanges=new Nt,this.statusChanges=new Nt}_calculateStatus(){return this._allControlsDisabled()?wA:this.errors?BL:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(px)?px:this._anyControlsHaveStatus(BL)?BL:yA}_anyControlsHaveStatus(e){return this._anyControls(i=>i.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,i){let r=!this._anyControlsDirty(),n=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),n&&this._events.next(new xA(this.pristine,i))}_updateTouched(e={},i){this.touched=this._anyControlsTouched(),this._events.next(new SA(this.touched,i)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){XL(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let i=this._parent&&this._parent.dirty;return!e&&!!i&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=$$e(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=G$e(this._rawAsyncValidators)}},uv=class extends gx{constructor(e,i,r){super(uU(i),hU(r,i)),this.controls=e,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,i){return this.controls[e]?this.controls[e]:(this.controls[e]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(e,i,r={}){this.registerControl(e,i),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(e,i,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],i&&this.registerControl(e,i),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,i={}){Zue(this,!0,e),Object.keys(e).forEach(r=>{Kue(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(e,i={}){e!=null&&(Object.keys(e).forEach(r=>{let n=this.controls[r];n&&n.patchValue(e[r],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(e={},i={}){this._forEachChild((r,n)=>{r.reset(e?e[n]:null,{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i,this),this._updateTouched(i,this),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(e,i,r)=>(e[r]=i.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(i,r)=>r._syncPendingControls()?!0:i);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(i=>{let r=this.controls[i];r&&e(r,i)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[i,r]of Object.entries(this.controls))if(this.contains(i)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(i,r,n)=>((r.enabled||this.disabled)&&(i[n]=r.value),i))}_reduceChildren(e,i){let r=e;return this._forEachChild((n,o)=>{r=i(r,n,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var aU=class extends uv{};var vx=new St("CallSetDisabledState",{providedIn:"root",factory:()=>KL}),KL="always";function X$e(t,e){return[...e.path,t]}function EA(t,e,i=KL){fU(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||i==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),Z$e(t,e),J$e(t,e),Q$e(t,e),K$e(t,e)}function qL(t,e,i=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),$L(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function YL(t,e){t.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(e)})}function K$e(t,e){if(e.valueAccessor.setDisabledState){let i=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(i),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(i)})}}function fU(t,e){let i=$ue(t);e.validator!==null?t.setValidators(Due(i,e.validator)):typeof i=="function"&&t.setValidators([i]);let r=Gue(t);e.asyncValidator!==null?t.setAsyncValidators(Due(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let n=()=>t.updateValueAndValidity();YL(e._rawValidators,n),YL(e._rawAsyncValidators,n)}function $L(t,e){let i=!1;if(t!==null){if(e.validator!==null){let n=$ue(t);if(Array.isArray(n)&&n.length>0){let o=n.filter(s=>s!==e.validator);o.length!==n.length&&(i=!0,t.setValidators(o))}}if(e.asyncValidator!==null){let n=Gue(t);if(Array.isArray(n)&&n.length>0){let o=n.filter(s=>s!==e.asyncValidator);o.length!==n.length&&(i=!0,t.setAsyncValidators(o))}}}let r=()=>{};return YL(e._rawValidators,r),YL(e._rawAsyncValidators,r),i}function Z$e(t,e){e.valueAccessor.registerOnChange(i=>{t._pendingValue=i,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&Que(t,e)})}function Q$e(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&Que(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function Que(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function J$e(t,e){let i=(r,n)=>{e.valueAccessor.writeValue(r),n&&e.viewToModelUpdate(r)};t.registerOnChange(i),e._registerOnDestroy(()=>{t._unregisterOnChange(i)})}function Jue(t,e){t==null,fU(t,e)}function eGe(t,e){return $L(t,e)}function ehe(t,e){if(!t.hasOwnProperty("model"))return!1;let i=t.model;return i.isFirstChange()?!0:!Object.is(e,i.currentValue)}function tGe(t){return Object.getPrototypeOf(t.constructor)===O$e}function the(t,e){t._syncPendingControls(),e.forEach(i=>{let r=i.control;r.updateOn==="submit"&&r._pendingChange&&(i.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function ihe(t,e){if(!e)return null;Array.isArray(e);let i,r,n;return e.forEach(o=>{o.constructor===A_?i=o:tGe(o)?r=o:n=o}),n||r||i||null}function iGe(t,e){let i=t.indexOf(e);i>-1&&t.splice(i,1)}var rGe={provide:cv,useExisting:hc(()=>I_)},CA=Promise.resolve(),I_=(()=>{let e=class e extends cv{constructor(r,n,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Nt,this.form=new uv({},cU(r),dU(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){CA.then(()=>{let n=this._findContainer(r.path);r.control=n.registerControl(r.name,r.control),EA(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){CA.then(()=>{let n=this._findContainer(r.path);n&&n.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){CA.then(()=>{let n=this._findContainer(r.path),o=new uv({});Jue(o,r),n.registerControl(r.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){CA.then(()=>{let n=this._findContainer(r.path);n&&n.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,n){CA.then(()=>{this.form.get(r.path).setValue(n)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,the(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(n){return new(n||e)(Te(em,10),Te(GL,10),Te(vx,8))},e.\u0275dir=Ot({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,o){n&1&&At("submit",function(a){return o.onSubmit(a)})("reset",function(){return o.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[zi([rGe]),vr]});let t=e;return t})();function Oue(t,e){let i=t.indexOf(e);i>-1&&t.splice(i,1)}function Nue(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var jd=class extends gx{constructor(e=null,i,r){super(uU(i),hU(r,i)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),XL(i)&&(i.nonNullable||i.initialValueIsDefault)&&(Nue(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,i={}){this.value=this._pendingValue=e,this._onChange.length&&i.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,i.emitViewToModelChange!==!1)),this.updateValueAndValidity(i)}patchValue(e,i={}){this.setValue(e,i)}reset(e=this.defaultValue,i={}){this._applyFormState(e),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Oue(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Oue(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Nue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var nGe=t=>t instanceof jd;var oGe={provide:zd,useExisting:hc(()=>bx)},Pue=Promise.resolve(),bx=(()=>{let e=class e extends zd{constructor(r,n,o,s,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new jd,this._registered=!1,this.name="",this.update=new Nt,this._parent=r,this._setValidators(n),this._setAsyncValidators(o),this.valueAccessor=ihe(this,s)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let n=r.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),ehe(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){EA(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Pue.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let n=r.isDisabled.currentValue,o=n!==0&&bi(n);Pue.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?X$e(r,this._parent):[r]}};e.\u0275fac=function(n){return new(n||e)(Te(cv,9),Te(em,10),Te(GL,10),Te(R_,10),Te(Xi,8),Te(vx,8))},e.\u0275dir=Ot({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[zi([oGe]),vr,Li]});let t=e;return t})(),rhe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var nhe=new St(""),sGe={provide:zd,useExisting:hc(()=>pU)},pU=(()=>{let e=class e extends zd{set isDisabled(r){}constructor(r,n,o,s,a){super(),this._ngModelWarningConfig=s,this.callSetDisabledState=a,this.update=new Nt,this._ngModelWarningSent=!1,this._setValidators(r),this._setAsyncValidators(n),this.valueAccessor=ihe(this,o)}ngOnChanges(r){if(this._isControlChanged(r)){let n=r.form.previousValue;n&&qL(n,this,!1),EA(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}ehe(r,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&qL(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_isControlChanged(r){return r.hasOwnProperty("form")}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(n){return new(n||e)(Te(em,10),Te(GL,10),Te(R_,10),Te(nhe,8),Te(vx,8))},e.\u0275dir=Ot({type:e,selectors:[["","formControl",""]],inputs:{form:[0,"formControl","form"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[zi([sGe]),vr,Li]});let t=e;return t})(),aGe={provide:cv,useExisting:hc(()=>RA)},RA=(()=>{let e=class e extends cv{constructor(r,n,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Nt,this._setValidators(r),this._setAsyncValidators(n)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&($L(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let n=this.form.get(r.path);return EA(n,r,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),n}getControl(r){return this.form.get(r.path)}removeControl(r){qL(r.control||null,r,!1),iGe(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,n){this.form.get(r.path).setValue(n)}onSubmit(r){return this.submitted=!0,the(this.form,this.directives),this.ngSubmit.emit(r),this.form._events.next(new oU(this.control)),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1,this.form._events.next(new sU(this.form))}_updateDomValue(){this.directives.forEach(r=>{let n=r.control,o=this.form.get(r.path);n!==o&&(qL(n||null,r),nGe(o)&&(EA(o,r,this.callSetDisabledState),r.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let n=this.form.get(r.path);Jue(n,r),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let n=this.form.get(r.path);n&&eGe(n,r)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){fU(this.form,this),this._oldForm&&$L(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(n){return new(n||e)(Te(em,10),Te(GL,10),Te(vx,8))},e.\u0275dir=Ot({type:e,selectors:[["","formGroup",""]],hostBindings:function(n,o){n&1&&At("submit",function(a){return o.onSubmit(a)})("reset",function(){return o.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[zi([aGe]),vr,Li]});let t=e;return t})();var lGe=(()=>{let e=class e{constructor(){this._validator=VL}ngOnChanges(r){if(this.inputName in r){let n=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):VL,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,features:[Li]});let t=e;return t})();var cGe={provide:em,useExisting:hc(()=>mU),multi:!0};var mU=(()=>{let e=class e extends lGe{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=bi,this.createValidator=r=>Bue}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=el(e)))(o||e)}})(),e.\u0275dir=Ot({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,o){n&2&&mi("required",o._enabled?"":null)},inputs:{required:"required"},features:[zi([cGe]),vr]});let t=e;return t})();var ohe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({});let t=e;return t})(),lU=class extends gx{constructor(e,i,r){super(uU(i),hU(r,i)),this.controls=e,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,i={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(e,i,r={}){this.controls.splice(e,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(e,i,r={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),i&&(this.controls.splice(n,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,i={}){Zue(this,!1,e),e.forEach((r,n)=>{Kue(this,!1,n),this.at(n).setValue(r,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(e,i={}){e!=null&&(e.forEach((r,n)=>{this.at(n)&&this.at(n).patchValue(r,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(e=[],i={}){this._forEachChild((r,n)=>{r.reset(e[n],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i,this),this._updateTouched(i,this),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((i,r)=>r._syncPendingControls()?!0:i,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((i,r)=>{e(i,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(i=>i.enabled&&e(i))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Lue(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var she=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let r=new e;return r.useNonNullable=!0,r}group(r,n=null){let o=this._reduceControls(r),s={};return Lue(n)?s=n:n!==null&&(s.validators=n.validator,s.asyncValidators=n.asyncValidator),new uv(o,s)}record(r,n=null){let o=this._reduceControls(r);return new aU(o,n)}control(r,n,o){let s={};return this.useNonNullable?(Lue(n)?s=n:(s.validators=n,s.asyncValidators=o),new jd(r,Lt(Ke({},s),{nonNullable:!0}))):new jd(r,n,o)}array(r,n,o){let s=r.map(a=>this._createControl(a));return new lU(s,n,o)}_reduceControls(r){let n={};return Object.keys(r).forEach(o=>{n[o]=this._createControl(r[o])}),n}_createControl(r){if(r instanceof jd)return r;if(r instanceof gx)return r;if(Array.isArray(r)){let n=r[0],o=r.length>1?r[1]:null,s=r.length>2?r[2]:null;return this.control(n,o,s)}else return this.control(r)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var AA=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:vx,useValue:r.callSetDisabledState??KL}]}}};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[ohe]});let t=e;return t})(),ahe=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:nhe,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:vx,useValue:r.callSetDisabledState??KL}]}}};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[ohe]});let t=e;return t})();var dGe=U(nl(),1),lhe=U(nl(),1),D_=lhe.default||dGe,vU=new St("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:uGe});function uGe(){return{useUtc:!1}}function hGe(t,e){let i=Array(t);for(let r=0;r<t;r++)i[r]=e(r);return i}var fGe=(()=>{let e=class e extends ea{constructor(r,n){super(),this._options=n,this.setLocale(r||D_.locale())}setLocale(r){super.setLocale(r);let n=D_.localeData(r);this._localeData={firstDayOfWeek:n.firstDayOfWeek(),longMonths:n.months(),shortMonths:n.monthsShort(),dates:hGe(31,o=>this.createDate(2017,0,o+1).format("D")),longDaysOfWeek:n.weekdays(),shortDaysOfWeek:n.weekdaysShort(),narrowDaysOfWeek:n.weekdaysMin()}}getYear(r){return this.clone(r).year()}getMonth(r){return this.clone(r).month()}getDate(r){return this.clone(r).date()}getDayOfWeek(r){return this.clone(r).day()}getMonthNames(r){return r=="long"?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(r){return r=="long"?this._localeData.longDaysOfWeek:r=="short"?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(r){return this.clone(r).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(r){return this.clone(r).daysInMonth()}clone(r){return r.clone().locale(this.locale)}createDate(r,n,o){let s=this._createMoment({year:r,month:n,date:o}).locale(this.locale);return s.isValid(),s}today(){return this._createMoment().locale(this.locale)}parse(r,n){return r&&typeof r=="string"?this._createMoment(r,n,this.locale):r?this._createMoment(r).locale(this.locale):null}format(r,n){return r=this.clone(r),this.isValid(r),r.format(n)}addCalendarYears(r,n){return this.clone(r).add({years:n})}addCalendarMonths(r,n){return this.clone(r).add({months:n})}addCalendarDays(r,n){return this.clone(r).add({days:n})}toIso8601(r){return this.clone(r).format()}deserialize(r){let n;if(r instanceof Date)n=this._createMoment(r).locale(this.locale);else if(this.isDateInstance(r))return this.clone(r);if(typeof r=="string"){if(!r)return null;n=this._createMoment(r,D_.ISO_8601).locale(this.locale)}return n&&this.isValid(n)?this._createMoment(n).locale(this.locale):super.deserialize(r)}isDateInstance(r){return D_.isMoment(r)}isValid(r){return this.clone(r).isValid()}invalid(){return D_.invalid()}_createMoment(r,n,o){let{strict:s,useUtc:a}=this._options||{};return a?D_.utc(r,n,o,s):D_(r,n,o,s)}};e.\u0275fac=function(n){return new(n||e)(lt(ZW,8),lt(vU,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac});let t=e;return t})(),pGe={parse:{dateInput:"l"},display:{dateInput:"l",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};function che(t=pGe,e){let i=[{provide:ea,useClass:fGe,deps:[ZW,vU]},{provide:Jp,useValue:t}];return e&&i.push({provide:vU,useValue:e}),i}var dhe=pc({passive:!0}),uhe=(()=>{let e=class e{constructor(r,n){this._platform=r,this._ngZone=n,this._monitoredElements=new Map}monitor(r){if(!this._platform.isBrowser)return qC;let n=Hd(r),o=this._monitoredElements.get(n);if(o)return o.subject;let s=new Ft,a="cdk-text-field-autofilled",c=d=>{d.animationName==="cdk-text-field-autofill-start"&&!n.classList.contains(a)?(n.classList.add(a),this._ngZone.run(()=>s.next({target:d.target,isAutofilled:!0}))):d.animationName==="cdk-text-field-autofill-end"&&n.classList.contains(a)&&(n.classList.remove(a),this._ngZone.run(()=>s.next({target:d.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{n.addEventListener("animationstart",c,dhe),n.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(n,{subject:s,unlisten:()=>{n.removeEventListener("animationstart",c,dhe)}}),s}stopMonitoring(r){let n=Hd(r),o=this._monitoredElements.get(n);o&&(o.unlisten(),o.subject.complete(),n.classList.remove("cdk-text-field-autofill-monitored"),n.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(n))}ngOnDestroy(){this._monitoredElements.forEach((r,n)=>this.stopMonitoring(n))}};e.\u0275fac=function(n){return new(n||e)(lt(yr),lt(ni))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var hhe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({});let t=e;return t})();var gGe=["notch"],vGe=["matFormFieldNotchedOutline",""],bGe=["*"],_Ge=["textField"],yGe=["iconPrefixContainer"],wGe=["textPrefixContainer"],CGe=["iconSuffixContainer"],xGe=["textSuffixContainer"],SGe=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],EGe=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function TGe(t,e){t&1&&bt(0,"span",21)}function RGe(t,e){if(t&1&&(ae(0,"label",20),Ri(1,1),wi(2,TGe,1,0,"span",21),ne()),t&2){let i=$t(2);ht("floating",i._shouldLabelFloat())("monitorResize",i._hasOutline())("id",i._labelId),mi("for",i._control.disableAutomaticLabeling?null:i._control.id),Ye(2),Mr(!i.hideRequiredMarker&&i._control.required?2:-1)}}function AGe(t,e){if(t&1&&wi(0,RGe,3,5,"label",20),t&2){let i=$t();Mr(i._hasFloatingLabel()?0:-1)}}function IGe(t,e){t&1&&bt(0,"div",7)}function DGe(t,e){}function MGe(t,e){if(t&1&&wi(0,DGe,0,0,"ng-template",13),t&2){$t(2);let i=Js(1);ht("ngTemplateOutlet",i)}}function kGe(t,e){if(t&1&&(ae(0,"div",9),wi(1,MGe,1,1,null,13),ne()),t&2){let i=$t();ht("matFormFieldNotchedOutlineOpen",i._shouldLabelFloat()),Ye(),Mr(i._forceDisplayInfixLabel()?-1:1)}}function OGe(t,e){t&1&&(ae(0,"div",10,2),Ri(2,2),ne())}function NGe(t,e){t&1&&(ae(0,"div",11,3),Ri(2,3),ne())}function PGe(t,e){}function LGe(t,e){if(t&1&&wi(0,PGe,0,0,"ng-template",13),t&2){$t();let i=Js(1);ht("ngTemplateOutlet",i)}}function FGe(t,e){t&1&&(ae(0,"div",14,4),Ri(2,4),ne())}function HGe(t,e){t&1&&(ae(0,"div",15,5),Ri(2,5),ne())}function BGe(t,e){t&1&&bt(0,"div",16)}function VGe(t,e){if(t&1&&(ae(0,"div",18),Ri(1,6),ne()),t&2){let i=$t();ht("@transitionMessages",i._subscriptAnimationState)}}function jGe(t,e){if(t&1&&(ae(0,"mat-hint",22),_e(1),ne()),t&2){let i=$t(2);ht("id",i._hintLabelId),Ye(),zn(i.hintLabel)}}function zGe(t,e){if(t&1&&(ae(0,"div",19),wi(1,jGe,2,2,"mat-hint",22),Ri(2,7),bt(3,"div",23),Ri(4,8),ne()),t&2){let i=$t();ht("@transitionMessages",i._subscriptAnimationState),Ye(),Mr(i.hintLabel?1:-1)}}var IA=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,selectors:[["mat-label"]],standalone:!0});let t=e;return t})();var WGe=new St("MatError");var UGe=0,fhe=(()=>{let e=class e{constructor(){this.align="start",this.id=`mat-mdc-hint-${UGe++}`}};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(n,o){n&2&&(il("id",o.id),mi("align",null),hi("mat-mdc-form-field-hint-end",o.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0});let t=e;return t})(),qGe=new St("MatPrefix");var whe=new St("MatSuffix"),Che=(()=>{let e=class e{constructor(){this._isText=!1}set _isTextSelector(r){this._isText=!0}};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:[0,"matTextSuffix","_isTextSelector"]},standalone:!0,features:[zi([{provide:whe,useExisting:e}])]});let t=e;return t})(),xhe=new St("FloatingLabelParent"),phe=(()=>{let e=class e{get floating(){return this._floating}set floating(r){this._floating=r,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(r){this._monitorResize=r,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(r){this._elementRef=r,this._floating=!1,this._monitorResize=!1,this._resizeObserver=Jt(Tue),this._ngZone=Jt(ni),this._parent=Jt(xhe),this._resizeSubscription=new jn}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return YGe(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}};e.\u0275fac=function(n){return new(n||e)(Te(qt))},e.\u0275dir=Ot({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(n,o){n&2&&hi("mdc-floating-label--float-above",o.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0});let t=e;return t})();function YGe(t){let e=t;if(e.offsetParent!==null)return e.scrollWidth;let i=e.cloneNode(!0);i.style.setProperty("position","absolute"),i.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(i);let r=i.scrollWidth;return i.remove(),r}var mhe="mdc-line-ripple--active",QL="mdc-line-ripple--deactivating",ghe=(()=>{let e=class e{constructor(r,n){this._elementRef=r,this._handleTransitionEnd=o=>{let s=this._elementRef.nativeElement.classList,a=s.contains(QL);o.propertyName==="opacity"&&a&&s.remove(mhe,QL)},n.runOutsideAngular(()=>{r.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let r=this._elementRef.nativeElement.classList;r.remove(QL),r.add(mhe)}deactivate(){this._elementRef.nativeElement.classList.add(QL)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(ni))},e.\u0275dir=Ot({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0});let t=e;return t})(),vhe=(()=>{let e=class e{constructor(r,n){this._elementRef=r,this._ngZone=n,this.open=!1}ngAfterViewInit(){let r=this._elementRef.nativeElement.querySelector(".mdc-floating-label");r?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(r.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>r.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(r){!this.open||!r?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${r}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(ni))},e.\u0275cmp=Tt({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(n,o){if(n&1&&Ii(gGe,5),n&2){let s;ai(s=li())&&(o._notch=s.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(n,o){n&2&&hi("mdc-notched-outline--notched",o.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[zt],attrs:vGe,ngContentSelectors:bGe,decls:5,vars:0,consts:[["notch",""],[1,"mat-mdc-notch-piece","mdc-notched-outline__leading"],[1,"mat-mdc-notch-piece","mdc-notched-outline__notch"],[1,"mat-mdc-notch-piece","mdc-notched-outline__trailing"]],template:function(n,o){n&1&&(Br(),bt(0,"div",1),ae(1,"div",2,0),Ri(3),ne(),bt(4,"div",3))},encapsulation:2,changeDetection:0});let t=e;return t})(),$Ge={transitionMessages:zu("transitionMessages",[df("enter",ns({opacity:1,transform:"translateY(0%)"})),Ll("void => enter",[ns({opacity:0,transform:"translateY(-5px)"}),fc("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},yx=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e});let t=e;return t})();var M_=new St("MatFormField"),GGe=new St("MAT_FORM_FIELD_DEFAULT_OPTIONS"),bhe=0,_he="fill",XGe="auto",yhe="fixed",KGe="translateY(-50%)",bU=(()=>{let e=class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(r){this._hideRequiredMarker=hf(r)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||XGe}set floatLabel(r){r!==this._floatLabel&&(this._floatLabel=r,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(r){let n=this._appearance,o=r||this._defaults?.appearance||_he;this._appearance=o,this._appearance==="outline"&&this._appearance!==n&&(this._needsOutlineLabelOffsetUpdate=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||yhe}set subscriptSizing(r){this._subscriptSizing=r||this._defaults?.subscriptSizing||yhe}get hintLabel(){return this._hintLabel}set hintLabel(r){this._hintLabel=r,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(r){this._explicitFormFieldControl=r}constructor(r,n,o,s,a,c,d,u){this._elementRef=r,this._changeDetectorRef=n,this._dir=s,this._platform=a,this._defaults=c,this._animationMode=d,this._labelChild=dde(IA),this._hideRequiredMarker=!1,this.color="primary",this._appearance=_he,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${bhe++}`,this._hintLabelId=`mat-mdc-hint-${bhe++}`,this._subscriptAnimationState="",this._destroyed=new Ft,this._isFocused=null,this._needsOutlineLabelOffsetUpdate=!1,this._previousControl=null,this._injector=Jt(kn),this.getLabelId=CW(()=>this._hasFloatingLabel()?this._labelId:null),this._hasFloatingLabel=CW(()=>!!this._labelChild()),c&&(c.appearance&&(this.appearance=c.appearance),this._hideRequiredMarker=!!c?.hideRequiredMarker,c.color&&(this.color=c.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl(),this._control!==this._previousControl&&(this._initializeControl(this._previousControl),this._previousControl=this._control)}ngOnDestroy(){this._stateChanges?.unsubscribe(),this._valueChanges?.unsubscribe(),this._destroyed.next(),this._destroyed.complete()}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(r){let n=this._control,o="mat-mdc-form-field-type-";r&&this._elementRef.nativeElement.classList.remove(o+r.controlType),n.controlType&&this._elementRef.nativeElement.classList.add(o+n.controlType),this._stateChanges?.unsubscribe(),this._stateChanges=n.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._valueChanges?.unsubscribe(),n.ngControl&&n.ngControl.valueChanges&&(this._valueChanges=n.ngControl.valueChanges.pipe(Hr(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()))}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(r=>!r._isText),this._hasTextPrefix=!!this._prefixChildren.find(r=>r._isText),this._hasIconSuffix=!!this._suffixChildren.find(r=>!r._isText),this._hasTextSuffix=!!this._suffixChildren.find(r=>r._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Ra(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),fL(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(Hr(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_shouldLabelFloat(){return this._hasFloatingLabel()?this._control.shouldLabelFloat||this._shouldAlwaysFloat():!1}_shouldForward(r){let n=this._control?this._control.ngControl:null;return n&&n[r]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let r=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&r.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let n=this._hintChildren?this._hintChildren.find(s=>s.align==="start"):null,o=this._hintChildren?this._hintChildren.find(s=>s.align==="end"):null;n?r.push(n.id):this._hintLabel&&r.push(this._hintLabelId),o&&r.push(o.id)}else this._errorChildren&&r.push(...this._errorChildren.map(n=>n.id));this._control.setDescribedByIds(r)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;let r=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){r.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdate=!0;return}let n=this._iconPrefixContainer?.nativeElement,o=this._textPrefixContainer?.nativeElement,s=this._iconSuffixContainer?.nativeElement,a=this._textSuffixContainer?.nativeElement,c=n?.getBoundingClientRect().width??0,d=o?.getBoundingClientRect().width??0,u=s?.getBoundingClientRect().width??0,h=a?.getBoundingClientRect().width??0,p=this._dir.value==="rtl"?"-1":"1",f=`${c+d}px`,g=`calc(${p} * (${f} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;r.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${KGe} translateX(${g})
    )`;let y=c+d+u+h;this._elementRef.nativeElement.style.setProperty("--mat-form-field-notch-max-width",`calc(100% - ${y}px)`)}_isAttachedToDom(){let r=this._elementRef.nativeElement;if(r.getRootNode){let n=r.getRootNode();return n&&n!==r}return document.documentElement.contains(r)}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(Xi),Te(ni),Te(ss),Te(yr),Te(GGe,8),Te(rs,8),Te(ir))},e.\u0275cmp=Tt({type:e,selectors:[["mat-form-field"]],contentQueries:function(n,o,s){if(n&1&&(mde(s,o._labelChild,IA,5),ws(s,yx,5),ws(s,qGe,5),ws(s,whe,5),ws(s,WGe,5),ws(s,fhe,5)),n&2){gde();let a;ai(a=li())&&(o._formFieldControl=a.first),ai(a=li())&&(o._prefixChildren=a),ai(a=li())&&(o._suffixChildren=a),ai(a=li())&&(o._errorChildren=a),ai(a=li())&&(o._hintChildren=a)}},viewQuery:function(n,o){if(n&1&&(Ii(_Ge,5),Ii(yGe,5),Ii(wGe,5),Ii(CGe,5),Ii(xGe,5),Ii(phe,5),Ii(vhe,5),Ii(ghe,5)),n&2){let s;ai(s=li())&&(o._textField=s.first),ai(s=li())&&(o._iconPrefixContainer=s.first),ai(s=li())&&(o._textPrefixContainer=s.first),ai(s=li())&&(o._iconSuffixContainer=s.first),ai(s=li())&&(o._textSuffixContainer=s.first),ai(s=li())&&(o._floatingLabel=s.first),ai(s=li())&&(o._notchedOutline=s.first),ai(s=li())&&(o._lineRipple=s.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(n,o){n&2&&hi("mat-mdc-form-field-label-always-float",o._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",o._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",o._hasIconSuffix)("mat-form-field-invalid",o._control.errorState)("mat-form-field-disabled",o._control.disabled)("mat-form-field-autofilled",o._control.autofilled)("mat-form-field-no-animations",o._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",o.appearance=="fill")("mat-form-field-appearance-outline",o.appearance=="outline")("mat-form-field-hide-placeholder",o._hasFloatingLabel()&&!o._shouldLabelFloat())("mat-focused",o._control.focused)("mat-primary",o.color!=="accent"&&o.color!=="warn")("mat-accent",o.color==="accent")("mat-warn",o.color==="warn")("ng-untouched",o._shouldForward("untouched"))("ng-touched",o._shouldForward("touched"))("ng-pristine",o._shouldForward("pristine"))("ng-dirty",o._shouldForward("dirty"))("ng-valid",o._shouldForward("valid"))("ng-invalid",o._shouldForward("invalid"))("ng-pending",o._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[zi([{provide:M_,useExisting:e},{provide:xhe,useExisting:e}]),zt],ngContentSelectors:EGe,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],["textSuffixContainer",""],["iconSuffixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(n,o){if(n&1){let s=eo();Br(SGe),wi(0,AGe,1,1,"ng-template",null,0,pL),ae(2,"div",6,1),At("click",function(c){return _i(s),yi(o._control.onContainerClick(c))}),wi(4,IGe,1,0,"div",7),ae(5,"div",8),wi(6,kGe,2,2,"div",9)(7,OGe,3,0,"div",10)(8,NGe,3,0,"div",11),ae(9,"div",12),wi(10,LGe,1,1,null,13),Ri(11),ne(),wi(12,FGe,3,0,"div",14)(13,HGe,3,0,"div",15),ne(),wi(14,BGe,1,0,"div",16),ne(),ae(15,"div",17),wi(16,VGe,2,1,"div",18)(17,zGe,5,2,"div",19),ne()}if(n&2){let s;Ye(2),hi("mdc-text-field--filled",!o._hasOutline())("mdc-text-field--outlined",o._hasOutline())("mdc-text-field--no-label",!o._hasFloatingLabel())("mdc-text-field--disabled",o._control.disabled)("mdc-text-field--invalid",o._control.errorState),Ye(2),Mr(!o._hasOutline()&&!o._control.disabled?4:-1),Ye(2),Mr(o._hasOutline()?6:-1),Ye(),Mr(o._hasIconPrefix?7:-1),Ye(),Mr(o._hasTextPrefix?8:-1),Ye(2),Mr(!o._hasOutline()||o._forceDisplayInfixLabel()?10:-1),Ye(2),Mr(o._hasTextSuffix?12:-1),Ye(),Mr(o._hasIconSuffix?13:-1),Ye(),Mr(o._hasOutline()?-1:14),Ye(),hi("mat-mdc-form-field-subscript-dynamic-size",o.subscriptSizing==="dynamic"),Ye(),Mr((s=o._getDisplayedMessages())==="error"?16:s==="hint"?17:-1)}},dependencies:[phe,vhe,vL,ghe,fhe],styles:['.mdc-text-field{display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field__input{width:100%;min-width:0;border:none;border-radius:0;background:none;padding:0;-moz-appearance:none;-webkit-appearance:none;height:28px}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input::placeholder{opacity:0}.mdc-text-field__input::-moz-placeholder{opacity:0}.mdc-text-field__input::-webkit-input-placeholder{opacity:0}.mdc-text-field__input:-ms-input-placeholder{opacity:0}.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}.mdc-text-field--outlined .mdc-text-field__input,.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color, var(--mat-app-on-surface));caret-color:var(--mdc-filled-text-field-caret-color, var(--mat-app-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-app-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-app-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-app-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-app-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color, var(--mat-app-on-surface));caret-color:var(--mdc-outlined-text-field-caret-color, var(--mat-app-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-app-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-app-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-app-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-app-on-surface-variant))}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--disabled .cdk-high-contrast-active .mdc-text-field__input{background-color:Window}.mdc-text-field--filled{height:56px;border-bottom-right-radius:0;border-bottom-left-radius:0;border-top-left-radius:var(--mdc-filled-text-field-container-shape, var(--mat-app-corner-extra-small-top));border-top-right-radius:var(--mdc-filled-text-field-container-shape, var(--mat-app-corner-extra-small-top))}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color, var(--mat-app-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--outlined{height:56px;overflow:visible;padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small)));padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small)) + 4px)}[dir=rtl] .mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small)) + 4px);padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small)))}.mdc-floating-label{position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:auto}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label{left:auto;right:4px}.mdc-text-field--filled .mdc-floating-label{left:16px;right:auto}[dir=rtl] .mdc-text-field--filled .mdc-floating-label{left:auto;right:16px}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.cdk-high-contrast-active .mdc-text-field--disabled .mdc-floating-label{z-index:1}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-filled-text-field-label-text-color, var(--mat-app-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-focus-label-text-color, var(--mat-app-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-filled-text-field-hover-label-text-color, var(--mat-app-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-filled-text-field-error-label-text-color, var(--mat-app-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-error-focus-label-text-color, var(--mat-app-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-filled-text-field-error-hover-label-text-color, var(--mat-app-on-error-container))}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font, var(--mat-app-body-large-font));font-size:var(--mdc-filled-text-field-label-text-size, var(--mat-app-body-large-size));font-weight:var(--mdc-filled-text-field-label-text-weight, var(--mat-app-body-large-weight));letter-spacing:var(--mdc-filled-text-field-label-text-tracking, var(--mat-app-body-large-tracking))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-outlined-text-field-label-text-color, var(--mat-app-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-focus-label-text-color, var(--mat-app-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-hover-label-text-color, var(--mat-app-on-surface))}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-outlined-text-field-error-label-text-color, var(--mat-app-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-error-focus-label-text-color, var(--mat-app-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-error-hover-label-text-color, var(--mat-app-on-error-container))}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font, var(--mat-app-body-large-font));font-size:var(--mdc-outlined-text-field-label-text-size, var(--mat-app-body-large-size));font-weight:var(--mdc-outlined-text-field-label-text-weight, var(--mat-app-body-large-weight));letter-spacing:var(--mdc-outlined-text-field-label-text-tracking, var(--mat-app-body-large-tracking))}.mdc-floating-label--float-above{cursor:auto;transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1);font-size:.75rem}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mat-mdc-notch-piece{box-sizing:border-box;height:100%;pointer-events:none;border-top:1px solid;border-bottom:1px solid}.mdc-text-field--focused .mat-mdc-notch-piece{border-width:2px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-outline-color, var(--mat-app-outline));border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-hover-outline-color, var(--mat-app-on-surface))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-focus-outline-color, var(--mat-app-primary))}.mdc-text-field--outlined.mdc-text-field--disabled .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-outline-color, var(--mat-app-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-notched-outline .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-hover-outline-color, var(--mat-app-on-error-container))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-focus-outline-color, var(--mat-app-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mat-mdc-notch-piece{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small))}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small)))}[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid;border-bottom-left-radius:0;border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small))}.mdc-notched-outline__trailing{flex-grow:1;border-left:none;border-right:1px solid;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small))}[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small))}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:min(var(--mat-form-field-notch-max-width, 100%),100% - max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-app-corner-extra-small)))*2)}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none;--mat-form-field-notch-max-width: 100%}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1;border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color, var(--mat-app-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color, var(--mat-app-on-surface))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color, var(--mat-app-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color, var(--mat-app-on-error-container))}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color, var(--mat-app-primary))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color, var(--mat-app-error))}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-text-field--disabled{pointer-events:none}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color, var(--mat-app-error))}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font, var(--mat-app-body-small-font));line-height:var(--mat-form-field-subscript-text-line-height, var(--mat-app-body-small-line-height));font-size:var(--mat-form-field-subscript-text-size, var(--mat-app-body-small-size));letter-spacing:var(--mat-form-field-subscript-text-tracking, var(--mat-app-body-small-tracking));font-weight:var(--mat-form-field-subscript-text-weight, var(--mat-app-body-small-weight))}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color, var(--mat-app-on-surface))}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color, var(--mat-app-on-surface-variant))}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color, var(--mat-app-primary))}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font, var(--mat-app-body-large-font));line-height:var(--mat-form-field-container-text-line-height, var(--mat-app-body-large-line-height));font-size:var(--mat-form-field-container-text-size, var(--mat-app-body-large-size));letter-spacing:var(--mat-form-field-container-text-tracking, var(--mat-app-body-large-tracking));font-weight:var(--mat-form-field-container-text-weight, var(--mat-app-body-large-weight))}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color, var(--mat-app-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color, var(--mat-app-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color, var(--mat-app-error))}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color, var(--mat-app-on-error-container))}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color, var(--mat-app-error))}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field-infix:has(textarea[cols]){width:auto}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::-moz-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::-webkit-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[$Ge.transitionMessages]},changeDetection:0});let t=e;return t})(),hv=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,Wn,nx,oi]});let t=e;return t})();var _U=new St("MAT_INPUT_VALUE_ACCESSOR"),QGe=["button","checkbox","file","hidden","image","radio","range","reset","submit"],JGe=0,yU=(()=>{let e=class e{get disabled(){return this._disabled}set disabled(r){this._disabled=hf(r),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(r){this._id=r||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(lv.required)??!1}set required(r){this._required=hf(r)}get type(){return this._type}set type(r){this._type=r||"text",this._validateType(),!this._isTextarea&&PW().has(this._type)&&(this._elementRef.nativeElement.type=this._type),this._ensureWheelDefaultBehavior()}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(r){this._errorStateTracker.matcher=r}get value(){return this._inputValueAccessor.value}set value(r){r!==this.value&&(this._inputValueAccessor.value=r,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(r){this._readonly=hf(r)}get errorState(){return this._errorStateTracker.errorState}set errorState(r){this._errorStateTracker.errorState=r}constructor(r,n,o,s,a,c,d,u,h,p){this._elementRef=r,this._platform=n,this.ngControl=o,this._autofillMonitor=u,this._ngZone=h,this._formField=p,this._uid=`mat-input-${JGe++}`,this._webkitBlinkWheelListenerAttached=!1,this.focused=!1,this.stateChanges=new Ft,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(g=>PW().has(g)),this._iOSKeyupListener=g=>{let y=g.target;!y.value&&y.selectionStart===0&&y.selectionEnd===0&&(y.setSelectionRange(1,1),y.setSelectionRange(0,0))},this._webkitBlinkWheelListener=()=>{};let f=this._elementRef.nativeElement,m=f.nodeName.toLowerCase();this._inputValueAccessor=d||f,this._previousNativeValue=this.value,this.id=this.id,n.IOS&&h.runOutsideAngular(()=>{r.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new x_(c,o,a,s,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=m==="select",this._isTextarea=m==="textarea",this._isInFormField=!!p,this._isNativeSelect&&(this.controlType=f.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(r=>{this.autofilled=r.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener),this._webkitBlinkWheelListenerAttached&&this._elementRef.nativeElement.removeEventListener("wheel",this._webkitBlinkWheelListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(r){this._elementRef.nativeElement.focus(r)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(r){r!==this.focused&&(this.focused=r,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let r=this._elementRef.nativeElement.value;this._previousNativeValue!==r&&(this._previousNativeValue=r,this.stateChanges.next())}_dirtyCheckPlaceholder(){let r=this._getPlaceholder();if(r!==this._previousPlaceholder){let n=this._elementRef.nativeElement;this._previousPlaceholder=r,r?n.setAttribute("placeholder",r):n.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){QGe.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let r=this._elementRef.nativeElement.validity;return r&&r.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let r=this._elementRef.nativeElement,n=r.options[0];return this.focused||r.multiple||!this.empty||!!(r.selectedIndex>-1&&n&&n.label)}else return this.focused||!this.empty}setDescribedByIds(r){r.length?this._elementRef.nativeElement.setAttribute("aria-describedby",r.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let r=this._elementRef.nativeElement;return this._isNativeSelect&&(r.multiple||r.size>1)}_ensureWheelDefaultBehavior(){!this._webkitBlinkWheelListenerAttached&&this._type==="number"&&(this._platform.BLINK||this._platform.WEBKIT)&&(this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("wheel",this._webkitBlinkWheelListener)}),this._webkitBlinkWheelListenerAttached=!0),this._webkitBlinkWheelListenerAttached&&this._type!=="number"&&(this._elementRef.nativeElement.removeEventListener("wheel",this._webkitBlinkWheelListener),this._webkitBlinkWheelListenerAttached=!0)}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(yr),Te(zd,10),Te(I_,8),Te(RA,8),Te(mA),Te(_U,10),Te(uhe),Te(ni),Te(M_,8))},e.\u0275dir=Ot({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(n,o){n&1&&At("focus",function(){return o._focusChanged(!0)})("blur",function(){return o._focusChanged(!1)})("input",function(){return o._onInput()}),n&2&&(il("id",o.id)("disabled",o.disabled)("required",o.required),mi("name",o.name||null)("readonly",o.readonly&&!o._isNativeSelect||null)("aria-invalid",o.empty&&o.required?null:o.errorState)("aria-required",o.required)("id",o.id),hi("mat-input-server",o._isServer)("mat-mdc-form-field-textarea-control",o._isInFormField&&o._isTextarea)("mat-mdc-form-field-input-control",o._isInFormField)("mdc-text-field__input",o._isInFormField)("mat-mdc-native-select-inline",o._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[zi([{provide:yx,useExisting:e}]),Li]});let t=e;return t})(),wU=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,hv,hv,hhe,oi]});let t=e;return t})();var She=Gde(),CU=class{constructor(e,i){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=i}attach(){}enable(){if(this._canBeEnabled()){let e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=os(-this._previousScrollPosition.left),e.style.top=os(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let e=this._document.documentElement,i=this._document.body,r=e.style,n=i.style,o=r.scrollBehavior||"",s=n.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),She&&(r.scrollBehavior=n.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),She&&(r.scrollBehavior=o,n.scrollBehavior=s)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let i=this._document.body,r=this._viewportRuler.getViewportSize();return i.scrollHeight>r.height||i.scrollWidth>r.width}};var xU=class{constructor(e,i,r,n){this._scrollDispatcher=e,this._ngZone=i,this._viewportRuler=r,this._config=n,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(this._scrollSubscription)return;let e=this._scrollDispatcher.scrolled(0).pipe(Ls(i=>!i||!this._overlayRef.overlayElement.contains(i.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{let i=this._viewportRuler.getViewportScrollPosition().top;Math.abs(i-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},JL=class{enable(){}disable(){}attach(){}};function SU(t,e){return e.some(i=>{let r=t.bottom<i.top,n=t.top>i.bottom,o=t.right<i.left,s=t.left>i.right;return r||n||o||s})}function Ehe(t,e){return e.some(i=>{let r=t.top<i.top,n=t.bottom>i.bottom,o=t.left<i.left,s=t.right>i.right;return r||n||o||s})}var EU=class{constructor(e,i,r,n){this._scrollDispatcher=e,this._viewportRuler=i,this._ngZone=r,this._config=n,this._scrollSubscription=null}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(!this._scrollSubscription){let e=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(e).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let i=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:n}=this._viewportRuler.getViewportSize();SU(i,[{width:r,height:n,bottom:n,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},tXe=(()=>{let e=class e{constructor(r,n,o,s){this._scrollDispatcher=r,this._viewportRuler=n,this._ngZone=o,this.noop=()=>new JL,this.close=a=>new xU(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new CU(this._viewportRuler,this._document),this.reposition=a=>new EU(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=s}};e.\u0275fac=function(n){return new(n||e)(lt(bA),lt(fx),lt(ni),lt(ir))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),mf=class{constructor(e){if(this.scrollStrategy=new JL,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){let i=Object.keys(e);for(let r of i)e[r]!==void 0&&(this[r]=e[r])}}};var TU=class{constructor(e,i){this.connectionPair=e,this.scrollableViewProperties=i}};var Mhe=(()=>{let e=class e{constructor(r){this._attachedOverlays=[],this._document=r}ngOnDestroy(){this.detach()}add(r){this.remove(r),this._attachedOverlays.push(r)}remove(r){let n=this._attachedOverlays.indexOf(r);n>-1&&this._attachedOverlays.splice(n,1),this._attachedOverlays.length===0&&this.detach()}};e.\u0275fac=function(n){return new(n||e)(lt(ir))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),iXe=(()=>{let e=class e extends Mhe{constructor(r,n){super(r),this._ngZone=n,this._keydownListener=o=>{let s=this._attachedOverlays;for(let a=s.length-1;a>-1;a--)if(s[a]._keydownEvents.observers.length>0){let c=s[a]._keydownEvents;this._ngZone?this._ngZone.run(()=>c.next(o)):c.next(o);break}}}add(r){super.add(r),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}};e.\u0275fac=function(n){return new(n||e)(lt(ir),lt(ni,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),rXe=(()=>{let e=class e extends Mhe{constructor(r,n,o){super(r),this._platform=n,this._ngZone=o,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=td(s)},this._clickListener=s=>{let a=td(s),c=s.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:a;this._pointerDownEventTarget=null;let d=this._attachedOverlays.slice();for(let u=d.length-1;u>-1;u--){let h=d[u];if(h._outsidePointerEvents.observers.length<1||!h.hasAttached())continue;if(The(h.overlayElement,a)||The(h.overlayElement,c))break;let p=h._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>p.next(s)):p.next(s)}}}add(r){if(super.add(r),!this._isAttached){let n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let r=this._document.body;r.removeEventListener("pointerdown",this._pointerDownListener,!0),r.removeEventListener("click",this._clickListener,!0),r.removeEventListener("auxclick",this._clickListener,!0),r.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(r.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(r){r.addEventListener("pointerdown",this._pointerDownListener,!0),r.addEventListener("click",this._clickListener,!0),r.addEventListener("auxclick",this._clickListener,!0),r.addEventListener("contextmenu",this._clickListener,!0)}};e.\u0275fac=function(n){return new(n||e)(lt(ir),lt(yr),lt(ni,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function The(t,e){let i=typeof ShadowRoot<"u"&&ShadowRoot,r=e;for(;r;){if(r===t)return!0;r=i&&r instanceof ShadowRoot?r.host:r.parentNode}return!1}var wx=(()=>{let e=class e{constructor(r,n){this._platform=n,this._document=r}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let r="cdk-overlay-container";if(this._platform.isBrowser||cA()){let o=this._document.querySelectorAll(`.${r}[platform="server"], .${r}[platform="test"]`);for(let s=0;s<o.length;s++)o[s].remove()}let n=this._document.createElement("div");n.classList.add(r),cA()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}};e.\u0275fac=function(n){return new(n||e)(lt(ir),lt(yr))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),tm=class{constructor(e,i,r,n,o,s,a,c,d,u=!1,h){this._portalOutlet=e,this._host=i,this._pane=r,this._config=n,this._ngZone=o,this._keyboardDispatcher=s,this._document=a,this._location=c,this._outsideClickDispatcher=d,this._animationsDisabled=u,this._injector=h,this._backdropElement=null,this._backdropClick=new Ft,this._attachments=new Ft,this._detachments=new Ft,this._locationChanges=jn.EMPTY,this._backdropClickHandler=p=>this._backdropClick.next(p),this._backdropTransitionendHandler=p=>{this._disposeBackdrop(p.target)},this._keydownEvents=new Ft,this._outsidePointerEvents=new Ft,this._renders=new Ft,n.scrollStrategy&&(this._scrollStrategy=n.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=n.positionStrategy,this._afterRenderRef=Cde(()=>fL(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let i=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=ed(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof i?.onDestroy=="function"&&i.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),i}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){let e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=Ke(Ke({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Lt(Ke({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){let e=this._config.direction;return e?typeof e=="string"?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let e=this._pane.style;e.width=os(this._config.width),e.height=os(this._config.height),e.minWidth=os(this._config.minWidth),e.minHeight=os(this._config.minHeight),e.maxWidth=os(this._config.maxWidth),e.maxHeight=os(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){let e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(e){if(this._animationsDisabled){this._disposeBackdrop(e);return}e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,i,r){let n=rx(i||[]).filter(o=>!!o);n.length&&(r?e.classList.add(...n):e.classList.remove(...n))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let e=this._renders.pipe(Hr(Ra(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){let e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},Rhe="cdk-overlay-connected-position-bounding-box",nXe=/([A-Za-z%]+)$/,DA=class{get positions(){return this._preferredPositions}constructor(e,i,r,n,o){this._viewportRuler=i,this._document=r,this._platform=n,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Ft,this._resizeSubscription=jn.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._overlayRef&&this._overlayRef,this._validatePositions(),e.hostElement.classList.add(Rhe),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._originRect,i=this._overlayRect,r=this._viewportRect,n=this._containerRect,o=[],s;for(let a of this._preferredPositions){let c=this._getOriginPoint(e,n,a),d=this._getOverlayPoint(c,i,a),u=this._getOverlayFit(d,i,r,a);if(u.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(a,c);return}if(this._canFitWithFlexibleDimensions(u,d,r)){o.push({position:a,origin:c,overlayRect:i,boundingBoxRect:this._calculateBoundingBoxRect(c,a)});continue}(!s||s.overlayFit.visibleArea<u.visibleArea)&&(s={overlayFit:u,overlayPoint:d,originPoint:c,position:a,overlayRect:i})}if(o.length){let a=null,c=-1;for(let d of o){let u=d.boundingBoxRect.width*d.boundingBoxRect.height*(d.position.weight||1);u>c&&(c=u,a=d)}this._isPushed=!1,this._applyPosition(a.position,a.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(s.position,s.originPoint);return}this._applyPosition(s.position,s.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&k_(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Rhe),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,i)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,e.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,i,r){let n;if(r.originX=="center")n=e.left+e.width/2;else{let s=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;n=r.originX=="start"?s:a}i.left<0&&(n-=i.left);let o;return r.originY=="center"?o=e.top+e.height/2:o=r.originY=="top"?e.top:e.bottom,i.top<0&&(o-=i.top),{x:n,y:o}}_getOverlayPoint(e,i,r){let n;r.overlayX=="center"?n=-i.width/2:r.overlayX==="start"?n=this._isRtl()?-i.width:0:n=this._isRtl()?0:-i.width;let o;return r.overlayY=="center"?o=-i.height/2:o=r.overlayY=="top"?0:-i.height,{x:e.x+n,y:e.y+o}}_getOverlayFit(e,i,r,n){let o=Ihe(i),{x:s,y:a}=e,c=this._getOffset(n,"x"),d=this._getOffset(n,"y");c&&(s+=c),d&&(a+=d);let u=0-s,h=s+o.width-r.width,p=0-a,f=a+o.height-r.height,m=this._subtractOverflows(o.width,u,h),g=this._subtractOverflows(o.height,p,f),y=m*g;return{visibleArea:y,isCompletelyWithinViewport:o.width*o.height===y,fitsInViewportVertically:g===o.height,fitsInViewportHorizontally:m==o.width}}_canFitWithFlexibleDimensions(e,i,r){if(this._hasFlexibleDimensions){let n=r.bottom-i.y,o=r.right-i.x,s=Ahe(this._overlayRef.getConfig().minHeight),a=Ahe(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportVertically||s!=null&&s<=n,d=e.fitsInViewportHorizontally||a!=null&&a<=o;return c&&d}return!1}_pushOverlayOnScreen(e,i,r){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};let n=Ihe(i),o=this._viewportRect,s=Math.max(e.x+n.width-o.width,0),a=Math.max(e.y+n.height-o.height,0),c=Math.max(o.top-r.top-e.y,0),d=Math.max(o.left-r.left-e.x,0),u=0,h=0;return n.width<=o.width?u=d||-s:u=e.x<this._viewportMargin?o.left-r.left-e.x:0,n.height<=o.height?h=c||-a:h=e.y<this._viewportMargin?o.top-r.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,i){if(this._setTransformOrigin(e),this._setOverlayElementStyles(i,e),this._setBoundingBoxStyles(i,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){let r=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!oXe(this._lastScrollVisibility,r)){let n=new TU(e,r);this._positionChanges.next(n)}this._lastScrollVisibility=r}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;let i=this._boundingBox.querySelectorAll(this._transformOriginSelector),r,n=e.overlayY;e.overlayX==="center"?r="center":this._isRtl()?r=e.overlayX==="start"?"right":"left":r=e.overlayX==="start"?"left":"right";for(let o=0;o<i.length;o++)i[o].style.transformOrigin=`${r} ${n}`}_calculateBoundingBoxRect(e,i){let r=this._viewportRect,n=this._isRtl(),o,s,a;if(i.overlayY==="top")s=e.y,o=r.height-s+this._viewportMargin;else if(i.overlayY==="bottom")a=r.height-e.y+this._viewportMargin*2,o=r.height-a+this._viewportMargin;else{let f=Math.min(r.bottom-e.y+r.top,e.y),m=this._lastBoundingBoxSize.height;o=f*2,s=e.y-f,o>m&&!this._isInitialRender&&!this._growAfterOpen&&(s=e.y-m/2)}let c=i.overlayX==="start"&&!n||i.overlayX==="end"&&n,d=i.overlayX==="end"&&!n||i.overlayX==="start"&&n,u,h,p;if(d)p=r.width-e.x+this._viewportMargin*2,u=e.x-this._viewportMargin;else if(c)h=e.x,u=r.right-e.x;else{let f=Math.min(r.right-e.x+r.left,e.x),m=this._lastBoundingBoxSize.width;u=f*2,h=e.x-f,u>m&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-m/2)}return{top:s,left:h,bottom:a,right:p,width:u,height:o}}_setBoundingBoxStyles(e,i){let r=this._calculateBoundingBoxRect(e,i);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));let n={};if(this._hasExactPosition())n.top=n.left="0",n.bottom=n.right=n.maxHeight=n.maxWidth="",n.width=n.height="100%";else{let o=this._overlayRef.getConfig().maxHeight,s=this._overlayRef.getConfig().maxWidth;n.height=os(r.height),n.top=os(r.top),n.bottom=os(r.bottom),n.width=os(r.width),n.left=os(r.left),n.right=os(r.right),i.overlayX==="center"?n.alignItems="center":n.alignItems=i.overlayX==="end"?"flex-end":"flex-start",i.overlayY==="center"?n.justifyContent="center":n.justifyContent=i.overlayY==="bottom"?"flex-end":"flex-start",o&&(n.maxHeight=os(o)),s&&(n.maxWidth=os(s))}this._lastBoundingBoxSize=r,k_(this._boundingBox.style,n)}_resetBoundingBoxStyles(){k_(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){k_(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,i){let r={},n=this._hasExactPosition(),o=this._hasFlexibleDimensions,s=this._overlayRef.getConfig();if(n){let u=this._viewportRuler.getViewportScrollPosition();k_(r,this._getExactOverlayY(i,e,u)),k_(r,this._getExactOverlayX(i,e,u))}else r.position="static";let a="",c=this._getOffset(i,"x"),d=this._getOffset(i,"y");c&&(a+=`translateX(${c}px) `),d&&(a+=`translateY(${d}px)`),r.transform=a.trim(),s.maxHeight&&(n?r.maxHeight=os(s.maxHeight):o&&(r.maxHeight="")),s.maxWidth&&(n?r.maxWidth=os(s.maxWidth):o&&(r.maxWidth="")),k_(this._pane.style,r)}_getExactOverlayY(e,i,r){let n={top:"",bottom:""},o=this._getOverlayPoint(i,this._overlayRect,e);if(this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),e.overlayY==="bottom"){let s=this._document.documentElement.clientHeight;n.bottom=`${s-(o.y+this._overlayRect.height)}px`}else n.top=os(o.y);return n}_getExactOverlayX(e,i,r){let n={left:"",right:""},o=this._getOverlayPoint(i,this._overlayRect,e);this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r));let s;if(this._isRtl()?s=e.overlayX==="end"?"left":"right":s=e.overlayX==="end"?"right":"left",s==="right"){let a=this._document.documentElement.clientWidth;n.right=`${a-(o.x+this._overlayRect.width)}px`}else n.left=os(o.x);return n}_getScrollVisibility(){let e=this._getOriginRect(),i=this._pane.getBoundingClientRect(),r=this._scrollables.map(n=>n.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Ehe(e,r),isOriginOutsideView:SU(e,r),isOverlayClipped:Ehe(i,r),isOverlayOutsideView:SU(i,r)}}_subtractOverflows(e,...i){return i.reduce((r,n)=>r-Math.max(n,0),e)}_getNarrowedViewportRect(){let e=this._document.documentElement.clientWidth,i=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+e-this._viewportMargin,bottom:r.top+i-this._viewportMargin,width:e-2*this._viewportMargin,height:i-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,i){return i==="x"?e.offsetX==null?this._offsetX:e.offsetX:e.offsetY==null?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&rx(e).forEach(i=>{i!==""&&this._appliedPanelClasses.indexOf(i)===-1&&(this._appliedPanelClasses.push(i),this._pane.classList.add(i))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){let e=this._origin;if(e instanceof qt)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();let i=e.width||0,r=e.height||0;return{top:e.y,bottom:e.y+r,left:e.x,right:e.x+i,height:r,width:i}}};function k_(t,e){for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function Ahe(t){if(typeof t!="number"&&t!=null){let[e,i]=t.split(nXe);return!i||i==="px"?parseFloat(e):null}return t||null}function Ihe(t){return{top:Math.floor(t.top),right:Math.floor(t.right),bottom:Math.floor(t.bottom),left:Math.floor(t.left),width:Math.floor(t.width),height:Math.floor(t.height)}}function oXe(t,e){return t===e?!0:t.isOriginClipped===e.isOriginClipped&&t.isOriginOutsideView===e.isOriginOutsideView&&t.isOverlayClipped===e.isOverlayClipped&&t.isOverlayOutsideView===e.isOverlayOutsideView}var Dhe="cdk-global-overlay-wrapper",RU=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){let i=e.getConfig();this._overlayRef=e,this._width&&!i.width&&e.updateSize({width:this._width}),this._height&&!i.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(Dhe),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let e=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:n,height:o,maxWidth:s,maxHeight:a}=r,c=(n==="100%"||n==="100vw")&&(!s||s==="100%"||s==="100vw"),d=(o==="100%"||o==="100vh")&&(!a||a==="100%"||a==="100vh"),u=this._xPosition,h=this._xOffset,p=this._overlayRef.getConfig().direction==="rtl",f="",m="",g="";c?g="flex-start":u==="center"?(g="center",p?m=h:f=h):p?u==="left"||u==="end"?(g="flex-end",f=h):(u==="right"||u==="start")&&(g="flex-start",m=h):u==="left"||u==="start"?(g="flex-start",f=h):(u==="right"||u==="end")&&(g="flex-end",m=h),e.position=this._cssPosition,e.marginLeft=c?"0":f,e.marginTop=d?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=c?"0":m,i.justifyContent=g,i.alignItems=d?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let e=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement,r=i.style;i.classList.remove(Dhe),r.justifyContent=r.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}},sXe=(()=>{let e=class e{constructor(r,n,o,s){this._viewportRuler=r,this._document=n,this._platform=o,this._overlayContainer=s}global(){return new RU}flexibleConnectedTo(r){return new DA(r,this._viewportRuler,this._document,this._platform,this._overlayContainer)}};e.\u0275fac=function(n){return new(n||e)(lt(fx),lt(ir),lt(yr),lt(wx))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),aXe=0,$r=(()=>{let e=class e{constructor(r,n,o,s,a,c,d,u,h,p,f,m){this.scrollStrategies=r,this._overlayContainer=n,this._componentFactoryResolver=o,this._positionBuilder=s,this._keyboardDispatcher=a,this._injector=c,this._ngZone=d,this._document=u,this._directionality=h,this._location=p,this._outsideClickDispatcher=f,this._animationsModuleType=m}create(r){let n=this._createHostElement(),o=this._createPaneElement(n),s=this._createPortalOutlet(o),a=new mf(r);return a.direction=a.direction||this._directionality.value,new tm(s,n,o,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(sde))}position(){return this._positionBuilder}_createPaneElement(r){let n=this._document.createElement("div");return n.id=`cdk-overlay-${aXe++}`,n.classList.add("cdk-overlay-pane"),r.appendChild(n),n}_createHostElement(){let r=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(r),r}_createPortalOutlet(r){return this._appRef||(this._appRef=this._injector.get(wW)),new HL(r,this._componentFactoryResolver,this._appRef,this._injector,this._document)}};e.\u0275fac=function(n){return new(n||e)(lt(tXe),lt(wx),lt(XC),lt(sXe),lt(iXe),lt(kn),lt(ni),lt(ir),lt(ss),lt(mL),lt(rXe),lt(rs,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),lXe=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],khe=new St("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let t=Jt($r);return()=>t.scrollStrategies.reposition()}}),MA=(()=>{let e=class e{constructor(r){this.elementRef=r}};e.\u0275fac=function(n){return new(n||e)(Te(qt))},e.\u0275dir=Ot({type:e,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0});let t=e;return t})(),AU=(()=>{let e=class e{get offsetX(){return this._offsetX}set offsetX(r){this._offsetX=r,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(r){this._offsetY=r,this._position&&this._updatePositionStrategy(this._position)}get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(r){this._disposeOnNavigation=r}constructor(r,n,o,s,a){this._overlay=r,this._dir=a,this._backdropSubscription=jn.EMPTY,this._attachSubscription=jn.EMPTY,this._detachSubscription=jn.EMPTY,this._positionSubscription=jn.EMPTY,this._disposeOnNavigation=!1,this._ngZone=Jt(ni),this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.hasBackdrop=!1,this.lockPosition=!1,this.flexibleDimensions=!1,this.growAfterOpen=!1,this.push=!1,this.backdropClick=new Nt,this.positionChange=new Nt,this.attach=new Nt,this.detach=new Nt,this.overlayKeydown=new Nt,this.overlayOutsideClick=new Nt,this._templatePortal=new ov(n,o),this._scrollStrategyFactory=s,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(r){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),r.origin&&this.open&&this._position.apply()),r.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=lXe);let r=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=r.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=r.detachments().subscribe(()=>this.detach.emit()),r.keydownEvents().subscribe(n=>{this.overlayKeydown.next(n),n.keyCode===27&&!this.disableClose&&!jo(n)&&(n.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(n=>{let o=this._getOriginElement(),s=td(n);(!o||o!==s&&!o.contains(s))&&this.overlayOutsideClick.next(n)})}_buildConfig(){let r=this._position=this.positionStrategy||this._createPositionStrategy(),n=new mf({direction:this._dir,positionStrategy:r,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(n.width=this.width),(this.height||this.height===0)&&(n.height=this.height),(this.minWidth||this.minWidth===0)&&(n.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(n.minHeight=this.minHeight),this.backdropClass&&(n.backdropClass=this.backdropClass),this.panelClass&&(n.panelClass=this.panelClass),n}_updatePositionStrategy(r){let n=this.positions.map(o=>({originX:o.originX,originY:o.originY,overlayX:o.overlayX,overlayY:o.overlayY,offsetX:o.offsetX||this.offsetX,offsetY:o.offsetY||this.offsetY,panelClass:o.panelClass||void 0}));return r.setOrigin(this._getOrigin()).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let r=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(r),r}_getOrigin(){return this.origin instanceof MA?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof MA?this.origin.elementRef.nativeElement:this.origin instanceof qt?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(r=>{this.backdropClick.emit(r)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(nde(()=>this.positionChange.observers.length>0)).subscribe(r=>{this._ngZone.run(()=>this.positionChange.emit(r)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}};e.\u0275fac=function(n){return new(n||e)(Te($r),Te(Pl),Te(Qs),Te(khe),Te(ss,8))},e.\u0275dir=Ot({type:e,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[0,"cdkConnectedOverlayOrigin","origin"],positions:[0,"cdkConnectedOverlayPositions","positions"],positionStrategy:[0,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[0,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[0,"cdkConnectedOverlayOffsetY","offsetY"],width:[0,"cdkConnectedOverlayWidth","width"],height:[0,"cdkConnectedOverlayHeight","height"],minWidth:[0,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[0,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[0,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[0,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[0,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[0,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[0,"cdkConnectedOverlayOpen","open"],disableClose:[0,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[0,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[2,"cdkConnectedOverlayHasBackdrop","hasBackdrop",bi],lockPosition:[2,"cdkConnectedOverlayLockPosition","lockPosition",bi],flexibleDimensions:[2,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",bi],growAfterOpen:[2,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",bi],push:[2,"cdkConnectedOverlayPush","push",bi],disposeOnNavigation:[2,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",bi]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[ar,Li]});let t=e;return t})();function cXe(t){return()=>t.scrollStrategies.reposition()}var dXe={provide:khe,deps:[$r],useFactory:cXe},Wd=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({providers:[$r,dXe],imports:[nv,hx,_A,_A]});let t=e;return t})();var uXe=["trigger"],hXe=["panel"],fXe=[[["mat-select-trigger"]],"*"],pXe=["mat-select-trigger","*"];function mXe(t,e){if(t&1&&(ae(0,"span",4),_e(1),ne()),t&2){let i=$t();Ye(),zn(i.placeholder)}}function gXe(t,e){t&1&&Ri(0)}function vXe(t,e){if(t&1&&(ae(0,"span",11),_e(1),ne()),t&2){let i=$t(2);Ye(),zn(i.triggerValue)}}function bXe(t,e){if(t&1&&(ae(0,"span",5),wi(1,gXe,1,0)(2,vXe,2,1,"span",11),ne()),t&2){let i=$t();Ye(),Mr(i.customTrigger?1:2)}}function _Xe(t,e){if(t&1){let i=eo();ae(0,"div",12,1),At("@transformPanel.done",function(n){_i(i);let o=$t();return yi(o._panelDoneAnimatingStream.next(n.toState))})("keydown",function(n){_i(i);let o=$t();return yi(o._handleKeydown(n))}),Ri(2,1),ne()}if(t&2){let i=$t();ude("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",i._getPanelTheme(),""),ht("ngClass",i.panelClass)("@transformPanel","showing"),mi("id",i.id+"-panel")("aria-multiselectable",i.multiple)("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby())}}var yXe={transformPanelWrap:zu("transformPanelWrap",[Ll("* => void",kde("@transformPanel",[Mde()],{optional:!0}))]),transformPanel:zu("transformPanel",[df("void",ns({opacity:0,transform:"scale(1, 0.8)"})),Ll("void => showing",fc("120ms cubic-bezier(0, 0, 0.2, 1)",ns({opacity:1,transform:"scale(1, 1)"}))),Ll("* => void",fc("100ms linear",ns({opacity:0})))])};var Ohe=0,Nhe=new St("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let t=Jt($r);return()=>t.scrollStrategies.reposition()}});function wXe(t){return()=>t.scrollStrategies.reposition()}var CXe=new St("MAT_SELECT_CONFIG"),xXe={provide:Nhe,deps:[$r],useFactory:wXe},SXe=new St("MatSelectTrigger"),IU=class{constructor(e,i){this.source=e,this.value=i}},Phe=(()=>{let e=class e{_scrollOptionIntoView(r){let n=this.options.toArray()[r];if(n){let o=this.panel.nativeElement,s=eU(r,this.options,this.optionGroups),a=n._getHostElement();r===0&&s===1?o.scrollTop=0:o.scrollTop=tU(a.offsetTop,a.offsetHeight,o.scrollTop,o.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(r){return new IU(this,r)}get focused(){return this._focused||this._panelOpen}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(r){this._hideSingleSelectionIndicator=r,this._syncParentProperties()}get placeholder(){return this._placeholder}set placeholder(r){this._placeholder=r,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(lv.required)??!1}set required(r){this._required=r,this.stateChanges.next()}get multiple(){return this._multiple}set multiple(r){this._selectionModel,this._multiple=r}get compareWith(){return this._compareWith}set compareWith(r){this._compareWith=r,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(r){this._assignValue(r)&&this._onChange(r)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(r){this._errorStateTracker.matcher=r}get id(){return this._id}set id(r){this._id=r||this._uid,this.stateChanges.next()}get errorState(){return this._errorStateTracker.errorState}set errorState(r){this._errorStateTracker.errorState=r}constructor(r,n,o,s,a,c,d,u,h,p,f,m,g,y){this._viewportRuler=r,this._changeDetectorRef=n,this._elementRef=a,this._dir=c,this._parentFormField=h,this.ngControl=p,this._liveAnnouncer=g,this._defaultOptions=y,this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._panelOpen=!1,this._compareWith=(w,x)=>w===x,this._uid=`mat-select-${Ohe++}`,this._triggerAriaLabelledBy=null,this._destroy=new Ft,this.stateChanges=new Ft,this.disableAutomaticLabeling=!0,this._onChange=()=>{},this._onTouched=()=>{},this._valueId=`mat-select-value-${Ohe++}`,this._panelDoneAnimatingStream=new Ft,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._multiple=!1,this.disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto",this._initialized=new Ft,this.optionSelectionChanges=YC(()=>{let w=this.options;return w?w.changes.pipe(Fs(w),uc(()=>Ra(...w.map(x=>x.onSelectionChange)))):this._initialized.pipe(uc(()=>this.optionSelectionChanges))}),this.openedChange=new Nt,this._openedStream=this.openedChange.pipe(Ls(w=>w),Gi(()=>{})),this._closedStream=this.openedChange.pipe(Ls(w=>!w),Gi(()=>{})),this.selectionChange=new Nt,this.valueChange=new Nt,this._trackedModal=null,this._skipPredicate=w=>this.panelOpen?!1:w.disabled,this.ngControl&&(this.ngControl.valueAccessor=this),y?.typeaheadDebounceInterval!=null&&(this.typeaheadDebounceInterval=y.typeaheadDebounceInterval),this._errorStateTracker=new x_(s,p,u,d,this.stateChanges),this._scrollStrategyFactory=m,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(f)||0,this.id=this.id}ngOnInit(){this._selectionModel=new T_(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(Kp(),Hr(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen)),this._viewportRuler.change().pipe(Hr(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(Hr(this._destroy)).subscribe(r=>{r.added.forEach(n=>n.select()),r.removed.forEach(n=>n.deselect())}),this.options.changes.pipe(Fs(null),Hr(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){let r=this._getTriggerAriaLabelledby(),n=this.ngControl;if(r!==this._triggerAriaLabelledBy){let o=this._elementRef.nativeElement;this._triggerAriaLabelledBy=r,r?o.setAttribute("aria-labelledby",r):o.removeAttribute("aria-labelledby")}n&&(this._previousControl!==n.control&&(this._previousControl!==void 0&&n.disabled!==null&&n.disabled!==this.disabled&&(this.disabled=n.disabled),this._previousControl=n.control),this.updateErrorState())}ngOnChanges(r){(r.disabled||r.userAriaDescribedBy)&&this.stateChanges.next(),r.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_applyModalPanelOwnership(){let r=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!r)return;let n=`${this.id}-panel`;this._trackedModal&&AL(this._trackedModal,"aria-owns",n),WW(r,"aria-owns",n),this._trackedModal=r}_clearFromModal(){if(!this._trackedModal)return;let r=`${this.id}-panel`;AL(this._trackedModal,"aria-owns",r),this._trackedModal=null}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next())}writeValue(r){this._assignValue(r)}registerOnChange(r){this._onChange=r}registerOnTouched(r){this._onTouched=r}setDisabledState(r){this.disabled=r,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){let r=this._selectionModel.selected.map(n=>n.viewValue);return this._isRtl()&&r.reverse(),r.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return this._dir?this._dir.value==="rtl":!1}_handleKeydown(r){this.disabled||(this.panelOpen?this._handleOpenKeydown(r):this._handleClosedKeydown(r))}_handleClosedKeydown(r){let n=r.keyCode,o=n===40||n===38||n===37||n===39,s=n===13||n===32,a=this._keyManager;if(!a.isTyping()&&s&&!jo(r)||(this.multiple||r.altKey)&&o)r.preventDefault(),this.open();else if(!this.multiple){let c=this.selected;a.onKeydown(r);let d=this.selected;d&&c!==d&&this._liveAnnouncer.announce(d.viewValue,1e4)}}_handleOpenKeydown(r){let n=this._keyManager,o=r.keyCode,s=o===40||o===38,a=n.isTyping();if(s&&r.altKey)r.preventDefault(),this.close();else if(!a&&(o===13||o===32)&&n.activeItem&&!jo(r))r.preventDefault(),n.activeItem._selectViaInteraction();else if(!a&&this._multiple&&o===65&&r.ctrlKey){r.preventDefault();let c=this.options.some(d=>!d.disabled&&!d.selected);this.options.forEach(d=>{d.disabled||(c?d.select():d.deselect())})}else{let c=n.activeItemIndex;n.onKeydown(r),this._multiple&&s&&r.shiftKey&&n.activeItem&&n.activeItemIndex!==c&&n.activeItem._selectViaInteraction()}}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(Vo(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(r){if(this.options.forEach(n=>n.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&r)Array.isArray(r),r.forEach(n=>this._selectOptionByValue(n)),this._sortValues();else{let n=this._selectOptionByValue(r);n?this._keyManager.updateActiveItem(n):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(r){let n=this.options.find(o=>{if(this._selectionModel.isSelected(o))return!1;try{return o.value!=null&&this._compareWith(o.value,r)}catch{return!1}});return n&&this._selectionModel.select(n),n}_assignValue(r){return r!==this._value||this._multiple&&Array.isArray(r)?(this.options&&this._setSelectionByValue(r),this._value=r,!0):!1}_getOverlayWidth(r){return this.panelWidth==="auto"?(r instanceof MA?r.elementRef:r||this._elementRef).nativeElement.getBoundingClientRect().width:this.panelWidth===null?"":this.panelWidth}_syncParentProperties(){if(this.options)for(let r of this.options)r._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new RL(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){let r=Ra(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Hr(r)).subscribe(n=>{this._onSelect(n.source,n.isUserInput),n.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Ra(...this.options.map(n=>n._stateChanges)).pipe(Hr(r)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(r,n){let o=this._selectionModel.isSelected(r);r.value==null&&!this._multiple?(r.deselect(),this._selectionModel.clear(),this.value!=null&&this._propagateChanges(r.value)):(o!==r.selected&&(r.selected?this._selectionModel.select(r):this._selectionModel.deselect(r)),n&&this._keyManager.setActiveItem(r),this.multiple&&(this._sortValues(),n&&this.focus())),o!==this._selectionModel.isSelected(r)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){let r=this.options.toArray();this._selectionModel.sort((n,o)=>this.sortComparator?this.sortComparator(n,o,r):r.indexOf(n)-r.indexOf(o)),this.stateChanges.next()}}_propagateChanges(r){let n;this.multiple?n=this.selected.map(o=>o.value):n=this.selected?this.selected.value:r,this._value=n,this.valueChange.emit(n),this._onChange(n),this.selectionChange.emit(this._getChangeEvent(n)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let r=-1;for(let n=0;n<this.options.length;n++)if(!this.options.get(n).disabled){r=n;break}this._keyManager.setActiveItem(r)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(r){this._elementRef.nativeElement.focus(r)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;let r=this._parentFormField?.getLabelId(),n=r?r+" ":"";return this.ariaLabelledby?n+this.ariaLabelledby:r}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let r=this._parentFormField?.getLabelId(),n=(r?r+" ":"")+this._valueId;return this.ariaLabelledby&&(n+=" "+this.ariaLabelledby),n}_panelDoneAnimating(r){this.openedChange.emit(r)}setDescribedByIds(r){r.length?this._elementRef.nativeElement.setAttribute("aria-describedby",r.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}};e.\u0275fac=function(n){return new(n||e)(Te(fx),Te(Xi),Te(ni),Te(mA),Te(qt),Te(ss,8),Te(I_,8),Te(RA,8),Te(M_,8),Te(zd,10),Jc("tabindex"),Te(Nhe),Te(IL),Te(CXe,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-select"]],contentQueries:function(n,o,s){if(n&1&&(ws(s,SXe,5),ws(s,gA,5),ws(s,LL,5)),n&2){let a;ai(a=li())&&(o.customTrigger=a.first),ai(a=li())&&(o.options=a),ai(a=li())&&(o.optionGroups=a)}},viewQuery:function(n,o){if(n&1&&(Ii(uXe,5),Ii(hXe,5),Ii(AU,5)),n&2){let s;ai(s=li())&&(o.trigger=s.first),ai(s=li())&&(o.panel=s.first),ai(s=li())&&(o._overlayDir=s.first)}},hostAttrs:["role","combobox","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(n,o){n&1&&At("keydown",function(a){return o._handleKeydown(a)})("focus",function(){return o._onFocus()})("blur",function(){return o._onBlur()}),n&2&&(mi("id",o.id)("tabindex",o.disabled?-1:o.tabIndex)("aria-controls",o.panelOpen?o.id+"-panel":null)("aria-expanded",o.panelOpen)("aria-label",o.ariaLabel||null)("aria-required",o.required.toString())("aria-disabled",o.disabled.toString())("aria-invalid",o.errorState)("aria-activedescendant",o._getAriaActiveDescendant()),hi("mat-mdc-select-disabled",o.disabled)("mat-mdc-select-invalid",o.errorState)("mat-mdc-select-required",o.required)("mat-mdc-select-empty",o.empty)("mat-mdc-select-multiple",o.multiple))},inputs:{userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[2,"disabled","disabled",bi],disableRipple:[2,"disableRipple","disableRipple",bi],tabIndex:[2,"tabIndex","tabIndex",r=>r==null?0:Ia(r)],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",bi],placeholder:"placeholder",required:[2,"required","required",bi],multiple:[2,"multiple","multiple",bi],disableOptionCentering:[2,"disableOptionCentering","disableOptionCentering",bi],compareWith:"compareWith",value:"value",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[2,"typeaheadDebounceInterval","typeaheadDebounceInterval",Ia],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],standalone:!0,features:[zi([{provide:yx,useExisting:e},{provide:PL,useExisting:e}]),ar,Li,zt],ngContentSelectors:pXe,decls:11,vars:8,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","attach","detach","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(n,o){if(n&1){let s=eo();Br(fXe),ae(0,"div",2,0),At("click",function(){return _i(s),yi(o.open())}),ae(3,"div",3),wi(4,mXe,2,1,"span",4)(5,bXe,3,1,"span",5),ne(),ae(6,"div",6)(7,"div",7),cf(),ae(8,"svg",8),bt(9,"path",9),ne()()()(),wi(10,_Xe,3,9,"ng-template",10),At("backdropClick",function(){return _i(s),yi(o.close())})("attach",function(){return _i(s),yi(o._onAttached())})("detach",function(){return _i(s),yi(o.close())})}if(n&2){let s=Js(1);Ye(3),mi("id",o._valueId),Ye(),Mr(o.empty?4:5),Ye(6),ht("cdkConnectedOverlayPanelClass",o._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",o._scrollStrategy)("cdkConnectedOverlayOrigin",o._preferredOverlayOrigin||s)("cdkConnectedOverlayOpen",o.panelOpen)("cdkConnectedOverlayPositions",o._positions)("cdkConnectedOverlayWidth",o._overlayWidth)}},dependencies:[MA,AU,JC],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color, var(--mat-app-on-surface));font-family:var(--mat-select-trigger-text-font, var(--mat-app-body-large-font));line-height:var(--mat-select-trigger-text-line-height, var(--mat-app-body-large-line-height));font-size:var(--mat-select-trigger-text-size, var(--mat-app-body-large-size));font-weight:var(--mat-select-trigger-text-weight, var(--mat-app-body-large-weight));letter-spacing:var(--mat-select-trigger-text-tracking, var(--mat-app-body-large-tracking))}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow)}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color)}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color, var(--mat-app-error))}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color, var(--mat-app-on-surface-variant))}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color, var(--mat-app-primary))}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color)}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color, var(--mat-app-surface-container))}.cdk-high-contrast-active div.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color, var(--mat-app-on-surface-variant))}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform)}'],encapsulation:2,data:{animation:[yXe.transformPanel]},changeDetection:0});let t=e;return t})();var DU=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({providers:[xXe],imports:[Wn,Wd,dx,oi,Vd,hv,dx,oi]});let t=e;return t})();var TXe=new St("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{let t=Jt($r);return()=>t.scrollStrategies.reposition()}});function RXe(t){return()=>t.scrollStrategies.reposition()}var AXe={provide:TXe,deps:[$r],useFactory:RXe};var Lhe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({providers:[AXe],imports:[Wd,dx,oi,Wn,Vd,dx,oi]});let t=e;return t})();function NA(t){return t+.5|0}var fv=(t,e,i)=>Math.max(Math.min(t,i),e);function kA(t){return fv(NA(t*2.55),0,255)}function pv(t){return fv(NA(t*255),0,255)}function im(t){return fv(NA(t/2.55)/100,0,1)}function Fhe(t){return fv(NA(t*100),0,100)}var Ud={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},kU=[..."0123456789ABCDEF"],IXe=t=>kU[t&15],DXe=t=>kU[(t&240)>>4]+kU[t&15],iF=t=>(t&240)>>4===(t&15),MXe=t=>iF(t.r)&&iF(t.g)&&iF(t.b)&&iF(t.a);function kXe(t){var e=t.length,i;return t[0]==="#"&&(e===4||e===5?i={r:255&Ud[t[1]]*17,g:255&Ud[t[2]]*17,b:255&Ud[t[3]]*17,a:e===5?Ud[t[4]]*17:255}:(e===7||e===9)&&(i={r:Ud[t[1]]<<4|Ud[t[2]],g:Ud[t[3]]<<4|Ud[t[4]],b:Ud[t[5]]<<4|Ud[t[6]],a:e===9?Ud[t[7]]<<4|Ud[t[8]]:255})),i}var OXe=(t,e)=>t<255?e(t):"";function NXe(t){var e=MXe(t)?IXe:DXe;return t?"#"+e(t.r)+e(t.g)+e(t.b)+OXe(t.a,e):void 0}var PXe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function jhe(t,e,i){let r=e*Math.min(i,1-i),n=(o,s=(o+t/30)%12)=>i-r*Math.max(Math.min(s-3,9-s,1),-1);return[n(0),n(8),n(4)]}function LXe(t,e,i){let r=(n,o=(n+t/60)%6)=>i-i*e*Math.max(Math.min(o,4-o,1),0);return[r(5),r(3),r(1)]}function FXe(t,e,i){let r=jhe(t,1,.5),n;for(e+i>1&&(n=1/(e+i),e*=n,i*=n),n=0;n<3;n++)r[n]*=1-e-i,r[n]+=e;return r}function HXe(t,e,i,r,n){return t===n?(e-i)/r+(e<i?6:0):e===n?(i-t)/r+2:(t-e)/r+4}function OU(t){let i=t.r/255,r=t.g/255,n=t.b/255,o=Math.max(i,r,n),s=Math.min(i,r,n),a=(o+s)/2,c,d,u;return o!==s&&(u=o-s,d=a>.5?u/(2-o-s):u/(o+s),c=HXe(i,r,n,u,o),c=c*60+.5),[c|0,d||0,a]}function NU(t,e,i,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,r)).map(pv)}function PU(t,e,i){return NU(jhe,t,e,i)}function BXe(t,e,i){return NU(FXe,t,e,i)}function VXe(t,e,i){return NU(LXe,t,e,i)}function zhe(t){return(t%360+360)%360}function jXe(t){let e=PXe.exec(t),i=255,r;if(!e)return;e[5]!==r&&(i=e[6]?kA(+e[5]):pv(+e[5]));let n=zhe(+e[2]),o=+e[3]/100,s=+e[4]/100;return e[1]==="hwb"?r=BXe(n,o,s):e[1]==="hsv"?r=VXe(n,o,s):r=PU(n,o,s),{r:r[0],g:r[1],b:r[2],a:i}}function zXe(t,e){var i=OU(t);i[0]=zhe(i[0]+e),i=PU(i),t.r=i[0],t.g=i[1],t.b=i[2]}function WXe(t){if(!t)return;let e=OU(t),i=e[0],r=Fhe(e[1]),n=Fhe(e[2]);return t.a<255?`hsla(${i}, ${r}%, ${n}%, ${im(t.a)})`:`hsl(${i}, ${r}%, ${n}%)`}var Hhe={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Bhe={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function UXe(){let t={},e=Object.keys(Bhe),i=Object.keys(Hhe),r,n,o,s,a;for(r=0;r<e.length;r++){for(s=a=e[r],n=0;n<i.length;n++)o=i[n],a=a.replace(o,Hhe[o]);o=parseInt(Bhe[s],16),t[a]=[o>>16&255,o>>8&255,o&255]}return t}var rF;function qXe(t){rF||(rF=UXe(),rF.transparent=[0,0,0,0]);let e=rF[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}var YXe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function $Xe(t){let e=YXe.exec(t),i=255,r,n,o;if(e){if(e[7]!==r){let s=+e[7];i=e[8]?kA(s):fv(s*255,0,255)}return r=+e[1],n=+e[3],o=+e[5],r=255&(e[2]?kA(r):fv(r,0,255)),n=255&(e[4]?kA(n):fv(n,0,255)),o=255&(e[6]?kA(o):fv(o,0,255)),{r,g:n,b:o,a:i}}}function GXe(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${im(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}var MU=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Cx=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function XXe(t,e,i){let r=Cx(im(t.r)),n=Cx(im(t.g)),o=Cx(im(t.b));return{r:pv(MU(r+i*(Cx(im(e.r))-r))),g:pv(MU(n+i*(Cx(im(e.g))-n))),b:pv(MU(o+i*(Cx(im(e.b))-o))),a:t.a+i*(e.a-t.a)}}function nF(t,e,i){if(t){let r=OU(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*i,e===0?360:1)),r=PU(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function Whe(t,e){return t&&Object.assign(e||{},t)}function Vhe(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=pv(t[3]))):(e=Whe(t,{r:0,g:0,b:0,a:1}),e.a=pv(e.a)),e}function KXe(t){return t.charAt(0)==="r"?$Xe(t):jXe(t)}var OA=class t{constructor(e){if(e instanceof t)return e;let i=typeof e,r;i==="object"?r=Vhe(e):i==="string"&&(r=kXe(e)||qXe(e)||KXe(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=Whe(this._rgb);return e&&(e.a=im(e.a)),e}set rgb(e){this._rgb=Vhe(e)}rgbString(){return this._valid?GXe(this._rgb):void 0}hexString(){return this._valid?NXe(this._rgb):void 0}hslString(){return this._valid?WXe(this._rgb):void 0}mix(e,i){if(e){let r=this.rgb,n=e.rgb,o,s=i===o?.5:i,a=2*s-1,c=r.a-n.a,d=((a*c===-1?a:(a+c)/(1+a*c))+1)/2;o=1-d,r.r=255&d*r.r+o*n.r+.5,r.g=255&d*r.g+o*n.g+.5,r.b=255&d*r.b+o*n.b+.5,r.a=s*r.a+(1-s)*n.a,this.rgb=r}return this}interpolate(e,i){return e&&(this._rgb=XXe(this._rgb,e._rgb,i)),this}clone(){return new t(this.rgb)}alpha(e){return this._rgb.a=pv(e),this}clearer(e){let i=this._rgb;return i.a*=1-e,this}greyscale(){let e=this._rgb,i=NA(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=i,this}opaquer(e){let i=this._rgb;return i.a*=1+e,this}negate(){let e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return nF(this._rgb,2,e),this}darken(e){return nF(this._rgb,2,-e),this}saturate(e){return nF(this._rgb,1,e),this}desaturate(e){return nF(this._rgb,1,-e),this}rotate(e){return zXe(this._rgb,e),this}};function _f(){}var efe=(()=>{let t=0;return()=>t++})();function kr(t){return t===null||typeof t>"u"}function Un(t){if(Array.isArray&&Array.isArray(t))return!0;let e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function wr(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Ro(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function gc(t,e){return Ro(t)?t:e}function Ki(t,e){return typeof t>"u"?e:t}var tfe=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,BU=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function On(t,e,i){if(t&&typeof t.call=="function")return t.apply(i,e)}function an(t,e,i,r){let n,o,s;if(Un(t))if(o=t.length,r)for(n=o-1;n>=0;n--)e.call(i,t[n],n);else for(n=0;n<o;n++)e.call(i,t[n],n);else if(wr(t))for(s=Object.keys(t),o=s.length,n=0;n<o;n++)e.call(i,t[s[n]],s[n])}function FA(t,e){let i,r,n,o;if(!t||!e||t.length!==e.length)return!1;for(i=0,r=t.length;i<r;++i)if(n=t[i],o=e[i],n.datasetIndex!==o.datasetIndex||n.index!==o.index)return!1;return!0}function lF(t){if(Un(t))return t.map(lF);if(wr(t)){let e=Object.create(null),i=Object.keys(t),r=i.length,n=0;for(;n<r;++n)e[i[n]]=lF(t[i[n]]);return e}return t}function ife(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function ZXe(t,e,i,r){if(!ife(t))return;let n=e[t],o=i[t];wr(n)&&wr(o)?Sx(n,o,r):e[t]=lF(o)}function Sx(t,e,i){let r=Un(e)?e:[e],n=r.length;if(!wr(t))return t;i=i||{};let o=i.merger||ZXe,s;for(let a=0;a<n;++a){if(s=r[a],!wr(s))continue;let c=Object.keys(s);for(let d=0,u=c.length;d<u;++d)o(c[d],t,s,i)}return t}function Tx(t,e){return Sx(t,e,{merger:QXe})}function QXe(t,e,i){if(!ife(t))return;let r=e[t],n=i[t];wr(r)&&wr(n)?Tx(r,n):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=lF(n))}var Uhe={"":t=>t,x:t=>t.x,y:t=>t.y};function JXe(t){let e=t.split("."),i=[],r="";for(let n of e)r+=n,r.endsWith("\\")?r=r.slice(0,-1)+".":(i.push(r),r="");return i}function eKe(t){let e=JXe(t);return i=>{for(let r of e){if(r==="")break;i=i&&i[r]}return i}}function om(t,e){return(Uhe[e]||(Uhe[e]=eKe(e)))(t)}function hF(t){return t.charAt(0).toUpperCase()+t.slice(1)}var Rx=t=>typeof t<"u",rm=t=>typeof t=="function",VU=(t,e)=>{if(t.size!==e.size)return!1;for(let i of t)if(!e.has(i))return!1;return!0};function rfe(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}var qn=Math.PI,Yn=2*qn,tKe=Yn+qn,cF=Number.POSITIVE_INFINITY,iKe=qn/180,zo=qn/2,O_=qn/4,qhe=qn*2/3,nm=Math.log10,Yu=Math.sign;function Ax(t,e,i){return Math.abs(t-e)<i}function jU(t){let e=Math.round(t);t=Ax(t,e,t/1e3)?e:t;let i=Math.pow(10,Math.floor(nm(t))),r=t/i;return(r<=1?1:r<=2?2:r<=5?5:10)*i}function nfe(t){let e=[],i=Math.sqrt(t),r;for(r=1;r<i;r++)t%r===0&&(e.push(r),e.push(t/r));return i===(i|0)&&e.push(i),e.sort((n,o)=>n-o).pop(),e}function L_(t){return!isNaN(parseFloat(t))&&isFinite(t)}function ofe(t,e){let i=Math.round(t);return i-e<=t&&i+e>=t}function zU(t,e,i){let r,n,o;for(r=0,n=t.length;r<n;r++)o=t[r][i],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function qd(t){return t*(qn/180)}function fF(t){return t*(180/qn)}function WU(t){if(!Ro(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function UU(t,e){let i=e.x-t.x,r=e.y-t.y,n=Math.sqrt(i*i+r*r),o=Math.atan2(r,i);return o<-.5*qn&&(o+=Yn),{angle:o,distance:n}}function dF(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function rKe(t,e){return(t-e+tKe)%Yn-qn}function mc(t){return(t%Yn+Yn)%Yn}function Ix(t,e,i,r){let n=mc(t),o=mc(e),s=mc(i),a=mc(o-n),c=mc(s-n),d=mc(n-o),u=mc(n-s);return n===o||n===s||r&&o===s||a>c&&d<u}function Hs(t,e,i){return Math.max(e,Math.min(i,t))}function sfe(t){return Hs(t,-32768,32767)}function yf(t,e,i,r=1e-6){return t>=Math.min(e,i)-r&&t<=Math.max(e,i)+r}function pF(t,e,i){i=i||(s=>t[s]<e);let r=t.length-1,n=0,o;for(;r-n>1;)o=n+r>>1,i(o)?n=o:r=o;return{lo:n,hi:r}}var vf=(t,e,i,r)=>pF(t,i,r?n=>{let o=t[n][e];return o<i||o===i&&t[n+1][e]===i}:n=>t[n][e]<i),afe=(t,e,i)=>pF(t,i,r=>t[r][e]>=i);function lfe(t,e,i){let r=0,n=t.length;for(;r<n&&t[r]<e;)r++;for(;n>r&&t[n-1]>i;)n--;return r>0||n<t.length?t.slice(r,n):t}var cfe=["push","pop","shift","splice","unshift"];function dfe(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),cfe.forEach(i=>{let r="_onData"+hF(i),n=t[i];Object.defineProperty(t,i,{configurable:!0,enumerable:!1,value(...o){let s=n.apply(this,o);return t._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...o)}),s}})})}function qU(t,e){let i=t._chartjs;if(!i)return;let r=i.listeners,n=r.indexOf(e);n!==-1&&r.splice(n,1),!(r.length>0)&&(cfe.forEach(o=>{delete t[o]}),delete t._chartjs)}function YU(t){let e=new Set(t);return e.size===t.length?t:Array.from(e)}var $U=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function GU(t,e){let i=[],r=!1;return function(...n){i=n,r||(r=!0,$U.call(window,()=>{r=!1,t.apply(e,i)}))}}function ufe(t,e){let i;return function(...r){return e?(clearTimeout(i),i=setTimeout(t,e,r)):t.apply(this,r),e}}var mF=t=>t==="start"?"left":t==="end"?"right":"center",Da=(t,e,i)=>t==="start"?e:t==="end"?i:(e+i)/2,hfe=(t,e,i,r)=>t===(r?"left":"right")?i:t==="center"?(e+i)/2:e;function XU(t,e,i){let r=e.length,n=0,o=r;if(t._sorted){let{iScale:s,_parsed:a}=t,c=s.axis,{min:d,max:u,minDefined:h,maxDefined:p}=s.getUserBounds();h&&(n=Hs(Math.min(vf(a,c,d).lo,i?r:vf(e,c,s.getPixelForValue(d)).lo),0,r-1)),p?o=Hs(Math.max(vf(a,s.axis,u,!0).hi+1,i?0:vf(e,c,s.getPixelForValue(u),!0).hi+1),n,r)-n:o=r-n}return{start:n,count:o}}function KU(t){let{xScale:e,yScale:i,_scaleRanges:r}=t,n={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!r)return t._scaleRanges=n,!0;let o=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==i.min||r.ymax!==i.max;return Object.assign(r,n),o}var oF=t=>t===0||t===1,Yhe=(t,e,i)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Yn/i)),$he=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*Yn/i)+1,xx={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*zo)+1,easeOutSine:t=>Math.sin(t*zo),easeInOutSine:t=>-.5*(Math.cos(qn*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>oF(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>oF(t)?t:Yhe(t,.075,.3),easeOutElastic:t=>oF(t)?t:$he(t,.075,.3),easeInOutElastic(t){return oF(t)?t:t<.5?.5*Yhe(t*2,.1125,.45):.5+.5*$he(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-xx.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?xx.easeInBounce(t*2)*.5:xx.easeOutBounce(t*2-1)*.5+.5};function ZU(t){if(t&&typeof t=="object"){let e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function QU(t){return ZU(t)?t:new OA(t)}function LU(t){return ZU(t)?t:new OA(t).saturate(.5).darken(.1).hexString()}var nKe=["x","y","borderWidth","radius","tension"],oKe=["color","borderColor","backgroundColor"];function sKe(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:oKe},numbers:{type:"number",properties:nKe}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function aKe(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}var Ghe=new Map;function lKe(t,e){e=e||{};let i=t+JSON.stringify(e),r=Ghe.get(i);return r||(r=new Intl.NumberFormat(t,e),Ghe.set(i,r)),r}function Dx(t,e,i){return lKe(e,i).format(t)}var ffe={values(t){return Un(t)?t:""+t},numeric(t,e,i){if(t===0)return"0";let r=this.chart.options.locale,n,o=t;if(i.length>1){let d=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(d<1e-4||d>1e15)&&(n="scientific"),o=cKe(t,i)}let s=nm(Math.abs(o)),a=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),c={notation:n,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),Dx(t,r,c)},logarithmic(t,e,i){if(t===0)return"0";let r=i[e].significand||t/Math.pow(10,Math.floor(nm(t)));return[1,2,3,5,10,15].includes(r)||e>.8*i.length?ffe.numeric.call(this,t,e,i):""}};function cKe(t,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(i)>=1&&t!==Math.floor(t)&&(i=t-Math.floor(t)),i}var HA={formatters:ffe};function dKe(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,i)=>i.lineWidth,tickColor:(e,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:HA.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}var gv=Object.create(null),gF=Object.create(null);function PA(t,e){if(!e)return t;let i=e.split(".");for(let r=0,n=i.length;r<n;++r){let o=i[r];t=t[o]||(t[o]=Object.create(null))}return t}function FU(t,e,i){return typeof e=="string"?Sx(PA(t,e),i):Sx(PA(t,""),e)}var HU=class{constructor(e,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,n)=>LU(n.backgroundColor),this.hoverBorderColor=(r,n)=>LU(n.borderColor),this.hoverColor=(r,n)=>LU(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(i)}set(e,i){return FU(this,e,i)}get(e){return PA(this,e)}describe(e,i){return FU(gF,e,i)}override(e,i){return FU(gv,e,i)}route(e,i,r,n){let o=PA(this,e),s=PA(this,r),a="_"+i;Object.defineProperties(o,{[a]:{value:o[i],writable:!0},[i]:{enumerable:!0,get(){let c=this[a],d=s[n];return wr(c)?Object.assign({},d,c):Ki(c,d)},set(c){this[a]=c}}})}apply(e){e.forEach(i=>i(this))}},to=new HU({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[sKe,aKe,dKe]);function uKe(t){return!t||kr(t.size)||kr(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function LA(t,e,i,r,n){let o=e[n];return o||(o=e[n]=t.measureText(n).width,i.push(n)),o>r&&(r=o),r}function pfe(t,e,i,r){r=r||{};let n=r.data=r.data||{},o=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(n=r.data={},o=r.garbageCollect=[],r.font=e),t.save(),t.font=e;let s=0,a=i.length,c,d,u,h,p;for(c=0;c<a;c++)if(h=i[c],h!=null&&!Un(h))s=LA(t,n,o,s,h);else if(Un(h))for(d=0,u=h.length;d<u;d++)p=h[d],p!=null&&!Un(p)&&(s=LA(t,n,o,s,p));t.restore();let f=o.length/2;if(f>i.length){for(c=0;c<f;c++)delete n[o[c]];o.splice(0,f)}return s}function vv(t,e,i){let r=t.currentDevicePixelRatio,n=i!==0?Math.max(i/2,.5):0;return Math.round((e-n)*r)/r+n}function JU(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function vF(t,e,i,r){eq(t,e,i,r,null)}function eq(t,e,i,r,n){let o,s,a,c,d,u,h,p,f=e.pointStyle,m=e.rotation,g=e.radius,y=(m||0)*iKe;if(f&&typeof f=="object"&&(o=f.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){t.save(),t.translate(i,r),t.rotate(y),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!(isNaN(g)||g<=0)){switch(t.beginPath(),f){default:n?t.ellipse(i,r,n/2,g,0,0,Yn):t.arc(i,r,g,0,Yn),t.closePath();break;case"triangle":u=n?n/2:g,t.moveTo(i+Math.sin(y)*u,r-Math.cos(y)*g),y+=qhe,t.lineTo(i+Math.sin(y)*u,r-Math.cos(y)*g),y+=qhe,t.lineTo(i+Math.sin(y)*u,r-Math.cos(y)*g),t.closePath();break;case"rectRounded":d=g*.516,c=g-d,s=Math.cos(y+O_)*c,h=Math.cos(y+O_)*(n?n/2-d:c),a=Math.sin(y+O_)*c,p=Math.sin(y+O_)*(n?n/2-d:c),t.arc(i-h,r-a,d,y-qn,y-zo),t.arc(i+p,r-s,d,y-zo,y),t.arc(i+h,r+a,d,y,y+zo),t.arc(i-p,r+s,d,y+zo,y+qn),t.closePath();break;case"rect":if(!m){c=Math.SQRT1_2*g,u=n?n/2:c,t.rect(i-u,r-c,2*u,2*c);break}y+=O_;case"rectRot":h=Math.cos(y)*(n?n/2:g),s=Math.cos(y)*g,a=Math.sin(y)*g,p=Math.sin(y)*(n?n/2:g),t.moveTo(i-h,r-a),t.lineTo(i+p,r-s),t.lineTo(i+h,r+a),t.lineTo(i-p,r+s),t.closePath();break;case"crossRot":y+=O_;case"cross":h=Math.cos(y)*(n?n/2:g),s=Math.cos(y)*g,a=Math.sin(y)*g,p=Math.sin(y)*(n?n/2:g),t.moveTo(i-h,r-a),t.lineTo(i+h,r+a),t.moveTo(i+p,r-s),t.lineTo(i-p,r+s);break;case"star":h=Math.cos(y)*(n?n/2:g),s=Math.cos(y)*g,a=Math.sin(y)*g,p=Math.sin(y)*(n?n/2:g),t.moveTo(i-h,r-a),t.lineTo(i+h,r+a),t.moveTo(i+p,r-s),t.lineTo(i-p,r+s),y+=O_,h=Math.cos(y)*(n?n/2:g),s=Math.cos(y)*g,a=Math.sin(y)*g,p=Math.sin(y)*(n?n/2:g),t.moveTo(i-h,r-a),t.lineTo(i+h,r+a),t.moveTo(i+p,r-s),t.lineTo(i-p,r+s);break;case"line":s=n?n/2:Math.cos(y)*g,a=Math.sin(y)*g,t.moveTo(i-s,r-a),t.lineTo(i+s,r+a);break;case"dash":t.moveTo(i,r),t.lineTo(i+Math.cos(y)*(n?n/2:g),r+Math.sin(y)*g);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function bf(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function BA(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function VA(t){t.restore()}function mfe(t,e,i,r,n){if(!e)return t.lineTo(i.x,i.y);if(n==="middle"){let o=(e.x+i.x)/2;t.lineTo(o,e.y),t.lineTo(o,i.y)}else n==="after"!=!!r?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}function gfe(t,e,i,r){if(!e)return t.lineTo(i.x,i.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?i.cp2x:i.cp1x,r?i.cp2y:i.cp1y,i.x,i.y)}function hKe(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),kr(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function fKe(t,e,i,r,n){if(n.strikethrough||n.underline){let o=t.measureText(r),s=e-o.actualBoundingBoxLeft,a=e+o.actualBoundingBoxRight,c=i-o.actualBoundingBoxAscent,d=i+o.actualBoundingBoxDescent,u=n.strikethrough?(c+d)/2:d;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=n.decorationWidth||2,t.moveTo(s,u),t.lineTo(a,u),t.stroke()}}function pKe(t,e){let i=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=i}function bv(t,e,i,r,n,o={}){let s=Un(e)?e:[e],a=o.strokeWidth>0&&o.strokeColor!=="",c,d;for(t.save(),t.font=n.string,hKe(t,o),c=0;c<s.length;++c)d=s[c],o.backdrop&&pKe(t,o.backdrop),a&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),kr(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(d,i,r,o.maxWidth)),t.fillText(d,i,r,o.maxWidth),fKe(t,i,r,d,o),r+=Number(n.lineHeight);t.restore()}function Mx(t,e){let{x:i,y:r,w:n,h:o,radius:s}=e;t.arc(i+s.topLeft,r+s.topLeft,s.topLeft,1.5*qn,qn,!0),t.lineTo(i,r+o-s.bottomLeft),t.arc(i+s.bottomLeft,r+o-s.bottomLeft,s.bottomLeft,qn,zo,!0),t.lineTo(i+n-s.bottomRight,r+o),t.arc(i+n-s.bottomRight,r+o-s.bottomRight,s.bottomRight,zo,0,!0),t.lineTo(i+n,r+s.topRight),t.arc(i+n-s.topRight,r+s.topRight,s.topRight,0,-zo,!0),t.lineTo(i+s.topLeft,r)}var mKe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,gKe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function vKe(t,e){let i=(""+t).match(mKe);if(!i||i[1]==="normal")return e*1.2;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100;break}return e*t}var bKe=t=>+t||0;function bF(t,e){let i={},r=wr(e),n=r?Object.keys(e):e,o=wr(t)?r?s=>Ki(t[s],t[e[s]]):s=>t[s]:()=>t;for(let s of n)i[s]=bKe(o(s));return i}function tq(t){return bF(t,{top:"y",right:"x",bottom:"y",left:"x"})}function _v(t){return bF(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Ma(t){let e=tq(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Cs(t,e){t=t||{},e=e||to.font;let i=Ki(t.size,e.size);typeof i=="string"&&(i=parseInt(i,10));let r=Ki(t.style,e.style);r&&!(""+r).match(gKe)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);let n={family:Ki(t.family,e.family),lineHeight:vKe(Ki(t.lineHeight,e.lineHeight),i),size:i,style:r,weight:Ki(t.weight,e.weight),string:""};return n.string=uKe(n),n}function kx(t,e,i,r){let n=!0,o,s,a;for(o=0,s=t.length;o<s;++o)if(a=t[o],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e),n=!1),i!==void 0&&Un(a)&&(a=a[i%a.length],n=!1),a!==void 0))return r&&!n&&(r.cacheable=!1),a}function vfe(t,e,i){let{min:r,max:n}=t,o=BU(e,(n-r)/2),s=(a,c)=>i&&a===0?0:a+c;return{min:s(r,-Math.abs(o)),max:s(n,o)}}function sm(t,e){return Object.assign(Object.create(t),e)}function _F(t,e=[""],i,r,n=()=>t[0]){let o=i||t;typeof r>"u"&&(r=yfe("_fallback",t));let s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:o,_fallback:r,_getTarget:n,override:a=>_F([a,...t],e,o,r)};return new Proxy(s,{deleteProperty(a,c){return delete a[c],delete a._keys,delete t[0][c],!0},get(a,c){return bfe(a,c,()=>TKe(c,e,t,a))},getOwnPropertyDescriptor(a,c){return Reflect.getOwnPropertyDescriptor(a._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,c){return Khe(a).includes(c)},ownKeys(a){return Khe(a)},set(a,c,d){let u=a._storage||(a._storage=n());return a[c]=u[c]=d,delete a._keys,!0}})}function P_(t,e,i,r){let n={_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:iq(t,r),setContext:o=>P_(t,o,i,r),override:o=>P_(t.override(o),e,i,r)};return new Proxy(n,{deleteProperty(o,s){return delete o[s],delete t[s],!0},get(o,s,a){return bfe(o,s,()=>yKe(o,s,a))},getOwnPropertyDescriptor(o,s){return o._descriptors.allKeys?Reflect.has(t,s)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,s)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(o,s){return Reflect.has(t,s)},ownKeys(){return Reflect.ownKeys(t)},set(o,s,a){return t[s]=a,delete o[s],!0}})}function iq(t,e={scriptable:!0,indexable:!0}){let{_scriptable:i=e.scriptable,_indexable:r=e.indexable,_allKeys:n=e.allKeys}=t;return{allKeys:n,scriptable:i,indexable:r,isScriptable:rm(i)?i:()=>i,isIndexable:rm(r)?r:()=>r}}var _Ke=(t,e)=>t?t+hF(e):e,rq=(t,e)=>wr(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function bfe(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];let r=i();return t[e]=r,r}function yKe(t,e,i){let{_proxy:r,_context:n,_subProxy:o,_descriptors:s}=t,a=r[e];return rm(a)&&s.isScriptable(e)&&(a=wKe(e,a,t,i)),Un(a)&&a.length&&(a=CKe(e,a,t,s.isIndexable)),rq(e,a)&&(a=P_(a,n,o&&o[e],s)),a}function wKe(t,e,i,r){let{_proxy:n,_context:o,_subProxy:s,_stack:a}=i;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let c=e(o,s||r);return a.delete(t),rq(t,c)&&(c=nq(n._scopes,n,t,c)),c}function CKe(t,e,i,r){let{_proxy:n,_context:o,_subProxy:s,_descriptors:a}=i;if(typeof o.index<"u"&&r(t))return e[o.index%e.length];if(wr(e[0])){let c=e,d=n._scopes.filter(u=>u!==c);e=[];for(let u of c){let h=nq(d,n,t,u);e.push(P_(h,o,s&&s[t],a))}}return e}function _fe(t,e,i){return rm(t)?t(e,i):t}var xKe=(t,e)=>t===!0?e:typeof t=="string"?om(e,t):void 0;function SKe(t,e,i,r,n){for(let o of e){let s=xKe(i,o);if(s){t.add(s);let a=_fe(s._fallback,i,n);if(typeof a<"u"&&a!==i&&a!==r)return a}else if(s===!1&&typeof r<"u"&&i!==r)return null}return!1}function nq(t,e,i,r){let n=e._rootScopes,o=_fe(e._fallback,i,r),s=[...t,...n],a=new Set;a.add(r);let c=Xhe(a,s,i,o||i,r);return c===null||typeof o<"u"&&o!==i&&(c=Xhe(a,s,o,c,r),c===null)?!1:_F(Array.from(a),[""],n,o,()=>EKe(e,i,r))}function Xhe(t,e,i,r,n){for(;i;)i=SKe(t,e,i,r,n);return i}function EKe(t,e,i){let r=t._getTarget();e in r||(r[e]={});let n=r[e];return Un(n)&&wr(i)?i:n||{}}function TKe(t,e,i,r){let n;for(let o of e)if(n=yfe(_Ke(o,t),i),typeof n<"u")return rq(t,n)?nq(i,r,t,n):n}function yfe(t,e){for(let i of e){if(!i)continue;let r=i[t];if(typeof r<"u")return r}}function Khe(t){let e=t._keys;return e||(e=t._keys=RKe(t._scopes)),e}function RKe(t){let e=new Set;for(let i of t)for(let r of Object.keys(i).filter(n=>!n.startsWith("_")))e.add(r);return Array.from(e)}function oq(t,e,i,r){let{iScale:n}=t,{key:o="r"}=this._parsing,s=new Array(r),a,c,d,u;for(a=0,c=r;a<c;++a)d=a+i,u=e[d],s[a]={r:n.parse(om(u,o),d)};return s}var AKe=Number.EPSILON||1e-14,Ex=(t,e)=>e<t.length&&!t[e].skip&&t[e],wfe=t=>t==="x"?"y":"x";function IKe(t,e,i,r){let n=t.skip?e:t,o=e,s=i.skip?e:i,a=dF(o,n),c=dF(s,o),d=a/(a+c),u=c/(a+c);d=isNaN(d)?0:d,u=isNaN(u)?0:u;let h=r*d,p=r*u;return{previous:{x:o.x-h*(s.x-n.x),y:o.y-h*(s.y-n.y)},next:{x:o.x+p*(s.x-n.x),y:o.y+p*(s.y-n.y)}}}function DKe(t,e,i){let r=t.length,n,o,s,a,c,d=Ex(t,0);for(let u=0;u<r-1;++u)if(c=d,d=Ex(t,u+1),!(!c||!d)){if(Ax(e[u],0,AKe)){i[u]=i[u+1]=0;continue}n=i[u]/e[u],o=i[u+1]/e[u],a=Math.pow(n,2)+Math.pow(o,2),!(a<=9)&&(s=3/Math.sqrt(a),i[u]=n*s*e[u],i[u+1]=o*s*e[u])}}function MKe(t,e,i="x"){let r=wfe(i),n=t.length,o,s,a,c=Ex(t,0);for(let d=0;d<n;++d){if(s=a,a=c,c=Ex(t,d+1),!a)continue;let u=a[i],h=a[r];s&&(o=(u-s[i])/3,a[`cp1${i}`]=u-o,a[`cp1${r}`]=h-o*e[d]),c&&(o=(c[i]-u)/3,a[`cp2${i}`]=u+o,a[`cp2${r}`]=h+o*e[d])}}function kKe(t,e="x"){let i=wfe(e),r=t.length,n=Array(r).fill(0),o=Array(r),s,a,c,d=Ex(t,0);for(s=0;s<r;++s)if(a=c,c=d,d=Ex(t,s+1),!!c){if(d){let u=d[e]-c[e];n[s]=u!==0?(d[i]-c[i])/u:0}o[s]=a?d?Yu(n[s-1])!==Yu(n[s])?0:(n[s-1]+n[s])/2:n[s-1]:n[s]}DKe(t,n,o),MKe(t,o,e)}function sF(t,e,i){return Math.max(Math.min(t,i),e)}function OKe(t,e){let i,r,n,o,s,a=bf(t[0],e);for(i=0,r=t.length;i<r;++i)s=o,o=a,a=i<r-1&&bf(t[i+1],e),o&&(n=t[i],s&&(n.cp1x=sF(n.cp1x,e.left,e.right),n.cp1y=sF(n.cp1y,e.top,e.bottom)),a&&(n.cp2x=sF(n.cp2x,e.left,e.right),n.cp2y=sF(n.cp2y,e.top,e.bottom)))}function Cfe(t,e,i,r,n){let o,s,a,c;if(e.spanGaps&&(t=t.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")kKe(t,n);else{let d=r?t[t.length-1]:t[0];for(o=0,s=t.length;o<s;++o)a=t[o],c=IKe(d,a,t[Math.min(o+1,s-(r?0:1))%s],e.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,d=a}e.capBezierPoints&&OKe(t,i)}function yF(){return typeof window<"u"&&typeof document<"u"}function wF(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function uF(t,e,i){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[i])):r=t,r}var CF=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function NKe(t,e){return CF(t).getPropertyValue(e)}var PKe=["top","right","bottom","left"];function N_(t,e,i){let r={};i=i?"-"+i:"";for(let n=0;n<4;n++){let o=PKe[n];r[o]=parseFloat(t[e+"-"+o+i])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}var LKe=(t,e,i)=>(t>0||e>0)&&(!i||!i.shadowRoot);function FKe(t,e){let i=t.touches,r=i&&i.length?i[0]:t,{offsetX:n,offsetY:o}=r,s=!1,a,c;if(LKe(n,o,t.target))a=n,c=o;else{let d=e.getBoundingClientRect();a=r.clientX-d.left,c=r.clientY-d.top,s=!0}return{x:a,y:c,box:s}}function yv(t,e){if("native"in t)return t;let{canvas:i,currentDevicePixelRatio:r}=e,n=CF(i),o=n.boxSizing==="border-box",s=N_(n,"padding"),a=N_(n,"border","width"),{x:c,y:d,box:u}=FKe(t,i),h=s.left+(u&&a.left),p=s.top+(u&&a.top),{width:f,height:m}=e;return o&&(f-=s.width+a.width,m-=s.height+a.height),{x:Math.round((c-h)/f*i.width/r),y:Math.round((d-p)/m*i.height/r)}}function HKe(t,e,i){let r,n;if(e===void 0||i===void 0){let o=t&&wF(t);if(!o)e=t.clientWidth,i=t.clientHeight;else{let s=o.getBoundingClientRect(),a=CF(o),c=N_(a,"border","width"),d=N_(a,"padding");e=s.width-d.width-c.width,i=s.height-d.height-c.height,r=uF(a.maxWidth,o,"clientWidth"),n=uF(a.maxHeight,o,"clientHeight")}}return{width:e,height:i,maxWidth:r||cF,maxHeight:n||cF}}var aF=t=>Math.round(t*10)/10;function xfe(t,e,i,r){let n=CF(t),o=N_(n,"margin"),s=uF(n.maxWidth,t,"clientWidth")||cF,a=uF(n.maxHeight,t,"clientHeight")||cF,c=HKe(t,e,i),{width:d,height:u}=c;if(n.boxSizing==="content-box"){let p=N_(n,"border","width"),f=N_(n,"padding");d-=f.width+p.width,u-=f.height+p.height}return d=Math.max(0,d-o.width),u=Math.max(0,r?d/r:u-o.height),d=aF(Math.min(d,s,c.maxWidth)),u=aF(Math.min(u,a,c.maxHeight)),d&&!u&&(u=aF(d/2)),(e!==void 0||i!==void 0)&&r&&c.height&&u>c.height&&(u=c.height,d=aF(Math.floor(u*r))),{width:d,height:u}}function sq(t,e,i){let r=e||1,n=Math.floor(t.height*r),o=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);let s=t.canvas;return s.style&&(i||!s.style.height&&!s.style.width)&&(s.style.height=`${t.height}px`,s.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||s.height!==n||s.width!==o?(t.currentDevicePixelRatio=r,s.height=n,s.width=o,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}var Sfe=function(){let t=!1;try{let e={get passive(){return t=!0,!1}};yF()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function aq(t,e){let i=NKe(t,e),r=i&&i.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function mv(t,e,i,r){return{x:t.x+i*(e.x-t.x),y:t.y+i*(e.y-t.y)}}function Efe(t,e,i,r){return{x:t.x+i*(e.x-t.x),y:r==="middle"?i<.5?t.y:e.y:r==="after"?i<1?t.y:e.y:i>0?e.y:t.y}}function Tfe(t,e,i,r){let n={x:t.cp2x,y:t.cp2y},o={x:e.cp1x,y:e.cp1y},s=mv(t,n,i),a=mv(n,o,i),c=mv(o,e,i),d=mv(s,a,i),u=mv(a,c,i);return mv(d,u,i)}var BKe=function(t,e){return{x(i){return t+t+e-i},setWidth(i){e=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,r){return i-r},leftForLtr(i,r){return i-r}}},VKe=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function F_(t,e,i){return t?BKe(e,i):VKe()}function lq(t,e){let i,r;(e==="ltr"||e==="rtl")&&(i=t.canvas.style,r=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=r)}function cq(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Rfe(t){return t==="angle"?{between:Ix,compare:rKe,normalize:mc}:{between:yf,compare:(e,i)=>e-i,normalize:e=>e}}function Zhe({start:t,end:e,count:i,loop:r,style:n}){return{start:t%i,end:e%i,loop:r&&(e-t+1)%i===0,style:n}}function jKe(t,e,i){let{property:r,start:n,end:o}=i,{between:s,normalize:a}=Rfe(r),c=e.length,{start:d,end:u,loop:h}=t,p,f;if(h){for(d+=c,u+=c,p=0,f=c;p<f&&s(a(e[d%c][r]),n,o);++p)d--,u--;d%=c,u%=c}return u<d&&(u+=c),{start:d,end:u,loop:h,style:t.style}}function dq(t,e,i){if(!i)return[t];let{property:r,start:n,end:o}=i,s=e.length,{compare:a,between:c,normalize:d}=Rfe(r),{start:u,end:h,loop:p,style:f}=jKe(t,e,i),m=[],g=!1,y=null,w,x,T,M=()=>c(n,T,w)&&a(n,T)!==0,B=()=>a(o,w)===0||c(o,T,w),G=()=>g||M(),F=()=>!g||B();for(let O=u,V=u;O<=h;++O)x=e[O%s],!x.skip&&(w=d(x[r]),w!==T&&(g=c(w,n,o),y===null&&G()&&(y=a(w,n)===0?O:V),y!==null&&F()&&(m.push(Zhe({start:y,end:O,loop:p,count:s,style:f})),y=null),V=O,T=w));return y!==null&&m.push(Zhe({start:y,end:h,loop:p,count:s,style:f})),m}function uq(t,e){let i=[],r=t.segments;for(let n=0;n<r.length;n++){let o=dq(r[n],t.points,e);o.length&&i.push(...o)}return i}function zKe(t,e,i,r){let n=0,o=e-1;if(i&&!r)for(;n<e&&!t[n].skip;)n++;for(;n<e&&t[n].skip;)n++;for(n%=e,i&&(o+=n);o>n&&t[o%e].skip;)o--;return o%=e,{start:n,end:o}}function WKe(t,e,i,r){let n=t.length,o=[],s=e,a=t[e],c;for(c=e+1;c<=i;++c){let d=t[c%n];d.skip||d.stop?a.skip||(r=!1,o.push({start:e%n,end:(c-1)%n,loop:r}),e=s=d.stop?c:null):(s=c,a.skip&&(e=c)),a=d}return s!==null&&o.push({start:e%n,end:s%n,loop:r}),o}function Afe(t,e){let i=t.points,r=t.options.spanGaps,n=i.length;if(!n)return[];let o=!!t._loop,{start:s,end:a}=zKe(i,n,o,r);if(r===!0)return Qhe(t,[{start:s,end:a,loop:o}],i,e);let c=a<s?a+n:a,d=!!t._fullLoop&&s===0&&a===n-1;return Qhe(t,WKe(i,s,c,d),i,e)}function Qhe(t,e,i,r){return!r||!r.setContext||!i?e:UKe(t,e,i,r)}function UKe(t,e,i,r){let n=t._chart.getContext(),o=Jhe(t.options),{_datasetIndex:s,options:{spanGaps:a}}=t,c=i.length,d=[],u=o,h=e[0].start,p=h;function f(m,g,y,w){let x=a?-1:1;if(m!==g){for(m+=c;i[m%c].skip;)m-=x;for(;i[g%c].skip;)g+=x;m%c!==g%c&&(d.push({start:m%c,end:g%c,loop:y,style:w}),u=w,h=g%c)}}for(let m of e){h=a?h:m.start;let g=i[h%c],y;for(p=h+1;p<=m.end;p++){let w=i[p%c];y=Jhe(r.setContext(sm(n,{type:"segment",p0:g,p1:w,p0DataIndex:(p-1)%c,p1DataIndex:p%c,datasetIndex:s}))),qKe(y,u)&&f(h,p-1,m.loop,u),g=w,u=y}h<p-1&&f(h,p-1,m.loop,u)}return d}function Jhe(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function qKe(t,e){if(!e)return!1;let i=[],r=function(n,o){return ZU(o)?(i.includes(o)||i.push(o),i.indexOf(o)):o};return JSON.stringify(t,r)!==JSON.stringify(e,r)}var wq=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,i,r,n){let o=i.listeners[n],s=i.duration;o.forEach(a=>a({chart:e,initial:i.initial,numSteps:s,currentStep:Math.min(r-i.start,s)}))}_refresh(){this._request||(this._running=!0,this._request=$U.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let i=0;this._charts.forEach((r,n)=>{if(!r.running||!r.items.length)return;let o=r.items,s=o.length-1,a=!1,c;for(;s>=0;--s)c=o[s],c._active?(c._total>r.duration&&(r.duration=c._total),c.tick(e),a=!0):(o[s]=o[o.length-1],o.pop());a&&(n.draw(),this._notify(n,r,e,"progress")),o.length||(r.running=!1,this._notify(n,r,e,"complete"),r.initial=!1),i+=o.length}),this._lastDate=e,i===0&&(this._running=!1)}_getAnims(e){let i=this._charts,r=i.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(e,r)),r}listen(e,i,r){this._getAnims(e).listeners[i].push(r)}add(e,i){!i||!i.length||this._getAnims(e).items.push(...i)}has(e){return this._getAnims(e).items.length>0}start(e){let i=this._charts.get(e);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((r,n)=>Math.max(r,n._duration),0),this._refresh())}running(e){if(!this._running)return!1;let i=this._charts.get(e);return!(!i||!i.running||!i.items.length)}stop(e){let i=this._charts.get(e);if(!i||!i.items.length)return;let r=i.items,n=r.length-1;for(;n>=0;--n)r[n].cancel();i.items=[],this._notify(e,i,Date.now(),"complete")}remove(e){return this._charts.delete(e)}},am=new wq,Ife="transparent",YKe={boolean(t,e,i){return i>.5?e:t},color(t,e,i){let r=QU(t||Ife),n=r.valid&&QU(e||Ife);return n&&n.valid?n.mix(r,i).hexString():e},number(t,e,i){return t+(e-t)*i}},Cq=class{constructor(e,i,r,n){let o=i[r];n=kx([e.to,n,o,e.from]);let s=kx([e.from,o,n]);this._active=!0,this._fn=e.fn||YKe[e.type||typeof s],this._easing=xx[e.easing]||xx.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=i,this._prop=r,this._from=s,this._to=n,this._promises=void 0}active(){return this._active}update(e,i,r){if(this._active){this._notify(!1);let n=this._target[this._prop],o=r-this._start,s=this._duration-o;this._start=r,this._duration=Math.floor(Math.max(s,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=kx([e.to,i,n,e.from]),this._from=kx([e.from,n,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){let i=e-this._start,r=this._duration,n=this._prop,o=this._from,s=this._loop,a=this._to,c;if(this._active=o!==a&&(s||i<r),!this._active){this._target[n]=a,this._notify(!0);return}if(i<0){this._target[n]=o;return}c=i/r%2,c=s&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[n]=this._fn(o,a,c)}wait(){let e=this._promises||(this._promises=[]);return new Promise((i,r)=>{e.push({res:i,rej:r})})}_notify(e){let i=e?"res":"rej",r=this._promises||[];for(let n=0;n<r.length;n++)r[n][i]()}},kF=class{constructor(e,i){this._chart=e,this._properties=new Map,this.configure(i)}configure(e){if(!wr(e))return;let i=Object.keys(to.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(n=>{let o=e[n];if(!wr(o))return;let s={};for(let a of i)s[a]=o[a];(Un(o.properties)&&o.properties||[n]).forEach(a=>{(a===n||!r.has(a))&&r.set(a,s)})})}_animateOptions(e,i){let r=i.options,n=GKe(e,r);if(!n)return[];let o=this._createAnimations(n,r);return r.$shared&&$Ke(e.options.$animations,r).then(()=>{e.options=r},()=>{}),o}_createAnimations(e,i){let r=this._properties,n=[],o=e.$animations||(e.$animations={}),s=Object.keys(i),a=Date.now(),c;for(c=s.length-1;c>=0;--c){let d=s[c];if(d.charAt(0)==="$")continue;if(d==="options"){n.push(...this._animateOptions(e,i));continue}let u=i[d],h=o[d],p=r.get(d);if(h)if(p&&h.active()){h.update(p,u,a);continue}else h.cancel();if(!p||!p.duration){e[d]=u;continue}o[d]=h=new Cq(p,e,d,u),n.push(h)}return n}update(e,i){if(this._properties.size===0){Object.assign(e,i);return}let r=this._createAnimations(e,i);if(r.length)return am.add(this._chart,r),!0}};function $Ke(t,e){let i=[],r=Object.keys(e);for(let n=0;n<r.length;n++){let o=t[r[n]];o&&o.active()&&i.push(o.wait())}return Promise.all(i)}function GKe(t,e){if(!e)return;let i=t.options;if(!i){t.options=e;return}return i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function Dfe(t,e){let i=t&&t.options||{},r=i.reverse,n=i.min===void 0?e:0,o=i.max===void 0?e:0;return{start:r?o:n,end:r?n:o}}function XKe(t,e,i){if(i===!1)return!1;let r=Dfe(t,i),n=Dfe(e,i);return{top:n.end,right:r.end,bottom:n.start,left:r.start}}function KKe(t){let e,i,r,n;return wr(t)?(e=t.top,i=t.right,r=t.bottom,n=t.left):e=i=r=n=t,{top:e,right:i,bottom:r,left:n,disabled:t===!1}}function Dpe(t,e){let i=[],r=t._getSortedDatasetMetas(e),n,o;for(n=0,o=r.length;n<o;++n)i.push(r[n].index);return i}function Mfe(t,e,i,r={}){let n=t.keys,o=r.mode==="single",s,a,c,d;if(e!==null){for(s=0,a=n.length;s<a;++s){if(c=+n[s],c===i){if(r.all)continue;break}d=t.values[c],Ro(d)&&(o||e===0||Yu(e)===Yu(d))&&(e+=d)}return e}}function ZKe(t,e){let{iScale:i,vScale:r}=e,n=i.axis==="x"?"x":"y",o=r.axis==="x"?"x":"y",s=Object.keys(t),a=new Array(s.length),c,d,u;for(c=0,d=s.length;c<d;++c)u=s[c],a[c]={[n]:u,[o]:t[u]};return a}function kfe(t,e){let i=t&&t.options.stacked;return i||i===void 0&&e.stack!==void 0}function QKe(t,e,i){return`${t.id}.${e.id}.${i.stack||i.type}`}function JKe(t){let{min:e,max:i,minDefined:r,maxDefined:n}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:n?i:Number.POSITIVE_INFINITY}}function eZe(t,e,i){let r=t[e]||(t[e]={});return r[i]||(r[i]={})}function Ofe(t,e,i,r){for(let n of e.getMatchingVisibleMetas(r).reverse()){let o=t[n.index];if(i&&o>0||!i&&o<0)return n.index}return null}function Nfe(t,e){let{chart:i,_cachedMeta:r}=t,n=i._stacks||(i._stacks={}),{iScale:o,vScale:s,index:a}=r,c=o.axis,d=s.axis,u=QKe(o,s,r),h=e.length,p;for(let f=0;f<h;++f){let m=e[f],{[c]:g,[d]:y}=m,w=m._stacks||(m._stacks={});p=w[d]=eZe(n,u,g),p[a]=y,p._top=Ofe(p,s,!0,r.type),p._bottom=Ofe(p,s,!1,r.type);let x=p._visualValues||(p._visualValues={});x[a]=y}}function hq(t,e){let i=t.scales;return Object.keys(i).filter(r=>i[r].axis===e).shift()}function tZe(t,e){return sm(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function iZe(t,e,i){return sm(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}function jA(t,e){let i=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(let n of e){let o=n._stacks;if(!o||o[r]===void 0||o[r][i]===void 0)return;delete o[r][i],o[r]._visualValues!==void 0&&o[r]._visualValues[i]!==void 0&&delete o[r]._visualValues[i]}}}var fq=t=>t==="reset"||t==="none",Pfe=(t,e)=>e?t:Object.assign({},t),rZe=(t,e,i)=>t&&!e.hidden&&e._stacked&&{keys:Dpe(i,!0),values:null},Cv=(()=>{class t{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(i,r){this.chart=i,this._ctx=i.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){let i=this._cachedMeta;this.configure(),this.linkScales(),i._stacked=kfe(i.vScale,i),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(i){this.index!==i&&jA(this._cachedMeta),this.index=i}linkScales(){let i=this.chart,r=this._cachedMeta,n=this.getDataset(),o=(p,f,m,g)=>p==="x"?f:p==="r"?g:m,s=r.xAxisID=Ki(n.xAxisID,hq(i,"x")),a=r.yAxisID=Ki(n.yAxisID,hq(i,"y")),c=r.rAxisID=Ki(n.rAxisID,hq(i,"r")),d=r.indexAxis,u=r.iAxisID=o(d,s,a,c),h=r.vAxisID=o(d,a,s,c);r.xScale=this.getScaleForId(s),r.yScale=this.getScaleForId(a),r.rScale=this.getScaleForId(c),r.iScale=this.getScaleForId(u),r.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(i){return this.chart.scales[i]}_getOtherScale(i){let r=this._cachedMeta;return i===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){let i=this._cachedMeta;this._data&&qU(this._data,this),i._stacked&&jA(i)}_dataCheck(){let i=this.getDataset(),r=i.data||(i.data=[]),n=this._data;if(wr(r)){let o=this._cachedMeta;this._data=ZKe(r,o)}else if(n!==r){if(n){qU(n,this);let o=this._cachedMeta;jA(o),o._parsed=[]}r&&Object.isExtensible(r)&&dfe(r,this),this._syncList=[],this._data=r}}addElements(){let i=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(i.dataset=new this.datasetElementType)}buildOrUpdateElements(i){let r=this._cachedMeta,n=this.getDataset(),o=!1;this._dataCheck();let s=r._stacked;r._stacked=kfe(r.vScale,r),r.stack!==n.stack&&(o=!0,jA(r),r.stack=n.stack),this._resyncElements(i),(o||s!==r._stacked)&&Nfe(this,r._parsed)}configure(){let i=this.chart.config,r=i.datasetScopeKeys(this._type),n=i.getOptionScopes(this.getDataset(),r,!0);this.options=i.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(i,r){let{_cachedMeta:n,_data:o}=this,{iScale:s,_stacked:a}=n,c=s.axis,d=i===0&&r===o.length?!0:n._sorted,u=i>0&&n._parsed[i-1],h,p,f;if(this._parsing===!1)n._parsed=o,n._sorted=!0,f=o;else{Un(o[i])?f=this.parseArrayData(n,o,i,r):wr(o[i])?f=this.parseObjectData(n,o,i,r):f=this.parsePrimitiveData(n,o,i,r);let m=()=>p[c]===null||u&&p[c]<u[c];for(h=0;h<r;++h)n._parsed[h+i]=p=f[h],d&&(m()&&(d=!1),u=p);n._sorted=d}a&&Nfe(this,f)}parsePrimitiveData(i,r,n,o){let{iScale:s,vScale:a}=i,c=s.axis,d=a.axis,u=s.getLabels(),h=s===a,p=new Array(o),f,m,g;for(f=0,m=o;f<m;++f)g=f+n,p[f]={[c]:h||s.parse(u[g],g),[d]:a.parse(r[g],g)};return p}parseArrayData(i,r,n,o){let{xScale:s,yScale:a}=i,c=new Array(o),d,u,h,p;for(d=0,u=o;d<u;++d)h=d+n,p=r[h],c[d]={x:s.parse(p[0],h),y:a.parse(p[1],h)};return c}parseObjectData(i,r,n,o){let{xScale:s,yScale:a}=i,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,u=new Array(o),h,p,f,m;for(h=0,p=o;h<p;++h)f=h+n,m=r[f],u[h]={x:s.parse(om(m,c),f),y:a.parse(om(m,d),f)};return u}getParsed(i){return this._cachedMeta._parsed[i]}getDataElement(i){return this._cachedMeta.data[i]}applyStack(i,r,n){let o=this.chart,s=this._cachedMeta,a=r[i.axis],c={keys:Dpe(o,!0),values:r._stacks[i.axis]._visualValues};return Mfe(c,a,s.index,{mode:n})}updateRangeFromParsed(i,r,n,o){let s=n[r.axis],a=s===null?NaN:s,c=o&&n._stacks[r.axis];o&&c&&(o.values=c,a=Mfe(o,s,this._cachedMeta.index)),i.min=Math.min(i.min,a),i.max=Math.max(i.max,a)}getMinMax(i,r){let n=this._cachedMeta,o=n._parsed,s=n._sorted&&i===n.iScale,a=o.length,c=this._getOtherScale(i),d=rZe(r,n,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:p}=JKe(c),f,m;function g(){m=o[f];let y=m[c.axis];return!Ro(m[i.axis])||h>y||p<y}for(f=0;f<a&&!(!g()&&(this.updateRangeFromParsed(u,i,m,d),s));++f);if(s){for(f=a-1;f>=0;--f)if(!g()){this.updateRangeFromParsed(u,i,m,d);break}}return u}getAllParsedValues(i){let r=this._cachedMeta._parsed,n=[],o,s,a;for(o=0,s=r.length;o<s;++o)a=r[o][i.axis],Ro(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(i){let r=this._cachedMeta,n=r.iScale,o=r.vScale,s=this.getParsed(i);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:o?""+o.getLabelForValue(s[o.axis]):""}}_update(i){let r=this._cachedMeta;this.update(i||"default"),r._clip=KKe(Ki(this.options.clip,XKe(r.xScale,r.yScale,this.getMaxOverflow())))}update(i){}draw(){let i=this._ctx,r=this.chart,n=this._cachedMeta,o=n.data||[],s=r.chartArea,a=[],c=this._drawStart||0,d=this._drawCount||o.length-c,u=this.options.drawActiveElementsOnTop,h;for(n.dataset&&n.dataset.draw(i,s,c,d),h=c;h<c+d;++h){let p=o[h];p.hidden||(p.active&&u?a.push(p):p.draw(i,s))}for(h=0;h<a.length;++h)a[h].draw(i,s)}getStyle(i,r){let n=r?"active":"default";return i===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(i||0,n)}getContext(i,r,n){let o=this.getDataset(),s;if(i>=0&&i<this._cachedMeta.data.length){let a=this._cachedMeta.data[i];s=a.$context||(a.$context=iZe(this.getContext(),i,a)),s.parsed=this.getParsed(i),s.raw=o.data[i],s.index=s.dataIndex=i}else s=this.$context||(this.$context=tZe(this.chart.getContext(),this.index)),s.dataset=o,s.index=s.datasetIndex=this.index;return s.active=!!r,s.mode=n,s}resolveDatasetElementOptions(i){return this._resolveElementOptions(this.datasetElementType.id,i)}resolveDataElementOptions(i,r){return this._resolveElementOptions(this.dataElementType.id,r,i)}_resolveElementOptions(i,r="default",n){let o=r==="active",s=this._cachedDataOpts,a=i+"-"+r,c=s[a],d=this.enableOptionSharing&&Rx(n);if(c)return Pfe(c,d);let u=this.chart.config,h=u.datasetElementScopeKeys(this._type,i),p=o?[`${i}Hover`,"hover",i,""]:[i,""],f=u.getOptionScopes(this.getDataset(),h),m=Object.keys(to.elements[i]),g=()=>this.getContext(n,o,r),y=u.resolveNamedOptions(f,m,g,p);return y.$shared&&(y.$shared=d,s[a]=Object.freeze(Pfe(y,d))),y}_resolveAnimations(i,r,n){let o=this.chart,s=this._cachedDataOpts,a=`animation-${r}`,c=s[a];if(c)return c;let d;if(o.options.animation!==!1){let h=this.chart.config,p=h.datasetAnimationScopeKeys(this._type,r),f=h.getOptionScopes(this.getDataset(),p);d=h.createResolver(f,this.getContext(i,n,r))}let u=new kF(o,d&&d.animations);return d&&d._cacheable&&(s[a]=Object.freeze(u)),u}getSharedOptions(i){if(i.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},i))}includeOptions(i,r){return!r||fq(i)||this.chart._animationsDisabled}_getSharedOptions(i,r){let n=this.resolveDataElementOptions(i,r),o=this._sharedOptions,s=this.getSharedOptions(n),a=this.includeOptions(r,s)||s!==o;return this.updateSharedOptions(s,r,n),{sharedOptions:s,includeOptions:a}}updateElement(i,r,n,o){fq(o)?Object.assign(i,n):this._resolveAnimations(r,o).update(i,n)}updateSharedOptions(i,r,n){i&&!fq(r)&&this._resolveAnimations(void 0,r).update(i,n)}_setStyle(i,r,n,o){i.active=o;let s=this.getStyle(r,o);this._resolveAnimations(r,n,o).update(i,{options:!o&&this.getSharedOptions(s)||s})}removeHoverStyle(i,r,n){this._setStyle(i,n,"active",!1)}setHoverStyle(i,r,n){this._setStyle(i,n,"active",!0)}_removeDatasetHoverStyle(){let i=this._cachedMeta.dataset;i&&this._setStyle(i,void 0,"active",!1)}_setDatasetHoverStyle(){let i=this._cachedMeta.dataset;i&&this._setStyle(i,void 0,"active",!0)}_resyncElements(i){let r=this._data,n=this._cachedMeta.data;for(let[c,d,u]of this._syncList)this[c](d,u);this._syncList=[];let o=n.length,s=r.length,a=Math.min(s,o);a&&this.parse(0,a),s>o?this._insertElements(o,s-o,i):s<o&&this._removeElements(s,o-s)}_insertElements(i,r,n=!0){let o=this._cachedMeta,s=o.data,a=i+r,c,d=u=>{for(u.length+=r,c=u.length-1;c>=a;c--)u[c]=u[c-r]};for(d(s),c=i;c<a;++c)s[c]=new this.dataElementType;this._parsing&&d(o._parsed),this.parse(i,r),n&&this.updateElements(s,i,r,"reset")}updateElements(i,r,n,o){}_removeElements(i,r){let n=this._cachedMeta;if(this._parsing){let o=n._parsed.splice(i,r);n._stacked&&jA(n,o)}n.data.splice(i,r)}_sync(i){if(this._parsing)this._syncList.push(i);else{let[r,n,o]=i;this[r](n,o)}this.chart._dataChanges.push([this.index,...i])}_onDataPush(){let i=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-i,i])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(i,r){r&&this._sync(["_removeElements",i,r]);let n=arguments.length-2;n&&this._sync(["_insertElements",i,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return t})();function nZe(t,e){if(!t._cache.$bar){let i=t.getMatchingVisibleMetas(e),r=[];for(let n=0,o=i.length;n<o;n++)r=r.concat(i[n].controller.getAllParsedValues(t));t._cache.$bar=YU(r.sort((n,o)=>n-o))}return t._cache.$bar}function oZe(t){let e=t.iScale,i=nZe(e,t.type),r=e._length,n,o,s,a,c=()=>{s===32767||s===-32768||(Rx(a)&&(r=Math.min(r,Math.abs(s-a)||r)),a=s)};for(n=0,o=i.length;n<o;++n)s=e.getPixelForValue(i[n]),c();for(a=void 0,n=0,o=e.ticks.length;n<o;++n)s=e.getPixelForTick(n),c();return r}function sZe(t,e,i,r){let n=i.barThickness,o,s;return kr(n)?(o=e.min*i.categoryPercentage,s=i.barPercentage):(o=n*r,s=1),{chunk:o/r,ratio:s,start:e.pixels[t]-o/2}}function aZe(t,e,i,r){let n=e.pixels,o=n[t],s=t>0?n[t-1]:null,a=t<n.length-1?n[t+1]:null,c=i.categoryPercentage;s===null&&(s=o-(a===null?e.end-e.start:a-o)),a===null&&(a=o+o-s);let d=o-(o-Math.min(s,a))/2*c;return{chunk:Math.abs(a-s)/2*c/r,ratio:i.barPercentage,start:d}}function lZe(t,e,i,r){let n=i.parse(t[0],r),o=i.parse(t[1],r),s=Math.min(n,o),a=Math.max(n,o),c=s,d=a;Math.abs(s)>Math.abs(a)&&(c=a,d=s),e[i.axis]=d,e._custom={barStart:c,barEnd:d,start:n,end:o,min:s,max:a}}function Mpe(t,e,i,r){return Un(t)?lZe(t,e,i,r):e[i.axis]=i.parse(t,r),e}function Lfe(t,e,i,r){let n=t.iScale,o=t.vScale,s=n.getLabels(),a=n===o,c=[],d,u,h,p;for(d=i,u=i+r;d<u;++d)p=e[d],h={},h[n.axis]=a||n.parse(s[d],d),c.push(Mpe(p,h,o,d));return c}function pq(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function cZe(t,e,i){return t!==0?Yu(t):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}function dZe(t){let e,i,r,n,o;return t.horizontal?(e=t.base>t.x,i="left",r="right"):(e=t.base<t.y,i="bottom",r="top"),e?(n="end",o="start"):(n="start",o="end"),{start:i,end:r,reverse:e,top:n,bottom:o}}function uZe(t,e,i,r){let n=e.borderSkipped,o={};if(!n){t.borderSkipped=o;return}if(n===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:s,end:a,reverse:c,top:d,bottom:u}=dZe(t);n==="middle"&&i&&(t.enableBorderRadius=!0,(i._top||0)===r?n=d:(i._bottom||0)===r?n=u:(o[Ffe(u,s,a,c)]=!0,n=d)),o[Ffe(n,s,a,c)]=!0,t.borderSkipped=o}function Ffe(t,e,i,r){return r?(t=hZe(t,e,i),t=Hfe(t,i,e)):t=Hfe(t,e,i),t}function hZe(t,e,i){return t===e?i:t===i?e:t}function Hfe(t,e,i){return t==="start"?e:t==="end"?i:t}function fZe(t,{inflateAmount:e},i){t.inflateAmount=e==="auto"?i===1?.33:0:e}var pZe=(()=>{class t extends Cv{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(i,r,n,o){return Lfe(i,r,n,o)}parseArrayData(i,r,n,o){return Lfe(i,r,n,o)}parseObjectData(i,r,n,o){let{iScale:s,vScale:a}=i,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,u=s.axis==="x"?c:d,h=a.axis==="x"?c:d,p=[],f,m,g,y;for(f=n,m=n+o;f<m;++f)y=r[f],g={},g[s.axis]=s.parse(om(y,u),f),p.push(Mpe(om(y,h),g,a,f));return p}updateRangeFromParsed(i,r,n,o){super.updateRangeFromParsed(i,r,n,o);let s=n._custom;s&&r===this._cachedMeta.vScale&&(i.min=Math.min(i.min,s.min),i.max=Math.max(i.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(i){let r=this._cachedMeta,{iScale:n,vScale:o}=r,s=this.getParsed(i),a=s._custom,c=pq(a)?"["+a.start+", "+a.end+"]":""+o.getLabelForValue(s[o.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();let i=this._cachedMeta;i.stack=this.getDataset().stack}update(i){let r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,i)}updateElements(i,r,n,o){let s=o==="reset",{index:a,_cachedMeta:{vScale:c}}=this,d=c.getBasePixel(),u=c.isHorizontal(),h=this._getRuler(),{sharedOptions:p,includeOptions:f}=this._getSharedOptions(r,o);for(let m=r;m<r+n;m++){let g=this.getParsed(m),y=s||kr(g[c.axis])?{base:d,head:d}:this._calculateBarValuePixels(m),w=this._calculateBarIndexPixels(m,h),x=(g._stacks||{})[c.axis],T={horizontal:u,base:y.base,enableBorderRadius:!x||pq(g._custom)||a===x._top||a===x._bottom,x:u?y.head:w.center,y:u?w.center:y.head,height:u?w.size:Math.abs(y.size),width:u?Math.abs(y.size):w.size};f&&(T.options=p||this.resolveDataElementOptions(m,i[m].active?"active":o));let M=T.options||i[m].options;uZe(T,M,x,a),fZe(T,M,h.ratio),this.updateElement(i[m],m,T,o)}}_getStacks(i,r){let{iScale:n}=this._cachedMeta,o=n.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),s=n.options.stacked,a=[],c=d=>{let u=d.controller.getParsed(r),h=u&&u[d.vScale.axis];if(kr(h)||isNaN(h))return!0};for(let d of o)if(!(r!==void 0&&c(d))&&((s===!1||a.indexOf(d.stack)===-1||s===void 0&&d.stack===void 0)&&a.push(d.stack),d.index===i))break;return a.length||a.push(void 0),a}_getStackCount(i){return this._getStacks(void 0,i).length}_getStackIndex(i,r,n){let o=this._getStacks(i,n),s=r!==void 0?o.indexOf(r):-1;return s===-1?o.length-1:s}_getRuler(){let i=this.options,r=this._cachedMeta,n=r.iScale,o=[],s,a;for(s=0,a=r.data.length;s<a;++s)o.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));let c=i.barThickness;return{min:c||oZe(r),pixels:o,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:i.grouped,ratio:c?1:i.categoryPercentage*i.barPercentage}}_calculateBarValuePixels(i){let{_cachedMeta:{vScale:r,_stacked:n,index:o},options:{base:s,minBarLength:a}}=this,c=s||0,d=this.getParsed(i),u=d._custom,h=pq(u),p=d[r.axis],f=0,m=n?this.applyStack(r,d,n):p,g,y;m!==p&&(f=m-p,m=p),h&&(p=u.barStart,m=u.barEnd-u.barStart,p!==0&&Yu(p)!==Yu(u.barEnd)&&(f=0),f+=p);let w=!kr(s)&&!h?s:f,x=r.getPixelForValue(w);if(this.chart.getDataVisibility(i)?g=r.getPixelForValue(f+m):g=x,y=g-x,Math.abs(y)<a){y=cZe(y,r,c)*a,p===c&&(x-=y/2);let T=r.getPixelForDecimal(0),M=r.getPixelForDecimal(1),B=Math.min(T,M),G=Math.max(T,M);x=Math.max(Math.min(x,G),B),g=x+y,n&&!h&&(d._stacks[r.axis]._visualValues[o]=r.getValueForPixel(g)-r.getValueForPixel(x))}if(x===r.getPixelForValue(c)){let T=Yu(y)*r.getLineWidthForValue(c)/2;x+=T,y-=T}return{size:y,base:x,head:g,center:g+y/2}}_calculateBarIndexPixels(i,r){let n=r.scale,o=this.options,s=o.skipNull,a=Ki(o.maxBarThickness,1/0),c,d;if(r.grouped){let u=s?this._getStackCount(i):r.stackCount,h=o.barThickness==="flex"?aZe(i,r,o,u):sZe(i,r,o,u),p=this._getStackIndex(this.index,this._cachedMeta.stack,s?i:void 0);c=h.start+h.chunk*p+h.chunk/2,d=Math.min(a,h.chunk*h.ratio)}else c=n.getPixelForValue(this.getParsed(i)[n.axis],i),d=Math.min(a,r.min*r.ratio);return{base:c-d/2,head:c+d/2,center:c,size:d}}draw(){let i=this._cachedMeta,r=i.vScale,n=i.data,o=n.length,s=0;for(;s<o;++s)this.getParsed(s)[r.axis]!==null&&!n[s].hidden&&n[s].draw(this._ctx)}}return t})(),mZe=(()=>{class t extends Cv{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(i,r,n,o){let s=super.parsePrimitiveData(i,r,n,o);for(let a=0;a<s.length;a++)s[a]._custom=this.resolveDataElementOptions(a+n).radius;return s}parseArrayData(i,r,n,o){let s=super.parseArrayData(i,r,n,o);for(let a=0;a<s.length;a++){let c=r[n+a];s[a]._custom=Ki(c[2],this.resolveDataElementOptions(a+n).radius)}return s}parseObjectData(i,r,n,o){let s=super.parseObjectData(i,r,n,o);for(let a=0;a<s.length;a++){let c=r[n+a];s[a]._custom=Ki(c&&c.r&&+c.r,this.resolveDataElementOptions(a+n).radius)}return s}getMaxOverflow(){let i=this._cachedMeta.data,r=0;for(let n=i.length-1;n>=0;--n)r=Math.max(r,i[n].size(this.resolveDataElementOptions(n))/2);return r>0&&r}getLabelAndValue(i){let r=this._cachedMeta,n=this.chart.data.labels||[],{xScale:o,yScale:s}=r,a=this.getParsed(i),c=o.getLabelForValue(a.x),d=s.getLabelForValue(a.y),u=a._custom;return{label:n[i]||"",value:"("+c+", "+d+(u?", "+u:"")+")"}}update(i){let r=this._cachedMeta.data;this.updateElements(r,0,r.length,i)}updateElements(i,r,n,o){let s=o==="reset",{iScale:a,vScale:c}=this._cachedMeta,{sharedOptions:d,includeOptions:u}=this._getSharedOptions(r,o),h=a.axis,p=c.axis;for(let f=r;f<r+n;f++){let m=i[f],g=!s&&this.getParsed(f),y={},w=y[h]=s?a.getPixelForDecimal(.5):a.getPixelForValue(g[h]),x=y[p]=s?c.getBasePixel():c.getPixelForValue(g[p]);y.skip=isNaN(w)||isNaN(x),u&&(y.options=d||this.resolveDataElementOptions(f,m.active?"active":o),s&&(y.options.radius=0)),this.updateElement(m,f,y,o)}}resolveDataElementOptions(i,r){let n=this.getParsed(i),o=super.resolveDataElementOptions(i,r);o.$shared&&(o=Object.assign({},o,{$shared:!1}));let s=o.radius;return r!=="active"&&(o.radius=0),o.radius+=Ki(n&&n._custom,s),o}}return t})();function gZe(t,e,i){let r=1,n=1,o=0,s=0;if(e<Yn){let a=t,c=a+e,d=Math.cos(a),u=Math.sin(a),h=Math.cos(c),p=Math.sin(c),f=(T,M,B)=>Ix(T,a,c,!0)?1:Math.max(M,M*i,B,B*i),m=(T,M,B)=>Ix(T,a,c,!0)?-1:Math.min(M,M*i,B,B*i),g=f(0,d,h),y=f(zo,u,p),w=m(qn,d,h),x=m(qn+zo,u,p);r=(g-w)/2,n=(y-x)/2,o=-(g+w)/2,s=-(y+x)/2}return{ratioX:r,ratioY:n,offsetX:o,offsetY:s}}var zq=(()=>{class t extends Cv{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:i=>i!=="spacing",_indexable:i=>i!=="spacing"&&!i.startsWith("borderDash")&&!i.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(i){let r=i.data;if(r.labels.length&&r.datasets.length){let{labels:{pointStyle:n,color:o}}=i.legend.options;return r.labels.map((s,a)=>{let d=i.getDatasetMeta(0).controller.getStyle(a);return{text:s,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:o,lineWidth:d.borderWidth,pointStyle:n,hidden:!i.getDataVisibility(a),index:a}})}return[]}},onClick(i,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}}};constructor(i,r){super(i,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(i,r){let n=this.getDataset().data,o=this._cachedMeta;if(this._parsing===!1)o._parsed=n;else{let s=d=>+n[d];if(wr(n[i])){let{key:d="value"}=this._parsing;s=u=>+om(n[u],d)}let a,c;for(a=i,c=i+r;a<c;++a)o._parsed[a]=s(a)}}_getRotation(){return qd(this.options.rotation-90)}_getCircumference(){return qd(this.options.circumference)}_getRotationExtents(){let i=Yn,r=-Yn;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){let o=this.chart.getDatasetMeta(n).controller,s=o._getRotation(),a=o._getCircumference();i=Math.min(i,s),r=Math.max(r,s+a)}return{rotation:i,circumference:r-i}}update(i){let r=this.chart,{chartArea:n}=r,o=this._cachedMeta,s=o.data,a=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,c=Math.max((Math.min(n.width,n.height)-a)/2,0),d=Math.min(tfe(this.options.cutout,c),1),u=this._getRingWeight(this.index),{circumference:h,rotation:p}=this._getRotationExtents(),{ratioX:f,ratioY:m,offsetX:g,offsetY:y}=gZe(p,h,d),w=(n.width-a)/f,x=(n.height-a)/m,T=Math.max(Math.min(w,x)/2,0),M=BU(this.options.radius,T),B=Math.max(M*d,0),G=(M-B)/this._getVisibleDatasetWeightTotal();this.offsetX=g*M,this.offsetY=y*M,o.total=this.calculateTotal(),this.outerRadius=M-G*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-G*u,0),this.updateElements(s,0,s.length,i)}_circumference(i,r){let n=this.options,o=this._cachedMeta,s=this._getCircumference();return r&&n.animation.animateRotate||!this.chart.getDataVisibility(i)||o._parsed[i]===null||o.data[i].hidden?0:this.calculateCircumference(o._parsed[i]*s/Yn)}updateElements(i,r,n,o){let s=o==="reset",a=this.chart,c=a.chartArea,u=a.options.animation,h=(c.left+c.right)/2,p=(c.top+c.bottom)/2,f=s&&u.animateScale,m=f?0:this.innerRadius,g=f?0:this.outerRadius,{sharedOptions:y,includeOptions:w}=this._getSharedOptions(r,o),x=this._getRotation(),T;for(T=0;T<r;++T)x+=this._circumference(T,s);for(T=r;T<r+n;++T){let M=this._circumference(T,s),B=i[T],G={x:h+this.offsetX,y:p+this.offsetY,startAngle:x,endAngle:x+M,circumference:M,outerRadius:g,innerRadius:m};w&&(G.options=y||this.resolveDataElementOptions(T,B.active?"active":o)),x+=M,this.updateElement(B,T,G,o)}}calculateTotal(){let i=this._cachedMeta,r=i.data,n=0,o;for(o=0;o<r.length;o++){let s=i._parsed[o];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(o)&&!r[o].hidden&&(n+=Math.abs(s))}return n}calculateCircumference(i){let r=this._cachedMeta.total;return r>0&&!isNaN(i)?Yn*(Math.abs(i)/r):0}getLabelAndValue(i){let r=this._cachedMeta,n=this.chart,o=n.data.labels||[],s=Dx(r._parsed[i],n.options.locale);return{label:o[i]||"",value:s}}getMaxBorderWidth(i){let r=0,n=this.chart,o,s,a,c,d;if(!i){for(o=0,s=n.data.datasets.length;o<s;++o)if(n.isDatasetVisible(o)){a=n.getDatasetMeta(o),i=a.data,c=a.controller;break}}if(!i)return 0;for(o=0,s=i.length;o<s;++o)d=c.resolveDataElementOptions(o),d.borderAlign!=="inner"&&(r=Math.max(r,d.borderWidth||0,d.hoverBorderWidth||0));return r}getMaxOffset(i){let r=0;for(let n=0,o=i.length;n<o;++n){let s=this.resolveDataElementOptions(n);r=Math.max(r,s.offset||0,s.hoverOffset||0)}return r}_getRingWeightOffset(i){let r=0;for(let n=0;n<i;++n)this.chart.isDatasetVisible(n)&&(r+=this._getRingWeight(n));return r}_getRingWeight(i){return Math.max(Ki(this.chart.data.datasets[i].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return t})(),vZe=(()=>{class t extends Cv{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(i){let r=this._cachedMeta,{dataset:n,data:o=[],_dataset:s}=r,a=this.chart._animationsDisabled,{start:c,count:d}=XU(r,o,a);this._drawStart=c,this._drawCount=d,KU(r)&&(c=0,d=o.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=o;let u=this.resolveDatasetElementOptions(i);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(n,void 0,{animated:!a,options:u},i),this.updateElements(o,c,d,i)}updateElements(i,r,n,o){let s=o==="reset",{iScale:a,vScale:c,_stacked:d,_dataset:u}=this._cachedMeta,{sharedOptions:h,includeOptions:p}=this._getSharedOptions(r,o),f=a.axis,m=c.axis,{spanGaps:g,segment:y}=this.options,w=L_(g)?g:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||s||o==="none",T=r+n,M=i.length,B=r>0&&this.getParsed(r-1);for(let G=0;G<M;++G){let F=i[G],O=x?F:{};if(G<r||G>=T){O.skip=!0;continue}let V=this.getParsed(G),J=kr(V[m]),N=O[f]=a.getPixelForValue(V[f],G),P=O[m]=s||J?c.getBasePixel():c.getPixelForValue(d?this.applyStack(c,V,d):V[m],G);O.skip=isNaN(N)||isNaN(P)||J,O.stop=G>0&&Math.abs(V[f]-B[f])>w,y&&(O.parsed=V,O.raw=u.data[G]),p&&(O.options=h||this.resolveDataElementOptions(G,F.active?"active":o)),x||this.updateElement(F,G,O,o),B=V}}getMaxOverflow(){let i=this._cachedMeta,r=i.dataset,n=r.options&&r.options.borderWidth||0,o=i.data||[];if(!o.length)return n;let s=o[0].size(this.resolveDataElementOptions(0)),a=o[o.length-1].size(this.resolveDataElementOptions(o.length-1));return Math.max(n,s,a)/2}draw(){let i=this._cachedMeta;i.dataset.updateControlPoints(this.chart.chartArea,i.iScale.axis),super.draw()}}return t})(),kpe=(()=>{class t extends Cv{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(i){let r=i.data;if(r.labels.length&&r.datasets.length){let{labels:{pointStyle:n,color:o}}=i.legend.options;return r.labels.map((s,a)=>{let d=i.getDatasetMeta(0).controller.getStyle(a);return{text:s,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:o,lineWidth:d.borderWidth,pointStyle:n,hidden:!i.getDataVisibility(a),index:a}})}return[]}},onClick(i,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(i,r){super(i,r),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(i){let r=this._cachedMeta,n=this.chart,o=n.data.labels||[],s=Dx(r._parsed[i].r,n.options.locale);return{label:o[i]||"",value:s}}parseObjectData(i,r,n,o){return oq.bind(this)(i,r,n,o)}update(i){let r=this._cachedMeta.data;this._updateRadius(),this.updateElements(r,0,r.length,i)}getMinMax(){let i=this._cachedMeta,r={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return i.data.forEach((n,o)=>{let s=this.getParsed(o).r;!isNaN(s)&&this.chart.getDataVisibility(o)&&(s<r.min&&(r.min=s),s>r.max&&(r.max=s))}),r}_updateRadius(){let i=this.chart,r=i.chartArea,n=i.options,o=Math.min(r.right-r.left,r.bottom-r.top),s=Math.max(o/2,0),a=Math.max(n.cutoutPercentage?s/100*n.cutoutPercentage:1,0),c=(s-a)/i.getVisibleDatasetCount();this.outerRadius=s-c*this.index,this.innerRadius=this.outerRadius-c}updateElements(i,r,n,o){let s=o==="reset",a=this.chart,d=a.options.animation,u=this._cachedMeta.rScale,h=u.xCenter,p=u.yCenter,f=u.getIndexAngle(0)-.5*qn,m=f,g,y=360/this.countVisibleElements();for(g=0;g<r;++g)m+=this._computeAngle(g,o,y);for(g=r;g<r+n;g++){let w=i[g],x=m,T=m+this._computeAngle(g,o,y),M=a.getDataVisibility(g)?u.getDistanceFromCenterForValue(this.getParsed(g).r):0;m=T,s&&(d.animateScale&&(M=0),d.animateRotate&&(x=T=f));let B={x:h,y:p,innerRadius:0,outerRadius:M,startAngle:x,endAngle:T,options:this.resolveDataElementOptions(g,w.active?"active":o)};this.updateElement(w,g,B,o)}}countVisibleElements(){let i=this._cachedMeta,r=0;return i.data.forEach((n,o)=>{!isNaN(this.getParsed(o).r)&&this.chart.getDataVisibility(o)&&r++}),r}_computeAngle(i,r,n){return this.chart.getDataVisibility(i)?qd(this.resolveDataElementOptions(i,r).angle||n):0}}return t})(),bZe=(()=>{class t extends zq{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}return t})(),_Ze=(()=>{class t extends Cv{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(i){let r=this._cachedMeta.vScale,n=this.getParsed(i);return{label:r.getLabels()[i],value:""+r.getLabelForValue(n[r.axis])}}parseObjectData(i,r,n,o){return oq.bind(this)(i,r,n,o)}update(i){let r=this._cachedMeta,n=r.dataset,o=r.data||[],s=r.iScale.getLabels();if(n.points=o,i!=="resize"){let a=this.resolveDatasetElementOptions(i);this.options.showLine||(a.borderWidth=0);let c={_loop:!0,_fullLoop:s.length===o.length,options:a};this.updateElement(n,void 0,c,i)}this.updateElements(o,0,o.length,i)}updateElements(i,r,n,o){let s=this._cachedMeta.rScale,a=o==="reset";for(let c=r;c<r+n;c++){let d=i[c],u=this.resolveDataElementOptions(c,d.active?"active":o),h=s.getPointPositionForValue(c,this.getParsed(c).r),p=a?s.xCenter:h.x,f=a?s.yCenter:h.y,m={x:p,y:f,angle:h.angle,skip:isNaN(p)||isNaN(f),options:u};this.updateElement(d,c,m,o)}}}return t})(),yZe=(()=>{class t extends Cv{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(i){let r=this._cachedMeta,n=this.chart.data.labels||[],{xScale:o,yScale:s}=r,a=this.getParsed(i),c=o.getLabelForValue(a.x),d=s.getLabelForValue(a.y);return{label:n[i]||"",value:"("+c+", "+d+")"}}update(i){let r=this._cachedMeta,{data:n=[]}=r,o=this.chart._animationsDisabled,{start:s,count:a}=XU(r,n,o);if(this._drawStart=s,this._drawCount=a,KU(r)&&(s=0,a=n.length),this.options.showLine){this.datasetElementType||this.addElements();let{dataset:c,_dataset:d}=r;c._chart=this.chart,c._datasetIndex=this.index,c._decimated=!!d._decimated,c.points=n;let u=this.resolveDatasetElementOptions(i);u.segment=this.options.segment,this.updateElement(c,void 0,{animated:!o,options:u},i)}else this.datasetElementType&&(delete r.dataset,this.datasetElementType=!1);this.updateElements(n,s,a,i)}addElements(){let{showLine:i}=this.options;!this.datasetElementType&&i&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(i,r,n,o){let s=o==="reset",{iScale:a,vScale:c,_stacked:d,_dataset:u}=this._cachedMeta,h=this.resolveDataElementOptions(r,o),p=this.getSharedOptions(h),f=this.includeOptions(o,p),m=a.axis,g=c.axis,{spanGaps:y,segment:w}=this.options,x=L_(y)?y:Number.POSITIVE_INFINITY,T=this.chart._animationsDisabled||s||o==="none",M=r>0&&this.getParsed(r-1);for(let B=r;B<r+n;++B){let G=i[B],F=this.getParsed(B),O=T?G:{},V=kr(F[g]),J=O[m]=a.getPixelForValue(F[m],B),N=O[g]=s||V?c.getBasePixel():c.getPixelForValue(d?this.applyStack(c,F,d):F[g],B);O.skip=isNaN(J)||isNaN(N)||V,O.stop=B>0&&Math.abs(F[m]-M[m])>x,w&&(O.parsed=F,O.raw=u.data[B]),f&&(O.options=p||this.resolveDataElementOptions(B,G.active?"active":o)),T||this.updateElement(G,B,O,o),M=F}this.updateSharedOptions(p,o,h)}getMaxOverflow(){let i=this._cachedMeta,r=i.data||[];if(!this.options.showLine){let c=0;for(let d=r.length-1;d>=0;--d)c=Math.max(c,r[d].size(this.resolveDataElementOptions(d))/2);return c>0&&c}let n=i.dataset,o=n.options&&n.options.borderWidth||0;if(!r.length)return o;let s=r[0].size(this.resolveDataElementOptions(0)),a=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(o,s,a)/2}}return t})(),wZe=Object.freeze({__proto__:null,BarController:pZe,BubbleController:mZe,DoughnutController:zq,LineController:vZe,PieController:bZe,PolarAreaController:kpe,RadarController:_Ze,ScatterController:yZe});function H_(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var xq=class t{static override(e){Object.assign(t.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return H_()}parse(){return H_()}format(){return H_()}add(){return H_()}diff(){return H_()}startOf(){return H_()}endOf(){return H_()}},CZe={_date:xq};function xZe(t,e,i,r){let{controller:n,data:o,_sorted:s}=t,a=n._cachedMeta.iScale;if(a&&e===a.axis&&e!=="r"&&s&&o.length){let c=a._reversePixels?afe:vf;if(r){if(n._sharedOptions){let d=o[0],u=typeof d.getRange=="function"&&d.getRange(e);if(u){let h=c(o,e,i-u),p=c(o,e,i+u);return{lo:h.lo,hi:p.hi}}}}else return c(o,e,i)}return{lo:0,hi:o.length-1}}function ZA(t,e,i,r,n){let o=t.getSortedVisibleDatasetMetas(),s=i[e];for(let a=0,c=o.length;a<c;++a){let{index:d,data:u}=o[a],{lo:h,hi:p}=xZe(o[a],e,s,n);for(let f=h;f<=p;++f){let m=u[f];m.skip||r(m,d,f)}}}function SZe(t){let e=t.indexOf("x")!==-1,i=t.indexOf("y")!==-1;return function(r,n){let o=e?Math.abs(r.x-n.x):0,s=i?Math.abs(r.y-n.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(s,2))}}function mq(t,e,i,r,n){let o=[];return!n&&!t.isPointInArea(e)||ZA(t,i,e,function(a,c,d){!n&&!bf(a,t.chartArea,0)||a.inRange(e.x,e.y,r)&&o.push({element:a,datasetIndex:c,index:d})},!0),o}function EZe(t,e,i,r){let n=[];function o(s,a,c){let{startAngle:d,endAngle:u}=s.getProps(["startAngle","endAngle"],r),{angle:h}=UU(s,{x:e.x,y:e.y});Ix(h,d,u)&&n.push({element:s,datasetIndex:a,index:c})}return ZA(t,i,e,o),n}function TZe(t,e,i,r,n,o){let s=[],a=SZe(i),c=Number.POSITIVE_INFINITY;function d(u,h,p){let f=u.inRange(e.x,e.y,n);if(r&&!f)return;let m=u.getCenterPoint(n);if(!(!!o||t.isPointInArea(m))&&!f)return;let y=a(e,m);y<c?(s=[{element:u,datasetIndex:h,index:p}],c=y):y===c&&s.push({element:u,datasetIndex:h,index:p})}return ZA(t,i,e,d),s}function gq(t,e,i,r,n,o){return!o&&!t.isPointInArea(e)?[]:i==="r"&&!r?EZe(t,e,i,n):TZe(t,e,i,r,n,o)}function Bfe(t,e,i,r,n){let o=[],s=i==="x"?"inXRange":"inYRange",a=!1;return ZA(t,i,e,(c,d,u)=>{c[s](e[i],n)&&(o.push({element:c,datasetIndex:d,index:u}),a=a||c.inRange(e.x,e.y,n))}),r&&!a?[]:o}var RZe={evaluateInteractionItems:ZA,modes:{index(t,e,i,r){let n=yv(e,t),o=i.axis||"x",s=i.includeInvisible||!1,a=i.intersect?mq(t,n,o,r,s):gq(t,n,o,!1,r,s),c=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(d=>{let u=a[0].index,h=d.data[u];h&&!h.skip&&c.push({element:h,datasetIndex:d.index,index:u})}),c):[]},dataset(t,e,i,r){let n=yv(e,t),o=i.axis||"xy",s=i.includeInvisible||!1,a=i.intersect?mq(t,n,o,r,s):gq(t,n,o,!1,r,s);if(a.length>0){let c=a[0].datasetIndex,d=t.getDatasetMeta(c).data;a=[];for(let u=0;u<d.length;++u)a.push({element:d[u],datasetIndex:c,index:u})}return a},point(t,e,i,r){let n=yv(e,t),o=i.axis||"xy",s=i.includeInvisible||!1;return mq(t,n,o,r,s)},nearest(t,e,i,r){let n=yv(e,t),o=i.axis||"xy",s=i.includeInvisible||!1;return gq(t,n,o,i.intersect,r,s)},x(t,e,i,r){let n=yv(e,t);return Bfe(t,n,"x",i.intersect,r)},y(t,e,i,r){let n=yv(e,t);return Bfe(t,n,"y",i.intersect,r)}}},Ope=["left","top","right","bottom"];function zA(t,e){return t.filter(i=>i.pos===e)}function Vfe(t,e){return t.filter(i=>Ope.indexOf(i.pos)===-1&&i.box.axis===e)}function WA(t,e){return t.sort((i,r)=>{let n=e?r:i,o=e?i:r;return n.weight===o.weight?n.index-o.index:n.weight-o.weight})}function AZe(t){let e=[],i,r,n,o,s,a;for(i=0,r=(t||[]).length;i<r;++i)n=t[i],{position:o,options:{stack:s,stackWeight:a=1}}=n,e.push({index:i,box:n,pos:o,horizontal:n.isHorizontal(),weight:n.weight,stack:s&&o+s,stackWeight:a});return e}function IZe(t){let e={};for(let i of t){let{stack:r,pos:n,stackWeight:o}=i;if(!r||!Ope.includes(n))continue;let s=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=o}return e}function DZe(t,e){let i=IZe(t),{vBoxMaxWidth:r,hBoxMaxHeight:n}=e,o,s,a;for(o=0,s=t.length;o<s;++o){a=t[o];let{fullSize:c}=a.box,d=i[a.stack],u=d&&a.stackWeight/d.weight;a.horizontal?(a.width=u?u*r:c&&e.availableWidth,a.height=n):(a.width=r,a.height=u?u*n:c&&e.availableHeight)}return i}function MZe(t){let e=AZe(t),i=WA(e.filter(d=>d.box.fullSize),!0),r=WA(zA(e,"left"),!0),n=WA(zA(e,"right")),o=WA(zA(e,"top"),!0),s=WA(zA(e,"bottom")),a=Vfe(e,"x"),c=Vfe(e,"y");return{fullSize:i,leftAndTop:r.concat(o),rightAndBottom:n.concat(c).concat(s).concat(a),chartArea:zA(e,"chartArea"),vertical:r.concat(n).concat(c),horizontal:o.concat(s).concat(a)}}function jfe(t,e,i,r){return Math.max(t[i],e[i])+Math.max(t[r],e[r])}function Npe(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function kZe(t,e,i,r){let{pos:n,box:o}=i,s=t.maxPadding;if(!wr(n)){i.size&&(t[n]-=i.size);let h=r[i.stack]||{size:0,count:1};h.size=Math.max(h.size,i.horizontal?o.height:o.width),i.size=h.size/h.count,t[n]+=i.size}o.getPadding&&Npe(s,o.getPadding());let a=Math.max(0,e.outerWidth-jfe(s,t,"left","right")),c=Math.max(0,e.outerHeight-jfe(s,t,"top","bottom")),d=a!==t.w,u=c!==t.h;return t.w=a,t.h=c,i.horizontal?{same:d,other:u}:{same:u,other:d}}function OZe(t){let e=t.maxPadding;function i(r){let n=Math.max(e[r]-t[r],0);return t[r]+=n,n}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}function NZe(t,e){let i=e.maxPadding;function r(n){let o={left:0,top:0,right:0,bottom:0};return n.forEach(s=>{o[s]=Math.max(e[s],i[s])}),o}return r(t?["left","right"]:["top","bottom"])}function YA(t,e,i,r){let n=[],o,s,a,c,d,u;for(o=0,s=t.length,d=0;o<s;++o){a=t[o],c=a.box,c.update(a.width||e.w,a.height||e.h,NZe(a.horizontal,e));let{same:h,other:p}=kZe(e,i,a,r);d|=h&&n.length,u=u||p,c.fullSize||n.push(a)}return d&&YA(n,e,i,r)||u}function xF(t,e,i,r,n){t.top=i,t.left=e,t.right=e+r,t.bottom=i+n,t.width=r,t.height=n}function zfe(t,e,i,r){let n=i.padding,{x:o,y:s}=e;for(let a of t){let c=a.box,d=r[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/d.weight||1;if(a.horizontal){let h=e.w*u,p=d.size||c.height;Rx(d.start)&&(s=d.start),c.fullSize?xF(c,n.left,s,i.outerWidth-n.right-n.left,p):xF(c,e.left+d.placed,s,h,p),d.start=s,d.placed+=h,s=c.bottom}else{let h=e.h*u,p=d.size||c.width;Rx(d.start)&&(o=d.start),c.fullSize?xF(c,o,n.top,p,i.outerHeight-n.bottom-n.top):xF(c,o,e.top+d.placed,p,h),d.start=o,d.placed+=h,o=c.right}}e.x=o,e.y=s}var ol={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(i){e.draw(i)}}]},t.boxes.push(e)},removeBox(t,e){let i=t.boxes?t.boxes.indexOf(e):-1;i!==-1&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,r){if(!t)return;let n=Ma(t.options.layout.padding),o=Math.max(e-n.width,0),s=Math.max(i-n.height,0),a=MZe(t.boxes),c=a.vertical,d=a.horizontal;an(t.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});let u=c.reduce((g,y)=>y.box.options&&y.box.options.display===!1?g:g+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:i,padding:n,availableWidth:o,availableHeight:s,vBoxMaxWidth:o/2/u,hBoxMaxHeight:s/2}),p=Object.assign({},n);Npe(p,Ma(r));let f=Object.assign({maxPadding:p,w:o,h:s,x:n.left,y:n.top},n),m=DZe(c.concat(d),h);YA(a.fullSize,f,h,m),YA(c,f,h,m),YA(d,f,h,m)&&YA(c,f,h,m),OZe(f),zfe(a.leftAndTop,f,h,m),f.x+=f.w,f.y+=f.h,zfe(a.rightAndBottom,f,h,m),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},an(a.chartArea,g=>{let y=g.box;Object.assign(y,t.chartArea),y.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}},OF=class{acquireContext(e,i){}releaseContext(e){return!1}addEventListener(e,i,r){}removeEventListener(e,i,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,i,r,n){return i=Math.max(0,i||e.width),r=r||e.height,{width:i,height:Math.max(0,n?Math.floor(i/n):r)}}isAttached(e){return!0}updateConfig(e){}},Sq=class extends OF{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}},DF="$chartjs",PZe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Wfe=t=>t===null||t==="";function LZe(t,e){let i=t.style,r=t.getAttribute("height"),n=t.getAttribute("width");if(t[DF]={initial:{height:r,width:n,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",Wfe(n)){let o=aq(t,"width");o!==void 0&&(t.width=o)}if(Wfe(r))if(t.style.height==="")t.height=t.width/(e||2);else{let o=aq(t,"height");o!==void 0&&(t.height=o)}return t}var Ppe=Sfe?{passive:!0}:!1;function FZe(t,e,i){t&&t.addEventListener(e,i,Ppe)}function HZe(t,e,i){t&&t.canvas&&t.canvas.removeEventListener(e,i,Ppe)}function BZe(t,e){let i=PZe[t.type]||t.type,{x:r,y:n}=yv(t,e);return{type:i,chart:e,native:t,x:r!==void 0?r:null,y:n!==void 0?n:null}}function NF(t,e){for(let i of t)if(i===e||i.contains(e))return!0}function VZe(t,e,i){let r=t.canvas,n=new MutationObserver(o=>{let s=!1;for(let a of o)s=s||NF(a.addedNodes,r),s=s&&!NF(a.removedNodes,r);s&&i()});return n.observe(document,{childList:!0,subtree:!0}),n}function jZe(t,e,i){let r=t.canvas,n=new MutationObserver(o=>{let s=!1;for(let a of o)s=s||NF(a.removedNodes,r),s=s&&!NF(a.addedNodes,r);s&&i()});return n.observe(document,{childList:!0,subtree:!0}),n}var GA=new Map,Ufe=0;function Lpe(){let t=window.devicePixelRatio;t!==Ufe&&(Ufe=t,GA.forEach((e,i)=>{i.currentDevicePixelRatio!==t&&e()}))}function zZe(t,e){GA.size||window.addEventListener("resize",Lpe),GA.set(t,e)}function WZe(t){GA.delete(t),GA.size||window.removeEventListener("resize",Lpe)}function UZe(t,e,i){let r=t.canvas,n=r&&wF(r);if(!n)return;let o=GU((a,c)=>{let d=n.clientWidth;i(a,c),d<n.clientWidth&&i()},window),s=new ResizeObserver(a=>{let c=a[0],d=c.contentRect.width,u=c.contentRect.height;d===0&&u===0||o(d,u)});return s.observe(n),zZe(t,o),s}function vq(t,e,i){i&&i.disconnect(),e==="resize"&&WZe(t)}function qZe(t,e,i){let r=t.canvas,n=GU(o=>{t.ctx!==null&&i(BZe(o,t))},t);return FZe(r,e,n),n}var Eq=class extends OF{acquireContext(e,i){let r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(LZe(e,i),r):null}releaseContext(e){let i=e.canvas;if(!i[DF])return!1;let r=i[DF].initial;["height","width"].forEach(o=>{let s=r[o];kr(s)?i.removeAttribute(o):i.setAttribute(o,s)});let n=r.style||{};return Object.keys(n).forEach(o=>{i.style[o]=n[o]}),i.width=i.width,delete i[DF],!0}addEventListener(e,i,r){this.removeEventListener(e,i);let n=e.$proxies||(e.$proxies={}),s={attach:VZe,detach:jZe,resize:UZe}[i]||qZe;n[i]=s(e,i,r)}removeEventListener(e,i){let r=e.$proxies||(e.$proxies={}),n=r[i];if(!n)return;({attach:vq,detach:vq,resize:vq}[i]||HZe)(e,i,n),r[i]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,i,r,n){return xfe(e,i,r,n)}isAttached(e){let i=e&&wF(e);return!!(i&&i.isConnected)}};function YZe(t){return!yF()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?Sq:Eq}var $u=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){let{x:i,y:r}=this.getProps(["x","y"],e);return{x:i,y:r}}hasValue(){return L_(this.x)&&L_(this.y)}getProps(e,i){let r=this.$animations;if(!i||!r)return this;let n={};return e.forEach(o=>{n[o]=r[o]&&r[o].active()?r[o]._to:this[o]}),n}};function $Ze(t,e){let i=t.options.ticks,r=GZe(t),n=Math.min(i.maxTicksLimit||r,r),o=i.major.enabled?KZe(e):[],s=o.length,a=o[0],c=o[s-1],d=[];if(s>n)return ZZe(e,d,o,s/n),d;let u=XZe(o,e,n);if(s>0){let h,p,f=s>1?Math.round((c-a)/(s-1)):null;for(SF(e,d,u,kr(f)?0:a-f,a),h=0,p=s-1;h<p;h++)SF(e,d,u,o[h],o[h+1]);return SF(e,d,u,c,kr(f)?e.length:c+f),d}return SF(e,d,u),d}function GZe(t){let e=t.options.offset,i=t._tickSize(),r=t._length/i+(e?0:1),n=t._maxLength/i;return Math.floor(Math.min(r,n))}function XZe(t,e,i){let r=QZe(t),n=e.length/i;if(!r)return Math.max(n,1);let o=nfe(r);for(let s=0,a=o.length-1;s<a;s++){let c=o[s];if(c>n)return c}return Math.max(n,1)}function KZe(t){let e=[],i,r;for(i=0,r=t.length;i<r;i++)t[i].major&&e.push(i);return e}function ZZe(t,e,i,r){let n=0,o=i[0],s;for(r=Math.ceil(r),s=0;s<t.length;s++)s===o&&(e.push(t[s]),n++,o=i[n*r])}function SF(t,e,i,r,n){let o=Ki(r,0),s=Math.min(Ki(n,t.length),t.length),a=0,c,d,u;for(i=Math.ceil(i),n&&(c=n-r,i=c/Math.floor(c/i)),u=o;u<0;)a++,u=Math.round(o+a*i);for(d=Math.max(o,0);d<s;d++)d===u&&(e.push(t[d]),a++,u=Math.round(o+a*i))}function QZe(t){let e=t.length,i,r;if(e<2)return!1;for(r=t[0],i=1;i<e;++i)if(t[i]-t[i-1]!==r)return!1;return r}var JZe=t=>t==="left"?"right":t==="right"?"left":t,qfe=(t,e,i)=>e==="top"||e==="left"?t[e]+i:t[e]-i,Yfe=(t,e)=>Math.min(e||t,t);function $fe(t,e){let i=[],r=t.length/e,n=t.length,o=0;for(;o<n;o+=r)i.push(t[Math.floor(o)]);return i}function eQe(t,e,i){let r=t.ticks.length,n=Math.min(e,r-1),o=t._startPixel,s=t._endPixel,a=1e-6,c=t.getPixelForTick(n),d;if(!(i&&(r===1?d=Math.max(c-o,s-c):e===0?d=(t.getPixelForTick(1)-c)/2:d=(c-t.getPixelForTick(n-1))/2,c+=n<e?d:-d,c<o-a||c>s+a)))return c}function tQe(t,e){an(t,i=>{let r=i.gc,n=r.length/2,o;if(n>e){for(o=0;o<n;++o)delete i.data[r[o]];r.splice(0,n)}})}function UA(t){return t.drawTicks?t.tickLength:0}function Gfe(t,e){if(!t.display)return 0;let i=Cs(t.font,e),r=Ma(t.padding);return(Un(t.text)?t.text.length:1)*i.lineHeight+r.height}function iQe(t,e){return sm(t,{scale:e,type:"scale"})}function rQe(t,e,i){return sm(t,{tick:i,index:e,type:"tick"})}function nQe(t,e,i){let r=mF(t);return(i&&e!=="right"||!i&&e==="right")&&(r=JZe(r)),r}function oQe(t,e,i,r){let{top:n,left:o,bottom:s,right:a,chart:c}=t,{chartArea:d,scales:u}=c,h=0,p,f,m,g=s-n,y=a-o;if(t.isHorizontal()){if(f=Da(r,o,a),wr(i)){let w=Object.keys(i)[0],x=i[w];m=u[w].getPixelForValue(x)+g-e}else i==="center"?m=(d.bottom+d.top)/2+g-e:m=qfe(t,i,e);p=a-o}else{if(wr(i)){let w=Object.keys(i)[0],x=i[w];f=u[w].getPixelForValue(x)-y+e}else i==="center"?f=(d.left+d.right)/2-y+e:f=qfe(t,i,e);m=Da(r,s,n),h=i==="left"?-zo:zo}return{titleX:f,titleY:m,maxWidth:p,rotation:h}}var V_=class t extends $u{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,i){return e}getUserBounds(){let{_userMin:e,_userMax:i,_suggestedMin:r,_suggestedMax:n}=this;return e=gc(e,Number.POSITIVE_INFINITY),i=gc(i,Number.NEGATIVE_INFINITY),r=gc(r,Number.POSITIVE_INFINITY),n=gc(n,Number.NEGATIVE_INFINITY),{min:gc(e,r),max:gc(i,n),minDefined:Ro(e),maxDefined:Ro(i)}}getMinMax(e){let{min:i,max:r,minDefined:n,maxDefined:o}=this.getUserBounds(),s;if(n&&o)return{min:i,max:r};let a=this.getMatchingVisibleMetas();for(let c=0,d=a.length;c<d;++c)s=a[c].controller.getMinMax(this,e),n||(i=Math.min(i,s.min)),o||(r=Math.max(r,s.max));return i=o&&i>r?r:i,r=n&&i>r?i:r,{min:gc(i,gc(r,i)),max:gc(r,gc(i,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){On(this.options.beforeUpdate,[this])}update(e,i,r){let{beginAtZero:n,grace:o,ticks:s}=this.options,a=s.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=i,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=vfe(this,o,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let c=a<this.ticks.length;this._convertTicksToLabels(c?$fe(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||s.source==="auto")&&(this.ticks=$Ze(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,i,r;this.isHorizontal()?(i=this.left,r=this.right):(i=this.top,r=this.bottom,e=!e),this._startPixel=i,this._endPixel=r,this._reversePixels=e,this._length=r-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){On(this.options.afterUpdate,[this])}beforeSetDimensions(){On(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){On(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),On(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){On(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){let i=this.options.ticks,r,n,o;for(r=0,n=e.length;r<n;r++)o=e[r],o.label=On(i.callback,[o.value,r,e],this)}afterTickToLabelConversion(){On(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){On(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let e=this.options,i=e.ticks,r=Yfe(this.ticks.length,e.ticks.maxTicksLimit),n=i.minRotation||0,o=i.maxRotation,s=n,a,c,d;if(!this._isVisible()||!i.display||n>=o||r<=1||!this.isHorizontal()){this.labelRotation=n;return}let u=this._getLabelSizes(),h=u.widest.width,p=u.highest.height,f=Hs(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/r:f/(r-1),h+6>a&&(a=f/(r-(e.offset?.5:1)),c=this.maxHeight-UA(e.grid)-i.padding-Gfe(e.title,this.chart.options.font),d=Math.sqrt(h*h+p*p),s=fF(Math.min(Math.asin(Hs((u.highest.height+6)/a,-1,1)),Math.asin(Hs(c/d,-1,1))-Math.asin(Hs(p/d,-1,1)))),s=Math.max(n,Math.min(o,s))),this.labelRotation=s}afterCalculateLabelRotation(){On(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){On(this.options.beforeFit,[this])}fit(){let e={width:0,height:0},{chart:i,options:{ticks:r,title:n,grid:o}}=this,s=this._isVisible(),a=this.isHorizontal();if(s){let c=Gfe(n,i.options.font);if(a?(e.width=this.maxWidth,e.height=UA(o)+c):(e.height=this.maxHeight,e.width=UA(o)+c),r.display&&this.ticks.length){let{first:d,last:u,widest:h,highest:p}=this._getLabelSizes(),f=r.padding*2,m=qd(this.labelRotation),g=Math.cos(m),y=Math.sin(m);if(a){let w=r.mirror?0:y*h.width+g*p.height;e.height=Math.min(this.maxHeight,e.height+w+f)}else{let w=r.mirror?0:g*h.width+y*p.height;e.width=Math.min(this.maxWidth,e.width+w+f)}this._calculatePadding(d,u,y,g)}}this._handleMargins(),a?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,i,r,n){let{ticks:{align:o,padding:s},position:a}=this.options,c=this.labelRotation!==0,d=a!=="top"&&this.axis==="x";if(this.isHorizontal()){let u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1),p=0,f=0;c?d?(p=n*e.width,f=r*i.height):(p=r*e.height,f=n*i.width):o==="start"?f=i.width:o==="end"?p=e.width:o!=="inner"&&(p=e.width/2,f=i.width/2),this.paddingLeft=Math.max((p-u+s)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-h+s)*this.width/(this.width-h),0)}else{let u=i.height/2,h=e.height/2;o==="start"?(u=0,h=e.height):o==="end"&&(u=i.height,h=0),this.paddingTop=u+s,this.paddingBottom=h+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){On(this.options.afterFit,[this])}isHorizontal(){let{axis:e,position:i}=this.options;return i==="top"||i==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let i,r;for(i=0,r=e.length;i<r;i++)kr(e[i].label)&&(e.splice(i,1),r--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){let i=this.options.ticks.sampleSize,r=this.ticks;i<r.length&&(r=$fe(r,i)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,i,r){let{ctx:n,_longestTextCache:o}=this,s=[],a=[],c=Math.floor(i/Yfe(i,r)),d=0,u=0,h,p,f,m,g,y,w,x,T,M,B;for(h=0;h<i;h+=c){if(m=e[h].label,g=this._resolveTickFontOptions(h),n.font=y=g.string,w=o[y]=o[y]||{data:{},gc:[]},x=g.lineHeight,T=M=0,!kr(m)&&!Un(m))T=LA(n,w.data,w.gc,T,m),M=x;else if(Un(m))for(p=0,f=m.length;p<f;++p)B=m[p],!kr(B)&&!Un(B)&&(T=LA(n,w.data,w.gc,T,B),M+=x);s.push(T),a.push(M),d=Math.max(T,d),u=Math.max(M,u)}tQe(o,i);let G=s.indexOf(d),F=a.indexOf(u),O=V=>({width:s[V]||0,height:a[V]||0});return{first:O(0),last:O(i-1),widest:O(G),highest:O(F),widths:s,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,i){return NaN}getValueForPixel(e){}getPixelForTick(e){let i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);let i=this._startPixel+e*this._length;return sfe(this._alignToPixels?vv(this.chart,i,0):i)}getDecimalForPixel(e){let i=(e-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:e,max:i}=this;return e<0&&i<0?i:e>0&&i>0?e:0}getContext(e){let i=this.ticks||[];if(e>=0&&e<i.length){let r=i[e];return r.$context||(r.$context=rQe(this.getContext(),e,r))}return this.$context||(this.$context=iQe(this.chart.getContext(),this))}_tickSize(){let e=this.options.ticks,i=qd(this.labelRotation),r=Math.abs(Math.cos(i)),n=Math.abs(Math.sin(i)),o=this._getLabelSizes(),s=e.autoSkipPadding||0,a=o?o.widest.width+s:0,c=o?o.highest.height+s:0;return this.isHorizontal()?c*r>a*n?a/r:c/n:c*n<a*r?c/r:a/n}_isVisible(){let e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){let i=this.axis,r=this.chart,n=this.options,{grid:o,position:s,border:a}=n,c=o.offset,d=this.isHorizontal(),h=this.ticks.length+(c?1:0),p=UA(o),f=[],m=a.setContext(this.getContext()),g=m.display?m.width:0,y=g/2,w=function(W){return vv(r,W,g)},x,T,M,B,G,F,O,V,J,N,P,$;if(s==="top")x=w(this.bottom),F=this.bottom-p,V=x-y,N=w(e.top)+y,$=e.bottom;else if(s==="bottom")x=w(this.top),N=e.top,$=w(e.bottom)-y,F=x+y,V=this.top+p;else if(s==="left")x=w(this.right),G=this.right-p,O=x-y,J=w(e.left)+y,P=e.right;else if(s==="right")x=w(this.left),J=e.left,P=w(e.right)-y,G=x+y,O=this.left+p;else if(i==="x"){if(s==="center")x=w((e.top+e.bottom)/2+.5);else if(wr(s)){let W=Object.keys(s)[0],ee=s[W];x=w(this.chart.scales[W].getPixelForValue(ee))}N=e.top,$=e.bottom,F=x+y,V=F+p}else if(i==="y"){if(s==="center")x=w((e.left+e.right)/2);else if(wr(s)){let W=Object.keys(s)[0],ee=s[W];x=w(this.chart.scales[W].getPixelForValue(ee))}G=x-y,O=G-p,J=e.left,P=e.right}let K=Ki(n.ticks.maxTicksLimit,h),ve=Math.max(1,Math.ceil(h/K));for(T=0;T<h;T+=ve){let W=this.getContext(T),ee=o.setContext(W),te=a.setContext(W),se=ee.lineWidth,Ae=ee.color,k=te.dash||[],S=te.dashOffset,I=ee.tickWidth,X=ee.tickColor,Q=ee.tickBorderDash||[],le=ee.tickBorderDashOffset;M=eQe(this,T,c),M!==void 0&&(B=vv(r,M,se),d?G=O=J=P=B:F=V=N=$=B,f.push({tx1:G,ty1:F,tx2:O,ty2:V,x1:J,y1:N,x2:P,y2:$,width:se,color:Ae,borderDash:k,borderDashOffset:S,tickWidth:I,tickColor:X,tickBorderDash:Q,tickBorderDashOffset:le}))}return this._ticksLength=h,this._borderValue=x,f}_computeLabelItems(e){let i=this.axis,r=this.options,{position:n,ticks:o}=r,s=this.isHorizontal(),a=this.ticks,{align:c,crossAlign:d,padding:u,mirror:h}=o,p=UA(r.grid),f=p+u,m=h?-u:f,g=-qd(this.labelRotation),y=[],w,x,T,M,B,G,F,O,V,J,N,P,$="middle";if(n==="top")G=this.bottom-m,F=this._getXAxisLabelAlignment();else if(n==="bottom")G=this.top+m,F=this._getXAxisLabelAlignment();else if(n==="left"){let ve=this._getYAxisLabelAlignment(p);F=ve.textAlign,B=ve.x}else if(n==="right"){let ve=this._getYAxisLabelAlignment(p);F=ve.textAlign,B=ve.x}else if(i==="x"){if(n==="center")G=(e.top+e.bottom)/2+f;else if(wr(n)){let ve=Object.keys(n)[0],W=n[ve];G=this.chart.scales[ve].getPixelForValue(W)+f}F=this._getXAxisLabelAlignment()}else if(i==="y"){if(n==="center")B=(e.left+e.right)/2-f;else if(wr(n)){let ve=Object.keys(n)[0],W=n[ve];B=this.chart.scales[ve].getPixelForValue(W)}F=this._getYAxisLabelAlignment(p).textAlign}i==="y"&&(c==="start"?$="top":c==="end"&&($="bottom"));let K=this._getLabelSizes();for(w=0,x=a.length;w<x;++w){T=a[w],M=T.label;let ve=o.setContext(this.getContext(w));O=this.getPixelForTick(w)+o.labelOffset,V=this._resolveTickFontOptions(w),J=V.lineHeight,N=Un(M)?M.length:1;let W=N/2,ee=ve.color,te=ve.textStrokeColor,se=ve.textStrokeWidth,Ae=F;s?(B=O,F==="inner"&&(w===x-1?Ae=this.options.reverse?"left":"right":w===0?Ae=this.options.reverse?"right":"left":Ae="center"),n==="top"?d==="near"||g!==0?P=-N*J+J/2:d==="center"?P=-K.highest.height/2-W*J+J:P=-K.highest.height+J/2:d==="near"||g!==0?P=J/2:d==="center"?P=K.highest.height/2-W*J:P=K.highest.height-N*J,h&&(P*=-1),g!==0&&!ve.showLabelBackdrop&&(B+=J/2*Math.sin(g))):(G=O,P=(1-N)*J/2);let k;if(ve.showLabelBackdrop){let S=Ma(ve.backdropPadding),I=K.heights[w],X=K.widths[w],Q=P-S.top,le=0-S.left;switch($){case"middle":Q-=I/2;break;case"bottom":Q-=I;break}switch(F){case"center":le-=X/2;break;case"right":le-=X;break;case"inner":w===x-1?le-=X:w>0&&(le-=X/2);break}k={left:le,top:Q,width:X+S.width,height:I+S.height,color:ve.backdropColor}}y.push({label:M,font:V,textOffset:P,options:{rotation:g,color:ee,strokeColor:te,strokeWidth:se,textAlign:Ae,textBaseline:$,translation:[B,G],backdrop:k}})}return y}_getXAxisLabelAlignment(){let{position:e,ticks:i}=this.options;if(-qd(this.labelRotation))return e==="top"?"left":"right";let n="center";return i.align==="start"?n="left":i.align==="end"?n="right":i.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(e){let{position:i,ticks:{crossAlign:r,mirror:n,padding:o}}=this.options,s=this._getLabelSizes(),a=e+o,c=s.widest.width,d,u;return i==="left"?n?(u=this.right+o,r==="near"?d="left":r==="center"?(d="center",u+=c/2):(d="right",u+=c)):(u=this.right-a,r==="near"?d="right":r==="center"?(d="center",u-=c/2):(d="left",u=this.left)):i==="right"?n?(u=this.left+o,r==="near"?d="right":r==="center"?(d="center",u-=c/2):(d="left",u-=c)):(u=this.left+a,r==="near"?d="left":r==="center"?(d="center",u+=c/2):(d="right",u=this.right)):d="right",{textAlign:d,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;let e=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){let{ctx:e,options:{backgroundColor:i},left:r,top:n,width:o,height:s}=this;i&&(e.save(),e.fillStyle=i,e.fillRect(r,n,o,s),e.restore())}getLineWidthForValue(e){let i=this.options.grid;if(!this._isVisible()||!i.display)return 0;let n=this.ticks.findIndex(o=>o.value===e);return n>=0?i.setContext(this.getContext(n)).lineWidth:0}drawGrid(e){let i=this.options.grid,r=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e)),o,s,a=(c,d,u)=>{!u.width||!u.color||(r.save(),r.lineWidth=u.width,r.strokeStyle=u.color,r.setLineDash(u.borderDash||[]),r.lineDashOffset=u.borderDashOffset,r.beginPath(),r.moveTo(c.x,c.y),r.lineTo(d.x,d.y),r.stroke(),r.restore())};if(i.display)for(o=0,s=n.length;o<s;++o){let c=n[o];i.drawOnChartArea&&a({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),i.drawTicks&&a({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){let{chart:e,ctx:i,options:{border:r,grid:n}}=this,o=r.setContext(this.getContext()),s=r.display?o.width:0;if(!s)return;let a=n.setContext(this.getContext(0)).lineWidth,c=this._borderValue,d,u,h,p;this.isHorizontal()?(d=vv(e,this.left,s)-s/2,u=vv(e,this.right,a)+a/2,h=p=c):(h=vv(e,this.top,s)-s/2,p=vv(e,this.bottom,a)+a/2,d=u=c),i.save(),i.lineWidth=o.width,i.strokeStyle=o.color,i.beginPath(),i.moveTo(d,h),i.lineTo(u,p),i.stroke(),i.restore()}drawLabels(e){if(!this.options.ticks.display)return;let r=this.ctx,n=this._computeLabelArea();n&&BA(r,n);let o=this.getLabelItems(e);for(let s of o){let a=s.options,c=s.font,d=s.label,u=s.textOffset;bv(r,d,0,u,c,a)}n&&VA(r)}drawTitle(){let{ctx:e,options:{position:i,title:r,reverse:n}}=this;if(!r.display)return;let o=Cs(r.font),s=Ma(r.padding),a=r.align,c=o.lineHeight/2;i==="bottom"||i==="center"||wr(i)?(c+=s.bottom,Un(r.text)&&(c+=o.lineHeight*(r.text.length-1))):c+=s.top;let{titleX:d,titleY:u,maxWidth:h,rotation:p}=oQe(this,c,i,a);bv(e,r.text,0,0,o,{color:r.color,maxWidth:h,rotation:p,textAlign:nQe(a,i,n),textBaseline:"middle",translation:[d,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){let e=this.options,i=e.ticks&&e.ticks.z||0,r=Ki(e.grid&&e.grid.z,-1),n=Ki(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==t.prototype.draw?[{z:i,draw:o=>{this.draw(o)}}]:[{z:r,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:i,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){let i=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",n=[],o,s;for(o=0,s=i.length;o<s;++o){let a=i[o];a[r]===this.id&&(!e||a.type===e)&&n.push(a)}return n}_resolveTickFontOptions(e){let i=this.options.ticks.setContext(this.getContext(e));return Cs(i.font)}_maxDigits(){let e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}},Nx=class{constructor(e,i,r){this.type=e,this.scope=i,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){let i=Object.getPrototypeOf(e),r;lQe(i)&&(r=this.register(i));let n=this.items,o=e.id,s=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in n||(n[o]=e,sQe(e,s,r),this.override&&to.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){let i=this.items,r=e.id,n=this.scope;r in i&&delete i[r],n&&r in to[n]&&(delete to[n][r],this.override&&delete gv[r])}};function sQe(t,e,i){let r=Sx(Object.create(null),[i?to.get(i):{},to.get(e),t.defaults]);to.set(e,r),t.defaultRoutes&&aQe(e,t.defaultRoutes),t.descriptors&&to.describe(e,t.descriptors)}function aQe(t,e){Object.keys(e).forEach(i=>{let r=i.split("."),n=r.pop(),o=[t].concat(r).join("."),s=e[i].split("."),a=s.pop(),c=s.join(".");to.route(o,n,c,a)})}function lQe(t){return"id"in t&&"defaults"in t}var Tq=class{constructor(){this.controllers=new Nx(Cv,"datasets",!0),this.elements=new Nx($u,"elements"),this.plugins=new Nx(Object,"plugins"),this.scales=new Nx(V_,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,i,r){[...i].forEach(n=>{let o=r||this._getRegistryForType(n);r||o.isForType(n)||o===this.plugins&&n.id?this._exec(e,o,n):an(n,s=>{let a=r||this._getRegistryForType(s);this._exec(e,a,s)})})}_exec(e,i,r){let n=hF(e);On(r["before"+n],[],r),i[e](r),On(r["after"+n],[],r)}_getRegistryForType(e){for(let i=0;i<this._typedRegistries.length;i++){let r=this._typedRegistries[i];if(r.isForType(e))return r}return this.plugins}_get(e,i,r){let n=i.get(e);if(n===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return n}},Cf=new Tq,Rq=class{constructor(){this._init=[]}notify(e,i,r,n){i==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));let o=n?this._descriptors(e).filter(n):this._descriptors(e),s=this._notify(o,e,i,r);return i==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),s}_notify(e,i,r,n){n=n||{};for(let o of e){let s=o.plugin,a=s[r],c=[i,n,o.options];if(On(a,c,s)===!1&&n.cancelable)return!1}return!0}invalidate(){kr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;let i=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),i}_createDescriptors(e,i){let r=e&&e.config,n=Ki(r.options&&r.options.plugins,{}),o=cQe(r);return n===!1&&!i?[]:uQe(e,o,n,i)}_notifyStateChanges(e){let i=this._oldCache||[],r=this._cache,n=(o,s)=>o.filter(a=>!s.some(c=>a.plugin.id===c.plugin.id));this._notify(n(i,r),e,"stop"),this._notify(n(r,i),e,"start")}};function cQe(t){let e={},i=[],r=Object.keys(Cf.plugins.items);for(let o=0;o<r.length;o++)i.push(Cf.getPlugin(r[o]));let n=t.plugins||[];for(let o=0;o<n.length;o++){let s=n[o];i.indexOf(s)===-1&&(i.push(s),e[s.id]=!0)}return{plugins:i,localIds:e}}function dQe(t,e){return!e&&t===!1?null:t===!0?{}:t}function uQe(t,{plugins:e,localIds:i},r,n){let o=[],s=t.getContext();for(let a of e){let c=a.id,d=dQe(r[c],n);d!==null&&o.push({plugin:a,options:hQe(t.config,{plugin:a,local:i[c]},d,s)})}return o}function hQe(t,{plugin:e,local:i},r,n){let o=t.pluginScopeKeys(e),s=t.getOptionScopes(r,o);return i&&e.defaults&&s.push(e.defaults),t.createResolver(s,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Aq(t,e){let i=to.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function fQe(t,e){let i=t;return t==="_index_"?i=e:t==="_value_"&&(i=e==="x"?"y":"x"),i}function pQe(t,e){return t===e?"_index_":"_value_"}function Xfe(t){if(t==="x"||t==="y"||t==="r")return t}function mQe(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Iq(t,...e){if(Xfe(t))return t;for(let i of e){let r=i.axis||mQe(i.position)||t.length>1&&Xfe(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Kfe(t,e,i){if(i[e+"AxisID"]===t)return{axis:e}}function gQe(t,e){if(e.data&&e.data.datasets){let i=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(i.length)return Kfe(t,"x",i[0])||Kfe(t,"y",i[0])}return{}}function vQe(t,e){let i=gv[t.type]||{scales:{}},r=e.scales||{},n=Aq(t.type,e),o=Object.create(null);return Object.keys(r).forEach(s=>{let a=r[s];if(!wr(a))return console.error(`Invalid scale configuration for scale: ${s}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${s}`);let c=Iq(s,a,gQe(s,t),to.scales[a.type]),d=pQe(c,n),u=i.scales||{};o[s]=Tx(Object.create(null),[{axis:c},a,u[c],u[d]])}),t.data.datasets.forEach(s=>{let a=s.type||t.type,c=s.indexAxis||Aq(a,e),u=(gv[a]||{}).scales||{};Object.keys(u).forEach(h=>{let p=fQe(h,c),f=s[p+"AxisID"]||p;o[f]=o[f]||Object.create(null),Tx(o[f],[{axis:p},r[f],u[h]])})}),Object.keys(o).forEach(s=>{let a=o[s];Tx(a,[to.scales[a.type],to.scale])}),o}function Fpe(t){let e=t.options||(t.options={});e.plugins=Ki(e.plugins,{}),e.scales=vQe(t,e)}function Hpe(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function bQe(t){return t=t||{},t.data=Hpe(t.data),Fpe(t),t}var Zfe=new Map,Bpe=new Set;function EF(t,e){let i=Zfe.get(t);return i||(i=e(),Zfe.set(t,i),Bpe.add(i)),i}var qA=(t,e,i)=>{let r=om(e,i);r!==void 0&&t.add(r)},Dq=class{constructor(e){this._config=bQe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Hpe(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){let e=this._config;this.clearCache(),Fpe(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return EF(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,i){return EF(`${e}.transition.${i}`,()=>[[`datasets.${e}.transitions.${i}`,`transitions.${i}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,i){return EF(`${e}-${i}`,()=>[[`datasets.${e}.elements.${i}`,`datasets.${e}`,`elements.${i}`,""]])}pluginScopeKeys(e){let i=e.id,r=this.type;return EF(`${r}-plugin-${i}`,()=>[[`plugins.${i}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,i){let r=this._scopeCache,n=r.get(e);return(!n||i)&&(n=new Map,r.set(e,n)),n}getOptionScopes(e,i,r){let{options:n,type:o}=this,s=this._cachedScopes(e,r),a=s.get(i);if(a)return a;let c=new Set;i.forEach(u=>{e&&(c.add(e),u.forEach(h=>qA(c,e,h))),u.forEach(h=>qA(c,n,h)),u.forEach(h=>qA(c,gv[o]||{},h)),u.forEach(h=>qA(c,to,h)),u.forEach(h=>qA(c,gF,h))});let d=Array.from(c);return d.length===0&&d.push(Object.create(null)),Bpe.has(i)&&s.set(i,d),d}chartOptionScopes(){let{options:e,type:i}=this;return[e,gv[i]||{},to.datasets[i]||{},{type:i},to,gF]}resolveNamedOptions(e,i,r,n=[""]){let o={$shared:!0},{resolver:s,subPrefixes:a}=Qfe(this._resolverCache,e,n),c=s;if(yQe(s,i)){o.$shared=!1,r=rm(r)?r():r;let d=this.createResolver(e,r,a);c=P_(s,r,d)}for(let d of i)o[d]=c[d];return o}createResolver(e,i,r=[""],n){let{resolver:o}=Qfe(this._resolverCache,e,r);return wr(i)?P_(o,i,void 0,n):o}};function Qfe(t,e,i){let r=t.get(e);r||(r=new Map,t.set(e,r));let n=i.join(),o=r.get(n);return o||(o={resolver:_F(e,i),subPrefixes:i.filter(a=>!a.toLowerCase().includes("hover"))},r.set(n,o)),o}var _Qe=t=>wr(t)&&Object.getOwnPropertyNames(t).some(e=>rm(t[e]));function yQe(t,e){let{isScriptable:i,isIndexable:r}=iq(t);for(let n of e){let o=i(n),s=r(n),a=(s||o)&&t[n];if(o&&(rm(a)||_Qe(a))||s&&Un(a))return!0}return!1}var wQe="4.4.3",CQe=["top","bottom","left","right","chartArea"];function Jfe(t,e){return t==="top"||t==="bottom"||CQe.indexOf(t)===-1&&e==="x"}function epe(t,e){return function(i,r){return i[t]===r[t]?i[e]-r[e]:i[t]-r[t]}}function tpe(t){let e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),On(i&&i.onComplete,[t],e)}function xQe(t){let e=t.chart,i=e.options.animation;On(i&&i.onProgress,[t],e)}function Vpe(t){return yF()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}var MF={},ipe=t=>{let e=Vpe(t);return Object.values(MF).filter(i=>i.canvas===e).pop()};function SQe(t,e,i){let r=Object.keys(t);for(let n of r){let o=+n;if(o>=e){let s=t[n];delete t[n],(i>0||o>e)&&(t[o+i]=s)}}}function EQe(t,e,i,r){return!i||t.type==="mouseout"?null:r?e:t}function TF(t,e,i){return t.options.clip?t[i]:e[i]}function TQe(t,e){let{xScale:i,yScale:r}=t;return i&&r?{left:TF(i,e,"left"),right:TF(i,e,"right"),top:TF(r,e,"top"),bottom:TF(r,e,"bottom")}:e}var Lx=(()=>{class t{static defaults=to;static instances=MF;static overrides=gv;static registry=Cf;static version=wQe;static getChart=ipe;static register(...i){Cf.add(...i),rpe()}static unregister(...i){Cf.remove(...i),rpe()}constructor(i,r){let n=this.config=new Dq(r),o=Vpe(i),s=ipe(o);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");let a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||YZe(o)),this.platform.updateConfig(n);let c=this.platform.acquireContext(o,a.aspectRatio),d=c&&c.canvas,u=d&&d.height,h=d&&d.width;if(this.id=efe(),this.ctx=c,this.canvas=d,this.width=h,this.height=u,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Rq,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=ufe(p=>this.update(p),a.resizeDelay||0),this._dataChanges=[],MF[this.id]=this,!c||!d){console.error("Failed to create chart: can't acquire context from the given item");return}am.listen(this,"complete",tpe),am.listen(this,"progress",xQe),this._initialize(),this.attached&&this.update()}get aspectRatio(){let{options:{aspectRatio:i,maintainAspectRatio:r},width:n,height:o,_aspectRatio:s}=this;return kr(i)?r&&s?s:o?n/o:null:i}get data(){return this.config.data}set data(i){this.config.data=i}get options(){return this._options}set options(i){this.config.options=i}get registry(){return Cf}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():sq(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return JU(this.canvas,this.ctx),this}stop(){return am.stop(this),this}resize(i,r){am.running(this)?this._resizeBeforeDraw={width:i,height:r}:this._resize(i,r)}_resize(i,r){let n=this.options,o=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(o,i,r,s),c=n.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,sq(this,c,!0)&&(this.notifyPlugins("resize",{size:a}),On(n.onResize,[this,a],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){let r=this.options.scales||{};an(r,(n,o)=>{n.id=o})}buildOrUpdateScales(){let i=this.options,r=i.scales,n=this.scales,o=Object.keys(n).reduce((a,c)=>(a[c]=!1,a),{}),s=[];r&&(s=s.concat(Object.keys(r).map(a=>{let c=r[a],d=Iq(a,c),u=d==="r",h=d==="x";return{options:c,dposition:u?"chartArea":h?"bottom":"left",dtype:u?"radialLinear":h?"category":"linear"}}))),an(s,a=>{let c=a.options,d=c.id,u=Iq(d,c),h=Ki(c.type,a.dtype);(c.position===void 0||Jfe(c.position,u)!==Jfe(a.dposition))&&(c.position=a.dposition),o[d]=!0;let p=null;if(d in n&&n[d].type===h)p=n[d];else{let f=Cf.getScale(h);p=new f({id:d,type:h,ctx:this.ctx,chart:this}),n[p.id]=p}p.init(c,i)}),an(o,(a,c)=>{a||delete n[c]}),an(n,a=>{ol.configure(this,a,a.options),ol.addBox(this,a)})}_updateMetasets(){let i=this._metasets,r=this.data.datasets.length,n=i.length;if(i.sort((o,s)=>o.index-s.index),n>r){for(let o=r;o<n;++o)this._destroyDatasetMeta(o);i.splice(r,n-r)}this._sortedMetasets=i.slice(0).sort(epe("order","index"))}_removeUnreferencedMetasets(){let{_metasets:i,data:{datasets:r}}=this;i.length>r.length&&delete this._stacks,i.forEach((n,o)=>{r.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(o)})}buildOrUpdateControllers(){let i=[],r=this.data.datasets,n,o;for(this._removeUnreferencedMetasets(),n=0,o=r.length;n<o;n++){let s=r[n],a=this.getDatasetMeta(n),c=s.type||this.config.type;if(a.type&&a.type!==c&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=c,a.indexAxis=s.indexAxis||Aq(c,this.options),a.order=s.order||0,a.index=n,a.label=""+s.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{let d=Cf.getController(c),{datasetElementType:u,dataElementType:h}=to.datasets[c];Object.assign(d,{dataElementType:Cf.getElement(h),datasetElementType:u&&Cf.getElement(u)}),a.controller=new d(this,n),i.push(a.controller)}}return this._updateMetasets(),i}_resetElements(){an(this.data.datasets,(i,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(i){let r=this.config;r.update();let n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),o=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:i,cancelable:!0})===!1)return;let s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let u=0,h=this.data.datasets.length;u<h;u++){let{controller:p}=this.getDatasetMeta(u),f=!o&&s.indexOf(p)===-1;p.buildOrUpdateElements(f),a=Math.max(+p.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),o||an(s,u=>{u.reset()}),this._updateDatasets(i),this.notifyPlugins("afterUpdate",{mode:i}),this._layers.sort(epe("z","_idx"));let{_active:c,_lastEvent:d}=this;d?this._eventHandler(d,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){an(this.scales,i=>{ol.removeBox(this,i)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let i=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(i.events);(!VU(r,n)||!!this._responsiveListeners!==i.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:i}=this,r=this._getUniformDataChanges()||[];for(let{method:n,start:o,count:s}of r){let a=n==="_removeElements"?-s:s;SQe(i,o,a)}}_getUniformDataChanges(){let i=this._dataChanges;if(!i||!i.length)return;this._dataChanges=[];let r=this.data.datasets.length,n=s=>new Set(i.filter(a=>a[0]===s).map((a,c)=>c+","+a.splice(1).join(","))),o=n(0);for(let s=1;s<r;s++)if(!VU(o,n(s)))return;return Array.from(o).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(i){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ol.update(this,this.width,this.height,i);let r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],an(this.boxes,o=>{n&&o.position==="chartArea"||(o.configure&&o.configure(),this._layers.push(...o._layers()))},this),this._layers.forEach((o,s)=>{o._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(i){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:i,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,rm(i)?i({datasetIndex:r}):i);this.notifyPlugins("afterDatasetsUpdate",{mode:i})}}_updateDataset(i,r){let n=this.getDatasetMeta(i),o={meta:n,index:i,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",o)!==!1&&(n.controller._update(r),o.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",o))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(am.has(this)?this.attached&&!am.running(this)&&am.start(this):(this.draw(),tpe({chart:this})))}draw(){let i;if(this._resizeBeforeDraw){let{width:n,height:o}=this._resizeBeforeDraw;this._resize(n,o),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;let r=this._layers;for(i=0;i<r.length&&r[i].z<=0;++i)r[i].draw(this.chartArea);for(this._drawDatasets();i<r.length;++i)r[i].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(i){let r=this._sortedMetasets,n=[],o,s;for(o=0,s=r.length;o<s;++o){let a=r[o];(!i||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;let i=this.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r)this._drawDataset(i[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(i){let r=this.ctx,n=i._clip,o=!n.disabled,s=TQe(i,this.chartArea),a={meta:i,index:i.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(o&&BA(r,{left:n.left===!1?0:s.left-n.left,right:n.right===!1?this.width:s.right+n.right,top:n.top===!1?0:s.top-n.top,bottom:n.bottom===!1?this.height:s.bottom+n.bottom}),i.controller.draw(),o&&VA(r),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(i){return bf(i,this.chartArea,this._minPadding)}getElementsAtEventForMode(i,r,n,o){let s=RZe.modes[r];return typeof s=="function"?s(this,i,n,o):[]}getDatasetMeta(i){let r=this.data.datasets[i],n=this._metasets,o=n.filter(s=>s&&s._dataset===r).pop();return o||(o={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:i,_dataset:r,_parsed:[],_sorted:!1},n.push(o)),o}getContext(){return this.$context||(this.$context=sm(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(i){let r=this.data.datasets[i];if(!r)return!1;let n=this.getDatasetMeta(i);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(i,r){let n=this.getDatasetMeta(i);n.hidden=!r}toggleDataVisibility(i){this._hiddenIndices[i]=!this._hiddenIndices[i]}getDataVisibility(i){return!this._hiddenIndices[i]}_updateVisibility(i,r,n){let o=n?"show":"hide",s=this.getDatasetMeta(i),a=s.controller._resolveAnimations(void 0,o);Rx(r)?(s.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(i,n),a.update(s,{visible:n}),this.update(c=>c.datasetIndex===i?o:void 0))}hide(i,r){this._updateVisibility(i,r,!1)}show(i,r){this._updateVisibility(i,r,!0)}_destroyDatasetMeta(i){let r=this._metasets[i];r&&r.controller&&r.controller._destroy(),delete this._metasets[i]}_stop(){let i,r;for(this.stop(),am.remove(this),i=0,r=this.data.datasets.length;i<r;++i)this._destroyDatasetMeta(i)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:i,ctx:r}=this;this._stop(),this.config.clearCache(),i&&(this.unbindEvents(),JU(i,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete MF[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...i){return this.canvas.toDataURL(...i)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let i=this._listeners,r=this.platform,n=(s,a)=>{r.addEventListener(this,s,a),i[s]=a},o=(s,a,c)=>{s.offsetX=a,s.offsetY=c,this._eventHandler(s)};an(this.options.events,s=>n(s,o))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});let i=this._responsiveListeners,r=this.platform,n=(d,u)=>{r.addEventListener(this,d,u),i[d]=u},o=(d,u)=>{i[d]&&(r.removeEventListener(this,d,u),delete i[d])},s=(d,u)=>{this.canvas&&this.resize(d,u)},a,c=()=>{o("attach",c),this.attached=!0,this.resize(),n("resize",s),n("detach",a)};a=()=>{this.attached=!1,o("resize",s),this._stop(),this._resize(0,0),n("attach",c)},r.isAttached(this.canvas)?c():a()}unbindEvents(){an(this._listeners,(i,r)=>{this.platform.removeEventListener(this,r,i)}),this._listeners={},an(this._responsiveListeners,(i,r)=>{this.platform.removeEventListener(this,r,i)}),this._responsiveListeners=void 0}updateHoverStyle(i,r,n){let o=n?"set":"remove",s,a,c,d;for(r==="dataset"&&(s=this.getDatasetMeta(i[0].datasetIndex),s.controller["_"+o+"DatasetHoverStyle"]()),c=0,d=i.length;c<d;++c){a=i[c];let u=a&&this.getDatasetMeta(a.datasetIndex).controller;u&&u[o+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(i){let r=this._active||[],n=i.map(({datasetIndex:s,index:a})=>{let c=this.getDatasetMeta(s);if(!c)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:c.data[a],index:a}});!FA(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(i,r,n){return this._plugins.notify(this,i,r,n)}isPluginEnabled(i){return this._plugins._cache.filter(r=>r.plugin.id===i).length===1}_updateHoverStyles(i,r,n){let o=this.options.hover,s=(d,u)=>d.filter(h=>!u.some(p=>h.datasetIndex===p.datasetIndex&&h.index===p.index)),a=s(r,i),c=n?i:s(i,r);a.length&&this.updateHoverStyle(a,o.mode,!1),c.length&&o.mode&&this.updateHoverStyle(c,o.mode,!0)}_eventHandler(i,r){let n={event:i,replay:r,cancelable:!0,inChartArea:this.isPointInArea(i)},o=a=>(a.options.events||this.options.events).includes(i.native.type);if(this.notifyPlugins("beforeEvent",n,o)===!1)return;let s=this._handleEvent(i,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,o),(s||n.changed)&&this.render(),this}_handleEvent(i,r,n){let{_active:o=[],options:s}=this,a=r,c=this._getActiveElements(i,o,n,a),d=rfe(i),u=EQe(i,this._lastEvent,n,d);n&&(this._lastEvent=null,On(s.onHover,[i,c,this],this),d&&On(s.onClick,[i,c,this],this));let h=!FA(c,o);return(h||r)&&(this._active=c,this._updateHoverStyles(c,o,r)),this._lastEvent=u,h}_getActiveElements(i,r,n,o){if(i.type==="mouseout")return[];if(!n)return r;let s=this.options.hover;return this.getElementsAtEventForMode(i,s.mode,s,o)}}return t})();function rpe(){return an(Lx.instances,t=>t._plugins.invalidate())}function RQe(t,e,i){let{startAngle:r,pixelMargin:n,x:o,y:s,outerRadius:a,innerRadius:c}=e,d=n/a;t.beginPath(),t.arc(o,s,a,r-d,i+d),c>n?(d=n/c,t.arc(o,s,c,i+d,r-d,!0)):t.arc(o,s,n,i+zo,r-zo),t.closePath(),t.clip()}function AQe(t){return bF(t,["outerStart","outerEnd","innerStart","innerEnd"])}function IQe(t,e,i,r){let n=AQe(t.options.borderRadius),o=(i-e)/2,s=Math.min(o,r*e/2),a=c=>{let d=(i-Math.min(o,c))*r/2;return Hs(c,0,Math.min(o,d))};return{outerStart:a(n.outerStart),outerEnd:a(n.outerEnd),innerStart:Hs(n.innerStart,0,s),innerEnd:Hs(n.innerEnd,0,s)}}function Ox(t,e,i,r){return{x:i+t*Math.cos(e),y:r+t*Math.sin(e)}}function PF(t,e,i,r,n,o){let{x:s,y:a,startAngle:c,pixelMargin:d,innerRadius:u}=e,h=Math.max(e.outerRadius+r+i-d,0),p=u>0?u+r+i+d:0,f=0,m=n-c;if(r){let ve=u>0?u-r:0,W=h>0?h-r:0,ee=(ve+W)/2,te=ee!==0?m*ee/(ee+r):m;f=(m-te)/2}let g=Math.max(.001,m*h-i/qn)/h,y=(m-g)/2,w=c+y+f,x=n-y-f,{outerStart:T,outerEnd:M,innerStart:B,innerEnd:G}=IQe(e,p,h,x-w),F=h-T,O=h-M,V=w+T/F,J=x-M/O,N=p+B,P=p+G,$=w+B/N,K=x-G/P;if(t.beginPath(),o){let ve=(V+J)/2;if(t.arc(s,a,h,V,ve),t.arc(s,a,h,ve,J),M>0){let se=Ox(O,J,s,a);t.arc(se.x,se.y,M,J,x+zo)}let W=Ox(P,x,s,a);if(t.lineTo(W.x,W.y),G>0){let se=Ox(P,K,s,a);t.arc(se.x,se.y,G,x+zo,K+Math.PI)}let ee=(x-G/p+(w+B/p))/2;if(t.arc(s,a,p,x-G/p,ee,!0),t.arc(s,a,p,ee,w+B/p,!0),B>0){let se=Ox(N,$,s,a);t.arc(se.x,se.y,B,$+Math.PI,w-zo)}let te=Ox(F,w,s,a);if(t.lineTo(te.x,te.y),T>0){let se=Ox(F,V,s,a);t.arc(se.x,se.y,T,w-zo,V)}}else{t.moveTo(s,a);let ve=Math.cos(V)*h+s,W=Math.sin(V)*h+a;t.lineTo(ve,W);let ee=Math.cos(J)*h+s,te=Math.sin(J)*h+a;t.lineTo(ee,te)}t.closePath()}function DQe(t,e,i,r,n){let{fullCircles:o,startAngle:s,circumference:a}=e,c=e.endAngle;if(o){PF(t,e,i,r,c,n);for(let d=0;d<o;++d)t.fill();isNaN(a)||(c=s+(a%Yn||Yn))}return PF(t,e,i,r,c,n),t.fill(),c}function MQe(t,e,i,r,n){let{fullCircles:o,startAngle:s,circumference:a,options:c}=e,{borderWidth:d,borderJoinStyle:u,borderDash:h,borderDashOffset:p}=c,f=c.borderAlign==="inner";if(!d)return;t.setLineDash(h||[]),t.lineDashOffset=p,f?(t.lineWidth=d*2,t.lineJoin=u||"round"):(t.lineWidth=d,t.lineJoin=u||"bevel");let m=e.endAngle;if(o){PF(t,e,i,r,m,n);for(let g=0;g<o;++g)t.stroke();isNaN(a)||(m=s+(a%Yn||Yn))}f&&RQe(t,e,m),o||(PF(t,e,i,r,m,n),t.stroke())}var Mq=class extends $u{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,i,r){let n=this.getProps(["x","y"],r),{angle:o,distance:s}=UU(n,{x:e,y:i}),{startAngle:a,endAngle:c,innerRadius:d,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),p=(this.options.spacing+this.options.borderWidth)/2,m=Ki(h,c-a)>=Yn||Ix(o,a,c),g=yf(s,d+p,u+p);return m&&g}getCenterPoint(e){let{x:i,y:r,startAngle:n,endAngle:o,innerRadius:s,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,u=(n+o)/2,h=(s+a+d+c)/2;return{x:i+Math.cos(u)*h,y:r+Math.sin(u)*h}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){let{options:i,circumference:r}=this,n=(i.offset||0)/4,o=(i.spacing||0)/2,s=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=r>Yn?Math.floor(r/Yn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();let a=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(a)*n,Math.sin(a)*n);let c=1-Math.sin(Math.min(qn,r||0)),d=n*c;e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,DQe(e,this,d,o,s),MQe(e,this,d,o,s),e.restore()}};function jpe(t,e,i=e){t.lineCap=Ki(i.borderCapStyle,e.borderCapStyle),t.setLineDash(Ki(i.borderDash,e.borderDash)),t.lineDashOffset=Ki(i.borderDashOffset,e.borderDashOffset),t.lineJoin=Ki(i.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Ki(i.borderWidth,e.borderWidth),t.strokeStyle=Ki(i.borderColor,e.borderColor)}function kQe(t,e,i){t.lineTo(i.x,i.y)}function OQe(t){return t.stepped?mfe:t.tension||t.cubicInterpolationMode==="monotone"?gfe:kQe}function zpe(t,e,i={}){let r=t.length,{start:n=0,end:o=r-1}=i,{start:s,end:a}=e,c=Math.max(n,s),d=Math.min(o,a),u=n<s&&o<s||n>a&&o>a;return{count:r,start:c,loop:e.loop,ilen:d<c&&!u?r+d-c:d-c}}function NQe(t,e,i,r){let{points:n,options:o}=e,{count:s,start:a,loop:c,ilen:d}=zpe(n,i,r),u=OQe(o),{move:h=!0,reverse:p}=r||{},f,m,g;for(f=0;f<=d;++f)m=n[(a+(p?d-f:f))%s],!m.skip&&(h?(t.moveTo(m.x,m.y),h=!1):u(t,g,m,p,o.stepped),g=m);return c&&(m=n[(a+(p?d:0))%s],u(t,g,m,p,o.stepped)),!!c}function PQe(t,e,i,r){let n=e.points,{count:o,start:s,ilen:a}=zpe(n,i,r),{move:c=!0,reverse:d}=r||{},u=0,h=0,p,f,m,g,y,w,x=M=>(s+(d?a-M:M))%o,T=()=>{g!==y&&(t.lineTo(u,y),t.lineTo(u,g),t.lineTo(u,w))};for(c&&(f=n[x(0)],t.moveTo(f.x,f.y)),p=0;p<=a;++p){if(f=n[x(p)],f.skip)continue;let M=f.x,B=f.y,G=M|0;G===m?(B<g?g=B:B>y&&(y=B),u=(h*u+M)/++h):(T(),t.lineTo(M,B),m=G,h=0,g=y=B),w=B}T()}function kq(t){let e=t.options,i=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!i?PQe:NQe}function LQe(t){return t.stepped?Efe:t.tension||t.cubicInterpolationMode==="monotone"?Tfe:mv}function FQe(t,e,i,r){let n=e._path;n||(n=e._path=new Path2D,e.path(n,i,r)&&n.closePath()),jpe(t,e.options),t.stroke(n)}function HQe(t,e,i,r){let{segments:n,options:o}=e,s=kq(e);for(let a of n)jpe(t,o,a.style),t.beginPath(),s(t,e,a,{start:i,end:i+r-1})&&t.closePath(),t.stroke()}var BQe=typeof Path2D=="function";function VQe(t,e,i,r){BQe&&!e.options.segment?FQe(t,e,i,r):HQe(t,e,i,r)}var HF=(()=>{class t extends $u{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:i=>i!=="borderDash"&&i!=="fill"};constructor(i){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,i&&Object.assign(this,i)}updateControlPoints(i,r){let n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){let o=n.spanGaps?this._loop:this._fullLoop;Cfe(this._points,n,i,o,r),this._pointsUpdated=!0}}set points(i){this._points=i,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Afe(this,this.options.segment))}first(){let i=this.segments,r=this.points;return i.length&&r[i[0].start]}last(){let i=this.segments,r=this.points,n=i.length;return n&&r[i[n-1].end]}interpolate(i,r){let n=this.options,o=i[r],s=this.points,a=uq(this,{property:r,start:o,end:o});if(!a.length)return;let c=[],d=LQe(n),u,h;for(u=0,h=a.length;u<h;++u){let{start:p,end:f}=a[u],m=s[p],g=s[f];if(m===g){c.push(m);continue}let y=Math.abs((o-m[r])/(g[r]-m[r])),w=d(m,g,y,n.stepped);w[r]=i[r],c.push(w)}return c.length===1?c[0]:c}pathSegment(i,r,n){return kq(this)(i,this,r,n)}path(i,r,n){let o=this.segments,s=kq(this),a=this._loop;r=r||0,n=n||this.points.length-r;for(let c of o)a&=s(i,this,c,{start:r,end:r+n-1});return!!a}draw(i,r,n,o){let s=this.options||{};(this.points||[]).length&&s.borderWidth&&(i.save(),VQe(i,this,n,o),i.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return t})();function npe(t,e,i,r){let n=t.options,{[i]:o}=t.getProps([i],r);return Math.abs(e-o)<n.radius+n.hitRadius}var jQe=(()=>{class t extends $u{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(i){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,i&&Object.assign(this,i)}inRange(i,r,n){let o=this.options,{x:s,y:a}=this.getProps(["x","y"],n);return Math.pow(i-s,2)+Math.pow(r-a,2)<Math.pow(o.hitRadius+o.radius,2)}inXRange(i,r){return npe(this,i,"x",r)}inYRange(i,r){return npe(this,i,"y",r)}getCenterPoint(i){let{x:r,y:n}=this.getProps(["x","y"],i);return{x:r,y:n}}size(i){i=i||this.options||{};let r=i.radius||0;r=Math.max(r,r&&i.hoverRadius||0);let n=r&&i.borderWidth||0;return(r+n)*2}draw(i,r){let n=this.options;this.skip||n.radius<.1||!bf(this,r,this.size(n)/2)||(i.strokeStyle=n.borderColor,i.lineWidth=n.borderWidth,i.fillStyle=n.backgroundColor,vF(i,n,this.x,this.y))}getRange(){let i=this.options||{};return i.radius+i.hitRadius}}return t})();function Wpe(t,e){let{x:i,y:r,base:n,width:o,height:s}=t.getProps(["x","y","base","width","height"],e),a,c,d,u,h;return t.horizontal?(h=s/2,a=Math.min(i,n),c=Math.max(i,n),d=r-h,u=r+h):(h=o/2,a=i-h,c=i+h,d=Math.min(r,n),u=Math.max(r,n)),{left:a,top:d,right:c,bottom:u}}function wv(t,e,i,r){return t?0:Hs(e,i,r)}function zQe(t,e,i){let r=t.options.borderWidth,n=t.borderSkipped,o=tq(r);return{t:wv(n.top,o.top,0,i),r:wv(n.right,o.right,0,e),b:wv(n.bottom,o.bottom,0,i),l:wv(n.left,o.left,0,e)}}function WQe(t,e,i){let{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),n=t.options.borderRadius,o=_v(n),s=Math.min(e,i),a=t.borderSkipped,c=r||wr(n);return{topLeft:wv(!c||a.top||a.left,o.topLeft,0,s),topRight:wv(!c||a.top||a.right,o.topRight,0,s),bottomLeft:wv(!c||a.bottom||a.left,o.bottomLeft,0,s),bottomRight:wv(!c||a.bottom||a.right,o.bottomRight,0,s)}}function UQe(t){let e=Wpe(t),i=e.right-e.left,r=e.bottom-e.top,n=zQe(t,i/2,r/2),o=WQe(t,i/2,r/2);return{outer:{x:e.left,y:e.top,w:i,h:r,radius:o},inner:{x:e.left+n.l,y:e.top+n.t,w:i-n.l-n.r,h:r-n.t-n.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(n.t,n.l)),topRight:Math.max(0,o.topRight-Math.max(n.t,n.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(n.b,n.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(n.b,n.r))}}}}function bq(t,e,i,r){let n=e===null,o=i===null,a=t&&!(n&&o)&&Wpe(t,r);return a&&(n||yf(e,a.left,a.right))&&(o||yf(i,a.top,a.bottom))}function qQe(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function YQe(t,e){t.rect(e.x,e.y,e.w,e.h)}function _q(t,e,i={}){let r=t.x!==i.x?-e:0,n=t.y!==i.y?-e:0,o=(t.x+t.w!==i.x+i.w?e:0)-r,s=(t.y+t.h!==i.y+i.h?e:0)-n;return{x:t.x+r,y:t.y+n,w:t.w+o,h:t.h+s,radius:t.radius}}var Oq=class extends $u{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){let{inflateAmount:i,options:{borderColor:r,backgroundColor:n}}=this,{inner:o,outer:s}=UQe(this),a=qQe(s.radius)?Mx:YQe;e.save(),(s.w!==o.w||s.h!==o.h)&&(e.beginPath(),a(e,_q(s,i,o)),e.clip(),a(e,_q(o,-i,s)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),a(e,_q(o,i)),e.fillStyle=n,e.fill(),e.restore()}inRange(e,i,r){return bq(this,e,i,r)}inXRange(e,i){return bq(this,e,null,i)}inYRange(e,i){return bq(this,null,e,i)}getCenterPoint(e){let{x:i,y:r,base:n,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(i+n)/2:i,y:o?r:(r+n)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}},$Qe=Object.freeze({__proto__:null,ArcElement:Mq,BarElement:Oq,LineElement:HF,PointElement:jQe}),Nq=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],ope=Nq.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function Upe(t){return Nq[t%Nq.length]}function qpe(t){return ope[t%ope.length]}function GQe(t,e){return t.borderColor=Upe(e),t.backgroundColor=qpe(e),++e}function XQe(t,e){return t.backgroundColor=t.data.map(()=>Upe(e++)),e}function KQe(t,e){return t.backgroundColor=t.data.map(()=>qpe(e++)),e}function ZQe(t){let e=0;return(i,r)=>{let n=t.getDatasetMeta(r).controller;n instanceof zq?e=XQe(i,e):n instanceof kpe?e=KQe(i,e):n&&(e=GQe(i,e))}}function spe(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function QQe(t){return t&&(t.borderColor||t.backgroundColor)}var JQe={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,i){if(!i.enabled)return;let{data:{datasets:r},options:n}=t.config,{elements:o}=n;if(!i.forceOverride&&(spe(r)||QQe(n)||o&&spe(o)))return;let s=ZQe(t);r.forEach(s)}};function eJe(t,e,i,r,n){let o=n.samples||r;if(o>=i)return t.slice(e,e+i);let s=[],a=(i-2)/(o-2),c=0,d=e+i-1,u=e,h,p,f,m,g;for(s[c++]=t[u],h=0;h<o-2;h++){let y=0,w=0,x,T=Math.floor((h+1)*a)+1+e,M=Math.min(Math.floor((h+2)*a)+1,i)+e,B=M-T;for(x=T;x<M;x++)y+=t[x].x,w+=t[x].y;y/=B,w/=B;let G=Math.floor(h*a)+1+e,F=Math.min(Math.floor((h+1)*a)+1,i)+e,{x:O,y:V}=t[u];for(f=m=-1,x=G;x<F;x++)m=.5*Math.abs((O-y)*(t[x].y-V)-(O-t[x].x)*(w-V)),m>f&&(f=m,p=t[x],g=x);s[c++]=p,u=g}return s[c++]=t[d],s}function tJe(t,e,i,r){let n=0,o=0,s,a,c,d,u,h,p,f,m,g,y=[],w=e+i-1,x=t[e].x,M=t[w].x-x;for(s=e;s<e+i;++s){a=t[s],c=(a.x-x)/M*r,d=a.y;let B=c|0;if(B===u)d<m?(m=d,h=s):d>g&&(g=d,p=s),n=(o*n+a.x)/++o;else{let G=s-1;if(!kr(h)&&!kr(p)){let F=Math.min(h,p),O=Math.max(h,p);F!==f&&F!==G&&y.push(Lt(Ke({},t[F]),{x:n})),O!==f&&O!==G&&y.push(Lt(Ke({},t[O]),{x:n}))}s>0&&G!==f&&y.push(t[G]),y.push(a),u=B,o=0,m=g=d,h=p=f=s}}return y}function Ype(t){if(t._decimated){let e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function ape(t){t.data.datasets.forEach(e=>{Ype(e)})}function iJe(t,e){let i=e.length,r=0,n,{iScale:o}=t,{min:s,max:a,minDefined:c,maxDefined:d}=o.getUserBounds();return c&&(r=Hs(vf(e,o.axis,s).lo,0,i-1)),d?n=Hs(vf(e,o.axis,a).hi+1,r,i)-r:n=i-r,{start:r,count:n}}var rJe={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,i)=>{if(!i.enabled){ape(t);return}let r=t.width;t.data.datasets.forEach((n,o)=>{let{_data:s,indexAxis:a}=n,c=t.getDatasetMeta(o),d=s||n.data;if(kx([a,t.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;let u=t.scales[c.xAxisID];if(u.type!=="linear"&&u.type!=="time"||t.options.parsing)return;let{start:h,count:p}=iJe(c,d),f=i.threshold||4*r;if(p<=f){Ype(n);return}kr(s)&&(n._data=d,delete n.data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(g){this._data=g}}));let m;switch(i.algorithm){case"lttb":m=eJe(d,h,p,r,i);break;case"min-max":m=tJe(d,h,p,r);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}n._decimated=m})},destroy(t){ape(t)}};function nJe(t,e,i){let r=t.segments,n=t.points,o=e.points,s=[];for(let a of r){let{start:c,end:d}=a;d=Wq(c,d,n);let u=Pq(i,n[c],n[d],a.loop);if(!e.segments){s.push({source:a,target:u,start:n[c],end:n[d]});continue}let h=uq(e,u);for(let p of h){let f=Pq(i,o[p.start],o[p.end],p.loop),m=dq(a,n,f);for(let g of m)s.push({source:g,target:p,start:{[i]:lpe(u,f,"start",Math.max)},end:{[i]:lpe(u,f,"end",Math.min)}})}}return s}function Pq(t,e,i,r){if(r)return;let n=e[t],o=i[t];return t==="angle"&&(n=mc(n),o=mc(o)),{property:t,start:n,end:o}}function oJe(t,e){let{x:i=null,y:r=null}=t||{},n=e.points,o=[];return e.segments.forEach(({start:s,end:a})=>{a=Wq(s,a,n);let c=n[s],d=n[a];r!==null?(o.push({x:c.x,y:r}),o.push({x:d.x,y:r})):i!==null&&(o.push({x:i,y:c.y}),o.push({x:i,y:d.y}))}),o}function Wq(t,e,i){for(;e>t;e--){let r=i[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function lpe(t,e,i,r){return t&&e?r(t[i],e[i]):t?t[i]:e?e[i]:0}function $pe(t,e){let i=[],r=!1;return Un(t)?(r=!0,i=t):i=oJe(t,e),i.length?new HF({points:i,options:{tension:0},_loop:r,_fullLoop:r}):null}function cpe(t){return t&&t.fill!==!1}function sJe(t,e,i){let n=t[e].fill,o=[e],s;if(!i)return n;for(;n!==!1&&o.indexOf(n)===-1;){if(!Ro(n))return n;if(s=t[n],!s)return!1;if(s.visible)return n;o.push(n),n=s.fill}return!1}function aJe(t,e,i){let r=uJe(t);if(wr(r))return isNaN(r.value)?!1:r;let n=parseFloat(r);return Ro(n)&&Math.floor(n)===n?lJe(r[0],e,n,i):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function lJe(t,e,i,r){return(t==="-"||t==="+")&&(i=e+i),i===e||i<0||i>=r?!1:i}function cJe(t,e){let i=null;return t==="start"?i=e.bottom:t==="end"?i=e.top:wr(t)?i=e.getPixelForValue(t.value):e.getBasePixel&&(i=e.getBasePixel()),i}function dJe(t,e,i){let r;return t==="start"?r=i:t==="end"?r=e.options.reverse?e.min:e.max:wr(t)?r=t.value:r=e.getBaseValue(),r}function uJe(t){let e=t.options,i=e.fill,r=Ki(i&&i.target,i);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function hJe(t){let{scale:e,index:i,line:r}=t,n=[],o=r.segments,s=r.points,a=fJe(e,i);a.push($pe({x:null,y:e.bottom},r));for(let c=0;c<o.length;c++){let d=o[c];for(let u=d.start;u<=d.end;u++)pJe(n,s[u],a)}return new HF({points:n,options:{}})}function fJe(t,e){let i=[],r=t.getMatchingVisibleMetas("line");for(let n=0;n<r.length;n++){let o=r[n];if(o.index===e)break;o.hidden||i.unshift(o.dataset)}return i}function pJe(t,e,i){let r=[];for(let n=0;n<i.length;n++){let o=i[n],{first:s,last:a,point:c}=mJe(o,e,"x");if(!(!c||s&&a)){if(s)r.unshift(c);else if(t.push(c),!a)break}}t.push(...r)}function mJe(t,e,i){let r=t.interpolate(e,i);if(!r)return{};let n=r[i],o=t.segments,s=t.points,a=!1,c=!1;for(let d=0;d<o.length;d++){let u=o[d],h=s[u.start][i],p=s[u.end][i];if(yf(n,h,p)){a=n===h,c=n===p;break}}return{first:a,last:c,point:r}}var LF=class{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,i,r){let{x:n,y:o,radius:s}=this;return i=i||{start:0,end:Yn},e.arc(n,o,s,i.end,i.start,!0),!r.bounds}interpolate(e){let{x:i,y:r,radius:n}=this,o=e.angle;return{x:i+Math.cos(o)*n,y:r+Math.sin(o)*n,angle:o}}};function gJe(t){let{chart:e,fill:i,line:r}=t;if(Ro(i))return vJe(e,i);if(i==="stack")return hJe(t);if(i==="shape")return!0;let n=bJe(t);return n instanceof LF?n:$pe(n,r)}function vJe(t,e){let i=t.getDatasetMeta(e);return i&&t.isDatasetVisible(e)?i.dataset:null}function bJe(t){return(t.scale||{}).getPointPositionForValue?yJe(t):_Je(t)}function _Je(t){let{scale:e={},fill:i}=t,r=cJe(i,e);if(Ro(r)){let n=e.isHorizontal();return{x:n?r:null,y:n?null:r}}return null}function yJe(t){let{scale:e,fill:i}=t,r=e.options,n=e.getLabels().length,o=r.reverse?e.max:e.min,s=dJe(i,e,o),a=[];if(r.grid.circular){let c=e.getPointPositionForValue(0,o);return new LF({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(s)})}for(let c=0;c<n;++c)a.push(e.getPointPositionForValue(c,s));return a}function yq(t,e,i){let r=gJe(e),{line:n,scale:o,axis:s}=e,a=n.options,c=a.fill,d=a.backgroundColor,{above:u=d,below:h=d}=c||{};r&&n.points.length&&(BA(t,i),wJe(t,{line:n,target:r,above:u,below:h,area:i,scale:o,axis:s}),VA(t))}function wJe(t,e){let{line:i,target:r,above:n,below:o,area:s,scale:a}=e,c=i._loop?"angle":e.axis;t.save(),c==="x"&&o!==n&&(dpe(t,r,s.top),upe(t,{line:i,target:r,color:n,scale:a,property:c}),t.restore(),t.save(),dpe(t,r,s.bottom)),upe(t,{line:i,target:r,color:o,scale:a,property:c}),t.restore()}function dpe(t,e,i){let{segments:r,points:n}=e,o=!0,s=!1;t.beginPath();for(let a of r){let{start:c,end:d}=a,u=n[c],h=n[Wq(c,d,n)];o?(t.moveTo(u.x,u.y),o=!1):(t.lineTo(u.x,i),t.lineTo(u.x,u.y)),s=!!e.pathSegment(t,a,{move:s}),s?t.closePath():t.lineTo(h.x,i)}t.lineTo(e.first().x,i),t.closePath(),t.clip()}function upe(t,e){let{line:i,target:r,property:n,color:o,scale:s}=e,a=nJe(i,r,n);for(let{source:c,target:d,start:u,end:h}of a){let{style:{backgroundColor:p=o}={}}=c,f=r!==!0;t.save(),t.fillStyle=p,CJe(t,s,f&&Pq(n,u,h)),t.beginPath();let m=!!i.pathSegment(t,c),g;if(f){m?t.closePath():hpe(t,r,h,n);let y=!!r.pathSegment(t,d,{move:m,reverse:!0});g=m&&y,g||hpe(t,r,u,n)}t.closePath(),t.fill(g?"evenodd":"nonzero"),t.restore()}}function CJe(t,e,i){let{top:r,bottom:n}=e.chart.chartArea,{property:o,start:s,end:a}=i||{};o==="x"&&(t.beginPath(),t.rect(s,r,a-s,n-r),t.clip())}function hpe(t,e,i,r){let n=e.interpolate(i,r);n&&t.lineTo(n.x,n.y)}var xJe={id:"filler",afterDatasetsUpdate(t,e,i){let r=(t.data.datasets||[]).length,n=[],o,s,a,c;for(s=0;s<r;++s)o=t.getDatasetMeta(s),a=o.dataset,c=null,a&&a.options&&a instanceof HF&&(c={visible:t.isDatasetVisible(s),index:s,fill:aJe(a,s,r),chart:t,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=c,n.push(c);for(s=0;s<r;++s)c=n[s],!(!c||c.fill===!1)&&(c.fill=sJe(n,s,i.propagate))},beforeDraw(t,e,i){let r=i.drawTime==="beforeDraw",n=t.getSortedVisibleDatasetMetas(),o=t.chartArea;for(let s=n.length-1;s>=0;--s){let a=n[s].$filler;a&&(a.line.updateControlPoints(o,a.axis),r&&a.fill&&yq(t.ctx,a,o))}},beforeDatasetsDraw(t,e,i){if(i.drawTime!=="beforeDatasetsDraw")return;let r=t.getSortedVisibleDatasetMetas();for(let n=r.length-1;n>=0;--n){let o=r[n].$filler;cpe(o)&&yq(t.ctx,o,t.chartArea)}},beforeDatasetDraw(t,e,i){let r=e.meta.$filler;!cpe(r)||i.drawTime!=="beforeDatasetDraw"||yq(t.ctx,r,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},fpe=(t,e)=>{let{boxHeight:i=e,boxWidth:r=e}=t;return t.usePointStyle&&(i=Math.min(i,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:i,itemHeight:Math.max(e,i)}},SJe=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index,FF=class extends $u{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i,r){this.maxWidth=e,this.maxHeight=i,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let e=this.options.labels||{},i=On(e.generateLabels,[this.chart],this)||[];e.filter&&(i=i.filter(r=>e.filter(r,this.chart.data))),e.sort&&(i=i.sort((r,n)=>e.sort(r,n,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){let{options:e,ctx:i}=this;if(!e.display){this.width=this.height=0;return}let r=e.labels,n=Cs(r.font),o=n.size,s=this._computeTitleHeight(),{boxWidth:a,itemHeight:c}=fpe(r,o),d,u;i.font=n.string,this.isHorizontal()?(d=this.maxWidth,u=this._fitRows(s,o,a,c)+10):(u=this.maxHeight,d=this._fitCols(s,n,a,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,i,r,n){let{ctx:o,maxWidth:s,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],u=n+a,h=e;o.textAlign="left",o.textBaseline="middle";let p=-1,f=-u;return this.legendItems.forEach((m,g)=>{let y=r+i/2+o.measureText(m.text).width;(g===0||d[d.length-1]+y+2*a>s)&&(h+=u,d[d.length-(g>0?0:1)]=0,f+=u,p++),c[g]={left:0,top:f,row:p,width:y,height:n},d[d.length-1]+=y+a}),h}_fitCols(e,i,r,n){let{ctx:o,maxHeight:s,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],u=s-e,h=a,p=0,f=0,m=0,g=0;return this.legendItems.forEach((y,w)=>{let{itemWidth:x,itemHeight:T}=EJe(r,i,o,y,n);w>0&&f+T+2*a>u&&(h+=p+a,d.push({width:p,height:f}),m+=p+a,g++,p=f=0),c[w]={left:m,top:f,col:g,width:x,height:T},p=Math.max(p,x),f+=T+a}),h+=p,d.push({width:p,height:f}),h}adjustHitBoxes(){if(!this.options.display)return;let e=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:r,labels:{padding:n},rtl:o}}=this,s=F_(o,this.left,this.width);if(this.isHorizontal()){let a=0,c=Da(r,this.left+n,this.right-this.lineWidths[a]);for(let d of i)a!==d.row&&(a=d.row,c=Da(r,this.left+n,this.right-this.lineWidths[a])),d.top+=this.top+e+n,d.left=s.leftForLtr(s.x(c),d.width),c+=d.width+n}else{let a=0,c=Da(r,this.top+e+n,this.bottom-this.columnSizes[a].height);for(let d of i)d.col!==a&&(a=d.col,c=Da(r,this.top+e+n,this.bottom-this.columnSizes[a].height)),d.top=c,d.left+=this.left+n,d.left=s.leftForLtr(s.x(d.left),d.width),c+=d.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){let e=this.ctx;BA(e,this),this._draw(),VA(e)}}_draw(){let{options:e,columnSizes:i,lineWidths:r,ctx:n}=this,{align:o,labels:s}=e,a=to.color,c=F_(e.rtl,this.left,this.width),d=Cs(s.font),{padding:u}=s,h=d.size,p=h/2,f;this.drawTitle(),n.textAlign=c.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=d.string;let{boxWidth:m,boxHeight:g,itemHeight:y}=fpe(s,h),w=function(G,F,O){if(isNaN(m)||m<=0||isNaN(g)||g<0)return;n.save();let V=Ki(O.lineWidth,1);if(n.fillStyle=Ki(O.fillStyle,a),n.lineCap=Ki(O.lineCap,"butt"),n.lineDashOffset=Ki(O.lineDashOffset,0),n.lineJoin=Ki(O.lineJoin,"miter"),n.lineWidth=V,n.strokeStyle=Ki(O.strokeStyle,a),n.setLineDash(Ki(O.lineDash,[])),s.usePointStyle){let J={radius:g*Math.SQRT2/2,pointStyle:O.pointStyle,rotation:O.rotation,borderWidth:V},N=c.xPlus(G,m/2),P=F+p;eq(n,J,N,P,s.pointStyleWidth&&m)}else{let J=F+Math.max((h-g)/2,0),N=c.leftForLtr(G,m),P=_v(O.borderRadius);n.beginPath(),Object.values(P).some($=>$!==0)?Mx(n,{x:N,y:J,w:m,h:g,radius:P}):n.rect(N,J,m,g),n.fill(),V!==0&&n.stroke()}n.restore()},x=function(G,F,O){bv(n,O.text,G,F+y/2,d,{strikethrough:O.hidden,textAlign:c.textAlign(O.textAlign)})},T=this.isHorizontal(),M=this._computeTitleHeight();T?f={x:Da(o,this.left+u,this.right-r[0]),y:this.top+u+M,line:0}:f={x:this.left+u,y:Da(o,this.top+M+u,this.bottom-i[0].height),line:0},lq(this.ctx,e.textDirection);let B=y+u;this.legendItems.forEach((G,F)=>{n.strokeStyle=G.fontColor,n.fillStyle=G.fontColor;let O=n.measureText(G.text).width,V=c.textAlign(G.textAlign||(G.textAlign=s.textAlign)),J=m+p+O,N=f.x,P=f.y;c.setWidth(this.width),T?F>0&&N+J+u>this.right&&(P=f.y+=B,f.line++,N=f.x=Da(o,this.left+u,this.right-r[f.line])):F>0&&P+B>this.bottom&&(N=f.x=N+i[f.line].width+u,f.line++,P=f.y=Da(o,this.top+M+u,this.bottom-i[f.line].height));let $=c.x(N);if(w($,P,G),N=hfe(V,N+m+p,T?N+J:this.right,e.rtl),x(c.x(N),P,G),T)f.x+=J+u;else if(typeof G.text!="string"){let K=d.lineHeight;f.y+=Gpe(G,K)+u}else f.y+=B}),cq(this.ctx,e.textDirection)}drawTitle(){let e=this.options,i=e.title,r=Cs(i.font),n=Ma(i.padding);if(!i.display)return;let o=F_(e.rtl,this.left,this.width),s=this.ctx,a=i.position,c=r.size/2,d=n.top+c,u,h=this.left,p=this.width;if(this.isHorizontal())p=Math.max(...this.lineWidths),u=this.top+d,h=Da(e.align,h,this.right-p);else{let m=this.columnSizes.reduce((g,y)=>Math.max(g,y.height),0);u=d+Da(e.align,this.top,this.bottom-m-e.labels.padding-this._computeTitleHeight())}let f=Da(a,h,h+p);s.textAlign=o.textAlign(mF(a)),s.textBaseline="middle",s.strokeStyle=i.color,s.fillStyle=i.color,s.font=r.string,bv(s,i.text,f,u,r)}_computeTitleHeight(){let e=this.options.title,i=Cs(e.font),r=Ma(e.padding);return e.display?i.lineHeight+r.height:0}_getLegendItemAt(e,i){let r,n,o;if(yf(e,this.left,this.right)&&yf(i,this.top,this.bottom)){for(o=this.legendHitBoxes,r=0;r<o.length;++r)if(n=o[r],yf(e,n.left,n.left+n.width)&&yf(i,n.top,n.top+n.height))return this.legendItems[r]}return null}handleEvent(e){let i=this.options;if(!AJe(e.type,i))return;let r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){let n=this._hoveredItem,o=SJe(n,r);n&&!o&&On(i.onLeave,[e,n,this],this),this._hoveredItem=r,r&&!o&&On(i.onHover,[e,r,this],this)}else r&&On(i.onClick,[e,r,this],this)}};function EJe(t,e,i,r,n){let o=TJe(r,t,e,i),s=RJe(n,r,e.lineHeight);return{itemWidth:o,itemHeight:s}}function TJe(t,e,i,r){let n=t.text;return n&&typeof n!="string"&&(n=n.reduce((o,s)=>o.length>s.length?o:s)),e+i.size/2+r.measureText(n).width}function RJe(t,e,i){let r=t;return typeof e.text!="string"&&(r=Gpe(e,i)),r}function Gpe(t,e){let i=t.text?t.text.length:0;return e*i}function AJe(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var IJe={id:"legend",_element:FF,start(t,e,i){let r=t.legend=new FF({ctx:t.ctx,options:i,chart:t});ol.configure(t,r,i),ol.addBox(t,r)},stop(t){ol.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){let r=t.legend;ol.configure(t,r,i),r.options=i},afterUpdate(t){let e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){let r=e.datasetIndex,n=i.chart;n.isDatasetVisible(r)?(n.hide(r),e.hidden=!0):(n.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){let e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:r,textAlign:n,color:o,useBorderRadius:s,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(c=>{let d=c.controller.getStyle(i?0:void 0),u=Ma(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:o,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:d.borderColor,pointStyle:r||d.pointStyle,rotation:d.rotation,textAlign:n||d.textAlign,borderRadius:s&&(a||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}},XA=class extends $u{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i){let r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=i;let n=Un(r.text)?r.text.length:1;this._padding=Ma(r.padding);let o=n*Cs(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){let e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){let{top:i,left:r,bottom:n,right:o,options:s}=this,a=s.align,c=0,d,u,h;return this.isHorizontal()?(u=Da(a,r,o),h=i+e,d=o-r):(s.position==="left"?(u=r+e,h=Da(a,n,i),c=qn*-.5):(u=o-e,h=Da(a,i,n),c=qn*.5),d=n-i),{titleX:u,titleY:h,maxWidth:d,rotation:c}}draw(){let e=this.ctx,i=this.options;if(!i.display)return;let r=Cs(i.font),o=r.lineHeight/2+this._padding.top,{titleX:s,titleY:a,maxWidth:c,rotation:d}=this._drawArgs(o);bv(e,i.text,0,0,r,{color:i.color,maxWidth:c,rotation:d,textAlign:mF(i.align),textBaseline:"middle",translation:[s,a]})}};function DJe(t,e){let i=new XA({ctx:t.ctx,options:e,chart:t});ol.configure(t,i,e),ol.addBox(t,i),t.titleBlock=i}var MJe={id:"title",_element:XA,start(t,e,i){DJe(t,i)},stop(t){let e=t.titleBlock;ol.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){let r=t.titleBlock;ol.configure(t,r,i),r.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},RF=new WeakMap,kJe={id:"subtitle",start(t,e,i){let r=new XA({ctx:t.ctx,options:i,chart:t});ol.configure(t,r,i),ol.addBox(t,r),RF.set(t,r)},stop(t){ol.removeBox(t,RF.get(t)),RF.delete(t)},beforeUpdate(t,e,i){let r=RF.get(t);ol.configure(t,r,i),r.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},$A={average(t){if(!t.length)return!1;let e,i,r=new Set,n=0,o=0;for(e=0,i=t.length;e<i;++e){let a=t[e].element;if(a&&a.hasValue()){let c=a.tooltipPosition();r.add(c.x),n+=c.y,++o}}return{x:[...r].reduce((a,c)=>a+c)/r.size,y:n/o}},nearest(t,e){if(!t.length)return!1;let i=e.x,r=e.y,n=Number.POSITIVE_INFINITY,o,s,a;for(o=0,s=t.length;o<s;++o){let c=t[o].element;if(c&&c.hasValue()){let d=c.getCenterPoint(),u=dF(e,d);u<n&&(n=u,a=c)}}if(a){let c=a.tooltipPosition();i=c.x,r=c.y}return{x:i,y:r}}};function wf(t,e){return e&&(Un(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function lm(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function OJe(t,e){let{element:i,datasetIndex:r,index:n}=e,o=t.getDatasetMeta(r).controller,{label:s,value:a}=o.getLabelAndValue(n);return{chart:t,label:s,parsed:o.getParsed(n),raw:t.data.datasets[r].data[n],formattedValue:a,dataset:o.getDataset(),dataIndex:n,datasetIndex:r,element:i}}function ppe(t,e){let i=t.chart.ctx,{body:r,footer:n,title:o}=t,{boxWidth:s,boxHeight:a}=e,c=Cs(e.bodyFont),d=Cs(e.titleFont),u=Cs(e.footerFont),h=o.length,p=n.length,f=r.length,m=Ma(e.padding),g=m.height,y=0,w=r.reduce((M,B)=>M+B.before.length+B.lines.length+B.after.length,0);if(w+=t.beforeBody.length+t.afterBody.length,h&&(g+=h*d.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),w){let M=e.displayColors?Math.max(a,c.lineHeight):c.lineHeight;g+=f*M+(w-f)*c.lineHeight+(w-1)*e.bodySpacing}p&&(g+=e.footerMarginTop+p*u.lineHeight+(p-1)*e.footerSpacing);let x=0,T=function(M){y=Math.max(y,i.measureText(M).width+x)};return i.save(),i.font=d.string,an(t.title,T),i.font=c.string,an(t.beforeBody.concat(t.afterBody),T),x=e.displayColors?s+2+e.boxPadding:0,an(r,M=>{an(M.before,T),an(M.lines,T),an(M.after,T)}),x=0,i.font=u.string,an(t.footer,T),i.restore(),y+=m.width,{width:y,height:g}}function NJe(t,e){let{y:i,height:r}=e;return i<r/2?"top":i>t.height-r/2?"bottom":"center"}function PJe(t,e,i,r){let{x:n,width:o}=r,s=i.caretSize+i.caretPadding;if(t==="left"&&n+o+s>e.width||t==="right"&&n-o-s<0)return!0}function LJe(t,e,i,r){let{x:n,width:o}=i,{width:s,chartArea:{left:a,right:c}}=t,d="center";return r==="center"?d=n<=(a+c)/2?"left":"right":n<=o/2?d="left":n>=s-o/2&&(d="right"),PJe(d,t,e,i)&&(d="center"),d}function mpe(t,e,i){let r=i.yAlign||e.yAlign||NJe(t,i);return{xAlign:i.xAlign||e.xAlign||LJe(t,e,i,r),yAlign:r}}function FJe(t,e){let{x:i,width:r}=t;return e==="right"?i-=r:e==="center"&&(i-=r/2),i}function HJe(t,e,i){let{y:r,height:n}=t;return e==="top"?r+=i:e==="bottom"?r-=n+i:r-=n/2,r}function gpe(t,e,i,r){let{caretSize:n,caretPadding:o,cornerRadius:s}=t,{xAlign:a,yAlign:c}=i,d=n+o,{topLeft:u,topRight:h,bottomLeft:p,bottomRight:f}=_v(s),m=FJe(e,a),g=HJe(e,c,d);return c==="center"?a==="left"?m+=d:a==="right"&&(m-=d):a==="left"?m-=Math.max(u,p)+n:a==="right"&&(m+=Math.max(h,f)+n),{x:Hs(m,0,r.width-e.width),y:Hs(g,0,r.height-e.height)}}function AF(t,e,i){let r=Ma(i.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function vpe(t){return wf([],lm(t))}function BJe(t,e,i){return sm(t,{tooltip:e,tooltipItems:i,type:"tooltip"})}function bpe(t,e){let i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}var Xpe={beforeTitle:_f,title(t){if(t.length>0){let e=t[0],i=e.chart.data.labels,r=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return i[e.dataIndex]}return""},afterTitle:_f,beforeBody:_f,beforeLabel:_f,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");let i=t.formattedValue;return kr(i)||(e+=i),e},labelColor(t){let i=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){let i=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:i.pointStyle,rotation:i.rotation}},afterLabel:_f,afterBody:_f,beforeFooter:_f,footer:_f,afterFooter:_f};function vc(t,e,i,r){let n=t[e].call(i,r);return typeof n>"u"?Xpe[e].call(i,r):n}var _pe=(()=>{class t extends $u{static positioners=$A;constructor(i){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=i.chart,this.options=i.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(i){this.options=i,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let i=this._cachedAnimations;if(i)return i;let r=this.chart,n=this.options.setContext(this.getContext()),o=n.enabled&&r.options.animation&&n.animations,s=new kF(this.chart,o);return o._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=BJe(this.chart.getContext(),this,this._tooltipItems))}getTitle(i,r){let{callbacks:n}=r,o=vc(n,"beforeTitle",this,i),s=vc(n,"title",this,i),a=vc(n,"afterTitle",this,i),c=[];return c=wf(c,lm(o)),c=wf(c,lm(s)),c=wf(c,lm(a)),c}getBeforeBody(i,r){return vpe(vc(r.callbacks,"beforeBody",this,i))}getBody(i,r){let{callbacks:n}=r,o=[];return an(i,s=>{let a={before:[],lines:[],after:[]},c=bpe(n,s);wf(a.before,lm(vc(c,"beforeLabel",this,s))),wf(a.lines,vc(c,"label",this,s)),wf(a.after,lm(vc(c,"afterLabel",this,s))),o.push(a)}),o}getAfterBody(i,r){return vpe(vc(r.callbacks,"afterBody",this,i))}getFooter(i,r){let{callbacks:n}=r,o=vc(n,"beforeFooter",this,i),s=vc(n,"footer",this,i),a=vc(n,"afterFooter",this,i),c=[];return c=wf(c,lm(o)),c=wf(c,lm(s)),c=wf(c,lm(a)),c}_createItems(i){let r=this._active,n=this.chart.data,o=[],s=[],a=[],c=[],d,u;for(d=0,u=r.length;d<u;++d)c.push(OJe(this.chart,r[d]));return i.filter&&(c=c.filter((h,p,f)=>i.filter(h,p,f,n))),i.itemSort&&(c=c.sort((h,p)=>i.itemSort(h,p,n))),an(c,h=>{let p=bpe(i.callbacks,h);o.push(vc(p,"labelColor",this,h)),s.push(vc(p,"labelPointStyle",this,h)),a.push(vc(p,"labelTextColor",this,h))}),this.labelColors=o,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=c,c}update(i,r){let n=this.options.setContext(this.getContext()),o=this._active,s,a=[];if(!o.length)this.opacity!==0&&(s={opacity:0});else{let c=$A[n.position].call(this,o,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);let d=this._size=ppe(this,n),u=Object.assign({},c,d),h=mpe(this.chart,n,u),p=gpe(n,u,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,s={opacity:1,x:p.x,y:p.y,width:d.width,height:d.height,caretX:c.x,caretY:c.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),i&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(i,r,n,o){let s=this.getCaretPosition(i,n,o);r.lineTo(s.x1,s.y1),r.lineTo(s.x2,s.y2),r.lineTo(s.x3,s.y3)}getCaretPosition(i,r,n){let{xAlign:o,yAlign:s}=this,{caretSize:a,cornerRadius:c}=n,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=_v(c),{x:f,y:m}=i,{width:g,height:y}=r,w,x,T,M,B,G;return s==="center"?(B=m+y/2,o==="left"?(w=f,x=w-a,M=B+a,G=B-a):(w=f+g,x=w+a,M=B-a,G=B+a),T=w):(o==="left"?x=f+Math.max(d,h)+a:o==="right"?x=f+g-Math.max(u,p)-a:x=this.caretX,s==="top"?(M=m,B=M-a,w=x-a,T=x+a):(M=m+y,B=M+a,w=x+a,T=x-a),G=M),{x1:w,x2:x,x3:T,y1:M,y2:B,y3:G}}drawTitle(i,r,n){let o=this.title,s=o.length,a,c,d;if(s){let u=F_(n.rtl,this.x,this.width);for(i.x=AF(this,n.titleAlign,n),r.textAlign=u.textAlign(n.titleAlign),r.textBaseline="middle",a=Cs(n.titleFont),c=n.titleSpacing,r.fillStyle=n.titleColor,r.font=a.string,d=0;d<s;++d)r.fillText(o[d],u.x(i.x),i.y+a.lineHeight/2),i.y+=a.lineHeight+c,d+1===s&&(i.y+=n.titleMarginBottom-c)}}_drawColorBox(i,r,n,o,s){let a=this.labelColors[n],c=this.labelPointStyles[n],{boxHeight:d,boxWidth:u}=s,h=Cs(s.bodyFont),p=AF(this,"left",s),f=o.x(p),m=d<h.lineHeight?(h.lineHeight-d)/2:0,g=r.y+m;if(s.usePointStyle){let y={radius:Math.min(u,d)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},w=o.leftForLtr(f,u)+u/2,x=g+d/2;i.strokeStyle=s.multiKeyBackground,i.fillStyle=s.multiKeyBackground,vF(i,y,w,x),i.strokeStyle=a.borderColor,i.fillStyle=a.backgroundColor,vF(i,y,w,x)}else{i.lineWidth=wr(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,i.strokeStyle=a.borderColor,i.setLineDash(a.borderDash||[]),i.lineDashOffset=a.borderDashOffset||0;let y=o.leftForLtr(f,u),w=o.leftForLtr(o.xPlus(f,1),u-2),x=_v(a.borderRadius);Object.values(x).some(T=>T!==0)?(i.beginPath(),i.fillStyle=s.multiKeyBackground,Mx(i,{x:y,y:g,w:u,h:d,radius:x}),i.fill(),i.stroke(),i.fillStyle=a.backgroundColor,i.beginPath(),Mx(i,{x:w,y:g+1,w:u-2,h:d-2,radius:x}),i.fill()):(i.fillStyle=s.multiKeyBackground,i.fillRect(y,g,u,d),i.strokeRect(y,g,u,d),i.fillStyle=a.backgroundColor,i.fillRect(w,g+1,u-2,d-2))}i.fillStyle=this.labelTextColors[n]}drawBody(i,r,n){let{body:o}=this,{bodySpacing:s,bodyAlign:a,displayColors:c,boxHeight:d,boxWidth:u,boxPadding:h}=n,p=Cs(n.bodyFont),f=p.lineHeight,m=0,g=F_(n.rtl,this.x,this.width),y=function(V){r.fillText(V,g.x(i.x+m),i.y+f/2),i.y+=f+s},w=g.textAlign(a),x,T,M,B,G,F,O;for(r.textAlign=a,r.textBaseline="middle",r.font=p.string,i.x=AF(this,w,n),r.fillStyle=n.bodyColor,an(this.beforeBody,y),m=c&&w!=="right"?a==="center"?u/2+h:u+2+h:0,B=0,F=o.length;B<F;++B){for(x=o[B],T=this.labelTextColors[B],r.fillStyle=T,an(x.before,y),M=x.lines,c&&M.length&&(this._drawColorBox(r,i,B,g,n),f=Math.max(p.lineHeight,d)),G=0,O=M.length;G<O;++G)y(M[G]),f=p.lineHeight;an(x.after,y)}m=0,f=p.lineHeight,an(this.afterBody,y),i.y-=s}drawFooter(i,r,n){let o=this.footer,s=o.length,a,c;if(s){let d=F_(n.rtl,this.x,this.width);for(i.x=AF(this,n.footerAlign,n),i.y+=n.footerMarginTop,r.textAlign=d.textAlign(n.footerAlign),r.textBaseline="middle",a=Cs(n.footerFont),r.fillStyle=n.footerColor,r.font=a.string,c=0;c<s;++c)r.fillText(o[c],d.x(i.x),i.y+a.lineHeight/2),i.y+=a.lineHeight+n.footerSpacing}}drawBackground(i,r,n,o){let{xAlign:s,yAlign:a}=this,{x:c,y:d}=i,{width:u,height:h}=n,{topLeft:p,topRight:f,bottomLeft:m,bottomRight:g}=_v(o.cornerRadius);r.fillStyle=o.backgroundColor,r.strokeStyle=o.borderColor,r.lineWidth=o.borderWidth,r.beginPath(),r.moveTo(c+p,d),a==="top"&&this.drawCaret(i,r,n,o),r.lineTo(c+u-f,d),r.quadraticCurveTo(c+u,d,c+u,d+f),a==="center"&&s==="right"&&this.drawCaret(i,r,n,o),r.lineTo(c+u,d+h-g),r.quadraticCurveTo(c+u,d+h,c+u-g,d+h),a==="bottom"&&this.drawCaret(i,r,n,o),r.lineTo(c+m,d+h),r.quadraticCurveTo(c,d+h,c,d+h-m),a==="center"&&s==="left"&&this.drawCaret(i,r,n,o),r.lineTo(c,d+p),r.quadraticCurveTo(c,d,c+p,d),r.closePath(),r.fill(),o.borderWidth>0&&r.stroke()}_updateAnimationTarget(i){let r=this.chart,n=this.$animations,o=n&&n.x,s=n&&n.y;if(o||s){let a=$A[i.position].call(this,this._active,this._eventPosition);if(!a)return;let c=this._size=ppe(this,i),d=Object.assign({},a,this._size),u=mpe(r,i,d),h=gpe(i,d,u,r);(o._to!==h.x||s._to!==h.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=c.width,this.height=c.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(i){let r=this.options.setContext(this.getContext()),n=this.opacity;if(!n)return;this._updateAnimationTarget(r);let o={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;let a=Ma(r.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&c&&(i.save(),i.globalAlpha=n,this.drawBackground(s,i,o,r),lq(i,r.textDirection),s.y+=a.top,this.drawTitle(s,i,r),this.drawBody(s,i,r),this.drawFooter(s,i,r),cq(i,r.textDirection),i.restore())}getActiveElements(){return this._active||[]}setActiveElements(i,r){let n=this._active,o=i.map(({datasetIndex:c,index:d})=>{let u=this.chart.getDatasetMeta(c);if(!u)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:u.data[d],index:d}}),s=!FA(n,o),a=this._positionChanged(o,r);(s||a)&&(this._active=o,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(i,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let o=this.options,s=this._active||[],a=this._getActiveElements(i,s,r,n),c=this._positionChanged(a,i),d=r||!FA(a,s)||c;return d&&(this._active=a,(o.enabled||o.external)&&(this._eventPosition={x:i.x,y:i.y},this.update(!0,r))),d}_getActiveElements(i,r,n,o){let s=this.options;if(i.type==="mouseout")return[];if(!o)return r.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);let a=this.chart.getElementsAtEventForMode(i,s.mode,s,n);return s.reverse&&a.reverse(),a}_positionChanged(i,r){let{caretX:n,caretY:o,options:s}=this,a=$A[s.position].call(this,i,r);return a!==!1&&(n!==a.x||o!==a.y)}}return t})(),VJe={id:"tooltip",_element:_pe,positioners:$A,afterInit(t,e,i){i&&(t.tooltip=new _pe({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){let e=t.tooltip;if(e&&e._willRender()){let i={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",Lt(Ke({},i),{cancelable:!0}))===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){let i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Xpe},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},jJe=Object.freeze({__proto__:null,Colors:JQe,Decimation:rJe,Filler:xJe,Legend:IJe,SubTitle:kJe,Title:MJe,Tooltip:VJe}),zJe=(t,e,i,r)=>(typeof e=="string"?(i=t.push(e)-1,r.unshift({index:i,label:e})):isNaN(e)&&(i=null),i);function WJe(t,e,i,r){let n=t.indexOf(e);if(n===-1)return zJe(t,e,i,r);let o=t.lastIndexOf(e);return n!==o?i:n}var UJe=(t,e)=>t===null?null:Hs(Math.round(t),0,e);function ype(t){let e=this.getLabels();return t>=0&&t<e.length?e[t]:t}var qJe=(()=>{class t extends V_{static id="category";static defaults={ticks:{callback:ype}};constructor(i){super(i),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(i){let r=this._addedLabels;if(r.length){let n=this.getLabels();for(let{index:o,label:s}of r)n[o]===s&&n.splice(o,1);this._addedLabels=[]}super.init(i)}parse(i,r){if(kr(i))return null;let n=this.getLabels();return r=isFinite(r)&&n[r]===i?r:WJe(n,i,Ki(r,i),this._addedLabels),UJe(r,n.length-1)}determineDataLimits(){let{minDefined:i,maxDefined:r}=this.getUserBounds(),{min:n,max:o}=this.getMinMax(!0);this.options.bounds==="ticks"&&(i||(n=0),r||(o=this.getLabels().length-1)),this.min=n,this.max=o}buildTicks(){let i=this.min,r=this.max,n=this.options.offset,o=[],s=this.getLabels();s=i===0&&r===s.length-1?s:s.slice(i,r+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=i;a<=r;a++)o.push({value:a});return o}getLabelForValue(i){return ype.call(this,i)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(i){return typeof i!="number"&&(i=this.parse(i)),i===null?NaN:this.getPixelForDecimal((i-this._startValue)/this._valueRange)}getPixelForTick(i){let r=this.ticks;return i<0||i>r.length-1?null:this.getPixelForValue(r[i].value)}getValueForPixel(i){return Math.round(this._startValue+this.getDecimalForPixel(i)*this._valueRange)}getBasePixel(){return this.bottom}}return t})();function YJe(t,e){let i=[],{bounds:n,step:o,min:s,max:a,precision:c,count:d,maxTicks:u,maxDigits:h,includeBounds:p}=t,f=o||1,m=u-1,{min:g,max:y}=e,w=!kr(s),x=!kr(a),T=!kr(d),M=(y-g)/(h+1),B=jU((y-g)/m/f)*f,G,F,O,V;if(B<1e-14&&!w&&!x)return[{value:g},{value:y}];V=Math.ceil(y/B)-Math.floor(g/B),V>m&&(B=jU(V*B/m/f)*f),kr(c)||(G=Math.pow(10,c),B=Math.ceil(B*G)/G),n==="ticks"?(F=Math.floor(g/B)*B,O=Math.ceil(y/B)*B):(F=g,O=y),w&&x&&o&&ofe((a-s)/o,B/1e3)?(V=Math.round(Math.min((a-s)/B,u)),B=(a-s)/V,F=s,O=a):T?(F=w?s:F,O=x?a:O,V=d-1,B=(O-F)/V):(V=(O-F)/B,Ax(V,Math.round(V),B/1e3)?V=Math.round(V):V=Math.ceil(V));let J=Math.max(WU(B),WU(F));G=Math.pow(10,kr(c)?J:c),F=Math.round(F*G)/G,O=Math.round(O*G)/G;let N=0;for(w&&(p&&F!==s?(i.push({value:s}),F<s&&N++,Ax(Math.round((F+N*B)*G)/G,s,wpe(s,M,t))&&N++):F<s&&N++);N<V;++N){let P=Math.round((F+N*B)*G)/G;if(x&&P>a)break;i.push({value:P})}return x&&p&&O!==a?i.length&&Ax(i[i.length-1].value,a,wpe(a,M,t))?i[i.length-1].value=a:i.push({value:a}):(!x||O===a)&&i.push({value:O}),i}function wpe(t,e,{horizontal:i,minRotation:r}){let n=qd(r),o=(i?Math.sin(n):Math.cos(n))||.001,s=.75*e*(""+t).length;return Math.min(e/o,s)}var Px=class extends V_{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,i){return kr(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){let{beginAtZero:e}=this.options,{minDefined:i,maxDefined:r}=this.getUserBounds(),{min:n,max:o}=this,s=c=>n=i?n:c,a=c=>o=r?o:c;if(e){let c=Yu(n),d=Yu(o);c<0&&d<0?a(0):c>0&&d>0&&s(0)}if(n===o){let c=o===0?1:Math.abs(o*.05);a(o+c),e||s(n-c)}this.min=n,this.max=o}getTickLimit(){let e=this.options.ticks,{maxTicksLimit:i,stepSize:r}=e,n;return r?(n=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,n>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${n} ticks. Limiting to 1000.`),n=1e3)):(n=this.computeTickLimit(),i=i||11),i&&(n=Math.min(i,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){let e=this.options,i=e.ticks,r=this.getTickLimit();r=Math.max(2,r);let n={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},o=this._range||this,s=YJe(n,o);return e.bounds==="ticks"&&zU(s,this,"value"),e.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}configure(){let e=this.ticks,i=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){let n=(r-i)/Math.max(e.length-1,1)/2;i-=n,r+=n}this._startValue=i,this._endValue=r,this._valueRange=r-i}getLabelForValue(e){return Dx(e,this.chart.options.locale,this.options.ticks.format)}},Lq=class extends Px{static id="linear";static defaults={ticks:{callback:HA.formatters.numeric}};determineDataLimits(){let{min:e,max:i}=this.getMinMax(!0);this.min=Ro(e)?e:0,this.max=Ro(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){let e=this.isHorizontal(),i=e?this.width:this.height,r=qd(this.options.ticks.minRotation),n=(e?Math.sin(r):Math.cos(r))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,o.lineHeight/n))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}},KA=t=>Math.floor(nm(t)),B_=(t,e)=>Math.pow(10,KA(t)+e);function Cpe(t){return t/Math.pow(10,KA(t))===1}function xpe(t,e,i){let r=Math.pow(10,i),n=Math.floor(t/r);return Math.ceil(e/r)-n}function $Je(t,e){let i=e-t,r=KA(i);for(;xpe(t,e,r)>10;)r++;for(;xpe(t,e,r)<10;)r--;return Math.min(r,KA(t))}function GJe(t,{min:e,max:i}){e=gc(t.min,e);let r=[],n=KA(e),o=$Je(e,i),s=o<0?Math.pow(10,Math.abs(o)):1,a=Math.pow(10,o),c=n>o?Math.pow(10,n):0,d=Math.round((e-c)*s)/s,u=Math.floor((e-c)/a/10)*a*10,h=Math.floor((d-u)/Math.pow(10,o)),p=gc(t.min,Math.round((c+u+h*Math.pow(10,o))*s)/s);for(;p<i;)r.push({value:p,major:Cpe(p),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(o++,h=2,s=o>=0?1:s),p=Math.round((c+u+h*Math.pow(10,o))*s)/s;let f=gc(t.max,p);return r.push({value:f,major:Cpe(f),significand:h}),r}var Fq=class extends V_{static id="logarithmic";static defaults={ticks:{callback:HA.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,i){let r=Px.prototype.parse.apply(this,[e,i]);if(r===0){this._zero=!0;return}return Ro(r)&&r>0?r:null}determineDataLimits(){let{min:e,max:i}=this.getMinMax(!0);this.min=Ro(e)?Math.max(0,e):null,this.max=Ro(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Ro(this._userMin)&&(this.min=e===B_(this.min,0)?B_(this.min,-1):B_(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:e,maxDefined:i}=this.getUserBounds(),r=this.min,n=this.max,o=a=>r=e?r:a,s=a=>n=i?n:a;r===n&&(r<=0?(o(1),s(10)):(o(B_(r,-1)),s(B_(n,1)))),r<=0&&o(B_(n,-1)),n<=0&&s(B_(r,1)),this.min=r,this.max=n}buildTicks(){let e=this.options,i={min:this._userMin,max:this._userMax},r=GJe(i,this);return e.bounds==="ticks"&&zU(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(e){return e===void 0?"0":Dx(e,this.chart.options.locale,this.options.ticks.format)}configure(){let e=this.min;super.configure(),this._startValue=nm(e),this._valueRange=nm(this.max)-nm(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(nm(e)-this._startValue)/this._valueRange)}getValueForPixel(e){let i=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+i*this._valueRange)}};function Hq(t){let e=t.ticks;if(e.display&&t.display){let i=Ma(e.backdropPadding);return Ki(e.font&&e.font.size,to.font.size)+i.height}return 0}function XJe(t,e,i){return i=Un(i)?i:[i],{w:pfe(t,e.string,i),h:i.length*e.lineHeight}}function Spe(t,e,i,r,n){return t===r||t===n?{start:e-i/2,end:e+i/2}:t<r||t>n?{start:e-i,end:e}:{start:e,end:e+i}}function KJe(t){let e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},i=Object.assign({},e),r=[],n=[],o=t._pointLabels.length,s=t.options.pointLabels,a=s.centerPointLabels?qn/o:0;for(let c=0;c<o;c++){let d=s.setContext(t.getPointLabelContext(c));n[c]=d.padding;let u=t.getPointPosition(c,t.drawingArea+n[c],a),h=Cs(d.font),p=XJe(t.ctx,h,t._pointLabels[c]);r[c]=p;let f=mc(t.getIndexAngle(c)+a),m=Math.round(fF(f)),g=Spe(m,u.x,p.w,0,180),y=Spe(m,u.y,p.h,90,270);ZJe(i,e,f,g,y)}t.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),t._pointLabelItems=eet(t,r,n)}function ZJe(t,e,i,r,n){let o=Math.abs(Math.sin(i)),s=Math.abs(Math.cos(i)),a=0,c=0;r.start<e.l?(a=(e.l-r.start)/o,t.l=Math.min(t.l,e.l-a)):r.end>e.r&&(a=(r.end-e.r)/o,t.r=Math.max(t.r,e.r+a)),n.start<e.t?(c=(e.t-n.start)/s,t.t=Math.min(t.t,e.t-c)):n.end>e.b&&(c=(n.end-e.b)/s,t.b=Math.max(t.b,e.b+c))}function QJe(t,e,i){let r=t.drawingArea,{extra:n,additionalAngle:o,padding:s,size:a}=i,c=t.getPointPosition(e,r+n+s,o),d=Math.round(fF(mc(c.angle+zo))),u=net(c.y,a.h,d),h=tet(d),p=iet(c.x,a.w,h);return{visible:!0,x:c.x,y:u,textAlign:h,left:p,top:u,right:p+a.w,bottom:u+a.h}}function JJe(t,e){if(!e)return!0;let{left:i,top:r,right:n,bottom:o}=t;return!(bf({x:i,y:r},e)||bf({x:i,y:o},e)||bf({x:n,y:r},e)||bf({x:n,y:o},e))}function eet(t,e,i){let r=[],n=t._pointLabels.length,o=t.options,{centerPointLabels:s,display:a}=o.pointLabels,c={extra:Hq(o)/2,additionalAngle:s?qn/n:0},d;for(let u=0;u<n;u++){c.padding=i[u],c.size=e[u];let h=QJe(t,u,c);r.push(h),a==="auto"&&(h.visible=JJe(h,d),h.visible&&(d=h))}return r}function tet(t){return t===0||t===180?"center":t<180?"left":"right"}function iet(t,e,i){return i==="right"?t-=e:i==="center"&&(t-=e/2),t}function net(t,e,i){return i===90||i===270?t-=e/2:(i>270||i<90)&&(t-=e),t}function oet(t,e,i){let{left:r,top:n,right:o,bottom:s}=i,{backdropColor:a}=e;if(!kr(a)){let c=_v(e.borderRadius),d=Ma(e.backdropPadding);t.fillStyle=a;let u=r-d.left,h=n-d.top,p=o-r+d.width,f=s-n+d.height;Object.values(c).some(m=>m!==0)?(t.beginPath(),Mx(t,{x:u,y:h,w:p,h:f,radius:c}),t.fill()):t.fillRect(u,h,p,f)}}function set(t,e){let{ctx:i,options:{pointLabels:r}}=t;for(let n=e-1;n>=0;n--){let o=t._pointLabelItems[n];if(!o.visible)continue;let s=r.setContext(t.getPointLabelContext(n));oet(i,s,o);let a=Cs(s.font),{x:c,y:d,textAlign:u}=o;bv(i,t._pointLabels[n],c,d+a.lineHeight/2,a,{color:s.color,textAlign:u,textBaseline:"middle"})}}function Kpe(t,e,i,r){let{ctx:n}=t;if(i)n.arc(t.xCenter,t.yCenter,e,0,Yn);else{let o=t.getPointPosition(0,e);n.moveTo(o.x,o.y);for(let s=1;s<r;s++)o=t.getPointPosition(s,e),n.lineTo(o.x,o.y)}}function aet(t,e,i,r,n){let o=t.ctx,s=e.circular,{color:a,lineWidth:c}=e;!s&&!r||!a||!c||i<0||(o.save(),o.strokeStyle=a,o.lineWidth=c,o.setLineDash(n.dash),o.lineDashOffset=n.dashOffset,o.beginPath(),Kpe(t,i,s,r),o.closePath(),o.stroke(),o.restore())}function cet(t,e,i){return sm(t,{label:i,index:e,type:"pointLabel"})}var Bq=class extends Px{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:HA.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){let e=this._padding=Ma(Hq(this.options)/2),i=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+i/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(i,r)/2)}determineDataLimits(){let{min:e,max:i}=this.getMinMax(!1);this.min=Ro(e)&&!isNaN(e)?e:0,this.max=Ro(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Hq(this.options))}generateTickLabels(e){Px.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((i,r)=>{let n=On(this.options.pointLabels.callback,[i,r],this);return n||n===0?n:""}).filter((i,r)=>this.chart.getDataVisibility(r))}fit(){let e=this.options;e.display&&e.pointLabels.display?KJe(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,i,r,n){this.xCenter+=Math.floor((e-i)/2),this.yCenter+=Math.floor((r-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,i,r,n))}getIndexAngle(e){let i=Yn/(this._pointLabels.length||1),r=this.options.startAngle||0;return mc(e*i+qd(r))}getDistanceFromCenterForValue(e){if(kr(e))return NaN;let i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*i:(e-this.min)*i}getValueForDistanceFromCenter(e){if(kr(e))return NaN;let i=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(e){let i=this._pointLabels||[];if(e>=0&&e<i.length){let r=i[e];return cet(this.getContext(),e,r)}}getPointPosition(e,i,r=0){let n=this.getIndexAngle(e)-zo+r;return{x:Math.cos(n)*i+this.xCenter,y:Math.sin(n)*i+this.yCenter,angle:n}}getPointPositionForValue(e,i){return this.getPointPosition(e,this.getDistanceFromCenterForValue(i))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){let{left:i,top:r,right:n,bottom:o}=this._pointLabelItems[e];return{left:i,top:r,right:n,bottom:o}}drawBackground(){let{backgroundColor:e,grid:{circular:i}}=this.options;if(e){let r=this.ctx;r.save(),r.beginPath(),Kpe(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){let e=this.ctx,i=this.options,{angleLines:r,grid:n,border:o}=i,s=this._pointLabels.length,a,c,d;if(i.pointLabels.display&&set(this,s),n.display&&this.ticks.forEach((u,h)=>{if(h!==0||h===0&&this.min<0){c=this.getDistanceFromCenterForValue(u.value);let p=this.getContext(h),f=n.setContext(p),m=o.setContext(p);aet(this,f,c,s,m)}}),r.display){for(e.save(),a=s-1;a>=0;a--){let u=r.setContext(this.getPointLabelContext(a)),{color:h,lineWidth:p}=u;!p||!h||(e.lineWidth=p,e.strokeStyle=h,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,c=this.getDistanceFromCenterForValue(i.ticks.reverse?this.min:this.max),d=this.getPointPosition(a,c),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(d.x,d.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){let e=this.ctx,i=this.options,r=i.ticks;if(!r.display)return;let n=this.getIndexAngle(0),o,s;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(n),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,c)=>{if(c===0&&this.min>=0&&!i.reverse)return;let d=r.setContext(this.getContext(c)),u=Cs(d.font);if(o=this.getDistanceFromCenterForValue(this.ticks[c].value),d.showLabelBackdrop){e.font=u.string,s=e.measureText(a.label).width,e.fillStyle=d.backdropColor;let h=Ma(d.backdropPadding);e.fillRect(-s/2-h.left,-o-u.size/2-h.top,s+h.width,u.size+h.height)}bv(e,a.label,0,-o,u,{color:d.color,strokeColor:d.textStrokeColor,strokeWidth:d.textStrokeWidth})}),e.restore()}drawTitle(){}},BF={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},bc=Object.keys(BF);function Epe(t,e){return t-e}function Tpe(t,e){if(kr(e))return null;let i=t._adapter,{parser:r,round:n,isoWeekday:o}=t._parseOpts,s=e;return typeof r=="function"&&(s=r(s)),Ro(s)||(s=typeof r=="string"?i.parse(s,r):i.parse(s)),s===null?null:(n&&(s=n==="week"&&(L_(o)||o===!0)?i.startOf(s,"isoWeek",o):i.startOf(s,n)),+s)}function Rpe(t,e,i,r){let n=bc.length;for(let o=bc.indexOf(t);o<n-1;++o){let s=BF[bc[o]],a=s.steps?s.steps:Number.MAX_SAFE_INTEGER;if(s.common&&Math.ceil((i-e)/(a*s.size))<=r)return bc[o]}return bc[n-1]}function det(t,e,i,r,n){for(let o=bc.length-1;o>=bc.indexOf(i);o--){let s=bc[o];if(BF[s].common&&t._adapter.diff(n,r,s)>=e-1)return s}return bc[i?bc.indexOf(i):0]}function uet(t){for(let e=bc.indexOf(t)+1,i=bc.length;e<i;++e)if(BF[bc[e]].common)return bc[e]}function Ape(t,e,i){if(!i)t[e]=!0;else if(i.length){let{lo:r,hi:n}=pF(i,e),o=i[r]>=e?i[r]:i[n];t[o]=!0}}function het(t,e,i,r){let n=t._adapter,o=+n.startOf(e[0].value,r),s=e[e.length-1].value,a,c;for(a=o;a<=s;a=+n.add(a,1,r))c=i[a],c>=0&&(e[c].major=!0);return e}function Ipe(t,e,i){let r=[],n={},o=e.length,s,a;for(s=0;s<o;++s)a=e[s],n[a]=s,r.push({value:a,major:!1});return o===0||!i?r:het(t,r,n,i)}var Vq=(()=>{class t extends V_{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(i){super(i),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(i,r={}){let n=i.time||(i.time={}),o=this._adapter=new CZe._date(i.adapters.date);o.init(r),Tx(n.displayFormats,o.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(i),this._normalized=r.normalized}parse(i,r){return i===void 0?null:Tpe(this,i)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let i=this.options,r=this._adapter,n=i.time.unit||"day",{min:o,max:s,minDefined:a,maxDefined:c}=this.getUserBounds();function d(u){!a&&!isNaN(u.min)&&(o=Math.min(o,u.min)),!c&&!isNaN(u.max)&&(s=Math.max(s,u.max))}(!a||!c)&&(d(this._getLabelBounds()),(i.bounds!=="ticks"||i.ticks.source!=="labels")&&d(this.getMinMax(!1))),o=Ro(o)&&!isNaN(o)?o:+r.startOf(Date.now(),n),s=Ro(s)&&!isNaN(s)?s:+r.endOf(Date.now(),n)+1,this.min=Math.min(o,s-1),this.max=Math.max(o+1,s)}_getLabelBounds(){let i=this.getLabelTimestamps(),r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return i.length&&(r=i[0],n=i[i.length-1]),{min:r,max:n}}buildTicks(){let i=this.options,r=i.time,n=i.ticks,o=n.source==="labels"?this.getLabelTimestamps():this._generate();i.bounds==="ticks"&&o.length&&(this.min=this._userMin||o[0],this.max=this._userMax||o[o.length-1]);let s=this.min,a=this.max,c=lfe(o,s,a);return this._unit=r.unit||(n.autoSkip?Rpe(r.minUnit,this.min,this.max,this._getLabelCapacity(s)):det(this,c.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:uet(this._unit),this.initOffsets(o),i.reverse&&c.reverse(),Ipe(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(i=>+i.value))}initOffsets(i=[]){let r=0,n=0,o,s;this.options.offset&&i.length&&(o=this.getDecimalForValue(i[0]),i.length===1?r=1-o:r=(this.getDecimalForValue(i[1])-o)/2,s=this.getDecimalForValue(i[i.length-1]),i.length===1?n=s:n=(s-this.getDecimalForValue(i[i.length-2]))/2);let a=i.length<3?.5:.25;r=Hs(r,0,a),n=Hs(n,0,a),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){let i=this._adapter,r=this.min,n=this.max,o=this.options,s=o.time,a=s.unit||Rpe(s.minUnit,r,n,this._getLabelCapacity(r)),c=Ki(o.ticks.stepSize,1),d=a==="week"?s.isoWeekday:!1,u=L_(d)||d===!0,h={},p=r,f,m;if(u&&(p=+i.startOf(p,"isoWeek",d)),p=+i.startOf(p,u?"day":a),i.diff(n,r,a)>1e5*c)throw new Error(r+" and "+n+" are too far apart with stepSize of "+c+" "+a);let g=o.ticks.source==="data"&&this.getDataTimestamps();for(f=p,m=0;f<n;f=+i.add(f,c,a),m++)Ape(h,f,g);return(f===n||o.bounds==="ticks"||m===1)&&Ape(h,f,g),Object.keys(h).sort(Epe).map(y=>+y)}getLabelForValue(i){let r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(i,n.tooltipFormat):r.format(i,n.displayFormats.datetime)}format(i,r){let o=this.options.time.displayFormats,s=this._unit,a=r||o[s];return this._adapter.format(i,a)}_tickFormatFunction(i,r,n,o){let s=this.options,a=s.ticks.callback;if(a)return On(a,[i,r,n],this);let c=s.time.displayFormats,d=this._unit,u=this._majorUnit,h=d&&c[d],p=u&&c[u],f=n[r],m=u&&p&&f&&f.major;return this._adapter.format(i,o||(m?p:h))}generateTickLabels(i){let r,n,o;for(r=0,n=i.length;r<n;++r)o=i[r],o.label=this._tickFormatFunction(o.value,r,i)}getDecimalForValue(i){return i===null?NaN:(i-this.min)/(this.max-this.min)}getPixelForValue(i){let r=this._offsets,n=this.getDecimalForValue(i);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(i){let r=this._offsets,n=this.getDecimalForPixel(i)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(i){let r=this.options.ticks,n=this.ctx.measureText(i).width,o=qd(this.isHorizontal()?r.maxRotation:r.minRotation),s=Math.cos(o),a=Math.sin(o),c=this._resolveTickFontOptions(0).size;return{w:n*s+c*a,h:n*a+c*s}}_getLabelCapacity(i){let r=this.options.time,n=r.displayFormats,o=n[r.unit]||n.millisecond,s=this._tickFormatFunction(i,0,Ipe(this,[i],this._majorUnit),o),a=this._getLabelSize(s),c=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return c>0?c:1}getDataTimestamps(){let i=this._cache.data||[],r,n;if(i.length)return i;let o=this.getMatchingVisibleMetas();if(this._normalized&&o.length)return this._cache.data=o[0].controller.getAllParsedValues(this);for(r=0,n=o.length;r<n;++r)i=i.concat(o[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){let i=this._cache.labels||[],r,n;if(i.length)return i;let o=this.getLabels();for(r=0,n=o.length;r<n;++r)i.push(Tpe(this,o[r]));return this._cache.labels=this._normalized?i:this.normalize(i)}normalize(i){return YU(i.sort(Epe))}}return t})();function IF(t,e,i){let r=0,n=t.length-1,o,s,a,c;i?(e>=t[r].pos&&e<=t[n].pos&&({lo:r,hi:n}=vf(t,"pos",e)),{pos:o,time:a}=t[r],{pos:s,time:c}=t[n]):(e>=t[r].time&&e<=t[n].time&&({lo:r,hi:n}=vf(t,"time",e)),{time:o,pos:a}=t[r],{time:s,pos:c}=t[n]);let d=s-o;return d?a+(c-a)*(e-o)/d:a}var jq=class extends Vq{static id="timeseries";static defaults=Vq.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){let e=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(e);this._minPos=IF(i,this.min),this._tableRange=IF(i,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){let{min:i,max:r}=this,n=[],o=[],s,a,c,d,u;for(s=0,a=e.length;s<a;++s)d=e[s],d>=i&&d<=r&&n.push(d);if(n.length<2)return[{time:i,pos:0},{time:r,pos:1}];for(s=0,a=n.length;s<a;++s)u=n[s+1],c=n[s-1],d=n[s],Math.round((u+c)/2)!==d&&o.push({time:d,pos:s/(a-1)});return o}_generate(){let e=this.min,i=this.max,r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(i)||r.length===1)&&r.push(i),r.sort((n,o)=>n-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;let i=this.getDataTimestamps(),r=this.getLabelTimestamps();return i.length&&r.length?e=this.normalize(i.concat(r)):e=i.length?i:r,e=this._cache.all=e,e}getDecimalForValue(e){return(IF(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){let i=this._offsets,r=this.getDecimalForPixel(e)/i.factor-i.end;return IF(this._table,r*this._tableRange+this._minPos,!0)}},fet=Object.freeze({__proto__:null,CategoryScale:qJe,LinearScale:Lq,LogarithmicScale:Fq,RadialLinearScale:Bq,TimeScale:Vq,TimeSeriesScale:jq}),Zpe=[wZe,$Qe,jJe,fet];var pet=typeof global=="object"&&global&&global.Object===Object&&global,VF=pet;var met=typeof self=="object"&&self&&self.Object===Object&&self,get=VF||met||Function("return this")(),Yd=get;var vet=Yd.Symbol,Fx=vet;var Qpe=Object.prototype,bet=Qpe.hasOwnProperty,_et=Qpe.toString,QA=Fx?Fx.toStringTag:void 0;function yet(t){var e=bet.call(t,QA),i=t[QA];try{t[QA]=void 0;var r=!0}catch{}var n=_et.call(t);return r&&(e?t[QA]=i:delete t[QA]),n}var Jpe=yet;var wet=Object.prototype,Cet=wet.toString;function xet(t){return Cet.call(t)}var eme=xet;var Eet="[object Null]",Tet="[object Undefined]",tme=Fx?Fx.toStringTag:void 0;function Ret(t){return t==null?t===void 0?Tet:Eet:tme&&tme in Object(t)?Jpe(t):eme(t)}var xv=Ret;function Aet(t){return t!=null&&typeof t=="object"}var xf=Aet;var Iet=Array.isArray,JA=Iet;function Det(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var _c=Det;function Met(t){return t}var jF=Met;var ket="[object AsyncFunction]",Oet="[object Function]",Net="[object GeneratorFunction]",Pet="[object Proxy]";function Let(t){if(!_c(t))return!1;var e=xv(t);return e==Oet||e==Net||e==ket||e==Pet}var Hx=Let;var Fet=Yd["__core-js_shared__"],zF=Fet;var ime=function(){var t=/[^.]+$/.exec(zF&&zF.keys&&zF.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Het(t){return!!ime&&ime in t}var rme=Het;var Bet=Function.prototype,Vet=Bet.toString;function jet(t){if(t!=null){try{return Vet.call(t)}catch{}try{return t+""}catch{}}return""}var nme=jet;var zet=/[\\^$.*+?()[\]{}|]/g,Wet=/^\[object .+?Constructor\]$/,Uet=Function.prototype,qet=Object.prototype,Yet=Uet.toString,$et=qet.hasOwnProperty,Get=RegExp("^"+Yet.call($et).replace(zet,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Xet(t){if(!_c(t)||rme(t))return!1;var e=Hx(t)?Get:Wet;return e.test(nme(t))}var ome=Xet;function Ket(t,e){return t?.[e]}var sme=Ket;function Zet(t,e){var i=sme(t,e);return ome(i)?i:void 0}var Bx=Zet;var ame=Object.create,Qet=function(){function t(){}return function(e){if(!_c(e))return{};if(ame)return ame(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}(),lme=Qet;function Jet(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}var cme=Jet;function ett(t,e){var i=-1,r=t.length;for(e||(e=Array(r));++i<r;)e[i]=t[i];return e}var dme=ett;var ttt=800,itt=16,rtt=Date.now;function ntt(t){var e=0,i=0;return function(){var r=rtt(),n=itt-(r-i);if(i=r,n>0){if(++e>=ttt)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var ume=ntt;function ott(t){return function(){return t}}var hme=ott;var stt=function(){try{var t=Bx(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Vx=stt;var att=Vx?function(t,e){return Vx(t,"toString",{configurable:!0,enumerable:!1,value:hme(e),writable:!0})}:jF,fme=att;var ltt=ume(fme),pme=ltt;var ctt=9007199254740991,dtt=/^(?:0|[1-9]\d*)$/;function utt(t,e){var i=typeof t;return e=e??ctt,!!e&&(i=="number"||i!="symbol"&&dtt.test(t))&&t>-1&&t%1==0&&t<e}var WF=utt;function htt(t,e,i){e=="__proto__"&&Vx?Vx(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}var jx=htt;function ftt(t,e){return t===e||t!==t&&e!==e}var Sv=ftt;var ptt=Object.prototype,mtt=ptt.hasOwnProperty;function gtt(t,e,i){var r=t[e];(!(mtt.call(t,e)&&Sv(r,i))||i===void 0&&!(e in t))&&jx(t,e,i)}var mme=gtt;function vtt(t,e,i,r){var n=!i;i||(i={});for(var o=-1,s=e.length;++o<s;){var a=e[o],c=r?r(i[a],t[a],a,i,t):void 0;c===void 0&&(c=t[a]),n?jx(i,a,c):mme(i,a,c)}return i}var gme=vtt;var vme=Math.max;function btt(t,e,i){return e=vme(e===void 0?t.length-1:e,0),function(){for(var r=arguments,n=-1,o=vme(r.length-e,0),s=Array(o);++n<o;)s[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=i(s),cme(t,this,a)}}var bme=btt;function _tt(t,e){return pme(bme(t,e,jF),t+"")}var _me=_tt;var ytt=9007199254740991;function wtt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=ytt}var UF=wtt;function Ctt(t){return t!=null&&UF(t.length)&&!Hx(t)}var zx=Ctt;function xtt(t,e,i){if(!_c(i))return!1;var r=typeof e;return(r=="number"?zx(i)&&WF(e,i.length):r=="string"&&e in i)?Sv(i[e],t):!1}var yme=xtt;function Stt(t){return _me(function(e,i){var r=-1,n=i.length,o=n>1?i[n-1]:void 0,s=n>2?i[2]:void 0;for(o=t.length>3&&typeof o=="function"?(n--,o):void 0,s&&yme(i[0],i[1],s)&&(o=n<3?void 0:o,n=1),e=Object(e);++r<n;){var a=i[r];a&&t(e,a,r,o)}return e})}var wme=Stt;var Ett=Object.prototype;function Ttt(t){var e=t&&t.constructor,i=typeof e=="function"&&e.prototype||Ett;return t===i}var qF=Ttt;function Rtt(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r}var Cme=Rtt;var Att="[object Arguments]";function Itt(t){return xf(t)&&xv(t)==Att}var Uq=Itt;var xme=Object.prototype,Dtt=xme.hasOwnProperty,Mtt=xme.propertyIsEnumerable,ktt=Uq(function(){return arguments}())?Uq:function(t){return xf(t)&&Dtt.call(t,"callee")&&!Mtt.call(t,"callee")},eI=ktt;function Ott(){return!1}var Sme=Ott;var Rme=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Eme=Rme&&typeof module=="object"&&module&&!module.nodeType&&module,Ntt=Eme&&Eme.exports===Rme,Tme=Ntt?Yd.Buffer:void 0,Ptt=Tme?Tme.isBuffer:void 0,Ltt=Ptt||Sme,YF=Ltt;var Ftt="[object Arguments]",Htt="[object Array]",Btt="[object Boolean]",Vtt="[object Date]",jtt="[object Error]",ztt="[object Function]",Wtt="[object Map]",Utt="[object Number]",qtt="[object Object]",Ytt="[object RegExp]",$tt="[object Set]",Gtt="[object String]",Xtt="[object WeakMap]",Ktt="[object ArrayBuffer]",Ztt="[object DataView]",Qtt="[object Float32Array]",Jtt="[object Float64Array]",eit="[object Int8Array]",tit="[object Int16Array]",iit="[object Int32Array]",rit="[object Uint8Array]",nit="[object Uint8ClampedArray]",oit="[object Uint16Array]",sit="[object Uint32Array]",io={};io[Qtt]=io[Jtt]=io[eit]=io[tit]=io[iit]=io[rit]=io[nit]=io[oit]=io[sit]=!0;io[Ftt]=io[Htt]=io[Ktt]=io[Btt]=io[Ztt]=io[Vtt]=io[jtt]=io[ztt]=io[Wtt]=io[Utt]=io[qtt]=io[Ytt]=io[$tt]=io[Gtt]=io[Xtt]=!1;function ait(t){return xf(t)&&UF(t.length)&&!!io[xv(t)]}var Ame=ait;function lit(t){return function(e){return t(e)}}var Ime=lit;var Dme=typeof exports=="object"&&exports&&!exports.nodeType&&exports,tI=Dme&&typeof module=="object"&&module&&!module.nodeType&&module,cit=tI&&tI.exports===Dme,qq=cit&&VF.process,dit=function(){try{var t=tI&&tI.require&&tI.require("util").types;return t||qq&&qq.binding&&qq.binding("util")}catch{}}(),Yq=dit;var Mme=Yq&&Yq.isTypedArray,uit=Mme?Ime(Mme):Ame,$F=uit;var hit=Object.prototype,fit=hit.hasOwnProperty;function pit(t,e){var i=JA(t),r=!i&&eI(t),n=!i&&!r&&YF(t),o=!i&&!r&&!n&&$F(t),s=i||r||n||o,a=s?Cme(t.length,String):[],c=a.length;for(var d in t)(e||fit.call(t,d))&&!(s&&(d=="length"||n&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||WF(d,c)))&&a.push(d);return a}var kme=pit;function mit(t,e){return function(i){return t(e(i))}}var Ome=mit;function git(t){var e=[];if(t!=null)for(var i in Object(t))e.push(i);return e}var Nme=git;var vit=Object.prototype,bit=vit.hasOwnProperty;function _it(t){if(!_c(t))return Nme(t);var e=qF(t),i=[];for(var r in t)r=="constructor"&&(e||!bit.call(t,r))||i.push(r);return i}var Pme=_it;function yit(t){return zx(t)?kme(t,!0):Pme(t)}var GF=yit;var wit=Bx(Object,"create"),cm=wit;function Cit(){this.__data__=cm?cm(null):{},this.size=0}var Lme=Cit;function xit(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Fme=xit;var Sit="__lodash_hash_undefined__",Eit=Object.prototype,Tit=Eit.hasOwnProperty;function Rit(t){var e=this.__data__;if(cm){var i=e[t];return i===Sit?void 0:i}return Tit.call(e,t)?e[t]:void 0}var Hme=Rit;var Ait=Object.prototype,Iit=Ait.hasOwnProperty;function Dit(t){var e=this.__data__;return cm?e[t]!==void 0:Iit.call(e,t)}var Bme=Dit;var Mit="__lodash_hash_undefined__";function kit(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=cm&&e===void 0?Mit:e,this}var Vme=kit;function Wx(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}Wx.prototype.clear=Lme;Wx.prototype.delete=Fme;Wx.prototype.get=Hme;Wx.prototype.has=Bme;Wx.prototype.set=Vme;var $q=Wx;function Oit(){this.__data__=[],this.size=0}var jme=Oit;function Nit(t,e){for(var i=t.length;i--;)if(Sv(t[i][0],e))return i;return-1}var Ev=Nit;var Pit=Array.prototype,Lit=Pit.splice;function Fit(t){var e=this.__data__,i=Ev(e,t);if(i<0)return!1;var r=e.length-1;return i==r?e.pop():Lit.call(e,i,1),--this.size,!0}var zme=Fit;function Hit(t){var e=this.__data__,i=Ev(e,t);return i<0?void 0:e[i][1]}var Wme=Hit;function Bit(t){return Ev(this.__data__,t)>-1}var Ume=Bit;function Vit(t,e){var i=this.__data__,r=Ev(i,t);return r<0?(++this.size,i.push([t,e])):i[r][1]=e,this}var qme=Vit;function Ux(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}Ux.prototype.clear=jme;Ux.prototype.delete=zme;Ux.prototype.get=Wme;Ux.prototype.has=Ume;Ux.prototype.set=qme;var Tv=Ux;var jit=Bx(Yd,"Map"),XF=jit;function zit(){this.size=0,this.__data__={hash:new $q,map:new(XF||Tv),string:new $q}}var Yme=zit;function Wit(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var $me=Wit;function Uit(t,e){var i=t.__data__;return $me(e)?i[typeof e=="string"?"string":"hash"]:i.map}var Rv=Uit;function qit(t){var e=Rv(this,t).delete(t);return this.size-=e?1:0,e}var Gme=qit;function Yit(t){return Rv(this,t).get(t)}var Xme=Yit;function $it(t){return Rv(this,t).has(t)}var Kme=$it;function Git(t,e){var i=Rv(this,t),r=i.size;return i.set(t,e),this.size+=i.size==r?0:1,this}var Zme=Git;function qx(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}qx.prototype.clear=Yme;qx.prototype.delete=Gme;qx.prototype.get=Xme;qx.prototype.has=Kme;qx.prototype.set=Zme;var Qme=qx;var Xit=Ome(Object.getPrototypeOf,Object),KF=Xit;var Kit="[object Object]",Zit=Function.prototype,Qit=Object.prototype,Jme=Zit.toString,Jit=Qit.hasOwnProperty,ert=Jme.call(Object);function trt(t){if(!xf(t)||xv(t)!=Kit)return!1;var e=KF(t);if(e===null)return!0;var i=Jit.call(e,"constructor")&&e.constructor;return typeof i=="function"&&i instanceof i&&Jme.call(i)==ert}var ege=trt;function irt(){this.__data__=new Tv,this.size=0}var tge=irt;function rrt(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}var ige=rrt;function nrt(t){return this.__data__.get(t)}var rge=nrt;function ort(t){return this.__data__.has(t)}var nge=ort;var srt=200;function art(t,e){var i=this.__data__;if(i instanceof Tv){var r=i.__data__;if(!XF||r.length<srt-1)return r.push([t,e]),this.size=++i.size,this;i=this.__data__=new Qme(r)}return i.set(t,e),this.size=i.size,this}var oge=art;function Yx(t){var e=this.__data__=new Tv(t);this.size=e.size}Yx.prototype.clear=tge;Yx.prototype.delete=ige;Yx.prototype.get=rge;Yx.prototype.has=nge;Yx.prototype.set=oge;var sge=Yx;var dge=typeof exports=="object"&&exports&&!exports.nodeType&&exports,age=dge&&typeof module=="object"&&module&&!module.nodeType&&module,lrt=age&&age.exports===dge,lge=lrt?Yd.Buffer:void 0,cge=lge?lge.allocUnsafe:void 0;function crt(t,e){if(e)return t.slice();var i=t.length,r=cge?cge(i):new t.constructor(i);return t.copy(r),r}var uge=crt;var drt=Yd.Uint8Array,Gq=drt;function urt(t){var e=new t.constructor(t.byteLength);return new Gq(e).set(new Gq(t)),e}var hge=urt;function hrt(t,e){var i=e?hge(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}var fge=hrt;function frt(t){return typeof t.constructor=="function"&&!qF(t)?lme(KF(t)):{}}var pge=frt;function prt(t){return function(e,i,r){for(var n=-1,o=Object(e),s=r(e),a=s.length;a--;){var c=s[t?a:++n];if(i(o[c],c,o)===!1)break}return e}}var mge=prt;var mrt=mge(),gge=mrt;function grt(t,e,i){(i!==void 0&&!Sv(t[e],i)||i===void 0&&!(e in t))&&jx(t,e,i)}var iI=grt;function vrt(t){return xf(t)&&zx(t)}var vge=vrt;function brt(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var rI=brt;function _rt(t){return gme(t,GF(t))}var bge=_rt;function yrt(t,e,i,r,n,o,s){var a=rI(t,i),c=rI(e,i),d=s.get(c);if(d){iI(t,i,d);return}var u=o?o(a,c,i+"",t,e,s):void 0,h=u===void 0;if(h){var p=JA(c),f=!p&&YF(c),m=!p&&!f&&$F(c);u=c,p||f||m?JA(a)?u=a:vge(a)?u=dme(a):f?(h=!1,u=uge(c,!0)):m?(h=!1,u=fge(c,!0)):u=[]:ege(c)||eI(c)?(u=a,eI(a)?u=bge(a):(!_c(a)||Hx(a))&&(u=pge(c))):h=!1}h&&(s.set(c,u),n(u,c,r,o,s),s.delete(c)),iI(t,i,u)}var _ge=yrt;function yge(t,e,i,r,n){t!==e&&gge(e,function(o,s){if(n||(n=new sge),_c(o))_ge(t,e,s,i,yge,r,n);else{var a=r?r(rI(t,s),o,s+"",t,e,n):void 0;a===void 0&&(a=o),iI(t,s,a)}},GF)}var wge=yge;var wrt=wme(function(t,e,i){wge(t,e,i)}),ZF=wrt;var Cge=new St("Configuration for ngCharts");function xge(...t){return{registerables:[...Zpe,...t]}}function Sge(...t){let e=ZF({},...t);return{provide:Cge,useValue:e}}var Crt=(()=>{let e=class e{constructor(){this.colorschemesOptions=new Ta(void 0)}setColorschemesOptions(r){this.pColorschemesOptions=r,this.colorschemesOptions.next(r)}getColorschemesOptions(){return this.pColorschemesOptions}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),QF=(()=>{let e=class e{constructor(r,n,o,s){this.zone=n,this.themeService=o,this.type="bar",this.plugins=[],this.chartClick=new Nt,this.chartHover=new Nt,this.subs=[],this.themeOverrides={},s?.registerables&&Lx.register(...s.registerables),s?.defaults&&to.set(s.defaults),this.ctx=r.nativeElement.getContext("2d"),this.subs.push(this.themeService.colorschemesOptions.pipe(Kp()).subscribe(a=>this.themeChanged(a)))}ngOnChanges(r){let n=["type"],o=Object.getOwnPropertyNames(r);if(o.some(s=>n.includes(s))||o.every(s=>r[s].isFirstChange()))this.render();else{let s=this.getChartConfiguration();this.chart&&(Object.assign(this.chart.config.data,s.data),this.chart.config.plugins&&Object.assign(this.chart.config.plugins,s.plugins),this.chart.config.options&&Object.assign(this.chart.config.options,s.options)),this.update()}}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.subs.forEach(r=>r.unsubscribe())}render(){return this.chart&&this.chart.destroy(),this.zone.runOutsideAngular(()=>this.chart=new Lx(this.ctx,this.getChartConfiguration()))}update(r){this.chart&&this.zone.runOutsideAngular(()=>this.chart?.update(r))}hideDataset(r,n){this.chart&&(this.chart.getDatasetMeta(r).hidden=n,this.update())}isDatasetHidden(r){return this.chart?.getDatasetMeta(r)?.hidden}toBase64Image(){return this.chart?.toBase64Image()}themeChanged(r){this.themeOverrides=r,this.chart&&(this.chart.config.options&&Object.assign(this.chart.config.options,this.getChartOptions()),this.update())}getChartOptions(){return ZF({onHover:(r,n)=>{!this.chartHover.observed&&!this.chartHover.observers?.length||this.zone.run(()=>this.chartHover.emit({event:r,active:n}))},onClick:(r,n)=>{!this.chartClick.observed&&!this.chartClick.observers?.length||this.zone.run(()=>this.chartClick.emit({event:r,active:n}))}},this.themeOverrides,this.options,{plugins:{legend:{display:this.legend}}})}getChartConfiguration(){return{type:this.type,data:this.getChartData(),options:this.getChartOptions(),plugins:this.plugins}}getChartData(){return this.data?this.data:{labels:this.labels||[],datasets:this.datasets||[]}}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(ni),Te(Crt),Te(Cge,8))},e.\u0275dir=Ot({type:e,selectors:[["canvas","baseChart",""]],inputs:{type:"type",legend:"legend",data:"data",options:"options",plugins:"plugins",labels:"labels",datasets:"datasets"},outputs:{chartClick:"chartClick",chartHover:"chartHover"},exportAs:["base-chart"],standalone:!0,features:[Li]});let t=e;return t})();function Ege(t){return t&&t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function Tge(t){return t}function Xq(t,e){e=e||{};let i=e.delimiter||".",r=e.maxDepth,n=e.transformKey||Tge,o={};function s(a,c,d){d=d||1,Object.keys(a).forEach(function(u){let h=a[u],p=e.safe&&Array.isArray(h),f=Object.prototype.toString.call(h),m=Ege(h),g=f==="[object Object]"||f==="[object Array]",y=c?c+i+n(u):n(u);if(!p&&!m&&g&&Object.keys(h).length&&(!e.maxDepth||d<r))return s(h,y,d+1);o[y]=h})}return s(t),o}function Kq(t,e){e=e||{};let i=e.delimiter||".",r=e.overwrite||!1,n=e.transformKey||Tge,o={};if(Ege(t)||Object.prototype.toString.call(t)!=="[object Object]")return t;function a(u){let h=Number(u);return isNaN(h)||u.indexOf(".")!==-1||e.object?u:h}function c(u,h,p){return Object.keys(p).reduce(function(f,m){return f[u+i+m]=p[m],f},h)}function d(u){let h=Object.prototype.toString.call(u),p=h==="[object Array]",f=h==="[object Object]";if(u){if(p)return!u.length;if(f)return!Object.keys(u).length}else return!0}return t=Object.keys(t).reduce(function(u,h){let p=Object.prototype.toString.call(t[h]);return!(p==="[object Object]"||p==="[object Array]")||d(t[h])?(u[h]=t[h],u):c(h,u,Xq(t[h],e))},{}),Object.keys(t).forEach(function(u){let h=u.split(i).map(n),p=a(h.shift()),f=a(h[0]),m=o;for(;f!==void 0;){if(p==="__proto__")return;let g=Object.prototype.toString.call(m[p]),y=g==="[object Object]"||g==="[object Array]";if(!r&&!y&&typeof m[p]<"u")return;(r&&!y||!r&&m[p]==null)&&(m[p]=typeof f=="number"&&!e.object?[]:{}),m=m[p],h.length>0&&(p=a(h.shift()),f=a(h[0]))}m[p]=Kq(t[u],e)}),o}var Qq=class{translations;constructor(e){this.translations=e}getTranslation(e){return qi(this.translations.get(e)||{})}},Dge=new St("TRANSLOCO_LOADER");function Rge(t,e){return t&&(Object.prototype.hasOwnProperty.call(t,e)?t[e]:e.split(".").reduce((i,r)=>i?.[r],t))}function xrt(t,e,i){t=Ke({},t);let r=e.split("."),n=r.length-1;return r.reduce((o,s,a)=>(a===n?o[s]=i:o[s]=Array.isArray(o[s])?o[s].slice():Ke({},o[s]),o&&o[s]),t),t}function Mge(t){return t?Array.isArray(t)?t.length:r7(t)?Object.keys(t).length:t?t.length:0:0}function Srt(t){return Mge(t)===0}function Ert(t){return typeof t=="function"}function nI(t){return typeof t=="string"}function r7(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}function kge(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,(e,i)=>i==0?e.toLowerCase():e.toUpperCase()).replace(/\s+|_|-|\//g,"")}function Jq(t){return t==null}function Age(t){return Jq(t)===!1}function n7(t){return t&&typeof t.scope=="string"}function Trt(t){return Array.isArray(t)&&t.every(n7)}function Rrt(t){return t&&r7(t.loader)}function Art(t){return Kq(t)}function Ige(t){return Xq(t,{safe:!0})}var $x=new St("TRANSLOCO_CONFIG",{providedIn:"root",factory:()=>oI}),oI={defaultLang:"en",reRenderOnLangChange:!1,prodMode:!1,failedRetries:2,fallbackLang:[],availableLangs:[],missingHandler:{logMissingKey:!0,useFallbackTranslation:!1,allowEmpty:!1},flatten:{aot:!1},interpolation:["{{","}}"]};function Irt(t={}){return Lt(Ke(Ke({},oI),t),{missingHandler:Ke(Ke({},oI.missingHandler),t.missingHandler),flatten:Ke(Ke({},oI.flatten),t.flatten)})}var Oge=new St("TRANSLOCO_TRANSPILER"),Drt=(()=>{class t{interpolationMatcher;constructor(i){this.interpolationMatcher=Mrt(i??oI)}transpile(i,r={},n,o){return nI(i)?i.replace(this.interpolationMatcher,(s,a)=>(a=a.trim(),Age(r[a])?r[a]:Age(n[a])?this.transpile(n[a],r,n,o):"")):(r&&(r7(i)?i=this.handleObject(i,r,n,o):Array.isArray(i)&&(i=this.handleArray(i,r,n,o))),i)}handleObject(i,r={},n,o){let s=i;return Object.keys(r).forEach(a=>{let c=Rge(s,a),d=Rge(r,a),u=this.transpile(c,d,n,o);s=xrt(s,a,u)}),s}handleArray(i,r={},n,o){return i.map(s=>this.transpile(s,r,n,o))}static \u0275fac=function(r){return new(r||t)(lt($x,8))};static \u0275prov=kt({token:t,factory:t.\u0275fac})}return t})();function Mrt(t){let[e,i]=t.interpolation;return new RegExp(`${e}(.*?)${i}`,"g")}var Nge=new St("TRANSLOCO_MISSING_HANDLER"),krt=(()=>{class t{handle(i,r){if(r.missingHandler.logMissingKey&&!r.prodMode){let n=`Missing translation for '${i}'`;console.warn(`%c ${n}`,"font-size: 12px; color: red")}return i}static \u0275fac=function(r){return new(r||t)};static \u0275prov=kt({token:t,factory:t.\u0275fac})}return t})(),Pge=new St("TRANSLOCO_INTERCEPTOR"),Ort=(()=>{class t{preSaveTranslation(i){return i}preSaveTranslationKey(i,r){return r}static \u0275fac=function(r){return new(r||t)};static \u0275prov=kt({token:t,factory:t.\u0275fac})}return t})(),Lge=new St("TRANSLOCO_FALLBACK_STRATEGY"),Nrt=(()=>{class t{userConfig;constructor(i){this.userConfig=i}getNextLangs(){let i=this.userConfig.fallbackLang;if(!i)throw new Error("When using the default fallback, a fallback language must be provided in the config!");return Array.isArray(i)?i:[i]}static \u0275fac=function(r){return new(r||t)(lt($x))};static \u0275prov=kt({token:t,factory:t.\u0275fac})}return t})();function sI(t){if(!t)return"";let e=t.split("/");return e.pop(),e.join("/")}function Av(t){return t?t.split("/").pop():""}function e7(t,e,i="|"){if(nI(t)){let r=t.split(i),n=r.pop();return n===e?[!0,r.toString()]:[!1,n]}return[!1,""]}function Prt(t,e){let[i]=e7(e,"static");return i?!1:!!t.config.reRenderOnLangChange}function Lrt(t){return t?e=>e:Vo(1)}function Frt(t,e){return Object.keys(t).reduce((i,r)=>(i[`${e}/${r}`]=t[r],i),{})}function Fge(t,e){return Rrt(t)?Frt(t.loader,e):void 0}function Zq(t){return{scope:sI(t)||null,langName:Av(t)}}function Hge(t){let{path:e,inlineLoader:i,mainLoader:r,data:n}=t;if(i){let o=i[e];if(Ert(o)===!1)throw`You're using an inline loader but didn't provide a loader for ${e}`;return i[e]().then(s=>s.default?s.default:s)}return r.getTranslation(e,n)}function Hrt({mainLoader:t,path:e,data:i,fallbackPath:r,inlineLoader:n}){return(r?[e,r]:[e]).map(s=>{let a=Hge({path:s,mainLoader:t,inlineLoader:n,data:i});return XR(a).pipe(Gi(c=>({translation:c,lang:s})))})}var Brt;var id=(()=>{class t{loader;parser;missingHandler;interceptor;fallbackStrategy;langChanges$;subscription=null;translations=new Map;cache=new Map;firstFallbackLang;defaultLang="";availableLangs=[];isResolvedMissingOnce=!1;lang;failedLangs=new Set;events=new Ft;events$=this.events.asObservable();config;constructor(i,r,n,o,s,a){this.loader=i,this.parser=r,this.missingHandler=n,this.interceptor=o,this.fallbackStrategy=a,this.loader||(this.loader=new Qq(this.translations)),Brt=this,this.config=JSON.parse(JSON.stringify(s)),this.setAvailableLangs(this.config.availableLangs||[]),this.setFallbackLangForMissingTranslation(this.config),this.setDefaultLang(this.config.defaultLang),this.lang=new Ta(this.getDefaultLang()),this.langChanges$=this.lang.asObservable(),this.subscription=this.events$.subscribe(c=>{c.type==="translationLoadSuccess"&&c.wasFailure&&this.setActiveLang(c.payload.langName)})}getDefaultLang(){return this.defaultLang}setDefaultLang(i){this.defaultLang=i}getActiveLang(){return this.lang.getValue()}setActiveLang(i){return this.parser.onLangChanged?.(i),this.lang.next(i),this.events.next({type:"langChanged",payload:Zq(i)}),this}setAvailableLangs(i){this.availableLangs=i}getAvailableLangs(){return this.availableLangs}load(i,r={}){let n=this.cache.get(i);if(n)return n;let o,s=this._isLangScoped(i),a;s&&(a=sI(i));let c={path:i,mainLoader:this.loader,inlineLoader:r.inlineLoader,data:s?{scope:a}:void 0};if(this.useFallbackTranslation(i)){let u=s?`${a}/${this.firstFallbackLang}`:this.firstFallbackLang,h=Hrt(Lt(Ke({},c),{fallbackPath:u}));o=lf(h)}else{let u=Hge(c);o=XR(u)}let d=o.pipe(ide(this.config.failedRetries),Qc(u=>{if(Array.isArray(u)){u.forEach(h=>{this.handleSuccess(h.lang,h.translation),h.lang!==i&&this.cache.set(h.lang,qi({}))});return}this.handleSuccess(i,u)}),g_(u=>(this.config.prodMode||console.error(`Error while trying to load "${i}"`,u),this.handleFailure(i,r))),ZR(1));return this.cache.set(i,d),d}translate(i,r={},n=this.getActiveLang()){if(!i)return i;let{scope:o,resolveLang:s}=this.resolveLangAndScope(n);if(Array.isArray(i))return i.map(d=>this.translate(o?`${o}.${d}`:d,r,s));i=o?`${o}.${i}`:i;let a=this.getTranslation(s),c=a[i];return c?this.parser.transpile(c,r,a,i):this._handleMissingKey(i,c,r)}selectTranslate(i,r,n,o=!1){let s,a=(d,u)=>this.load(d,u).pipe(Gi(()=>o?this.translateObject(i,r,d):this.translate(i,r,d)));if(Jq(n))return this.langChanges$.pipe(uc(d=>a(d)));if(Trt(n)||n7(n)){let d=Array.isArray(n)?n[0]:n;n=d.scope,s=Fge(d,d.scope)}if(n=n,this.isLang(n)||this.isScopeWithLang(n))return a(n);let c=n;return this.langChanges$.pipe(uc(d=>a(`${c}/${d}`,{inlineLoader:s})))}isScopeWithLang(i){return this.isLang(Av(i))}translateObject(i,r={},n=this.getActiveLang()){if(nI(i)||Array.isArray(i)){let{resolveLang:s,scope:a}=this.resolveLangAndScope(n);if(Array.isArray(i))return i.map(u=>this.translateObject(a?`${a}.${u}`:u,r,s));let c=this.getTranslation(s);i=a?`${a}.${i}`:i;let d=Art(this.getObjectByKey(c,i));return Srt(d)?this.translate(i,r,n):this.parser.transpile(d,r,c,i)}let o=[];for(let[s,a]of this.getEntries(i))o.push(this.translateObject(s,a,n));return o}selectTranslateObject(i,r,n){if(nI(i)||Array.isArray(i))return this.selectTranslate(i,r,n,!0);let[[o,s],...a]=this.getEntries(i);return this.selectTranslateObject(o,s,n).pipe(Gi(c=>{let d=[c];for(let[u,h]of a)d.push(this.translateObject(u,h,n));return d}))}getTranslation(i){if(i){if(this.isLang(i))return this.translations.get(i)||{};{let{scope:r,resolveLang:n}=this.resolveLangAndScope(i),o=this.translations.get(n)||{};return this.getObjectByKey(o,r)}}return this.translations}selectTranslation(i){let r=this.langChanges$;if(i){let n=Av(i)!==i;this.isLang(i)||n?r=qi(i):r=this.langChanges$.pipe(Gi(o=>`${i}/${o}`))}return r.pipe(uc(n=>this.load(n).pipe(Gi(()=>this.getTranslation(n)))))}setTranslation(i,r=this.getActiveLang(),n={}){let s=Ke(Ke({},{merge:!0,emitChange:!0}),n),a=sI(r),c=i;if(a){let f=this.getMappedScope(a);c=Ige({[f]:i})}let d=a?Av(r):r,u=Ke(Ke({},s.merge&&this.getTranslation(d)),c),h=this.config.flatten.aot?u:Ige(u),p=this.interceptor.preSaveTranslation(h,d);this.translations.set(d,p),s.emitChange&&this.setActiveLang(this.getActiveLang())}setTranslationKey(i,r,n=this.getActiveLang(),o={}){let s=this.interceptor.preSaveTranslationKey(i,r,n),a={[i]:s};this.setTranslation(a,n,Lt(Ke({},o),{merge:!0}))}setFallbackLangForMissingTranslation({fallbackLang:i}){let r=Array.isArray(i)?i[0]:i;i&&this.useFallbackTranslation(r)&&(this.firstFallbackLang=r)}_handleMissingKey(i,r,n){if(this.config.missingHandler.allowEmpty&&r==="")return"";if(!this.isResolvedMissingOnce&&this.useFallbackTranslation()){this.isResolvedMissingOnce=!0;let o=this.translate(i,n,this.firstFallbackLang);return this.isResolvedMissingOnce=!1,o}return this.missingHandler.handle(i,this.getMissingHandlerData(),n)}_isLangScoped(i){return this.getAvailableLangsIds().indexOf(i)===-1}isLang(i){return this.getAvailableLangsIds().indexOf(i)!==-1}_loadDependencies(i,r){let n=Av(i);return this._isLangScoped(i)&&!this.isLoadedTranslation(n)?Jg([this.load(n),this.load(i,{inlineLoader:r})]):this.load(i,{inlineLoader:r})}_completeScopeWithLang(i){return this._isLangScoped(i)&&!this.isLang(Av(i))?`${i}/${this.getActiveLang()}`:i}_setScopeAlias(i,r){this.config.scopeMapping||(this.config.scopeMapping={}),this.config.scopeMapping[i]=r}ngOnDestroy(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.cache.clear()}isLoadedTranslation(i){return Mge(this.getTranslation(i))}getAvailableLangsIds(){let i=this.getAvailableLangs()[0];return nI(i)?this.getAvailableLangs():this.getAvailableLangs().map(r=>r.id)}getMissingHandlerData(){return Lt(Ke({},this.config),{activeLang:this.getActiveLang(),availableLangs:this.availableLangs,defaultLang:this.defaultLang})}useFallbackTranslation(i){return this.config.missingHandler.useFallbackTranslation&&i!==this.firstFallbackLang}handleSuccess(i,r){this.setTranslation(r,i,{emitChange:!1}),this.events.next({wasFailure:!!this.failedLangs.size,type:"translationLoadSuccess",payload:Zq(i)}),this.failedLangs.forEach(n=>this.cache.delete(n)),this.failedLangs.clear()}handleFailure(i,r){Jq(r.failedCounter)&&(r.failedCounter=0,r.fallbackLangs||(r.fallbackLangs=this.fallbackStrategy.getNextLangs(i)));let n=i.split("/"),s=r.fallbackLangs[r.failedCounter];if(this.failedLangs.add(i),this.cache.has(s))return this.handleSuccess(s,this.getTranslation(s)),qC;let a=s===n[n.length-1];if(!s||a){let d="Unable to load translation and all the fallback languages";throw n.length>1&&(d+=", did you misspelled the scope name?"),new Error(d)}let c=s;return n.length>1&&(n[n.length-1]=s,c=n.join("/")),r.failedCounter++,this.events.next({type:"translationLoadFailure",payload:Zq(i)}),this.load(c,r)}getMappedScope(i){let{scopeMapping:r={}}=this.config;return r[i]||kge(i)}resolveLangAndScope(i){let r=i,n;if(this._isLangScoped(i)){let o=Av(i),s=this.isLang(o);r=s?o:this.getActiveLang(),n=this.getMappedScope(s?sI(i):i)}return{scope:n,resolveLang:r}}getObjectByKey(i,r){let n={},o=`${r}.`;for(let s in i)s.startsWith(o)&&(n[s.replace(o,"")]=i[s]);return n}getEntries(i){return i instanceof Map?i.entries():Object.entries(i)}static \u0275fac=function(r){return new(r||t)(lt(Dge,8),lt(Oge),lt(Nge),lt(Pge),lt($x),lt(Lge))};static \u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Vrt=new St("TRANSLOCO_LANG"),nsi=new St("TRANSLOCO_LOADING_TEMPLATE"),jrt=new St("TRANSLOCO_SCOPE"),t7=class{initialized=!1;resolve({inline:e,provider:i,active:r}){let n=r;if(this.initialized)return n=r,n;if(i){let[,o]=e7(i,"static");n=o}if(e){let[,o]=e7(e,"static");n=o}return this.initialized=!0,n}resolveLangBasedOnScope(e){return sI(e)?Av(e):e}resolveLangPath(e,i){return i?`${i}/${e}`:e}},i7=class{service;constructor(e){this.service=e}resolve(e){let{inline:i,provider:r}=e;if(i)return i;if(r){if(n7(r)){let{scope:n,alias:o=kge(n)}=r;return this.service._setScopeAlias(n,o),n}return r}}};var Iv=(()=>{class t{service;providerScope;providerLang;cdr;subscription=null;lastValue="";lastKey;path;langResolver=new t7;scopeResolver;constructor(i,r,n,o){this.service=i,this.providerScope=r,this.providerLang=n,this.cdr=o,this.scopeResolver=new i7(this.service)}transform(i,r,n){if(!i)return i;let o=r?`${i}${JSON.stringify(r)}`:i;if(o===this.lastKey)return this.lastValue;this.lastKey=o,this.subscription?.unsubscribe();let s=Prt(this.service,this.providerLang||n);return this.subscription=this.service.langChanges$.pipe(uc(a=>{let c=this.langResolver.resolve({inline:n,provider:this.providerLang,active:a});return Array.isArray(this.providerScope)?lf(this.providerScope.map(d=>this.resolveScope(c,d))):this.resolveScope(c,this.providerScope)}),Lrt(s)).subscribe(()=>this.updateValue(i,r)),this.lastValue}ngOnDestroy(){this.subscription?.unsubscribe(),this.subscription=null}updateValue(i,r){let n=this.langResolver.resolveLangBasedOnScope(this.path);this.lastValue=this.service.translate(i,r,n),this.cdr.markForCheck()}resolveScope(i,r){let n=this.scopeResolver.resolve({inline:void 0,provider:r});this.path=this.langResolver.resolveLangPath(i,n);let o=Fge(r,n);return this.service._loadDependencies(this.path,o)}static \u0275fac=function(r){return new(r||t)(Te(id,16),Te(jrt,24),Te(Vrt,24),Te(Xi,16))};static \u0275pipe=ode({name:"transloco",type:t,pure:!1,standalone:!0})}return t})();var Dv=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Mt({type:t});static \u0275inj=Dt({})}return t})();function Bge(t){let e=[Urt(Drt),Yrt(krt),$rt(Ort),qrt(Nrt)];return t.config&&e.push(zrt(t.config)),t.loader&&e.push(Wrt(t.loader)),e}function zrt(t){return v_([{provide:$x,useValue:Irt(t)}])}function Wrt(t){return v_([{provide:Dge,useClass:t}])}function Urt(t){return v_([{provide:Oge,useClass:t,deps:[$x]}])}function qrt(t){return v_([{provide:Lge,useClass:t,deps:[$x]}])}function Yrt(t){return v_([{provide:Nge,useClass:t}])}function $rt(t){return v_([{provide:Pge,useClass:t}])}var osi=new St("TRANSLOCO_TEST_LANGS - Available testing languages"),ssi=new St("TRANSLOCO_TEST_OPTIONS - Testing options");var Vge=(()=>{let e=class e{constructor(r){this.translocoService=r,this.barChartData_datasets=[],this.barChartData_labels=[],this.barChartOptions={responsive:!0,plugins:{legend:{display:!0,labels:{generateLabels:n=>{let o=Lx.defaults.plugins.legend.labels.generateLabels;return o(n).map(a=>{let c=a.datasetIndex;if(c===void 0)return a;let d=n.data.datasets[c],u=n.isDatasetVisible(c),h=d.label??`Dataset ${c+1}`;return Lt(Ke({},a),{text:u?`${h} \u2714\uFE0F`:h})})}}},tooltip:{callbacks:{label:n=>{let o=n.dataset.label||"",s=n.parsed.y!==null?this.formatNumber(n.parsed.y):"";return`${o}: ${s}`}}}},scales:{x:{stacked:!0},y:{stacked:!1,ticks:{callback:n=>this.formatNumber(n)}}}},this.barChartLegend=!0,this.barChartType="bar"}formatNumber(r){let n=this.translocoService.getActiveLang();return Number(r).toLocaleString(n==="fr"?"fr-FR":"en-US",{useGrouping:!0})}ngOnChanges(r){r.barChartData&&this.barChartData&&(this.barChartData_datasets=this.barChartData.datasets,this.barChartData_labels=this.barChartData.labels)}};e.\u0275fac=function(n){return new(n||e)(Te(id))},e.\u0275cmp=Tt({type:e,selectors:[["app-horizontal-bar-graph"]],inputs:{barChartData:"barChartData"},standalone:!0,features:[Li,zt],decls:1,vars:5,consts:[["baseChart","",3,"datasets","labels","options","legend","type"]],template:function(n,o){n&1&&bt(0,"canvas",0),n&2&&ht("datasets",o.barChartData_datasets)("labels",o.barChartData_labels)("options",o.barChartOptions)("legend",o.barChartLegend)("type",o.barChartType)},dependencies:[QF]});let t=e;return t})();var jge=(()=>{let e=class e{constructor(){this.pieChartOptions={devicePixelRatio:1,responsive:!1,plugins:{title:{display:!1,text:"Custom Chart Title"},legend:{position:"right",labels:{textAlign:"left",padding:1}}}},this.pieChartLegend=!0,this.pieChartType="doughnut"}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Tt({type:e,selectors:[["app-pie-graph"]],inputs:{pieChartLabels:"pieChartLabels",pieChartData:"pieChartData",width:"width",height:"height"},standalone:!0,features:[zt],decls:2,vars:7,consts:[["baseChart","",3,"width","height","datasets","labels","options","legend","type"]],template:function(n,o){n&1&&(ae(0,"div"),bt(1,"canvas",0),ne()),n&2&&(Ye(),ht("width",o.width)("height",o.height)("datasets",o.pieChartData)("labels",o.pieChartLabels)("options",o.pieChartOptions)("legend",o.pieChartLegend)("type",o.pieChartType))},dependencies:[QF]});let t=e;return t})();var zge=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[QW,oi,QW,oi]});let t=e;return t})();var Wge=["mat-button",""],Uge=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],qge=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],Grt='.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 8px);height:var(--mdc-text-button-container-height);font-family:var(--mdc-text-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-text-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-text-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, var(--mat-app-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-filled-button-horizontal-padding, 16px);height:var(--mdc-filled-button-container-height);font-family:var(--mdc-filled-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-filled-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-filled-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color, var(--mat-app-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, var(--mat-app-on-primary));background-color:var(--mdc-filled-button-container-color, var(--mat-app-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow, var(--mat-app-level1));height:var(--mdc-protected-button-container-height);font-family:var(--mdc-protected-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-protected-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-protected-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, var(--mat-app-primary));background-color:var(--mdc-protected-button-container-color, var(--mat-app-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow, var(--mat-app-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow, var(--mat-app-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow, var(--mat-app-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow, var(--mat-app-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-outlined-button-horizontal-padding, 15px);height:var(--mdc-outlined-button-container-height);font-family:var(--mdc-outlined-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-outlined-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-outlined-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight, var(--mat-app-label-large-weight));border-radius:var(--mdc-outlined-button-container-shape, var(--mat-app-corner-full));border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, var(--mat-app-primary));border-color:var(--mdc-outlined-button-outline-color, var(--mat-app-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button .mdc-button__ripple{border-width:var(--mdc-outlined-button-outline-width);border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',Yge=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}";var Xrt=["mat-icon-button",""],Krt=["*"];var Zrt=new St("MAT_BUTTON_CONFIG");var Qrt=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],o7=(()=>{let e=class e{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(r){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,r)}get disableRipple(){return this._disableRipple}set disableRipple(r){this._disableRipple=r,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(r){this._disabled=r,this._updateRippleDisabled()}constructor(r,n,o,s){this._elementRef=r,this._platform=n,this._ngZone=o,this._animationMode=s,this._focusMonitor=Jt(Qp),this._rippleLoader=Jt(Cue),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let a=Jt(Zrt,{optional:!0}),c=r.nativeElement,d=c.classList;this.disabledInteractive=a?.disabledInteractive??!1,this.color=a?.color??null,this._rippleLoader?.configureRipple(c,{className:"mat-mdc-button-ripple"});for(let{attribute:u,mdcClasses:h}of Qrt)c.hasAttribute(u)&&d.add(...h)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(r="program",n){r?this._focusMonitor.focusVia(this._elementRef.nativeElement,r,n):this._elementRef.nativeElement.focus(n)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}};e.\u0275fac=function(n){tA()},e.\u0275dir=Ot({type:e,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",bi],disabled:[2,"disabled","disabled",bi],ariaDisabled:[2,"aria-disabled","ariaDisabled",bi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",bi]},features:[ar]});let t=e;return t})();var Jrt=(()=>{let e=class e extends o7{constructor(r,n,o,s){super(r,n,o,s),this._haltDisabledEvents=a=>{this.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}}ngOnInit(){this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)})}ngOnDestroy(){super.ngOnDestroy(),this._elementRef.nativeElement.removeEventListener("click",this._haltDisabledEvents)}_getAriaDisabled(){return this.ariaDisabled==null?this.disabled:this.ariaDisabled}};e.\u0275fac=function(n){tA()},e.\u0275dir=Ot({type:e,inputs:{tabIndex:[2,"tabIndex","tabIndex",r=>r==null?void 0:Ia(r)]},features:[ar,vr]});let t=e;return t})(),$d=(()=>{let e=class e extends o7{constructor(r,n,o,s){super(r,n,o,s)}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(yr),Te(ni),Te(rs,8))},e.\u0275cmp=Tt({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(n,o){n&2&&(mi("disabled",o._getDisabledAttribute())("aria-disabled",o._getAriaDisabled()),Aa(o.color?"mat-"+o.color:""),hi("mat-mdc-button-disabled",o.disabled)("mat-mdc-button-disabled-interactive",o.disabledInteractive)("_mat-animation-noopable",o._animationMode==="NoopAnimations")("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[vr,zt],attrs:Wge,ngContentSelectors:qge,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,o){n&1&&(Br(Uge),bt(0,"span",0),Ri(1),ae(2,"span",1),Ri(3,1),ne(),Ri(4,2),bt(5,"span",2)(6,"span",3)),n&2&&hi("mdc-button__ripple",!o._isFab)("mdc-fab__ripple",o._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 8px);height:var(--mdc-text-button-container-height);font-family:var(--mdc-text-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-text-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-text-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, var(--mat-app-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-filled-button-horizontal-padding, 16px);height:var(--mdc-filled-button-container-height);font-family:var(--mdc-filled-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-filled-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-filled-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color, var(--mat-app-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, var(--mat-app-on-primary));background-color:var(--mdc-filled-button-container-color, var(--mat-app-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow, var(--mat-app-level1));height:var(--mdc-protected-button-container-height);font-family:var(--mdc-protected-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-protected-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-protected-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, var(--mat-app-primary));background-color:var(--mdc-protected-button-container-color, var(--mat-app-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow, var(--mat-app-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow, var(--mat-app-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow, var(--mat-app-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow, var(--mat-app-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-outlined-button-horizontal-padding, 15px);height:var(--mdc-outlined-button-container-height);font-family:var(--mdc-outlined-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-outlined-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-outlined-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight, var(--mat-app-label-large-weight));border-radius:var(--mdc-outlined-button-container-shape, var(--mat-app-corner-full));border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, var(--mat-app-primary));border-color:var(--mdc-outlined-button-outline-color, var(--mat-app-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button .mdc-button__ripple{border-width:var(--mdc-outlined-button-outline-width);border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0});let t=e;return t})(),$ge=(()=>{let e=class e extends Jrt{constructor(r,n,o,s){super(r,n,o,s)}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(yr),Te(ni),Te(rs,8))},e.\u0275cmp=Tt({type:e,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-flat-button",""],["a","mat-stroked-button",""]],hostVars:15,hostBindings:function(n,o){n&2&&(mi("disabled",o._getDisabledAttribute())("tabindex",o.disabled&&!o.disabledInteractive?-1:o.tabIndex)("aria-disabled",o._getDisabledAttribute()),Aa(o.color?"mat-"+o.color:""),hi("mat-mdc-button-disabled",o.disabled)("mat-mdc-button-disabled-interactive",o.disabledInteractive)("_mat-animation-noopable",o._animationMode==="NoopAnimations")("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},exportAs:["matButton","matAnchor"],standalone:!0,features:[vr,zt],attrs:Wge,ngContentSelectors:qge,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,o){n&1&&(Br(Uge),bt(0,"span",0),Ri(1),ae(2,"span",1),Ri(3,1),ne(),Ri(4,2),bt(5,"span",2)(6,"span",3)),n&2&&hi("mdc-button__ripple",!o._isFab)("mdc-fab__ripple",o._isFab)},styles:[Grt,Yge],encapsulation:2,changeDetection:0});let t=e;return t})();var aI=(()=>{let e=class e extends o7{constructor(r,n,o,s){super(r,n,o,s),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(yr),Te(ni),Te(rs,8))},e.\u0275cmp=Tt({type:e,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(n,o){n&2&&(mi("disabled",o._getDisabledAttribute())("aria-disabled",o._getAriaDisabled()),Aa(o.color?"mat-"+o.color:""),hi("mat-mdc-button-disabled",o.disabled)("mat-mdc-button-disabled-interactive",o.disabledInteractive)("_mat-animation-noopable",o._animationMode==="NoopAnimations")("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[vr,zt],attrs:Xrt,ngContentSelectors:Krt,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,o){n&1&&(Br(),bt(0,"span",0),Ri(1),bt(2,"span",1)(3,"span",2))},styles:['.mat-mdc-icon-button{-webkit-user-select:none;user-select:none;display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;z-index:0;overflow:visible;border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 48px);height:var(--mdc-icon-button-state-layer-size, 48px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 48px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size);color:var(--mdc-icon-button-icon-color, var(--mat-app-on-surface-variant));-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button img,.mat-mdc-icon-button svg{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size);vertical-align:baseline}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label,.mat-mdc-icon-button .mat-icon{z-index:1;position:relative}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color)}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-icon-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-icon-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button[hidden]{display:none}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',Yge],encapsulation:2,changeDetection:0});let t=e;return t})();var Gu=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,E_,oi]});let t=e;return t})();var ent=["*"],e5;function tnt(){if(e5===void 0&&(e5=null,typeof window<"u")){let t=window;t.trustedTypes!==void 0&&(e5=t.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return e5}function lI(t){return tnt()?.createHTML(t)||t}function Gge(t){return Error(`Unable to find icon with the name "${t}"`)}function int(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function Xge(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function Kge(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}var dm=class{constructor(e,i,r){this.url=e,this.svgText=i,this.options=r}},rnt=(()=>{let e=class e{constructor(r,n,o,s){this._httpClient=r,this._sanitizer=n,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=o}addSvgIcon(r,n,o){return this.addSvgIconInNamespace("",r,n,o)}addSvgIconLiteral(r,n,o){return this.addSvgIconLiteralInNamespace("",r,n,o)}addSvgIconInNamespace(r,n,o,s){return this._addSvgIconConfig(r,n,new dm(o,null,s))}addSvgIconResolver(r){return this._resolvers.push(r),this}addSvgIconLiteralInNamespace(r,n,o,s){let a=this._sanitizer.sanitize(GC.HTML,o);if(!a)throw Kge(o);let c=lI(a);return this._addSvgIconConfig(r,n,new dm("",c,s))}addSvgIconSet(r,n){return this.addSvgIconSetInNamespace("",r,n)}addSvgIconSetLiteral(r,n){return this.addSvgIconSetLiteralInNamespace("",r,n)}addSvgIconSetInNamespace(r,n,o){return this._addSvgIconSetConfig(r,new dm(n,null,o))}addSvgIconSetLiteralInNamespace(r,n,o){let s=this._sanitizer.sanitize(GC.HTML,n);if(!s)throw Kge(n);let a=lI(s);return this._addSvgIconSetConfig(r,new dm("",a,o))}registerFontClassAlias(r,n=r){return this._fontCssClassesByAlias.set(r,n),this}classNameForFontAlias(r){return this._fontCssClassesByAlias.get(r)||r}setDefaultFontSetClass(...r){return this._defaultFontSetClass=r,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(r){let n=this._sanitizer.sanitize(GC.RESOURCE_URL,r);if(!n)throw Xge(r);let o=this._cachedIconsByUrl.get(n);return o?qi(t5(o)):this._loadSvgIconFromConfig(new dm(r,null)).pipe(Qc(s=>this._cachedIconsByUrl.set(n,s)),Gi(s=>t5(s)))}getNamedSvgIcon(r,n=""){let o=Zge(n,r),s=this._svgIconConfigs.get(o);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(n,r),s)return this._svgIconConfigs.set(o,s),this._getSvgFromConfig(s);let a=this._iconSetConfigs.get(n);return a?this._getSvgFromIconSetConfigs(r,a):ede(Gge(o))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(r){return r.svgText?qi(t5(this._svgElementFromConfig(r))):this._loadSvgIconFromConfig(r).pipe(Gi(n=>t5(n)))}_getSvgFromIconSetConfigs(r,n){let o=this._extractIconWithNameFromAnySet(r,n);if(o)return qi(o);let s=n.filter(a=>!a.svgText).map(a=>this._loadSvgIconSetFromConfig(a).pipe(g_(c=>{let u=`Loading icon set URL: ${this._sanitizer.sanitize(GC.RESOURCE_URL,a.url)} failed: ${c.message}`;return this._errorHandler.handleError(new Error(u)),qi(null)})));return lf(s).pipe(Gi(()=>{let a=this._extractIconWithNameFromAnySet(r,n);if(!a)throw Gge(r);return a}))}_extractIconWithNameFromAnySet(r,n){for(let o=n.length-1;o>=0;o--){let s=n[o];if(s.svgText&&s.svgText.toString().indexOf(r)>-1){let a=this._svgElementFromConfig(s),c=this._extractSvgIconFromSet(a,r,s.options);if(c)return c}}return null}_loadSvgIconFromConfig(r){return this._fetchIcon(r).pipe(Qc(n=>r.svgText=n),Gi(()=>this._svgElementFromConfig(r)))}_loadSvgIconSetFromConfig(r){return r.svgText?qi(null):this._fetchIcon(r).pipe(Qc(n=>r.svgText=n))}_extractSvgIconFromSet(r,n,o){let s=r.querySelector(`[id="${n}"]`);if(!s)return null;let a=s.cloneNode(!0);if(a.removeAttribute("id"),a.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(a,o);if(a.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(a),o);let c=this._svgElementFromString(lI("<svg></svg>"));return c.appendChild(a),this._setSvgAttributes(c,o)}_svgElementFromString(r){let n=this._document.createElement("DIV");n.innerHTML=r;let o=n.querySelector("svg");if(!o)throw Error("<svg> tag not found");return o}_toSvgElement(r){let n=this._svgElementFromString(lI("<svg></svg>")),o=r.attributes;for(let s=0;s<o.length;s++){let{name:a,value:c}=o[s];a!=="id"&&n.setAttribute(a,c)}for(let s=0;s<r.childNodes.length;s++)r.childNodes[s].nodeType===this._document.ELEMENT_NODE&&n.appendChild(r.childNodes[s].cloneNode(!0));return n}_setSvgAttributes(r,n){return r.setAttribute("fit",""),r.setAttribute("height","100%"),r.setAttribute("width","100%"),r.setAttribute("preserveAspectRatio","xMidYMid meet"),r.setAttribute("focusable","false"),n&&n.viewBox&&r.setAttribute("viewBox",n.viewBox),r}_fetchIcon(r){let{url:n,options:o}=r,s=o?.withCredentials??!1;if(!this._httpClient)throw int();if(n==null)throw Error(`Cannot fetch icon from URL "${n}".`);let a=this._sanitizer.sanitize(GC.RESOURCE_URL,n);if(!a)throw Xge(n);let c=this._inProgressUrlFetches.get(a);if(c)return c;let d=this._httpClient.get(a,{responseType:"text",withCredentials:s}).pipe(Gi(u=>lI(u)),tde(()=>this._inProgressUrlFetches.delete(a)),rde());return this._inProgressUrlFetches.set(a,d),d}_addSvgIconConfig(r,n,o){return this._svgIconConfigs.set(Zge(r,n),o),this}_addSvgIconSetConfig(r,n){let o=this._iconSetConfigs.get(r);return o?o.push(n):this._iconSetConfigs.set(r,[n]),this}_svgElementFromConfig(r){if(!r.svgElement){let n=this._svgElementFromString(r.svgText);this._setSvgAttributes(n,r.options),r.svgElement=n}return r.svgElement}_getIconConfigFromResolvers(r,n){for(let o=0;o<this._resolvers.length;o++){let s=this._resolvers[o](n,r);if(s)return nnt(s)?new dm(s.url,null,s.options):new dm(s,null)}}};e.\u0275fac=function(n){return new(n||e)(lt(ev,8),lt(Ide),lt(ir,8),lt(uL))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function t5(t){return t.cloneNode(!0)}function Zge(t,e){return t+":"+e}function nnt(t){return!!(t.url&&t.options)}var ont=new St("MAT_ICON_DEFAULT_OPTIONS"),snt=new St("mat-icon-location",{providedIn:"root",factory:ant});function ant(){let t=Jt(ir),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}var Jge=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],lnt=Jge.map(t=>`[${t}]`).join(", "),cnt=/^url\(['"]?#(.*?)['"]?\)$/,Mv=(()=>{let e=class e{get color(){return this._color||this._defaultColor}set color(r){this._color=r}get svgIcon(){return this._svgIcon}set svgIcon(r){r!==this._svgIcon&&(r?this._updateSvgIcon(r):this._svgIcon&&this._clearSvgElement(),this._svgIcon=r)}get fontSet(){return this._fontSet}set fontSet(r){let n=this._cleanupFontValue(r);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(r){let n=this._cleanupFontValue(r);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}constructor(r,n,o,s,a,c){this._elementRef=r,this._iconRegistry=n,this._location=s,this._errorHandler=a,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=jn.EMPTY,c&&(c.color&&(this.color=this._defaultColor=c.color),c.fontSet&&(this.fontSet=c.fontSet)),o||r.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(r){if(!r)return["",""];let n=r.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${r}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let r=this._elementsWithExternalReferences;if(r&&r.size){let n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(r){this._clearSvgElement();let n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(r),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(r)}_clearSvgElement(){let r=this._elementRef.nativeElement,n=r.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){let o=r.childNodes[n];(o.nodeType!==1||o.nodeName.toLowerCase()==="svg")&&o.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let r=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(o=>o.length>0);this._previousFontSetClass.forEach(o=>r.classList.remove(o)),n.forEach(o=>r.classList.add(o)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&r.classList.remove(this._previousFontIconClass),this.fontIcon&&r.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(r){return typeof r=="string"?r.trim().split(" ")[0]:r}_prependPathToReferences(r){let n=this._elementsWithExternalReferences;n&&n.forEach((o,s)=>{o.forEach(a=>{s.setAttribute(a.name,`url('${r}#${a.value}')`)})})}_cacheChildrenWithExternalReferences(r){let n=r.querySelectorAll(lnt),o=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<n.length;s++)Jge.forEach(a=>{let c=n[s],d=c.getAttribute(a),u=d?d.match(cnt):null;if(u){let h=o.get(c);h||(h=[],o.set(c,h)),h.push({name:a,value:u[1]})}})}_updateSvgIcon(r){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),r){let[n,o]=this._splitIconName(r);n&&(this._svgNamespace=n),o&&(this._svgName=o),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(o,n).pipe(Vo(1)).subscribe(s=>this._setSvgElement(s),s=>{let a=`Error retrieving icon ${n}:${o}! ${s.message}`;this._errorHandler.handleError(new Error(a))})}}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(rnt),Jc("aria-hidden"),Te(snt),Te(uL),Te(ont,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(n,o){n&2&&(mi("data-mat-icon-type",o._usingFontIcon()?"font":"svg")("data-mat-icon-name",o._svgName||o.fontIcon)("data-mat-icon-namespace",o._svgNamespace||o.fontSet)("fontIcon",o._usingFontIcon()?o.fontIcon:null),Aa(o.color?"mat-"+o.color:""),hi("mat-icon-inline",o.inline)("mat-icon-no-color",o.color!=="primary"&&o.color!=="accent"&&o.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",bi],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[ar,zt],ngContentSelectors:ent,decls:1,vars:0,template:function(n,o){n&1&&(Br(),Ri(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0});let t=e;return t})(),Gx=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,oi]});let t=e;return t})();var dnt=new St("MAT_SORT_DEFAULT_OPTIONS"),eve=(()=>{let e=class e{get direction(){return this._direction}set direction(r){this._direction=r}constructor(r){this._defaultOptions=r,this._initializedStream=new Jce(1),this.sortables=new Map,this._stateChanges=new Ft,this.start="asc",this._direction="",this.disabled=!1,this.sortChange=new Nt,this.initialized=this._initializedStream}register(r){this.sortables.set(r.id,r)}deregister(r){this.sortables.delete(r.id)}sort(r){this.active!=r.id?(this.active=r.id,this.direction=r.start?r.start:this.start):this.direction=this.getNextSortDirection(r),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(r){if(!r)return"";let n=r?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear,o=unt(r.start||this.start,n),s=o.indexOf(this.direction)+1;return s>=o.length&&(s=0),o[s]}ngOnInit(){this._initializedStream.next()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete(),this._initializedStream.complete()}};e.\u0275fac=function(n){return new(n||e)(Te(dnt,8))},e.\u0275dir=Ot({type:e,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{active:[0,"matSortActive","active"],start:[0,"matSortStart","start"],direction:[0,"matSortDirection","direction"],disableClear:[2,"matSortDisableClear","disableClear",bi],disabled:[2,"matSortDisabled","disabled",bi]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],standalone:!0,features:[ar,Li]});let t=e;return t})();function unt(t,e){let i=["asc","desc"];return t=="desc"&&i.reverse(),e||i.push(""),i}var tai=wue.ENTERING+" "+yue.STANDARD_CURVE;var a7=(()=>{let e=class e{constructor(){this.changes=new Ft}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function hnt(t){return t||new a7}var fnt={provide:a7,deps:[[new QR,new JR,a7]],useFactory:hnt};var tve=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({providers:[fnt],imports:[oi]});let t=e;return t})();var cSi=U($e(),1),dSi=U(dt(),1),uSi=U(ln(),1),hSi=U(cn(),1),fSi=U(dn(),1),pSi=U(un(),1),mSi=U(hn(),1),gSi=U(fn(),1),vSi=U(pn(),1),bSi=U(Pbe(),1);var kli=U($e(),1),Oli=U(dt(),1);var Ali=U(dt(),1);var b7=U(nl(),1);var mli=U(dt(),1),gli=U(ln(),1),vli=U(cn(),1),bli=U(dn(),1),_li=U(un(),1),yli=U(hn(),1),wli=U(fn(),1),Cli=U(pn(),1);function Lbe(t){let e=t.length,i=0;for(;i<e;)t[i]=[t[i]],i+=1}function m7(t,e){let i=e.length,r=0;for(;r<i;)t.push(e[r]),r+=1}function Zx(t){let e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;let i=t.length,r=t[0].length;for(let n=0;n<i;n++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][n]=t[n][o];return e}function Gr(t,e,i,r){let n=-1,o=t,s=i;Array.isArray(t)||(o=Array.from(t));let a=o.length;for(r&&a&&(n+=1,s=o[n]),n+=1;n<a;)s=e(s,o[n],n,o),n+=1;return s}function xs(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length,o=[],s=-1;for(;i<n;){let a=r[i];e(a,i,r)&&(s+=1,o[s]=a),i+=1}return o}function ri(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length,o=[],s=-1;for(;i<n;){let a=r[i];s+=1,o[s]=e(a,i,r),i+=1}return o}function Ce(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length;for(;i<n&&e(r[i],i,r)!==!1;)i+=1;return t}function o5(t){let e=[];return Ce(t,i=>{e.indexOf(i)===-1&&e.push(i)}),e}function g7(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...n]=[...e],o=r;return Ce(n,s=>{o=o.filter(a=>!s.includes(a))}),o}function v7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Ai(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return Gr(t,(o,s,a)=>{let c=s.replace(/\r?\n\s*/g,""),d=i[a]?i[a]:"";return o+c+d},"").trim()}function Vr(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function wt(t){return typeof t<"u"}function Qi(t){return typeof t>"u"}function jr(t){return t===null||t===""||Qi(t)}function jbe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var cI="length",dI=t=>parseInt(t,16),Fbe=t=>parseInt(t,10),s5=(t,e,i)=>t.substr(e,i),uI=t=>t.codePointAt(0)-65,_7=t=>`${t}`.replace(/\-/g,""),Vst=t=>dI(s5(_7(t),dI("12"),uI("F")))/(dI(s5(_7(t),uI("B"),~~![][cI]))||9),jst=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),Hbe=!1,Bbe={invalid:()=>Ai`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return Ai`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ai`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Vbe={invalid:()=>Ai`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return Ai`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ai`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function zbe(t,e){let i=!jr(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",n="14.4.0",o,s="invalid",a="invalid";t=_7(t||"");let c=zst(t);if(i||r||c)if(c){let d=(0,b7.default)("11/06/2024","DD/MM/YYYY"),u=Math.floor(d.toDate().getTime()/864e5),h=Vst(t);o=(0,b7.default)((h+1)*864e5,"x").format("MMMM DD, YYYY"),u>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(jst()&&(s="valid",a="valid"),!Hbe&&s!=="valid"&&(Bbe[s]({keyValidityDate:o,hotVersion:n})&&console[s==="non_commercial"?"info":"warn"](Bbe[s]({keyValidityDate:o,hotVersion:n})),Hbe=!0),a!=="valid"&&e.parentNode&&Vbe[a]({keyValidityDate:o,hotVersion:n})){let u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=Vbe[a]({keyValidityDate:o,hotVersion:n}),e.parentNode.insertBefore(u,e.nextSibling)}}function zst(t){let e=[][cI],i=e;if(t[cI]!==uI("Z"))return!1;for(let r="",n="B<H4P+".split(""),o=uI(n.shift());o;o=uI(n.shift()||"A"))--o<""[cI]?i=i|(Fbe(`${Fbe(dI(r)+(dI(s5(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=s5(t,o,o?n[cI]===1?9:8:6);return i===e}function ka(t){return t[0].toUpperCase()+t.substr(1)}function a5(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function l5(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function c5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(i,r)=>i.charAt(0)==="\\"?i.substr(1,i.length-1):e[r]===void 0?"":e[r])}function y7(t){return hI(`${t}`,{ALLOWED_TAGS:[]})}function hI(t,e){return Yde.sanitize(t,e)}var Gd=t=>["tabindex",t],Wbe=()=>["role","treegrid"],Fl=()=>["role","presentation"],Ube=()=>["role","gridcell"],qbe=()=>["role","rowheader"],d5=()=>["role","rowgroup"],Ybe=()=>["role","columnheader"],fI=()=>["role","row"],$be=()=>["role","menu"],Gbe=()=>["role","menuitem"],Xbe=()=>["role","combobox"],u5=()=>["role","listbox"],Kbe=()=>["role","option"],Zbe=()=>["role","checkbox"],Qbe=()=>["scope","col"],Jbe=()=>["scope","row"],e0e=()=>["type","text"],Qx=t=>["aria-label",t],ta=()=>["aria-hidden","true"],t0e=()=>["aria-disabled","true"],i0e=()=>["aria-multiselectable","true"],h5=t=>["aria-haspopup",t],f5=t=>["aria-rowcount",t],Jx=t=>["aria-colcount",t],p5=t=>["aria-rowindex",t],e1=t=>["aria-colindex",t],Oa=t=>["aria-expanded",t],r0e=t=>["aria-sort",t],w7=()=>["aria-readonly","true"],C7=()=>["aria-invalid","true"],n0e=t=>["aria-checked",t],t1=()=>["aria-selected","true"],o0e=()=>["aria-autocomplete","list"],s0e=t=>["aria-controls",t],a0e=t=>["aria-activedescendant",t],l0e=t=>["aria-live",t],c0e=t=>["aria-relevant",t],d0e=t=>["aria-setsize",t],u0e=t=>["aria-posinset",t];function h0e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=-1,r=null,n=t;for(;n!==null;){if(i===e){r=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(i+=1,n=n.parentNode)}return r}function f0e(t,e){let i=t.closest(".handsontable");return!!i&&(i.parentNode===e||i===e)}function Wst(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Ef(t){return Wst(t)&&t.parent}function Ku(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:n}=Node,o=t;for(;o!=null&&o!==i;){let{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;let{host:c}=o;c&&s===n?o=c:o=o.parentNode}return null}function pI(t,e,i){let r=[],n=t;for(;n&&(n=Ku(n,e,i),!(!n||i&&!i.contains(n)));)r.push(n),n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:n=n.parentNode;let o=r.length;return o?r[o-1]:null}function Zu(t,e){let i=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);i!==null;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function p0e(t){let e=0,i=t;if(i.previousSibling)for(;i=i.previousSibling;)e+=1;return e}function Lv(t,e,i){let r=i.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function m0e(t){return!t||!t.length?[]:t.filter(e=>!!e)}function g0e(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];let i=[],r=[];return r.push(...t.filter(n=>{let o=n instanceof RegExp;return o&&e&&i.push(n),!o})),e?{regexFree:r,regexes:i}:r}function Bt(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Qe(t,e){typeof e=="string"&&(e=e.split(" ")),e=m0e(e),e.length>0&&t.classList.add(...e)}function Gt(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=g0e(e,!0);i=m0e(i),i.length>0&&t.classList.remove(...i),r.forEach(n=>{t.classList.forEach(o=>{n.test(o)&&t.classList.remove(o)})})}function Ht(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,i]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Kd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=g0e(e,!0);i.forEach(n=>{n!==""&&t.removeAttribute(n)}),r.forEach(n=>{t.getAttributeNames().forEach(o=>{n.test(o)&&t.removeAttribute(o)})})}function S7(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){let e=t.childNodes;for(let i=e.length-1;i>=0;i--)S7(e[i])}}function ia(t){let e;for(;e=t.lastChild;)t.removeChild(e)}var Ust=/(<(.*)>|&(.*);)/;function Zd(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Ust.test(e)?t.innerHTML=i?hI(e):e:Qd(t,e)}function Qd(t,e){let i=t.firstChild;i&&i.nodeType===3&&i.nextSibling===null?i.textContent=e:(ia(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Xd(t){let e=t.ownerDocument.documentElement,i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return Xd(i.host.impl);if(i.host)return Xd(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(Jd(i).display==="none")return!1;i=i.parentNode}return!0}function Nn(t){let e=t.ownerDocument,i=e.defaultView,r=e.documentElement,n=t,o,s,a;for(o=n.offsetLeft,s=n.offsetTop,a=n;(n=n.offsetParent)&&!(n===e.body||!("offsetLeft"in n));)o+=n.offsetLeft,s+=n.offsetTop,a=n;return a&&a.style.position==="fixed"&&(o+=i.pageXOffset||r.scrollLeft,s+=i.pageYOffset||r.scrollTop),{left:o,top:s}}function E7(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function mI(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function i1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?E7(e):t.scrollTop}function m5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?mI(e):t.scrollLeft}function r1(t){let e=t.ownerDocument,i=e?e.defaultView:void 0;e||(e=t.document?t.document:t,i=e.defaultView);let r=["auto","scroll"],n=t.parentNode;for(;n&&n.style&&e.body!==n;){let{overflow:o,overflowX:s,overflowY:a}=n.style;if([o,s,a].includes("scroll"))return n;if({overflow:o,overflowX:s,overflowY:a}=i.getComputedStyle(n),r.includes(o)||r.includes(s)||r.includes(a)||n.clientHeight<=n.scrollHeight+1&&(r.includes(a)||r.includes(o))||n.clientWidth<=n.scrollWidth+1&&(r.includes(s)||r.includes(o)))return n;n=n.parentNode}return i}function v0e(t){return t.scrollHeight-t.clientHeight}function b0e(t){return t.scrollWidth-t.clientWidth}function Qu(t){let e=t.ownerDocument,i=e.defaultView,r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;let n=Jd(r,i),o=["scroll","hidden","auto"],s=n.getPropertyValue("overflow"),a=n.getPropertyValue("overflow-y"),c=n.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(c))return r;r=r.parentNode}return i}function Fv(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===i)return e==="width"?`${i.innerWidth}px`:e==="height"?`${i.innerHeight}px`:void 0}else return;let r=t.style[e];if(r!==""&&r!==void 0)return r;let n=Jd(t,i);if(n[e]!==""&&n[e]!==void 0)return n[e]}function Jd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function Ji(t){return t.offsetWidth}function ur(t){return t.offsetHeight}function um(t){return t.clientHeight||t.innerHeight}function g5(t){return t.clientWidth||t.innerWidth}function v5(t){return t.selectionStart?t.selectionStart:0}function _0e(t){return t.selectionEnd?t.selectionEnd:0}function T7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Hv(t,e,i){if(i===void 0&&(i=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,i)}catch{let n=t.parentNode,o=n.style.display;n.style.display="block",t.setSelectionRange(e,i),n.style.display=o}}}var x7;function qst(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";let i=t.createElement("div");i.style.boxSizing="content-box",i.style.height="150px",i.style.left="0px",i.style.overflow="hidden",i.style.position="absolute",i.style.top="0px",i.style.width="200px",i.style.visibility="hidden",i.appendChild(e),(t.body||t.documentElement).appendChild(i);let r=e.offsetWidth;i.style.overflow="scroll";let n=e.offsetWidth;return r===n&&(n=i.clientWidth),(t.body||t.documentElement).removeChild(i),r-n}function mn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return x7===void 0&&(x7=qst(t)),x7}function y0e(t){return t.offsetWidth!==t.clientWidth}function w0e(t){return t.offsetHeight!==t.clientHeight}function n1(t,e,i){t.style.transform=`translate3d(${e},${i},0)`}function Bv(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function gI(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function b5(t){return gI(t)&&t.hasAttribute("data-hot-input")===!1}function _5(t){return!t.parentNode}function C0e(t,e){new IntersectionObserver((r,n)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),n.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function R7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=t.ownerDocument,n=r.createRange(),o=r.defaultView.getSelection();Ht(t,"contenteditable",!0),i&&Ht(t,...ta()),e&&Qe(t,"invisibleSelection"),n.selectNodeContents(t),o.removeAllRanges(),o.addRange(n)}function A7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),i.removeAllRanges(),e&&Gt(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function x0e(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R7(t,i),e(),A7(t,i)}function nr(t){return typeof t=="function"}function o1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,i=null,r;function n(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i&&clearTimeout(i),i=setTimeout(()=>{r=t.apply(this,s)},e),r}return n}function y5(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,i.concat(s))}}function S0e(t){let e=t.length;function i(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];let c=r.concat(s),d;return c.length>=e?d=t.apply(this,c):d=i(c),d}}return i([])}function vI(t,e,i,r,n,o,s,a){return wt(a)?t.call(e,i,r,n,o,s,a):wt(s)?t.call(e,i,r,n,o,s):wt(o)?t.call(e,i,r,n,o):wt(n)?t.call(e,i,r,n):wt(r)?t.call(e,i,r):wt(i)?t.call(e,i):t.call(e)}var zli=U($e(),1),Wli=U(dt(),1),Uli=U(C5(),1);function W_(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Kt(t,(i,r)=>{r!=="__children"&&(i&&typeof i=="object"&&!Array.isArray(i)?e[r]=W_(i):Array.isArray(i)?i.length&&typeof i[0]=="object"&&!Array.isArray(i[0])?e[r]=[W_(i[0])]:e[r]=[]:e[r]=null)})),e}function Ju(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Sr(t,e,i){let r=Array.isArray(i);return Kt(e,(n,o)=>{(r===!1||i.includes(o))&&(t[o]=n)}),t}function U_(t,e){Kt(e,(i,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),U_(t[r],e[r])):t[r]=e[r]})}function Wo(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function as(t){let e={};return Kt(t,(i,r)=>{e[r]=i}),e}function Mi(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return Ce(i,n=>{t.MIXINS.push(n.MIXIN_NAME),Kt(n,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{let a=function(u,h){let p=`_${u}`,f=m=>{let g=m;return(Array.isArray(g)||Xt(g))&&(g=Wo(g)),g};return function(){return this[p]===void 0&&(this[p]=f(h)),this[p]}},c=function(u){let h=`_${u}`;return function(p){this[h]=p}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:c(s),configurable:!0})}})}),t}function s1(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Xt(t){return Object.prototype.toString.call(t)==="[object Object]"}function ra(t,e,i,r){r.value=i,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Kt(t,e){for(let i in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,i))&&e(t[i],i,t)===!1)break;return t}function j0e(t,e){let i=e.split("."),r=t;return Kt(i,n=>{if(r=r[n],r===void 0)return r=void 0,!1}),r}function x5(t,e,i){let r=e.split("."),n=t;r.forEach((o,s)=>{s!==r.length-1?(Pr(n,o)||(n[o]={}),n=n[o]):n[o]=i})}function a1(t){if(!Xt(t))return 0;let e=function(i){let r=0;return Xt(i)?Kt(i,(n,o)=>{o!=="__children"&&(r+=e(n))}):r+=1,r};return e(t)}function sl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",i=`_${e}`,r={_touched:!1,[i]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[i]},set(n){this._touched=!0,this[i]=n},enumerable:!0,configurable:!0}),r}function Pr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function c1(t){return window.requestAnimationFrame(t)}function d1(t){window.cancelAnimationFrame(t)}function S5(){return"ontouchstart"in window}function z0e(){return typeof window<"u"}var l1;function W0e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return l1||(typeof Intl=="object"?l1=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?l1=(i,r)=>`${i}`.localeCompare(r):l1=(i,r)=>i===r?0:i>r?-1:1,l1)}var eu=t=>{let e={value:!1};return e.test=(i,r)=>{e.value=t(i,r)},e},jv={chrome:eu((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:eu(t=>/CriOS/.test(t)),edge:eu(t=>/Edge/.test(t)),edgeWebKit:eu(t=>/EdgiOS/.test(t)),firefox:eu(t=>/Firefox/.test(t)),firefoxWebKit:eu(t=>/FxiOS/.test(t)),mobile:eu(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:eu((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},_I={mac:eu(t=>/^Mac/.test(t)),win:eu(t=>/^Win/.test(t)),linux:eu(t=>/^Linux/.test(t)),ios:eu(t=>/iPhone|iPad|iPod/i.test(t))};function sat(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Kt(jv,i=>{let{test:r}=i;return void r(t,e)})}function aat(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Kt(_I,e=>{let{test:i}=e;return void i(t)})}z0e()&&(sat(),aat());function E5(){return jv.chrome.value}function U0e(){return jv.chromeWebKit.value}function T5(){return jv.firefox.value}function q0e(){return jv.firefoxWebKit.value}function I7(){return jv.safari.value}function Y0e(){return jv.edge.value}function rd(){return jv.mobile.value}function R5(){return _I.ios.value}function A5(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&_I.mac.value}function D7(){return _I.win.value}function u1(){return _I.mac.value}var Rci=U($e(),1);var Zli=U(dt(),1);var ci={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:T5()?182:174,AUDIO_MUTE:T5()?181:173,AUDIO_UP:T5()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},lat=[ci.ALT,ci.ARROW_DOWN,ci.ARROW_LEFT,ci.ARROW_RIGHT,ci.ARROW_UP,ci.AUDIO_DOWN,ci.AUDIO_MUTE,ci.AUDIO_UP,ci.BACKSPACE,ci.CAPS_LOCK,ci.DELETE,ci.END,ci.ENTER,ci.ESCAPE,ci.F1,ci.F2,ci.F3,ci.F4,ci.F5,ci.F6,ci.F7,ci.F8,ci.F9,ci.F10,ci.F11,ci.F12,ci.F13,ci.F14,ci.F15,ci.F16,ci.F17,ci.F18,ci.F19,ci.HOME,ci.INSERT,ci.MEDIA_NEXT,ci.MEDIA_PLAY_PAUSE,ci.MEDIA_PREV,ci.MEDIA_STOP,ci.NULL,ci.NUM_LOCK,ci.PAGE_DOWN,ci.PAGE_UP,ci.PAUSE,ci.SCROLL_LOCK,ci.SHIFT,ci.TAB];function $0e(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function I5(t){return lat.includes(t)}function G0e(t){return[ci.CONTROL,ci.COMMAND_LEFT,ci.COMMAND_RIGHT,ci.COMMAND_FIREFOX].includes(t)}function Tf(t,e){let i=e.split("|"),r=!1;return Ce(i,n=>{if(t===ci[n])return r=!0,!1}),r}function Uo(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Rf(t){return t.isImmediatePropagationEnabled===!1}function nd(t){return t.button===2}function h1(t){return t.button===0}function X0e(t,e){let i={x:t.offsetX,y:t.offsetY},r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return i;for(;r!==e;)i.x+=r.offsetLeft,i.y+=r.offsetTop,r=r.offsetParent;return i}var vci=U($e(),1);var sci=U($e(),1),aci=U(dt(),1),lci=U(M7(),1);function Zi(){wt(console)&&console.warn(...arguments)}function f1(){wt(console)&&console.error(...arguments)}function dat(t,e,i){return e=uat(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function uat(t){var e=hat(t,"string");return typeof e=="symbol"?e:e+""}function hat(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var p1=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],fat=Ai`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,k7=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),O7=new Map([[]]),D5=new WeakMap,M5=class{static getSingleton(){return mat()}constructor(){dat(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let e=Object.create(null);return Ce(p1,i=>{e[i]=[],this.initOrderMap(e,i)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;if(Array.isArray(i))Ce(i,o=>this.add(e,o,r));else{k7.has(e)&&Zi(c5(fat,{hookName:e,removedInVersion:k7.get(e)})),O7.has(e)&&Zi(O7.get(e));let o=this.getBucket(r);if(typeof o[e]>"u"&&(this.register(e),o[e]=[],this.initOrderMap(o,e)),i.skip=!1,o[e].indexOf(i)===-1){let s=!1;i.initialHook&&Ce(o[e],(a,c)=>{if(a.initialHook)return o[e][c]=i,s=!0,!1}),s||o[e].push(i)}this.setCallbackOrderIndex(o,e,i,n),this.orderBucketByOrderIndex(o,e)}return this}once(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;Array.isArray(i)?Ce(i,o=>this.once(e,o,r)):(i.runOnce=!0,this.add(e,i,r,n))}remove(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=this.getBucket(r);return typeof n[e]<"u"&&n[e].indexOf(i)>=0?(i.skip=!0,!0):!1}has(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=this.getBucket(i);return!!(r[e]!==void 0&&r[e].length)}run(e,i,r,n,o,s,a,c){{let d=this.globalBucket[i],u=d?d.length:0,h=0;if(u)for(;h<u;){if(!d[h]||d[h].skip){h+=1;continue}let p=vI(d[h],e,r,n,o,s,a,c);p!==void 0&&(r=p),d[h]&&d[h].runOnce&&this.remove(i,d[h]),h+=1}}{let d=this.getBucket(e)[i],u=d?d.length:0,h=0;if(u)for(;h<u;){if(!d[h]||d[h].skip){h+=1;continue}let p=vI(d[h],e,r,n,o,s,a,c);p!==void 0&&(r=p),d[h]&&d[h].runOnce&&this.remove(i,d[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Kt(this.getBucket(e),(i,r,n)=>n[r].length=0)}register(e){this.isRegistered(e)||p1.push(e)}deregister(e){this.isRegistered(e)&&p1.splice(p1.indexOf(e),1)}isDeprecated(e){return O7.has(e)||k7.has(e)}isRegistered(e){return p1.indexOf(e)>=0}getRegistered(){return p1}setCallbackOrderIndex(e,i,r,n){let o=Number.isInteger(n)?n:0,s=this.getCallbackOrderMap(e,i);s.set(o,[...s.get(o)||[],r])}orderBucketByOrderIndex(e,i){let r=this.getCallbackOrderMap(e,i);r===void 0||r.size===0||r.size===1&&r.has(0)||(e[i]=[...r].sort((n,o)=>n[0]-o[0]).flatMap(n=>{let[,o]=n;return o}))}initOrderMap(e,i){D5.has(e)||D5.set(e,[]),D5.get(e)[i]=new Map}getCallbackOrderMap(e,i){return D5.get(e)[i]}},pat=new M5;function mat(){return pat}var Ct=M5;var N7=new Map;function ls(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";N7.has(t)||N7.set(t,new Map);let e=N7.get(t);function i(a,c){e.set(a,c)}function r(a){return e.get(a)}function n(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:i,getItem:r,hasItem:n,getNames:o,getValues:s}}var P7=new WeakMap,{register:gat,getItem:K0e,hasItem:L7,getNames:yci,getValues:wci}=ls("editors");function vat(t){let e={},i=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new i(r)),e[r.guid]},Ct.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function k5(t,e){let i;if(typeof t=="function")P7.get(t)||Hl(null,t),i=P7.get(t);else if(typeof t=="string")i=K0e(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error(`No editor registered under name "${t}"`);return i.getInstance(e)}function F7(t){if(typeof t=="function")return t;if(!L7(t))throw Error(`No registered editor found under "${t}" name`);return K0e(t).getConstructor()}function Hl(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);let i=new vat(e);typeof t=="string"&&gat(t,i),P7.set(e,i)}var xci=U($e(),1),Sci=U(dt(),1);function bat(t,e,i){return e=_at(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _at(t){var e=yat(t,"string");return typeof e=="symbol"?e:e+""}function yat(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var H7=0,B7=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;bat(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,i,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,wat(s))}return this.context.eventListeners.push({element:e,event:i,callback:r,callbackProxy:o,options:n,eventManager:this}),e.addEventListener(i,o,n),H7+=1,()=>{this.removeEventListener(e,i,r)}}removeEventListener(e,i,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===i&&s.element===e){if(r&&r!==s.callback||n&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),H7-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let i=this.context.eventListeners.length;for(;i;){i-=1;let r=this.context.eventListeners[i];e&&r.eventManager!==this||(this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),H7-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,i){let r=e.document,n=e;r||(r=e.ownerDocument?e.ownerDocument:e,n=r.defaultView);let o={bubbles:!0,cancelable:i!=="mousemove",view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(i,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${i}`,s)}};function wat(t){let e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Uo(this)},t}var cs=B7;function Cat(t,e){xat(t,e),e.add(t)}function xat(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function q_(t,e,i){return e=Sat(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Sat(t){var e=Eat(t,"string");return typeof e=="symbol"?e:e+""}function Eat(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z0e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var V7=new WeakSet,yI=class{constructor(e,i,r){Cat(this,V7),q_(this,"hot",void 0),q_(this,"tableMeta",void 0),q_(this,"selection",void 0),q_(this,"eventManager",void 0),q_(this,"destroyed",!1),q_(this,"activeEditor",void 0),q_(this,"cellProperties",void 0),this.hot=e,this.tableMeta=i,this.selection=r,this.eventManager=new cs(e),this.hot.addHook("afterDocumentKeyDown",n=>Z0e(V7,this,Tat).call(this,n)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",n=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",n)}),this.hot.view._wt.update("onCellDblClick",(n,o,s)=>Z0e(V7,this,Rat).call(this,n,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,d=>{d&&this.prepareEditor()});return}let i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!i||i.isHeader())return;let{row:r,col:n}=i,o=this.hot.runHooks("modifyGetCellCoords",r,n),s=r,a=n;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}let c=this.hot.getCell(r,n,!0);if(c){let d=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=k5(d,this.hot),this.activeEditor.prepare(r,n,u,c,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}let n=this.hot.getSelectedRangeLast(),o=this.hot.runHooks("beforeBeginEditing",n.highlight.row,n.highlight.col,e,i,r);if(i instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&n.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,i))}closeEditor(e,i,r){this.activeEditor?this.activeEditor.finishEditing(e,i,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let e=this.hot.getSelectedRangeLast();if(!e)return!1;let i=this.hot.getCellEditor(this.cellProperties),{row:r,col:n}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!i||a)}moveSelectionAfterEnter(e){let i=Ke({},typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves);e.shiftKey&&(i.row=-i.row,i.col=-i.col),this.hot.selection.isMultiple()?this.selection.transformFocus(i.row,i.col):this.selection.transformStart(i.row,i.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}};function Tat(t){let e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Rf(t))return;let{keyCode:i}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!I5(i)&&!G0e(i)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function Rat(t,e){e.isCell()&&this.openEditor(null,t,!0)}var Q0e=new WeakMap;yI.getInstance=function(t,e,i){let r=Q0e.get(t);return r||(r=new yI(t,e,i),Q0e.set(t,r)),r};var J0e=yI;var Nci=U($e(),1);function Aat(t,e){t_e(t,e),e.add(t)}function wI(t,e,i){t_e(t,e),e.set(t,i)}function t_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yo(t,e){return t.get(hm(t,e))}function CI(t,e,i){return t.set(hm(t,e),i),i}function hm(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var m1=Object.freeze({CELL:"cell",MIXED:"mixed"}),na=new WeakMap,O5=new WeakMap,N5=new WeakMap,P5=new WeakMap,L5=new WeakMap,zv=new WeakSet,F5=class{constructor(e){var i=this;Aat(this,zv),wI(this,na,void 0),wI(this,O5,void 0),wI(this,N5,1),wI(this,P5,null),wI(this,L5,new Map);let r=e.getSettings();CI(na,this,e),CI(O5,this,r.imeFastEdit?m1.MIXED:m1.CELL),yo(na,this).addHook("afterUpdateSettings",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return hm(zv,i,Dat).call(i,...o)}),yo(na,this).addHook("afterSelection",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return hm(zv,i,e_e).call(i,...o)}),yo(na,this).addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return hm(zv,i,e_e).call(i,...o)}),yo(na,this).addHook("afterSelectionEnd",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return hm(zv,i,Iat).call(i,...o)})}getFocusMode(){return yo(O5,this)}setFocusMode(e){Object.values(m1).includes(e)?CI(O5,this,e):Zi(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return yo(N5,this)}setRefocusDelay(e){CI(N5,this,e)}setRefocusElementGetter(e){CI(P5,this,e)}getRefocusElement(){if(typeof yo(P5,this)=="function")return yo(P5,this).call(this);var e;return(e=yo(na,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){let i=r=>{var n,o;let s=(n=yo(na,this).getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;if(!s)return;let a=yo(na,this).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=yo(na,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?i(e):hm(zv,this,j7).call(this,r=>i(r))}refocusToEditorTextarea(){var e;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yo(N5,this),r=this.getRefocusElement();yo(na,this).getSettings().imeFastEdit&&!((e=yo(na,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(yo(L5,this).has(i)||yo(L5,this).set(i,o1(()=>{r.select()},i)),yo(L5,this).get(i)())}};function j7(t){var e;let i=(e=yo(na,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!i||!yo(na,this).selection.isCellVisible(i)){t(null);return}let r=yo(na,this).getCell(i.row,i.col,!0);r===null?yo(na,this).addHookOnce("afterScroll",()=>{t(yo(na,this).getCell(i.row,i.col,!0))}):t(r)}function e_e(){hm(zv,this,j7).call(this,t=>{let{activeElement:e}=yo(na,this).rootDocument;e&&b5(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Iat(){hm(zv,this,j7).call(this,t=>{this.getFocusMode()===m1.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function Dat(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?m1.MIXED:m1.CELL)}var jci=U(dt(),1),zci=U(n_e(),1);var o_e={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},qat=new RegExp(Object.keys(o_e).map(t=>`(${t})`).join("|"),"gi");function Yat(t){return(t&&t.nodeName||"")==="TABLE"}function U7(t){let e=t.hasColHeaders(),i=t.hasRowHeaders(),r=[e?-1:0,i?-1:0,t.countRows()-1,t.countCols()-1],n=t.getData(...r),o=n.length,s=o>0?n[0].length:0,a=["<table>","</table>"],c=e?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],u=i?1:0,h=e?1:0;for(let p=0;p<o;p+=1){let f=e&&p===0,m=[];for(let y=0;y<s;y+=1){let w=!f&&i&&y===0,x="";if(f)x=`<th>${t.getColHeader(y-u)}</th>`;else if(w)x=`<th>${t.getRowHeader(p-h)}</th>`;else{let T=n[p][y],{hidden:M,rowspan:B,colspan:G}=t.getCellMeta(p-h,y-u);if(!M){let F=[];if(B&&F.push(`rowspan="${B}"`),G&&F.push(`colspan="${G}"`),jr(T))x=`<td ${F.join(" ")}></td>`;else{let O=T.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");x=`<td ${F.join(" ")}>${O}</td>`}}}m.push(x)}let g=["<tr>",...m,"</tr>"].join("");f?c.splice(1,0,g):d.splice(-1,0,g)}return a.splice(1,0,c.join(""),d.join("")),a.join("")}function q7(t){let e=t.length,i=["<table>"];for(let r=0;r<e;r+=1){let n=t[r],o=n.length,s=[];r===0&&i.push("<tbody>");for(let a=0;a<o;a+=1){let c=n[a],d=jr(c)?"":c.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${d}</td>`)}i.push("<tr>",...s,"</tr>"),r+1===e&&i.push("</tbody>")}return i.push("</table>"),i.join("")}function s_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,i={},r=e.createDocumentFragment(),n=e.createElement("div");r.appendChild(n);let o=t;if(typeof o=="string"){let T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,M=>{let B=M.match(/<td\b[^>]*?>/g)[0],G=/<p.*?>/g,F=M.substring(B.length,M.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(G,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${B}${F}</td>`});n.insertAdjacentHTML("afterbegin",`${T}`),o=n.querySelector("table")}if(!o||!Yat(o))return;let s=n.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,c=o.querySelector("tr"),d=c?Array.from(c.cells).reduce((T,M)=>T+M.colSpan,0)-(a?1:0):0,u=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[],p=!1,f=0,m=0;if(o.tHead){let T=Array.from(o.tHead.rows).filter(M=>{let B=M.querySelector("td")!==null;return B&&h.push(M),!B});f=T.length,p=f>0,f>1?i.nestedHeaders=Array.from(T).reduce((M,B)=>{let G=Array.from(B.cells).reduce((F,O,V)=>{if(a&&V===0)return F;let{colSpan:J,innerHTML:N}=O,P=J>1?{label:N,colspan:J}:N;return F.push(P),F},[]);return M.push(G),M},[]):p&&(i.colHeaders=Array.from(T[0].children).reduce((M,B,G)=>(a&&G===0||M.push(B.innerHTML),M),[]))}h.length&&(i.fixedRowsTop=h.length),u.length&&(i.fixedRowsBottom=u.length);let g=[...h,...Array.from(o.tBodies).reduce((T,M)=>(T.push(...Array.from(M.rows)),T),[]),...u];m=g.length;let y=new Array(m);for(let T=0;T<m;T++)y[T]=new Array(d);let w=[],x=[];for(let T=0;T<m;T++){let M=g[T],B=Array.from(M.cells),G=B.length;for(let F=0;F<G;F++){let O=B[F],{nodeName:V,innerHTML:J,rowSpan:N,colSpan:P}=O,$=y[T].findIndex(K=>K===void 0);if(V==="TD"){if(N>1||P>1){for(let ee=T;ee<T+N;ee++)if(ee<m)for(let te=$;te<$+P;te++)y[ee][te]=null;let ve=O.getAttribute("style");ve&&ve.includes("mso-ignore:colspan")||w.push({col:$,row:T,rowspan:N,colspan:P})}let K="";s&&/excel/gi.test(s.content)?K=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):K=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[T][$]=K.replace(qat,ve=>o_e[ve])}else x.push(J)}}return w.length&&(i.mergeCells=w),x.length&&(i.rowHeaders=x),y.length&&(i.data=y),i}var gdi=U($e(),1);var Jci=U($e(),1);var qci=U(ln(),1),Yci=U(cn(),1),$ci=U(dn(),1),Gci=U(un(),1),Xci=U(hn(),1),Kci=U(fn(),1),Zci=U(pn(),1);function ds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=typeof t;if(i==="number")return!isNaN(t)&&isFinite(t);if(i==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);let r=Array.from(new Set([".",...e])).map(n=>`\\${n}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(i==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function a_e(t){return ds(t,[","])}function _t(t,e,i){let r=-1;for(typeof e=="function"?(i=e,e=t):r=t-1;++r<=e&&i(r)!==!1;);}function xI(t,e,i){let r=t+1;for(typeof e=="function"&&(i=e,e=0);--r>=e&&i(r)!==!1;);}function H5(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Rr(t,e,i){return Math.min(t,e)===t?e:Math.max(t,i)===t?i:t}var Y7="asc",$at="desc",l_e=new Map([[Y7,[-1,1]],[$at,[1,-1]]]),Gat=t=>`The priority '${t}' is already declared in a map.`,Xat=t=>`The priority '${t}' is not a number.`;function c_e(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=new Map;t=nr(t)?t:Gat,e=nr(e)?e:Xat;function r(o,s){if(!ds(o))throw new Error(e(o));if(i.has(o))throw new Error(t(o));i.set(o,s)}function n(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y7,[s,a]=l_e.get(o)||l_e.get(Y7);return[...i].sort((c,d)=>c[0]<d[0]?s:a).map(c=>c[1])}return{addItem:r,getItems:n}}var rdi=U($e(),1);var Kat=t=>`The id '${t}' is already declared in a map.`;function Wv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Map;t=nr(t)?t:Kat;function i(d,u){if(c(d))throw new Error(t(d));e.set(d,u)}function r(d){return e.delete(d)}function n(){e.clear()}function o(d){let[u]=a().find(h=>{let[p,f]=h;return d===f?p:!1})||[null];return u}function s(d){return e.get(d)}function a(){return[...e]}function c(d){return e.has(d)}return{addItem:i,clear:n,getId:o,getItem:s,getItems:a,hasItem:c,removeItem:r}}var sdi=U($e(),1),adi=U(ln(),1),ldi=U(cn(),1),cdi=U(dn(),1),ddi=U(un(),1),udi=U(hn(),1),hdi=U(fn(),1),fdi=U(pn(),1);var Zat=t=>`'${t}' value is already declared in a unique set.`;function d_e(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Set;t=nr(t)?t:Zat;function i(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function n(){e.clear()}return{addItem:i,clear:n,getItems:r}}var G7=t=>`There is already registered "${t}" plugin.`,Qat=t=>`There is already registered plugin on priority "${t}".`,Jat=t=>`The priority "${t}" is not a number.`,u_e=c_e({errorPriorityExists:Qat,errorPriorityNaN:Jat}),h_e=d_e({errorItemExists:G7}),$7=Wv({errorIdExists:G7});function B5(){return[...u_e.getItems(),...h_e.getItems()]}function V5(t){let e=ka(t);return $7.getItem(e)}function f_e(t){return!!V5(t)}function Or(t,e,i){[t,e,i]=tlt(t,e,i),V5(t)===void 0&&elt(t,e,i)}function elt(t,e,i){let r=ka(t);if($7.hasItem(r))throw new Error(G7(r));i===void 0?h_e.addItem(r):u_e.addItem(i,r),$7.addItem(r,e)}function tlt(t,e,i){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,i=e.PLUGIN_PRIORITY),[t,e,i]}var Cdi=U($e(),1);var{register:ilt,getItem:rlt,hasItem:X7,getNames:Sdi,getValues:Edi}=ls("renderers");function K7(t){if(typeof t=="function")return t;if(!X7(t))throw Error(`No registered renderer found under "${t}" name`);return rlt(t)}function yc(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),ilt(t,e)}var Rdi=U($e(),1);var{register:nlt,getItem:olt,hasItem:Z7,getNames:Idi,getValues:Ddi}=ls("validators");function p_e(t){if(typeof t=="function")return t;if(!Z7(t))throw Error(`No registered validator found under "${t}" name`);return olt(t)}function Uv(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),nlt(t,e)}var bgi=U($e(),1),_gi=U(dt(),1);var kdi=U($e(),1);function j5(t,e,i){return e=slt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function slt(t){var e=alt(t,"string");return typeof e=="symbol"?e:e+""}function alt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SI=class{constructor(e){j5(this,"count",0),j5(this,"startColumn",0),j5(this,"endColumn",0),j5(this,"startPosition",0),this.count=e.totalColumns,this.endColumn=this.count-1}};var Ndi=U($e(),1);function z5(t,e,i){return e=llt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function llt(t){var e=clt(t,"string");return typeof e=="symbol"?e:e+""}function clt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var EI=class{constructor(e){z5(this,"count",0),z5(this,"startRow",0),z5(this,"endRow",0),z5(this,"startPosition",0),this.count=e.totalRows,this.endRow=this.count-1}};var Hdi=U($e(),1),Bdi=U(Q7(),1),Vdi=U(dt(),1);function mlt(t,e,i){glt(t,e),e.set(t,i)}function glt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TI(t,e,i){return e=vlt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function vlt(t){var e=blt(t,"string");return typeof e=="symbol"?e:e+""}function blt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v1(t,e){return t.get(m_e(t,e))}function _lt(t,e,i){return t.set(m_e(t,e),i),i}function m_e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var qv=new WeakMap,Af=class t{static get DEFAULT_WIDTH(){return 50}constructor(e){TI(this,"count",0),TI(this,"startColumn",null),TI(this,"endColumn",null),TI(this,"startPosition",null),TI(this,"isVisibleInTrimmingContainer",!1),mlt(this,qv,void 0),_lt(qv,this,e),this.calculate()}calculate(){let{calculationType:e,overrideFn:i,scrollOffset:r,totalColumns:n,viewportWidth:o}=v1(qv,this),s=Math.max(v1(qv,this).scrollOffset,0),a=s>0?o+1:o,c=0,d=!0,u=[],h,p=0,f=0;for(let w=0;w<n;w++)if(h=this._getColumnWidth(w),c<=s&&e!==2&&(this.startColumn=w,p=h),c>=s&&c+(e===2?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=w,p=h),this.endColumn=w),u.push(c),c+=h,f=h,e!==2&&(this.endColumn=w),c>=s+o){d=!1;break}let m=r+o-a,g=e===2?0:f,y=e===2?p:0;if(m<-1*v1(qv,this).inlineStartOffset||r>u.at(-1)+g||-1*v1(qv,this).scrollOffset-v1(qv,this).viewportWidth>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===n-1&&d)for(this.startColumn=this.endColumn;this.startColumn>0;){let w=u[this.endColumn]+h-u[this.startColumn-1];if((w<=o||e!==2)&&(this.startColumn-=1),w>o)break}e===1&&this.startColumn!==null&&i&&i(this),this.startPosition=u[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),n<this.endColumn&&(this.endColumn=n-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(e){let i=v1(qv,this).columnWidthFn(e);return isNaN(i)&&(i=t.DEFAULT_WIDTH),i}};var zdi=U($e(),1),Wdi=U(Q7(),1),Udi=U(dt(),1);function ylt(t,e,i){wlt(t,e),e.set(t,i)}function wlt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RI(t,e,i){return e=Clt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Clt(t){var e=xlt(t,"string");return typeof e=="symbol"?e:e+""}function xlt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function J7(t,e){return t.get(g_e(t,e))}function Slt(t,e,i){return t.set(g_e(t,e),i),i}function g_e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var AI=new WeakMap,$v=class t{static get DEFAULT_HEIGHT(){return 23}constructor(e){RI(this,"count",0),RI(this,"startRow",null),RI(this,"endRow",null),RI(this,"startPosition",null),RI(this,"isVisibleInTrimmingContainer",!1),ylt(this,AI,void 0),Slt(AI,this,e),this.calculate()}calculate(){let{calculationType:e,overrideFn:i,rowHeightFn:r,scrollOffset:n,totalRows:o,viewportHeight:s}=J7(AI,this),a=Math.max(J7(AI,this).scrollOffset,0),c=J7(AI,this).horizontalScrollbarHeight||0,d=a+s-c,u=0,h=!0,p=[],f,m=0,g=0;for(let T=0;T<o;T++)if(f=r(T),isNaN(f)&&(f=t.DEFAULT_HEIGHT),u<=a&&e!==2&&(this.startRow=T,m=f),u>=a&&u+(e===2?f:0)<=d&&(this.startRow===null&&(this.startRow=T,m=f),this.endRow=T),p.push(u),u+=f,g=f,e!==2&&(this.endRow=T),u>=d){h=!1;break}let y=n+s-c,w=e===2?m:0,x=e===2?0:g;if(y<w||n>p.at(-1)+x?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&h)for(this.startRow=this.endRow;this.startRow>0;){let T=p[this.endRow]+f-p[this.startRow-1];if((T<=s-c||e!==2)&&(this.startRow-=1),T>=s-c)break}e===1&&this.startRow!==null&&i&&i(this),this.startPosition=p[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}};var Qdi=U($e(),1);function Elt(t,e,i){Tlt(t,e),e.set(t,i)}function Tlt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v_e(t,e,i){return e=Rlt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Rlt(t){var e=Alt(t,"string");return typeof e=="symbol"?e:e+""}function Alt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b1(t,e){return t.get(__e(t,e))}function b_e(t,e,i){return t.set(__e(t,e),i),i}function __e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var fm=new WeakMap,e9=class t{constructor(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;v_e(this,"row",null),v_e(this,"col",null),Elt(this,fm,!1),b_e(fm,this,r),typeof e<"u"&&typeof i<"u"&&(this.row=e,this.col=i)}isValid(e){let{countRows:i,countCols:r,countRowHeaders:n,countColHeaders:o}=Ke({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},e);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-n||this.row>=i||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return b1(fm,this)}isSouthEastOf(e){return this.row>=e.row&&(b1(fm,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(b1(fm,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(b1(fm,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(b1(fm,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof t&&b_e(fm,this,e.isRtl()),this}clone(){return new t(this.row,this.col,b1(fm,this))}toObject(){return{row:this.row,col:this.col}}},Gv=e9;var tui=U($e(),1),iui=U(dt(),1);function Ilt(t,e,i){Dlt(t,e),e.set(t,i)}function Dlt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t9(t,e,i){return e=Mlt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Mlt(t){var e=klt(t,"string");return typeof e=="symbol"?e:e+""}function klt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tu(t,e){return t.get(y_e(t,e))}function Olt(t,e,i){return t.set(y_e(t,e),i),i}function y_e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var wc=new WeakMap,i9=class t{constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;t9(this,"highlight",null),t9(this,"from",null),t9(this,"to",null),Ilt(this,wc,!1),this.highlight=e.clone(),this.from=i.clone(),this.to=r.clone(),Olt(wc,this,n)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let e=Math.max(this.from.row,0),i=Math.max(this.to.row,0);return Math.max(e,i)-Math.min(e,i)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let e=Math.max(this.from.col,0),i=Math.max(this.to.col,0);return Math.max(e,i)-Math.min(e,i)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){let{row:i,col:r}=e,n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return n.row<=i&&o.row>=i&&n.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){let i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<i.row||e.col<i.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(i.row,e.row),Math.min(i.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;let r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),c=Math.min(r.row,s.row),d=Math.min(r.col,s.col),u=Math.max(n.row,a.row),h=Math.max(n.col,a.col),p=this._createCellCoords(c,d),f=this._createCellCoords(u,h);return this.from=p,this.to=f,this.setDirection(o),i&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return tu(wc,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return tu(wc,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return tu(wc,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return tu(wc,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return tu(wc,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return tu(wc,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return tu(wc,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return tu(wc,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Gv))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];let i={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},n=[];return i.top===r.top&&n.push("top"),i.right===r.right&&n.push(tu(wc,this)?"left":"right"),i.bottom===r.bottom&&n.push("bottom"),i.left===r.left&&n.push(tu(wc,this)?"right":"left"),n}getInner(){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),r=[];for(let n=e.row;n<=i.row;n++)for(let o=e.col;o<=i.col;o++)!(this.from.row===n&&this.from.col===o)&&!(this.to.row===n&&this.to.col===o)&&r.push(this._createCellCoords(n,o));return r}getAll(){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),r=[];for(let n=e.row;n<=i.row;n++)for(let o=e.col;o<=i.col;o++)e.row===n&&e.col===o?r.push(e):i.row===n&&i.col===o?r.push(i):r.push(this._createCellCoords(n,o));return r}forAll(e){let i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let n=i.row;n<=r.row;n++)for(let o=i.col;o<=r.col;o++)if(e(n,o)===!1)return}clone(){return new t(this.highlight,this.from,this.to,tu(wc,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,i){return new Gv(e,i,tu(wc,this))}},Y_=i9;var Xmi=U(dt(),1);var oui=U($e(),1);function If(t,e,i){Nlt(t,e),e.set(t,i)}function Nlt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function si(t,e){return t.get(w_e(t,e))}function Xv(t,e,i){return t.set(w_e(t,e),i),i}function w_e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var iu=new WeakMap,r9=new WeakMap,oa=new WeakMap,_1=new WeakMap,W5=new WeakMap,eh=new WeakMap,n9=new WeakMap,II=new WeakMap,$_=new WeakMap,Df=new WeakMap,o9=class{constructor(e,i,r,n,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;If(this,iu,void 0),If(this,r9,void 0),If(this,oa,void 0),If(this,_1,void 0),If(this,W5,void 0),If(this,eh,void 0),If(this,n9,void 0),If(this,II,void 0),If(this,$_,[null,null]),If(this,Df,[null,null]),Xv(iu,this,r),Xv(r9,this,i),Xv(oa,this,o),Xv(_1,this,s),Xv(W5,this,a),Xv(eh,this,n),Xv(n9,this,e),this.registerEvents()}registerEvents(){si(eh,this).addEventListener(si(oa,this).holder,"contextmenu",r=>this.onContextMenu(r)),si(eh,this).addEventListener(si(oa,this).TABLE,"mouseover",r=>this.onMouseOver(r)),si(eh,this).addEventListener(si(oa,this).TABLE,"mouseout",r=>this.onMouseOut(r));let e=()=>{si(eh,this).addEventListener(si(oa,this).holder,"touchstart",r=>this.onTouchStart(r)),si(eh,this).addEventListener(si(oa,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),si(eh,this).addEventListener(si(oa,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||si(iu,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,si(iu,this).getSetting("onAfterMomentumScroll"))},200)})},i=()=>{si(eh,this).addEventListener(si(oa,this).holder,"mouseup",r=>this.onMouseUp(r)),si(eh,this).addEventListener(si(oa,this).holder,"mousedown",r=>this.onMouseDown(r))};rd()?e():(S5()&&e(),i())}selectedCellWasTouched(e){let r=this.parentCell(e).coords;if(si(II,this)&&r){let[n,o]=[r.row,si(II,this).from.row],[s,a]=[r.col,si(II,this).from.col];return n===o&&s===a}return!1}parentCell(e){let i={},r=si(oa,this).TABLE,n=pI(e,["TD","TH"],r);return n?(i.coords=si(oa,this).getCoords(n),i.TD=n):Bt(e,"wtBorder")&&Bt(e,"current")?(i.coords=si(_1,this).getFocusSelection().cellRange.highlight,i.TD=si(oa,this).getCell(i.coords)):Bt(e,"wtBorder")&&Bt(e,"area")&&si(_1,this).getAreaSelection().cellRange&&(i.coords=si(_1,this).getAreaSelection().cellRange.to,i.TD=si(oa,this).getCell(i.coords)),i}onMouseDown(e){let i=si(r9,this).rootDocument.activeElement,r=y5(h0e,e.target),n=e.target;if(!["TD","TH"].includes(i.nodeName)&&(n===i||r(0)===i||r(1)===i))return;let o=this.parentCell(n);Bt(n,"corner")?si(iu,this).getSetting("onCellCornerMouseDown",e,n):o.TD&&si(iu,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(si(Df,this)[0]=o.TD,clearTimeout(si($_,this)[0]),si($_,this)[0]=setTimeout(()=>{si(Df,this)[0]=null},1e3))}onContextMenu(e){if(si(iu,this).has("onCellContextMenu")){let i=this.parentCell(e.target);i.TD&&this.callListener("onCellContextMenu",e,i.coords,i.TD)}}onMouseOver(e){if(!si(iu,this).has("onCellMouseOver"))return;let i=si(oa,this).TABLE,r=pI(e.target,["TD","TH"],i),n=si(W5,this)||this;r&&r!==n.lastMouseOver&&Zu(r,i)&&(n.lastMouseOver=r,this.callListener("onCellMouseOver",e,si(oa,this).getCoords(r),r))}onMouseOut(e){if(!si(iu,this).has("onCellMouseOut"))return;let i=si(oa,this).TABLE,r=pI(e.target,["TD","TH"],i),n=pI(e.relatedTarget,["TD","TH"],i),o=si(W5,this)||this;r&&r!==n&&Zu(r,i)&&(this.callListener("onCellMouseOut",e,si(oa,this).getCoords(r),r),n===null&&(o.lastMouseOver=null))}onMouseUp(e){let i=this.parentCell(e.target);i.TD&&si(iu,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,i.coords,i.TD),!(e.button!==0&&!this.touchApplied)&&(i.TD===si(Df,this)[0]&&i.TD===si(Df,this)[1]?(Bt(e.target,"corner")?this.callListener("onCellCornerDblClick",e,i.coords,i.TD):this.callListener("onCellDblClick",e,i.coords,i.TD),si(Df,this)[0]=null,si(Df,this)[1]=null):i.TD===si(Df,this)[0]&&(si(Df,this)[1]=i.TD,clearTimeout(si($_,this)[1]),si($_,this)[1]=setTimeout(()=>{si(Df,this)[1]=null},500)))}onTouchStart(e){Xv(II,this,si(_1,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var i;let r=e.target,n=(i=this.parentCell(r))===null||i===void 0?void 0:i.coords,o=wt(n)&&n.row>=0&&n.col>=0;if(e.cancelable&&o&&si(iu,this).getSetting("isDataViewInstance")){let a=["A","BUTTON","INPUT"];R5()&&(U0e()||q0e())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,i,r,n){let o=si(iu,this).getSettingPure(e);o&&o(i,r,n,si(n9,this).call(this))}destroy(){clearTimeout(si($_,this)[0]),clearTimeout(si($_,this)[1]),si(eh,this).destroy()}},U5=o9;var Tmi=U($e(),1),Rmi=U(dt(),1);var Ahi=U($e(),1),Ihi=U(dt(),1);var hui=U($e(),1);function s9(t,e,i){return e=Plt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Plt(t){var e=Llt(t,"string");return typeof e=="symbol"?e:e+""}function Llt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var a9=class{constructor(e,i,r){s9(this,"offset",void 0),s9(this,"total",void 0),s9(this,"countTH",void 0),this.offset=e,this.total=i,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}},C_e=a9;var pui=U($e(),1);function l9(t,e,i){return e=Flt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Flt(t){var e=Hlt(t,"string");return typeof e=="symbol"?e:e+""}function Hlt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var c9=class{constructor(e,i,r){l9(this,"offset",void 0),l9(this,"total",void 0),l9(this,"countTH",void 0),this.offset=e,this.total=i,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}},x_e=c9;var Lui=U($e(),1);var Cui=U($e(),1),xui=U(dt(),1);var _ui=U($e(),1);var gui=U($e(),1);function q5(t,e,i){return e=Blt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Blt(t){var e=Vlt(t,"string");return typeof e=="symbol"?e:e+""}function Vlt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var DI=class{constructor(){q5(this,"currentSize",0),q5(this,"nextSize",0),q5(this,"currentOffset",0),q5(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}};function d9(t,e,i){return e=jlt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function jlt(t){var e=zlt(t,"string");return typeof e=="symbol"?e:e+""}function zlt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Y5=class{constructor(){d9(this,"size",new DI),d9(this,"workingSpace",0),d9(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof DI}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}};function y1(t,e,i){return e=Wlt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Wlt(t){var e=Ult(t,"string");return typeof e=="symbol"?e:e+""}function Ult(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var G_=class{constructor(e,i,r){y1(this,"rootNode",void 0),y1(this,"nodesPool",void 0),y1(this,"sizeSet",new Y5),y1(this,"childNodeType",void 0),y1(this,"visualIndex",0),y1(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=i,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){let e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){let{rootNode:e,sizeSet:i}=this,r=0;if(this.isSharedViewSet()){let n=e.firstElementChild;for(;n;){if(n.tagName===this.childNodeType)r+=1;else if(i.isPlaceOn(1))break;n=n.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:e,sizeSet:i}=this,r=this.isSharedViewSet(),{nextSize:n}=i.getViewSize(),o=this.getRenderedChildCount();for(;o<n;){let a=this.nodesPool();!r||r&&i.isPlaceOn(2)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}let s=r&&i.isPlaceOn(1);for(;o>n;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){let{rootNode:e,sizeSet:i}=this,r=this.visualIndex;this.isSharedViewSet()&&i.isPlaceOn(2)&&(r+=i.sharedSize.nextSize);let n=e.childNodes[r];if(n.tagName!==this.childNodeType){let o=this.nodesPool();e.replaceChild(o,n),n=o}this.collectedNodes.push(n),this.visualIndex+=1}end(){}};var X_=class extends G_{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}};var Oui=U($e(),1);var Mui=U($e(),1);function qlt(t,e,i){return e=Ylt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ylt(t){var e=$lt(t,"string");return typeof e=="symbol"?e:e+""}function $lt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $5=class{constructor(e){qlt(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}};function MI(t,e,i){return e=Glt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Glt(t){var e=Xlt(t,"string");return typeof e=="symbol"?e:e+""}function Xlt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ru=class{constructor(e,i){MI(this,"nodesPool",null),MI(this,"nodeType",void 0),MI(this,"rootNode",void 0),MI(this,"table",null),MI(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new $5(e):null,this.nodeType=e,this.rootNode=i}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}};function S_e(t,e,i){return e=Klt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Klt(t){var e=Zlt(t,"string");return typeof e=="symbol"?e:e+""}function Zlt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var G5=class extends ru{constructor(){super("TH"),S_e(this,"orderViews",new WeakMap),S_e(this,"sourceRowIndex",0)}obtainOrderView(e){let i;return this.orderViews.has(e)?i=this.orderViews.get(e):(i=new X_(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,i)),i}render(){let{rowsToRender:e,rowHeaderFunctions:i,rowHeadersCount:r,rows:n,cells:o}=this.table;for(let s=0;s<e;s++){let a=this.table.renderedRowToSource(s),c=n.getRenderedNode(s);this.sourceRowIndex=a;let d=this.obtainOrderView(c),u=o.obtainOrderView(c);d.appendView(u).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){d.render();let p=d.getCurrentNode();p.className="",p.removeAttribute("style"),Kd(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ht(p,[qbe(),Jbe(),e1(h+1),Gd(-1)]),i[h](a,p,h)}d.end()}}};var X5=class extends ru{constructor(e){super(null,e)}adjust(){let{columnHeadersCount:e,rowHeadersCount:i}=this.table,r=this.rootNode.firstChild;if(e){let{columnsToRender:n}=this.table,o=n+i;for(let a=0,c=e;a<c;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}let s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ia(r)}render(){let{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ht(this.rootNode,[d5()]);for(let i=0;i<e;i+=1){let{columnHeaderFunctions:r,columnsToRender:n,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[i];this.table.isAriaEnabled()&&Ht(s,[fI(),p5(i+1)]);for(let a=-1*o;a<n;a+=1){let c=this.table.renderedColumnToSource(a),d=s.childNodes[a+o];d.className="",d.removeAttribute("style"),Kd(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ht(d,[e1(a+1+this.table.rowHeadersCount),Gd(-1),Ybe(),...a>=0?[Qbe()]:[fI()]]),r[i](c,d,i)}}}};var E_e=!1,K5=class extends ru{constructor(e){super(null,e)}adjust(){let{columnsToRender:e,rowHeadersCount:i}=this.table,r=e+i;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:e,rowHeadersCount:i}=this.table;!E_e&&e>1e3&&(E_e=!0,Zi(Ai`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let n=0;n<i;n++){let o=this.table.renderedColumnToSource(n),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[n].style.width=`${s}px`}for(let n=0;n<e;n++){let o=this.table.renderedColumnToSource(n),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[n+i].style.width=`${s}px`}let r=this.rootNode.firstChild;r&&Qe(r,"rowHeader")}};var Zui=U($e(),1);function Qlt(t,e,i){return e=Jlt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Jlt(t){var e=ect(t,"string");return typeof e=="symbol"?e:e+""}function ect(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var T_e=!1,Z5=class extends ru{constructor(e){super("TR",e),Qlt(this,"orderView",void 0),this.orderView=new G_(e,i=>this.nodesPool.obtain(i),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){let{rowsToRender:e}=this.table;!T_e&&e>1e3&&(T_e=!0,Zi(Ai`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ht(this.rootNode,[d5()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<e;n++){this.orderView.render();let o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(n);if(this.table.isAriaEnabled()){var i,r;Ht(o,[fI(),p5(s+((i=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&i!==void 0?i:0)+1)])}}this.orderView.end()}};var ohi=U($e(),1);function R_e(t,e,i){return e=tct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tct(t){var e=ict(t,"string");return typeof e=="symbol"?e:e+""}function ict(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Q5=class extends ru{constructor(){super("TD"),R_e(this,"orderViews",new WeakMap),R_e(this,"sourceRowIndex",0)}obtainOrderView(e){let i;return this.orderViews.has(e)?i=this.orderViews.get(e):(i=new X_(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,i)),i}render(){let{rowsToRender:e,columnsToRender:i,rows:r,rowHeaders:n}=this.table;for(let a=0;a<e;a++){let c=this.table.renderedRowToSource(a),d=r.getRenderedNode(a);this.sourceRowIndex=c;let u=this.obtainOrderView(d),h=n.obtainOrderView(d);u.prependView(h).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let p=0;p<i;p++){u.render();let f=u.getCurrentNode(),m=this.table.renderedColumnToSource(p);if(Bt(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),Kd(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(c,m,f),this.table.isAriaEnabled()){var o,s;Ht(f,[...f.hasAttribute("role")?[]:[Ube()],Gd(-1),e1(m+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}u.end()}}};var uhi=U($e(),1);function sa(t,e,i){return e=rct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function rct(t){var e=nct(t,"string");return typeof e=="symbol"?e:e+""}function nct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var J5=class{constructor(e){let{cellRenderer:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sa(this,"rootNode",void 0),sa(this,"rootDocument",void 0),sa(this,"rowHeaders",null),sa(this,"columnHeaders",null),sa(this,"colGroup",null),sa(this,"rows",null),sa(this,"cells",null),sa(this,"rowFilter",null),sa(this,"columnFilter",null),sa(this,"rowUtils",null),sa(this,"columnUtils",null),sa(this,"rowsToRender",0),sa(this,"columnsToRender",0),sa(this,"rowHeaderFunctions",[]),sa(this,"rowHeadersCount",0),sa(this,"columnHeaderFunctions",[]),sa(this,"columnHeadersCount",0),sa(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=i}setAxisUtils(e,i){this.rowUtils=e,this.columnUtils=i}setViewportSize(e,i){this.rowsToRender=e,this.columnsToRender=i}setFilters(e,i){this.rowFilter=e,this.columnFilter=i}setHeaderContentRenderers(e,i){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=i,this.columnHeadersCount=i.length}setRenderers(){let{rowHeaders:e,columnHeaders:i,colGroup:r,rows:n,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),i.setTable(this),r.setTable(this),n.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=i,this.colGroup=r,this.rows=n,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:e,rows:i}=this;for(let r=0;r<e;r++){let n=i.getRenderedNode(r);if(n.firstChild){let o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?n.firstChild.style.height=`${s-1}px`:n.firstChild.style.height=""}}}};var eH=class{constructor(){let{TABLE:e,THEAD:i,COLGROUP:r,TBODY:n,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new J5(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new G5,columnHeaders:new X5(i),colGroup:new K5(r),rows:new Z5(n),cells:new Q5}),this.renderer.setAxisUtils(o,s)}setFilters(e,i){return this.renderer.setFilters(e,i),this}setViewportSize(e,i){return this.renderer.setViewportSize(e,i),this}setHeaderContentRenderers(e,i){return this.renderer.setHeaderContentRenderers(e,i),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}};var Chi=U($e(),1);var yhi=U($e(),1);function kI(t,e,i){oct(t,e),e.set(t,i)}function oct(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tH(t,e,i){return e=sct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function sct(t){var e=act(t,"string");return typeof e=="symbol"?e:e+""}function act(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ll(t,e){return t.get(A_e(t,e))}function OI(t,e,i){return t.set(A_e(t,e),i),i}function A_e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var iH=new WeakMap,w1=new WeakMap,NI=new WeakMap,rH=new WeakMap,K_=new WeakMap,nH=class t{static get DEFAULT_WIDTH(){return 50}constructor(e){let{totalColumns:i,stretchMode:r,stretchingColumnWidthFn:n,columnWidthFn:o}=e;tH(this,"stretchAllRatio",0),tH(this,"stretchLastWidth",0),tH(this,"stretchAllColumnsWidth",[]),kI(this,iH,0),tH(this,"needVerifyLastColumnWidth",!0),kI(this,w1,()=>0),kI(this,NI,s=>s),kI(this,rH,s=>s),kI(this,K_,()=>"none"),OI(w1,this,i),OI(K_,this,r),OI(NI,this,n??ll(NI,this)),OI(rH,this,o??ll(rH,this))}refreshStretching(e){if(ll(K_,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,OI(iH,this,e);let i=0;for(let n=0;n<ll(w1,this).call(this);n++){let o=this._getColumnWidth(n),s=ll(NI,this).call(this,void 0,n);typeof s=="number"?e-=s:i+=o}let r=e-i;if(ll(K_,this).call(this)==="all"&&r>0)this.stretchAllRatio=e/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(ll(K_,this).call(this)==="last"&&e!==1/0){let n=this._getColumnWidth(ll(w1,this).call(this)-1),o=r+n;this.stretchLastWidth=o>=0?o:n}}getStretchedColumnWidth(e,i){let r=null;return ll(K_,this).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,i):ll(K_,this).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,i){let r=0;if(!this.stretchAllColumnsWidth[e]){let n=Math.round(i*this.stretchAllRatio),o=ll(NI,this).call(this,n,e);o===void 0?this.stretchAllColumnsWidth[e]=n:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===ll(w1,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let n=0;n<this.stretchAllColumnsWidth.length;n++)r+=this.stretchAllColumnsWidth[n];r!==ll(iH,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=ll(iH,this)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===ll(w1,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let i=ll(rH,this).call(this,e);return isNaN(i)&&(i=t.DEFAULT_WIDTH),i}};function oH(t,e,i){return e=lct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function lct(t){var e=cct(t,"string");return typeof e=="symbol"?e:e+""}function cct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sH=class{constructor(e,i){oH(this,"dataAccessObject",void 0),oH(this,"wtSettings",void 0),oH(this,"headerWidths",new Map),oH(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=i,this.stretching=new nH({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,n)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,n),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let i=this.getWidth(e),r=this.stretching.getStretchedColumnWidth(e,i);return r&&(i=r),i}getHeaderHeight(e){let i=this.wtSettings.getSetting("defaultRowHeight"),r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(i=i?Math.max(i,r):r),i}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){let{wtTable:e,wtViewport:i,cloneSource:r}=this.dataAccessObject,n=r?r.wtTable.holder:e.holder,o=n.offsetHeight<n.scrollHeight?mn():0;this.stretching.refreshStretching(i.getViewportWidth()-o)}calculateWidths(){let{wtSettings:e}=this,i=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),i=e.getSetting("onModifyRowHeaderWidth",i),i!=null){let r=e.getSetting("rowHeaders").length,n=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(i)?i[o]:i;s=s??n,this.headerWidths.set(o,s)}}}};var Thi=U($e(),1);function I_e(t,e,i){return e=dct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function dct(t){var e=uct(t,"string");return typeof e=="symbol"?e:e+""}function uct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var aH=class{constructor(e,i){I_e(this,"dataAccessObject",void 0),I_e(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=i}getHeight(e){let i=this.wtSettings.getSetting("rowHeight",e),r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}};function Mf(t,e,i){return e=hct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function hct(t){var e=fct(t,"string");return typeof e=="symbol"?e:e+""}function fct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var f9=class{constructor(e,i,r,n,o){Mf(this,"wtSettings",null),Mf(this,"domBindings",void 0),Mf(this,"TBODY",null),Mf(this,"THEAD",null),Mf(this,"COLGROUP",null),Mf(this,"hasTableHeight",!0),Mf(this,"hasTableWidth",!0),Mf(this,"isTableVisible",!1),Mf(this,"tableOffset",0),Mf(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=i,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,S7(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new aH(this.dataAccessObject,this.wtSettings),this.columnUtils=new sH(this.dataAccessObject,this.wtSettings),this.tableRenderer=new eH({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){let e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){let i=e.parentNode,r;return(!i||i.nodeType!==Node.ELEMENT_NODE||!Bt(i,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",i&&i.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ht(r,[Fl()]),r}createHider(e){let i=e.parentNode,r;return(!i||i.nodeType!==Node.ELEMENT_NODE||!Bt(i,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",i&&i.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ht(r,[Fl()]),r}createHolder(e){let i=e.parentNode,r;return(!i||i.nodeType!==Node.ELEMENT_NODE||!Bt(i,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",i&&i.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ht(r.parentNode,[Fl()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ht(r,[Fl()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtSettings:i}=this,{wtOverlays:r,wtViewport:n}=this.dataAccessObject,o=i.getSetting("totalRows"),s=i.getSetting("totalColumns"),a=i.getSetting("rowHeaders"),c=a.length,d=i.getSetting("columnHeaders"),u=d.length,h=e;if(this.isMaster&&(this.holderOffset=Nn(this.holder),h=n.createRenderCalculators(h),c&&!i.getSetting("fixedColumnsStart"))){let f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(this.isMaster&&r.beforeDraw(),h)this.isMaster&&(n.createVisibleCalculators(),n.createPartiallyVisibleCalculators()),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=Nn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let f=o>0?this.getFirstRenderedRow():0,m=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new x_e(f,o,u),this.columnFilter=new C_e(m,s,c);let g=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let y={};this.wtSettings.getSetting("beforeDraw",!0,y),g=y.skipRender!==!0}if(g){this.tableRenderer.setHeaderContentRenderers(a,d),(this.is(od)||this.is(th))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let y;if(this.isMaster&&(y=this.dataAccessObject.workspaceWidth,n.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(od))&&this.markOversizedRows(),this.isMaster){n.createVisibleCalculators(),n.createPartiallyVisibleCalculators(),r.refresh(!1),r.applyToDOM();let w=Ji(this.hider),x=Ji(this.TABLE);w!==0&&x!==w&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==n.getWorkspaceWidth()&&(n.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(od)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let p=!1;return this.isMaster&&(p=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(p=r.bottomOverlay.resetFixedPosition()||p),p=r.inlineStartOverlay.resetFixedPosition()||p,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),p?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){let i=this.columnFilter.renderedToSource(e),r=this.wtSettings.getSetting("columnHeaders").length,n=this.wtSettings.getSetting("defaultRowHeight"),o,s,a,c=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(i,r),s&&(a=um(s),(!o&&n<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(c)?c[r]!==null&&c[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=c[r]):isNaN(c)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=c),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(c[r]||c)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=c[r]||c))}adjustColumnHeaderHeights(){let{wtSettings:e}=this,i=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,n=e.getSetting("columnHeaders");for(let o=0,s=n.length;o<s;o++)if(r[o]){if(!i[o]||i[o].childNodes.length===0)return;i[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){let{wtSettings:e}=this,{wtViewport:i}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(od))&&!e.getSetting("externalRowCalculator")){let r=this.getRenderedRowsCount();for(let n=0;n<r;n++){let o=this.rowFilter.renderedToSource(n);i.oversizedRows&&i.oversizedRows[o]&&(i.oversizedRows[o]=void 0)}}}getCell(e){let i=e.row,r=e.col,n=this.wtSettings.getSetting("onModifyGetCellCoords",i,r);if(n&&Array.isArray(n)&&([i,r]=n),this.isRowBeforeRenderedRows(i))return-1;if(this.isRowAfterRenderedRows(i))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;let o=this.getRow(i);if(!o&&i>=0)throw new Error("TR was expected to be rendered but is not");let s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let i=null,r=null;if(e<0){var n;i=(n=this.rowFilter)===null||n===void 0?void 0:n.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;i=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return i!==void 0&&r!==void 0?r.childNodes.length<i+1?!1:r.childNodes[i]:!1}getColumnHeader(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=this.THEAD.childNodes[i];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){let i=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(n=>{let o=n.childNodes[r];o&&i.push(o)}),i}getRowHeader(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=this.wtSettings.getSetting("rowHeaders").length;if(i>=r)return;let n=this.rowFilter.sourceToRendered(e),o=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):n,a=(n<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[i]}getRowHeaders(e){let i=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<r;n++){let o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[n];s&&i.push(s)}return i}getCoords(e){let i=e;if(i.nodeName!=="TD"&&i.nodeName!=="TH"&&(i=Ku(i,["TD","TH"])),i===null)return null;let r=i.parentNode,n=r.parentNode,o=p0e(r),s=i.cellIndex;return Lv(kf,i,this.wtRootElement)||Lv(ih,i,this.wtRootElement)?n.nodeName==="THEAD"&&(o-=n.childNodes.length):Lv(th,i,this.wtRootElement)||Lv(od,i,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-n.childNodes.length+o:n===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),Lv(kf,i,this.wtRootElement)||Lv(rh,i,this.wtRootElement)||Lv(th,i,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length,i=e*this.wtSettings.getSetting("defaultRowHeight"),r=um(this.TBODY)-1,n,o,s,a,c;if(!(i===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),n=this.getRowHeight(s),a=this.getTrForRow(s),c=a.querySelector("th"),c?o=um(c):o=um(a)-1,(!n&&this.wtSettings.getSetting("defaultRowHeight")<o||n<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;let r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;let r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){let i=this.getFirstRenderedRow();return e<0&&i<=0?!this.isRowHeaderRendered(e):e<i}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){let i=this.getFirstRenderedColumn();return e<0&&i<=0?!this.isColumnHeaderRendered(e):e<i}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Ji(this.TABLE)}getHeight(){return ur(this.TABLE)}getTotalWidth(){let e=Ji(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){let e=ur(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Xd(this.TABLE)}_modifyRowHeaderWidth(e){let i=nr(e)?e():null;return Array.isArray(i)?(i=[...i],i[i.length-1]=this._correctRowHeaderWidth(i[i.length-1])):i=this._correctRowHeaderWidth(i),i}_correctRowHeaderWidth(e){let i=e;return typeof e!="number"&&(i=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(i+=1),i}},nu=f9;var pct="stickyRowsBottom",D_e={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),i=t-e;return t===0||e===0?-1:i<0?0:i},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ra(D_e,"MIXIN_NAME",pct,{writable:!1,enumerable:!1});var lH=D_e;var mct="stickyColumnsStart",M_e={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ra(M_e,"MIXIN_NAME",mct,{writable:!1,enumerable:!1});var C1=M_e;var PI=class extends nu{constructor(e,i,r,n){super(e,i,r,n,th)}};Mi(PI,lH);Mi(PI,C1);var k_e=PI;var ffi=U($e(),1);var ih="top",od="bottom",rh="inline_start",kf="top_inline_start_corner",th="bottom_inline_start_corner",O_e=[ih,od,rh,kf,th],N_e=new Map([[ih,`ht_clone_${ih}`],[od,`ht_clone_${od}`],[rh,`ht_clone_${rh} ht_clone_left`],[kf,`ht_clone_${kf} ht_clone_top_left_corner`],[th,`ht_clone_${th} ht_clone_bottom_left_corner`]]);var cfi=U($e(),1);var efi=U($e(),1),tfi=U(dt(),1);var Zhi=U($e(),1);function gct(t,e){vct(t,e),e.add(t)}function vct(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bct(t,e,i){return e=_ct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _ct(t){var e=yct(t,"string");return typeof e=="symbol"?e:e+""}function yct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cH(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var LI=new WeakSet,p9=class{constructor(e){gct(this,LI),bct(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,i,r,n,o){let s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,i,n);return s||a}scrollViewportHorizontally(e,i,r){let{drawn:n,totalColumns:o}=this.dataAccessObject;if(!n||!Number.isInteger(e)||e<0||e>o)return!1;let s=i===void 0&&r===void 0,{fixedColumnsStart:a,inlineStartOverlay:c}=this.dataAccessObject;if(s&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>o))return!1;let d=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),h=!1;return(s&&(e<d||e>u)||!s)&&(h=c.scrollTo(e,s?e>=this.getLastPartiallyVisibleColumn():i)),h}scrollViewportVertically(e,i,r){let{drawn:n,totalRows:o}=this.dataAccessObject;if(!n||!Number.isInteger(e)||e<0||e>o)return!1;let s=i===void 0&&r===void 0,{fixedRowsBottom:a,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(s&&(e<c||e>o-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>o))return!1;let u=this.getFirstVisibleRow(),h=this.getLastVisibleRow(),p=!1;return(s&&(e<u||e>h)||!s)&&(p=d.scrollTo(e,s?e>=this.getLastPartiallyVisibleRow():r)),p}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return cH(LI,this,L_e).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return cH(LI,this,L_e).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return cH(LI,this,P_e).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return cH(LI,this,P_e).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function P_e(t){let{wtSettings:e,inlineStartOverlay:i,wtTable:r,wtViewport:n,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(i.mainTableScrollableElement===s){let a=e.getSetting("rtlMode"),c=null;if(a){let u=r.TABLE.getBoundingClientRect(),p=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;c=Math.abs(u.right-p)}else c=Nn(r.wtRootElement).left;let d=Math.abs(m5(s,s));if(c>d){let u=g5(s),h=n.getRowHeaderWidth();for(let p=1;p<=o;p++)if(h+=i.sumCellSizes(p-1,p),c+h-d>=u){t=p-2;break}}}return t}function L_e(t){let{topOverlay:e,wtTable:i,wtViewport:r,totalRows:n,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){let s=Nn(i.wtRootElement),a=i1(o,o);if(s.top>a){let c=um(o),d=r.getColumnHeaderHeight();for(let u=1;u<=n;u++)if(d+=e.sumCellSizes(u-1,u),s.top+d-a>=c){t=u-2;break}}}return t}var F_e=p9;function nh(t,e,i){return e=wct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function wct(t){var e=Cct(t,"string");return typeof e=="symbol"?e:e+""}function Cct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Kv=class{get eventManager(){return new cs(this)}constructor(e,i){nh(this,"wtTable",void 0),nh(this,"wtScroll",void 0),nh(this,"wtViewport",void 0),nh(this,"wtOverlays",void 0),nh(this,"selectionManager",void 0),nh(this,"wtEvent",void 0),nh(this,"guid",`wt_${a5()}`),nh(this,"drawInterrupted",!1),nh(this,"drawn",!1),nh(this,"domBindings",void 0),nh(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=i,this.wtScroll=new F_e(this.createScrollDao())}findOriginalHeaders(){let e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let i=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;i<r;i++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,r){Qd(r,e[i])}])}}createCellCoords(e,i){return new Gv(e,i,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,i,r){return new Y_(e,i,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);let r=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,i,r,n,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,i,r,n,o)}scrollViewportHorizontally(e,i,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,i,r)}scrollViewportVertically(e,i,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,i,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(i){e.drawn=i},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}};function H_e(t,e,i){return e=xct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function xct(t){var e=Sct(t,"string");return typeof e=="symbol"?e:e+""}function Sct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dH=class extends Kv{constructor(e,i,r){super(e,i),H_e(this,"cloneSource",void 0),H_e(this,"cloneOverlay",void 0);let n=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new U5(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}};function Ect(t,e,i){return e=Tct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Tct(t){var e=Rct(t,"string");return typeof e=="symbol"?e:e+""}function Rct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ou=class{constructor(e,i,r,n,o){Ect(this,"wtSettings",null),ra(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=i,this.wtSettings=n;let{TABLE:s,hider:a,spreader:c,holder:d,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=c,this.holder=d,this.wtRootElement=u,this.trimmingContainer=Qu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Qu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:e}=this.wot,{rootWindow:i}=this.domBindings;i.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=r1(e.TABLE)}getRelativeCellPosition(e,i,r){if(this.clone.wtTable.holder.contains(e)===!1){Zi(`The provided element is not a child of the ${this.type} overlay`);return}let n=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=i<this.wtSettings.getSetting("fixedRowsTop"),a=i>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),c=this.clone.wtTable.spreader,d={start:this.getRelativeStartPosition(c),top:c.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop},h=null;return n?h=this.getRelativeCellPositionWithinWindow(s,o,u,d):h=this.getRelativeCellPositionWithinHolder(s,a,o,u,d),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,i,r,n){let o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,a=0;if(!i)s=n.start;else{let c=o.left;this.isRtl()&&(c=this.domBindings.rootWindow.innerWidth-(o.left+o.width+mn())),s=c<=0?-1*c:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=n.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,i,r,n,o){let s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,c=0;if(r||(a=s.horizontal-o.start),i){let d=this.wot.wtTable.wtRootElement.getBoundingClientRect();c=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+d.top}else e||(c=s.vertical-o.top);return{start:n.start-a,top:n.top-c}}makeClone(){if(O_e.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);let{wtTable:e,wtSettings:i}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${N_e.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,i.getSetting("ariaTags")&&Ht(o,[Fl()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);let d=this.wtSettings.getSetting("preventOverflow");return d===!0||d==="horizontal"&&this.type===ih||d==="vertical"&&this.type===rh?this.mainTableScrollableElement=n:n.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=r1(e.TABLE),new dH(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){let e=this.clone.wtTable.holder,i=this.clone.wtTable.hider,r=e.style,n=i.style,o=e.parentNode.style;[r,n,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}};var FI=class extends ou{constructor(e,i,r,n,o,s){super(e,i,th,r,n),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return new k_e(...i)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;let i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]=`${o}px`,i.style.bottom=`${s}px`}else Bv(i),this.repositionOverlay();let r=ur(this.clone.wtTable.TABLE),n=Ji(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),i.style.height=`${r}px`,i.style.width=`${n}px`,!1}repositionOverlay(){let{wtTable:e,wtViewport:i}=this.wot,{rootDocument:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;i.hasVerticalScroll()||(o+=i.getWorkspaceHeight()-e.getTotalHeight()),i.hasVerticalScroll()&&i.hasHorizontalScroll()&&(o+=mn(r)),n.style.bottom=`${o}px`}};var Nfi=U($e(),1);var Act="calculatedColumns",B_e={getFirstRenderedColumn(){let t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){let t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){let t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){let t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){let t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){let t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ra(B_e,"MIXIN_NAME",Act,{writable:!1,enumerable:!1});var x1=B_e;var HI=class extends nu{constructor(e,i,r,n){super(e,i,r,n,od)}};Mi(HI,lH);Mi(HI,x1);var V_e=HI;function Ict(t,e,i){return e=Dct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Dct(t){var e=Mct(t,"string");return typeof e=="symbol"?e:e+""}function Mct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var BI=class extends ou{constructor(e,i,r,n){super(e,i,od,r,n),Ict(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return new V_e(...i)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,i=this.clone.wtTable.holder.parentNode;i.style.top="";let r=0,n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!n||n!=="vertical")?(r=this.getOverlayOffset(),i.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());let o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){let{wtTable:e,wtViewport:i}=this.wot,{rootDocument:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;i.hasVerticalScroll()||(o+=i.getWorkspaceHeight()-e.getTotalHeight()),i.hasVerticalScroll()&&i.hasHorizontalScroll()&&(o+=mn(r)),n.style.bottom=`${o}px`}setScrollPosition(e){let{rootWindow:i}=this.domBindings,r=!1;return this.mainTableScrollableElement===i?(i.scrollTo(mI(i),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,i){let{wtTable:r,wtSettings:n}=this.wot,o=n.getSetting("defaultRowHeight"),s=e,a=0;for(;s<i;){let c=r.getRowHeight(s);a+=c===void 0?o:c,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:i}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,o=mn(r),a=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||c==="horizontal"){let u=i.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=o),u=Math.min(u,e.wtRootElement.scrollWidth),a.width=`${u}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let d=ur(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),a.height=`${d}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:i}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:i.style[e]=""}scrollTo(e,i){let r=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0;i&&o.offsetHeight!==o.clientHeight&&(s=mn(this.domBindings.rootDocument)),i?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return i1(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===e&&(!i||i!=="vertical")){let n=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=n-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+n,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let i=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==i,n=this.wtSettings.getSetting("columnHeaders"),o=!1;if((r||i===0)&&n.length>0){let s=this.wot.wtTable.holder.parentNode,a=Bt(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Qe(s,"innerBorderBottom"),o=!a):(Gt(s,"innerBorderBottom"),o=a)}return o}};var Bpi=U($e(),1);var kct="calculatedRows",j_e={getFirstRenderedRow(){let t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){let t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){let t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){let t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){let t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){let t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ra(j_e,"MIXIN_NAME",kct,{writable:!1,enumerable:!1});var uH=j_e;var VI=class extends nu{constructor(e,i,r,n){super(e,i,r,n,rh)}};Mi(VI,uH);Mi(VI,C1);var z_e=VI;var Gfi=U(dt(),1);var Oct="localHooks",W_e={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,i,r,n,o,s){if(this._localHooks[t]){let a=this._localHooks[t].length;for(let c=0;c<a;c++)vI(this._localHooks[t][c],this,e,i,r,n,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ra(W_e,"MIXIN_NAME",Oct,{writable:!1,enumerable:!1});var En=W_e;var hH=class{constructor(e,i){this.settings=e,this.cellRange=i||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,i){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=i,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=i,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let e=this.cellRange.getOuterTopStartCorner(),i=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,i.row,i.col]}destroy(){this.runLocalHooks("destroy")}};Mi(hH,En);var fH=hH;var S1="active-header",Zv="header",Qv="area",Z_="focus",pH="fill",mH="row",gH="column",vH="custom-selection";var E1=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var wpi=U($e(),1),Cpi=U(dt(),1),xpi=U(m9(),1),Spi=U(ln(),1),Epi=U(cn(),1),Tpi=U(dn(),1),Rpi=U(un(),1),Api=U(hn(),1),Ipi=U(fn(),1),Dpi=U(pn(),1);var opi=U($e(),1),spi=U(ln(),1),api=U(cn(),1),lpi=U(dn(),1),cpi=U(un(),1),dpi=U(hn(),1),upi=U(fn(),1),hpi=U(pn(),1);function Pct(t,e){Y_e(t,e),e.add(t)}function U_e(t,e,i){Y_e(t,e),e.set(t,i)}function Y_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e){return t.get(jI(t,e))}function q_e(t,e,i){return t.set(jI(t,e),i),i}function jI(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var oh=new WeakMap,Cc=new WeakMap,bH=new WeakSet,_H=class{constructor(){Pct(this,bH),U_e(this,oh,void 0),U_e(this,Cc,void 0)}setActiveOverlay(e){return q_e(Cc,this,e),this}setActiveSelection(e){return q_e(oh,this,e),this}scan(){let e=us(oh,this).settings.selectionType,i=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>i.add(r)),this.scanRowsInHeadersRange(r=>i.add(r))):e==="area"?this.scanCellsRange(r=>i.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>i.add(r)),this.scanRowsInHeadersRange(r=>i.add(r)),this.scanCellsRange(r=>i.add(r))):e==="fill"?this.scanCellsRange(r=>i.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>i.add(r)),this.scanRowsInHeadersRange(r=>i.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>i.add(r)),this.scanRowsInCellsRange(r=>i.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>i.add(r)),this.scanColumnsInCellsRange(r=>i.add(r))),i}scanColumnsInHeadersRange(e){let[i,r,n,o]=us(oh,this).getCorners(),{wtTable:s}=us(Cc,this),a=s.getRenderedColumnsCount(),c=s.getColumnHeadersCount(),d=0;for(let u=-s.getRowHeadersCount();u<a;u++){let h=s.columnFilter.renderedToSource(u);if(!(h<r||h>o)){for(let p=-c;p<0;p++){if(p<i||p>n)continue;let f=p+c,m=s.getColumnHeader(h,f),g=us(Cc,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:us(oh,this).settings.selectionType,columnCursor:d,selectionWidth:o-r+1});g!==null&&(g!==h&&(m=s.getColumnHeader(g,f)),e(m))}d+=1}}}scanRowsInHeadersRange(e){let[i,r,n,o]=us(oh,this).getCorners(),{wtTable:s}=us(Cc,this),a=s.getRenderedRowsCount(),c=s.getRowHeadersCount(),d=0;for(let u=-s.getColumnHeadersCount();u<a;u++){let h=s.rowFilter.renderedToSource(u);if(!(h<i||h>n)){for(let p=-c;p<0;p++){if(p<r||p>o)continue;let f=p+c,m=s.getRowHeader(h,f),g=us(Cc,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:us(oh,this).settings.selectionType,rowCursor:d,selectionHeight:n-i+1});g!==null&&(g!==h&&(m=s.getRowHeader(g,f)),e(m))}d+=1}}}scanCellsRange(e){let[i,r,n,o]=us(oh,this).getCorners(),{wtTable:s}=us(Cc,this);jI(bH,this,g9).call(this,(a,c)=>{if(a>=i&&a<=n&&c>=r&&c<=o){let d=s.getCell(us(Cc,this).createCellCoords(a,c)),u=us(Cc,this).getSetting("onAfterDrawSelection",a,c,us(oh,this).settings.layerLevel);typeof u=="string"&&Qe(d,u),e(d)}})}scanRowsInCellsRange(e){let[i,,r]=us(oh,this).getCorners(),{wtTable:n}=us(Cc,this);jI(bH,this,g9).call(this,(o,s)=>{if(o>=i&&o<=r){let a=n.getCell(us(Cc,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){let[,i,,r]=us(oh,this).getCorners(),{wtTable:n}=us(Cc,this);jI(bH,this,g9).call(this,(o,s)=>{if(s>=i&&s<=r){let a=n.getCell(us(Cc,this).createCellCoords(o,s));e(a)}})}};function g9(t){let{wtTable:e}=us(Cc,this),i=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let n=0;n<i;n+=1){let o=e.rowFilter.renderedToSource(n);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}var v9=class{constructor(e,i){i&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=i,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=E1,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(i),this.registerListeners())}registerListeners(){let e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let i=0,r=this.main.childNodes.length;i<r;i++){let n=this.main.childNodes[i];this.eventManager.addEventListener(n,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[i]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,i){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Uo(e);let r=this,n=this.wot.rootDocument.body,o=i.getBoundingClientRect();i.style.display="none";function s(c){if(c.clientY<Math.floor(o.top)||c.clientY>Math.ceil(o.top+o.height)||c.clientX<Math.floor(o.left)||c.clientX>Math.ceil(o.left+o.width))return!0}function a(c){s(c)&&(r.eventManager.removeEventListener(n,"mousemove",a),i.style.display="block")}this.eventManager.addEventListener(n,"mousemove",a)}createBorders(e){let{rootDocument:i}=this.wot;this.main=i.createElement("div");let r=["top","start","bottom","end","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let a=0;a<5;a++){let c=r[a],d=i.createElement("div");d.className=`wtBorder ${this.settings.className||""}`,this.settings[c]&&this.settings[c].hide&&(d.className+=" hidden"),n=d.style,n.backgroundColor=this.settings[c]&&this.settings[c].color?this.settings[c].color:e.border.color,n.height=this.settings[c]&&this.settings[c].width?`${this.settings[c].width}px`:`${e.border.width}px`,n.width=this.settings[c]&&this.settings[c].width?`${this.settings[c].width}px`:`${e.border.width}px`,this.main.appendChild(d)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),rd()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:o}=this.wot,s=o.bordersHolder;s||(s=i.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};let i=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let n={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Kt(n,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});let o={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Kt(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,i){let r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||i!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,i,r,n,o,s){let c=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:d,topHitArea:u,bottom:h,bottomHitArea:p}=this.selectionHandles.styles,f=parseInt(d.borderWidth,10),m=parseInt(d.width,10),g=parseInt(u.width,10),y=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();d.top=`${parseInt(r-m-1,10)}px`,d[c]=`${parseInt(n-m-1,10)}px`,u.top=`${parseInt(r-g/4*3,10)}px`,u[c]=`${parseInt(n-g/4*3,10)}px`;let x=Math.min(parseInt(n+o,10),y-m-f*2),T=Math.min(parseInt(n+o-g/4,10),y-g-f*2);h[c]=`${x}px`,p[c]=`${T}px`;let M=Math.min(parseInt(r+s,10),w-m-f*2),B=Math.min(parseInt(r+s-g/4,10),w-g-f*2);h.top=`${M}px`,p.top=`${B}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(d.display="block",u.display="block",this.isPartRange(e,i)?(h.display="none",p.display="none"):(h.display="block",p.display="block")):(d.display="none",h.display="none",u.display="none",p.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||i===this.wot.wtSettings.getSetting("fixedColumnsStart")?(d.zIndex="9999",u.zIndex="9999"):(d.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;let{wtTable:i,rootDocument:r,rootWindow:n}=this.wot,o,s,a,c,d,u,h=i.getRenderedRowsCount();for(let te=0;te<h;te+=1){let se=i.rowFilter.renderedToSource(te);if(se>=e[0]&&se<=e[2]){o=se,d=e[0];break}}for(let te=h-1;te>=0;te-=1){let se=i.rowFilter.renderedToSource(te);if(se>=e[0]&&se<=e[2]){s=se;break}}let p=i.getRenderedColumnsCount();for(let te=0;te<p;te+=1){let se=i.columnFilter.renderedToSource(te);if(se>=e[1]&&se<=e[3]){a=se,u=e[1];break}}for(let te=p-1;te>=0;te-=1){let se=i.columnFilter.renderedToSource(te);if(se>=e[1]&&se<=e[3]){c=se;break}}if(o===void 0||a===void 0){this.disappear();return}let f=i.getCell(this.wot.createCellCoords(o,a)),m=o!==s||a!==c,g=m?i.getCell(this.wot.createCellCoords(s,c)):f,y=Nn(f),w=m?Nn(g):y,x=Nn(i.TABLE),T=Ji(i.TABLE),M=y.top,B=y.left,G=this.wot.wtSettings.getSetting("rtlMode"),F=0,O=0;if(G){let te=Ji(f),se=n.innerWidth-x.left-T;O=B+te-w.left,F=n.innerWidth-B-te-se-1}else O=w.left+Ji(g)-B,F=B-x.left-1;if(this.isEntireColumnSelected(o,s)){let te=this.getDimensionsFromHeader("columns",a,c,d,x),se=null;te&&([se,F,O]=te),se&&(f=se)}let V=M-x.top-1,J=w.top+ur(g)-M;if(this.isEntireRowSelected(a,c)){let te=this.getDimensionsFromHeader("rows",o,s,u,x),se=null;te&&([se,V,J]=te),se&&(f=se)}let N=Jd(f,n);parseInt(N.borderTopWidth,10)>0&&(V+=1,J=J>0?J-1:0),parseInt(N[G?"borderRightWidth":"borderLeftWidth"],10)>0&&(F+=1,O=O>0?O-1:0);let P=G?"right":"left";this.topStyle.top=`${V}px`,this.topStyle[P]=`${F}px`,this.topStyle.width=`${O}px`,this.topStyle.display="block",this.startStyle.top=`${V}px`,this.startStyle[P]=`${F}px`,this.startStyle.height=`${J}px`,this.startStyle.display="block";let $=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${V+J-$}px`,this.bottomStyle[P]=`${F}px`,this.bottomStyle.width=`${O}px`,this.bottomStyle.display="block",this.endStyle.top=`${V}px`,this.endStyle[P]=`${F+O-$}px`,this.endStyle.height=`${J+1}px`,this.endStyle.display="block";let K=this.settings.border.cornerVisible;K=typeof K=="function"?K(this.settings.layerLevel):K;let ve=this.wot.getSetting("onModifyGetCellCoords",s,c),[W,ee]=[s,c];if(ve&&Array.isArray(ve)&&([,,W,ee]=ve),rd()||!K||this.isPartRange(W,ee))this.cornerStyle.display="none";else{this.cornerStyle.top=`${V+J+this.cornerCenterPointOffset-1}px`,this.cornerStyle[P]=`${F+O+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let te=Qu(i.TABLE),se=te===n;se&&(te=r.documentElement);let Ae=parseInt(this.cornerDefaultStyle.width,10)/2,k=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){let S=se?g.getBoundingClientRect().left:g.offsetLeft,I=!1,X=0;G?(X=S-parseInt(this.cornerDefaultStyle.width,10)/2,I=X<0):(X=S+Ji(g)+parseInt(this.cornerDefaultStyle.width,10)/2,I=X>=g5(te)),I&&(this.cornerStyle[P]=`${Math.floor(F+O+this.cornerCenterPointOffset-Ae)}px`,this.cornerStyle[G?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(se?g.getBoundingClientRect().top:g.offsetTop)+ur(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=um(te)&&(this.cornerStyle.top=`${Math.floor(V+J+this.cornerCenterPointOffset-k)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}rd()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,c,V,F,O,J)}isEntireColumnSelected(e,i){return e===this.wot.wtTable.getFirstRenderedRow()&&i===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,i){return e===this.wot.wtTable.getFirstRenderedColumn()&&i===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,i,r,n,o){let{wtTable:s}=this.wot,a=s.wtRootElement.parentNode,c=null,d=null,u=null,h=null,p=null,f=null,m=null,g=null;switch(e){case"rows":c=function(){return s.getRowHeader(...arguments)},d=function(){return ur(...arguments)},u="ht__selection--rows",f="top";break;case"columns":c=function(){return s.getColumnHeader(...arguments)},d=function(){return Ji(...arguments)},u="ht__selection--columns",f="left";break;default:}if(a.classList.contains(u)){let y=this.wot.getSetting("columnHeaders").length;if(m=c(i,y-n),g=c(r,y-n),!m||!g)return!1;let w=Nn(m),x=Nn(g);return m&&g&&(h=w[f]-o[f]-1,p=x[f]+d(g)-w[f]),[m,h,p]}return!1}changeBorderStyle(e,i){let r=this[e].style,n=i[e];!n||n.hide?Qe(this[e],"hidden"):(Bt(this[e],"hidden")&&Gt(this[e],"hidden"),r.backgroundColor=n.color,(e==="top"||e==="bottom")&&(r.height=`${n.width}px`),(e==="start"||e==="end")&&(r.width=`${n.width}px`))}changeBorderToDefaultStyle(e){let i={width:1,color:"#000"},r=this[e].style;r.backgroundColor=i.color,r.width=`${i.width}px`,r.height=`${i.width}px`}toggleHiddenClass(e,i){this.changeBorderToDefaultStyle(e),i?Qe(this[e],"hidden"):Gt(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",rd()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}},b9=v9;function Lct(t,e){X_e(t,e),e.add(t)}function T1(t,e,i){X_e(t,e),e.set(t,i)}function X_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function or(t,e){return t.get(w9(t,e))}function $_e(t,e,i){return t.set(w9(t,e),i),i}function w9(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var cl=new WeakMap,xc=new WeakMap,_9=new WeakMap,zI=new WeakMap,y9=new WeakMap,Q_=new WeakMap,G_e=new WeakSet,yH=class{constructor(e){Lct(this,G_e),T1(this,cl,void 0),T1(this,xc,void 0),T1(this,_9,new _H),T1(this,zI,new WeakMap),T1(this,y9,new WeakSet),T1(this,Q_,new Map),$_e(xc,this,e)}setActiveOverlay(e){return $_e(cl,this,e),or(_9,this).setActiveOverlay(or(cl,this)),or(zI,this).has(or(cl,this))||or(zI,this).set(or(cl,this),new Set),this}getFocusSelection(){return or(xc,this)!==null?or(xc,this).getFocus():null}getAreaSelection(){return or(xc,this)!==null?or(xc,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(or(Q_,this).has(e)){let r=or(Q_,this).get(e);if(r.has(or(cl,this)))return r.get(or(cl,this));let n=new b9(or(cl,this),e.settings);return r.set(or(cl,this),n),n}let i=new b9(or(cl,this),e.settings);return or(Q_,this).set(e,new Map([[or(cl,this),i]])),i}getBorderInstances(e){var i,r;return Array.from((i=(r=or(Q_,this).get(e))===null||r===void 0?void 0:r.values())!==null&&i!==void 0?i:[])}destroyBorders(e){or(Q_,this).get(e).forEach(i=>i.destroy()),or(Q_,this).delete(e)}render(e){if(or(xc,this)===null)return;e&&w9(G_e,this,Fct).call(this);let i=Array.from(or(xc,this)),r=new Map,n=new Map;for(let o=0;o<i.length;o++){let s=i[o],{className:a,headerAttributes:c,createLayers:d,selectionType:u}=s.settings;or(y9,this).has(s)||(or(y9,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));let h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&or(_9,this).setActiveSelection(s).scan().forEach(m=>{if(r.has(m)){let g=r.get(m);g.has(a)&&d===!0?g.set(a,g.get(a)+1):g.set(a,1)}else r.set(m,new Map([[a,1]]));c&&(n.has(m)||n.set(m,[]),m.nodeName==="TH"&&n.get(m).push(...c))});let p=s.getCorners();or(cl,this).getSetting("onBeforeDrawBorders",p,u),h?.appear(p)}r.forEach((o,s)=>{var a;let c=Array.from(o).map(d=>{let[u,h]=d;return h===1?u:[u,...Array.from({length:h-1},(p,f)=>`${u}-${f+1}`)]}).flat();c.forEach(d=>or(zI,this).get(or(cl,this)).add(d)),Qe(s,c),s.nodeName==="TD"&&Array.isArray((a=or(xc,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ht(s,or(xc,this).options.cellAttributes)}),Array.from(n.keys()).forEach(o=>{Ht(o,[...n.get(o)])})}};function Fct(){let t=or(zI,this).get(or(cl,this)),e=or(cl,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let i=0;i<e.length;i++)t.add(e[i]);t.forEach(i=>{var r,n;let o=or(cl,this).wtTable.TABLE.querySelectorAll(`.${i}`),s=[];Array.isArray((r=or(xc,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=or(xc,this).options.cellAttributes.map(a=>a[0])),Array.isArray((n=or(xc,this).options)===null||n===void 0?void 0:n.headerAttributes)&&(s=[...s,...or(xc,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,c=o.length;a<c;a++)Gt(o[a],i),Kd(o[a],s)}),t.clear()}var WI=class extends ou{constructor(e,i,r,n){super(e,i,rh,r,n)}createTable(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return new z_e(...i)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;let{rootWindow:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer===i&&(!n||n!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),n1(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Bv(r));let s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){let{rootWindow:i}=this.domBindings,r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===i&&i.scrollX!==e?(i.scrollTo(e,E7(i)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,i){let r=this.wtSettings.getSetting("defaultColumnWidth"),n=e,o=0;for(;n<i;)o+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,n=mn(i),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let d=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(d-=n),d=Math.min(d,e.wtRootElement.scrollHeight),s.height=`${d}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;let c=Ji(this.clone.wtTable.TABLE);s.width=`${c}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,i=this.wot.selectionManager.getFocusSelection()?parseInt(E1.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,i){let{wtSettings:r}=this,n=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,c=o===0&&n.length>0&&!Bt(a.parentNode,"innerBorderInlineStart")?1:0,d=this.getTableParentOffset(),u=0;if(i){let h=this.wot.wtTable.getColumnWidth(e),p=this.wot.wtViewport.getViewportWidth();h>p&&(i=!1)}return i&&a.offsetWidth!==a.clientWidth&&(u=mn(this.domBindings.rootDocument)),i?(d+=this.sumCellSizes(0,e+1),d-=this.wot.wtViewport.getViewportWidth(),d+=c):d+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),d+=u,b0e(this.mainTableScrollableElement)===d-c&&c>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(c),this.setScrollPosition(d)}getTableParentOffset(){let e=this.wtSettings.getSetting("preventOverflow"),i=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}getScrollPosition(){return Math.abs(m5(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:e}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===e&&(!i||i!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let n=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=n-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,n=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),s=i.getSetting("totalRows"),a=i.getSetting("preventOverflow")==="vertical";s?Gt(r,"emptyRows"):Qe(r,"emptyRows");let c=!1;if(!a){if(o&&!n.length)Qe(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){let d=Bt(r,"innerBorderInlineStart");e?(Qe(r,"innerBorderLeft innerBorderInlineStart"),c=!d):(Gt(r,"innerBorderLeft innerBorderInlineStart"),c=d)}}return c}};var emi=U($e(),1);var Hct="stickyRowsTop",K_e={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ra(K_e,"MIXIN_NAME",Hct,{writable:!1,enumerable:!1});var wH=K_e;var UI=class extends nu{constructor(e,i,r,n){super(e,i,r,n,kf)}};Mi(UI,wH);Mi(UI,C1);var Z_e=UI;function Q_e(t,e,i){return e=Bct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Bct(t){var e=Vct(t,"string");return typeof e=="symbol"?e:e+""}function Vct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qI=class extends ou{constructor(e,i,r,n,o,s){super(e,i,kf,r,n),Q_e(this,"topOverlay",void 0),Q_e(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return new Z_e(...i)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let n=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();n1(e,`${n}px`,`${o}px`)}else Bv(e);let i=ur(this.clone.wtTable.TABLE),r=Ji(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),e.style.height=`${i}px`,e.style.width=`${r}px`,!1}};var hmi=U($e(),1);var YI=class extends nu{constructor(e,i,r,n){super(e,i,r,n,ih)}};Mi(YI,wH);Mi(YI,x1);var J_e=YI;function jct(t,e,i){return e=zct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function zct(t){var e=Wct(t,"string");return typeof e=="symbol"?e:e+""}function Wct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $I=class extends ou{constructor(e,i,r,n){super(e,i,ih,r,n),jct(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return new J_e(...i)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode,{rootWindow:i}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow"),n=0,o=!1;if(this.trimmingContainer===i&&(!r||r!=="vertical")){let{wtTable:a}=this.wot,c=a.hider.getBoundingClientRect(),d=Math.ceil(c.bottom),u=e.offsetHeight;o=d===u,n=this.getOverlayOffset(),n1(e,"0px",`${n}px`)}else n=this.getScrollPosition(),Bv(e);let s=this.adjustHeaderBordersPosition(n,o);return this.adjustElementsSize(),s}setScrollPosition(e){let i=this.domBindings.rootWindow,r=!1;return this.mainTableScrollableElement===i&&i.scrollY!==e?(i.scrollTo(mI(i),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,i){let r=this.wtSettings.getSetting("defaultRowHeight"),n=e,o=0;for(;n<i;){let s=this.wot.wtTable.getRowHeight(n);o+=s===void 0?r:s,n+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,n=mn(i),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let d=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=n),d=Math.min(d,e.wtRootElement.scrollWidth),s.width=`${d}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let c=ur(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),s.height=`${c}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,i=this.wot.selectionManager.getFocusSelection()?parseInt(E1.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:i}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:i.style[e]=""}scrollTo(e,i){let{wot:r,wtSettings:n}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=n.getSetting("columnHeaders"),d=n.getSetting("fixedRowsTop")===0&&a.length>0&&!Bt(s.parentNode,"innerBorderTop")?1:0,u=this.getTableParentOffset(),h=0;if(i){let p=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();p>f&&(i=!1)}if(i&&s.offsetHeight!==s.clientHeight&&(h=mn(this.domBindings.rootDocument)),i){let p=n.getSetting("fixedRowsBottom"),f=n.getSetting("totalRows");u+=this.sumCellSizes(0,e+1),u-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-p,f),u+=1,u+=d}else u+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);return u+=h,v0e(this.mainTableScrollableElement)===u-d&&d>0&&this.wot.wtOverlays.expandHiderVerticallyBy(d),this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return i1(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===e&&(!i||i!=="vertical")){let n=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=n-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?Gt(n,"emptyColumns"):Qe(n,"emptyColumns");let a=!1;if(!i&&!s){let c=r.getSetting("fixedRowsTop"),d=this.cachedFixedRowsTop!==c,u=r.getSetting("columnHeaders");if((d||c===0)&&u.length>0){let h=Bt(n,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(Qe(n,"innerBorderTop"),a=!h):(Gt(n,"innerBorderTop"),a=h)}}return a}};function eye(t,e,i){Uct(t,e),e.set(t,i)}function Uct(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pm(t,e,i){return e=qct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function qct(t){var e=Yct(t,"string");return typeof e=="symbol"?e:e+""}function Yct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function C9(t,e,i){return t.set(tye(t,e),i),i}function GI(t,e){return t.get(tye(t,e))}function tye(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var R1=new WeakMap,CH=new WeakMap,x9=class{constructor(e,i,r,n,o,s){pm(this,"wot",null),eye(this,R1,[]),pm(this,"topOverlay",null),pm(this,"bottomOverlay",null),pm(this,"inlineStartOverlay",null),pm(this,"topInlineStartCornerOverlay",null),pm(this,"bottomInlineStartCornerOverlay",null),pm(this,"browserLineHeight",void 0),pm(this,"wtSettings",null),eye(this,CH,!1),pm(this,"resizeObserver",new ResizeObserver(u=>{c1(()=>{!Array.isArray(u)||!u.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=n,this.domBindings=r,this.facadeGetter=i,this.wtTable=s;let{rootDocument:a,rootWindow:c}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=mn(a);let d=c.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=d?s.holder:r1(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=[...GI(R1,this)];return e&&i.push(this.wtTable),i}initBrowserLineHeight(){let{rootWindow:e,rootDocument:i}=this.domBindings,r=e.getComputedStyle(i.body),n=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=n||o}initOverlays(){let e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new $I(...e),this.bottomOverlay=new BI(...e),this.inlineStartOverlay=new WI(...e),this.topInlineStartCornerOverlay=new qI(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new FI(...e,this.bottomOverlay,this.inlineStartOverlay),C9(R1,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){C9(CH,this,GI(R1,this).reduce((e,i)=>i.hasRenderingStateChanged()||e,!1)),GI(R1,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),GI(R1,this).forEach(e=>{let i=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),i&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let{rootDocument:e,rootWindow:i}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==n&&this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0});let o=i.devicePixelRatio&&i.devicePixelRatio>1,s=this.scrollableElement===i,a=this.wtSettings.getSetting("preventWheel"),c={passive:s};(a||o||!E5())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),c),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){let{holder:p}=h.clone.wtTable;this.eventManager.addEventListener(p,"wheel",f=>this.onCloneWheel(f,a),c)}});let u;this.eventManager.addEventListener(i,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){let i=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(n!==i&&o!==i&&!e.target.contains(n)||r!==i&&o!==i&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,i){let{rootWindow:r}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),c=n!==r&&s!==r&&!s.contains(n);if(this.keyPressed&&(a||c))return;let d=this.translateMouseWheelToScroll(e);(i||this.scrollableElement!==r&&d)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Tf(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let i=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,i+=i*this.browserLineHeight);let n=this.scrollVertically(i),o=this.scrollHorizontally(r);return n||o}scrollVertically(e){let i=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,i!==this.scrollableElement.scrollTop}scrollHorizontally(e){let i=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,i!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:e}=this.domBindings,i=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[n,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=i.scrollLeft!==n||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){i.scrollLeft=n;let s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!GI(CH,this))return;let e=this.topOverlay.mainTableScrollableElement,{scrollLeft:i,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=i),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=i),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),C9(CH,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:e}=this,{rootWindow:i}=this.domBindings;i.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=r1(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){let e=this.wtTable.spreader,i=e.clientWidth,r=e.clientHeight,n=i!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=i,this.spreaderLastSize.height=r),n}adjustElementsSize(){let{wtViewport:e}=this.wot,{wtTable:i}=this,{rootWindow:r}=this.domBindings,n=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),d=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,u=a+this.inlineStartOverlay.sumCellSizes(0,o),p=i.hider.style,f=()=>n?!1:this.scrollableElement.scrollTop>Math.max(0,d-i.holder.clientHeight),m=()=>n?!1:this.scrollableElement.scrollLeft>Math.max(0,u-i.holder.clientWidth),g=f()?1:0,y=m()?1:0;if(p.width=`${u+y}px`,p.height=`${d+g}px`,this.scrollbarSize>0){let{scrollHeight:w,scrollWidth:x}=i.wtRootElement,{scrollHeight:T,scrollWidth:M}=i.holder;this.hasScrollbarRight=w<T,this.hasScrollbarBottom=x<M,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>x?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>w&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){let{wtTable:i}=this;i.hider.style.height=`${parseInt(i.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){let{wtTable:i}=this;i.hider.style.width=`${parseInt(i.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;let i=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],r=null;return Ce(i,n=>{n&&n.clone&&n.clone.wtTable.TABLE.contains(e)&&(r=n.clone)}),r}syncOverlayTableClassNames(){let e=this.wtTable.TABLE,i=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Ce(i,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}},iye=x9;var Pmi=U($e(),1);function rye(t,e,i){return e=$ct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function $ct(t){var e=Gct(t,"string");return typeof e=="symbol"?e:e+""}function Gct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xH=class{constructor(e){rye(this,"settings",{}),rye(this,"defaults",Object.freeze(this.getDefaults())),Kt(this.defaults,(i,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(i===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=i}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,i,r)=>{let n=this.getSetting("data",e,i);Qd(r,n??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,i){return i===void 0?Kt(e,(r,n)=>{this.settings[n]=r}):this.settings[e]=i,this}getSetting(e,i,r,n,o){return typeof this.settings[e]=="function"?this.settings[e](i,r,n,o):i!==void 0&&Array.isArray(this.settings[e])?this.settings[e][i]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};var XI=class extends nu{constructor(e,i,r,n){super(e,i,r,n,"master")}alignOverlaysWithTrimmingContainer(){let e=Qu(this.wtRootElement),{rootWindow:i}=this.domBindings;if(e===i)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{let r=e.parentElement,n=Fv(e,"height",i),o=Fv(e,"overflow",i),s=this.holder.style,{scrollWidth:a,scrollHeight:c}=e,d=e.offsetWidth,u=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){let p=e.cloneNode(!1);p.style.overflow="auto",p.style.position="absolute",e.nextElementSibling?r.insertBefore(p,e.nextElementSibling):r.appendChild(p);let f=parseInt(Jd(p,i).height,10);r.removeChild(p),f===0&&(u=0)}u=Math.min(u,c),s.height=n==="auto"?"auto":`${u}px`,d=Math.min(d,a),s.width=`${d}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:u>0,this.hasTableWidth=d>0}this.isTableVisible=Xd(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:e}=this,{wtViewport:i}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!i.hasOversizedColumnHeadersMarked[r]){let a=e.getSetting("rowHeaders").length,c=this.getRenderedColumnsCount();for(let d=0;d<o;d++)for(let u=-1*a;u<c;u++)this.markIfOversizedColumnHeader(u);i.hasOversizedColumnHeadersMarked[r]=!0}}};Mi(XI,uH);Mi(XI,x1);var nye=XI;var S9=class{constructor(e,i,r,n,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=i,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let e=this.domBindings.rootDocument,i=this.dataAccessObject.topOverlayTrimmingContainer,r=0;return i===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=ur(i)>0&&i.clientHeight>0?i.clientHeight:1/0,r}getWorkspaceWidth(){let{wtSettings:e}=this,{rootDocument:i,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=i.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),c=e.getSetting("rtlMode"),d=this.wtTable.TABLE.getBoundingClientRect(),u=c?d.right-o:d.left,h=o-u,p,f;if(a)return Ji(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?p=Math.min(h,o):p=Math.min(this.getContainerFillWidth(),h,o),n===r&&s>0&&this.sumColumnWidths(0,s-1)>p)return i.documentElement.clientWidth;if(n!==r&&(f=Fv(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(p,n.clientWidth);let m=e.getSetting("stretchH");return m==="none"||!m?Math.max(p,Ji(this.wtTable.TABLE)):p}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,i){let r=0,n=e;for(;n<i;)r+=this.wtTable.getColumnWidth(n),n+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let e=this.wtTable.holder,i=this.domBindings.rootDocument.createElement("div");i.style.width="100%",i.style.height="1px",e.appendChild(i);let r=i.offsetWidth;return this.containerWidth=r,e.removeChild(i),r}getWorkspaceOffset(){return Nn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ur(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;let i=this.getColumnHeaderHeight();return i>0&&(e-=i),e}getRowHeaderWidth(){let e=this.wtSettings.getSetting("rowHeaderWidth"),i=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,n=i.length;r<n;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(i.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,o=i.length;n<o;n++)r?(this.rowHeaderWidth+=Ji(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let e=this.getWorkspaceWidth();if(e===1/0)return e;let i=this.getRowHeaderWidth();return i>0?e-i:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{wtSettings:i,wtTable:r}=this;if(i.getSetting("renderAllRows")&&e===1)return new EI({totalRows:i.getSetting("totalRows")});let n=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,c=i.getSetting("fixedRowsTop"),d=i.getSetting("fixedRowsBottom"),u=i.getSetting("totalRows");return c&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,c),a+=s,n-=s),d&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(u-d,u),n-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=mn(this.domBindings.rootDocument),new $v({viewportHeight:n,scrollOffset:a,totalRows:i.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:i.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{wtSettings:i,wtTable:r}=this;if(i.getSetting("renderAllColumns")&&e===1)return new SI({totalColumns:i.getSetting("totalColumns")});let n=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let s=i.getSetting("fixedColumnsStart");if(s&&o>=0){let a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,n-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(n-=mn(this.domBindings.rootDocument)),new Af({viewportWidth:n,scrollOffset:o,totalColumns:i.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:i.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtSettings:i}=this;if(e&&!i.getSetting("renderAllRows")){let r=this.createRowsCalculator(2);e=this.areAllProposedVisibleRowsAlreadyRendered(r)}if(e&&!i.getSetting("renderAllColumns")){let r=this.createColumnsCalculator(2);e=this.areAllProposedVisibleColumnsAlreadyRendered(r)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}createPartiallyVisibleCalculators(){this.rowsPartiallyVisibleCalculator=this.createRowsCalculator(3),this.columnsPartiallyVisibleCalculator=this.createColumnsCalculator(3)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:i,endRow:r}=e;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;i=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}let{startRow:n,endRow:o}=this.rowsRenderCalculator;return i<n||i===n&&i>0?!1:!(r>o||r===o&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:i,endColumn:r}=e;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;i=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}let{startColumn:n,endColumn:o}=this.columnsRenderCalculator;return i<n||i===n&&i>0?!1:!(r>o||r===o&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Kt(this.hasOversizedColumnHeadersMarked,(e,i,r)=>{r[i]=void 0})}},sye=S9;var SH=class extends Kv{constructor(e,i){super(e,new xH(i));let r=this.wtSettings.getSetting("facade",this);this.wtTable=new nye(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new sye(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new yH(this.wtSettings.getSetting("selections")),this.wtEvent=new U5(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new iye(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},i=[],r=[];Kt(e,(n,o)=>{this.wtSettings.getSetting(o).length&&r.push(n),i.push(n)}),Gt(this.wtTable.wtRootElement.parentNode,i),Qe(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){let e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}};var KI=class t{constructor(e){e instanceof Kv?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=i=>{let r=new t(i);return()=>r},this._wot=new SH(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,i){return this._wot.createCellCoords(e,i)}createCellRange(e,i,r){return this._wot.createCellRange(e,i,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,i)}scrollViewport(e,i,r,n,o){return this._wot.scrollViewport(e,i,r,n,o)}scrollViewportHorizontally(e,i,r){return this._wot.scrollViewportHorizontally(e,i,r)}scrollViewportVertically(e,i,r){return this._wot.scrollViewportVertically(e,i,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,i){return this._wot.wtSettings.update(e,i),this}getSetting(e,i,r,n,o){return this._wot.wtSettings.getSetting(e,i,r,n,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}};function aye(t){let{isShiftKey:e,isLeftClick:i,isRightClick:r,coords:n,selection:o,controller:s,cellCoordsFactory:a}=t,c=o.isSelected()?o.getSelectedRange().current():null,d=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&c)n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(n):(d||u)&&n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(a(n.row,n.col)):d&&n.row<0&&!s.column?o.setRangeEnd(a(c.to.row,n.col)):u&&n.col<0&&!s.row?o.setRangeEnd(a(n.row,c.to.col)):(!d&&!u&&n.col<0||d&&n.col<0)&&!s.row?o.selectRows(Math.max(c.from.row,0),n.row,n.col):(!d&&!u&&n.row<0||u&&n.row<0)&&!s.column&&o.selectColumns(Math.max(c.from.col,0),n.col,n.row);else{let h=!o.inInSelection(n),p=i||r&&h;n.row<0&&n.col>=0&&!s.column?p&&o.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!s.row?p&&o.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!s.cell?p&&o.setRangeStart(n):n.col<0&&n.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Xct(t){let{isLeftClick:e,coords:i,selection:r,controller:n,cellCoordsFactory:o}=t;if(!e)return;let s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),c=r.tableProps.countCols(),d=r.tableProps.countRows();r.markSource("mouse"),a&&!n.column?r.setRangeEnd(o(d-1,i.col)):s&&!n.row?r.setRangeEnd(o(i.row,c-1)):n.cell||r.setRangeEnd(i),r.markEndSource()}var Kct=new Map([["mousedown",aye],["mouseover",Xct],["touchstart",aye]]);function E9(t,e){let{coords:i,selection:r,controller:n,cellCoordsFactory:o}=e;Kct.get(t.type)({coords:i,selection:r,controller:n,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:h1(t)||t.type==="touchstart",isRightClick:nd(t)})}var lye=new WeakMap,EH=Symbol("rootInstance");function cye(t){lye.set(t,!0)}function dye(t){return t===EH}function A1(t){return lye.has(t)}function Zct(t,e){uye(t,e),e.add(t)}function J_(t,e,i){uye(t,e),e.set(t,i)}function uye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jv(t,e,i){return e=Qct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Qct(t){var e=Jct(t,"string");return typeof e=="symbol"?e:e+""}function Jct(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aa(t,e){return t.get(ZI(t,e))}function su(t,e,i){return t.set(ZI(t,e),i),i}function ZI(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var T9=new WeakMap,TH=new WeakMap,RH=new WeakMap,mm=new WeakMap,sh=new WeakMap,R9=new WeakMap,A9=new WeakMap,AH=new WeakSet,I9=class{constructor(e){Zct(this,AH),Jv(this,"hot",void 0),Jv(this,"eventManager",void 0),Jv(this,"settings",void 0),Jv(this,"THEAD",void 0),Jv(this,"TBODY",void 0),Jv(this,"_wt",void 0),Jv(this,"activeWt",void 0),J_(this,T9,0),J_(this,TH,0),Jv(this,"postponedAdjustElementsSize",!1),J_(this,RH,!1),J_(this,mm,void 0),J_(this,sh,void 0),J_(this,R9,0),J_(this,A9,0),this.hot=e,this.eventManager=new cs(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,i){let r=this._wt.getCell(e,i);return r<0?null:r}scrollViewport(e,i,r,n,o){return this._wt.scrollViewport(e,i,r,n,o)}scrollViewportHorizontally(e,i,r){return this._wt.scrollViewportHorizontally(e,i,r)}scrollViewportVertically(e,i,r){return this._wt.scrollViewportVertically(e,i,r)}createElements(){let{rootElement:e,rootDocument:i}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Qe(e,"handsontable"),su(sh,this,i.createElement("TABLE")),Qe(aa(sh,this),"htCore"),this.hot.getSettings().tableClassName&&Qe(aa(sh,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ht(aa(sh,this),[Fl()]),Ht(e,[Wbe(),f5(-1),Jx(this.hot.countCols()),i0e()])),this.THEAD=i.createElement("THEAD"),aa(sh,this).appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),aa(sh,this).appendChild(this.TBODY),this.hot.table=aa(sh,this),this.hot.container.insertBefore(aa(sh,this),this.hot.container.firstChild)}registerEvents(){let{rootElement:e,rootDocument:i,selection:r,rootWindow:n}=this.hot,o=i.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{su(RH,this,!0),this.isTextSelectionAllowed(a.target)||(T7(n),a.preventDefault(),n.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{su(RH,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{aa(RH,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&T7(n),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&h1(a)&&r.finish(),su(mm,this,!1);let c=b5(i.activeElement);gI(i.activeElement)&&!c||(c||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!nd(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&nd(a)&&(r.finish(),su(mm,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),su(mm,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{let c=a.target,d=a.x||a.clientX,u=a.y||a.clientY,h=a.target;if(aa(mm,this)||!e||!this.hot.view)return;let{holder:p}=this.hot.view._wt.wtTable;if(h===p){let m=mn(i);if(i.elementFromPoint(d+m,u)!==p||i.elementFromPoint(d,u+m)!==p)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(c):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Ef(n);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Ef(s);this.eventManager.addEventListener(aa(sh,this),"selectstart",a=>{this.settings.fragmentSelection||gI(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:i,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(i,r))}translateFromRenderableToVisualIndex(e,i){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,n=i>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(i):i;return r===null&&(r=e),n===null&&(n=i),[r,n]}countRenderableIndexes(e,i){let r=Math.min(e.getNotTrimmedIndexesLength(),i),n=e.getNearestNotHiddenIndex(r-1,-1);return n===null?0:e.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,i){return this.countNotHiddenIndexes(e,i,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,i){return this.countNotHiddenIndexes(e,i,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,i,r,n){if(isNaN(e)||e<0)return 0;let o=r.getNearestNotHiddenIndex(e,i),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return i<0?a=s+1:i>0&&(a=n-s),a}countNotHiddenFixedColumnsStart(){let e=this.hot.countCols(),i=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(i,-1)}countNotHiddenFixedRowsTop(){let e=this.hot.countRows(),i=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(i,-1)}countNotHiddenFixedRowsBottom(){let e=this.hot.countRows(),i=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(i,1)}countRenderableColumnsInRange(e,i){let r=0;for(let n=e;n<=i;n++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(n)!==null&&(r+=1);return r}countRenderableRowsInRange(e,i){let r=0;for(let n=e;n<=i;n++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(n)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){let e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),i=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>i}initializeWalkontable(){let e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:aa(sh,this),isDataViewInstance:()=>A1(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{let c=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(c,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),su(TH,this,o.length),this.hot.getSettings().ariaTags&&ZI(AH,this,hye).call(this)===this.hot.countCols()&&ZI(AH,this,edt).call(this,aa(TH,this)),o},columnHeaders:()=>{let o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{let c=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(c,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),su(T9,this,o.length),o},columnWidth:o=>{let s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{let s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{let[c,d]=this.translateFromRenderableToVisualIndex(o,s),u=this.hot.runHooks("modifyGetCellCoords",c,d),h=c,p=d;Array.isArray(u)&&([h,p]=u);let f=this.hot.getCellMeta(h,p),m=this.hot.colToProp(p),g=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(g=this.hot.runHooks("beforeValueRender",g,f)),this.hot.runHooks("beforeRenderer",a,c,d,m,g,f),this.hot.getCellRenderer(f)(this.hot,a,c,d,m,g,f),this.hot.runHooks("afterRenderer",a,c,d,m,g,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Xd(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,c)=>{let d=this.translateFromRenderableToVisualCoords(s),u={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=c,su(mm,this,!0),this.hot.runHooks("beforeOnCellMouseDown",o,d,a,u),!Rf(o)&&(E9(o,{coords:d,selection:this.hot.selection,controller:u,cellCoordsFactory:(h,p)=>this.hot._createCellCoords(h,p)}),this.hot.runHooks("afterOnCellMouseDown",o,d,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,c)=>{let d=this.translateFromRenderableToVisualCoords(s);this.activeWt=c,su(mm,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,d,a),!Rf(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,d,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,c)=>{let d=this.translateFromRenderableToVisualCoords(s);this.activeWt=c,this.hot.runHooks("beforeOnCellMouseOut",o,d,a),!Rf(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,d,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,c)=>{let d=this.translateFromRenderableToVisualCoords(s),u={row:!1,column:!1,cell:!1};this.activeWt=c,this.hot.runHooks("beforeOnCellMouseOver",o,d,a,u),!Rf(o)&&(aa(mm,this)&&E9(o,{coords:d,selection:this.hot.selection,controller:u,cellCoordsFactory:(h,p)=>this.hot._createCellCoords(h,p)}),this.hot.runHooks("afterOnCellMouseOver",o,d,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,c)=>{let d=this.translateFromRenderableToVisualCoords(s);this.activeWt=c,this.hot.runHooks("beforeOnCellMouseUp",o,d,a),!(Rf(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,d,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{let s=this.hot.rowIndexMapper,a=o<0,c=o;return!a&&(c=s.getVisualFromRenderableIndex(o),c===null)?o:(c=this.hot.runHooks("beforeViewportScrollVertically",c),this.hot.runHooks("beforeViewportScroll"),a?c:s.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:o=>{let s=this.hot.columnIndexMapper,a=o<0,c=o;return!a&&(c=s.getVisualFromRenderableIndex(o),c===null)?o:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c),this.hot.runHooks("beforeViewportScroll"),a?c:s.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{let c=this.hot.rowIndexMapper,d=o<0,u=o;d||(u=c.getVisualFromRenderableIndex(o));let h=this.hot.runHooks("beforeHighlightingRowHeader",u,s,a);return d?h:c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{let c=this.hot.columnIndexMapper,d=o<0,u=o;d||(u=c.getVisualFromRenderableIndex(o));let h=this.hot.runHooks("beforeHighlightingColumnHeader",u,s,a);return d?h:c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let c,[d,u]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){let f=h.peekByIndex(a??0);c=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",d,u,c,a)},onBeforeDrawBorders:(o,s)=>{let[a,c,d,u]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c),this.hot.rowIndexMapper.getVisualFromRenderableIndex(d),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{let a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{let c=this.hot.rowIndexMapper,d=this.hot.columnIndexMapper,u=s>=0?d.getVisualFromRenderableIndex(s):s,h=o>=0?c.getVisualFromRenderableIndex(o):o,p=this.hot.runHooks("modifyGetCellCoords",h,u,a);if(Array.isArray(p)){let[f,m,g,y]=p;return[f>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(f,1)):f,m>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(m,1)):m,g>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,-1)):g,y>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,-1)):y]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){let a=this.countRenderableRows(),c=o.startRow,d=o.endRow;if(typeof s=="number")o.startRow=Math.max(c-s,0),o.endRow=Math.min(d+s,a-1);else if(s==="auto"){let u=Math.ceil(d/a*12);o.startRow=Math.max(c-u,0),o.endRow=Math.min(d+u,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){let a=this.countRenderableColumns(),c=o.startColumn,d=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(c-s,0),o.endColumn=Math.min(d+s,a-1)),s==="auto"){let u=Math.ceil(d/a*6);o.startColumn=Math.max(c-u,0),o.endColumn=Math.min(d+u,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new KI(e),this.activeWt=this._wt;let i=this._wt.wtTable.spreader,{width:r,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,n),this.eventManager.addEventListener(i,"mousedown",o=>{o.target===i&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",o=>{o.target===i&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(gI(e))return!0;let i=Zu(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&i||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return aa(mm,this)}isSelectedOnlyCell(){var e,i;return(e=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){let e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,i){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,i)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,i){if(i.firstChild){let r=i.firstChild;if(!Bt(r,"relative")){ia(i),this.appendRowHeader(e,i);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{let{rootDocument:r,getRowHeader:n}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,n),o.appendChild(s),i.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,i)}appendColHeader(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(i.firstChild){let o=i.firstChild;Bt(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,n):(ia(i),this.appendColHeader(e,i,r,n))}else{let{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Ht(s,...Fl()),Ht(a,...Fl())),this.updateCellHeader(a,e,r,n),s.appendChild(a),i.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,i,n)}updateCellHeader(e,i,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=i,s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Bt(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(i):Bt(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(i))),o>-1?Zd(e,r(i,n)):(Qd(e,"\xA0"),Qe(e,"cornerHeader"))}maximumVisibleElementWidth(e){let r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){let r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,i){su(R9,this,e),su(A9,this,i)}getLastSize(){return{width:aa(R9,this),height:aa(A9,this)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return aa(T9,this)}getRowHeadersCount(){return aa(TH,this)}getViewportWidth(){return this.hot.view._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this.hot.view._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this.hot.view._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this.hot.view._wt.wtViewport.getWorkspaceHeight()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};function hye(){return parseInt(this.hot.rootElement.getAttribute(Jx()[0]),10)}function edt(t){let e=ZI(AH,this,hye).call(this)+t;Ht(this.hot.rootElement,...Jx(e))}var fye=I9;var Mgi=U($e(),1),kgi=U(dt(),1);var Agi=U(dt(),1);var tdt="ABCDEFGHIJKLMNOPQRSTUVWXYZ",pye=tdt.length;function mye(t){let e=t+1,i="",r;for(;e>0;)r=(e-1)%pye,i=String.fromCharCode(65+r)+i,e=parseInt((e-r)/pye,10);return i}function D9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=t,r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(i=[t]),i.forEach((n,o)=>{Array.isArray(n)?n.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(n).forEach(s=>{r.push([o+e,s,n[s]])})}),r}function IH(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Xt(t[0])&&(e=a1(t[0]))),e}function gye(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function vye(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function QI(t,e,i){return e=idt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function idt(t){var e=rdt(t,"string");return typeof e=="symbol"?e:e+""}function rdt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var M9=class{constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];QI(this,"hot",void 0),QI(this,"data",void 0),QI(this,"dataType","array"),QI(this,"colToProp",()=>{}),QI(this,"propToCol",()=>{}),this.hot=e,this.data=i}modifyRowData(e){let i;return this.hot.hasHook("modifyRowData")&&(i=this.hot.runHooks("modifyRowData",e)),i!==void 0&&!Number.isInteger(i)?i:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){let i=[];return Ce(this.data,(r,n)=>{let o=this.getAtCell(n,e);i.push(o)}),i}getAtRow(e,i,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=i===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings(),a=null,c=null;if(a=this.modifyRowData(e),Array.isArray(a))c=[],o?a.forEach((d,u)=>{c[u]=this.getAtPhysicalCell(e,u,a)}):_t(i,r,d=>{c[d-i]=this.getAtPhysicalCell(e,d,a)});else if(Xt(a)||nr(a))if(n?c=[]:c={},!o||n){let u=this.countFirstRowKeys()-1;_t(0,u,h=>{let p=this.colToProp(h);if(h>=(i||0)&&h<=(r||u)&&!Number.isInteger(p)){let f=this.getAtPhysicalCell(e,p,a);n?c.push(f):s?x5(c,p,f):c[p]=f}})}else Kt(a,(d,u)=>{let h=this.getAtPhysicalCell(e,u,a);s?x5(c,u,h):c[u]=h});return c}setAtCell(e,i,r){if(!(e>=this.countRows()||i>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let n=sl(r);this.hot.runHooks("modifySourceData",e,i,n,"set"),n.isTouched()&&(r=n.value)}Number.isInteger(i)?this.data[e][i]=r:x5(this.data[e],i,r)}}getAtPhysicalCell(e,i,r){let n=null;if(r)if(typeof i=="string"){let{dataDotNotation:o}=this.hot.getSettings();n=o?j0e(r,i):r[i]}else typeof i=="function"?n=i(r):n=r[i];if(this.hot.hasHook("modifySourceData")){let o=sl(n);this.hot.runHooks("modifySourceData",e,i,o,"get"),o.isTouched()&&(n=o.value)}return n}getAtCell(e,i){let r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(i),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=!1,o=null,s=null,a=null,c=null;e===null||i===null?(n=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,i.row),s=Math.min(e.col,i.col),a=Math.max(e.row,i.row),c=Math.max(e.col,i.col));let d=[];return _t(o,a,u=>{d.push(n?this.getAtRow(u,void 0,void 0,r):this.getAtRow(u,s,c,r))}),d}countRows(){if(this.hot.hasHook("modifySourceLength")){let e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return IH(this.data)}destroy(){this.data=null,this.hot=null}},bye=M9;var cbi=U($e(),1),dbi=U(ln(),1),ubi=U(cn(),1),hbi=U(dn(),1),fbi=U(un(),1),pbi=U(hn(),1),mbi=U(fn(),1),gbi=U(pn(),1);var Tvi=U($e(),1);var Qgi=U(dt(),1);var Bgi=U($e(),1),Vgi=U(dt(),1);function _ye(t,e,i){return e=ndt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ndt(t){var e=odt(t,"string");return typeof e=="symbol"?e:e+""}function odt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Bl=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_ye(this,"indexedValues",[]),_ye(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){let i=this.indexedValues;if(e<i.length)return i[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,i){return e<this.indexedValues.length?(this.indexedValues[e]=i,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,nr(this.initValueOrFn)?_t(e-1,i=>this.indexedValues.push(this.initValueOrFn(i))):_t(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}};Mi(Bl,En);function I1(t,e,i,r){let n=i.length?i[0]:void 0;return[...t.slice(0,n),...i.map((o,s)=>nr(r)?r(o,s):r),...n===void 0?[]:t.slice(n)]}function D1(t,e){return xs(t,(i,r)=>e.includes(r)===!1)}var la=class extends Bl{insert(e,i){this.indexedValues=I1(this.indexedValues,e,i,this.initValueOrFn),super.insert(e,i)}remove(e){this.indexedValues=D1(this.indexedValues,e),super.remove(e)}};var Of=class extends la{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Gr(this.getValues(),(e,i,r)=>(i&&e.push(r),e),[])}};var svi=U($e(),1);function M1(t,e,i){return[...t.slice(0,e),...i,...t.slice(e)]}function gm(t,e){return xs(t,i=>e.includes(i)===!1)}function eb(t,e){return ri(t,i=>i-e.filter(r=>r<i).length)}function tb(t,e){let i=e[0],r=e.length;return ri(t,n=>n>=i?n+r:n)}function sdt(t,e,i){return e=adt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function adt(t){var e=ldt(t,"string");return typeof e=="symbol"?e:e+""}function ldt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Nf=class extends Bl{constructor(){super(...arguments),sdt(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=i,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=gm(this.orderOfIndexes,[e]),nr(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,i){this.indexedValues=I1(this.indexedValues,e,i,this.initValueOrFn),this.orderOfIndexes=tb(this.orderOfIndexes,i),super.insert(e,i)}remove(e){this.indexedValues=D1(this.indexedValues,e),this.orderOfIndexes=gm(this.orderOfIndexes,e),this.orderOfIndexes=eb(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}};var fvi=U(dt(),1);var au=class extends la{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Gr(this.getValues(),(e,i,r)=>(i&&e.push(r),e),[])}};var vvi=U($e(),1);var yye=new Map([["indexesSequence",{getListWithInsertedItems:M1,getListWithRemovedItems:gm}],["physicallyIndexed",{getListWithInsertedItems:I1,getListWithRemovedItems:D1}]]),JI=t=>{if(yye.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return yye.get(t)};var k1=class extends Bl{constructor(){super(e=>e)}insert(e,i){let r=tb(this.indexedValues,i);this.indexedValues=M1(r,e,i),super.insert(e,i)}remove(e){let i=gm(this.indexedValues,e);this.indexedValues=eb(i,e),super.remove(e)}};var wye=new Map([["hiding",Of],["index",Bl],["linkedPhysicalIndexToValue",Nf],["physicalIndexToValue",la],["trimming",au]]);function Cye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!wye.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(wye.get(t))(e)}var Vvi=U($e(),1),jvi=U(dt(),1);var Pvi=U($e(),1);function cdt(t,e,i){return e=ddt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ddt(t){var e=udt(t,"string");return typeof e=="symbol"?e:e+""}function udt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xye=0,ey=class{constructor(){cdt(this,"collection",new Map)}register(e,i){this.collection.has(e)===!1&&(this.collection.set(e,i),i.addLocalHook("change",()=>this.runLocalHooks("change",i)),xye+=1)}unregister(e){let i=this.collection.get(e);wt(i)&&(i.destroy(),this.collection.delete(e),this.runLocalHooks("change",i),xye-=1)}unregisterAll(){this.collection.forEach((e,i)=>this.unregister(i)),this.collection.clear()}get(e){return Qi(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(i=>{i.remove(e)})}insertToEvery(e,i){this.collection.forEach(r=>{r.insert(e,i)})}initEvery(e){this.collection.forEach(i=>{i.init(e)})}};Mi(ey,En);function k9(t,e,i){return e=hdt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function hdt(t){var e=fdt(t,"string");return typeof e=="symbol"?e:e+""}function fdt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eD=class extends ey{constructor(e,i){super(),k9(this,"mergedValuesCache",[]),k9(this,"aggregationFunction",void 0),k9(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=i}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];let i=ri(this.get(),o=>o.getValues()),r=[],n=wt(i[0])&&i[0].length||0;for(let o=0;o<n;o+=1){let s=[];for(let a=0;a<this.getLength();a+=1)s.push(i[a][o]);r.push(s)}return ri(r,this.aggregationFunction)}getMergedValueAtIndex(e,i){let r=this.getMergedValues(i)[e];return wt(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}};var Qvi=U($e(),1),Jvi=U(ln(),1),ebi=U(cn(),1),tbi=U(dn(),1),ibi=U(un(),1),rbi=U(hn(),1),nbi=U(fn(),1),obi=U(pn(),1);var Yvi=U($e(),1);function pdt(t,e,i){mdt(t,e),e.set(t,i)}function mdt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gdt(t,e,i){return t.set(Sye(t,e),i),i}function vdt(t,e){return t.get(Sye(t,e))}function Sye(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var O9=new WeakMap,tD=class{constructor(){pdt(this,O9,[])}subscribe(e){return this.addLocalHook("change",e),this._write(vdt(O9,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){gdt(O9,this,e)}};Mi(tD,En);var Kvi=U(dt(),1);function N9(t,e){let i=[],r=0,n=0;for(;r<t.length&&n<e.length;r++,n++)t[r]!==e[n]&&i.push({op:"replace",index:n,oldValue:t[r],newValue:e[n]});for(;r<e.length;r++)i.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;n<t.length;n++)i.push({op:"remove",index:n,oldValue:t[n],newValue:void 0});return i}function iD(t,e,i){bdt(t,e),e.set(t,i)}function bdt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lu(t,e){return t.get(Eye(t,e))}function DH(t,e,i){return t.set(Eye(t,e),i),i}function Eye(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var MH=new WeakMap,rD=new WeakMap,kH=new WeakMap,OH=new WeakMap,NH=new WeakMap,PH=class{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};iD(this,MH,new Set),iD(this,rD,[]),iD(this,kH,[]),iD(this,OH,!1),iD(this,NH,!1),DH(NH,this,e??!1)}createObserver(){let e=new tD;return lu(MH,this).add(e),e.addLocalHook("unsubscribe",()=>{lu(MH,this).delete(e)}),e._writeInitialChanges(N9(lu(rD,this),lu(kH,this))),e}emit(e){let i=lu(kH,this);(!lu(OH,this)||lu(rD,this).length!==e.length)&&(e.length===0?e=new Array(i.length).fill(lu(NH,this)):DH(rD,this,new Array(e.length).fill(lu(NH,this))),lu(OH,this)||(DH(OH,this,!0),i=lu(rD,this)));let r=N9(i,e);lu(MH,this).forEach(n=>n._write(r)),DH(kH,this,e)}};function Vl(t,e,i){return e=_dt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _dt(t){var e=ydt(t,"string");return typeof e=="symbol"?e:e+""}function ydt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ty=class{constructor(){Vl(this,"indexesSequence",new k1),Vl(this,"trimmingMapsCollection",new eD(e=>e.some(i=>i===!0),!1)),Vl(this,"hidingMapsCollection",new eD(e=>e.some(i=>i===!0),!1)),Vl(this,"variousMapsCollection",new ey),Vl(this,"hidingChangesObservable",new PH({initialIndexValue:!1})),Vl(this,"notTrimmedIndexesCache",[]),Vl(this,"notHiddenIndexesCache",[]),Vl(this,"isBatched",!1),Vl(this,"indexesSequenceChanged",!1),Vl(this,"indexesChangeSource",void 0),Vl(this,"trimmedIndexesChanged",!1),Vl(this,"hiddenIndexesChanged",!1),Vl(this,"renderablePhysicalIndexesCache",[]),Vl(this,"fromPhysicalToVisualIndexesCache",new Map),Vl(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,i,r){return this.registerMap(e,Cye(i,r))}registerMap(e,i){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);i instanceof au?this.trimmingMapsCollection.register(e,i):i instanceof Of?this.hidingMapsCollection.register(e,i):this.variousMapsCollection.register(e,i);let r=this.getNumberOfIndexes();return r>0&&i.init(r),i}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){let i=this.notTrimmedIndexesCache[e];return wt(i)?i:null}getPhysicalFromRenderableIndex(e){let i=this.renderablePhysicalIndexesCache[e];return wt(i)?i:null}getVisualFromPhysicalIndex(e){let i=this.fromPhysicalToVisualIndexesCache.get(e);return wt(i)?i:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){let i=this.fromVisualToRenderableIndexesCache.get(e);return wt(i)?i:null}getNearestNotHiddenIndex(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;let o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return i>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-i,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){let i=this.getNumberOfIndexes();if(e<i){let r=[...Array(this.getNumberOfIndexes()-e).keys()].map(n=>n+e);this.removeIndexes(r)}else this.insertIndexes(i,e-i)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,i){typeof e=="number"&&(e=[e]);let r=ri(e,d=>this.getPhysicalFromVisualIndex(d)),n=this.getNotTrimmedIndexesLength(),o=e.length,s=gm(this.getIndexesSequence(),r),a=s.filter(d=>this.isTrimmed(d)===!1),c=s.indexOf(a[a.length-1])+1;if(i+o<n){let d=a[i];c=s.indexOf(d)}this.indexesChangeSource="move",this.setIndexesSequence(M1(s,c,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,i){let r=this.getNotTrimmedIndexes()[e],n=wt(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=ri(new Array(i).fill(n),(a,c)=>a+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&i===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let i=0;i<e;i+=1){let r=this.getPhysicalFromVisualIndex(i);this.fromPhysicalToVisualIndexesCache.set(r,i)}}cacheFromVisualToRenderableIndexes(){let e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let i=0;i<e;i+=1){let r=this.getPhysicalFromRenderableIndex(i),n=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(n,i)}}};Mi(ty,En);function Tye(t,e){return Kt(e,(i,r)=>{Qi(t[r])&&(t[r]=i)}),t}function LH(t){let i=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return i?`${i[1].toLowerCase()}-${i[2].toUpperCase()}`:t}function FH(t){wt(t)&&f1(Ai`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function P9(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}var{register:wdt,getValues:Cdt}=ls("phraseFormatters");function xdt(t,e){wdt(t,e)}function Rye(){return Cdt()}xdt("pluralize",P9);var ti={};fW(ti,{CHECKBOX_CHECKED:()=>xM,CHECKBOX_RENDERER_NAMESPACE:()=>L9,CHECKBOX_UNCHECKED:()=>SM,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>SD,CONTEXTMENU_ITEMS_ALIGNMENT:()=>AD,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>PD,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>DD,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>kD,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>ID,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>ND,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>MD,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>OD,CONTEXTMENU_ITEMS_BORDERS:()=>LD,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>BD,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>VD,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>HD,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>FD,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>pD,CONTEXTMENU_ITEMS_COPY:()=>mD,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>bD,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>vD,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>gD,CONTEXTMENU_ITEMS_CUT:()=>_D,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>ED,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>yD,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>UD,CONTEXTMENU_ITEMS_HIDE_ROW:()=>YD,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>aD,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>lD,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>CD,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>WD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>zD,CONTEXTMENU_ITEMS_NO_ITEMS:()=>nD,CONTEXTMENU_ITEMS_READ_ONLY:()=>fD,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>RD,CONTEXTMENU_ITEMS_REDO:()=>hD,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>jD,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>dD,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>TD,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>cD,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>oD,CONTEXTMENU_ITEMS_ROW_BELOW:()=>sD,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>qD,CONTEXTMENU_ITEMS_SHOW_ROW:()=>$D,CONTEXTMENU_ITEMS_UNDO:()=>uD,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>wD,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>xD,CONTEXT_MENU_ITEMS_NAMESPACE:()=>Aye,FILTERS_BUTTONS_CANCEL:()=>_M,FILTERS_BUTTONS_CLEAR:()=>vM,FILTERS_BUTTONS_OK:()=>bM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>yM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>CM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>wM,FILTERS_BUTTONS_SELECT_ALL:()=>gM,FILTERS_CONDITIONS_AFTER:()=>lM,FILTERS_CONDITIONS_BEFORE:()=>cM,FILTERS_CONDITIONS_BEGINS_WITH:()=>QD,FILTERS_CONDITIONS_BETWEEN:()=>sM,FILTERS_CONDITIONS_BY_VALUE:()=>Sdt,FILTERS_CONDITIONS_CONTAINS:()=>eM,FILTERS_CONDITIONS_EMPTY:()=>GD,FILTERS_CONDITIONS_ENDS_WITH:()=>JD,FILTERS_CONDITIONS_EQUAL:()=>KD,FILTERS_CONDITIONS_GREATER_THAN:()=>iM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>rM,FILTERS_CONDITIONS_LESS_THAN:()=>nM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>oM,FILTERS_CONDITIONS_NAMESPACE:()=>wo,FILTERS_CONDITIONS_NONE:()=>iy,FILTERS_CONDITIONS_NOT_BETWEEN:()=>aM,FILTERS_CONDITIONS_NOT_CONTAIN:()=>tM,FILTERS_CONDITIONS_NOT_EMPTY:()=>XD,FILTERS_CONDITIONS_NOT_EQUAL:()=>ZD,FILTERS_CONDITIONS_TODAY:()=>dM,FILTERS_CONDITIONS_TOMORROW:()=>uM,FILTERS_CONDITIONS_YESTERDAY:()=>hM,FILTERS_DIVS_FILTER_BY_CONDITION:()=>fM,FILTERS_DIVS_FILTER_BY_VALUE:()=>pM,FILTERS_LABELS_CONJUNCTION:()=>mM,FILTERS_LABELS_DISJUNCTION:()=>ry,FILTERS_NAMESPACE:()=>dl,FILTERS_VALUES_BLANK_CELLS:()=>O1});var Aye="ContextMenu:items",Yi=Aye,nD=`${Yi}.noItems`,oD=`${Yi}.insertRowAbove`,sD=`${Yi}.insertRowBelow`,aD=`${Yi}.insertColumnOnTheLeft`,lD=`${Yi}.insertColumnOnTheRight`,cD=`${Yi}.removeRow`,dD=`${Yi}.removeColumn`,uD=`${Yi}.undo`,hD=`${Yi}.redo`,fD=`${Yi}.readOnly`,pD=`${Yi}.clearColumn`,mD=`${Yi}.copy`,gD=`${Yi}.copyWithHeaders`,vD=`${Yi}.copyWithGroupHeaders`,bD=`${Yi}.copyHeadersOnly`,_D=`${Yi}.cut`,yD=`${Yi}.freezeColumn`,wD=`${Yi}.unfreezeColumn`,CD=`${Yi}.mergeCells`,xD=`${Yi}.unmergeCells`,SD=`${Yi}.addComment`,ED=`${Yi}.editComment`,TD=`${Yi}.removeComment`,RD=`${Yi}.readOnlyComment`,AD=`${Yi}.align`,ID=`${Yi}.align.left`,DD=`${Yi}.align.center`,MD=`${Yi}.align.right`,kD=`${Yi}.align.justify`,OD=`${Yi}.align.top`,ND=`${Yi}.align.middle`,PD=`${Yi}.align.bottom`,LD=`${Yi}.borders`,FD=`${Yi}.borders.top`,HD=`${Yi}.borders.right`,BD=`${Yi}.borders.bottom`,VD=`${Yi}.borders.left`,jD=`${Yi}.borders.remove`,zD=`${Yi}.nestedHeaders.insertChildRow`,WD=`${Yi}.nestedHeaders.detachFromParent`,UD=`${Yi}.hideColumn`,qD=`${Yi}.showColumn`,YD=`${Yi}.hideRow`,$D=`${Yi}.showRow`,dl="Filters:",wo=`${dl}conditions`,iy=`${wo}.none`,GD=`${wo}.isEmpty`,XD=`${wo}.isNotEmpty`,KD=`${wo}.isEqualTo`,ZD=`${wo}.isNotEqualTo`,QD=`${wo}.beginsWith`,JD=`${wo}.endsWith`,eM=`${wo}.contains`,tM=`${wo}.doesNotContain`,Sdt=`${wo}.byValue`,iM=`${wo}.greaterThan`,rM=`${wo}.greaterThanOrEqualTo`,nM=`${wo}.lessThan`,oM=`${wo}.lessThanOrEqualTo`,sM=`${wo}.isBetween`,aM=`${wo}.isNotBetween`,lM=`${wo}.after`,cM=`${wo}.before`,dM=`${wo}.today`,uM=`${wo}.tomorrow`,hM=`${wo}.yesterday`,fM=`${dl}labels.filterByCondition`,pM=`${dl}labels.filterByValue`,mM=`${dl}labels.conjunction`,ry=`${dl}labels.disjunction`,O1=`${dl}values.blankCells`,gM=`${dl}buttons.selectAll`,vM=`${dl}buttons.clear`,bM=`${dl}buttons.ok`,_M=`${dl}buttons.cancel`,yM=`${dl}buttons.placeholder.search`,wM=`${dl}buttons.placeholder.value`,CM=`${dl}buttons.placeholder.secondValue`,L9="CheckboxRenderer:",xM=`${L9}checked`,SM=`${L9}unchecked`;var Edt={languageCode:"en-US",[nD]:"No available options",[oD]:"Insert row above",[sD]:"Insert row below",[aD]:"Insert column left",[lD]:"Insert column right",[cD]:["Remove row","Remove rows"],[dD]:["Remove column","Remove columns"],[uD]:"Undo",[hD]:"Redo",[fD]:"Read only",[pD]:"Clear column",[AD]:"Alignment",[ID]:"Left",[DD]:"Center",[MD]:"Right",[kD]:"Justify",[OD]:"Top",[ND]:"Middle",[PD]:"Bottom",[yD]:"Freeze column",[wD]:"Unfreeze column",[LD]:"Borders",[FD]:"Top",[HD]:"Right",[BD]:"Bottom",[VD]:"Left",[jD]:"Remove border(s)",[SD]:"Add comment",[ED]:"Edit comment",[TD]:"Delete comment",[RD]:"Read-only comment",[CD]:"Merge cells",[xD]:"Unmerge cells",[mD]:"Copy",[gD]:["Copy with header","Copy with headers"],[vD]:["Copy with group header","Copy with group headers"],[bD]:["Copy header only","Copy headers only"],[_D]:"Cut",[zD]:"Insert child row",[WD]:"Detach from parent",[UD]:["Hide column","Hide columns"],[qD]:["Show column","Show columns"],[YD]:["Hide row","Hide rows"],[$D]:["Show row","Show rows"],[iy]:"None",[GD]:"Is empty",[XD]:"Is not empty",[KD]:"Is equal to",[ZD]:"Is not equal to",[QD]:"Begins with",[JD]:"Ends with",[eM]:"Contains",[tM]:"Does not contain",[iM]:"Greater than",[rM]:"Greater than or equal to",[nM]:"Less than",[oM]:"Less than or equal to",[sM]:"Is between",[aM]:"Is not between",[lM]:"After",[cM]:"Before",[dM]:"Today",[uM]:"Tomorrow",[hM]:"Yesterday",[O1]:"Blank cells",[fM]:"Filter by condition",[pM]:"Filter by value",[mM]:"And",[ry]:"Or",[gM]:"Select all",[vM]:"Clear",[bM]:"OK",[_M]:"Cancel",[yM]:"Search",[wM]:"Value",[CM]:"Second value",[xM]:"Checked",[SM]:"Unchecked"},F9=Edt;var Iye=ti,H9=F9.languageCode,{register:Tdt,getItem:Dye,hasItem:Rdt,getValues:Adt}=ls("languagesDictionaries");B9(F9);function B9(t,e){let i=t,r=e;return Xt(t)&&(r=t,i=r.languageCode),Idt(i,r),Tdt(i,Wo(r)),Wo(r)}function Idt(t,e){t!==H9&&Tye(e,Dye(H9))}function V9(t){return HH(t)?Wo(Dye(t)):null}function HH(t){return Rdt(t)}function Mye(){return Adt()}function BH(t,e,i){let r=V9(t);if(r===null)return null;let n=r[e];if(Qi(n))return null;let o=Ddt(n,i);return Array.isArray(o)?o[0]:o}function Ddt(t,e){let i=t;return Ce(Rye(),r=>{i=r(t,e)}),i}function kye(t){let e=LH(t);return HH(e)||(e=H9,FH(t)),e}var p_i=U($e(),1),m_i=U(dt(),1),g_i=U(ln(),1),v_i=U(cn(),1),b_i=U(dn(),1),__i=U(un(),1),y_i=U(hn(),1),w_i=U(fn(),1),C_i=U(pn(),1);var O0i=U($e(),1),N0i=U(dt(),1);var $bi=U($e(),1);function Mdt(t,e,i){return e=kdt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function kdt(t){var e=Odt(t,"string");return typeof e=="symbol"?e:e+""}function Odt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var j9=class extends fH{constructor(e,i){super(e,null),Mdt(this,"visualCellRange",null),this.visualCellRange=i||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:i,to:r}=e,n=this.getNearestNotHiddenCoords(i,1),o=this.getNearestNotHiddenCoords(r,-1);return n===null||o===null?null:((n.row>o.row||n.col>o.col)&&(n=i,o=r),this.settings.createCellRange(n,n,o))}getNearestNotHiddenCoords(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,i);if(n===null)return null;let o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(n,o)}getNearestNotHiddenIndex(e,i,r){return i<0?i:e.getNearestNotHiddenIndex(i,r)}commit(){if(this.visualCellRange===null)return this;let e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){let i=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(i,r,n)),s!==null&&e.overlaps(s)){let a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){let c=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(c)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:e,to:i}=this.cellRange;return[Math.min(e.row,i.row),Math.min(e.col,i.col),Math.max(e.row,i.row),Math.max(e.col,i.col)]}getVisualCorners(){let e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,i.row,i.col]}createRenderableCellRange(e,i){let r=this.settings.visualToRenderableCoords(e),n=this.settings.visualToRenderableCoords(i);return r.row===null||r.col===null||n.row===null||n.col===null?null:this.settings.createCellRange(r,r,n)}},ca=j9;function VH(t){let r=t,{activeHeaderClassName:e}=r,i=Mn(r,["activeHeaderClassName"]);return new ca(Lt(Ke({className:e},i),{selectionType:S1}))}function Oye(t){let r=t,{areaCornerVisible:e}=r,i=Mn(r,["areaCornerVisible"]);return new ca(Lt(Ke({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e}},i),{selectionType:Qv}))}function Nye(t){let e=Mn(t,[]);return new ca(Lt(Ke({className:"highlight"},e),{selectionType:Qv}))}function Pye(t){let r=t,{columnClassName:e}=r,i=Mn(r,["columnClassName"]);return new ca(Lt(Ke({className:e},i),{selectionType:gH}))}function Lye(t){let r=t,{cellCornerVisible:e}=r,i=Mn(r,["cellCornerVisible"]);return new ca(Lt(Ke({className:"current",headerAttributes:[t1()],border:{width:2,color:"#4b89ff",cornerVisible:e}},i),{selectionType:Z_}))}function Fye(t){let n=t,{border:e,visualCellRange:i}=n,r=Mn(n,["border","visualCellRange"]);return new ca(Lt(Ke(Ke({},e),r),{selectionType:vH}),i)}function Hye(t){let e=Mn(t,[]);return new ca(Lt(Ke({className:"fill",border:{width:1,color:"#ff0000"}},e),{selectionType:pH}))}function z9(t){let r=t,{headerClassName:e}=r,i=Mn(r,["headerClassName"]);return new ca(Lt(Ke({className:e},i),{selectionType:Zv}))}function Bye(t){let r=t,{rowClassName:e}=r,i=Mn(r,["rowClassName"]);return new ca(Lt(Ke({className:e},i),{selectionType:mH}))}function Ndt(t,e){Pdt(t,e),e.add(t)}function Pdt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sc(t,e,i){return e=Ldt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ldt(t){var e=Fdt(t,"string");return typeof e=="symbol"?e:e+""}function Fdt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vm(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var Pf=new WeakSet,W9=class{constructor(e){Ndt(this,Pf),Sc(this,"options",void 0),Sc(this,"layerLevel",0),Sc(this,"focus",void 0),Sc(this,"fill",void 0),Sc(this,"layeredAreas",new Map),Sc(this,"areas",new Map),Sc(this,"rowHeaders",new Map),Sc(this,"columnHeaders",new Map),Sc(this,"activeRowHeaders",new Map),Sc(this,"activeColumnHeaders",new Map),Sc(this,"activeCornerHeaders",new Map),Sc(this,"rowHighlights",new Map),Sc(this,"columnHighlights",new Map),Sc(this,"customSelections",[]),this.options=e,this.focus=Lye(e),this.fill=Hye(e)}isEnabledFor(e,i){let r=e;e===Z_&&(r="current");let n=this.options.disabledCellSelection(i.row,i.col);return typeof n=="string"&&(n=[n]),n===!1||Array.isArray(n)&&!n.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return vm(Pf,this,bm).call(this,this.layeredAreas,Oye)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return vm(Pf,this,bm).call(this,this.areas,Nye)}getAreas(){return[...this.areas.values()]}createRowHeader(){return vm(Pf,this,bm).call(this,this.rowHeaders,z9)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return vm(Pf,this,bm).call(this,this.columnHeaders,z9)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return vm(Pf,this,bm).call(this,this.activeRowHeaders,VH)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return vm(Pf,this,bm).call(this,this.activeColumnHeaders,VH)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return vm(Pf,this,bm).call(this,this.activeCornerHeaders,VH)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return vm(Pf,this,bm).call(this,this.rowHighlights,Bye)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return vm(Pf,this,bm).call(this,this.columnHighlights,Pye)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Fye(Ke(Ke({},this.options),e)))}clear(){this.focus.clear(),this.fill.clear(),Ce(this.areas.values(),e=>void e.clear()),Ce(this.layeredAreas.values(),e=>void e.clear()),Ce(this.rowHeaders.values(),e=>void e.clear()),Ce(this.columnHeaders.values(),e=>void e.clear()),Ce(this.activeRowHeaders.values(),e=>void e.clear()),Ce(this.activeColumnHeaders.values(),e=>void e.clear()),Ce(this.activeCornerHeaders.values(),e=>void e.clear()),Ce(this.rowHighlights.values(),e=>void e.clear()),Ce(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};function bm(t,e){let i=this.layerLevel;if(t.has(i))return t.get(i);let r=e(Ke({layerLevel:i},this.options));return t.set(i,r),r}var Vye=W9;var G0i=U($e(),1),X0i=U(dt(),1);function jye(t,e,i){return e=Hdt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Hdt(t){var e=Bdt(t,"string");return typeof e=="symbol"?e:e+""}function Bdt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var U9=class{constructor(e){jye(this,"ranges",[]),jye(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(i=>i.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i;return e>=0&&e<this.size()&&(i=this.ranges[e]),i}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}},zye=U9;var Z0i=U($e(),1);function Vdt(t,e){qye(t,e),e.add(t)}function q9(t,e,i){qye(t,e),e.set(t,i)}function qye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nr(t,e){return t.get(Ss(t,e))}function Y9(t,e,i){return t.set(Ss(t,e),i),i}function Ss(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var jH=new WeakMap,$n=new WeakMap,Lf=new WeakMap,Bs=new WeakSet,zH=class{constructor(e,i){Vdt(this,Bs),q9(this,jH,void 0),q9(this,$n,void 0),q9(this,Lf,{x:0,y:0}),Y9(jH,this,e),Y9($n,this,i)}transformStart(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=Nr($n,this).createCellCoords(e,i),o=Nr(jH,this).current().highlight,s=Nr($n,this).visualToRenderableCoords(o),a=0,c=0;if(this.runLocalHooks("beforeTransformStart",n),s.row!==null&&s.col!==null){let{width:d,height:u}=Ss(Bs,this,Yye).call(this),{row:h,col:p}=Ss(Bs,this,Uye).call(this,o),f=Nr($n,this).fixedRowsBottom(),m=Nr($n,this).minSpareRows(),g=Nr($n,this).minSpareCols(),y=Nr($n,this).autoWrapRow(),w=Nr($n,this).autoWrapCol(),x=Nr($n,this).createCellCoords(h+n.row,p+n.col);if(x.row>=u){let B=sl(r&&m>0&&f===0),G=x.col+1,F=Nr($n,this).createCellCoords(x.row-u,G>=d?G-d:G);this.runLocalHooks("beforeColumnWrap",B,Ss(Bs,this,N1).call(this,F),G>=d),B.value?this.runLocalHooks("insertRowRequire",Nr($n,this).countRenderableRows()):w&&x.assign(F)}else if(x.row<0){let B=sl(w),G=x.col-1,F=Nr($n,this).createCellCoords(u+x.row,G<0?d+G:G);this.runLocalHooks("beforeColumnWrap",B,Ss(Bs,this,N1).call(this,F),G<0),w&&x.assign(F)}if(x.col>=d){let B=sl(r&&g>0),G=x.row+1,F=Nr($n,this).createCellCoords(G>=u?G-u:G,x.col-d);this.runLocalHooks("beforeRowWrap",B,Ss(Bs,this,N1).call(this,F),G>=u),B.value?this.runLocalHooks("insertColRequire",Nr($n,this).countRenderableColumns()):y&&x.assign(F)}else if(x.col<0){let B=sl(y),G=x.row-1,F=Nr($n,this).createCellCoords(G<0?u+G:G,d+x.col);this.runLocalHooks("beforeRowWrap",B,Ss(Bs,this,N1).call(this,F),G<0),y&&x.assign(F)}let{rowDir:T,colDir:M}=Ss(Bs,this,Wye).call(this,x);a=T,c=M,o=Ss(Bs,this,N1).call(this,x)}return this.runLocalHooks("afterTransformStart",o,a,c),o}transformEnd(e,i){let r=Nr($n,this).createCellCoords(e,i),n=Nr(jH,this).current(),o=Nr($n,this).visualToRenderableCoords(n.highlight),s=Ss(Bs,this,$9).call(this,n.to.row,n.from.row),a=Ss(Bs,this,G9).call(this,n.to.col,n.from.col),c=n.to.clone(),d=0,u=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){let{row:h,col:p}=Ss(Bs,this,Uye).call(this,n.highlight),f=Nr($n,this).createCellCoords(s+r.row,a+r.col),m=n.getTopStartCorner(),g=n.getTopEndCorner(),y=n.getBottomEndCorner();if(r.col<0&&a>=p&&f.col<p){let M=f.col-p;f.col=Ss(Bs,this,G9).call(this,m.col,g.col)+M}else if(r.col>0&&a<=p&&f.col>p){let M=Ss(Bs,this,G9).call(this,g.col,m.col),B=Math.max(f.col-M,1);f.col=M+B}if(r.row<0&&s>=h&&f.row<h){let M=f.row-h;f.row=Ss(Bs,this,$9).call(this,m.row,y.row)+M}else if(r.row>0&&s<=h&&f.row>h){let M=Ss(Bs,this,$9).call(this,y.row,m.row),B=Math.max(f.row-M,1);f.row=M+B}let{rowDir:w,colDir:x}=Ss(Bs,this,Wye).call(this,f);d=w,u=x;let T=Ss(Bs,this,N1).call(this,f);r.row===0&&r.col!==0?c.col=T.col:r.row!==0&&r.col===0?c.row=T.row:(c.row=T.row,c.col=T.col)}return this.runLocalHooks("afterTransformEnd",c,d,u),c}setOffsetSize(e){let{x:i,y:r}=e;Y9(Lf,this,{x:i,y:r})}};function Wye(t){let{width:e,height:i}=Ss(Bs,this,Yye).call(this),r=0,n=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=i&&(r=1,t.row=i-1),t.col<0?(n=-1,t.col=0):t.col>0&&t.col>=e&&(n=1,t.col=e-1),{rowDir:r,colDir:n}}function Yye(){return{width:Nr(Lf,this).x+Nr($n,this).countRenderableColumns(),height:Nr(Lf,this).y+Nr($n,this).countRenderableRows()}}function $9(t,e){let i=Nr($n,this).findFirstNonHiddenRenderableRow(t,e);return i===null?null:Nr(Lf,this).y+i}function G9(t,e){let i=Nr($n,this).findFirstNonHiddenRenderableColumn(t,e);return i===null?null:Nr(Lf,this).x+i}function Uye(t){let{row:e,col:i}=Nr($n,this).visualToRenderableCoords(t);if(e===null||i===null)throw new Error("Renderable coords are not visible.");return Nr($n,this).createCellCoords(Nr(Lf,this).y+e,Nr(Lf,this).x+i)}function N1(t){let e=t.clone();return e.col=t.col-Nr(Lf,this).x,e.row=t.row-Nr(Lf,this).y,Nr($n,this).renderableToVisualCoords(e)}Mi(zH,En);var X9=zH;var t_i=U($e(),1),i_i=U(dt(),1),r_i=U(ln(),1),n_i=U(cn(),1),o_i=U(dn(),1),s_i=U(un(),1),a_i=U(hn(),1),l_i=U(fn(),1),c_i=U(pn(),1);var EM=0,TM=1,Gye=2,Z9=3,jdt=[Z9,Gye],zdt=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],K9=Symbol("root"),$ye=Symbol("child");function _m(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:K9;if(e!==K9&&e!==$ye)throw new Error("The second argument is used internally only and cannot be overwritten.");let i=Array.isArray(t),r=e===K9,n=EM;if(i){let o=t[0];t.length===0?n=TM:r&&o instanceof Y_?n=Z9:r&&Array.isArray(o)?n=_m(o,$ye):t.length>=2&&t.length<=4&&!t.some((a,c)=>!zdt[c].includes(typeof a))&&(n=Gye)}return n}function ib(t){let{createCellCoords:e,createCellRange:i,keepDirection:r=!1,propToCol:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!jdt.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){let s=t===Z9,a=s?o.from.row:o[0],c=s?o.from.col:o[1],d=s?o.to.row:o[2],u=s?o.to.col:o[3];if(typeof n=="function"&&(typeof c=="string"&&(c=n(c)),typeof u=="string"&&(u=n(u))),Qi(d)&&(d=a),Qi(u)&&(u=c),!r){let f=a,m=c,g=d,y=u;a=Math.min(f,g),c=Math.min(m,y),d=Math.max(f,g),u=Math.max(m,y)}let h=e(a,c),p=e(d,u);return i(h,h,p)}}function Xye(t){let e=_m(t.getSelected());if(e===EM||e===TM)return[];let i=ib(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;Ce(t.getSelected(),s=>{let{from:a,to:c}=i(s),d=Math.max(a.col,0),u=c.col-d+1;Ce(Array.from(new Array(u),(h,p)=>d+p),h=>{r.has(h)||r.add(h)})});let n=Array.from(r).sort((s,a)=>s-a);return Gr(n,(s,a,c,d)=>(c!==0&&a===d[c-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Kye(t){let e=_m(t.getSelected());if(e===EM||e===TM)return[];let i=ib(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;Ce(t.getSelected(),s=>{let{from:a,to:c}=i(s),d=Math.max(a.row,0),u=c.row-d+1;Ce(Array.from(new Array(u),(h,p)=>d+p),h=>{r.has(h)||r.add(h)})});let n=Array.from(r).sort((s,a)=>s-a);return Gr(n,(s,a,c,d)=>(c!==0&&a===d[c-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function P1(t,e,i){Wdt(t,e),e.set(t,i)}function Wdt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ny(t,e,i){return e=Udt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Udt(t){var e=qdt(t,"string");return typeof e=="symbol"?e:e+""}function qdt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ao(t,e){return t.get(Zye(t,e))}function Ff(t,e,i){return t.set(Zye(t,e),i),i}function Zye(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var Ec=new WeakMap,oy=new WeakMap,WH=new WeakMap,RM=new WeakMap,UH=new WeakMap,AM=new WeakMap,qH=class{constructor(e,i){var r=this;ny(this,"settings",void 0),ny(this,"tableProps",void 0),ny(this,"inProgress",!1),ny(this,"selectedRange",new zye((n,o,s)=>this.tableProps.createCellRange(n,o,s))),ny(this,"highlight",void 0),P1(this,Ec,void 0),P1(this,oy,void 0),ny(this,"selectedByRowHeader",new Set),ny(this,"selectedByColumnHeader",new Set),P1(this,WH,!1),P1(this,RM,!1),P1(this,UH,"unknown"),P1(this,AM,-1),this.settings=e,this.tableProps=i,this.highlight=new Vye({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[t1()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(n,o)=>this.tableProps.isDisabledCellSelection(n,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),createCellCoords:(n,o)=>this.tableProps.createCellCoords(n,o),createCellRange:(n,o,s)=>this.tableProps.createCellRange(n,o,s)}),Ff(Ec,this,new X9(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(n,o)=>this.tableProps.createCellCoords(n,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ff(oy,this,new X9(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{let n=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,n.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{let n=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,n.getOuterBottomEndCorner().col)},visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(n,o)=>this.tableProps.createCellCoords(n,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ao(Ec,this).addLocalHook("beforeTransformStart",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Ao(Ec,this).addLocalHook("afterTransformStart",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Ao(Ec,this).addLocalHook("beforeTransformEnd",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Ao(Ec,this).addLocalHook("afterTransformEnd",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Ao(Ec,this).addLocalHook("insertRowRequire",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Ao(Ec,this).addLocalHook("insertColRequire",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Ao(Ec,this).addLocalHook("beforeRowWrap",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Ao(Ec,this).addLocalHook("beforeColumnWrap",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Ao(oy,this).addLocalHook("beforeTransformStart",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Ao(oy,this).addLocalHook("afterTransformStart",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Ff(UH,this,e)}markEndSource(){Ff(UH,this,"unknown")}getSelectionSource(){return Ao(UH,this)}setExpectedLayers(e){Ff(AM,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ff(AM,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,o=this.settings.selectionMode==="multiple",s=Qi(i)?this.tableProps.getShortcutManager().isCtrlPressed():i,a=e.clone();Ff(WH,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Qi(i))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(n.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,i,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;let i=e.clone(),r=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||n>0)&&(r===0&&i.col<0&&!o||n===0&&i.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",i),this.begin();let s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{let c=s.getHorizontalDirection(),d=s.getVerticalDirection(),u=this.isMultiple();s.setTo(i),u&&(c!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),u&&(d!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();let a=Ao(AM,this)===-1||this.selectedRange.size()===Ao(AM,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel(),r=this.tableProps.countRows(),n=this.tableProps.countCols();i<this.highlight.layerLevel&&(Ce(this.highlight.getAreas(),m=>void m.clear()),Ce(this.highlight.getLayeredAreas(),m=>void m.clear()),Ce(this.highlight.getRowHeaders(),m=>void m.clear()),Ce(this.highlight.getColumnHeaders(),m=>void m.clear()),Ce(this.highlight.getActiveRowHeaders(),m=>void m.clear()),Ce(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),Ce(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),Ce(this.highlight.getRowHighlights(),m=>void m.clear()),Ce(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(i);let o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),c=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),p=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),c.clear(),d.clear(),u.clear(),h.clear(),p.clear(),f.clear(),this.highlight.isEnabledFor(Qv,e.highlight)&&(this.isMultiple()||i>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),i===1)){let m=this.selectedRange.previous();this.highlight.useLayerLevel(i-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Zv,e.highlight)){if(!e.isSingleHeader()){let y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),w=this.tableProps.createCellCoords(e.to.row,-1),x=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),c.add(x).commit(),p.add(y).commit(),f.add(x).commit()):(a.add(y).add(w).commit(),c.add(x).add(T).commit(),p.add(y).add(w).commit(),f.add(x).add(T).commit())}let m=!Ao(RM,this)&&this.isEntireRowSelected()&&(n>0&&n===e.getWidth()||n===0&&this.isSelectedByRowHeader()),g=!Ao(RM,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&d.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),g&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&g&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;let i=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);let r=this.highlight.getFocus();r.clear(),i.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Z_,i.highlight)&&r.add(i.highlight).commit().syncWith(i),this.inProgress||(Ff(WH,this,!0),this.runLocalHooks("afterSetFocus",i.highlight))}transformStart(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders&&Ao(Ec,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}),this.setRangeStart(Ao(Ec,this).transformStart(e,i,r))}transformEnd(e,i){this.settings.navigableHeaders&&Ao(Ec,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}),this.setRangeEnd(Ao(Ec,this).transformEnd(e,i))}transformFocus(e,i){let r=this.selectedRange.current(),{row:n,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,n-1);r.highlight.isHeader()?Ao(oy,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:n<0?Math.abs(n):-a}):Ao(oy,this).setOffsetSize({x:o<0?0:-s,y:n<0?0:-a});let c=Ao(oy,this).transformStart(e,i);this.setRangeFocus(c.normalize())}shiftRows(e,i){if(!this.isSelected())return;let r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){let{from:n,to:o,highlight:s}=r,a=this.tableProps.countRows(),c=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),u=d?-1:0,h=d?0:i;this.getSelectedRange().pop();let p=this.tableProps.createCellCoords(Rr(n.row+h,u,a-1),n.col),f=this.tableProps.createCellCoords(Rr(o.row+i,u,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(p,!0,this.tableProps.createCellCoords(Rr(s.row+i,0,a-1),s.col)):this.setRangeStartOnly(p,!0),c&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,i){if(!this.isSelected())return;let r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){let{from:n,to:o,highlight:s}=r,a=this.tableProps.countCols(),c=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),u=c?-1:0,h=c?0:i;this.getSelectedRange().pop();let p=this.tableProps.createCellCoords(n.row,Rr(n.col+h,u,a-1)),f=this.tableProps.createCellCoords(o.row,Rr(o.col+i,u,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(p,!0,this.tableProps.createCellCoords(s.row,Rr(s.col+i,0,a-1))):this.setRangeStartOnly(p,!0),c&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;let e=sl(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Ao(WH,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel(),i=n=>{let{col:o}=n.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&n.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(n=>i(n));let r=this.selectedRange.peekByIndex(e);return r?i(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel(),i=n=>{let{row:o}=n.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&n.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(n=>i(n));let r=this.selectedRange.peekByIndex(e);return r?i(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){let i=this.tableProps.visualToRenderableCoords(e);return i.row!==null&&i.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),c=this.tableProps.countColHeaders(),d=r?-c:0,u=i?-a:0;if(d===0&&u===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight,{focusPosition:p,disableHeadersHighlight:f}=n;Ff(RM,this,f),p&&Number.isInteger(p?.row)&&Number.isInteger(p?.col)&&(h=this.tableProps.createCellCoords(Rr(p.row,d,o-1),Rr(p.col,u,s-1)));let m=this.tableProps.createCellCoords(d,u),g=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(m,void 0,h),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),d<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),Ff(RM,this,!1)}selectCells(e){var i=this;let r=_m(e);if(r===TM)return!1;if(r===EM)throw new Error(Ai`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let n=ib(r,{createCellCoords:function(){return i.tableProps.createCellCoords(...arguments)},createCellRange:function(){return i.tableProps.createCellRange(...arguments)},propToCol:c=>this.tableProps.propToCol(c),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(c=>{let d=n(c),u=d.isValid(s);return!(u&&!d.containsHeaders()||u&&d.containsHeaders()&&d.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),Ce(e,c=>{let{from:d,to:u}=n(c);this.setRangeStartOnly(d.clone(),!1),this.setRangeEnd(u.clone())}),this.finish()),a}selectColumns(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof i=="string"?this.tableProps.propToCol(i):i,s=this.tableProps.countRows(),a=this.tableProps.countCols(),c=this.tableProps.countColHeaders(),d=c===0?0:-c,u=this.tableProps.createCellCoords(d,n),h=this.tableProps.createCellCoords(s-1,o),p=this.tableProps.createCellRange(u,u,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:c});if(p){let f=0,m=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=Rr(r.row,d,s-1),m=Rr(r.col,Math.min(n,o),Math.max(n,o))):(f=Rr(r,d,s-1),m=n);let g=this.tableProps.createCellCoords(f,m),y=c===0?0:Rr(g.row,d,-1),w=s-1,x=this.tableProps.createCellCoords(y,n),T=this.tableProps.createCellCoords(w,o);this.runLocalHooks("beforeSelectColumns",x,T,g),x.row=y,T.row=w,this.setRangeStartOnly(x,void 0,g),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",x,T,g),this.finish()}return p}selectRows(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,c=this.tableProps.createCellCoords(e,a),d=this.tableProps.createCellCoords(i,o-1),u=this.tableProps.createCellRange(c,c,d).isValid({countRows:n,countCols:o,countRowHeaders:s,countColHeaders:0});if(u){let h=0,p=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(h=Rr(r.row,Math.min(e,i),Math.max(e,i)),p=Rr(r.col,a,o-1)):(h=e,p=Rr(r,a,o-1));let f=this.tableProps.createCellCoords(h,p),m=s===0?0:Rr(f.col,a,-1),g=o-1,y=this.tableProps.createCellCoords(e,m),w=this.tableProps.createCellCoords(i,g);this.runLocalHooks("beforeSelectRows",y,w,f),y.col=m,w.col=g,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",y,w,f),this.finish()}return u}refresh(){if(!this.isSelected())return;let e=this.tableProps.countRows(),i=this.tableProps.countCols();if(e===0||i===0){this.deselect();return}let r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:n,to:o,highlight:s}=r;this.clear(),s.assign({row:Rr(s.row,-1/0,e-1),col:Rr(s.col,-1/0,i-1)}),n.assign({row:Rr(n.row,-1/0,e-1),col:Rr(n.col,-1/0,i-1)}),o.assign({row:Rr(o.row,0,e-1),col:Rr(o.col,0,i-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(n=>{n.commit()}),!this.isSelected())return;let i=this.highlight.getFocus(),r=this.getLayerLevel();i.commit().syncWith(this.selectedRange.current());for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);let o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),c=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),p=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),c.commit(),d.commit(),u.commit(),h.commit(),p.commit(),f.commit()}this.highlight.useLayerLevel(r)}};Mi(qH,En);var Q9=qH;var z_i=U($e(),1),W_i=U(dt(),1);var Qye=/^(\r\n|\n\r|\r|\n)/,Ydt=/^[^\t\r\n]+/,Jye=/^\t/;function J9(t){let e=[[""]];if(t.length===0)return e;let i=0,r=0,n;for(;t.length>0&&n!==t.length;)if(n=t.length,t.match(Jye))t=t.replace(Jye,""),i+=1,e[r][i]="";else if(t.match(Qye))t=t.replace(Qye,""),i=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){let c=t.slice(0,1);c==='"'&&(s+=1),o+=c,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,c=>new Array(Math.floor(c.length/2)).fill('"').join(""))}else{let s=t.match(Ydt);o=s?s[0]:"",t=t.slice(o.length)}e[r][i]=o}return e}function rb(t){let e,i,r,n,o="",s;for(e=0,i=t.length;e<i;e+=1){for(n=t[e].length,r=0;r<n;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==i-1&&(o+=`
`)}return o}function sy(t,e,i){return e=$dt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function $dt(t){var e=Gdt(t,"string");return typeof e=="symbol"?e:e+""}function Gdt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eY=class t{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,i,r){sy(this,"hot",void 0),sy(this,"metaManager",void 0),sy(this,"tableMeta",void 0),sy(this,"dataSource",void 0),sy(this,"duckSchema",void 0),sy(this,"colToPropCache",void 0),sy(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=i,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){let e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let i=this.tableMeta.columns,r;if(this.colToPropCache=[],this.propToColCache=new Map,i){let n=0,o=0,s=!1;if(typeof i=="function"){let a=a1(e);n=a>0?a:this.countFirstRowKeys(),s=!0}else{let a=this.tableMeta.maxCols;n=Math.min(a,i.length)}for(r=0;r<n;r++){let a=s?i(r):i[r];if(Xt(a)){if(typeof a.data<"u"){let c=s?o:r;this.colToPropCache[c]=a.data,this.propToColCache.set(a.data,c)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return IH(this.dataSource)}recursiveDuckColumns(e,i,r){let n=i,o=r,s;return typeof n>"u"&&(n=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Kt(e,(a,c)=>{a===null?(s=o+c,this.colToPropCache.push(s),this.propToColCache.set(s,n),n+=1):n=this.recursiveDuckColumns(a,n,`${c}.`)}),n}colToProp(e){if(Number.isInteger(e)===!1)return e;let i=this.hot.toPhysicalColumn(e);return i===null?e:this.colToPropCache&&wt(this.colToPropCache[i])?this.colToPropCache[i]:i}propToCol(e){let i=this.propToColCache.get(e);if(wt(i))return this.hot.toVisualColumn(i);let r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){let e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?W_(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:n="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=this.hot.countSourceRows(),s=o,a=0,c=e;if((typeof c!="number"||c>=o)&&(c=o),c<this.hot.countRows()&&(s=this.hot.toPhysicalRow(c)),this.hot.runHooks("beforeCreateRow",c,i,r)===!1||s===null)return{delta:0};let u=this.tableMeta.maxRows,h=this.getSchema().length,p=[];for(;a<i&&o+a<u;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=Wo(this.getSchema()):(m=[],_t(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(c+a):(m={},U_(m,this.getSchema())),p.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(c,a),n==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,p);let f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===p.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,i)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:n="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),c=e;if((typeof c!="number"||c>=a)&&(c=a),this.hot.runHooks("beforeCreateCol",c,i,r)===!1)return{delta:0};let u=a;c<this.hot.countCols()&&(u=this.hot.toPhysicalColumn(c));let h=this.hot.countSourceRows(),p=this.hot.countCols(),f=0,m=u;n==="end"&&(m=Math.min(m+1,a));let g=m;for(;f<i&&p<s;){if(typeof c!="number"||c>=p)if(h>0)for(let w=0;w<h;w+=1)typeof o[w]>"u"&&(o[w]=[]),o[w].push(null);else o.push([null]);else for(let w=0;w<h;w++)o[w].splice(m,0,null);f+=1,m+=1,p+=1}this.hot.columnIndexMapper.insertIndexes(c,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(g,i));let y=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",y,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:g}}removeRow(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-i,o=this.visualRowsToPhysical(n,i),s=this.hot.countSourceRows();if(n=(s+n)%s,this.hot.runHooks("beforeRemoveRow",n,o.length,o,r)===!1)return!1;let c=o.length;if(this.filterData(n,c,o),n<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);let u=wt(this.tableMeta.columns)||wt(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((u,h)=>h-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.hot.runHooks("afterRemoveRow",n,c,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n=typeof e!="number"?-i:e;n=(this.hot.countCols()+n)%this.hot.countCols();let o=this.visualColumnsToPhysical(n,i),s=o.slice(0).sort((h,p)=>p-h);if(this.hot.runHooks("beforeRemoveCol",n,i,o,r)===!1)return!1;let c=!0,d=s.length,u=this.dataSource;for(let h=0;h<d;h++)c&&o[0]!==o[h]-h&&(c=!1);if(c)for(let h=0,p=this.hot.countSourceRows();h<p;h++)u[h].splice(o[0],i),h===0&&this.metaManager.removeColumn(o[0],i);else for(let h=0,p=this.hot.countSourceRows();h<p;h++)for(let f=0;f<d;f++)u[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return n<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",n,i,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,i,r){let n=this.hot.getDataAtCol(e),o=n.slice(i,i+r),s=n.slice(i+r);for(var a=arguments.length,c=new Array(a>3?a-3:0),d=3;d<a;d++)c[d-3]=arguments[d];m7(c,s);let u=0;for(;u<r;)c.push(null),u+=1;return Lbe(c),this.hot.populateFromArray(i,e,c,null,null,"spliceCol"),o}spliceRow(e,i,r){let n=this.hot.getSourceDataAtRow(e),o=n.slice(i,i+r),s=n.slice(i+r);for(var a=arguments.length,c=new Array(a>3?a-3:0),d=3;d<a;d++)c[d-3]=arguments[d];m7(c,s);let u=0;for(;u<r;)c.push(null),u+=1;return this.hot.populateFromArray(e,i,[c],null,null,"spliceRow"),o}spliceData(e,i,r){if(this.hot.runHooks("beforeDataSplice",e,i,r)!==!1){let o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,i,r){let n=this.hot.runHooks("filterData",e,i,r);Array.isArray(n)===!1&&(n=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(e,i){let r=this.hot.toPhysicalRow(e),n=this.dataSource[r],o=this.hot.runHooks("modifyRowData",r);n=isNaN(o)?o:n;let{dataDotNotation:s}=this.hot.getSettings(),a=null;if(n&&n.hasOwnProperty&&Pr(n,i))a=n[i];else if(s&&typeof i=="string"&&i.indexOf(".")>-1){let c=n;if(!c)return null;let d=i.split(".");for(let u=0,h=d.length;u<h;u++)if(c=c[d[u]],typeof c>"u")return null;a=c}else typeof i=="function"&&(a=i(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){let c=sl(a);this.hot.runHooks("modifyData",r,this.propToCol(i),c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,i){return this.hot.getCellMeta(e,this.propToCol(i)).copyable?this.get(e,i):""}set(e,i,r){let n=this.hot.toPhysicalRow(e),o=r,s=this.dataSource[n],a=this.hot.runHooks("modifyRowData",n);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){let d=sl(o);this.hot.runHooks("modifyData",n,this.propToCol(i),d,"set"),d.isTouched()&&(o=d.value)}let{dataDotNotation:c}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Pr(s,i))s[i]=o;else if(c&&typeof i=="string"&&i.indexOf(".")>-1){let d=s,u=0,h,p=i.split(".");for(u=0,h=p.length-1;u<h;u++)typeof d[p[u]]>"u"&&(d[p[u]]={}),d=d[p[u]];d[p[u]]=o}else typeof i=="function"?i(this.dataSource.slice(n,n+1)[0],o):s[i]=o}visualRowsToPhysical(e,i){let r=this.hot.countSourceRows(),n=[],o=(r+e)%r,s=i,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),n.push(a),s-=1,o+=1;return n}visualColumnsToPhysical(e,i){let r=this.hot.countCols(),n=[],o=(r+e)%r,s=i;for(;o<r&&s;){let a=this.hot.toPhysicalColumn(o);n.push(a),s-=1,o+=1}return n}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let i=0;i<this.hot.countCols();i++)this.set(e,this.colToProp(i),"")}getLength(){let e=this.tableMeta.maxRows,i;e<0||e===0?i=0:i=e||1/0;let r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,i)}getAll(){let e={row:0,col:0},i={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-i.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,i,t.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,i,r){let n=[],o,s,a,c=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(c===0||d===0)return[];let u=r===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(c-1,0),Math.max(e.row,i.row)),p=Math.min(Math.max(d-1,0),Math.max(e.col,i.col));for(o=Math.min(e.row,i.row);o<=h;o++){a=[];let f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,i.col);s<=p&&f!==null;s++)a.push(u.call(this,o,this.colToProp(s)));f!==null&&n.push(a)}return n}getText(e,i){return rb(this.getRange(e,i,t.DESTINATION_RENDERER))}getCopyableText(e,i){return rb(this.getRange(e,i,t.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}},ewe=eY;var ewi=U($e(),1);var _yi=U($e(),1);var oyi=U($e(),1),syi=U(ln(),1),ayi=U(cn(),1),lyi=U(dn(),1),cyi=U(un(),1),dyi=U(hn(),1),uyi=U(fn(),1),hyi=U(pn(),1);var Z_i=U($e(),1);var{register:Xdt,getItem:Kdt,hasItem:tY,getNames:iyi,getValues:ryi}=ls("cellTypes");function twe(t){if(!tY(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Kdt(t)}function sd(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);let{editor:i,renderer:r,validator:n}=e;i&&Hl(t,i),r&&yc(t,r),n&&Uv(t,n),Xdt(t,e)}function Zdt(t,e){var i;return t==="CELL_TYPE"?!1:((i=e._automaticallyAssignedMetaProps)===null||i===void 0?void 0:i.has(t))||!Pr(e,t)}function nb(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,r=typeof e.type=="string"?twe(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Kt(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Xt(r))return;i===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);let n={};Kt(r,(o,s)=>{if(Zdt(s,i)){var a;n[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Sr(t,n)}function iwe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function i(){}Ju(i,t);for(let r=0;r<e.length;r++)i.prototype[e[r]]=void 0;return i}function L1(t){return Number.isInteger(t)&&t>=0}function F1(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function IM(t){return t==null}var DM=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,i,r;for(e=0,i=this.countRows();e<i;e++)if(r=this.getDataAtCell(e,t),jr(r)===!1)return!1;return!0},isEmptyRow(t){let e,i,r,n;for(e=0,i=this.countCols();e<i;e++)if(r=this.getDataAtCell(t,e),jr(r)===!1)return typeof r=="object"?(n=this.getCellMeta(t,e),s1(this.getSchema()[n.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function rwe(t,e,i){return e=Qdt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Qdt(t){var e=Jdt(t,"string");return typeof e=="symbol"?e:e+""}function Jdt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eut(){return class{}}var YH=class{constructor(e){rwe(this,"metaCtor",eut()),rwe(this,"meta",void 0),this.meta=this.metaCtor.prototype,Sr(this.meta,DM()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var i;Sr(this.meta,e),nb(this.meta,Lt(Ke({},e),{type:(i=e.type)!==null&&i!==void 0?i:this.meta.type}),e)}};var Tyi=U($e(),1);function tut(t,e,i){return e=iut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function iut(t){var e=rut(t,"string");return typeof e=="symbol"?e:e+""}function rut(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $H=class{constructor(e){tut(this,"meta",void 0);let i=e.getMetaConstructor();this.meta=new i}getMeta(){return this.meta}updateMeta(e){Sr(this.meta,e),nb(this.meta,e,e)}};var zyi=U($e(),1);var Dyi=U($e(),1),Myi=U(dt(),1),kyi=U(ln(),1),Oyi=U(cn(),1),Nyi=U(dn(),1),Pyi=U(un(),1),Lyi=U(hn(),1),Fyi=U(fn(),1),Hyi=U(pn(),1);function GH(t,e,i){return e=nut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function nut(t){var e=out(t,"string");return typeof e=="symbol"?e:e+""}function out(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ob=class{constructor(e){GH(this,"valueFactory",void 0),GH(this,"data",[]),GH(this,"index",[]),GH(this,"holes",new Set),this.valueFactory=e}obtain(e){F1(()=>L1(e),"Expecting an unsigned number.");let i=this._getStorageIndexByKey(e),r;if(i>=0)r=this.data[i],r===void 0&&(r=this.valueFactory(e),this.data[i]=r);else if(r=this.valueFactory(e),this.holes.size>0){let n=this.holes.values().next().value;this.holes.delete(n),this.data[n]=r,this.index[e]=n}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;F1(()=>L1(e)||IM(e),"Expecting an unsigned number or null/undefined argument.");let r=[],n=this.data.length;for(let s=0;s<i;s++)r.push(n+s),this.data.push(void 0);let o=IM(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;F1(()=>L1(e)||IM(e),"Expecting an unsigned number or null/undefined argument.");let r=this.index.splice(IM(e)?this.index.length-i:e,i);for(let n=0;n<r.length;n++){let o=r[n];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return xs(this.data,(e,i)=>!this.holes.has(i))[Symbol.iterator]()}entries(){let e=[];for(let r=0;r<this.data.length;r++){let n=this._getKeyByStorageIndex(r);n!==-1&&e.push([n,this.data[r]])}let i=0;return{next:()=>{if(i<e.length){let r=e[i];return i+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}};function nwe(t,e,i){return e=sut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function sut(t){var e=aut(t,"string");return typeof e=="symbol"?e:e+""}function aut(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lut=["data","width"],XH=class{constructor(e){nwe(this,"globalMeta",void 0),nwe(this,"metas",new ob(()=>this._createMeta())),this.globalMeta=e,this.metas=new ob(()=>this._createMeta())}updateMeta(e,i){let r=this.getMeta(e);Sr(r,i),nb(r,i)}createColumn(e,i){this.metas.insert(e,i)}removeColumn(e,i){this.metas.remove(e,i)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return iwe(this.globalMeta.getMetaConstructor(),lut).prototype}};var $yi=U($e(),1),Gyi=U(dt(),1);function owe(t,e,i){return e=cut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function cut(t){var e=dut(t,"string");return typeof e=="symbol"?e:e+""}function dut(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KH=class{constructor(e){owe(this,"columnMeta",void 0),owe(this,"metas",new ob(()=>this._createRow())),this.columnMeta=e}updateMeta(e,i,r){let n=this.getMeta(e,i);Sr(n,r),nb(n,r)}createRow(e,i){this.metas.insert(e,i)}createColumn(e,i){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,i)}removeRow(e,i){this.metas.remove(e,i)}removeColumn(e,i){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,i)}getMeta(e,i,r){let n=this.metas.obtain(e).obtain(i);return r===void 0?n:n[r]}setMeta(e,i,r,n){var o;let s=this.metas.obtain(e).obtain(i);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=n}removeMeta(e,i,r){let n=this.metas.obtain(e).obtain(i);delete n[r]}getMetas(){let e=[],i=Array.from(this.metas.values());for(let r=0;r<i.length;r++)wt(i[r])&&e.push(...i[r].values());return e}getMetasAtRow(e){F1(()=>L1(e),"Expecting an unsigned number.");let i=new Map(this.metas);return i.has(e)?Array.from(i.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new ob(e=>this._createMeta(e))}_createMeta(e){let i=this.columnMeta.getMetaConstructor(e);return new i}};var H1=class{constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new YH(e),this.tableMeta=new $H(this.globalMeta),this.columnMeta=new XH(this.globalMeta),this.cellMeta=new KH(this.columnMeta),r.forEach(n=>new n(this)),this.globalMeta.updateMeta(i)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,i){this.columnMeta.updateMeta(e,i)}getCellMeta(e,i,r){let{visualRow:n,visualColumn:o}=r,s=this.cellMeta.getMeta(e,i);return s.visualRow=n,s.visualCol=o,s.row=e,s.col=i,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,i,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,i,r)}setCellMeta(e,i,r,n){this.cellMeta.setMeta(e,i,r,n)}updateCellMeta(e,i,r){this.cellMeta.updateMeta(e,i,r)}removeCellMeta(e,i,r){this.cellMeta.removeMeta(e,i,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,i)}removeRow(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,i)}createColumn(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,i),this.columnMeta.createColumn(e,i)}removeColumn(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,i),this.columnMeta.removeColumn(e,i)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}};Mi(H1,En);var lwi=U($e(),1),cwi=U(dt(),1);function ZH(t,e,i,r){let{hotInstance:n,dataMap:o,dataSource:s,internalSource:a,source:c,metaManager:d,firstRun:u}=r,h=ka(a),p=n.getSettings();Array.isArray(p.dataSchema)?n.dataType="array":nr(p.dataSchema)?n.dataType="function":n.dataType="object",o&&o.destroy(),t=n.runHooks(`before${h}`,t,u,c);let f=new ewe(n,t,d);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){let m=f.getSchema();t=[];let g,y=0,w=0;for(y=0,w=p.startRows;y<w;y++)if((n.dataType==="object"||n.dataType==="function")&&p.dataSchema)g=Wo(m),t.push(g);else if(n.dataType==="array")g=Wo(m[0]),t.push(g);else{g=[];for(let x=0,T=p.startCols;x<T;x++)g.push(null);t.push(g)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(n.dataType="array"),p.data=t,f.dataSource=t,s.data=t,s.dataType=n.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),i(f),n.runHooks(`after${h}`,t,u,c),u||(n.runHooks("afterChange",null,a),n.render()),n.getSettings().ariaTags&&Ht(n.rootElement,[f5(-1),Jx(n.countCols()+(n.view?n.countRowHeaders():0))])}var vwi=U($e(),1),bwi=U(ln(),1),_wi=U(cn(),1),ywi=U(dn(),1),wwi=U(un(),1),Cwi=U(hn(),1),xwi=U(fn(),1),Swi=U(pn(),1);function swe(t,e,i){return e=uut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function uut(t){var e=hut(t,"string");return typeof e=="symbol"?e:e+""}function hut(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MM=class{constructor(e){swe(this,"metaManager",void 0),swe(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",i=>this.extendCellMeta(i)),Ct.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var i;let{row:r,col:n}=e;if((i=this.metaSyncMemo.get(r))!==null&&i!==void 0&&i.has(n))return;let{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,c=a.colToProp(s);e.prop=c,a.runHooks("beforeGetCellMeta",o,s,e);let d=Pr(e,"type")?e.type:null,u=nr(e.cells)?e.cells(r,n,c):null;if(d)if(u){var h;u.type=(h=u.type)!==null&&h!==void 0?h:d}else u={type:d};u&&this.metaManager.updateCellMeta(r,n,u),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(n)}};var Iwi=U($e(),1),Dwi=U(dt(),1),Mwi=U(ln(),1),kwi=U(cn(),1),Owi=U(dn(),1),Nwi=U(un(),1),Pwi=U(hn(),1),Lwi=U(fn(),1),Fwi=U(pn(),1);function fut(t,e,i){put(t,e),e.set(t,i)}function put(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iY(t,e,i){return e=mut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function mut(t){var e=gut(t,"string");return typeof e=="symbol"?e:e+""}function gut(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vut(t,e){return t.get(but(t,e))}function but(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var awe=new WeakMap,kM=class{constructor(e){iY(this,"metaManager",void 0),iY(this,"usageTracker",new Set),iY(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(i){if(this.metaManager.hot.isRtl()&&i==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),fut(this,awe,(i,r,n)=>{if(!n)throw new Error(`The \`${i}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,i)=>{let{initOnly:r,target:n,onChange:o}=e,s=typeof n=="string",a=s?n:i,c=`_${a}`;this.metaManager.globalMeta.meta[c]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(i,c,o),s&&this.installPropWatcher(n,c,o)):r&&(this.installPropWatcher(i,c,vut(awe,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(i))})}installPropWatcher(e,i,r){let n=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[i]},set(o){let s=!n.usageTracker.has(e);n.usageTracker.add(e),r.call(n,e,o,s),this[i]=o},enumerable:!0,configurable:!0})}};var QH="gridDefault",ul="editorManager.handlingEditor";var lwe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}};var Zwi=U($e(),1);var $wi=U(dt(),1);var _ut="hooksRefRegisterer",cwe={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Ce(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Kt(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ra(cwe,"MIXIN_NAME",_ut,{writable:!1,enumerable:!1});var dwe=cwe;function ah(t,e,i){return e=yut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function yut(t){var e=wut(t,"string");return typeof e=="symbol"?e:e+""}function wut(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rY="base",Pn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Tc=class{static get EDITOR_TYPE(){return rY}constructor(e){ah(this,"hot",void 0),ah(this,"state",Pn.VIRGIN),ah(this,"_opened",!1),ah(this,"_fullEditMode",!1),ah(this,"_closeCallback",null),ah(this,"TD",null),ah(this,"row",null),ah(this,"col",null),ah(this,"prop",null),ah(this,"originalValue",null),ah(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,i,r,n,o,s){this.TD=n,this.row=e,this.col=i,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Pn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,i){let r,n,o,s;if(i){let c=this.hot.getSelectedLast();r=Math.max(Math.min(c[0],c[2]),0),n=Math.max(Math.min(c[1],c[3]),0),o=Math.max(c[0],c[2]),s=Math.max(c[1],c[3])}else[r,n,o,s]=[this.row,this.col,null,null];let a=this.hot.runHooks("modifyGetCellCoords",r,n);Array.isArray(a)&&([r,n]=a),this.hot.populateFromArray(r,n,e,o,s,"edit")}beginEditing(e,i){if(this.state!==Pn.VIRGIN)return;let r=this.hot,n=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(n,o)),this.state=Pn.EDITING,this.isInFullEditMode()){let s=typeof e=="string"?e:Vr(this.originalValue);this.setValue(s)}this.open(i),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,i,r){let n;if(r){let o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Pn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Pn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}let o=this.getValue();this.cellProperties.trimWhitespace?n=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:n=[[o]],this.state=Pn.WAITING,this.saveValue(n,i),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Pn.FINISHED,this.discardEditor(s)}):(this.state=Pn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Pn.FINISHED,this.discardEditor()}discardEditor(e){this.state===Pn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Pn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Pn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Pn.WAITING}getEditedCellRect(){var e;let i=this.getEditedCell();if(!i)return;let{wtOverlays:r,wtViewport:n}=this.hot.view._wt,o=this.hot.rootWindow,s=Nn(i),a=Ji(i),c=Nn(this.hot.rootElement),d=Ji(this.hot.rootElement),u=r.topOverlay.holder,h=r.inlineStartOverlay.holder,p=u!==o?u.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-c.left-d,{wtTable:g}=(e=r.getParentOverlay(i))!==null&&e!==void 0?e:this.hot.view._wt,y=g.name,w=["master","inline_start"].includes(y)?p:0,x=["master","top","bottom"].includes(y)?f:0,T=s.top===c.top?0:1,M=s.top-c.top-T-w,B=0;this.hot.isRtl()?B=o.innerWidth-s.left-a-m-1+x:B=s.left-c.left-1-x,["top","top_inline_start_corner"].includes(y)&&(M+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(B+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));let G=this.hot.hasColHeaders(),F=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),O=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),J=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(G&&F<=0||F===J)&&(M+=1),O<=0&&(B+=1);let N=n.rowsRenderCalculator.startPosition,P=n.columnsRenderCalculator.startPosition,$=Math.abs(r.inlineStartOverlay.getScrollPosition()),K=r.topOverlay.getScrollPosition(),ve=mn(this.hot.rootDocument),W=i.offsetTop;if(["inline_start","master"].includes(y)&&(W+=N-K),["bottom","bottom_inline_start_corner"].includes(y)){let{wtViewport:Re,wtTable:Oe}=r.bottomOverlay.clone;W+=Re.getWorkspaceHeight()-Oe.getHeight()-ve}let ee=i.offsetLeft;this.hot.isRtl()?(ee>=0?ee=g.getWidth()-i.offsetLeft:ee=Math.abs(ee),ee+=P-$-a):["top","master","bottom"].includes(y)&&(ee+=P-$);let te=Jd(this.TD,this.hot.rootWindow),se=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Ae=parseInt(te[se],10)>0?0:1,k=parseInt(te.borderTopWidth,10)>0?0:1,S=Ji(i)+Ae,I=ur(i)+k,X=y0e(u)?ve:0,Q=w0e(h)?ve:0,le=this.hot.view.maximumVisibleElementWidth(ee)-X+Ae,xe=Math.max(this.hot.view.maximumVisibleElementHeight(W)-Q+k,23);return{top:M,start:B,height:I,maxHeight:xe,width:S,maxWidth:le}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let e=this.hot.countRows(),i="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?i="top-inline-start-corner":i="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?i="bottom-inline-start-corner":i="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(i="inline-start"),i}};Mi(Tc,dwe);var uwe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,i){let r=t._getEditorManager(),n=r.getActiveEditor();n.isInFullEditMode()&&n.state===Pn.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(i.includes("arrowdown")?t.selection.transformStart(1,0):i.includes("arrowup")?t.selection.transformStart(-1,0):i.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):i.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}};var hwe={name:"editorCloseAndSaveByEnter",callback(t,e){let i=t._getEditorManager();i.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),i.moveSelectionAfterEnter(e)}};var fwe={name:"editorCloseWithoutSaving",callback(t){let e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}};var pwe={name:"editorFastOpen",callback(t,e){let{highlight:i}=t.getSelectedRangeLast();i.isHeader()||t._getEditorManager().openEditor(null,e,!0)}};var mwe={name:"editorOpen",callback(t,e,i){let r=t._getEditorManager(),n=t.getSelectedRangeLast(),{highlight:o}=n;if(t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){let s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;i.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Uo(e))}};function gwe(){return[lwe,uwe,hwe,fwe,pwe,mwe]}var vwe={name:"extendCellsSelectionDown",callback(t){let{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}};var bwe={name:"extendCellsSelectionDownByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),i=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(i,-1);if(r!==null){let n=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(n.row-o,t.countRows()-1);t.selection.setRangeEnd(n),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};var _we={name:"extendCellsSelectionLeft",callback(t){let{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}};var ywe={name:"extendCellsSelectionRight",callback(t){let{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}};var wwe={name:"extendCellsSelectionToColumns",callback(t){let{highlight:e,from:i,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(i.col,r.col,e)}};var Cwe={name:"extendCellsSelectionToMostBottom",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){let a=i.getNearestNotHiddenIndex(t.countRows()-1,-1),c=n.clone();c.row=r.row,e.setRangeStart(c,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}};var xwe={name:"extendCellsSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){let s=i.getNearestNotHiddenIndex(t.countCols()-1,-1),a=n.clone();a.col=r.col,e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s))}}};var Swe={name:"extendCellsSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){let s=parseInt(t.getSettings().fixedColumnsStart,10),a=i.getNearestNotHiddenIndex(s,1),c=n.clone();c.col=r.col,e.setRangeStart(c,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a))}}};var Ewe={name:"extendCellsSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){let a=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),c=n.clone();c.col=r.col,e.setRangeStart(c,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}};var Twe={name:"extendCellsSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){let a=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),c=n.clone();c.col=r.col,e.setRangeStart(c,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}};var Rwe={name:"extendCellsSelectionToMostTop",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){let a=i.getNearestNotHiddenIndex(0,1),c=n.clone();c.row=r.row,e.setRangeStart(c,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}};var Awe={name:"extendCellsSelectionToRows",callback(t){let{highlight:e,from:i,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(i.row,r.row,e)}};var Iwe={name:"extendCellsSelectionUp",callback(t){let{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}};var Dwe={name:"extendCellsSelectionUpByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),i=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(i,1);if(r!==null){let n=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(n.row-o,0);t.selection.setRangeEnd(n),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Mwe(){return[vwe,bwe,_we,ywe,wwe,Cwe,xwe,Swe,Ewe,Twe,Rwe,Awe,Iwe,Dwe]}var kwe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}};var Owe={name:"moveCellSelectionDownByViewportHeight",callback(t){let{navigableHeaders:e}=t.getSettings(),i=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,n=t.countVisibleRows()+i;r===t.countRows()-1?n=1:r+n>t.countRows()&&(n=t.countRows()-r-1),t.selection.transformStart(n,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};var Nwe={name:"moveCellSelectionInlineEnd",callback(t,e){let i=t.getSettings(),r=t.getSelectedRangeLast(),n=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-n.row,-n.col):t.selection.transformStart(-n.row,-n.col)}};var Pwe={name:"moveCellSelectionInlineStart",callback(t,e){let i=t.getSettings(),r=t.getSelectedRangeLast(),n=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(n.row,n.col):t.selection.transformStart(n.row,n.col)}};var Lwe={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}};var Fwe={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}};var Hwe={name:"moveCellSelectionToMostBottom",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),t.selection.setRangeStart(t._createCellCoords(i,e))}};var Bwe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedRowsBottom,10),o=i.getNearestNotHiddenIndex(t.countRows()-n-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}};var Vwe={name:"moveCellSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,i.getNearestNotHiddenIndex(t.countCols()-1,-1)))}};var jwe={name:"moveCellSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),n=t.getSelectedRangeLast().highlight.row,o=i.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(n,o))}};var zwe={name:"moveCellSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,r=t.getSelectedRangeLast().highlight.row,n=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);n===null&&(n=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,n))}};var Wwe={name:"moveCellSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{row:r}=t.getSelectedRangeLast().highlight,n=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);n===null&&(n=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,n))}};var Uwe={name:"moveCellSelectionToMostTop",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(i,e))}};var qwe={name:"moveCellSelectionToMostTopInlineStart",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=i.getNearestNotHiddenIndex(n,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}};var Ywe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}};var $we={name:"moveCellSelectionUpByViewportHight",callback(t){let{navigableHeaders:e}=t.getSettings(),i=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,n=-(t.countVisibleRows()+i);r===-i?n=-1:r+n<i&&(n=-(r+i)),t.selection.transformStart(n,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Gwe(){return[kwe,Owe,Nwe,Pwe,Lwe,Fwe,Hwe,Bwe,Vwe,jwe,zwe,Wwe,Uwe,qwe,Ywe,$we]}var Xwe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}};var Kwe={name:"scrollToFocusedCell",callback(t){let{highlight:e}=t.getSelectedRangeLast(),i=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,n=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(i,r),a=t._createCellCoords(n,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){let d={};if(e.col>=0){let u=Math.floor(t.countVisibleCols()/2);d.col=Math.max(e.col-u,0)}if(e.row>=0){let u=Math.floor(t.countVisibleRows()/2);d.row=Math.max(e.row-u,0)}t.scrollViewportTo(Lt(Ke({},d),{verticalSnap:"top",horizontalSnap:"start"}))}}};var Zwe={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}};var Qwe={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}};var Jwe={name:"populateSelectedCellsData",callback(t){let e=t.getSelectedRange(),{row:i,col:r}=e[e.length-1].highlight.normalize(),n=t.getDataAtCell(i,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,c)=>{if(a>=0&&c>=0&&(a!==i||c!==r)){let{readOnly:d}=t.getCellMeta(a,c);d||o.set(`${a}x${c}`,[a,c,n])}});t.setDataAtCell(Array.from(o.values()))}};var Cut=[...gwe(),...Mwe(),...Gwe(),Xwe,Kwe,Zwe,Qwe,Jwe];function JH(t){let e={};return Cut.forEach(i=>{let{name:r,callback:n}=i;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n(t,...s)}}),e}function eCe(t){let e=t.getShortcutManager().addContext("editor"),i=JH(t),r={group:ul};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(n,o)=>i.editorCloseAndSaveByEnter(n,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(n,o)=>i.editorCloseAndSaveByEnter(n,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(n,o)=>i.editorCloseAndSave(n,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(n,o)=>i.editorCloseAndSaveByArrowKeys(n,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>i.editorCloseWithoutSaving()}],r)}function tCe(t){let e=t.getShortcutManager().addContext("grid"),i=JH(t),r={runOnlyIf:()=>{let{navigableHeaders:n}=t.getSettings();return wt(t.getSelected())&&(n||!n&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:QH};e.addShortcuts([{keys:[["F2"]],callback:n=>i.editorFastOpen(n)},{keys:[["Enter"],["Enter","Shift"]],callback:(n,o)=>i.editorOpen(n,o)},{keys:[["Backspace"],["Delete"]],callback:()=>i.emptySelectedCells()}],{group:ul,runOnlyIf:()=>wt(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>i.selectAllCells(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>t.getSelectedRangeLast().highlight.isHeader(),preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>i.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>i.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>i.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>i.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>i.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>i.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>i.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>i.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>i.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>i.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>i.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>i.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>i.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>i.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>i.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:n=>i.moveCellSelectionInlineStart(n)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:n=>i.moveCellSelectionInlineEnd(n)},{keys:[["Control/Meta","Backspace"]],callback:()=>i.scrollToFocusedCell()}],r)}function iCe(t){[tCe,eCe].forEach(e=>e(t))}function nCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.rootElement,r=rCe(t),n=rCe(t);return r.addEventListener("focus",()=>e?.onFocusFromTop()),n.addEventListener("focus",()=>e?.onFocusFromBottom()),i.firstChild.before(r),i.lastChild.after(n),{activate(){t._registerTimeout(()=>{r.tabIndex=0,n.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,n.tabIndex=-1},10)}}}function rCe(t){let i=t.rootDocument.createElement("input");return i.type="text",i.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ht(i,[Fl(),ta()]),i}function oCe(t){let e=xut(t),i,{activate:r,deactivate:n}=nCe(t,{onFocusFromTop(){var h;let p=(h=e(i))!==null&&h!==void 0?h:nY(t);p&&(t.runHooks("modifyFocusOnTabNavigation","from_above",p),t.selectCell(p.row,p.col)),t.listen()},onFocusFromBottom(){var h;let p=(h=e(i))!==null&&h!==void 0?h:oY(t);p&&(t.runHooks("modifyFocusOnTabNavigation","from_below",p),t.selectCell(p.row,p.col)),t.listen()}}),o={wrapped:!1,flipped:!1},s=!0,a=!1,c=!1;t.addHook("afterListen",()=>n()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,p,f,m,g)=>{if(a&&(o.wrapped&&o.flipped||c)&&(c=!1,g.value=!0),s){var y;i=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,p,f)=>{o.wrapped=!0,o.flipped=f});function d(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}let u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:QH,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([Lt(Ke({},u),{callback:()=>{let{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(c=!0)},position:"before"}),Lt(Ke({},u),{callback:h=>{let{tabNavigation:p,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!p||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(i=h.shiftKey?nY(t):oY(t)),d(),!1;h.preventDefault()},position:"after"})])}function nY(t){let{rowIndexMapper:e,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings(),n=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return n===0&&(n=e.getVisualFromRenderableIndex(n)),o===0&&(o=i.getVisualFromRenderableIndex(o)),n===null||o===null?null:t._createCellCoords(n,o)}function oY(t){var e,i;let{rowIndexMapper:r,columnIndexMapper:n}=t,{navigableHeaders:o}=t.getSettings(),s=r.getRenderableIndexesLength()-1,a=n.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(i=n.getVisualFromRenderableIndex(a))!==null&&i!==void 0?i:a)}function xut(t){return e=>{if(!e)return null;let i=nY(t),r=oY(t);return e.col<i.col&&(e.col=i.col),e.col>r.col&&(e.col=r.col),e.row<i.row&&(e.row=i.row),e.row>r.row&&(e.row=r.row),e}}function sCe(t){return e=>{let{col:i}=e;t.scrollViewportTo({col:i})}}function aCe(){return()=>{}}function lCe(t){return e=>{t.scrollViewportTo(e.toObject())}}function cCe(t){return e=>{t.scrollViewportTo(e.toObject())}}function dCe(t){return e=>{t.scrollViewportTo(e.toObject())}}function uCe(t){return e=>{let{row:i}=e;t.scrollViewportTo({row:i})}}function hCe(t){return e=>{let i=t.selection.getSelectionSource(),{row:r,col:n}=e;if(r<0&&n>=0)t.scrollViewportTo({col:n});else if(n<0&&r>=0)t.scrollViewportTo({row:r});else{if(i==="mouse"&&(n===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:n})}}}function fCe(t){let{selection:e}=t,i=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){i=!0},scrollTo(n){var o;if(i||r){i=!1;return}let s;e.isFocusSelectionChanged()?s=lCe(t):e.isSelectedByCorner()?s=aCe(t):e.isSelectedByRowHeader()?s=uCe(t):e.isSelectedByColumnHeader()?s=sCe(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=cCe(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=hCe(t):e.getSelectedRange().size()>1&&(s=dCe(t)),(o=s)===null||o===void 0||o(n)}}}var eSi=U($e(),1);var D1i=U($e(),1),M1i=U(dt(),1);var C1i=U(ln(),1),x1i=U(cn(),1),S1i=U(dn(),1),E1i=U(un(),1),T1i=U(hn(),1),R1i=U(fn(),1),A1i=U(pn(),1),pCe=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),OM=t=>t.map(e=>{let i=e.toLowerCase();return pCe.has(i)?pCe.get(i):i}).sort().join("+"),gCe=t=>t.split("+"),mCe=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Sut=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),eB=t=>{let{key:e,code:i}=t,r=e;return mCe.test(i)?r=i.replace(mCe,"$1"):Sut.has(i)&&(r=i),r.toLowerCase()};var vCe=Symbol("shortcut-context");function sY(t){return Xt(t)&&t.__kindOf===vCe}var bCe=t=>{let e=Wv({errorIdExists:c=>`The "${c}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:c,callback:d,group:u,runOnlyIf:h=()=>!0,captureCtrl:p=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:g,position:y,forwardToContext:w}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Qi(u))throw new Error("You need to define the shortcut's group.");if(nr(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(Ai`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let x={callback:d,group:u,runOnlyIf:h,captureCtrl:p,preventDefault:f,stopPropagation:m};wt(g)&&(x.relativeToGroup=g,x.position=y),sY(w)&&(x.forwardToContext=w),c.forEach(T=>{let M=OM(T);if(e.hasItem(M)){let G=e.getItem(M),F=G.findIndex(O=>O.group===g);F!==-1?y==="before"?F-=1:F+=1:F=G.length,G.splice(F,0,x)}else e.addItem(M,[x])})},r=function(c){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(u=>{Kt(d,(h,p)=>{Object.prototype.hasOwnProperty.call(u,p)===!1&&(u[p]=d[p])}),i(u)})},n=c=>{let d=OM(c);e.removeItem(d)};return{__kindOf:vCe,addShortcut:i,addShortcuts:r,getShortcuts:c=>{let d=OM(c),u=e.getItem(d);return wt(u)?u.slice():[]},hasShortcut:c=>{let d=OM(c);return e.hasItem(d)},removeShortcutsByKeys:n,removeShortcutsByGroup:c=>{e.getItems().forEach(u=>{let[h,p]=u,f=p.filter(m=>m.group!==c);f.length===0?n(gCe(h)):(p.length=0,p.push(...f))})}}};var $1i=U(dt(),1);var B1i=U(ln(),1),V1i=U(cn(),1),j1i=U(dn(),1),z1i=U(un(),1),W1i=U(hn(),1),U1i=U(fn(),1),q1i=U(pn(),1);function _Ce(){let t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}var Eut=["meta","alt","shift","control"],NM=_Ce(),PM=[],tB=0;function yCe(t,e,i,r,n){let o=f=>Eut.includes(f),s=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=[];return f.altKey&&g.push("alt"),m&&(f.ctrlKey||f.metaKey)?g.push("control/meta"):(f.ctrlKey&&g.push("control"),f.metaKey&&g.push("meta")),f.shiftKey&&g.push("shift"),g},a=f=>{if(e(f)===!1)return;let m=i(f);if(f.keyCode===229||m===!1||Rf(f))return;let g=eB(f),y=[];o(g)||(y=s(f));let w=[g].concat(y);!n(f,w)&&(u1()&&y.includes("meta")||!u1()&&y.includes("control"))&&n(f,[g].concat(s(f,!0))),r(f)},c=f=>{if(f.key){let m=eB(f);o(m)&&NM.press(m)}},d=f=>{if(f.key){let m=eB(f);o(m)&&NM.release(m)}},u=()=>{NM.releaseAll()};return{mount:()=>{let f=t;for(tB+=1;f;)tB===1&&(f.document.documentElement.addEventListener("keydown",c),PM.push({event:"keydown",listener:c}),f.document.documentElement.addEventListener("keyup",d),PM.push({event:"keyup",listener:d})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",u),f=Ef(f)},unmount:()=>{let f=t;for(tB-=1;f;){if(tB===0){for(let m=0;m<PM.length;m++){let{event:g,listener:y}=PM[m];f.document.documentElement.removeEventListener(g,y)}PM.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",u),f=Ef(f)}},isPressed:f=>NM.isPressed(f),releasePressedKeys:()=>NM.releaseAll()}}var aY=t=>{let{ownerWindow:e,handleEvent:i,beforeKeyDown:r,afterKeyDown:n}=t,o=Wv({errorIdExists:m=>`The "${m}" context name is already registered.`}),s="grid",a=m=>{let g=bCe(m);return o.addItem(m,g),g},c=()=>s,d=m=>o.getItem(m),u=m=>{if(!o.hasItem(m))throw new Error(Ai`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=m},h=!1,p=function(m,g){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c(),w=sY(y)?y:d(y),x=!1;if(!w.hasShortcut(g))return x;let T=w.getShortcuts(g);for(let M=0;M<T.length;M++){let{callback:B,runOnlyIf:G,preventDefault:F,stopPropagation:O,captureCtrl:V,forwardToContext:J}=T[M];if(G(m)===!0){if(h=V,x=B(m,g)===!1,h=!1,F&&m.preventDefault(),O&&(Uo(m),m.stopPropagation()),x)break;J&&p(m,g,J)}}return x},f=yCe(e,i,r,n,p);return f.mount(),{addContext:a,getActiveContextName:c,getContext:d,setActiveContextName:u,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};var lY=null,cY=new Map;function iB(t,e){var i,r=this;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this,s=new cs(o),a,c,d,u,h,p,f=!0;dye(n)&&cye(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let m=(i=e?.layoutDirection)!==null&&i!==void 0?i:"inherit",g=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",g),this.isRtl=function(){return g==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=kye(e.language);let y=new H1(o,e,[MM,kM]),w=y.getTableMeta(),x=y.getGlobalMeta(),T=Wv();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),A1(this)&&zbe(e.licenseKey,t),this.guid=`ht_${a5()}`,cY.set(this.guid,this),this.columnIndexMapper=new ty,this.rowIndexMapper=new ty,this.columnIndexMapper.addLocalHook("indexesSequenceChange",k=>{o.runHooks("afterColumnSequenceChange",k)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",k=>{o.runHooks("afterRowSequenceChange",k)}),c=new bye(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);let M=k=>{let{row:S,col:I}=k;return o._createCellCoords(S>=0?o.rowIndexMapper.getRenderableFromVisualIndex(S):S,I>=0?o.columnIndexMapper.getRenderableFromVisualIndex(I):I)},B=k=>{let{row:S,col:I}=k;return o._createCellCoords(S>=0?o.rowIndexMapper.getVisualFromRenderableIndex(S):S,I>=0?o.columnIndexMapper.getVisualFromRenderableIndex(I):I)},G=(k,S)=>{let I=S>k?1:-1,X=Math.min(k,S),Q=Math.max(k,S),le=o.rowIndexMapper.getNearestNotHiddenIndex(k,I);return le===null||I===1&&le>Q||I===-1&&le<X?null:le>=0?o.rowIndexMapper.getRenderableFromVisualIndex(le):le},F=(k,S)=>{let I=S>k?1:-1,X=Math.min(k,S),Q=Math.max(k,S),le=o.columnIndexMapper.getNearestNotHiddenIndex(k,I);return le===null||I===1&&le>Q||I===-1&&le<X?null:le>=0?o.columnIndexMapper.getRenderableFromVisualIndex(le):le},O=new Q9(w,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:k=>a.propToCol(k),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(k,S)=>o._createCellCoords(k,S),createCellRange:(k,S,I)=>o._createCellRange(k,S,I),visualToRenderableCoords:M,renderableToVisualCoords:B,findFirstNonHiddenRenderableRow:G,findFirstNonHiddenRenderableColumn:F,isDisabledCellSelection:(k,S)=>k<0||S<0?o.getSettings().disableVisualSelection:o.getCellMeta(k,S).disableVisualSelection});this.selection=O;let V=k=>{let{hiddenIndexesChanged:S}=k;S&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("afterSetRangeEnd",(k,S)=>{let I=sl(!1),X=this.selection.getSelectedRange(),{from:Q,to:le}=X.current(),xe=X.size()-1;this.runHooks("afterSelection",Q.row,Q.col,le.row,le.col,I,xe),this.runHooks("afterSelectionByProp",Q.row,o.colToProp(Q.col),le.row,o.colToProp(le.col),I,xe),S&&(!I.isTouched()||I.isTouched()&&!I.value)&&p.scrollTo(k);let Re=O.isSelectedByRowHeader(),Oe=O.isSelectedByColumnHeader();Re&&Oe?Qe(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Re?(Gt(this.rootElement,"ht__selection--columns"),Qe(this.rootElement,"ht__selection--rows")):Oe?(Gt(this.rootElement,"ht__selection--rows"),Qe(this.rootElement,"ht__selection--columns")):Gt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),O.getSelectionSource()!=="shift"&&u.closeEditor(null),o.view.render(),u.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",k=>{this.runHooks("beforeSelectionFocusSet",k.row,k.col)}),this.selection.addLocalHook("afterSetFocus",k=>{let S=sl(!1);this.runHooks("afterSelectionFocusSet",k.row,k.col,S),(!S.isTouched()||S.isTouched()&&!S.value)&&p.scrollTo(k),u.closeEditor(),o.view.render(),u.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",k=>{let S=k.length-1,{from:I,to:X}=k[S];this.runHooks("afterSelectionEnd",I.row,I.col,X.row,X.col,S),this.runHooks("afterSelectionEndByProp",I.row,o.colToProp(I.col),X.row,o.colToProp(X.col),S)}),this.selection.addLocalHook("afterIsMultipleSelection",k=>{let S=this.runHooks("afterIsMultipleSelection",k.value);k.value&&(k.value=S)}),this.selection.addLocalHook("afterDeselect",()=>{u.closeEditor(),o.view.render(),Gt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("beforeSetRangeStart",...S)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("beforeSetRangeStartOnly",...S)}).addLocalHook("beforeSetRangeEnd",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("beforeSetRangeEnd",...S)}).addLocalHook("beforeSelectColumns",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("beforeSelectColumns",...S)}).addLocalHook("afterSelectColumns",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("afterSelectColumns",...S)}).addLocalHook("beforeSelectRows",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("beforeSelectRows",...S)}).addLocalHook("afterSelectRows",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("afterSelectRows",...S)}).addLocalHook("beforeModifyTransformStart",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("modifyTransformStart",...S)}).addLocalHook("afterModifyTransformStart",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("afterModifyTransformStart",...S)}).addLocalHook("beforeModifyTransformFocus",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("modifyTransformFocus",...S)}).addLocalHook("afterModifyTransformFocus",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("afterModifyTransformFocus",...S)}).addLocalHook("beforeModifyTransformEnd",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("modifyTransformEnd",...S)}).addLocalHook("afterModifyTransformEnd",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("afterModifyTransformEnd",...S)}).addLocalHook("beforeRowWrap",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("beforeRowWrap",...S)}).addLocalHook("beforeColumnWrap",function(){for(var k=arguments.length,S=new Array(k),I=0;I<k;I++)S[I]=arguments[I];return r.runHooks("beforeColumnWrap",...S)}).addLocalHook("insertRowRequire",k=>this.alter("insert_row_above",k,1,"auto")).addLocalHook("insertColRequire",k=>this.alter("insert_col_start",k,1,"auto")),d={alter(k,S){var I,X;let Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,le=arguments.length>3?arguments[3]:void 0,xe=arguments.length>4?arguments[4]:void 0,Re=Oe=>{if(Oe.length===0)return[];let We=[...Oe];return We.sort((Ne,it)=>{let[ct]=Ne,[Ue]=it;return ct===Ue?0:ct>Ue?1:-1}),Gr(We,(Ne,it)=>{let[ct,Ue]=it,Se=Ne[Ne.length-1],[gt,ce]=Se,de=gt+ce;if(ct<=de){let ye=Math.max(Ue-(de-ct),0);Se[1]+=ye}else Ne.push([ct,Ue]);return Ne},[We[0]])};switch(k){case"insert_row_below":case"insert_row_above":let Oe=o.countSourceRows();if(w.maxRows===Oe)return;let We=k==="insert_row_below"?"below":"above";S=(I=S)!==null&&I!==void 0?I:We==="below"?Oe:0;let{delta:Le,startPhysicalIndex:Ne}=a.createRow(S,Q,{source:le,mode:We});O.shiftRows(o.toVisualRow(Ne),Le);break;case"insert_col_start":case"insert_col_end":let it=k==="insert_col_end"?"end":"start";S=(X=S)!==null&&X!==void 0?X:it==="end"?o.countSourceCols():0;let{delta:ct,startPhysicalIndex:Ue}=a.createCol(S,Q,{source:le,mode:it});if(ct){if(Array.isArray(w.colHeaders)){let ce=[o.toVisualColumn(Ue),0];ce.length+=ct,Array.prototype.splice.apply(w.colHeaders,ce)}O.shiftColumns(o.toVisualColumn(Ue),ct)}break;case"remove_row":let Se=ce=>{let de=0;Ce(ce,ye=>{let[Me,pe]=ye,ue=jr(Me)?o.countRows()-1:Math.max(Me-de,0);if(Number.isInteger(Me)&&(Me=Math.max(Me-de,0)),!a.removeRow(Me,pe,le))return;if(O.isSelected()){let{row:fe}=o.getSelectedRangeLast().highlight;fe>=Me&&fe<=Me+pe-1&&u.closeEditor(!0)}let L=o.countRows();L===0?O.deselect():le==="ContextMenu.removeRow"?O.refresh():O.shiftRows(Me,-pe);let Y=w.fixedRowsTop;Y>=ue+1&&(w.fixedRowsTop-=Math.min(pe,Y-ue));let Z=w.fixedRowsBottom;Z&&ue>=L-Z&&(w.fixedRowsBottom-=Math.min(pe,Z)),de+=pe})};Array.isArray(S)?Se(Re(S)):Se([[S,Q]]);break;case"remove_col":let gt=ce=>{let de=0;Ce(ce,ye=>{let[Me,pe]=ye,ue=jr(Me)?o.countCols()-1:Math.max(Me-de,0),A=o.toPhysicalColumn(ue);if(Number.isInteger(Me)&&(Me=Math.max(Me-de,0)),!a.removeCol(Me,pe,le))return;if(O.isSelected()){let{col:fe}=o.getSelectedRangeLast().highlight;fe>=Me&&fe<=Me+pe-1&&u.closeEditor(!0)}o.countCols()===0?O.deselect():le==="ContextMenu.removeColumn"?O.refresh():O.shiftColumns(Me,-pe);let Z=w.fixedColumnsStart;Z>=ue+1&&(w.fixedColumnsStart-=Math.min(pe,Z-ue)),Array.isArray(w.colHeaders)&&(typeof A>"u"&&(A=-1),w.colHeaders.splice(A,pe)),de+=pe})};Array.isArray(S)?gt(Re(S)):gt([[S,Q]]);break;default:throw new Error(`There is no such action "${k}"`)}o.view.render(),xe||d.adjustRowsAndCols()},adjustRowsAndCols(){let k=w.minRows,S=w.minSpareRows,I=w.minCols,X=w.minSpareCols;if(k){let Q=o.countRows();Q<k&&a.createRow(Q,k-Q,{source:"auto"})}if(S){let Q=o.countEmptyRows(!0);if(Q<S){let le=S-Q,xe=Math.min(le,w.maxRows-o.countSourceRows());a.createRow(o.countRows(),xe,{source:"auto"})}}{let Q;(I||X)&&(Q=o.countEmptyCols(!0));let le=o.countCols();if(I&&!w.columns&&le<I){let xe=I-le;Q+=xe,a.createCol(le,xe,{source:"auto"})}if(X&&!w.columns&&o.dataType==="array"&&Q<X){le=o.countCols();let xe=X-Q,Re=Math.min(xe,w.maxCols-le);a.createCol(le,Re,{source:"auto"})}}o.view&&o.view.adjustElementsSize()},populateFromArray(k,S,I,X,Q){let le,xe,Re,Oe,We=[],Le={},Ne=[],it=k.row,ct=k.col;if(xe=S.length,xe===0)return!1;let Ue=0,Se=0;switch(Xt(I)&&(Ue=I.col-ct+1,Se=I.row-it+1),Q){case"shift_down":let gt=Zx(S),ce=gt.length,de=Math.max(ce,Ue),ye=o.getData().slice(it),Me=Zx(ye).slice(ct,ct+de);for(Re=0;Re<de;Re+=1)if(Re<ce){for(le=0,xe=gt[Re].length;le<Se-xe;le+=1)gt[Re].push(gt[Re][le%xe]);Re<Me.length?Ne.push(gt[Re].concat(Me[Re])):Ne.push(gt[Re].concat(new Array(ye.length).fill(null)))}else Ne.push(gt[Re%ce].concat(Me[Re]));o.populateFromArray(it,ct,Zx(Ne));break;case"shift_right":let pe=S.length,ue=Math.max(pe,Se),A=o.getData().slice(it).map(ze=>ze.slice(ct));for(le=0;le<ue;le+=1)if(le<pe){for(Re=0,Oe=S[le].length;Re<Ue-Oe;Re+=1)S[le].push(S[le][Re%Oe]);if(le<A.length)for(let ze=0;ze<A[le].length;ze+=1)S[le].push(A[le][ze]);else S[le].push(...new Array(A[0].length).fill(null))}else S.push(S[le%xe].slice(0,ue).concat(A[le]));o.populateFromArray(it,ct,S);break;case"overwrite":default:Le.row=k.row,Le.col=k.col;let L=0,Y=0,Z=!0,fe,we=function(rt){let yt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,st=S[rt%S.length];return yt!==null?st[yt%st.length]:st},ke=S.length,Ie=I?I.row-k.row+1:0;for(I?xe=Ie:xe=Math.max(ke,Ie),le=0;le<xe&&!(I&&Le.row>I.row&&Ie>ke||!w.allowInsertRow&&Le.row>o.countRows()-1||Le.row>=w.maxRows);le++){let ze=le-L,rt=we(ze).length,yt=I?I.col-k.col+1:0;if(I?Oe=yt:Oe=Math.max(rt,yt),Le.col=k.col,fe=o.getCellMeta(Le.row,Le.col),(X==="CopyPaste.paste"||X==="Autofill.fill")&&fe.skipRowOnPaste){L+=1,Le.row+=1,xe+=1;continue}for(Y=0,Re=0;Re<Oe&&!(I&&Le.col>I.col&&yt>rt||!w.allowInsertColumn&&Le.col>o.countCols()-1||Le.col>=w.maxCols);Re++){if(fe=o.getCellMeta(Le.row,Le.col),(X==="CopyPaste.paste"||X==="Autofill.fill")&&fe.skipColumnOnPaste){Y+=1,Le.col+=1,Oe+=1;continue}if(fe.readOnly&&X!=="UndoRedo.undo"){Le.col+=1;continue}let st=Re-Y,vt=we(ze,st),di=o.getDataAtCell(Le.row,Le.col);if(vt!==null&&typeof vt=="object")if(Array.isArray(vt)&&di===null&&(di=[]),di===null||typeof di!="object")Z=!1;else{let fi=W_(Array.isArray(di)?di:di[0]||di),fo=W_(Array.isArray(vt)?vt:vt[0]||vt);s1(fi,fo)||Array.isArray(fi)&&Array.isArray(fo)?vt=Wo(vt):Z=!1}else di!==null&&typeof di=="object"&&(Z=!1);Z&&We.push([Le.row,Le.col,vt]),Z=!0,Le.col+=1}Le.row+=1}o.setDataAtCell(We,null,null,X||"populateFromArray");break}}};function J(k){let S=LH(k);HH(S)?(o.runHooks("beforeLanguageChange",S),x.language=S,o.runHooks("afterLanguageChange",S)):FH(k)}function N(k,S){let I=k==="className"?o.rootElement:o.table;if(f)Qe(I,S);else{let X=[],Q=[];x[k]&&(X=Array.isArray(x[k])?x[k]:v7(x[k])),S&&(Q=Array.isArray(S)?S:v7(S));let le=g7(X,Q),xe=g7(Q,X);le.length&&Gt(I,le),xe.length&&Qe(I,xe)}x[k]=S}this.init=function(){c.setData(w.data),o.runHooks("beforeInit"),(rd()||A5())&&Qe(o.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new fye(this),u=J0e.getInstance(o,w,O),p=fCe(o),h=new F5(o),A1(this)&&oCe(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&o.rootElement.offsetParent===null&&C0e(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function P(){let k=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,k=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&k===!1&&(k=!0,this.onQueueEmpty(this.valid))}}}function $(k){let S=k.replace(",",".");return isNaN(parseFloat(S))===!1?parseFloat(S):k}function K(k,S,I){if(!k.length)return;let X=o.getActiveEditor(),Q=new P,le=!0;Q.onQueueEmpty=xe=>{X&&le&&X.cancelChanges(),I(xe)};for(let xe=k.length-1;xe>=0;xe--){let[Re,Oe,,We]=k[xe],Le=a.propToCol(Oe),Ne;Number.isInteger(Le)?Ne=o.getCellMeta(Re,Le):Ne=Ke(Ke({},Object.getPrototypeOf(w)),w),Ne.type==="numeric"&&typeof We=="string"&&a_e(We)&&(k[xe][3]=$(We)),o.getCellValidator(Ne)&&(Q.addValidatorToQueue(),o.validateCell(k[xe][3],Ne,function(it,ct){return function(Ue){if(typeof Ue!="boolean")throw new Error("Validation error: result is not boolean");if(Ue===!1&&ct.allowInvalid===!1){le=!1,k.splice(it,1),ct.valid=!0;let Se=o.getCell(ct.visualRow,ct.visualCol);Se!==null&&Gt(Se,w.invalidCellClassName)}Q.removeValidatorFormQueue()}}(xe,Ne),S))}Q.checkIfQueueIsEmpty()}function ve(k,S){let I=k.length-1;if(I<0)return;for(;I>=0;I--){let Q=!1;if(k[I]===null){k.splice(I,1);continue}if(!((k[I][2]===null||k[I][2]===void 0)&&(k[I][3]===null||k[I][3]===void 0))){if(w.allowInsertRow)for(;k[I][0]>o.countRows()-1;){let{delta:le}=a.createRow(void 0,void 0,{source:S});if(le===0){Q=!0;break}}if(o.dataType==="array"&&(!w.columns||w.columns.length===0)&&w.allowInsertColumn)for(;a.propToCol(k[I][1])>o.countCols()-1;){let{delta:le}=a.createCol(void 0,void 0,{source:S});if(le===0){Q=!0;break}}Q||a.set(k[I][0],k[I][1],k[I][3])}}o.forceFullRender=!0,d.adjustRowsAndCols(),o.runHooks("beforeChangeRender",k,S),u.closeEditor(),o.view.render(),u.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",k,S||"edit");let X=o.getActiveEditor();X&&wt(X.refreshValue)&&X.refreshValue()}this._createCellCoords=function(k,S){return o.view._wt.createCellCoords(k,S)},this._createCellRange=function(k,S,I){return o.view._wt.createCellRange(k,S,I)},this.validateCell=function(k,S,I,X){let Q=o.getCellValidator(S);function le(xe){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||S.hidden===!0){I(xe);return}let Oe=S.visualCol,We=S.visualRow,Le=o.getCell(We,Oe,!0);if(Le&&Le.nodeName!=="TH"){let Ne=o.rowIndexMapper.getRenderableFromVisualIndex(We),it=o.columnIndexMapper.getRenderableFromVisualIndex(Oe);o.view._wt.getSetting("cellRenderer",Ne,it,Le)}I(xe)}jbe(Q)&&(Q=function(xe){return function(Re,Oe){Oe(xe.test(Re))}}(Q)),nr(Q)?(k=o.runHooks("beforeValidate",k,S.visualRow,S.prop,X),o._registerImmediate(()=>{Q.call(S,k,xe=>{o&&(xe=o.runHooks("afterValidate",xe,k,S.visualRow,S.prop,X),S.valid=xe,le(xe),o.runHooks("postAfterValidate",xe,k,S.visualRow,S.prop,X))})})):o._registerImmediate(()=>{S.valid=!0,le(S.valid,!1)})};function W(k,S,I){return Array.isArray(k)?k:[[k,S,I]]}function ee(k,S){let I=o.getActiveEditor(),X=o.runHooks("beforeChange",k,S||"edit"),Q=k.filter(le=>le!==null);return X===!1||Q.length===0?(I&&I.cancelChanges(),[]):Q}this.setDataAtCell=function(k,S,I,X){let Q=W(k,S,I),le=[],xe=X,Re,Oe,We;for(Re=0,Oe=Q.length;Re<Oe;Re++){if(typeof Q[Re]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Q[Re][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Q[Re][1]>=this.countCols()?We=Q[Re][1]:We=a.colToProp(Q[Re][1]),le.push([Q[Re][0],We,c.getAtCell(this.toPhysicalRow(Q[Re][0]),Q[Re][1]),Q[Re][2]])}!xe&&typeof k=="object"&&(xe=S);let Le=ee(le,X);o.runHooks("afterSetDataAtCell",Le,xe),K(Le,xe,()=>{ve(Le,xe)})},this.setDataAtRowProp=function(k,S,I,X){let Q=W(k,S,I),le=[],xe=X,Re,Oe;for(Re=0,Oe=Q.length;Re<Oe;Re++)le.push([Q[Re][0],Q[Re][1],c.getAtCell(this.toPhysicalRow(Q[Re][0]),Q[Re][1]),Q[Re][2]]);!xe&&typeof k=="object"&&(xe=S);let We=ee(le,X);o.runHooks("afterSetDataAtRowProp",We,xe),K(We,xe,()=>{ve(We,xe)})},this.listen=function(){o&&!o.isListening()&&(cY.forEach(k=>{o!==k&&k.unlisten()}),lY=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(lY=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return lY===o.guid},this.destroyEditor=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.closeEditor(k),o.view.render(),S&&O.isSelected()&&u.prepareEditor()},this.populateFromArray=function(k,S,I,X,Q,le,xe){if(!(typeof I=="object"&&typeof I[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");let Re=typeof X=="number"?o._createCellCoords(X,Q):null;return d.populateFromArray(o._createCellCoords(k,S),I,Re,le,xe)},this.spliceCol=function(k,S,I){for(var X=arguments.length,Q=new Array(X>3?X-3:0),le=3;le<X;le++)Q[le-3]=arguments[le];return a.spliceCol(k,S,I,...Q)},this.spliceRow=function(k,S,I){for(var X=arguments.length,Q=new Array(X>3?X-3:0),le=3;le<X;le++)Q[le-3]=arguments[le];return a.spliceRow(k,S,I,...Q)},this.getSelected=function(){if(O.isSelected())return ri(O.getSelectedRange(),k=>{let{from:S,to:I}=k;return[S.row,S.col,I.row,I.col]})},this.getSelectedLast=function(){let k=this.getSelected(),S;return k&&k.length>0&&(S=k[k.length-1]),S},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){let k=this.getSelectedRange(),S;return k&&k.length>0&&(S=k[k.length-1]),S},this.emptySelectedCells=function(k){if(!O.isSelected()||this.countRows()===0||this.countCols()===0)return;let S=[];Ce(O.getSelectedRange(),I=>{if(I.isSingleHeader())return;let X=I.getTopStartCorner(),Q=I.getBottomEndCorner();_t(X.row,Q.row,le=>{_t(X.col,Q.col,xe=>{this.getCellMeta(le,xe).readOnly||S.push([le,xe,null])})})}),S.length>0&&this.setDataAtCell(S,k)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let k=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(k,0),!this.isRenderSuspended()&&k===this.renderSuspendedCounter&&(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(k){this.suspendRender();let S=k();return this.resumeRender(),S},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(S,0),(!this.isExecutionSuspended()&&S===this.executionSuspendedCounter||k)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(k){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();let I=k();return this.resumeExecution(S),I},this.batch=function(k){this.suspendRender(),this.suspendExecution();let S=k();return this.resumeExecution(),this.resumeRender(),S},this.refreshDimensions=function(){if(!o.view)return;let{width:k,height:S}=o.view.getLastSize(),{width:I,height:X}=o.rootElement.getBoundingClientRect(),Q=I!==k||X!==S;o.runHooks("beforeRefreshDimensions",{width:k,height:S},{width:I,height:X},Q)!==!1&&((Q||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(I,X),o.render()),o.runHooks("afterRefreshDimensions",{width:k,height:S},{width:I,height:X},Q))},this.updateData=function(k,S){ZH(k,I=>{a=I},I=>{a=I,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),d.adjustRowsAndCols(),O.refresh()},{hotInstance:o,dataMap:a,dataSource:c,internalSource:"updateData",source:S,metaManager:y,firstRun:f})},this.loadData=function(k,S){ZH(k,I=>{a=I},()=>{y.clearCellsCache(),o.initIndexMappers(),d.adjustRowsAndCols(),O.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:c,internalSource:"loadData",source:S,metaManager:y,firstRun:f})},this.getInitialColumnCount=function(){let k=w.columns,S=0;if(Array.isArray(k))S=k.length;else if(nr(k))if(o.dataType==="array"){let I=this.countSourceCols();for(let X=0;X<I;X+=1)k(X)&&(S+=1)}else(o.dataType==="object"||o.dataType==="function")&&(S=a.colToPropCache.length);else if(wt(w.dataSchema)){let I=a.getSchema();S=Array.isArray(I)?I.length:a1(I)}else S=this.countSourceCols();return S},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(k,S,I,X){return Qi(k)?a.getAll():a.getRange(o._createCellCoords(k,S),o._createCellCoords(I,X),a.DESTINATION_RENDERER)},this.getCopyableText=function(k,S,I,X){return a.getCopyableText(o._createCellCoords(k,S),o._createCellCoords(I,X))},this.getCopyableData=function(k,S){return a.getCopyable(k,a.colToProp(S))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(k){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=(f?o.loadData:o.updateData).bind(this),X=!1,Q,le;if(wt(k.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(wt(k.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(wt(k.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(Q in k)Q==="data"||(Q==="language"?J(k.language):Q==="className"?N("className",k.className):Q==="tableClassName"&&o.table?(N("tableClassName",k.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):Ct.getSingleton().isRegistered(Q)||Ct.getSingleton().isDeprecated(Q)?(nr(k[Q])||Array.isArray(k[Q]))&&(k[Q].initialHook=!0,o.addHook(Q,k[Q])):!S&&Pr(k,Q)&&(x[Q]=k[Q]));k.data===void 0&&w.data===void 0?I(null,"updateSettings"):k.data!==void 0?I(k.data,"updateSettings"):k.columns!==void 0&&(a.createMap(),o.initIndexMappers());let xe=o.countCols(),Re=w.columns;if(Re&&nr(Re)&&(X=!0),(k.cell!==void 0||k.cells!==void 0||k.columns!==void 0)&&y.clearCache(),xe>0)for(Q=0,le=0;Q<xe;Q++){if(Re){let Le=X?Re(Q):Re[le];Le&&y.updateColumnMeta(le,Le)}le+=1}wt(k.cell)&&Kt(k.cell,Le=>{o.setCellMetaObject(Le.row,Le.col,Le)}),o.runHooks("afterCellMetaReset");let Oe=o.rootElement.style.height;Oe!==""&&(Oe=parseInt(o.rootElement.style.height,10));let We=k.height;if(nr(We)&&(We=We()),S&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),We===null){let Le=o.rootElement.getAttribute("data-initialstyle");Le&&(Le.indexOf("height")>-1||Le.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",Le):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else We!==void 0&&(o.rootElement.style.height=isNaN(We)?`${We}`:`${We}px`,o.rootElement.style.overflow="hidden");if(typeof k.width<"u"){let Le=k.width;nr(Le)&&(Le=Le()),o.rootElement.style.width=isNaN(Le)?`${Le}`:`${Le}px`}S||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",k)),d.adjustRowsAndCols(),o.view&&!f&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),!S&&o.view&&(Oe===""||We===""||We===void 0)&&Oe!==We&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let k=o.getSelectedLast();if(w.getValue){if(nr(w.getValue))return w.getValue.call(o);if(k)return o.getData()[k[0][0]][w.getValue]}else if(k)return o.getDataAtCell(k[0],k[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(k,S,I,X,Q){d.alter(k,S,I,X,Q)},this.getCell=function(k,S){let I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,X=S,Q=k;if(S>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(S)))return null;X=this.columnIndexMapper.getRenderableFromVisualIndex(S)}if(k>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(k)))return null;Q=this.rowIndexMapper.getRenderableFromVisualIndex(k)}return Q===null||X===null||Q===void 0||X===void 0?null:o.view.getCellAtCoords(o._createCellCoords(Q,X),I)},this.getCoords=function(k){let S=this.view._wt.wtTable.getCoords(k);if(S===null)return null;let{row:I,col:X}=S,Q=I,le=X;return I>=0&&(Q=this.rowIndexMapper.getVisualFromRenderableIndex(I)),X>=0&&(le=this.columnIndexMapper.getVisualFromRenderableIndex(X)),o._createCellCoords(Q,le)},this.colToProp=function(k){return a.colToProp(k)},this.propToCol=function(k){return a.propToCol(k)},this.toVisualRow=k=>this.rowIndexMapper.getVisualFromPhysicalIndex(k),this.toVisualColumn=k=>this.columnIndexMapper.getVisualFromPhysicalIndex(k),this.toPhysicalRow=k=>this.rowIndexMapper.getPhysicalFromVisualIndex(k),this.toPhysicalColumn=k=>this.columnIndexMapper.getPhysicalFromVisualIndex(k),this.getDataAtCell=function(k,S){return a.get(k,a.colToProp(S))},this.getDataAtRowProp=function(k,S){return a.get(k,S)},this.getDataAtCol=function(k){let S=[],I=a.getRange(o._createCellCoords(0,k),o._createCellCoords(w.data.length-1,k),a.DESTINATION_RENDERER);for(let X=0;X<I.length;X+=1)for(let Q=0;Q<I[X].length;Q+=1)S.push(I[X][Q]);return S},this.getDataAtProp=function(k){let S=[],I=a.getRange(o._createCellCoords(0,a.propToCol(k)),o._createCellCoords(w.data.length-1,a.propToCol(k)),a.DESTINATION_RENDERER);for(let X=0;X<I.length;X+=1)for(let Q=0;Q<I[X].length;Q+=1)S.push(I[X][Q]);return S},this.getSourceData=function(k,S,I,X){let Q;return k===void 0?Q=c.getData():Q=c.getByRange(o._createCellCoords(k,S),o._createCellCoords(I,X)),Q},this.getSourceDataArray=function(k,S,I,X){let Q;return k===void 0?Q=c.getData(!0):Q=c.getByRange(o._createCellCoords(k,S),o._createCellCoords(I,X),!0),Q},this.getSourceDataAtCol=function(k){return c.getAtColumn(k)},this.setSourceDataAtCell=function(k,S,I,X){let Q=W(k,S,I),le=this.hasHook("afterSetSourceDataAtCell"),xe=[];le&&Ce(Q,Oe=>{let[We,Le,Ne]=Oe;xe.push([We,Le,c.getAtCell(We,Le),Ne])}),Ce(Q,Oe=>{let[We,Le,Ne]=Oe;c.setAtCell(We,Le,Ne)}),le&&this.runHooks("afterSetSourceDataAtCell",xe,X),this.render();let Re=o.getActiveEditor();Re&&wt(Re.refreshValue)&&Re.refreshValue()},this.getSourceDataAtRow=function(k){return c.getAtRow(k)},this.getSourceDataAtCell=function(k,S){return c.getAtCell(k,S)},this.getDataAtRow=function(k){return a.getRange(o._createCellCoords(k,0),o._createCellCoords(k,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(k,S,I,X){let Q=k===void 0?[0,0,this.countRows(),this.countCols()]:[k,S,I,X],[le,xe]=Q,[,,Re,Oe]=Q,We=null,Le=null;Re===void 0&&(Re=le),Oe===void 0&&(Oe=xe);let Ne="mixed";return _t(Math.max(Math.min(le,Re),0),Math.max(le,Re),it=>{let ct=!0;return _t(Math.max(Math.min(xe,Oe),0),Math.max(xe,Oe),Ue=>(Le=this.getCellMeta(it,Ue).type,We?ct=We===Le:We=Le,ct)),Ne=ct?Le:"mixed",ct}),Ne},this.removeCellMeta=function(k,S,I){let[X,Q]=[this.toPhysicalRow(k),this.toPhysicalColumn(S)],le=y.getCellMetaKeyValue(X,Q,I);o.runHooks("beforeRemoveCellMeta",k,S,I,le)!==!1&&(y.removeCellMeta(X,Q,I),o.runHooks("afterRemoveCellMeta",k,S,I,le)),le=null},this.spliceCellsMeta=function(k){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var I=arguments.length,X=new Array(I>2?I-2:0),Q=2;Q<I;Q++)X[Q-2]=arguments[Q];if(X.length>0&&!Array.isArray(X[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");S>0&&y.removeRow(this.toPhysicalRow(k),S),X.length>0&&Ce(X.reverse(),le=>{y.createRow(this.toPhysicalRow(k)),Ce(le,(xe,Re)=>this.setCellMetaObject(k,Re,xe))}),o.render()},this.setCellMetaObject=function(k,S,I){typeof I=="object"&&Kt(I,(X,Q)=>{this.setCellMeta(k,S,Q,X)})},this.setCellMeta=function(k,S,I,X){if(o.runHooks("beforeSetCellMeta",k,S,I,X)===!1)return;let le=k,xe=S;k<this.countRows()&&(le=this.toPhysicalRow(k)),S<this.countCols()&&(xe=this.toPhysicalColumn(S)),y.setCellMeta(le,xe,I,X),o.runHooks("afterSetCellMeta",k,S,I,X)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(k,S){let I=this.toPhysicalRow(k),X=this.toPhysicalColumn(S);return I===null&&(I=k),X===null&&(X=S),y.getCellMeta(I,X,{visualRow:k,visualColumn:S})},this.getCellMetaAtRow=function(k){return y.getCellsMetaAtRow(k)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||w.columns)},this.getCellRenderer=function(k,S){let I=typeof k=="number"?o.getCellMeta(k,S).renderer:k.renderer;return typeof I=="string"?K7(I):Qi(I)?K7("text"):I},this.getCellEditor=function(k,S){let I=typeof k=="number"?o.getCellMeta(k,S).editor:k.editor;return typeof I=="string"?F7(I):Qi(I)?F7("text"):I},this.getCellValidator=function(k,S){let I=typeof k=="number"?o.getCellMeta(k,S).validator:k.validator;return typeof I=="string"?p_e(I):I},this.validateCells=function(k){this._validateCells(k)},this.validateRows=function(k,S){if(!Array.isArray(k))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(S,k)},this.validateColumns=function(k,S){if(!Array.isArray(k))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(S,void 0,k)},this._validateCells=function(k,S,I){let X=new P;k&&(X.onQueueEmpty=k);let Q=o.countRows()-1;for(;Q>=0;){if(S!==void 0&&S.indexOf(Q)===-1){Q-=1;continue}let le=o.countCols()-1;for(;le>=0;){if(I!==void 0&&I.indexOf(le)===-1){le-=1;continue}X.addValidatorToQueue(),o.validateCell(o.getDataAtCell(Q,le),o.getCellMeta(Q,le),xe=>{if(typeof xe!="boolean")throw new Error("Validation error: result is not boolean");xe===!1&&(X.valid=!1),X.removeValidatorFormQueue()},"validateCells"),le-=1}Q-=1}X.checkIfQueueIsEmpty()},this.getRowHeader=function(k){let S=w.rowHeaders,I=k;return I!==void 0&&(I=o.runHooks("modifyRowHeader",I)),I===void 0?(S=[],_t(o.countRows()-1,X=>{S.push(o.getRowHeader(X))})):Array.isArray(S)&&S[I]!==void 0?S=S[I]:nr(S)?S=S(I):S&&typeof S!="string"&&typeof S!="number"&&(S=I+1),S},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(w.colHeaders!==void 0&&w.colHeaders!==null)return!!w.colHeaders;for(let k=0,S=o.countCols();k<S;k++)if(o.getColHeader(k))return!0;return!1},this.getColHeader=function(k){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,I=o.runHooks("modifyColHeader",k);if(I===void 0){let Re=[],Oe=o.countCols();for(let We=0;We<Oe;We++)Re.push(o.getColHeader(We));return Re}let X=w.colHeaders,Q=function(Re){let Oe=[],We=o.countCols(),Le=0;for(;Le<We;Le++)nr(w.columns)&&w.columns(Le)&&Oe.push(Le);return Oe[Re]},le=o.toPhysicalColumn(I),xe=Q(le);return w.colHeaders===!1?X=null:w.columns&&nr(w.columns)&&w.columns(xe)&&w.columns(xe).title?X=w.columns(xe).title:w.columns&&w.columns[le]&&w.columns[le].title?X=w.columns[le].title:Array.isArray(w.colHeaders)&&w.colHeaders[le]!==void 0?X=w.colHeaders[le]:nr(w.colHeaders)?X=w.colHeaders(le):w.colHeaders&&typeof w.colHeaders!="string"&&typeof w.colHeaders!="number"&&(X=mye(I)),X=o.runHooks("modifyColumnHeaderValue",X,k,S),X},this._getColWidthFromSettings=function(k){let S;if(k>=0&&(S=o.getCellMeta(0,k).width),(S===void 0||S===w.width)&&(S=w.colWidths),S!=null){switch(typeof S){case"object":S=S[k];break;case"function":S=S(k);break;default:break}typeof S=="string"&&(S=parseInt(S,10))}return S},this.getColWidth=function(k){let S=o._getColWidthFromSettings(k);return S=o.runHooks("modifyColWidth",S,k),S===void 0&&(S=Af.DEFAULT_WIDTH),S},this._getRowHeightFromSettings=function(k){let S=w.rowHeights;if(S!=null){switch(typeof S){case"object":S=S[k];break;case"function":S=S(k);break;default:break}typeof S=="string"&&(S=parseInt(S,10))}return S},this.getRowHeight=function(k){let S=o._getRowHeightFromSettings(k);return S=o.runHooks("modifyRowHeight",S,k),S},this.countSourceRows=function(){return c.countRows()},this.countSourceCols=function(){return c.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){let k=w.maxCols,S=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(k,S)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return xI(o.countRows()-1,I=>{if(o.isEmptyRow(I))S+=1;else if(k===!0)return!1}),S},this.countEmptyCols=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return xI(o.countCols()-1,I=>{if(o.isEmptyCol(I))S+=1;else if(k===!0)return!1}),S},this.isEmptyRow=function(k){return w.isEmptyRow.call(o,k)},this.isEmptyCol=function(k){return w.isEmptyCol.call(o,k)},this.selectCell=function(k,S,I,X){let Q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,le=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Qi(k)||Qi(S)?!1:this.selectCells([[k,S,I,X]],Q,le)},this.selectCells=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;S===!1&&p.suspend();let X=O.selectCells(k);return X&&I&&o.listen(),p.resume(),X},this.selectColumns=function(k){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:k,I=arguments.length>2?arguments[2]:void 0;return O.selectColumns(k,S,I)},this.selectRows=function(k){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:k,I=arguments.length>2?arguments[2]:void 0;return O.selectRows(k,S,I)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:k,I=arguments.length>2?arguments[2]:void 0;p.skipNextScrollCycle(),O.selectAll(k,S,I)};let te=(k,S)=>k.getNearestNotHiddenIndex(S,1,!0);this.scrollViewportTo=function(k){var S;if(typeof k=="number"){var I;k={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(I=arguments[4])!==null&&I!==void 0?I:!0}}let{row:X,col:Q,verticalSnap:le,horizontalSnap:xe,considerHiddenIndexes:Re}=(S=k)!==null&&S!==void 0?S:{},Oe,We,Le,Ne;le!==void 0&&(Oe=le==="top",We=!Oe),xe!==void 0&&(Le=xe==="start",Ne=!Le);let it=X,ct=Q;if(Re===void 0||Re){let gt=Number.isInteger(X)&&X>=0,ce=Number.isInteger(Q)&&Q>=0,de=gt?te(this.rowIndexMapper,X):void 0,ye=ce?te(this.columnIndexMapper,Q):void 0;if(de===null||ye===null)return!1;it=gt?o.rowIndexMapper.getRenderableFromVisualIndex(de):X,ct=ce?o.columnIndexMapper.getRenderableFromVisualIndex(ye):Q}let Ue=Number.isInteger(it),Se=Number.isInteger(ct);return Ue&&it>=0&&Se&&ct>=0?o.view.scrollViewport(o._createCellCoords(it,ct),Oe,Ne,We,Le):Ue&&it>=0&&(Se&&ct<0||!Se)?o.view.scrollViewportVertically(it,Oe,We):Se&&ct>=0&&(Ue&&it<0||!Ue)?o.view.scrollViewportHorizontally(ct,Ne,Le):!1},this.scrollToFocusedCell=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",k);let{highlight:S}=this.getSelectedRangeLast();this.scrollViewportTo(S.toObject())?this.view.render():(this.removeHook("afterScroll",k),this._registerImmediate(()=>k()))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),c&&c.destroy(),c=null,this.getShortcutManager().destroy(),y.clearCache(),cY.delete(this.guid),A1(o)){let k=this.rootDocument.querySelector(".hot-display-license-info");k&&k.parentNode.removeChild(k)}ia(o.rootElement),s.destroy(),u&&u.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),T.getItems().forEach(k=>{let[,S]=k;S.destroy()}),T.clear(),o.runHooks("afterDestroy")},!0),Ct.getSingleton().destroy(o),Kt(o,(k,S,I)=>{nr(k)?I[S]=se(S):S!=="guid"&&(I[S]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,d=null,O=null,u=null,o=null};function se(k){return()=>{throw new Error(`The "${k}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(k){let S=ka(k);return S==="UndoRedo"?this.undoRedo:T.getItem(S)},this.getPluginName=function(k){return k===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:T.getId(k)},this.getInstance=function(){return o},this.addHook=function(k,S,I){Ct.getSingleton().add(k,S,o,I)},this.hasHook=function(k){return Ct.getSingleton().has(k,o)||Ct.getSingleton().has(k)},this.addHookOnce=function(k,S,I){Ct.getSingleton().once(k,S,o,I)},this.removeHook=function(k,S){Ct.getSingleton().remove(k,S,o)},this.runHooks=function(k,S,I,X,Q,le,xe){return Ct.getSingleton().run(o,k,S,I,X,Q,le,xe)},this.getTranslatedPhrase=function(k,S){return BH(w.language,k,S)},this.toHTML=()=>U7(this),this.toTableElement=()=>{let k=this.rootDocument.createElement("div");return k.insertAdjacentHTML("afterbegin",U7(this)),k.firstElementChild},this.timeouts=[],this._registerTimeout=function(k){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,I=k;typeof I=="function"&&(I=setTimeout(I,S)),this.timeouts.push(I)},this._clearTimeouts=function(){Ce(this.timeouts,k=>{clearTimeout(k)})},this.immediates=[],this._registerImmediate=function(k){this.immediates.push(setImmediate(k))},this._clearImmediates=function(){Ce(this.immediates,k=>{clearImmediate(k)})},this._getEditorManager=function(){return u},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};let Ae=aY({handleEvent(){return o.isListening()},beforeKeyDown:k=>this.runHooks("beforeKeyDown",k),afterKeyDown:k=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",k)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",k=>{k.ctrlKey===!1&&k.metaKey===!1&&Ae.releasePressedKeys()}),this.getShortcutManager=function(){return Ae},this.getFocusManager=function(){return h},B5().forEach(k=>{let S=V5(k);T.addItem(k,new S(this))}),iCe(o),Ae.setActiveContextName("grid"),Ct.getSingleton().run(o,"construct")}var tEi=U($e(),1);function wCe(t,e,i){t.addEventListener(e,i,!1)}function CCe(t,e,i){t.removeEventListener(e,i,!1)}function xCe(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function SCe(t){let e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i=t.body,r=t.createTextNode(""),n=t.createElement("span"),o;function s(){r.textContent=o.value,n.style.position="absolute",n.style.fontSize=xCe(o).fontSize,n.style.fontFamily=xCe(o).fontFamily,n.style.whiteSpace="pre",i.appendChild(n);let u=n.clientWidth+2;i.removeChild(n);let h=o.style;h.height=`${e.minHeight}px`,e.minWidth>u?h.width=`${e.minWidth}px`:u>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${u}px`;let p=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>p?h.height=`${e.minHeight}px`:e.maxHeight<p?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${p}px`}function a(){t.defaultView.setTimeout(s,0)}function c(u){if(u&&u.minHeight)if(u.minHeight==="inherit")e.minHeight=o.clientHeight;else{let h=parseInt(u.minHeight,10);isNaN(h)||(e.minHeight=h)}if(u&&u.maxHeight)if(u.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{let h=parseInt(u.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(u&&u.minWidth)if(u.minWidth==="inherit")e.minWidth=o.clientWidth;else{let h=parseInt(u.minWidth,10);isNaN(h)||(e.minWidth=h)}if(u&&u.maxWidth)if(u.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{let h=parseInt(u.maxWidth,10);isNaN(h)||(e.maxWidth=h)}n.firstChild||(n.className="autoResize",n.style.display="inline-block",n.appendChild(r))}function d(u,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=u,c(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),p&&(wCe(o,"input",s),wCe(o,"keydown",a)),s()}return{init:d,resize:s,unObserve(){CCe(o,"input",s),CCe(o,"keydown",a)}}}function dY(t,e){let i=v5(e),r=e.value.split(`
`),n=i,o=0;for(let s=0;s<r.length;s++){let a=r[s];s!==0&&(o+=r[s-1].length+1);let c=o+a.length;if(t==="home"?n=o:t==="end"&&(n=c),i<=c)break}Hv(e,n)}function ay(t,e,i){return e=Tut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Tut(t){var e=Rut(t,"string");return typeof e=="symbol"?e:e+""}function Rut(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Aut="ht_editor_visible",rB="ht_editor_hidden",ECe="textEditor",uY="text",Na=class extends Tc{static get EDITOR_TYPE(){return uY}constructor(e){super(e),ay(this,"eventManager",new cs(this)),ay(this,"autoResize",SCe(this.hot.rootDocument)),ay(this,"TEXTAREA",void 0),ay(this,"textareaStyle",void 0),ay(this,"TEXTAREA_PARENT",void 0),ay(this,"textareaParentStyle",void 0),ay(this,"layerClass",void 0),this.eventManager=new cs(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),f0e(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,i,r,n,o,s){let a=this.state;if(super.prepare(e,i,r,n,o,s),!s.readOnly){this.refreshDimensions(!0);let{allowInvalid:c}=s;c&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Pn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,i){this.state===Pn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,i))}focus(){this.TEXTAREA.select(),Hv(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ht(this.TEXTAREA,[["data-hot-input",""],Gd(-1)]),this.hot.getSettings().ariaTags&&Ht(this.TEXTAREA,[ta()]),Qe(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Qe(this.TEXTAREA_PARENT,"handsontableInputHolder"),Bt(this.TEXTAREA_PARENT,this.layerClass)&&Gt(this.TEXTAREA_PARENT,this.layerClass),Qe(this.TEXTAREA_PARENT,rB),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Y0e()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Gt(this.TEXTAREA_PARENT,this.layerClass),Qe(this.TEXTAREA_PARENT,rB)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";let e=this.TEXTAREA_PARENT.childNodes,i=!1;_t(e.length-1,r=>{let n=e[r];if(Bt(n,"handsontableEditor"))return i=!0,!1}),Bt(this.TEXTAREA_PARENT,rB)&&Gt(this.TEXTAREA_PARENT,rB),i?(this.layerClass=Aut,Qe(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Qe(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){let e=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Pn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}let{top:i,start:r,width:n,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${i}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();let c=Jd(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=c.fontSize,this.TEXTAREA.style.fontFamily=c.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let d=Jd(this.TEXTAREA),u=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),h=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),p=n-u,f=s-h,m=o-u,g=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(p,m),minHeight:Math.min(f,g),maxWidth:m,maxHeight:g},!0)}bindEvents(){R5()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Pn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Pn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let i=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>wt(this.hot.getSelected()),group:ECe},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};i.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;dY(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;dY(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ECe)}};var pEi=U(dt(),1);var hY="base";function Hf(t,e,i,r,n,o,s){let a=s.ariaTags,c=[],d=[],u=[],h=[];s.className&&Qe(e,s.className),s.readOnly?(c.push(s.readOnlyCellClassName),a&&h.push(w7())):a&&u.push(w7()[0]),s.valid===!1&&s.invalidCellClassName?(c.push(s.invalidCellClassName),a&&h.push(C7())):(d.push(s.invalidCellClassName),a&&u.push(C7()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&c.push(s.noWordWrapClassName),!o&&s.placeholder&&c.push(s.placeholderCellClassName),Gt(e,d),Qe(e,c),Kd(e,u),Ht(e,h)}Hf.RENDERER_TYPE=hY;var fY="text";function da(t,e,i,r,n,o,s){Hf.apply(this,[t,e,i,r,n,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Vr(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){ia(e);let c=t.rootDocument.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(i),e.appendChild(c)}else Qd(e,a)}da.RENDERER_TYPE=fY;var pY="text",LM={CELL_TYPE:pY,editor:Na,renderer:da};sd(LM);lh.editors={BaseEditor:Tc};function lh(t,e){let i=new iB(t,e||{},EH);return i.init(),i}lh.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new iB(t,e,EH)};lh.DefaultSettings=DM();lh.hooks=Ct.getSingleton();lh.CellCoords=Gv;lh.CellRange=Y_;lh.packageName="handsontable";lh.buildDate="11/06/2024 09:51:42";lh.version="14.4.0";lh.languages={dictionaryKeys:Iye,getLanguageDictionary:V9,getLanguagesDictionaries:Mye,registerLanguageDictionary:B9,getTranslatedPhrase:BH};var nB=lh;var Iut=["container"],mY=new Map,ACe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",gY=(()=>{class t{getInstance(i){let r=mY.get(i);return r.isDestroyed?(console.warn(ACe),null):r}registerInstance(i,r){return mY.set(i,r)}removeInstance(i){return mY.delete(i)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=kt({token:t,factory:t.\u0275fac})}return t})(),Dut=Object.keys(nB.DefaultSettings),TCe=nB.hooks.getRegistered(),RCe=(()=>{class t{mergeSettings(i){let r="settings"in i&&typeof i.settings=="object",n=r?i.settings:{};return TCe.concat(Dut).forEach(s=>{let a=TCe.indexOf(s)>-1,c;r&&a&&(c=i.settings[s]),i[s]!==void 0&&(c=i[s]),c!==void 0&&("ngZone"in i&&typeof c=="function"&&a?n[s]=function(...d){return i.ngZone.run(()=>c.apply(this,d))}:n[s]=c)}),n}prepareChanges(i){let r={};return Object.keys(i).forEach(o=>{i.hasOwnProperty(o)&&(r[o]=i[o].currentValue)}),r}static \u0275fac=function(r){return new(r||t)};static \u0275prov=kt({token:t,factory:t.\u0275fac})}return t})(),ICe=(()=>{class t{_hotTableRegisterer;_hotSettingsResolver;ngZone;container;__hotInstance=null;columnsComponents=[];settings;hotId="";activeHeaderClassName;allowEmpty;allowHtml;allowInsertColumn;allowInsertRow;allowInvalid;allowRemoveColumn;allowRemoveRow;ariaTags;autoColumnSize;autoRowSize;autoWrapCol;autoWrapRow;bindRowsWithHeaders;cell;cells;checkedTemplate;className;colHeaders;collapsibleColumns;columnHeaderHeight;columns;columnSorting;columnSummary;colWidths;commentedCellClassName;comments;contextMenu;copyable;copyPaste;correctFormat;currentColClassName;currentHeaderClassName;currentRowClassName;customBorders;data;dataDotNotation;dataSchema;dateFormat;datePickerConfig;defaultDate;tabNavigation;disableVisualSelection;dragToScroll;dropdownMenu;editor;enterBeginsEditing;enterMoves;fillHandle;filter;filteringCaseSensitive;filters;fixedColumnsLeft;fixedColumnsStart;fixedRowsBottom;fixedRowsTop;formulas;fragmentSelection;height;hiddenColumns;hiddenRows;invalidCellClassName;imeFastEdit;label;language;layoutDirection;licenseKey;locale;manualColumnFreeze;manualColumnMove;manualColumnResize;manualRowMove;manualRowResize;maxCols;maxRows;mergeCells;minCols;minRows;minSpareCols;minSpareRows;multiColumnSorting;navigableHeaders;nestedHeaders;nestedRows;noWordWrapClassName;numericFormat;observeDOMVisibility;outsideClickDeselects;persistentState;placeholder;placeholderCellClassName;preventOverflow;preventWheel;readOnly;readOnlyCellClassName;renderAllColumns;renderAllRows;renderer;rowHeaders;rowHeaderWidth;rowHeights;search;selectionMode;selectOptions;skipColumnOnPaste;skipRowOnPaste;sortByRelevance;source;startCols;startRows;stretchH;strict;tableClassName;tabMoves;title;trimDropdown;trimRows;trimWhitespace;type;uncheckedTemplate;undo;validator;viewportColumnRenderingOffset;viewportRowRenderingOffset;visibleRows;width;wordWrap;afterAddChild;afterAutofill;afterBeginEditing;afterCellMetaReset;afterChange;afterChangesObserved;afterColumnCollapse;afterColumnExpand;afterColumnFreeze;afterColumnMove;afterColumnResize;afterColumnSequenceChange;afterColumnSort;afterColumnUnfreeze;afterContextMenuDefaultOptions;afterContextMenuHide;afterContextMenuShow;afterCopy;afterCopyLimit;afterCreateCol;afterCreateRow;afterCut;afterDeselect;afterDestroy;afterDetachChild;afterDocumentKeyDown;afterDrawSelection;afterDropdownMenuDefaultOptions;afterDropdownMenuHide;afterDropdownMenuShow;afterFilter;afterFormulasValuesUpdate;afterGetCellMeta;afterGetColHeader;afterGetColumnHeaderRenderers;afterGetRowHeader;afterGetRowHeaderRenderers;afterHideColumns;afterHideRows;afterInit;afterLanguageChange;afterListen;afterLoadData;afterMergeCells;afterModifyTransformEnd;afterModifyTransformFocus;afterModifyTransformStart;afterMomentumScroll;afterNamedExpressionAdded;afterNamedExpressionRemoved;afterOnCellContextMenu;afterOnCellCornerDblClick;afterOnCellCornerMouseDown;afterOnCellMouseDown;afterOnCellMouseOut;afterOnCellMouseOver;afterOnCellMouseUp;afterPaste;afterPluginsInitialized;afterRedo;afterRedoStackChange;afterRefreshDimensions;afterRemoveCellMeta;afterRemoveCol;afterRemoveRow;afterRender;afterRenderer;afterRowMove;afterRowResize;afterRowSequenceChange;afterScrollHorizontally;afterScrollVertically;afterScroll;afterSelectColumns;afterSelection;afterSelectionByProp;afterSelectionEnd;afterSelectionEndByProp;afterSelectionFocusSet;afterSelectRows;afterSetCellMeta;afterSetDataAtCell;afterSetDataAtRowProp;afterSetSourceDataAtCell;afterSheetAdded;afterSheetRenamed;afterSheetRemoved;afterTrimRow;afterUndo;afterUndoStackChange;afterUnhideColumns;afterUnhideRows;afterUnlisten;afterUnmergeCells;afterUntrimRow;afterUpdateData;afterUpdateSettings;afterValidate;afterViewportColumnCalculatorOverride;afterViewportRowCalculatorOverride;afterViewRender;beforeAddChild;beforeAutofill;beforeBeginEditing;beforeCellAlignment;beforeChange;beforeChangeRender;beforeColumnCollapse;beforeColumnExpand;beforeColumnFreeze;beforeColumnMove;beforeColumnResize;beforeColumnSort;beforeColumnWrap;beforeColumnUnfreeze;beforeContextMenuSetItems;beforeContextMenuShow;beforeCopy;beforeCreateCol;beforeCreateRow;beforeCut;beforeDetachChild;beforeDrawBorders;beforeDropdownMenuSetItems;beforeDropdownMenuShow;beforeFilter;beforeGetCellMeta;beforeHideColumns;beforeHideRows;beforeHighlightingColumnHeader;beforeHighlightingRowHeader;beforeInit;beforeInitWalkontable;beforeKeyDown;beforeLanguageChange;beforeLoadData;beforeMergeCells;beforeOnCellContextMenu;beforeOnCellMouseDown;beforeOnCellMouseOut;beforeOnCellMouseOver;beforeOnCellMouseUp;beforePaste;beforeRedo;beforeRedoStackChange;beforeRefreshDimensions;beforeRemoveCellClassNames;beforeRemoveCellMeta;beforeRemoveCol;beforeRemoveRow;beforeRender;beforeRenderer;beforeRowMove;beforeRowResize;beforeRowWrap;beforeSelectColumns;beforeSelectionFocusSet;beforeSelectionHighlightSet;beforeSelectRows;beforeSetCellMeta;beforeSetRangeEnd;beforeSetRangeStart;beforeSetRangeStartOnly;beforeStretchingColumnWidth;beforeTouchScroll;beforeTrimRow;beforeUndo;beforeUndoStackChange;beforeUnhideColumns;beforeUnhideRows;beforeUnmergeCells;beforeUntrimRow;beforeUpdateData;beforeValidate;beforeValueRender;beforeViewportScroll;beforeViewportScrollHorizontally;beforeViewportScrollVertically;beforeViewRender;construct;init;modifyAutoColumnSizeSeed;modifyAutofillRange;modifyColHeader;modifyColumnHeaderHeight;modifyColumnHeaderValue;modifyColWidth;modifyCopyableRange;modifyFiltersMultiSelectValue;modifyFocusedElement;modifyData;modifyFocusOnTabNavigation;modifyGetCellCoords;modifyRowData;modifyRowHeader;modifyRowHeaderWidth;modifyRowHeight;modifySourceData;modifyTransformEnd;modifyTransformFocus;modifyTransformStart;persistentStateLoad;persistentStateReset;persistentStateSave;constructor(i,r,n){this._hotTableRegisterer=i,this._hotSettingsResolver=r,this.ngZone=n}get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(this._hotTableRegisterer.removeInstance(this.hotId),console.warn(ACe),null)}set hotInstance(i){this.__hotInstance=i}ngAfterViewInit(){let i=this._hotSettingsResolver.mergeSettings(this);if(this.columnsComponents.length>0){let r=[];this.columnsComponents.forEach(n=>{r.push(this._hotSettingsResolver.mergeSettings(n))}),i.columns=r}this.ngZone.runOutsideAngular(()=>{this.hotInstance=new nB.Core(this.container.nativeElement,i),this.hotId&&this._hotTableRegisterer.registerInstance(this.hotId,this.hotInstance),this.hotInstance.init()})}ngOnChanges(i){if(this.hotInstance===null)return;let r=this._hotSettingsResolver.prepareChanges(i);this.updateHotTable(r)}ngOnDestroy(){this.ngZone.runOutsideAngular(()=>{this.hotInstance&&this.hotInstance.destroy()}),this.hotId&&this._hotTableRegisterer.removeInstance(this.hotId)}updateHotTable(i){this.hotInstance&&this.ngZone.runOutsideAngular(()=>{this.hotInstance.updateSettings(i,!1)})}onAfterColumnsChange(){if(this.columnsComponents!==void 0&&this.columnsComponents.length>0){let i=[];this.columnsComponents.forEach(n=>{i.push(this._hotSettingsResolver.mergeSettings(n))});let r={columns:i};this.updateHotTable(r)}}onAfterColumnsNumberChange(){let i=[];this.columnsComponents.length>0&&this.columnsComponents.forEach(r=>{i.push(this._hotSettingsResolver.mergeSettings(r))}),this.updateHotTable({columns:i})}addColumn(i){this.columnsComponents.push(i),this.onAfterColumnsNumberChange()}removeColumn(i){let r=this.columnsComponents.indexOf(i);this.columnsComponents.splice(r,1),this.onAfterColumnsNumberChange()}static \u0275fac=function(r){return new(r||t)(Te(gY),Te(RCe),Te(ni))};static \u0275cmp=Tt({type:t,selectors:[["hot-table"]],viewQuery:function(r,n){if(r&1&&Ii(Iut,5),r&2){let o;ai(o=li())&&(n.container=o.first)}},inputs:{settings:"settings",hotId:"hotId",activeHeaderClassName:"activeHeaderClassName",allowEmpty:"allowEmpty",allowHtml:"allowHtml",allowInsertColumn:"allowInsertColumn",allowInsertRow:"allowInsertRow",allowInvalid:"allowInvalid",allowRemoveColumn:"allowRemoveColumn",allowRemoveRow:"allowRemoveRow",ariaTags:"ariaTags",autoColumnSize:"autoColumnSize",autoRowSize:"autoRowSize",autoWrapCol:"autoWrapCol",autoWrapRow:"autoWrapRow",bindRowsWithHeaders:"bindRowsWithHeaders",cell:"cell",cells:"cells",checkedTemplate:"checkedTemplate",className:"className",colHeaders:"colHeaders",collapsibleColumns:"collapsibleColumns",columnHeaderHeight:"columnHeaderHeight",columns:"columns",columnSorting:"columnSorting",columnSummary:"columnSummary",colWidths:"colWidths",commentedCellClassName:"commentedCellClassName",comments:"comments",contextMenu:"contextMenu",copyable:"copyable",copyPaste:"copyPaste",correctFormat:"correctFormat",currentColClassName:"currentColClassName",currentHeaderClassName:"currentHeaderClassName",currentRowClassName:"currentRowClassName",customBorders:"customBorders",data:"data",dataDotNotation:"dataDotNotation",dataSchema:"dataSchema",dateFormat:"dateFormat",datePickerConfig:"datePickerConfig",defaultDate:"defaultDate",tabNavigation:"tabNavigation",disableVisualSelection:"disableVisualSelection",dragToScroll:"dragToScroll",dropdownMenu:"dropdownMenu",editor:"editor",enterBeginsEditing:"enterBeginsEditing",enterMoves:"enterMoves",fillHandle:"fillHandle",filter:"filter",filteringCaseSensitive:"filteringCaseSensitive",filters:"filters",fixedColumnsLeft:"fixedColumnsLeft",fixedColumnsStart:"fixedColumnsStart",fixedRowsBottom:"fixedRowsBottom",fixedRowsTop:"fixedRowsTop",formulas:"formulas",fragmentSelection:"fragmentSelection",height:"height",hiddenColumns:"hiddenColumns",hiddenRows:"hiddenRows",invalidCellClassName:"invalidCellClassName",imeFastEdit:"imeFastEdit",label:"label",language:"language",layoutDirection:"layoutDirection",licenseKey:"licenseKey",locale:"locale",manualColumnFreeze:"manualColumnFreeze",manualColumnMove:"manualColumnMove",manualColumnResize:"manualColumnResize",manualRowMove:"manualRowMove",manualRowResize:"manualRowResize",maxCols:"maxCols",maxRows:"maxRows",mergeCells:"mergeCells",minCols:"minCols",minRows:"minRows",minSpareCols:"minSpareCols",minSpareRows:"minSpareRows",multiColumnSorting:"multiColumnSorting",navigableHeaders:"navigableHeaders",nestedHeaders:"nestedHeaders",nestedRows:"nestedRows",noWordWrapClassName:"noWordWrapClassName",numericFormat:"numericFormat",observeDOMVisibility:"observeDOMVisibility",outsideClickDeselects:"outsideClickDeselects",persistentState:"persistentState",placeholder:"placeholder",placeholderCellClassName:"placeholderCellClassName",preventOverflow:"preventOverflow",preventWheel:"preventWheel",readOnly:"readOnly",readOnlyCellClassName:"readOnlyCellClassName",renderAllColumns:"renderAllColumns",renderAllRows:"renderAllRows",renderer:"renderer",rowHeaders:"rowHeaders",rowHeaderWidth:"rowHeaderWidth",rowHeights:"rowHeights",search:"search",selectionMode:"selectionMode",selectOptions:"selectOptions",skipColumnOnPaste:"skipColumnOnPaste",skipRowOnPaste:"skipRowOnPaste",sortByRelevance:"sortByRelevance",source:"source",startCols:"startCols",startRows:"startRows",stretchH:"stretchH",strict:"strict",tableClassName:"tableClassName",tabMoves:"tabMoves",title:"title",trimDropdown:"trimDropdown",trimRows:"trimRows",trimWhitespace:"trimWhitespace",type:"type",uncheckedTemplate:"uncheckedTemplate",undo:"undo",validator:"validator",viewportColumnRenderingOffset:"viewportColumnRenderingOffset",viewportRowRenderingOffset:"viewportRowRenderingOffset",visibleRows:"visibleRows",width:"width",wordWrap:"wordWrap",afterAddChild:"afterAddChild",afterAutofill:"afterAutofill",afterBeginEditing:"afterBeginEditing",afterCellMetaReset:"afterCellMetaReset",afterChange:"afterChange",afterChangesObserved:"afterChangesObserved",afterColumnCollapse:"afterColumnCollapse",afterColumnExpand:"afterColumnExpand",afterColumnFreeze:"afterColumnFreeze",afterColumnMove:"afterColumnMove",afterColumnResize:"afterColumnResize",afterColumnSequenceChange:"afterColumnSequenceChange",afterColumnSort:"afterColumnSort",afterColumnUnfreeze:"afterColumnUnfreeze",afterContextMenuDefaultOptions:"afterContextMenuDefaultOptions",afterContextMenuHide:"afterContextMenuHide",afterContextMenuShow:"afterContextMenuShow",afterCopy:"afterCopy",afterCopyLimit:"afterCopyLimit",afterCreateCol:"afterCreateCol",afterCreateRow:"afterCreateRow",afterCut:"afterCut",afterDeselect:"afterDeselect",afterDestroy:"afterDestroy",afterDetachChild:"afterDetachChild",afterDocumentKeyDown:"afterDocumentKeyDown",afterDrawSelection:"afterDrawSelection",afterDropdownMenuDefaultOptions:"afterDropdownMenuDefaultOptions",afterDropdownMenuHide:"afterDropdownMenuHide",afterDropdownMenuShow:"afterDropdownMenuShow",afterFilter:"afterFilter",afterFormulasValuesUpdate:"afterFormulasValuesUpdate",afterGetCellMeta:"afterGetCellMeta",afterGetColHeader:"afterGetColHeader",afterGetColumnHeaderRenderers:"afterGetColumnHeaderRenderers",afterGetRowHeader:"afterGetRowHeader",afterGetRowHeaderRenderers:"afterGetRowHeaderRenderers",afterHideColumns:"afterHideColumns",afterHideRows:"afterHideRows",afterInit:"afterInit",afterLanguageChange:"afterLanguageChange",afterListen:"afterListen",afterLoadData:"afterLoadData",afterMergeCells:"afterMergeCells",afterModifyTransformEnd:"afterModifyTransformEnd",afterModifyTransformFocus:"afterModifyTransformFocus",afterModifyTransformStart:"afterModifyTransformStart",afterMomentumScroll:"afterMomentumScroll",afterNamedExpressionAdded:"afterNamedExpressionAdded",afterNamedExpressionRemoved:"afterNamedExpressionRemoved",afterOnCellContextMenu:"afterOnCellContextMenu",afterOnCellCornerDblClick:"afterOnCellCornerDblClick",afterOnCellCornerMouseDown:"afterOnCellCornerMouseDown",afterOnCellMouseDown:"afterOnCellMouseDown",afterOnCellMouseOut:"afterOnCellMouseOut",afterOnCellMouseOver:"afterOnCellMouseOver",afterOnCellMouseUp:"afterOnCellMouseUp",afterPaste:"afterPaste",afterPluginsInitialized:"afterPluginsInitialized",afterRedo:"afterRedo",afterRedoStackChange:"afterRedoStackChange",afterRefreshDimensions:"afterRefreshDimensions",afterRemoveCellMeta:"afterRemoveCellMeta",afterRemoveCol:"afterRemoveCol",afterRemoveRow:"afterRemoveRow",afterRender:"afterRender",afterRenderer:"afterRenderer",afterRowMove:"afterRowMove",afterRowResize:"afterRowResize",afterRowSequenceChange:"afterRowSequenceChange",afterScrollHorizontally:"afterScrollHorizontally",afterScrollVertically:"afterScrollVertically",afterScroll:"afterScroll",afterSelectColumns:"afterSelectColumns",afterSelection:"afterSelection",afterSelectionByProp:"afterSelectionByProp",afterSelectionEnd:"afterSelectionEnd",afterSelectionEndByProp:"afterSelectionEndByProp",afterSelectionFocusSet:"afterSelectionFocusSet",afterSelectRows:"afterSelectRows",afterSetCellMeta:"afterSetCellMeta",afterSetDataAtCell:"afterSetDataAtCell",afterSetDataAtRowProp:"afterSetDataAtRowProp",afterSetSourceDataAtCell:"afterSetSourceDataAtCell",afterSheetAdded:"afterSheetAdded",afterSheetRenamed:"afterSheetRenamed",afterSheetRemoved:"afterSheetRemoved",afterTrimRow:"afterTrimRow",afterUndo:"afterUndo",afterUndoStackChange:"afterUndoStackChange",afterUnhideColumns:"afterUnhideColumns",afterUnhideRows:"afterUnhideRows",afterUnlisten:"afterUnlisten",afterUnmergeCells:"afterUnmergeCells",afterUntrimRow:"afterUntrimRow",afterUpdateData:"afterUpdateData",afterUpdateSettings:"afterUpdateSettings",afterValidate:"afterValidate",afterViewportColumnCalculatorOverride:"afterViewportColumnCalculatorOverride",afterViewportRowCalculatorOverride:"afterViewportRowCalculatorOverride",afterViewRender:"afterViewRender",beforeAddChild:"beforeAddChild",beforeAutofill:"beforeAutofill",beforeBeginEditing:"beforeBeginEditing",beforeCellAlignment:"beforeCellAlignment",beforeChange:"beforeChange",beforeChangeRender:"beforeChangeRender",beforeColumnCollapse:"beforeColumnCollapse",beforeColumnExpand:"beforeColumnExpand",beforeColumnFreeze:"beforeColumnFreeze",beforeColumnMove:"beforeColumnMove",beforeColumnResize:"beforeColumnResize",beforeColumnSort:"beforeColumnSort",beforeColumnWrap:"beforeColumnWrap",beforeColumnUnfreeze:"beforeColumnUnfreeze",beforeContextMenuSetItems:"beforeContextMenuSetItems",beforeContextMenuShow:"beforeContextMenuShow",beforeCopy:"beforeCopy",beforeCreateCol:"beforeCreateCol",beforeCreateRow:"beforeCreateRow",beforeCut:"beforeCut",beforeDetachChild:"beforeDetachChild",beforeDrawBorders:"beforeDrawBorders",beforeDropdownMenuSetItems:"beforeDropdownMenuSetItems",beforeDropdownMenuShow:"beforeDropdownMenuShow",beforeFilter:"beforeFilter",beforeGetCellMeta:"beforeGetCellMeta",beforeHideColumns:"beforeHideColumns",beforeHideRows:"beforeHideRows",beforeHighlightingColumnHeader:"beforeHighlightingColumnHeader",beforeHighlightingRowHeader:"beforeHighlightingRowHeader",beforeInit:"beforeInit",beforeInitWalkontable:"beforeInitWalkontable",beforeKeyDown:"beforeKeyDown",beforeLanguageChange:"beforeLanguageChange",beforeLoadData:"beforeLoadData",beforeMergeCells:"beforeMergeCells",beforeOnCellContextMenu:"beforeOnCellContextMenu",beforeOnCellMouseDown:"beforeOnCellMouseDown",beforeOnCellMouseOut:"beforeOnCellMouseOut",beforeOnCellMouseOver:"beforeOnCellMouseOver",beforeOnCellMouseUp:"beforeOnCellMouseUp",beforePaste:"beforePaste",beforeRedo:"beforeRedo",beforeRedoStackChange:"beforeRedoStackChange",beforeRefreshDimensions:"beforeRefreshDimensions",beforeRemoveCellClassNames:"beforeRemoveCellClassNames",beforeRemoveCellMeta:"beforeRemoveCellMeta",beforeRemoveCol:"beforeRemoveCol",beforeRemoveRow:"beforeRemoveRow",beforeRender:"beforeRender",beforeRenderer:"beforeRenderer",beforeRowMove:"beforeRowMove",beforeRowResize:"beforeRowResize",beforeRowWrap:"beforeRowWrap",beforeSelectColumns:"beforeSelectColumns",beforeSelectionFocusSet:"beforeSelectionFocusSet",beforeSelectionHighlightSet:"beforeSelectionHighlightSet",beforeSelectRows:"beforeSelectRows",beforeSetCellMeta:"beforeSetCellMeta",beforeSetRangeEnd:"beforeSetRangeEnd",beforeSetRangeStart:"beforeSetRangeStart",beforeSetRangeStartOnly:"beforeSetRangeStartOnly",beforeStretchingColumnWidth:"beforeStretchingColumnWidth",beforeTouchScroll:"beforeTouchScroll",beforeTrimRow:"beforeTrimRow",beforeUndo:"beforeUndo",beforeUndoStackChange:"beforeUndoStackChange",beforeUnhideColumns:"beforeUnhideColumns",beforeUnhideRows:"beforeUnhideRows",beforeUnmergeCells:"beforeUnmergeCells",beforeUntrimRow:"beforeUntrimRow",beforeUpdateData:"beforeUpdateData",beforeValidate:"beforeValidate",beforeValueRender:"beforeValueRender",beforeViewportScroll:"beforeViewportScroll",beforeViewportScrollHorizontally:"beforeViewportScrollHorizontally",beforeViewportScrollVertically:"beforeViewportScrollVertically",beforeViewRender:"beforeViewRender",construct:"construct",init:"init",modifyAutoColumnSizeSeed:"modifyAutoColumnSizeSeed",modifyAutofillRange:"modifyAutofillRange",modifyColHeader:"modifyColHeader",modifyColumnHeaderHeight:"modifyColumnHeaderHeight",modifyColumnHeaderValue:"modifyColumnHeaderValue",modifyColWidth:"modifyColWidth",modifyCopyableRange:"modifyCopyableRange",modifyFiltersMultiSelectValue:"modifyFiltersMultiSelectValue",modifyFocusedElement:"modifyFocusedElement",modifyData:"modifyData",modifyFocusOnTabNavigation:"modifyFocusOnTabNavigation",modifyGetCellCoords:"modifyGetCellCoords",modifyRowData:"modifyRowData",modifyRowHeader:"modifyRowHeader",modifyRowHeaderWidth:"modifyRowHeaderWidth",modifyRowHeight:"modifyRowHeight",modifySourceData:"modifySourceData",modifyTransformEnd:"modifyTransformEnd",modifyTransformFocus:"modifyTransformFocus",modifyTransformStart:"modifyTransformStart",persistentStateLoad:"persistentStateLoad",persistentStateReset:"persistentStateReset",persistentStateSave:"persistentStateSave"},features:[zi([gY,RCe]),Li],decls:2,vars:1,consts:[["container",""],[3,"id"]],template:function(r,n){r&1&&bt(0,"div",1,0),r&2&&ht("id",n.hotId)},encapsulation:2})}return t})();var oB=(()=>{class t{static version="14.4.0";static forRoot(){return{ngModule:t,providers:[gY]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Mt({type:t});static \u0275inj=Dt({})}return t})();var KEi=U($e(),1),ZEi=U(dt(),1);var DCe="handsontableEditor",vY="handsontable",ym=class extends Na{static get EDITOR_TYPE(){return vY}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Hv(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,i,r,n,o,s){super.prepare(e,i,r,n,o,s);let a=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(d,u){let h=this.getSourceData(u.row,u.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Sr(c,s.handsontable),this.htOptions=c}beginEditing(e,i){let r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,i)}createElements(){super.createElements();let e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,i,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){let n=this.htEditor.getValue();n!==void 0&&this.setValue(n)}super.finishEditing(e,i,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){let i=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();let r={group:DCe,relativeToGroup:ul,position:"before"},n=(o,s)=>{let a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Uo(s),this.hot.listen(),this.TEXTAREA.focus(),!1};i.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{let s=this.htEditor,a,c;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(c=s.getSelectedLast()[0],a=Math.max(0,c-1)):(c=s.getSelectedLast()[0],a=c-1)),n(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{let s=this.htEditor,a,c;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){let d=s.countRows()-1;c=s.getSelectedLast()[0],a=Math.min(d,c+1)}}return n(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(DCe)}};function kut(t,e,i){Out(t,e),e.set(t,i)}function Out(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sB(t,e,i){return e=Nut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Nut(t){var e=Put(t,"string");return typeof e=="symbol"?e:e+""}function Put(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MCe(t,e){return t.get(Lut(t,e))}function Lut(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var _Y="autocomplete",bY=new WeakMap,wm=class extends ym{constructor(){super(...arguments),sB(this,"query",null),sB(this,"strippedChoices",[]),sB(this,"rawChoices",[]),kut(this,bY,this.hot.guid.slice(0,9)),sB(this,"sortByRelevance",function(e,i,r){let n=[],o=[],s=e.length,a=i.length,c,d,u,h;if(s===0){for(u=0;u<a;u++)o.push(u);return o}for(u=0;u<a;u++){if(d=y7(Vr(i[u])),r)h=d.indexOf(e);else{let p=this.cellProperties.locale;h=d.toLocaleLowerCase(p).indexOf(e.toLocaleLowerCase(p))}h!==-1&&(c=d.length-h-s,n.push({baseIndex:u,index:h,charsLeft:c,value:d}))}for(n.sort((p,f)=>{if(f.index===-1)return-1;if(p.index===-1)return 1;if(p.index<f.index)return-1;if(f.index<p.index)return 1;if(p.index===f.index){if(p.charsLeft<f.charsLeft)return-1;if(p.charsLeft>f.charsLeft)return 1}return 0}),u=0,a=n.length;u<a;u++)o.push(n[u].baseIndex);return o})}static get EDITOR_TYPE(){return _Y}getValue(){let e=this.rawChoices.find(i=>this.stripValueIfNeeded(i)===this.TEXTAREA.value);return wt(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Qe(this.htContainer,"autocompleteEditor"),Qe(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ht(this.TEXTAREA,[e0e(),Xbe(),h5("listbox"),o0e()])}prepare(e,i,r,n,o,s){super.prepare(e,i,r,n,o,s),this.hot.getSettings().ariaTags&&Ht(this.TEXTAREA,[Oa("false"),s0e(`${MCe(bY,this)}-listbox-${e}-${i}`)])}open(){super.open();let e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,i=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,n=r?.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=mn();a===0&&u1()&&(a+=15),this.addHook("beforeKeyDown",c=>this.onBeforeKeyDown(c)),this.htEditor.updateSettings({colWidths:e?[Ji(this.TEXTAREA)-2]:void 0,width:e?Ji(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(c,d,u,h,p,f,m)=>{da(c,d,u,h,p,f,m);let{filteringCaseSensitive:g,allowHtml:y,locale:w}=this.cellProperties,x=this.query,T=Vr(f),M,B;T&&!y&&(M=g===!0?T.indexOf(x):T.toLocaleLowerCase(w).indexOf(x.toLocaleLowerCase(w)),M!==-1&&(B=T.substr(M,x.length),T=T.replace(B,`<strong>${B}</strong>`))),i&&Ht(d,[Kbe(),...r?[d0e(n)]:[],...r?[u0e(r.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${h}`]]),d.innerHTML=T},afterSelectionEnd:(c,d)=>{if(i){let u=this.htEditor.getCell(c,d,!0);Ht(u,[t1()]),Ht(this.TEXTAREA,...a0e(u.id))}}}),i&&(Ht(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Fl()),Ht(this.htEditor.rootElement,[u5(),l0e("polite"),c0e("text"),["id",`${MCe(bY,this)}-listbox-${o}-${s}`]]),Ht(this.TEXTAREA,...Oa("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ht(this.TEXTAREA,[Oa("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){let i=this.cellProperties.source;this.query=e,typeof i=="function"?i.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(i)?(this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))):this.updateChoicesList([])}updateChoicesList(e){let i=v5(this.TEXTAREA),r=_0e(this.TEXTAREA),n=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,s=null,a=null,c=e;n&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));let d=Array.isArray(s)?s.length:0;if(o===!1)d&&(a=s[0]);else{let u=[];for(let h=0,p=c.length;h<p&&!(n&&d<=h);h++)d?u.push(c[s[h]]):u.push(c[h]);a=0,c=u}this.strippedChoices=c,c.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Zx([c])),c.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Hv(this.TEXTAREA,i,i===r?void 0:r)}flipDropdownIfNeeded(){let e=Qu(this.hot.view._wt.wtTable.TABLE),i=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(i||!i&&(r||r==="horizontal"))return!1;let n=Nn(this.TEXTAREA),o=ur(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,c=ur(this.hot.view._wt.wtTable.THEAD),d=Nn(e),u=n.top-d.top-c+a,h=e.scrollHeight-u-c-o,p=s>h&&u>h;return p?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(p?u:h,s),p}limitDropdownIfNeeded(e,i){if(i>e){let r=0,n=0,o=0,s=null;do o=this.htEditor.getRowHeight(n)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,n+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+i-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){let i=this.htEditor.rootElement.style;i.position="absolute",i.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){let e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){let e=this.htEditor.getColWidth(0)+mn(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){let e=this.htEditor.getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){let{allowHtml:i}=this.cellProperties,r=ri(e,o=>Vr(o));return ri(r,o=>i?o:y7(o))}allowKeyEventPropagation(e){let i=this.htEditor.getSelectedRangeLast(),r={row:i?i.from.row:-1},n=!1;return e===ci.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(n=!0),e===ci.ARROW_UP&&r.row>-1&&(n=!0),n}onBeforeKeyDown(e){if($0e(e.keyCode)||e.keyCode===ci.BACKSPACE||e.keyCode===ci.DELETE||e.keyCode===ci.INSERT){let i=10;if(e.keyCode===ci.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(i+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},i)}}};var yY="checkbox",ly=class extends Tc{static get EDITOR_TYPE(){return yY}beginEditing(e,i){if(i&&i.type==="mouseup"&&i.target.nodeName==="TD"){let r=this.TD.querySelector('input[type="checkbox"]');Bt(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}};var gTi=U($e(),1),ab=U(nl(),1);var sb=()=>window,cu=()=>window.document,xY=(t,e)=>window.setTimeout(t,e),Vf=function(t,e,i,r){t.addEventListener(e,i,!!r)},Cm=function(t,e,i,r){t.removeEventListener(e,i,!!r)},Fut=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},ad=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},wY=function(t,e){ad(t,e)||(t.className=t.className===""?e:t.className+" "+e)},CY=function(t,e){t.className=Fut((" "+t.className+" ").replace(" "+e+" "," "))},SY=function(t){return/Array/.test(Object.prototype.toString.call(t))},ld=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Hut=function(t){let e=t.getDay();return e===0||e===6},But=function(t){return t%4===0&&t%100!==0||t%400===0},kCe=function(t,e){return[31,But(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},aB=function(t){ld(t)&&t.setHours(0,0,0,0)},lB=function(t,e){return t.getTime()===e.getTime()},cB=function(t,e,i){let r,n;for(r in e)n=t[r]!==void 0,n&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?ld(e[r])?i&&(t[r]=new Date(e[r].getTime())):SY(e[r])?i&&(t[r]=e[r].slice(0)):t[r]=cB({},e[r],i):(i||!n)&&(t[r]=e[r]);return t},OCe=function(t,e,i){let r=cu().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=cB(r,i),t.dispatchEvent(r)},NCe=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Bf={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},PCe=function(t,e,i){for(e+=t.firstDay;e>=7;)e-=7;return i?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Vut=function(t){let e=[],i="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),i="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+i+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},jut=function(t,e){t.setHours(0,0,0,0);let i=t.getDate(),r=t.getDay(),n=e,o=n-1,s=7,a=function(p){return(p+s-1)%s};t.setDate(i+o-a(r));let c=new Date(t.getFullYear(),0,n),d=24*60*60*1e3,u=(t.getTime()-c.getTime())/d;return 1+Math.round((u-o+a(c.getDay()))/s)},zut=function(t,e,i,r,n){let o=new Date(r,i,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():jut(o,n))+"</td>"},Wut=function(t,e,i,r){return'<tr class="pika-row'+(i?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Uut=function(t){return"<tbody>"+t.join("")+"</tbody>"},qut=function(t){let e,i=[];for(t.showWeekNumber&&i.push("<th></th>"),e=0;e<7;e++)i.push('<th scope="col"><abbr title="'+PCe(t,e)+'">'+PCe(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?i.reverse():i).join("")+"</tr></thead>"},Yut=function(t,e,i,r,n,o){let s,a,c,d=t._o,u=i===d.minYear,h=i===d.maxYear,p='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,m,g=!0,y=!0;for(c=[],s=0;s<12;s++)c.push('<option value="'+(i===n?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(u&&s<d.minMonth||h&&s>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+d.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+c.join("")+"</select></div>",SY(d.yearRange)?(s=d.yearRange[0],a=d.yearRange[1]+1):(s=i-d.yearRange,a=1+i+d.yearRange),c=[];s<a&&s<=d.maxYear;s++)s>=d.minYear&&c.push('<option value="'+s+'"'+(s===i?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+i+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+c.join("")+"</select></div>",d.showMonthAfterYear?p+=m+f:p+=f+m,u&&(r===0||d.minMonth>=r)&&(g=!1),h&&(r===11||d.maxMonth<=r)&&(y=!1),e===0&&(p+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(p+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),p+="</div>"},$ut=function(t,e,i){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+i+'">'+qut(t)+Uut(e)+"</table>"};function dB(t){let e=this,i=e.config(t);e._onMouseDown=function(n){if(!e._v)return;n=n||sb().event;let o=n.target||n.srcElement;if(o)if(ad(o,"is-disabled")||(ad(o,"pika-button")&&!ad(o,"is-empty")&&!ad(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),i.bound&&xY(function(){e.hide(),i.blurFieldOnSelect&&i.field&&i.field.blur()},100)):ad(o,"pika-prev")?e.prevMonth():ad(o,"pika-next")&&e.nextMonth()),ad(o,"pika-select"))e._c=!0;else if(n.preventDefault)n.preventDefault();else return n.returnValue=!1,!1},e._onChange=function(n){n=n||sb().event;let o=n.target||n.srcElement;o&&(ad(o,"pika-select-month")?e.gotoMonth(o.value):ad(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(n){if(n=n||sb().event,e.isVisible())switch(n.keyCode){case 13:case 27:i.field&&i.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(i.parse)return i.parse(i.field.value,i.format);if(this.hasMoment){let n=this.moment(i.field.value,i.format,i.formatStrict);return n&&n.isValid()?n.toDate():null}else return new Date(Date.parse(i.field.value))},e._onInputChange=function(n){let o;n.firedBy!==e&&(o=e._parseFieldValue(),ld(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let n=cu().activeElement;do if(ad(n,"pika-single"))return;while(n=n.parentNode);e._c||(e._b=xY(function(){e.hide()},50)),e._c=!1},e._onClick=function(n){n=n||sb().event;let o=n.target||n.srcElement,s=o;if(o){!hasEventListeners&&ad(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Vf(o,"change",e._onChange)));do if(ad(s,"pika-single")||s===i.trigger)return;while(s=s.parentNode);e._v&&o!==i.trigger&&s!==i.trigger&&e.hide()}},e.el=cu().createElement("div"),e.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:""),Vf(e.el,"mousedown",e._onMouseDown,!0),Vf(e.el,"touchend",e._onMouseDown,!0),Vf(e.el,"change",e._onChange),i.keyboardInput&&Vf(cu(),"keydown",e._onKeyChange),i.field&&(i.container?i.container.appendChild(e.el):i.bound?cu().body.appendChild(e.el):i.field.parentNode.insertBefore(e.el,i.field.nextSibling),Vf(i.field,"change",e._onInputChange),i.defaultDate||(i.defaultDate=e._parseFieldValue(),i.setDefaultDate=!0));let r=i.defaultDate;ld(r)?i.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),i.bound?(this.hide(),e.el.className+=" is-bound",Vf(i.trigger,"click",e._onInputClick),Vf(i.trigger,"focus",e._onInputFocus),Vf(i.trigger,"blur",e._onInputBlur)):this.show()}dB.prototype={config:function(t){this._o||(this._o=cB({},Bf,!0));let e=cB(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let i=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=i>4?4:i,ld(e.minDate)||(e.minDate=!1),ld(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),SY(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Bf.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,ld(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return ld(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",OCe(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!ld(t))return;let i=this._o.minDate,r=this._o.maxDate;ld(i)&&t<i?t=i:ld(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),aB(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),OCe(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(ld(t)){if(this.calendars){let i=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),n=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=n<i.getTime()||r.getTime()<n}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let i=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,n;t==="add"?n=new Date(i.valueOf()+r):t==="subtract"&&(n=new Date(i.valueOf()-r)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=NCe(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=NCe({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(aB(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Bf.minDate,this._o.minYear=Bf.minYear,this._o.minMonth=Bf.minMonth,this._o.startRange=Bf.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(aB(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Bf.maxDate,this._o.maxYear=Bf.maxYear,this._o.maxMonth=Bf.maxMonth,this._o.endRange=Bf.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,i=e.minYear,r=e.maxYear,n=e.minMonth,o=e.maxMonth,s="",a;this._y<=i&&(this._y=i,!isNaN(n)&&this._m<n&&(this._m=n)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let c=0;c<e.numberOfMonths;c++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Yut(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year,a)+this.render(this.calendars[c].year,this.calendars[c].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&xY(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,i,r,n,o,s,a,c,d,u;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,i=this.el.offsetHeight,r=sb().innerWidth||cu().documentElement.clientWidth,n=sb().innerHeight||cu().documentElement.clientHeight,o=cu().body.scrollTop||cu().documentElement.scrollTop,d=!0,u=!0,c=t.getBoundingClientRect(),s=c.left+sb().pageXOffset,a=c.bottom+sb().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,d=!1),(this._o.reposition&&a+i>n+o||this._o.position.indexOf("top")>-1&&a-i-t.offsetHeight>0)&&(a=a-i-t.offsetHeight,u=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",wY(this.el,d?"left-aligned":"right-aligned"),wY(this.el,u?"bottom-aligned":"top-aligned"),CY(this.el,d?"right-aligned":"left-aligned"),CY(this.el,u?"top-aligned":"bottom-aligned"))},render:function(t,e,i){let r=this._o,n=new Date,o=kCe(t,e),s=new Date(t,e,1).getDay(),a=[],c=[];aB(n),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let d=e===0?11:e-1,u=e===11?0:e+1,h=e===0?t-1:t,p=e===11?t+1:t,f=kCe(h,d),m=o+s,g=m;for(;g>7;)g-=7;m+=7-g;let y=!1;for(let w=0,x=0;w<m;w++){let T=new Date(t,e,1+(w-s)),M=ld(this._d)?lB(T,this._d):!1,B=lB(T,n),G=r.events.indexOf(T.toDateString())!==-1,F=w<s||w>=o+s,O=1+(w-s),V=e,J=t,N=r.startRange&&lB(r.startRange,T),P=r.endRange&&lB(r.endRange,T),$=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,K=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&Hut(T)||r.disableDayFn&&r.disableDayFn(T);F&&(w<s?(O=f+O,V=d,J=h):(O=O-o,V=u,J=p));let ve={day:O,month:V,year:J,hasEvent:G,isSelected:M,isToday:B,isDisabled:K,isEmpty:F,isStartRange:N,isEndRange:P,isInRange:$,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&M&&(y=!0),c.push(Vut(ve)),++x===7&&(r.showWeekNumber&&c.unshift(zut(this,w-s,e,t,r.firstWeekOfYearMinDays)),a.push(Wut(c,r.isRTL,r.pickWholeWeek,y)),c=[],x=0,y=!1)}return $ut(r,a,i)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),CY(this.el,"is-hidden"),this._o.bound&&(Vf(cu(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Cm(cu(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),wY(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Cm(this.el,"mousedown",this._onMouseDown,!0),Cm(this.el,"touchend",this._onMouseDown,!0),Cm(this.el,"change",this._onChange),t.keyboardInput&&Cm(cu(),"keydown",this._onKeyChange),t.field&&(Cm(t.field,"change",this._onInputChange),t.bound&&(Cm(t.trigger,"click",this._onInputClick),Cm(t.trigger,"focus",this._onInputFocus),Cm(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function EY(t,e,i){return e=Gut(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Gut(t){var e=Xut(t,"string");return typeof e=="symbol"?e:e+""}function Xut(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FM="date",LCe="dateEditor",cy=class extends Na{constructor(){super(...arguments),EY(this,"defaultDateFormat","DD/MM/YYYY"),EY(this,"parentDestroyed",!1),EY(this,"$datePicker",null)}static get EDITOR_TYPE(){return FM}init(){if(typeof ab.default!="function")throw new Error("You need to include moment.js to your project.");if(typeof dB!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Qe(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Bt(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){let e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,i,r,n,o,s){super.prepare(e,i,r,n,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:LCe})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{let n=this.hot._getEditorManager();n.closeEditor(),this.hot.view.render(),n.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(LCe),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,i)}showDatepicker(e){let i=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),n=e?I5(e.keyCode):!1,o;this.datePicker.style.display="block",this.$datePicker=new dB(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(ab.default),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,(0,ab.default)(o,i,!0).isValid()&&this.$datePicker.setMoment((0,ab.default)(o,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!n&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,(0,ab.default)(o,i,!0).isValid()&&this.$datePicker.setMoment((0,ab.default)(o,i),!0),!n&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){let e=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&U_(i,this.cellProperties.datePickerConfig);let r=i.onSelect,n=i.onClose;return i.field=e,i.trigger=e,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=i.format||this.defaultDateFormat,i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=(0,ab.default)(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},i}refreshDimensions(e){var i;if(super.refreshDimensions(e),this.state!==Pn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}let{rowIndexMapper:r,columnIndexMapper:n}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(i=o.getParentOverlay(this.TD))!==null&&i!==void 0?i:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),c=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),d=n.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),u=n.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=c&&this.col>=d&&this.col<=u){let h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+ur(this.TD)}px`;let p=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?p+=h.right-Ji(this.datePicker):p+=h.left,this.datePickerStyle.left=`${p}px`}else this.hideDatepicker()}};var TY="dropdown",lb=class extends wm{static get EDITOR_TYPE(){return TY}prepare(e,i,r,n,o,s){super.prepare(e,i,r,n,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}};Ct.getSingleton().add("beforeValidate",function(t,e,i){let r=this.propToCol(i);if(Number.isInteger(r)){let n=this.getCellMeta(e,r);n.editor===lb&&n.strict===void 0&&(n.filter=!1,n.strict=!0)}});var RY="numeric",dy=class extends Na{static get EDITOR_TYPE(){return RY}};var AY="password",uy=class extends Na{static get EDITOR_TYPE(){return AY}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Ht(this.TEXTAREA,[ta()]),ia(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}};var IY="ht_editor_visible",FCe="selectEditor",DY="select",hy=class extends Tc{static get EDITOR_TYPE(){return DY}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",Qe(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Bt(this.select,IY)&&Gt(this.select,IY),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,i,r,n,o,s){super.prepare(e,i,r,n,o,s);let a=this.cellProperties.selectOptions,c;typeof a=="function"?c=this.prepareOptions(a(this.row,this.col,this.prop)):c=this.prepareOptions(a),ia(this.select),Kt(c,(d,u)=>{let h=this.hot.rootDocument.createElement("OPTION");h.value=u,Zd(h,d),this.select.appendChild(h)})}prepareOptions(e){let i={};if(Array.isArray(e))for(let r=0,n=e.length;r<n;r++)i[e[r]]=e[r];else typeof e=="object"&&(i=e);return i}refreshValue(){let e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Pn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}let{top:e,start:i,width:r,height:n}=this.getEditedCellRect(),o=this.select.style;o.height=`${n}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${i}px`,o.margin="0px",Qe(this.select,IY)}registerShortcuts(){let i=this.hot.getShortcutManager().getContext("editor"),r={group:FCe};this.isInFullEditMode()&&i.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{let n=this.select.selectedIndex-1;n>=0&&(this.select[n].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{let n=this.select.selectedIndex+1;n<=this.select.length-1&&(this.select[n].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FCe)}};var MY="time",fy=class extends Na{static get EDITOR_TYPE(){return MY}prepare(e,i,r,n,o,s){super.prepare(e,i,r,n,o,s),this.TEXTAREA.dir="ltr"}};function HCe(){Hl(Tc),Hl(wm),Hl(ly),Hl(cy),Hl(lb),Hl(ym),Hl(dy),Hl(uy),Hl(hy),Hl(Na),Hl(fy)}var kY="html";function B1(t,e,i,r,n,o,s){Hf.apply(this,[t,e,i,r,n,o,s]),Zd(e,o??"",!1)}B1.RENDERER_TYPE=kY;var OY="autocomplete";function du(t,e,i,r,n,o,s){let{rootDocument:a}=t,c=s.allowHtml?B1:da,d=a.createElement("DIV"),u=t.getSettings().ariaTags;if(d.className="htAutocompleteArrow",u&&d.setAttribute(...ta()),d.appendChild(a.createTextNode("\u25BC")),c.apply(this,[t,e,i,r,n,o,s]),e.firstChild||e.appendChild(a.createTextNode("\xA0")),e.insertBefore(d,e.firstChild),Qe(e,"htAutocomplete"),!t.acArrowListener){let h=new cs(t);t.acArrowListener=function(p){Bt(p.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(i,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}du.RENDERER_TYPE=OY;var NY="dropdown";function V1(t,e,i,r,n,o,s){du.apply(this,[t,e,i,r,n,o,s])}V1.RENDERER_TYPE=NY;var RRi=U(dt(),1);var BCe=new WeakMap,VCe=new WeakMap,Kut="htBadValue",j1="data-row",z1="data-col",Zut="checkboxRenderer",uB="checkbox";Ct.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,i){let{label:r,type:n,row:o,column:s,prop:a}=e;if(n===uB){if(r){let{value:c,property:d}=r,u=i;if(c)u=typeof c=="function"?c(o,s,a,i):c;else if(d){let h=this.getDataAtRowProp(o,d);u=h!==null?h:i}t=u}return t}});function W1(t,e,i,r,n,o,s){let{rootDocument:a}=t,c=t.getSettings().ariaTags;Hf.apply(this,[t,e,i,r,n,o,s]),Qut(t);let d=Jut(a),u=s.label,h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ia(e),o===s.checkedTemplate||Vr(o).toLocaleLowerCase(s.locale)===Vr(s.checkedTemplate).toLocaleLowerCase(s.locale)?d.checked=!0:o===s.uncheckedTemplate||Vr(o).toLocaleLowerCase(s.locale)===Vr(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?d.checked=!1:jr(o)?Qe(d,"noValue"):(d.style.display="none",Qe(d,Kut),h=!0),Ht(d,[[j1,i],[z1,r]]),c&&Ht(d,[Qx(d.checked?t.getTranslatedPhrase(xM):t.getTranslatedPhrase(SM)),n0e(d.checked),Zbe()]),!h&&u){let g="";if(u.value)g=typeof u.value=="function"?u.value.call(this,i,r,n,o):u.value;else if(u.property){let w=t.getDataAtRowProp(i,u.property);g=w!==null?w:""}let y=eht(a,g,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(y),e.appendChild(d)):(y.appendChild(d),d=y):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(d),e.appendChild(y)):(y.insertBefore(d,y.firstChild),d=y))}(!u||u&&!u.separated)&&e.appendChild(d),h&&e.appendChild(a.createTextNode("#bad-value#")),BCe.has(t)||(BCe.set(t,!0),p());function p(){let y=t.getShortcutManager().getContext("grid"),w={group:Zut,relativeToGroup:ul,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var x;return(x=t.getSelectedRangeLast())===null||x===void 0?void 0:x.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{let x=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&x?.isSingle()&&x.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var x;return(x=t.getSelectedRangeLast())===null||x===void 0?void 0:x.highlight.isCell()}}],w)}function f(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=t.getSelectedRange(),w=[],x=[],T=0;if(y){for(let M=0;M<y.length;M++){let{row:B,col:G}=y[M].getTopStartCorner(),{row:F,col:O}=y[M].getBottomEndCorner();for(let V=B;V<=F;V+=1)for(let J=G;J<=O;J+=1){let N=t.getCellMeta(V,J),P={checkedTemplate:N.checkedTemplate,uncheckedTemplate:N.uncheckedTemplate};if(N.type!=="checkbox")return;if(N.readOnly===!0)continue;typeof N.checkedTemplate>"u"&&(N.checkedTemplate=!0),typeof N.uncheckedTemplate>"u"&&(N.uncheckedTemplate=!1);let $=t.getDataAtCell(V,J);g===!1?[N.checkedTemplate,N.checkedTemplate.toString()].includes($)?x.push([V,J,N.uncheckedTemplate,P]):[N.uncheckedTemplate,N.uncheckedTemplate.toString(),null,void 0].includes($)&&x.push([V,J,N.checkedTemplate,P]):x.push([V,J,N.uncheckedTemplate,P]),T+=1}w.push(T),T=0}x.every(M=>{let[,,B]=M;return B===x[0][2]})?x=x.map(M=>{let[B,G,F]=M;return[B,G,F]}):x=x.map(M=>{let[B,G,,F]=M;return[B,G,F.checkedTemplate]}),x.length>0&&w.forEach(M=>{let B=x.splice(0,M);t.setDataAtCell(B)})}}function m(){let g=t.getSelectedRange();if(g){for(let y=0;y<g.length;y++){let w=g[y].getTopStartCorner(),x=g[y].getBottomEndCorner();for(let T=w.row;T<=x.row;T++)for(let M=w.col;M<=x.col;M++){let B=t.getCellMeta(T,M);if(B.type!=="checkbox")return!1;let G=t.getCell(T,M);if(G==null)return!0;if(G.querySelectorAll("input[type=checkbox]").length>0&&!B.readOnly)return!0}}return!1}}}W1.RENDERER_TYPE=uB;function Qut(t){let e=VCe.get(t);if(!e){let{rootElement:i}=t;e=new cs(t),e.addEventListener(i,"click",r=>iht(r,t)),e.addEventListener(i,"mouseup",r=>tht(r,t)),e.addEventListener(i,"change",r=>rht(r,t)),VCe.set(t,e)}return e}function Jut(t){let e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function eht(t,e,i){let r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${i?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function tht(t,e){let{target:i}=t;PY(i)&&(!i.hasAttribute(j1)||!i.hasAttribute(z1)||setTimeout(e.listen,10))}function iht(t,e){let{target:i}=t;if(!PY(i)||!i.hasAttribute(j1)||!i.hasAttribute(z1))return;let r=parseInt(i.getAttribute(j1),10),n=parseInt(i.getAttribute(z1),10);e.getCellMeta(r,n).readOnly&&t.preventDefault()}function rht(t,e){let{target:i}=t;if(!PY(i)||!i.hasAttribute(j1)||!i.hasAttribute(z1))return;let r=parseInt(i.getAttribute(j1),10),n=parseInt(i.getAttribute(z1),10),o=e.getCellMeta(r,n);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,n,s)}}function PY(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}var LY="handsontable";function U1(t,e,i,r,n,o,s){du.apply(this,[t,e,i,r,n,o,s])}U1.RENDERER_TYPE=LY;var URi=U(dt(),1),cb=U(zCe(),1);var HY="numeric";function hB(t,e){if(ds(t)){let i=e.numericFormat,r=i&&i.culture||"-",n=i&&i.pattern;if(typeof r<"u"&&!cb.default.languages()[r]){let o=r.replace("-",""),s=cb.default.allLanguages?cb.default.allLanguages[r]:cb.default[o];s&&cb.default.registerLanguage(s)}cb.default.setLanguage(r),t=(0,cb.default)(t).format(n||"0")}return t}function q1(t,e,i,r,n,o,s){let a=o;if(ds(a)){let c=s.className||"",d=c.length?c.split(" "):[];a=hB(a,s),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),s.className=d.join(" "),e.dir="ltr"}da(t,e,i,r,n,a,s)}q1.RENDERER_TYPE=HY;var BY="password";function Y1(t,e,i,r,n,o,s){da.apply(this,[t,e,i,r,n,o,s]);let a=s.hashLength||e.innerHTML.length,c=s.hashSymbol||"*",d="";_t(a-1,()=>{d+=c}),Zd(e,d)}Y1.RENDERER_TYPE=BY;var VY="select";function $1(t,e,i,r,n,o,s){da.apply(this,[t,e,i,r,n,o,s])}$1.RENDERER_TYPE=VY;var jY="time";function G1(t,e,i,r,n,o,s){da.apply(this,[t,e,i,r,n,o,s]),e.dir="ltr"}G1.RENDERER_TYPE=jY;function WCe(){yc(du),yc(Hf),yc(W1),yc(V1),yc(U1),yc(B1),yc(q1),yc(Y1),yc($1),yc(da),yc(G1)}var zY="autocomplete";function db(t,e){let i=t;if(i==null&&(i=""),this.allowEmpty&&i===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(i,UCe(i,e)):UCe(i,e)(this.source):e(!0)}db.VALIDATOR_TYPE=zY;function UCe(t,e){let i=t;return function(r){let n=!1;for(let o=0,s=r.length;o<s;o++)if(i===r[o]){n=!0;break}e(n)}}var HM=U(nl(),1);function qCe(t){let e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}var WY="date";function X1(t,e){let i=k5(FM,this.instance),r=t,n=!0;r==null&&(r="");let o=(0,HM.default)(r,this.dateFormat||i.defaultDateFormat,!0).isValid(),s=(0,HM.default)(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(n=!1),!s&&o&&(n=!0),s&&!o)if(this.correctFormat===!0){let a=YCe(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),n=!0}else n=!1;e(n)}X1.VALIDATOR_TYPE=WY;function YCe(t,e){let i=(0,HM.default)(qCe(t)),r=(0,HM.default)(t,e),n=t.search(/[A-z]/g)>-1,o;return i.isValid()&&i.format("x")===r.format("x")||!r.isValid()||n?o=i:o=r,o.format(e)}var UY="dropdown";function K1(t,e){db.apply(this,[t,e])}K1.VALIDATOR_TYPE=UY;var qY="numeric";function Z1(t,e){let i=t;i==null&&(i=""),this.allowEmpty&&i===""?e(!0):e(i===""?!1:ds(t))}Z1.VALIDATOR_TYPE=qY;var BM=U(nl(),1),nht=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],YY="time";function Q1(t,e){let i=this.timeFormat||"h:mm:ss a",r=!0,n=t;n===null&&(n=""),n=/^\d{3,}$/.test(n)?parseInt(n,10):n;let o=/^\d{1,2}$/.test(n);o&&(n+=":00");let s=(0,BM.default)(n,nht,!0).isValid()?(0,BM.default)(n):(0,BM.default)(n,i),a=s.isValid(),c=(0,BM.default)(n,i,!0).isValid()&&!o;if(this.allowEmpty&&n===""&&(a=!0,c=!0),a||(r=!1),!a&&c&&(r=!0),a&&!c)if(this.correctFormat===!0){let d=s.format(i);this.instance.setDataAtCell(this.visualRow,this.visualCol,d,"timeValidator"),r=!0}else r=!1;e(r)}Q1.VALIDATOR_TYPE=YY;function $Ce(){Uv(db),Uv(K1),Uv(X1),Uv(Z1),Uv(Q1)}var $Y="autocomplete",GY={CELL_TYPE:$Y,editor:wm,renderer:du,validator:db};var XY="checkbox",KY={CELL_TYPE:XY,editor:ly,renderer:W1};var GCe="date";function fB(t,e,i,r,n,o,s){du.apply(this,[t,e,i,r,n,o,s])}fB.RENDERER_TYPE=GCe;var ZY="date",QY={CELL_TYPE:ZY,editor:cy,renderer:fB,validator:X1};var JY="dropdown",e$={CELL_TYPE:JY,editor:lb,renderer:V1,validator:K1};var t$="handsontable",i$={CELL_TYPE:t$,editor:ym,renderer:U1};var r$="numeric",n$={CELL_TYPE:r$,editor:dy,renderer:q1,validator:Z1,dataType:"number"};var o$="password",s$={CELL_TYPE:o$,editor:uy,renderer:Y1,copyable:!1};var a$="select",l$={CELL_TYPE:a$,editor:hy,renderer:$1};var c$="time",d$={CELL_TYPE:c$,editor:fy,renderer:G1,validator:Q1};function XCe(){sd(GY),sd(KY),sd(QY),sd(e$),sd(i$),sd(n$),sd(s$),sd(l$),sd(LM),sd(d$)}var ODi=U($e(),1),NDi=U(dt(),1),PDi=U(ln(),1),LDi=U(cn(),1),FDi=U(dn(),1),HDi=U(un(),1),BDi=U(hn(),1),VDi=U(fn(),1),jDi=U(pn(),1);var cDi=U($e(),1),dDi=U(dt(),1);function oht(t,e){QCe(t,e),e.add(t)}function sht(t,e,i){QCe(t,e),e.set(t,i)}function QCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J1(t,e,i){return e=aht(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function aht(t){var e=lht(t,"string");return typeof e=="symbol"?e:e+""}function lht(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eS(t,e){return t.get(JCe(t,e))}function JCe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var KCe=new Map([["plugin",f_e],["cell-type",tY],["editor",L7],["renderer",X7],["validator",Z7]]),exe="base",u$=[],jf=null,py=new WeakMap,ZCe=new WeakSet,Zt=class{static get PLUGIN_KEY(){return exe}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){oht(this,ZCe),J1(this,"eventManager",new cs(this)),J1(this,"pluginName",null),J1(this,"pluginsInitializedCallbacks",[]),J1(this,"isPluginsReady",!1),J1(this,"enabled",!1),J1(this,"initialized",!1),sht(this,py,{}),ra(this,"hot",e,{writable:!1}),jf=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",i=>this.onUpdateSettings(i)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let e=this.constructor.PLUGIN_DEPS,i=Array.isArray(e)?e:[];if(i.length>0){let n=[];if(i.forEach(o=>{let[s,a]=o.split(":");if(!KCe.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);KCe.get(s)(a)||n.push(` - ${a} (${s})`)}),n.length>0){let o=[`The ${this.pluginName} plugin requires the following modules:
`,`${n.join(`
`)}
`].join("");u$.push(o)}}if(jf||(jf=B5()),jf.indexOf("UndoRedo")>=0&&jf.splice(jf.indexOf("UndoRedo"),1),jf.indexOf(this.pluginName)>=0&&jf.splice(jf.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),jf.length===0){if(u$.length>0){let n=[`${u$.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(n)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,i,r){eS(py,this)[e]=eS(py,this)[e]||[];let n=eS(py,this)[e];this.hot.addHook(e,i,r),n.push(i),eS(py,this)[e]=n}removeHooks(e){Ce(eS(py,this)[e]||[],i=>{this.hot.removeHook(e,i)})}clearHooks(){let e=eS(py,this);Kt(e,(i,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Ce(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){let i=JCe(ZCe,this,cht).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&i&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Kt(this,(i,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}};function cht(t){if(!t)return!1;let e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let i=0;i<e.length;i++)if(t[e[i]]!==void 0)return!0;return!1}var CDi=U($e(),1),xDi=U(dt(),1);function my(t,e,i){return e=dht(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function dht(t){var e=uht(t,"string");return typeof e=="symbol"?e:e+""}function uht(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var h$=class{constructor(e){my(this,"hot",null),my(this,"container",null),my(this,"injected",!1),my(this,"rows",[]),my(this,"columns",[]),my(this,"samples",null),my(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,i){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let r={row:e};this.rows.push(r),this.samples=i,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){let i=this.hot.getColHeader(0);if(i!=null){let r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,i){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let r={col:e};this.columns.push(r),this.samples=i,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Ce(this.rows,i=>{e(i.row,ur(i.table)-1)})}getWidths(e){this.injected||this.injectTable(),Ce(this.columns,i=>{let{width:r}=i.table.getBoundingClientRect();e(i.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,i){this.settings||(this.settings={}),this.settings[e]=i}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){let i=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&i.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{Ce(r.strings,n=>{i.appendChild(this.createColElement(n.col,e))})}),i}createRow(e){let{rootDocument:i}=this.hot,r=i.createDocumentFragment(),n=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,n),r.appendChild(n)),this.samples.forEach(o=>{Ce(o.strings,s=>{let a=s.col,c=this.hot.getCellMeta(e,a),d=this.hot.getCellRenderer(c),u=i.createElement("td");u.setAttribute("ghost-table",1),d(this.hot,u,e,a,this.hot.colToProp(a),s.value,c),r.appendChild(u)})}),r}appendColumnHeadersRow(){let{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){let n=e.createElement("th");r.push([-1,n]),i.appendChild(n)}this.samples.forEach(n=>{Ce(n.strings,o=>{let s=o.col,a=e.createElement("th");r.push([s,a]),i.appendChild(a)})}),this.table.tHead.appendChild(i),Ce(r,n=>{let[o,s]=n;this.hot.view.appendColHeader(o,s)})}createCol(e){let{rootDocument:i}=this.hot,r=i.createDocumentFragment();return this.samples.forEach(n=>{Ce(n.strings,o=>{let s=o.row,a=this.hot.getCellMeta(s,e),c=this.hot.getCellRenderer(a),d=i.createElement("td"),u=i.createElement("tr");d.setAttribute("ghost-table",1),c(this.hot,d,s,e,this.hot.colToProp(e),o.value,a),u.appendChild(d),r.appendChild(u)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,i){let r=this.hot.rootDocument.createElement("col"),n=0;i>=0&&e>=0&&(n=this.hot.getCellMeta(i,e).colspan);let o=this.hot.getColWidth(e);if(n>1)for(let s=e+1;s<e+n;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",{rootDocument:i}=this.hot,r=i.createDocumentFragment(),n=i.createElement("table"),o=i.createElement("thead"),s=i.createElement("tbody"),a=i.createElement("colgroup"),c=i.createElement("tr"),d=i.createElement("th");return this.isVertical()&&n.appendChild(a),this.isHorizontal()&&(c.appendChild(d),o.appendChild(c),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(o),this.isVertical()&&s.appendChild(c),n.appendChild(s),Qe(n,e),r.appendChild(n),{fragment:r,table:n,tHead:o,tBody:s,colGroup:a,tr:c,th:d}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",{rootDocument:i}=this.hot,r=i.createDocumentFragment(),n=i.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Qe(n,o),r.appendChild(n),{fragment:r,container:n}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}},pB=h$;var RDi=U($e(),1),ADi=U(dt(),1);function mB(t,e,i){return e=hht(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function hht(t){var e=fht(t,"string");return typeof e=="symbol"?e:e+""}function fht(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var f$=class t{static get SAMPLE_COUNT(){return 3}constructor(e){mB(this,"samples",null),mB(this,"dataFactory",null),mB(this,"customSampleCount",null),mB(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,i){return this.generateSamples("row",i,e)}generateColumnSamples(e,i){return this.generateSamples("col",i,e)}generateSamples(e,i,r){let n=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return _t(o,s,a=>{let c=this.generateSample(e,i,a);n.set(a,c)}),n}generateSample(e,i,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");let n=new Map,o=e==="row"?"col":"row",s=[];return _t(i.from,i.to,a=>{let c=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(c===!1)return;let{value:d,bundleSeed:u}=c,h=typeof u=="string"&&u.length>0,p;h?p=u:Xt(d)?p=`${Object.keys(d).length}`:Array.isArray(d)?p=`${d.length}`:p=`${Vr(d).length}`,n.has(p)||n.set(p,{needed:this.getSampleCount(),strings:[]});let f=n.get(p);f.needed&&(!(s.indexOf(d)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:d,[o]:a}),s.push(d),f.needed-=1)}),n}},gB=f$;function pht(t,e){ixe(t,e),e.add(t)}function mht(t,e,i){ixe(t,e),e.set(t,i)}function ixe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tS(t,e,i){return e=ght(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ght(t){var e=vht(t,"string");return typeof e=="symbol"?e:e+""}function vht(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bht(t,e,i){return t.set(xm(t,e),i),i}function vB(t,e){return t.get(xm(t,e))}function xm(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("modifyAutoColumnSizeSeed");var iS="autoColumnSize",rxe=10,_ht="autoColumnSize",rS=new WeakMap,ub=new WeakSet,VM=class t extends Zt{static get PLUGIN_KEY(){return iS}static get PLUGIN_PRIORITY(){return rxe}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),pht(this,ub),tS(this,"ghostTable",new pB(this.hot)),tS(this,"samplesGenerator",new gB((i,r)=>{let n=this.hot.toPhysicalRow(i),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(o))return!1;let s=this.hot.getCellMeta(i,r),a="";s.spanned||(a=this.hot.getDataAtCell(i,r));let c="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(c=this.hot.runHooks("modifyAutoColumnSizeSeed",c,s,a)),{value:a,bundleSeed:c}})),tS(this,"firstCalculation",!0),tS(this,"inProgress",!1),tS(this,"measuredColumns",0),tS(this,"columnWidthsMap",new la),mht(this,rS,[]),this.hot.columnIndexMapper.registerMap(_ht,this.columnWidthsMap),this.addHook("beforeColumnResize",(i,r,n)=>xm(ub,this,txe).call(this,i,r,n))}isEnabled(){return this.hot.getSettings()[iS]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;let i=this.hot.getSettings()[iS];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return xm(ub,e,wht).call(e,...n)}),this.addHook("beforeChangeRender",r=>xm(ub,this,Cht).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>xm(ub,this,Sht).call(this,r)),this.addHook("beforeViewRender",r=>xm(ub,this,yht).call(this,r)),this.addHook("modifyColWidth",(r,n)=>this.getColumnWidth(n,r)),this.addHook("afterInit",()=>xm(ub,this,xht).call(this)),super.enablePlugin()}updatePlugin(){let e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,i,r)=>xm(ub,this,txe).call(this,e,i,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;let i=this.hot.renderCall,r=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();r===-1||n===-1||this.calculateColumnsWidth({from:r,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=typeof e=="number"?{from:e,to:e}:e,o=typeof i=="number"?{from:i,to:i}:i;_t(n.from,n.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){let c=this.samplesGenerator.generateColumnSamples(s,o);Ce(c,d=>{let[u,h]=d;return this.ghostTable.addColumn(u,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{let c=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(c,a)})},!0),this.measuredColumns=n.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=0,r=this.hot.countCols()-1,n=null;this.inProgress=!0;let o=()=>{if(!this.hot){d1(n),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+t.CALCULATION_STEP,r)},e),i=i+t.CALCULATION_STEP+1,i<r?n=c1(o):(d1(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,i=s+1),i<r?o():this.inProgress=!1}setSamplingOptions(){let e=this.hot.getSettings()[iS],i=e&&Pr(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){let e=this.hot.getSettings()[iS],i=t.SYNC_CALCULATION_LIMIT,r=this.hot.countCols()-1;return Xt(e)&&(i=e.syncLimit,l5(i)?i=H5(r,i):i>>=0),Math.min(i,r)}getColumnWidth(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=i;return n===void 0&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof n=="number"&&(n=Math.max(n,Af.DEFAULT_WIDTH))),n}getFirstVisibleColumn(){let e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){let i=e.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(e.wtViewport.columnsRenderCalculator){let i=e.wtTable.getFirstRenderedColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}return-1}getLastVisibleColumn(){let e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){let i=e.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(e.wtViewport.columnsRenderCalculator){let i=e.wtTable.getLastRenderedColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}return-1}findColumnsWhereHeaderWasChanged(){let e=this.hot.getColHeader();return Gr(e,(r,n,o)=>{let s=vB(rS,this).length;return(s-1<o||vB(rS,this)[o]!==n)&&r.push(o),s-1<o?vB(rS,this).push(n):vB(rS,this)[o]=n,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{Ce(e,i=>{this.columnWidthsMap.setValueAtIndex(i,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!xs(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}};function yht(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function wht(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function Cht(t){let e=ri(t,i=>{let[,r]=i;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function txe(t,e,i){let r=t;return i&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function xht(){bht(rS,this,this.hot.getColHeader())}function Sht(t){let e=xs(t,r=>{var n;return wt((n=r.address)===null||n===void 0?void 0:n.col)}),i=ri(e,r=>r.address.col);this.clearCache(Array.from(new Set(i)))}var sMi=U($e(),1),aMi=U(dt(),1);var hb={horizontal:"horizontal",vertical:"vertical"};function nxe(t,e,i){let r,n,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=i(e[0],e[1]),n=i(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=i(e[0],t[3]+1),n=i(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=i(e[0],e[1]),n=i(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=i(t[2]+1,e[1]),n=i(e[2],e[3])),r&&r.normalize(),n&&n.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:n}}function oxe(t){let e={};return t===!0?(e.directions=Object.keys(hb),e.autoInsertRow=!0):Xt(t)?(wt(t.autoInsertRow)?t.direction===hb.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,wt(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(hb)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Eht(t,e){Tht(t,e),e.add(t)}function Tht(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nS(t,e,i){return e=Rht(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Rht(t){var e=Aht(t,"string");return typeof e=="symbol"?e:e+""}function Aht(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jM(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("modifyAutofillRange");Ct.getSingleton().register("beforeAutofill");Ct.getSingleton().register("afterAutofill");var p$="autofill",sxe=20,Iht=["fillHandle"],Dht="insert_row_below",Mht=200,oS=new WeakSet,zM=class extends Zt{constructor(){super(...arguments),Eht(this,oS),nS(this,"addingStarted",!1),nS(this,"mouseDownOnCellCorner",!1),nS(this,"mouseDragOutside",!1),nS(this,"handleDraggedCells",0),nS(this,"directions",[]),nS(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return p$}static get PLUGIN_PRIORITY(){return sxe}static get SETTING_KEYS(){return[p$,...Iht]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>jM(oS,this,Oht).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>jM(oS,this,kht).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,i)=>jM(oS,this,Nht).call(this,i)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=this.hot.getSelectedRangeLast(),{row:i,col:r}=e.getTopStartCorner(),{row:n,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:i,startCol:r,endRow:n,endCol:o}]),a=[],c=[],d=[];return Ce(s,u=>{for(let h=u.startRow;h<=u.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=u.startCol;h<=u.endCol;h+=1)c.indexOf(h)===-1&&c.push(h)}),Ce(a,u=>{let h=[];Ce(c,p=>{h.push(this.hot.getCopyableData(u,p))}),d.push(h)}),d}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[e,i,r,n]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();let c=[s.row,s.col,a.row,a.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,i),Math.max(a.row,r),Math.max(a.col,n)],c),{directionOfDrag:u,startOfDragCoords:h,endOfDragCoords:p}=nxe(c,d,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){let f=this.getSelectionData(),m=o.clone(),g=this.hot._createCellRange(h,h,p),y=this.hot.runHooks("beforeAutofill",f,m,g,u);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let w=y,x=y;if(["up","left"].indexOf(u)>-1&&!(x.length===1&&x[0].length===0))if(w=[],u==="up"){let T=p.row-h.row+1,M=T%x.length;for(let B=0;B<T;B++)w.push(x[(B+(x.length-M))%x.length])}else{let T=p.col-h.col+1,M=T%x[0].length;for(let B=0;B<x.length;B++){w.push([]);for(let G=0;G<T;G++)w[B].push(x[B][(G+(x[B].length-M))%x[B].length])}}this.hot.populateFromArray(h.row,h.col,w,p.row,p.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",w,m,g,u),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){let i=this.hot.getSelectedRangeLast(),r=i.getBottomEndCorner(),n=e;if(this.directions.includes(hb.vertical)&&this.directions.includes(hb.horizontal)){let o=i.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(n=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(n=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(hb.vertical))n=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(hb.horizontal))n=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(n)}showBorder(e){let i=this.getCoordsOfDragAndDropBorders(e);i&&this.redrawBorders(i)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Dht,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Mht)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){let e=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&i[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){let i=this.hot.getData(),r=this.hot.countRows(),n;for(let o=e[2]+1;o<r;o++){for(let c=e[1];c<=e[3];c++){let d=i[o][c];if(!jr(d))return-1}let s=i[o][e[1]-1],a=i[o][e[3]+1];(!jr(s)||!jr(a))&&(n=o)}return n}addSelectionFromStartAreaToSpecificRowIndex(e,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(i,e[3])).commit()}setSelection(e){this.hot.selectCell(...ri(e,i=>Math.max(i,0)),!1,!1)}selectAdjacent(){let e=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(e);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,i),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){let{documentElement:i}=this.hot.rootDocument,r=Nn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+ur(this.hot.table),n=Nn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+Ji(this.hot.table);return e.clientY>r&&e.clientX<=n}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>jM(oS,this,Pht).call(this)),this.eventManager.addEventListener(e,"mousemove",i=>jM(oS,this,Lht).call(this,i))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let e=oxe(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}};function kht(){this.selectAdjacent()&&this.fillIn()}function Oht(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Nht(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Pht(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Lht(t){let e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}var vMi=U($e(),1);function Fht(t,e){Hht(t,e),e.add(t)}function Hht(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gy(t,e,i){return e=Bht(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Bht(t){var e=Vht(t,"string");return typeof e=="symbol"?e:e+""}function Vht(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WM(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var UM="autoRowSize",lxe=40,jht="autoRowSize",sS=new WeakSet,qM=class t extends Zt{static get PLUGIN_KEY(){return UM}static get PLUGIN_PRIORITY(){return lxe}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Fht(this,sS),gy(this,"headerHeight",null),gy(this,"ghostTable",new pB(this.hot)),gy(this,"samplesGenerator",new gB((i,r)=>{let n=this.hot.toPhysicalRow(i),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(o)||i>=0&&r>=0&&this.hot.getCellMeta(i,r).hidden)return!1;let s;return i>=0?s=this.hot.getDataAtCell(i,r):i===-1&&(s=this.hot.getColHeader(r)),{value:s}})),gy(this,"firstCalculation",!0),gy(this,"inProgress",!1),gy(this,"measuredRows",0),gy(this,"rowHeightsMap",new la),this.hot.rowIndexMapper.registerMap(jht,this.rowHeightsMap),this.addHook("beforeRowResize",(i,r,n)=>WM(sS,this,axe).call(this,i,r,n))}isEnabled(){let e=this.hot.getSettings()[UM];return e===!0||Xt(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return WM(sS,e,Wht).call(e,...r)}),this.addHook("beforeChangeRender",i=>WM(sS,this,Uht).call(this,i)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",i=>WM(sS,this,zht).call(this,i)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,i,r)=>WM(sS,this,axe).call(this,e,i,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=typeof e=="number"?{from:e,to:e}:e,o=typeof i=="number"?{from:i,to:i}:i;if(this.hot.getColHeader(0)!==null){let s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}_t(n.from,n.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){let a=this.samplesGenerator.generateRowSamples(s,o);Ce(a,c=>{let[d,u]=c;return this.ghostTable.addRow(d,u)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=n.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=0,r=this.hot.countRows()-1,n=null;this.inProgress=!0;let o=()=>{if(!this.hot){d1(n),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+t.CALCULATION_STEP,r)},e),i=i+t.CALCULATION_STEP+1,i<r?n=c1(o):(d1(n),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,i=s+1),i<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){let e=this.hot.getSettings()[UM],i=e&&Pr(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Xd(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){let e=this.hot.getSettings()[UM],i=t.SYNC_CALCULATION_LIMIT,r=this.hot.countRows()-1;return Xt(e)&&(i=e.syncLimit,l5(i)?i=H5(r,i):i>>=0),Math.min(i,r)}getRowHeight(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),n=i;return r!==null&&r>(i||0)&&(n=r),n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){let e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){let e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){let{from:i,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{_t(Math.min(i,r),Math.max(i,r),n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0)}isNeedRecalculate(){return!!xs(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}};function zht(){let t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,i=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(i===-1||r===-1)){if(this.calculateRowsHeight({from:i,to:r},void 0,t),e){let n=this.hot.countRows()-1;this.calculateRowsHeight({from:n-e,to:n})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function axe(t,e,i){let r=t;return i&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Wht(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function Uht(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}var PMi=U($e(),1);var{getListWithInsertedItems:qht,getListWithRemovedItems:Yht}=JI("physicallyIndexed"),m$=class extends Bl{constructor(){super(e=>e)}insert(e,i){let r=tb(this.indexedValues,i);this.indexedValues=qht(r,e,i,this.initValueOrFn),super.insert(e,i)}remove(e){let i=Yht(this.indexedValues,e);this.indexedValues=eb(i,e),super.remove(e)}},cxe=m$;var{getListWithInsertedItems:$ht,getListWithRemovedItems:Ght}=JI("physicallyIndexed"),g$=class extends Bl{constructor(){super(e=>e)}insert(e,i){this.indexedValues=$ht(this.indexedValues,e,i,(r,n)=>this.getNextValue(n)),super.insert(e,i)}remove(e){this.indexedValues=Ght(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}},dxe=g$;function Xht(t,e){Kht(t,e),e.add(t)}function Kht(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zht(t,e,i){return e=Qht(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Qht(t){var e=Jht(t,"string");return typeof e=="symbol"?e:e+""}function Jht(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eft(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var bB="bindRowsWithHeaders",hxe=210,tft="loose",ift=new Map([["loose",cxe],["strict",dxe]]),uxe=new WeakSet,YM=class extends Zt{constructor(){super(...arguments),Xht(this,uxe),Zht(this,"headerIndexes",null)}static get PLUGIN_KEY(){return bB}static get PLUGIN_PRIORITY(){return hxe}isEnabled(){return!!this.hot.getSettings()[bB]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[bB];typeof e!="string"&&(e=tft);let i=ift.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new i),this.addHook("modifyRowHeader",r=>eft(uxe,this,rft).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}};function rft(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}var zMi=U($e(),1),WMi=U(dt(),1);function nft(t,e){vxe(t,e),e.add(t)}function oft(t,e,i){vxe(t,e),e.set(t,i)}function vxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fxe(t,e,i){return e=sft(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function sft(t){var e=aft(t,"string");return typeof e=="symbol"?e:e+""}function aft(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pxe(t,e){return t.get(lS(t,e))}function v$(t,e,i){return t.set(lS(t,e),i),i}function lS(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var GM="collapsibleColumns",bxe=290,lft=["nestedHeaders"],cS="collapsibleIndicator",mxe=GM,gxe=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),aS=new WeakMap,$M=new WeakSet,XM=class extends Zt{constructor(){super(...arguments),nft(this,$M),fxe(this,"nestedHeadersPlugin",null),fxe(this,"headerStateManager",null),oft(this,aS,null)}static get PLUGIN_KEY(){return GM}static get PLUGIN_PRIORITY(){return bxe}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[GM,...lft]}isEnabled(){return!!this.hot.getSettings()[GM]}enablePlugin(){var e=this;if(this.enabled)return;let{nestedHeaders:i}=this.hot.getSettings();i||Zi("You need to configure the Nested Headers plugin in order to use collapsible headers."),v$(aS,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>lS($M,this,uft).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return lS($M,e,hft).call(e,...n)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return lS($M,e,cft).call(e,...n)}),this.addHook("beforeOnCellMouseDown",(r,n,o)=>lS($M,this,dft).call(this,r,n,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){let{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(i=>({collapsible:i.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),v$(aS,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;let{row:i,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:n,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(i,r))!==null&&e!==void 0?e:{};if(n)return o?this.expandSection({row:i,col:s}):this.collapseSection({row:i,col:s}),!1},runOnlyIf:()=>{var e,i;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader())},group:mxe,relativeToGroup:ul,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mxe)}clearButtons(){if(!this.hot.view)return;let e=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};_t(0,e-1,s=>{let a=i.childNodes[s],c=r.childNodes[s],d=n?n.childNodes[s]:null;_t(0,a.childNodes.length-1,u=>{let h=a.childNodes[u].querySelector(`.${cS}`);o(h),c&&c.childNodes[u]&&(h=c.childNodes[u].querySelector(`.${cS}`),o(h)),n&&d&&d.childNodes[u]&&(h=d.childNodes[u].querySelector(`.${cS}`),o(h))})},!0)}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){let i=this.headerStateManager.mapNodes(r=>{let{collapsible:n,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:c}=r;if(n===!0&&o>1&&(c&&e==="expand"||!c&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(i,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,i){if(!gxe.has(i))throw new Error(`Unsupported action is passed (${i}).`);if(!Array.isArray(e))return;let r=xs(e,f=>{let{row:m}=f;return m<0}),n=r.length>0;Ce(r,f=>{var m;let{row:g,col:y}=f,{collapsible:w,isCollapsed:x}=(m=this.headerStateManager.getHeaderSettings(g,y))!==null&&m!==void 0?m:{};if(!w||x&&i==="collapse"||!x&&i==="expand")return n=!1,!1});let o=[],s=[];n&&Ce(r,f=>{let{row:m,col:g}=f,{colspanCompensation:y,affectedColumns:w,rollbackModification:x}=this.headerStateManager.triggerNodeModification(i,m,g);y>0&&(s.push(...w),o.push(x))});let a=this.getCollapsedColumns(),c=[];i==="collapse"?c=o5([...a,...s]):i==="expand"&&(c=xs(a,f=>!s.includes(f)));let d=gxe.get(i);if(this.hot.runHooks(d.beforeHook,a,c,n)===!1){Ce(o,f=>{f()});return}this.hot.batchExecution(()=>{Ce(s,f=>{pxe(aS,this).setValueAtIndex(this.hot.toPhysicalColumn(f),d.hideColumn)})},!0);let h=this.getCollapsedColumns().length!==a.length,p=this.hot.getSelectedRangeLast();if(i==="collapse"&&h&&p){let{row:f,col:m}=p.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){let y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,w=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;y!==null&&w!==null&&this.hot.selectCell(y,w)}}this.hot.runHooks(d.afterHook,a,c,n,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return pxe(aS,this).getHiddenIndexes()}destroy(){v$(aS,this,null),super.destroy()}};function cft(t,e,i){var r;let{collapsible:n,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(i,t))!==null&&r!==void 0?r:{},a=n&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,c=this.hot.getSettings().ariaTags,d=e.querySelector(`.${cS}`);if(Kd(e,[Oa("")[0]]),a)d||(d=this.hot.rootDocument.createElement("div"),Qe(d,cS),e.querySelector("div:first-child").appendChild(d)),Gt(d,["collapsed","expanded"]),s?(Qe(d,"collapsed"),Qd(d,"+"),c&&Ht(e,...Oa(!1))):(Qe(d,"expanded"),Qd(d,"-"),c&&Ht(e,...Oa(!0))),c&&Ht(d,...ta());else{var u;(u=d)===null||u===void 0||u.remove()}}function dft(t,e){Bt(t.target,cS)&&(Bt(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Bt(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Uo(t))}function uft(){this.updatePlugin()}function hft(t,e){e||this.updatePlugin()}var Zki=U($e(),1),Qki=U(dt(),1);var tki=U($e(),1);function vy(t,e,i){return e=fft(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function fft(t){var e=pft(t,"string");return typeof e=="symbol"?e:e+""}function pft(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mft=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],gft=!1,vft=!0,bft=!0,_B=class{constructor(e,i){vy(this,"hot",void 0),vy(this,"sortingStates",new Nf),vy(this,"sortEmptyCells",gft),vy(this,"indicator",vft),vy(this,"headerAction",bft),vy(this,"compareFunctionFactory",void 0),vy(this,"mapName",void 0),this.hot=e,this.mapName=i,this.hot.columnIndexMapper.registerMap(i,this.sortingStates)}updateAllColumnsProperties(e){Xt(e)&&Kt(e,(i,r)=>{mft.includes(r)&&(this[r]=i)})}getAllColumnsProperties(){let e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var i;return(i=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||i===void 0?void 0:i.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(i=>{let[r]=i;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Xt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(i=>{let[r,n]=i;return Ke({column:this.hot.toVisualColumn(r)},n)})}getColumnSortState(e){let i=this.getSortOrderOfColumn(e);if(wt(i))return{column:e,sortOrder:i}}setSortStates(e){this.sortingStates.clear();for(let i=0;i<e.length;i+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[i].column),{sortOrder:e[i].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}};var Oki=U(ln(),1),Nki=U(cn(),1),Pki=U(dn(),1),Lki=U(un(),1),Fki=U(hn(),1),Hki=U(fn(),1),Bki=U(pn(),1),w$=U(nl(),1);function yB(t,e,i){let r=e.locale;return function(n,o){let{sortEmptyCells:s}=i;return typeof n=="string"&&(n=n.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),n===o?hl:jr(n)?jr(o)?hl:s?t==="asc"?Tn:Rn:Rn:jr(o)?s?t==="asc"?Rn:Tn:Tn:isNaN(n)&&!isNaN(o)?t==="asc"?Rn:Tn:!isNaN(n)&&isNaN(o)?t==="asc"?Tn:Rn:(isNaN(n)||isNaN(o)||(n=parseFloat(n),o=parseFloat(o)),n<o?t==="asc"?Tn:Rn:n>o?t==="asc"?Rn:Tn:hl)}}var b$="default";function _xe(t,e,i){return function(r,n){let o=parseFloat(r),s=parseFloat(n),{sortEmptyCells:a}=i;if(o===s||isNaN(o)&&isNaN(s))return hl;if(a){if(jr(r))return t==="asc"?Tn:Rn;if(jr(n))return t==="asc"?Rn:Tn}return isNaN(o)?Rn:isNaN(s)?Tn:o<s?t==="asc"?Tn:Rn:o>s?t==="asc"?Rn:Tn:hl}}var yxe="numeric";function wxe(t,e,i){let r=e.checkedTemplate,n=e.uncheckedTemplate,{sortEmptyCells:o}=i;return function(s,a){let c=jr(s),d=jr(a),u=c?n:s,h=d?n:a,p=u===n||u===r,f=h===n||h===r;if(o===!1){if(c&&d===!1)return Rn;if(c===!1&&d)return Tn}return p===!1&&f?t==="asc"?Tn:Rn:p&&f===!1?t==="asc"?Rn:Tn:p===!1&&f===!1?yB(t,e,i)(s,a):u===n&&h===r?t==="asc"?Tn:Rn:u===r&&h===n?t==="asc"?Rn:Tn:hl}}var Cxe="checkbox";function xxe(t,e,i){return wB(t,e.dateFormat,i)}var Sxe="date";function Exe(t,e,i){return wB(t,e.timeFormat,i)}var Txe="time";var{register:KM,getItem:Rxe,hasItem:_ft}=ls("sorting.compareFunctionFactory"),{register:ZM,getItem:_$}=ls("sorting.mainSortComparator");function QM(t){return _ft(t)?Rxe(t):Rxe(b$)}KM(Cxe,wxe);KM(Sxe,xxe);KM(b$,yB);KM(yxe,_xe);KM(Txe,Exe);var hl=0,Tn=-1,Rn=1;function y$(t,e){let i=_$(e);for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];t.sort(i(...n))}var JM="asc",ek="desc",C$="colHeader";function yft(t){if(Xt(t)===!1)return!1;let{column:e,sortOrder:i}=t;return Number.isInteger(e)&&[JM,ek].includes(i)}function Axe(t){if(t.some(i=>yft(i)===!1))return!1;let e=t.map(i=>{let{column:r}=i;return r});return new Set(e).size===e.length}function x$(t){if(t!==ek)return t===JM?ek:JM}function S$(t){return t.querySelector(`.${C$}`)}function E$(t,e){if(t<0||!e.parentNode)return!1;let i=e.parentNode.parentNode.childNodes;return Array.from(i).indexOf(e.parentNode)-i.length===-1}function tk(t,e,i){return t===-1&&e>=0&&nd(i)===!1}function wB(t,e,i){return function(r,n){let{sortEmptyCells:o}=i;if(r===n)return hl;if(jr(r))return jr(n)?hl:o?t==="asc"?Tn:Rn:Rn;if(jr(n))return o?t==="asc"?Rn:Tn:Tn;let s=(0,w$.default)(r,e),a=(0,w$.default)(n,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Tn:Rn:a.isBefore(s)?t==="asc"?Rn:Tn:hl:Tn:Rn}}var qki=U(dt(),1);var wft="ascending",Cft="descending",Ixe="indicatorDisabled",Dxe="columnSorting",Mxe="sortAction",kxe=new Map([[JM,wft],[ek,Cft]]);function Oxe(t,e,i,r){let n=[Dxe];if(r&&n.push(Mxe),i===!1)return n.push(Ixe),n;let o=t.getSortOrderOfColumn(e);return wt(o)&&n.push(kxe.get(o)),n}function Nxe(){return Array.from(kxe.values()).concat(Mxe,Ixe,Dxe)}function Pxe(t,e){return function(i,r){let[,...n]=i,[,...o]=r;return function(a){let c=t[a],d=e[a],u=n[a],h=o[a],p=d.columnSorting;return(p.compareFunctionFactory?p.compareFunctionFactory:QM(d.type))(c,d,p)(u,h)}(0)}}function xft(t,e){Sft(t,e),e.add(t)}function Sft(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CB(t,e,i){return e=Eft(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Eft(t){var e=Tft(t,"string");return typeof e=="symbol"?e:e+""}function Tft(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dS(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var ik="columnSorting",Fxe=50,uS="append",Hxe="replace",Lxe=ik;ZM(ik,Pxe);Ct.getSingleton().register("beforeColumnSort");Ct.getSingleton().register("afterColumnSort");var by=new WeakSet,_y=class extends Zt{constructor(){super(...arguments),xft(this,by),CB(this,"columnStatesManager",null),CB(this,"columnMetaCache",null),CB(this,"pluginKey",ik),CB(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return ik}static get PLUGIN_PRIORITY(){return Fxe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new _B(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new la(i=>{let r=this.hot.toVisualColumn(i);return r===null&&(r=i),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(i,r)=>dS(by,this,Rft).call(this,i,r)),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return dS(by,e,Ift).call(e,...r)}),this.addHook("afterOnCellMouseDown",(i,r)=>this.onAfterOnCellMouseDown(i,r)),this.addHook("afterInit",()=>dS(by,this,T$).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return dS(by,e,Aft).call(e,...r)}),this.hot.view&&dS(by,this,T$).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){let e=(i,r)=>{let n=S$(r);E$(i,r)===!1||n===null||this.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,i;let r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:ul,position:"before",group:Lxe})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Lxe)}sort(e){let i=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),n=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",i,r,n)!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new k1),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",i,n?r:i,n),n&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return wt(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){let i=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){let i=this.hot.countCols();return Axe(e)&&e.every(r=>{let{column:n}=r;return n<=i&&n>=0})}saveAllSortSettings(e){let i=this.columnStatesManager.getAllColumnsProperties(),r=n=>{let a=n,{column:o}=a,s=Mn(a,["column"]);return Ke({column:this.hot.toPhysicalColumn(o)},s)};i.initialConfig=ri(e,r),this.hot.runHooks("persistentStateSave","columnSorting",i)}getAllSavedSortSettings(){let e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);let i=e.value,r=n=>{let a=n,{column:o}=a,s=Mn(a,["column"]);return Ke({column:this.hot.toVisualColumn(o)},s)};return wt(i)&&Array.isArray(i.initialConfig)&&(i.initialConfig=ri(i.initialConfig,r)),i}getColumnNextConfig(e){let i=this.columnStatesManager.getSortOrderOfColumn(e);if(wt(i)){let n=x$(i);return wt(n)?{column:e,sortOrder:n}:void 0}let r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:x$()}}getNextSortConfig(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uS,r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),n=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(n){if(Qi(s))return[...o.slice(0,r),...o.slice(r+1)];if(i===uS)return[...o.slice(0,r),...o.slice(r+1),s];if(i===Hxe)return[...o.slice(0,r),s,...o.slice(r+1)]}return wt(s)?o.concat(s):o}getPluginColumnConfig(e){if(Xt(e)){let i=e[this.pluginKey];if(Xt(i))return i}return{}}getMergedPluginSettings(e){let i=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(n);return Array.isArray(o.columns)?Object.assign(r,i,this.getPluginColumnConfig(o.columns[e])):nr(o.columns)?Object.assign(r,i,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,i)}getFirstCellSettings(e){let i=this.hot.getCellMeta(0,e),r=Object.create(i);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){let i=this.hot.getSettings();return i.maxRows<=e?i.maxRows:e-i.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}let i=[],r=this.hot.countRows(),n=d=>ri(e,u=>this.hot.getDataAtCell(d,u.column));for(let d=0;d<this.getNumberOfRowsToSort(r);d+=1)i.push([this.hot.toPhysicalRow(d)].concat(n(d)));let o=ri(i,d=>d[0]);y$(i,this.pluginKey,ri(e,d=>d.sortOrder),ri(e,d=>this.getFirstCellSettings(d.column)));for(let d=i.length;d<r;d+=1)i.push([d].concat(n(d)));let s=ri(i,d=>d[0]),a=new Map(ri(o,(d,u)=>[d,s[u]])),c=ri(this.hot.rowIndexMapper.getIndexesSequence(),d=>a.has(d)?a.get(d):d);this.hot.rowIndexMapper.setIndexesSequence(c)}sortBySettings(e){if(Xt(e)){this.columnStatesManager.updateAllColumnsProperties(e);let i=e.initialConfig;(Array.isArray(i)||Xt(i))&&this.sort(i)}else this.hot.render()}updateHeaderClasses(e){if(Gt(e,Nxe(e)),this.enabled!==!1){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];Qe(e,Oxe(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),wt(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,i){return this.getFirstCellSettings(i)[this.pluginKey].headerAction&&Bt(e.target,C$)}onAfterOnCellMouseDown(e,i){tk(i.row,i.col,e)!==!1&&this.wasClickableHeaderClicked(e,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}};function T$(){let t=this.getAllSavedSortSettings();if(Xt(t))this.sortBySettings(t);else{let e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Rft(t,e){let i=S$(e);if(E$(t,e)===!1||i===null)return;let r=this.getFirstCellSettings(t)[this.pluginKey],n=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(i,this.columnStatesManager,t,n,o),this.hot.getSettings().ariaTags){let s=this.columnStatesManager.getSortOrderOfColumn(t);Ht(e,...r0e(s?`${s}ending`:"none"))}}function Aft(t){t===!0&&this.hot.view&&dS(by,this,T$).call(this)}function Ift(t,e,i,r){tk(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}var SOi=U($e(),1);var bOi=U($e(),1),_Oi=U(dt(),1);function yy(t,e,i){return e=Dft(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Dft(t){var e=Mft(t,"string");return typeof e=="symbol"?e:e+""}function Mft(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var R$=class{constructor(e,i){yy(this,"plugin",void 0),yy(this,"hot",void 0),yy(this,"endpoints",[]),yy(this,"settings",void 0),yy(this,"settingsType","array"),yy(this,"currentEndpoint",null),yy(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=i}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){let i=[],r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),Ce(r,n=>{let o={};this.assignSetting(n,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(n,o,"reversedRowCoords",!1),this.assignSetting(n,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(n,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(n,o,"sourceColumn",n.destinationColumn),this.assignSetting(n,o,"type","sum"),this.assignSetting(n,o,"forceNumeric",!1),this.assignSetting(n,o,"suppressDataTypeErrors",!0),this.assignSetting(n,o,"customFunction",null),this.assignSetting(n,o,"readOnly",!0),this.assignSetting(n,o,"roundFloat",!1),i.push(o)}),i}assignSetting(e,i,r,n){if(r==="ranges"&&e[r]===void 0){i[r]=n;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(n instanceof Error)throw n;i[r]=n}else r==="destinationRow"&&i.reversedRowCoords?i[r]=this.hot.countRows()-e[r]-1:i[r]=e[r]}resetSetupBeforeStructureAlteration(e,i,r){if(this.settingsType!=="function")return;let n=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();Ce(o,s=>{n==="row"&&s.destinationRow>=i&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),n==="col"&&s.destinationColumn>=i&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,i,r,n,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){let p=()=>(this.hot.removeHook("beforeViewRender",p),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",p);return}let a=e.indexOf("row")>-1?"row":"col",c=e.indexOf("remove")>-1?-1:1,d=this.getAllEndpoints(),u=e.indexOf("move_row")===0,h=i;Ce(d,p=>{a==="row"&&p.destinationRow>=h&&(p.alterRowOffset=c*r),a==="col"&&p.destinationColumn>=h&&(p.alterColumnOffset=c*r)}),this.resetAllEndpoints(d,!u),u?Ce(d,p=>{this.extendEndpointRanges(p,h,n[0],n.length),this.recreatePhysicalRanges(p),this.clearOffsetInformation(p)}):Ce(d,p=>{this.shiftEndpointCoordinates(p,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,i,r,n){Ce(e.ranges,o=>{o[1]&&(i>=o[0]&&i<=o[1]?r>o[1]?o[1]+=n:r<o[0]&&(o[0]-=n):r>=o[0]&&r<=o[1]&&(o[1]-=n,i<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){let i=e.ranges,r=[],n=[];Ce(i,o=>{let s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));n.push(s)}),Ce(n,o=>{let s=[];Ce(o,(a,c)=>{c===0?s.push(a):o[c]!==o[c-1]+1&&(s.push(o[c-1]),r.push(s),s=[],s.push(a)),c===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,i){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,Ce(e.ranges,r=>{Ce(r,(n,o)=>{n>=i&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(n=>{let o=n.alterRowOffset||0,s=n.alterColumnOffset||0;return n.destinationRow+o>=this.hot.countRows()||n.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],Ce(e,n=>{this.resetEndpointValue(n,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Ce(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){let i=[];this.cellsToSetCache=[],Ce(e,(r,n,o)=>{`${r[2]||""}`!=`${r[3]}`&&Ce(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[n][1])===s.sourceColumn&&i.indexOf(a)===-1&&i.push(a)})}),Ce(i,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{let i=this.hot.toVisualRow(e.destinationRow);if(i!==null){let r=this.hot.getCellMeta(i,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.alterRowOffset||0,n=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(i?r:0)),this.hot.toVisualColumn(e.destinationColumn+(i?n:0)),""])}setEndpointValue(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}let o=this.hot.toVisualRow(e.destinationRow);if(o!==null){let s=this.hot.getCellMeta(o,e.destinationColumn);(i==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){let s=e.roundFloat,a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(n,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Zi("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}},Bxe=R$;function xB(t){return t==null||isNaN(t)}function kft(t,e){Oft(t,e),e.add(t)}function Oft(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nft(t,e,i){return e=Pft(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Pft(t){var e=Lft(t,"string");return typeof e=="symbol"?e:e+""}function Lft(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SB(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var EB="columnSummary",Vxe=220,rk=new WeakSet,nk=class extends Zt{constructor(){super(...arguments),kft(this,rk),Nft(this,"endpoints",null)}static get PLUGIN_KEY(){return EB}static get PLUGIN_PRIORITY(){return Vxe}isEnabled(){return!!this.hot.getSettings()[EB]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[EB],this.endpoints=new Bxe(this,this.settings),this.addHook("afterInit",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return SB(rk,e,Fft).call(e,...r)}),this.addHook("afterChange",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return SB(rk,e,Bft).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return SB(rk,e,Hft).call(e,...r)}),this.addHook("beforeCreateRow",(i,r,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,r,null,n)),this.addHook("beforeCreateCol",(i,r,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,r,null,n)),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(i,r,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",i,r,null,n)),this.addHook("afterCreateCol",(i,r,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",i,r,null,n)),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return SB(rk,e,Vft).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break;default:break}}calculateSum(e){let i=0;return Kt(e.ranges,r=>{i+=this.getPartialSum(r,e.sourceColumn)}),i}getPartialSum(e,i){let r=0,n=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(n,i),o=xB(o)?null:o,o!==null){let a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,n-=1}while(n>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,i){let r=null;return Kt(e.ranges,n=>{let o=this.getPartialMinMax(n,e.sourceColumn,i);if(r===null&&o!==null&&(r=o),o!==null)switch(i){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break;default:break}}),r===null?"Not enough data":r}getPartialMinMax(e,i,r){let n=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,i),s=xB(s)?null:s,n===null)n=s;else if(s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break;default:break}o-=1}while(o>=e[0]);return n}countEmpty(e,i){let r,n=0,o=e[1]||e[0];do r=this.getCellValue(o,i),r=xB(r)?null:r,r===null&&(n+=1),o-=1;while(o>=e[0]);return n}countEntries(e){let i=0,r=e.ranges;return Kt(r,n=>{let o=n[1]===void 0?1:n[1]-n[0]+1,s=this.countEmpty(n,e.sourceColumn);i+=o,i-=s}),i}calculateAverage(e){let i=this.calculateSum(e),r=this.countEntries(e);return i/r}getCellValue(e,i){let r=this.hot.toVisualRow(e),n=this.hot.toVisualColumn(i),o=this.hot.getSourceDataAtCell(e,i),s="";if(r!==null&&n!==null&&(s=this.hot.getCellMeta(r,n).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ai`ColumnSummary plugin: cell at (${e}, ${i}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}};function Fft(){this.endpoints.initEndpoints()}function Hft(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Bft(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Vft(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}var z2i=U($e(),1),W2i=U(dt(),1);var OOi=U($e(),1);function hS(t,e,i){return e=jft(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function jft(t){var e=zft(t,"string");return typeof e=="symbol"?e:e+""}function zft(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var A$=class t{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,i){hS(this,"rootDocument",void 0),hS(this,"isRtl",!1),hS(this,"container",null),hS(this,"editor",void 0),hS(this,"editorStyle",void 0),hS(this,"hidden",!0),this.rootDocument=e,this.isRtl=i,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,i){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${i}px`}setSize(e,i){if(e&&i){let r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${i}px`}}getSize(){return{width:Ji(this.getInputElement()),height:ur(this.getInputElement())}}resetSize(){let e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){let i=this.getInputElement();i.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){let i=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=i}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){let e=this.rootDocument.createElement("div"),i=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Qe(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Qe(e,t.CLASS_EDITOR),Qe(i,t.CLASS_INPUT),i.setAttribute("data-hot-input",!0),e.appendChild(i),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${t.CLASS_INPUT}`)}destroy(){let e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}},jxe=A$;var LOi=U($e(),1);function I$(t,e,i){return e=Wft(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Wft(t){var e=Uft(t,"string");return typeof e=="symbol"?e:e+""}function Uft(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qft=250,Yft=250,TB=class{constructor(e){I$(this,"wasLastActionShow",!0),I$(this,"showDebounced",null),I$(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Yft)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qft;this.showDebounced=o1(i=>{this.wasLastActionShow&&this.runLocalHooks("show",i.from.row,i.from.col)},e)}destroy(){this.clearLocalHooks()}};Mi(TB,En);var zxe=TB;function $ft(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Gft(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function fb(t,e){let i={};return Ce(t,r=>{r.forAll((n,o)=>{n>=0&&o>=0&&(i[n]||(i[n]=[]),i[n][o]=e(n,o))})}),i}function zf(t,e,i,r,n){Ce(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Xft(s,a,e,i,r,n)})})}function Xft(t,e,i,r,n,o){let s=n(t,e),a=r;s.className&&(i==="vertical"?a=$ft(s.className,r):a=Gft(s.className,r)),o(t,e,"className",a)}function uu(t){return`<span class="selected">\u2713</span>${t}`}function cd(t,e){let i=!1;return Array.isArray(t)&&Ce(t,r=>(r.forAll((n,o)=>{if(n>=0&&o>=0&&e(n,o))return i=!0,!1}),i)),i}function fS(t,e){let i={top:0,left:0};if(e!==t.ownerDocument){let{frameElement:r}=e.defaultView,{top:n,left:o}=r.getBoundingClientRect();i.top=n,i.left=o}return i}var gi="---------";function D$(){return{name:gi}}var fl="alignment";function M$(){return{key:fl,name(){return this.getTranslatedPhrase(AD)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${fl}:left`,name(){let t=this.getTranslatedPhrase(ID);return cd(this.getSelectedRange(),(i,r)=>{let n=this.getCellMeta(i,r).className;if(n&&n.indexOf("htLeft")!==-1)return!0})&&(t=uu(t)),t},callback(){let t=this.getSelectedRange(),e=fb(t,(n,o)=>this.getCellMeta(n,o).className),i="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,i,r),zf(t,i,r,(n,o)=>this.getCellMeta(n,o),(n,o,s,a)=>this.setCellMeta(n,o,s,a)),this.render()},disabled:!1},{key:`${fl}:center`,name(){let t=this.getTranslatedPhrase(DD);return cd(this.getSelectedRange(),(i,r)=>{let n=this.getCellMeta(i,r).className;if(n&&n.indexOf("htCenter")!==-1)return!0})&&(t=uu(t)),t},callback(){let t=this.getSelectedRange(),e=fb(t,(n,o)=>this.getCellMeta(n,o).className),i="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,i,r),zf(t,i,r,(n,o)=>this.getCellMeta(n,o),(n,o,s,a)=>this.setCellMeta(n,o,s,a)),this.render()},disabled:!1},{key:`${fl}:right`,name(){let t=this.getTranslatedPhrase(MD);return cd(this.getSelectedRange(),(i,r)=>{let n=this.getCellMeta(i,r).className;if(n&&n.indexOf("htRight")!==-1)return!0})&&(t=uu(t)),t},callback(){let t=this.getSelectedRange(),e=fb(t,(n,o)=>this.getCellMeta(n,o).className),i="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,i,r),zf(t,i,r,(n,o)=>this.getCellMeta(n,o),(n,o,s,a)=>this.setCellMeta(n,o,s,a)),this.render()},disabled:!1},{key:`${fl}:justify`,name(){let t=this.getTranslatedPhrase(kD);return cd(this.getSelectedRange(),(i,r)=>{let n=this.getCellMeta(i,r).className;if(n&&n.indexOf("htJustify")!==-1)return!0})&&(t=uu(t)),t},callback(){let t=this.getSelectedRange(),e=fb(t,(n,o)=>this.getCellMeta(n,o).className),i="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,i,r),zf(t,i,r,(n,o)=>this.getCellMeta(n,o),(n,o,s,a)=>this.setCellMeta(n,o,s,a)),this.render()},disabled:!1},{name:gi},{key:`${fl}:top`,name(){let t=this.getTranslatedPhrase(OD);return cd(this.getSelectedRange(),(i,r)=>{let n=this.getCellMeta(i,r).className;if(n&&n.indexOf("htTop")!==-1)return!0})&&(t=uu(t)),t},callback(){let t=this.getSelectedRange(),e=fb(t,(n,o)=>this.getCellMeta(n,o).className),i="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,i,r),zf(t,i,r,(n,o)=>this.getCellMeta(n,o),(n,o,s,a)=>this.setCellMeta(n,o,s,a)),this.render()},disabled:!1},{key:`${fl}:middle`,name(){let t=this.getTranslatedPhrase(ND);return cd(this.getSelectedRange(),(i,r)=>{let n=this.getCellMeta(i,r).className;if(n&&n.indexOf("htMiddle")!==-1)return!0})&&(t=uu(t)),t},callback(){let t=this.getSelectedRange(),e=fb(t,(n,o)=>this.getCellMeta(n,o).className),i="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,i,r),zf(t,i,r,(n,o)=>this.getCellMeta(n,o),(n,o,s,a)=>this.setCellMeta(n,o,s,a)),this.render()},disabled:!1},{key:`${fl}:bottom`,name(){let t=this.getTranslatedPhrase(PD);return cd(this.getSelectedRange(),(i,r)=>{let n=this.getCellMeta(i,r).className;if(n&&n.indexOf("htBottom")!==-1)return!0})&&(t=uu(t)),t},callback(){let t=this.getSelectedRange(),e=fb(t,(n,o)=>this.getCellMeta(n,o).className),i="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,i,r),zf(t,i,r,(n,o)=>this.getCellMeta(n,o),(n,o,s,a)=>this.setCellMeta(n,o,s,a)),this.render()},disabled:!1}]}}}var wy="clear_column";function k$(){return{key:wy,name(){return this.getTranslatedPhrase(pD)},callback(t,e){let i=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}var Sm="col_left";function O$(){return{key:Sm,name(){return this.getTranslatedPhrase(aD)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}var Em="col_right";function N$(){return{key:Em,name(){return this.getTranslatedPhrase(lD)},callback(){let t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}var Tm="make_read_only";function P$(){return{key:Tm,name(){let t=this.getTranslatedPhrase(fD);return cd(this.getSelectedRange(),(i,r)=>this.getCellMeta(i,r).readOnly)&&(t=uu(t)),t},callback(){let t=this.getSelectedRange(),e=cd(t,(i,r)=>this.getCellMeta(i,r).readOnly);Ce(t,i=>{i.forAll((r,n)=>{r>=0&&n>=0&&this.setCellMeta(r,n,"readOnly",!e)})}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Cy="redo";function L$(){return{key:Cy,name(){return this.getTranslatedPhrase(hD)},callback(){this.redo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}var Rm="remove_col";function F$(){return{key:Rm,name(){let t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{let[,i,,r]=t[0];i-r!==0&&(e=1)}return this.getTranslatedPhrase(dD,e)},callback(){this.alter("remove_col",Xye(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;let e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}var xy="remove_row";function H$(){return{key:xy,name(){let t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{let[i,,r]=t[0];i-r!==0&&(e=1)}return this.getTranslatedPhrase(cD,e)},callback(){this.alter("remove_row",Kye(this),1,"ContextMenu.removeRow")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;let e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}var Sy="row_above";function B$(){return{key:Sy,name(){return this.getTranslatedPhrase(oD)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}var Ey="row_below";function V$(){return{key:Ey,name(){return this.getTranslatedPhrase(sD)},callback(){let t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}var pb="no_items";function j$(){return{key:pb,name(){return this.getTranslatedPhrase(nD)},disabled:!0,isCommand:!1}}var Ty="undo";function z$(){return{key:Ty,name(){return this.getTranslatedPhrase(uD)},callback(){this.undo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}var Wxe=[Sy,Ey,Sm,Em,wy,xy,Rm,Ty,Cy,Tm,fl,gi,pb],Kft={[gi]:D$,[pb]:j$,[Sy]:B$,[Ey]:V$,[Sm]:O$,[Em]:N$,[wy]:k$,[xy]:H$,[Rm]:F$,[Ty]:z$,[Cy]:L$,[Tm]:P$,[fl]:M$};function RB(){let t={};return Kt(Kft,(e,i)=>{t[i]=e()}),t}function W$(t){return{key:"commentsAddEdit",name(){var e;let i=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i!=null&&i.isCell()&&t.getCommentAtCell(i.row,i.col)?this.getTranslatedPhrase(ED):this.getTranslatedPhrase(SD)},callback(){let e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function U$(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(TD)},callback(){this.getSelectedRangeLast().forAll((i,r)=>{i>=0&&r>=0&&t.removeCommentAtCell(i,r,!1)}),this.render()},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function q$(t){return{key:"commentsReadOnly",name(){let e=this.getTranslatedPhrase(RD);return cd(this.getSelectedRange(),(r,n)=>t.getCommentMeta(r,n,ok))?uu(e):e},callback(){this.getSelectedRangeLast().forAll((i,r)=>{if(i>=0&&r>=0){let n=!!t.getCommentMeta(i,r,ok);t.updateCommentMeta(i,r,{[ok]:!n})}})},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Zft(t,e){Uxe(t,e),e.add(t)}function Ry(t,e,i){Uxe(t,e),e.set(t,i)}function Uxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qft(t,e,i){return e=Jft(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Jft(t){var e=ept(t,"string");return typeof e=="symbol"?e:e+""}function ept(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Im(t,e,i){return t.set(hu(t,e),i),i}function rr(t,e){return t.get(hu(t,e))}function hu(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var pS="comments",qxe=60,Am="comment",sk="value",Yxe="style",ok="readOnly",AB=pS,Y$=`plugin:${pS}`,Ln=new WeakMap,dh=new WeakMap,kB=new WeakMap,IB=new WeakMap,DB=new WeakMap,$$=new WeakMap,MB=new WeakMap,ch=new WeakSet,ak=class extends Zt{constructor(){super(...arguments),Zft(this,ch),Qft(this,"range",{}),Ry(this,Ln,null),Ry(this,dh,null),Ry(this,kB,!1),Ry(this,IB,!1),Ry(this,DB,{}),Ry(this,$$,null),Ry(this,MB,"")}static get PLUGIN_KEY(){return pS}static get PLUGIN_PRIORITY(){return qxe}isEnabled(){return!!this.hot.getSettings()[pS]}enablePlugin(){this.enabled||(rr(Ln,this)||Im(Ln,this,new jxe(this.hot.rootDocument,this.hot.isRtl())),rr(dh,this)||Im(dh,this,new zxe(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,i,r,n,o,s)=>hu(ch,this,npt).call(this,e,s)),this.addHook("afterScroll",()=>hu(ch,this,dpt).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>hu(ch,this,cpt).call(this,e)),rr(dh,this).addLocalHook("hide",()=>this.hide()),rr(dh,this).addLocalHook("show",(e,i)=>this.showAtCell(e,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){rr(dh,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let e=this.hot.getShortcutManager(),i=e.getContext("grid"),r=e.addContext(Y$);i.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{let n=this.hot.getSelectedRangeLast();Im(IB,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(n),this.show(),this.focusEditor(),e.setActiveContextName(Y$),this.hot._registerTimeout(()=>{Im(IB,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var n;return((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isCell())&&!rr(Ln,this).isVisible()},group:AB}),r.addShortcut({keys:[["Escape"]],callback:()=>{rr(Ln,this).setValue(rr(MB,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>rr(Ln,this).isVisible()&&rr(Ln,this).isFocused(),group:AB}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>rr(Ln,this).isVisible()&&rr(Ln,this).isFocused(),group:AB})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AB)}registerListeners(){let{rootDocument:e}=this.hot,i=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>hu(ch,this,ipt).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>hu(ch,this,tpt).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>hu(ch,this,rpt).call(this)),this.eventManager.addEventListener(i,"focus",()=>hu(ch,this,spt).call(this)),this.eventManager.addEventListener(i,"blur",()=>hu(ch,this,opt).call(this)),this.eventManager.addEventListener(i,"mousedown",r=>hu(ch,this,apt).call(this,r)),this.eventManager.addEventListener(i,"mouseup",r=>hu(ch,this,lpt).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){let i=Ku(e.target,"TD","TBODY");return!!(i&&Bt(i,"htCommentCell")&&Ku(i,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let i=rr(Ln,this).getValue(),r="";e!=null?r=e:i!=null&&(r=i);let n=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(n,o,{[sk]:r}),this.hot.render()}setCommentAtCell(e,i,r){this.setRange({from:this.hot._createCellCoords(e,i)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Am),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,i)}),this.removeComment(r)}getComment(){let e=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(e,i,sk)}getCommentAtCell(e,i){return this.getCommentMeta(e,i,sk)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let{from:{row:i,col:r}}=this.range;if(i<0||i>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;let n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return rr(dh,this).cancelHiding(),rr(Ln,this).setValue((e=n[Am]?n[Am][sk]:null)!==null&&e!==void 0?e:""),rr(Ln,this).show(),this.refreshEditor(!0),!0}showAtCell(e,i){return this.setRange({from:this.hot._createCellCoords(e,i)}),this.show()}hide(){rr(Ln,this).hide()}refreshEditor(){var e,i;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!rr(Ln,this).isVisible()))return;let{rowIndexMapper:n,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from,c=n.getRenderableFromVisualIndex(s),d=o.getRenderableFromVisualIndex(a),u=c===null;rr(Ln,this).setPosition(0,0),c===null&&(c=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,-1))),d===null&&(d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));let h=c===null,p=d===null;c=(e=c)!==null&&e!==void 0?e:0,d=(i=d)!==null&&i!==void 0?i:0;let{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:g}=m,y=m.getCell({row:c,col:d},!0),w=this.getCommentMeta(s,a,Yxe);w?rr(Ln,this).setSize(w.width,w.height):rr(Ln,this).resetSize();let x=p?0:g.getStretchedColumnWidth(d),T=u&&!h?ur(y):0,{left:M,top:B,width:G,height:F}=y.getBoundingClientRect(),{width:O,height:V}=rr(Ln,this).getSize(),{innerWidth:J,innerHeight:N}=this.hot.rootWindow,P=this.hot.rootDocument.documentElement,$=M+f.scrollX+x,K=B+f.scrollY+T;this.hot.isRtl()&&($-=O+x),this.hot.isLtr()&&M+G+O>J?$=M+f.scrollX-O-1:this.hot.isRtl()&&$<-(P.scrollWidth-P.clientWidth)&&($=M+f.scrollX+x+1),B+V>N&&(K-=V-F+1),rr(Ln,this).setPosition($,K),rr(Ln,this).setReadOnlyState(this.getCommentMeta(s,a,ok))}focusEditor(){rr(Ln,this).focus()}updateCommentMeta(e,i,r){let n=this.hot.getCellMeta(e,i)[Am],o;n?(o=Wo(n),U_(o,r)):o=r,this.hot.setCellMeta(e,i,Am,o)}getCommentMeta(e,i,r){let n=this.hot.getCellMeta(e,i);if(n[Am])return n[Am][r]}addToContextMenu(e){e.items.push({name:gi},W$(this),U$(this),q$(this))}getDisplayDelaySetting(){let e=this.hot.getSettings()[pS];if(Xt(e))return e.displayDelay}getEditorInputElement(){return rr(Ln,this).getInputElement()}destroy(){rr(Ln,this)&&rr(Ln,this).destroy(),rr(dh,this)&&rr(dh,this).destroy(),super.destroy()}};function tpt(t){if(!(!this.hot.view||!this.hot.view._wt)&&!rr(kB,this)&&!this.targetIsCommentTextArea(t)){let e=Ku(t.target,"TD","TBODY"),i=null;e&&(i=this.hot.getCoords(e)),(!e||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}function ipt(t){let{rootDocument:e}=this.hot;if(!(rr(kB,this)||rr(Ln,this).isFocused()||Bt(t.target,"wtBorder")||rr($$,this)===t.target||!rr(Ln,this)))if(Im($$,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){let i=this.hot._createCellRange(this.hot.getCoords(t.target));rr(dh,this).show(i)}else Zu(t.target,e)&&!this.targetIsCommentTextArea(t)&&rr(dh,this).hide()}function rpt(){Im(kB,this,!1)}function npt(t,e){e[Am]&&e[Am][sk]&&Qe(t,e.commentedCellClassName)}function opt(){Im(MB,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function spt(){Im(MB,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Y$)}function apt(t){Im(DB,this,{width:Ji(t.target),height:ur(t.target)})}function lpt(t){let e=Ji(t.target),i=ur(t.target);(e!==rr(DB,this).width+1||i!==rr(DB,this).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Yxe]:{width:e,height:i}})}function cpt(t){rr(Ln,this).isVisible()&&Uo(t)}function dpt(){rr(IB,this)||this.hide()}var pPi=U($e(),1);var sNi=U($e(),1),aNi=U(dt(),1),lNi=U(Kxe(),1);function G$(t,e,i){return e=wpt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function wpt(t){var e=Cpt(t,"string");return typeof e=="symbol"?e:e+""}function Cpt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mS=class{constructor(e){G$(this,"hot",void 0),G$(this,"commands",{}),G$(this,"commonCallback",null),this.hot=e}registerCommand(e,i){this.commands[e]=i}setCommonCallback(e){this.commonCallback=e}execute(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];let o=e.split(":"),s=o[0],a=o.length===2?o[1]:null,c=this.commands[s];if(!c)throw new Error(`Menu command '${s}' not exists.`);if(a&&c.submenu&&(c=xpt(a,c.submenu.items)),c.disabled===!0||typeof c.disabled=="function"&&c.disabled.call(this.hot)===!0||Pr(c,"submenu"))return;let d=[];typeof c.callback=="function"&&d.push(c.callback),typeof this.commonCallback=="function"&&d.push(this.commonCallback),r.unshift(o.join(":")),Ce(d,u=>u.apply(this.hot,r))}};function xpt(t,e){let i;return Ce(e,r=>{let n=r.key?r.key.split(":"):null;if(Array.isArray(n)&&n[1]===t)return i=r,!1}),i}var hNi=U($e(),1),fNi=U(dt(),1);function X$(t,e,i){return e=Spt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Spt(t){var e=Ept(t,"string");return typeof e=="symbol"?e:e+""}function Ept(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gS=class{constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;X$(this,"hot",void 0),X$(this,"predefinedItems",RB()),X$(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=i}setPredefinedItems(e){let i={};this.defaultOrderPattern.length=0,Kt(e,(r,n)=>{let o="";r.name===gi?(i[gi]=r,o=gi):isNaN(parseInt(n,10))?(r.key=r.key===void 0?n:r.key,i[n]=r,o=r.key):(i[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=i}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Tpt(e,this.defaultOrderPattern,this.predefinedItems)}};function Tpt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=[],n=t;return n&&n.items?n=n.items:Array.isArray(n)||(n=e),Xt(n)?Kt(n,(o,s)=>{let a=i[typeof o=="string"?o:s];a||(a=o),Xt(o)?Sr(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):Ce(n,(o,s)=>{let a=i[o];!a&&Wxe.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Xt(o)&&Sr(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}var XNi=U($e(),1),KNi=U(dt(),1);var yNi=U($e(),1);var bNi=U($e(),1);function mb(t,e,i){return e=Rpt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Rpt(t){var e=Apt(t,"string");return typeof e=="symbol"?e:e+""}function Apt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var OB=class{constructor(e,i){mb(this,"top",void 0),mb(this,"topRelative",void 0),mb(this,"left",void 0),mb(this,"leftRelative",void 0),mb(this,"scrollTop",void 0),mb(this,"scrollLeft",void 0),mb(this,"cellHeight",void 0),mb(this,"cellWidth",void 0);let r=i.scrollY,n=i.scrollX,o,s,a,c,d,u;this.rootWindow=i,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),d=e.height||0,u=e.width||0,s=o,c=a,o+=r,a+=n):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),d=e.target.clientHeight,u=e.target.clientWidth,s=o-r,c=a-n),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=c,this.scrollTop=r,this.scrollLeft=n,this.cellHeight=d,this.cellWidth=u}getSourceType(e){let i="literal";return e instanceof Event&&(i="event"),i}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=i}fitsOnRight(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=i}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}};function lk(t,e,i){Ipt(t,e),e.set(t,i)}function Ipt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(Zxe(t,e))}function NB(t,e,i){return t.set(Zxe(t,e),i),i}function Zxe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var jl=new WeakMap,gb=new WeakMap,Pa=new WeakMap,K$=new WeakMap,vS=new WeakMap,PB=class{constructor(e){lk(this,jl,void 0),lk(this,gb,void 0),lk(this,Pa,void 0),lk(this,K$,!1),lk(this,vS,{above:0,below:0,left:0,right:0}),NB(K$,this,e)}setOffset(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return sr(vS,this)[e]=i,this}setElement(e){return NB(jl,this,e),this}setParentElement(e){return NB(gb,this,e),this}updatePosition(e){NB(Pa,this,new OB(e,sr(jl,this).ownerDocument.defaultView)),sr(K$,this)?(sr(Pa,this).fitsBelow(sr(jl,this))?this.setPositionBelowCursor():sr(Pa,this).fitsAbove(sr(jl,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){sr(jl,this).dir==="rtl"?sr(Pa,this).fitsOnLeft(sr(jl,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():sr(Pa,this).fitsOnRight(sr(jl,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=sr(vS,this).above+sr(Pa,this).top-sr(jl,this).offsetHeight;sr(gb,this)&&(e=sr(Pa,this).top+sr(Pa,this).cellHeight-sr(jl,this).offsetHeight+3),sr(jl,this).style.top=`${e}px`}setPositionBelowCursor(){let e=sr(vS,this).below+sr(Pa,this).top+1;sr(gb,this)&&(e=sr(Pa,this).top-1),sr(jl,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=sr(Pa,this).left;if(sr(gb,this)){let{right:i}=sr(gb,this).getBoundingClientRect();e+=sr(Pa,this).cellWidth+i-(sr(Pa,this).left+sr(Pa,this).cellWidth)}else e+=sr(vS,this).right;sr(jl,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=sr(vS,this).left+sr(Pa,this).left-sr(jl,this).offsetWidth;if(sr(gb,this)){let{left:i}=sr(gb,this).getBoundingClientRect();e-=sr(Pa,this).left-i}sr(jl,this).style.left=`${e}px`}};var xNi=U(ln(),1),SNi=U(cn(),1),ENi=U(dn(),1),TNi=U(un(),1),RNi=U(hn(),1),ANi=U(fn(),1),INi=U(pn(),1);function LB(t){let{initialPage:e=-1,size:i=()=>0,onItemSelect:r=()=>{},onClear:n=()=>{}}=t,o=new Set,s=Rr(e,-1,m()-1);function a(y,w){let x=m()-1;return y<0&&(y=x),y>x&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(w===1?++y:--y,w)),y)}function c(y){y>-1&&y<m()&&r(y,!0)!==!1&&(s=y)}function d(){return s}function u(){m()>0&&(o.clear(),s=a(0,1))}function h(){m()>0&&(o.clear(),s=a(m()-1,-1))}function p(){m()>0&&(o.clear(),s=a(++s,1))}function f(){m()>0&&(o.clear(),s=a(--s,-1))}function m(){return Math.max(i(),0)}function g(){o.clear(),s=e,n()}return{setCurrentPage:c,getCurrentPage:d,toFirstItem:u,toLastItem:h,toNextItem:p,toPreviousItem:f,getSize:m,clear:g}}var kNi=U(dt(),1);function Qxe(t){return ri(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ck(t){return Pr(t,"submenu")}function dk(t){return new RegExp(gi,"i").test(t.name)}function bS(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function Z$(t){return Pr(t,"disableSelection")}function Jxe(t){return Bt(t,"htSeparator")}function e1e(t){return Bt(t,"htSubmenu")}function t1e(t){return Bt(t,"htDisabled")}function i1e(t){return Bt(t,"htSelectionDisabled")}function r1e(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function n1e(t,e){let i=t.slice(0);for(let r=0;r<i.length&&i[r].name===e;)i.shift();return i}function Dpt(t,e){let i=t.slice(0);return i.reverse(),i=n1e(i,e),i.reverse(),i}function Mpt(t){let e=[];return Ce(t,(i,r)=>{r>0?e[e.length-1].name!==i.name&&e.push(i):e.push(i)}),e}function o1e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gi,i=t.slice(0);return i=n1e(i,e),i=Dpt(i,e),i=Mpt(i),i}function s1e(t){return LB({size:()=>t.countRows(),onItemSelect(e,i){let r=t.getCell(e,0);if(!r||Jxe(r)||t1e(r)||i1e(r))return!1;t.selectCell(e,0,...i?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}var zNi=U(dt(),1);function a1e(t){let{hot:e,hotMenu:i}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,n)=>{let o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;n.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{let r=i.getSelectedLast();if(r){let n=t.openSubMenu(r[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{i.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{let n=i.getSelectedLast();n&&(i.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(-i.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(i.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}var c1e="menu",l1e=c1e;function d1e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];r(a1e(t)),e.forEach(d=>{let{shortcuts:u,contextName:h}=d;n(u,h)});function r(d,u){a(u).addShortcuts(d,{group:c1e})}function n(d,u){let h=a(u);d.forEach(p=>{let{keys:f}=p;f.forEach(m=>h.removeShortcutsByKeys(m))}),i.push({shortcuts:d,contextName:u}),r(d,u)}function o(){return[...i]}function s(d){return d?`${l1e}:${d}`:l1e}function a(d){var u;let h=t.hotMenu.getShortcutManager(),p=s(d);return(u=h.getContext(p))!==null&&u!==void 0?u:h.addContext(p)}function c(d){t.hotMenu.getShortcutManager().setActiveContextName(s(d))}return{addCustomShortcuts:n,getCustomShortcuts:o,getContext:a,listen:c}}function u1e(t){return(e,i,r,n,o,s)=>{if(i.hasAttribute("ghost-table"))return;let a=e.getSourceDataAtRow(r),c=t.rootDocument.createElement("div"),d=typeof s=="function"?s.call(t):s;if(ia(i),Qe(c,"htItemWrapper"),t.getSettings().ariaTags){let u=!bS(a,t)&&!Z$(a)&&!dk(a);Ht(i,[Gbe(),Qx(d),...u?[Gd(-1)]:[],...bS(a,t)?[t0e()]:[],...ck(a)?[Oa(!1)]:[]])}i.className="",i.appendChild(c),dk(a)?Qe(i,"htSeparator"):typeof a.renderer=="function"?(Qe(i,"htCustomMenuRenderer"),i.appendChild(a.renderer(e,c,r,n,o,d))):Zd(c,d),bS(a,t)?Qe(i,"htDisabled"):Z$(a)?Qe(i,"htSelectionDisabled"):ck(a)&&Qe(i,"htSubmenu")}}function h1e(t,e,i){kpt(t,e),e.set(t,i)}function kpt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wf(t,e,i){return e=Opt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Opt(t){var e=Npt(t,"string");return typeof e=="symbol"?e:e+""}function Npt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f1e(t,e,i){return t.set(m1e(t,e),i),i}function uk(t,e){return t.get(m1e(t,e))}function m1e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var p1e=215,hk=new WeakMap,FB=new WeakMap,Dm=class t{constructor(e,i){var r=this;Wf(this,"hot",void 0),Wf(this,"options",void 0),Wf(this,"eventManager",new cs(this)),Wf(this,"container",void 0),Wf(this,"positioner",void 0),Wf(this,"hotMenu",null),Wf(this,"hotSubMenus",{}),Wf(this,"parentMenu",void 0),Wf(this,"menuItems",null),Wf(this,"origOutsideClickDeselects",null),h1e(this,hk,void 0),h1e(this,FB,void 0),this.hot=e,this.options=i||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:p1e,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new PB(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",i=>this.onDocumentMouseDown(i)),this.eventManager.addEventListener(e.document,"contextmenu",i=>this.onDocumentContextMenu(i)),e=Ef(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return uk(hk,this)}getKeyboardShortcutsCtrl(){return uk(FB,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let e=o1(a=>this.openSubMenu(a),300),i=this.options.minWidth||p1e,r=!1,n=xs(this.menuItems,a=>(a.key===pb&&(r=!0),r1e(a,this.hot)));if(n.length<1&&!r)n.push(RB()[pb]);else if(n.length===0)return;n=o1e(n,gi);let o=!1,s={data:n,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return wt(a)&&a<i?i:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:u1e(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,c)=>{uk(hk,this).setCurrentPage(c.row)},afterOnCellMouseOver:(a,c)=>{this.isAllSubMenusClosed()?e(c.row):this.openSubMenu(c.row)},rowHeights:a=>n[a].name===gi?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),D7()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,c,d,u,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!D7()||!nd(a))&&o&&this.hasSelectedItem()&&(rd()||A5()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),f1e(hk,this,s1e(this.hotMenu)),f1e(FB,this,d1e(this)),uk(FB,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(uk(hk,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let i=this.parentMenu.hotMenu.getSelectedLast();if(i){let r=this.parentMenu.hotMenu.getCell(i[0],0);Ht(r,[Oa(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;let i=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!i||!e1e(i))return!1;let r=this.hotMenu.getSourceDataAtRow(e),n=new t(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return n.setMenuItems(r.submenu.items),n.open(),n.setPosition(i.getBoundingClientRect()),this.hotSubMenus[r.key]=n,this.hot.getSettings().ariaTags&&Ht(i,[Oa(!0)]),n}closeSubMenu(e){let i=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[i.key];if(r){r.destroy(),delete this.hotSubMenus[i.key];let n=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ht(n,[Oa(!1)])}}closeAllSubMenus(){Ce(this.hotMenu.getData(),(e,i)=>this.closeSubMenu(i))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;let i=this.getSelectedItem();if(this.runLocalHooks("select",i,e),this.isCommandPassive(i))return;let r=this.hot.getSelectedRange(),n=r?Qxe(r):[];this.runLocalHooks("executeCommand",i.key,n,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",i.key,n,e)}isCommandPassive(e){return e.isCommand===!1||dk(e)||bS(e,this.hot)||ck(e)}setOffset(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,i)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.options.container.ownerDocument,r=e,n;return r&&(nr(r)&&(r=r.call(this.hot),r===null||Qi(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,n=i.querySelector(`.${this.options.className}.${r}`)),n||(n=i.createElement("div"),Qe(n,`htMenu ${this.options.className}`),r&&Qe(n,r),this.options.container.appendChild(n)),n}onAfterInit(){let{wtTable:e}=this.hotMenu.view._wt,i=this.hotMenu.getSettings().data,r=e.hider.style,n=e.holder.style,o=parseInt(r.width,10),s=Gr(i,(a,c)=>a+(c.name===gi?1:26),0);n.width=`${o+3}px`,n.height=`${s+3}px`,r.height=n.height,this.hot.getSettings().ariaTags&&Ht(this.hotMenu.rootElement,[$be(),Gd(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Zu(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Zu(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Bt(e.target,"htCore")&&Zu(e.target,this.hotMenu.rootElement)&&e.preventDefault()}};Mi(Dm,En);function Ppt(t,e){Lpt(t,e),e.add(t)}function Lpt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Q$(t,e,i){return e=Fpt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Fpt(t){var e=Hpt(t,"string");return typeof e=="symbol"?e:e+""}function Hpt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HB(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var _S="contextMenu",v1e=70,g1e=_S;Ct.getSingleton().register("afterContextMenuDefaultOptions");Ct.getSingleton().register("beforeContextMenuShow");Ct.getSingleton().register("afterContextMenuShow");Ct.getSingleton().register("afterContextMenuHide");Ct.getSingleton().register("afterContextMenuExecute");var fk=new WeakSet,yS=class t extends Zt{constructor(){super(...arguments),Ppt(this,fk),Q$(this,"commandExecutor",new mS(this.hot)),Q$(this,"itemsFactory",null),Q$(this,"menu",null)}static get PLUGIN_KEY(){return _S}static get PLUGIN_PRIORITY(){return v1e}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Sy,Ey,gi,Sm,Em,gi,xy,Rm,gi,Ty,Cy,gi,Tm,gi,fl]}isEnabled(){return!!this.hot.getSettings()[_S]}enablePlugin(){var e=this;if(this.enabled)return;let i=this.hot.getSettings()[_S];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new Dm(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>HB(fk,this,Vpt).call(this)),this.menu.addLocalHook("afterOpen",()=>HB(fk,this,jpt).call(this)),this.menu.addLocalHook("afterClose",()=>HB(fk,this,zpt).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return e.executeCommand.call(e,...n)}),this.addHook("afterOnCellContextMenu",r=>HB(fk,this,Bpt).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let i=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=fS(this.menu.container,this.hot.rootDocument);this.open({left:i.left+r.left,top:i.top+r.top-1+i.height},{left:i.width,above:-i.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;let i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&this.hot.selection.isCellVisible(i)&&!this.menu.isOpened()},group:g1e})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(g1e)}open(e){var i;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(i=this.menu)!==null&&i!==void 0&&i.isOpened()||(this.prepareMenuItems(),this.menu.open(),Kt(r,(n,o)=>{this.menu.setOffset(o,n)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new gS(this.hot,t.DEFAULT_ITEMS);let e=this.hot.getSettings()[_S],i={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);let r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),Ce(r,n=>this.commandExecutor.registerCommand(n.key,n))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function Bpt(t){let e=this.hot.getSettings(),i=e.rowHeaders,r=e.colHeaders;function n(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}let o=t.target;if(this.close(),Bt(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(i||r)&&!n(o)&&!(Bt(o,"current")&&Bt(o,"wtBorder"))))return;let s=fS(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Vpt(){this.hot.runHooks("beforeContextMenuShow",this)}function jpt(){this.hot.runHooks("afterContextMenuShow",this)}function zpt(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}yS.SEPARATOR={name:gi};var GPi=U($e(),1),XPi=U(dt(),1);function J$(t){return{key:"copy",name(){return this.getTranslatedPhrase(mD)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let i=this.getSelected();return!i||i.length>1},hidden:!1}}function eG(t){return{key:"copy_column_headers_only",name(){let e=this.getSelectedRangeLast(),i=e?Rr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(bD,i)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let i=this.getSelected();return!i||i.length>1},hidden:!1}}function tG(t){return{key:"copy_with_column_group_headers",name(){let e=this.getSelectedRangeLast(),i=e?Rr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(vD,i)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let i=this.getSelected();return!i||i.length>1},hidden:!1}}function iG(t){return{key:"copy_with_column_headers",name(){let e=this.getSelectedRangeLast(),i=e?Rr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(gD,i)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let i=this.getSelected();return!i||i.length>1},hidden:!1}}function rG(t){return{key:"cut",name(){return this.getTranslatedPhrase(_D)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let i=this.getSelected();return!i||i.length>1},hidden:!1}}var BB=class{constructor(){this.data={}}setData(e,i){this.data[e]=i}getData(e){return this.data[e]||void 0}};var VB=class{constructor(){this.clipboardData=new BB}preventDefault(){}};var WPi=U($e(),1),UPi=U(dt(),1);function Wpt(t,e){b1e(t,e),e.add(t)}function wS(t,e,i){b1e(t,e),e.set(t,i)}function b1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zl(t,e){return t.get(xS(t,e))}function CS(t,e,i){return t.set(xS(t,e),i),i}function xS(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var vb=new WeakMap,nG=new WeakMap,pk=new WeakMap,sG=new WeakMap,aG=new WeakMap,mk=new WeakMap,gk=new WeakSet,jB=class{constructor(e){let{countRows:i,countColumns:r,rowsLimit:n,columnsLimit:o,countColumnHeaders:s}=e;Wpt(this,gk),wS(this,vb,void 0),wS(this,nG,void 0),wS(this,pk,void 0),wS(this,sG,void 0),wS(this,aG,void 0),wS(this,mk,void 0),CS(nG,this,i),CS(pk,this,r),CS(sG,this,n),CS(aG,this,o),CS(mk,this,s)}setSelectedRange(e){CS(vb,this,e)}getCellsRange(){if(zl(nG,this).call(this)===0||zl(pk,this).call(this)===0)return null;let{row:e,col:i}=zl(vb,this).getTopStartCorner(),{row:r,col:n}=zl(vb,this).getBottomEndCorner(),o=xS(gk,this,Upt).call(this,e,r),s=xS(gk,this,oG).call(this,i,n);return{isRangeTrimmed:r!==o||n!==s,startRow:e,startCol:i,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(zl(pk,this).call(this)===0||zl(mk,this).call(this)===0)return null;let{col:e}=zl(vb,this).getTopStartCorner(),{col:i}=zl(vb,this).getBottomEndCorner(),r=xS(gk,this,oG).call(this,e,i);return{isRangeTrimmed:i!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(zl(pk,this).call(this)===0||zl(mk,this).call(this)===0)return null;let{col:e}=zl(vb,this).getTopStartCorner(),{col:i}=zl(vb,this).getBottomEndCorner(),r=xS(gk,this,oG).call(this,e,i);return{isRangeTrimmed:i!==r,startRow:-zl(mk,this).call(this),startCol:e,endRow:-1,endCol:r}}};function oG(t,e){return Math.min(e,Math.max(t+zl(aG,this).call(this)-1,t))}function Upt(t,e){return Math.min(e,Math.max(t+zl(sG,this).call(this)-1,t))}function lG(t){let e=[],i=[];return Ce(t,r=>{let n=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);_t(n,o,c=>{e.indexOf(c)===-1&&e.push(c)});let s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);_t(s,a,c=>{i.indexOf(c)===-1&&i.push(c)})}),{rows:e,columns:i}}function qpt(t,e){w1e(t,e),e.add(t)}function bb(t,e,i){w1e(t,e),e.set(t,i)}function w1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vk(t,e,i){return e=Ypt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ypt(t){var e=$pt(t,"string");return typeof e=="symbol"?e:e+""}function $pt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rc(t,e){return t.get(Ac(t,e))}function uh(t,e,i){return t.set(Ac(t,e),i),i}function Ac(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("afterCopyLimit");Ct.getSingleton().register("modifyCopyableRange");Ct.getSingleton().register("beforeCut");Ct.getSingleton().register("afterCut");Ct.getSingleton().register("beforePaste");Ct.getSingleton().register("afterPaste");Ct.getSingleton().register("beforeCopy");Ct.getSingleton().register("afterCopy");var bk="copyPaste",C1e=80,Gpt=["fragmentSelection"],_1e=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),cG=new WeakMap,dG=new WeakMap,uG=new WeakMap,SS=new WeakMap,zB=new WeakMap,WB=new WeakMap,ES=new WeakMap,UB=new WeakMap,dd=new WeakSet,_k=class extends Zt{constructor(){super(...arguments),qpt(this,dd),vk(this,"columnsLimit",1/0),vk(this,"rowsLimit",1/0),vk(this,"pasteMode","overwrite"),vk(this,"uiContainer",this.hot.rootDocument.body),bb(this,cG,!1),bb(this,dG,!1),bb(this,uG,!1),bb(this,SS,"cells-only"),bb(this,zB,!1),bb(this,WB,!1),bb(this,ES,new jB({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),bb(this,UB,!1),vk(this,"copyableRanges",[])}static get PLUGIN_KEY(){return bk}static get SETTING_KEYS(){return[bk,...Gpt]}static get PLUGIN_PRIORITY(){return C1e}isEnabled(){return!!this.hot.getSettings()[bk]}enablePlugin(){var e=this;if(this.enabled)return;let{[bk]:i}=this.hot.getSettings();if(typeof i=="object"){var r,n;this.pasteMode=(r=i.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,uh(cG,this,!!i.copyColumnHeaders),uh(dG,this,!!i.copyColumnGroupHeaders),uh(uG,this,!!i.copyColumnHeadersOnly),this.uiContainer=(n=i.uiContainer)!==null&&n!==void 0?n:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Ac(dd,this,Zpt).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Ac(dd,e,Qpt).call(e,...s)}),this.addHook("afterSelectionEnd",()=>Ac(dd,this,Jpt).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),I7()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Ac(dd,e,emt).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Ac(dd,e,tmt).call(e,...s)}),this.addHook("afterSelection",()=>Ac(dd,this,imt).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";uh(SS,this,e),uh(zB,this,!0),Ac(dd,this,y1e).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){uh(WB,this,!0),Ac(dd,this,y1e).call(this,"cut")}getRangedCopyableData(e){return rb(this.getRangedData(e))}getRangedData(e){let i=[],{rows:r,columns:n}=lG(e);return Ce(r,o=>{let s=[];Ce(n,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),i.push(s)}),i}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!i)return;let r=new VB;e&&r.clipboardData.setData("text/plain",e),i&&r.clipboardData.setData("text/html",i),this.onPaste(r)}setCopyableText(){let e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Rc(ES,this).setSelectedRange(e);let i=new Map([["headers",null],["cells",null]]);Rc(SS,this)==="column-headers-only"?i.set("headers",Rc(ES,this).getMostBottomColumnHeadersRange()):(Rc(SS,this)==="with-column-headers"?i.set("headers",Rc(ES,this).getMostBottomColumnHeadersRange()):Rc(SS,this)==="with-column-group-headers"&&i.set("headers",Rc(ES,this).getAllColumnHeadersRange()),i.set("cells",Rc(ES,this).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(n=>n!==null).map(n=>{let{startRow:o,startCol:s,endRow:a,endCol:c}=n;return{startRow:o,startCol:s,endRow:a,endCol:c}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let r=i.get("cells");if(r!==null&&r.isRangeTrimmed){let{startRow:n,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-n+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;let r=e.length,n=e[0].length,o=[],{row:s,col:a}=i.getTopStartCorner(),{row:c,col:d}=i.getBottomEndCorner(),u=s,h=a,p=s,f=a;for(;o.length<r||u<=c;){let{skipRowOnPaste:m,visualRow:g}=this.hot.getCellMeta(u,a);if(u=g+1,m===!0)continue;p=g,h=a;let y=[],w=o.length%r;for(;y.length<n||h<=d;){let{skipColumnOnPaste:x,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,x===!0)continue;f=T;let M=y.length%n;y.push(e[w][M])}o.push(y)}return uh(UB,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,p,f]}onCopy(e){if(!this.hot.isListening()&&!Rc(zB,this)||this.isEditorOpened()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;this.setCopyableText(),uh(zB,this,!1);let i=this.getRangedData(this.copyableRanges),r=Ac(dd,this,Xpt).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,r)){let o=rb(i);if(e&&e.clipboardData){let s=q7(i,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[_1e,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",i,this.copyableRanges,r)}uh(SS,this,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!Rc(WB,this)||this.isEditorOpened()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;this.setCopyableText(),uh(WB,this,!1);let i=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",i,this.copyableRanges)){let n=rb(i);if(e&&e.clipboardData){let o=q7(i,this.hot.rootDocument);e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",[_1e,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;e.preventDefault();let i;if(e&&typeof e.clipboardData<"u"){let a=hI(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?i=s_e(a,this.hot.rootDocument).data:i=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=J9(i)),i===void 0||i&&i.length===0||this.hot.runHooks("beforePaste",i,this.copyableRanges)===!1)return;let[r,n,o,s]=this.populateValues(i);this.hot.selectCell(r,n,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}destroy(){super.destroy()}};function y1e(t){if(I7()){let e=this.hot.getSelectedRangeLast();if(e){let{row:i,col:r}=e.highlight,n=this.hot.getCell(i,r,!0);n&&x0e(n,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Xpt(t){let{rows:e}=lG(t),i=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)i+=1;return{columnHeadersCount:i}}function Kpt(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);r&&R7(r)}}}function x1e(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);r!=null&&r.hasAttribute("contenteditable")&&A7(r)}}}function Zpt(t){t.items.push({name:"---------"},J$(this)),Rc(cG,this)&&t.items.push(iG(this)),Rc(dG,this)&&t.items.push(tG(this)),Rc(uG,this)&&t.items.push(eG(this)),t.items.push(rG(this))}function Qpt(t,e,i,r,n){Rc(UB,this)&&(n.value=!0),uh(UB,this,!1)}function Jpt(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function emt(){Ac(dd,this,x1e).call(this)}function tmt(){Ac(dd,this,Kpt).call(this)}function imt(){Ac(dd,this,x1e).call(this)}var NLi=U($e(),1),PLi=U(dt(),1);function hG(t,e){return`border_row${t}col${e}`}function TS(){return{width:1,color:"#000"}}function Uf(){return{hide:!0}}function rmt(){return{width:1,color:"#000",cornerVisible:!1}}function qB(t){if(wt(t.start)||wt(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(wt(t.end)||wt(t.right)){var i;t.end=(i=t.end)!==null&&i!==void 0?i:t.right}return delete t.left,delete t.right,t}function RS(t){return wt(t.start)&&(t.left=t.start),wt(t.end)&&(t.right=t.end),t}function YB(t,e){return{id:hG(t,e),border:rmt(),row:t,col:e,top:Uf(),bottom:Uf(),start:Uf(),end:Uf()}}function S1e(t,e){return Pr(e,"border")&&e.border&&(t.border=e.border),Pr(e,"top")&&wt(e.top)&&(e.top?(Xt(e.top)||(e.top=TS()),t.top=e.top):(e.top=Uf(),t.top=e.top)),Pr(e,"bottom")&&wt(e.bottom)&&(e.bottom?(Xt(e.bottom)||(e.bottom=TS()),t.bottom=e.bottom):(e.bottom=Uf(),t.bottom=e.bottom)),Pr(e,"start")&&wt(e.start)&&(e.start?(Xt(e.start)||(e.start=TS()),t.start=e.start):(e.start=Uf(),t.start=e.start)),Pr(e,"end")&&wt(e.end)&&(e.end?(Xt(e.end)||(e.end=TS()),t.end=e.end):(e.end=Uf(),t.end=e.end)),t}function Ic(t,e){let i=!1;return Ce(t.getSelectedRange(),r=>{r.forAll((n,o)=>{if(n<0||o<0)return;let s=t.getCellMeta(n,o).borders;if(s)if(e){if(!Pr(s[e],"hide")||s[e].hide===!1)return i=!0,!1}else return i=!0,!1})}),i}function _b(t){return`<span class="selected">\u2713</span>${t}`}function E1e(t){return t.some(e=>wt(e.left)||wt(e.right))}function T1e(t){return t.some(e=>wt(e.start)||wt(e.end))}var nmt=new Map([["left","start"],["right","end"]]);function R1e(t){var e;return(e=nmt.get(t))!==null&&e!==void 0?e:t}function $B(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(BD);return Ic(this,"bottom")&&(e=_b(e)),e},callback(e,i){let r=Ic(this,"bottom");t.prepareBorder(i,"bottom",r)}}}function GB(t){let e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let i=this.getTranslatedPhrase(VD);return Ic(this,e)&&(i=_b(i)),i},callback(i,r){let n=Ic(this,e);t.prepareBorder(r,e,n)}}}function XB(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(jD)},callback(e,i){t.prepareBorder(i,"noBorders")},disabled(){return!Ic(this)}}}function KB(t){let e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let i=this.getTranslatedPhrase(HD);return Ic(this,e)&&(i=_b(i)),i},callback(i,r){let n=Ic(this,e);t.prepareBorder(r,e,n)}}}function ZB(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(FD);return Ic(this,"top")&&(e=_b(e)),e},callback(e,i){let r=Ic(this,"top");t.prepareBorder(i,"top",r)}}}function omt(t,e){smt(t,e),e.add(t)}function smt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function amt(t,e,i){return e=lmt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function lmt(t){var e=cmt(t,"string");return typeof e=="symbol"?e:e+""}function cmt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function A1e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var yk="customBorders",I1e=90,fG=new WeakSet,wk=class extends Zt{constructor(){super(...arguments),omt(this,fG),amt(this,"savedBorders",[])}static get PLUGIN_KEY(){return yk}static get PLUGIN_PRIORITY(){return I1e}isEnabled(){return!!this.hot.getSettings()[yk]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>A1e(fG,this,dmt).call(this,e)),this.addHook("init",()=>A1e(fG,this,umt).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,i){let r=["top","bottom","start","end"],n=null;i&&(this.checkSettingsCohesion([i]),r=Object.keys(i),n=qB(i));let o=_m(e),s=ib(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Ce(e,a=>{s(a).forAll((c,d)=>{Ce(r,u=>{this.prepareBorderFromCustomAdded(c,d,n,R1e(u))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;let i=_m(e),r=ib(i,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return Ce(e,o=>{r(o).forAll((s,a)=>{Ce(this.savedBorders,c=>{c.row===s&&c.col===a&&n.push(RS(c))})})}),n}clearBorders(e){e?this.setBorders(e):(Ce(this.savedBorders,i=>{this.clearBordersFromSelectionSettings(i.id),this.clearNullCellRange(),this.hot.removeCellMeta(i.row,i.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,i){this.checkSavedBorders(e)||this.savedBorders.push(e);let n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,i)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}prepareBorderFromCustomAdded(e,i,r,n){let o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||i>=s)return;let a=YB(e,i);r&&(a=S1e(a,r),Ce(this.hot.selection.highlight.customSelections,c=>{if(a.id===c.settings.id)return Object.assign(c.settings,r),a.id=c.settings.id,a.top=c.settings.top,a.bottom=c.settings.bottom,a.start=c.settings.start,a.end=c.settings.end,!1})),this.hot.setCellMeta(e,i,"borders",RS(a)),this.insertBorderIntoSettings(a,n)}prepareBorderFromCustomAddedRange(e,i){let r=Math.min(e.to.row,this.hot.countRows()-1),n=Math.min(e.to.col,this.hot.countCols()-1);_t(e.from.row,r,o=>{_t(e.from.col,n,s=>{let a=YB(o,s),c=0;o===e.from.row&&Pr(i,"top")&&(c+=1,a.top=i.top),o===e.to.row&&Pr(i,"bottom")&&(c+=1,a.bottom=i.bottom),s===e.from.col&&Pr(i,"start")&&(c+=1,a.start=i.start),s===e.to.col&&Pr(i,"end")&&(c+=1,a.end=i.end),c>0&&(this.hot.setCellMeta(o,s,"borders",RS(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,i){let r=hG(e,i);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,i,"borders")}setBorder(e,i,r,n){let o=this.hot.getCellMeta(e,i).borders;!o||o.border===void 0?o=YB(e,i):o=qB(o),n?(o[r]=Uf(),this.countHide(o)===4?this.removeAllBorders(e,i):(this.checkCustomSelectionsFromContextMenu(o,r,n)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,i,"borders",RS(o)))):(o[r]=TS(),this.checkCustomSelectionsFromContextMenu(o,r,n)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,i,"borders",RS(o)))}prepareBorder(e,i,r){Ce(e,n=>{let{start:o,end:s}=n;if(o.row===s.row&&o.col===s.col)i==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,i,r);else switch(i){case"noBorders":_t(o.col,s.col,a=>{_t(o.row,s.row,c=>{this.removeAllBorders(c,a)})});break;case"top":_t(o.col,s.col,a=>{this.setBorder(o.row,a,i,r)});break;case"bottom":_t(o.col,s.col,a=>{this.setBorder(s.row,a,i,r)});break;case"start":_t(o.row,s.row,a=>{this.setBorder(a,o.col,i,r)});break;case"end":_t(o.row,s.row,a=>{this.setBorder(a,s.col,i,r)});break;default:break}})}createCustomBorders(e){Ce(e,i=>{let r=qB(i);i.range?this.prepareBorderFromCustomAddedRange(i.range,r):this.prepareBorderFromCustomAdded(i.row,i.col,r)})}countHide(e){let{top:i,bottom:r,start:n,end:o}=e;return Gr([i,r,n,o],(a,c)=>{let d=a;return c&&c.hide&&(d+=1),d},0)}clearBordersFromSelectionSettings(e){let i=ri(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}clearNullCellRange(){Ce(this.hot.selection.highlight.customSelections,(e,i)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[i].destroy(),this.hot.selection.highlight.customSelections.splice(i,1),!1})}hideBorders(){Ce(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){let i=ri(this.savedBorders,r=>r.id).indexOf(e);i>-1&&this.savedBorders.splice(i,1)}checkSavedBorders(e){let i=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),i=!0):Ce(this.savedBorders,(n,o)=>{if(e.id===n.id)return this.savedBorders[o]=e,i=!0,!1}),i}checkCustomSelectionsFromContextMenu(e,i,r){let n=!1;return Ce(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){let s=this.hot.view._wt.selectionManager.getBorderInstances(o);return Ce(s,a=>{a.toggleHiddenClass(i,r)}),n=!0,!1}}),n}checkCustomSelections(e,i,r){let n=this.countHide(e),o=!1;return n===4?(this.removeAllBorders(e.row,e.col),o=!0):Ce(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=i,s.commit(),r){let a=this.hot.view._wt.selectionManager.getBorderInstances(s);Ce(a,c=>{c.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){let e=this.hot.getSettings()[yk];if(Array.isArray(e)){let i=Wo(e);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){let i=E1e(e),r=T1e(e);if(i&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}};function dmt(t){this.hot.getSettings()[yk]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(LD)},disabled(){let e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[ZB(this),KB(this),$B(this),GB(this),XB(this)]}})}function umt(){this.changeBorderSettings()}var YLi=U($e(),1);function hmt(t,e){fmt(t,e),e.add(t)}function fmt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pG(t,e,i){return e=pmt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function pmt(t){var e=mmt(t,"string");return typeof e=="symbol"?e:e+""}function mmt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function D1e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var gG="dragToScroll",k1e=100,mG=new WeakSet,Ck=class extends Zt{constructor(){super(...arguments),hmt(this,mG),pG(this,"boundaries",null),pG(this,"callback",null),pG(this,"listening",!1)}static get PLUGIN_KEY(){return gG}static get PLUGIN_PRIORITY(){return k1e}isEnabled(){return!!this.hot.getSettings()[gG]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>D1e(mG,this,M1e).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>D1e(mG,this,M1e).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,i){let r=0,n=0;i<this.boundaries.top?n=i-this.boundaries.top:i>this.boundaries.bottom&&(n=i-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){let{rootWindow:e}=this.hot,i=e;for(;i;)this.eventManager.addEventListener(i.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(i.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(i.document,"mousemove",r=>this.onMouseMove(r)),i=Ef(i)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}};function M1e(t){if(nd(t))return;let e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((i,r)=>{var n,o;let s=(n=e.scrollLeft)!==null&&n!==void 0?n:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(i)*50,a+Math.sign(r)*20)}),this.listen()}var JLi=U($e(),1);function gmt(t,e){O1e(t,e),e.add(t)}function vmt(t,e,i){O1e(t,e),e.set(t,i)}function O1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vG(t,e,i){return e=bmt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function bmt(t){var e=_mt(t,"string");return typeof e=="symbol"?e:e+""}function _mt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ymt(t,e){return t.get(fu(t,e))}function N1e(t,e,i){return t.set(fu(t,e),i),i}function fu(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("afterDropdownMenuDefaultOptions");Ct.getSingleton().register("beforeDropdownMenuShow");Ct.getSingleton().register("afterDropdownMenuShow");Ct.getSingleton().register("afterDropdownMenuHide");Ct.getSingleton().register("afterDropdownMenuExecute");var xk="dropdownMenu",P1e=230,QB="changeType",bG=xk,JB=new WeakMap,hh=new WeakSet,AS=class t extends Zt{static get PLUGIN_KEY(){return xk}static get PLUGIN_PRIORITY(){return P1e}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Sm,Em,gi,Rm,gi,wy,gi,Tm,gi,fl]}constructor(e){super(e),gmt(this,hh),vG(this,"commandExecutor",new mS(this.hot)),vG(this,"itemsFactory",null),vG(this,"menu",null),vmt(this,JB,!1),this.hot.addHook("afterGetColHeader",(i,r)=>fu(hh,this,Cmt).call(this,i,r))}isEnabled(){return this.hot.getSettings()[xk]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new gS(this.hot,t.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return fu(hh,e,Amt).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return fu(hh,e,Rmt).call(e,...o)});let i=this.hot.getSettings()[xk],r={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);let n=this.itemsFactory.getItems(i);this.menu&&this.menu.destroy(),this.menu=new Dm(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",n),this.menu.setMenuItems(n),this.menu.addLocalHook("beforeOpen",()=>fu(hh,this,xmt).call(this)),this.menu.addLocalHook("afterOpen",()=>fu(hh,this,Smt).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>fu(hh,this,Emt).call(this,o)),this.menu.addLocalHook("afterClose",()=>fu(hh,this,Tmt).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),Ce(n,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let e=this.hot.getShortcutManager().getContext("grid"),i=()=>{let{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);let{from:n}=this.hot.getSelectedRangeLast(),o=fS(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,n.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:i,runOnlyIf:()=>{var r;let n=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:bG},{keys:[["Shift","Alt","ArrowDown"]],callback:i,runOnlyIf:()=>{var r;let n=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isCell()&&!this.menu.isOpened()},group:bG}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bG)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>fu(hh,this,wmt).call(this,e))}open(e){var i;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(i=this.menu)!==null&&i!==void 0&&i.isOpened()||(this.menu.open(),Kt(r,(n,o)=>{this.menu.setOffset(o,n)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function L1e(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function wmt(t){if(Bt(t.target,QB)){let e=fS(this.menu.container,this.hot.rootDocument),i=t.target.getBoundingClientRect();t.stopPropagation(),N1e(JB,this,!1),this.open({left:i.left+e.left,top:i.top+t.target.offsetHeight+3+e.top},{left:i.width})}}function Cmt(t,e){let i=e.parentNode;if(!i)return;let r=i.parentNode.childNodes,n=Array.prototype.indexOf.call(r,i);if(t<0||n!==r.length-1)return;let o=e.querySelector(`.${QB}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}let s=this.hot.rootDocument.createElement("button");s.className=QB,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ht(s,[ta(),Qx(" ")]),Ht(e,[h5("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function xmt(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Smt(){this.hot.runHooks("afterDropdownMenuShow",this),fu(hh,this,L1e).call(this,this.menu)}function Emt(t){fu(hh,this,L1e).call(this,t)}function Tmt(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Rmt(t){return ymt(JB,this)?null:t}function Amt(t){Bt(t.target,QB)&&N1e(JB,this,!0)}AS.SEPARATOR={name:gi};var AFi=U($e(),1);var pFi=U($e(),1),mFi=U(dt(),1);function F1e(t,e,i){return e=Imt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Imt(t){var e=Dmt(t,"string");return typeof e=="symbol"?e:e+""}function Dmt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _G=class{constructor(e){F1e(this,"hot",void 0),F1e(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){let{startRow:e,startCol:i,endRow:r,endCol:n}=this._getDataRange(),o=this.options,s=[];return _t(e,r,a=>{let c=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(_t(i,n,d=>{!o.exportHiddenColumns&&this._isHiddenColumn(d)||c.push(this.hot.getDataAtCell(a,d))}),s.push(c))}),s}getRowHeaders(){let e=[];if(this.options.rowHeaders){let{startRow:i,endRow:r}=this._getDataRange(),n=this.hot.getRowHeader();_t(i,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(n[o])})}return e}getColumnHeaders(){let e=[];if(this.options.columnHeaders){let{startCol:i,endCol:r}=this._getDataRange(),n=this.hot.getColHeader();_t(i,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(n[o])})}return e}_getDataRange(){let e=this.hot.countCols()-1,i=this.hot.countRows()-1,[r=0,n=0,o=i,s=e]=this.options.range;return r=Math.max(r,0),n=Math.max(n,0),o=Math.min(o,i),s=Math.min(s,e),{startRow:r,startCol:n,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}},H1e=_G;var bFi=U($e(),1);function B1e(t,e,i){return e=Mmt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Mmt(t){var e=kmt(t,"string");return typeof e=="symbol"?e:e+""}function kmt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yG=class t{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,i){B1e(this,"dataProvider",void 0),B1e(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(i),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let i=as(this.constructor.DEFAULT_OPTIONS),r=new Date;return i=Sr(as(t.DEFAULT_OPTIONS),i),i=Sr(i,e),i.filename=c5(i.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),i}},V1e=yG;var Omt="\r",Nmt='"',Pmt=`
`,wG=class extends V1e{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){let e=this.options,i=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),n=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0,a=e.bom?"\uFEFF":"";return n&&(r=ri(r,c=>this._escapeCell(c,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),Ce(i,(c,d)=>{d>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[d])+e.columnDelimiter),a+=c.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),a}_escapeCell(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Vr(e);return r!==""&&(i||r.indexOf(Omt)>=0||r.indexOf(Nmt)>=0||r.indexOf(Pmt)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}},j1e=wG;var Lmt="csv";var e3={[Lmt]:j1e};function CG(t,e,i){return typeof e3[t]=="function"?new e3[t](e,i):null}var z1e="exportFile",W1e=240,Sk=class extends Zt{static get PLUGIN_KEY(){return z1e}static get PLUGIN_PRIORITY(){return W1e}isEnabled(){return!0}exportAsString(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,i).export()}exportAsBlob(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,i))}downloadFile(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{rootDocument:r,rootWindow:n}=this.hot,o=this._createTypeFormatter(e,i),s=this._createBlob(o),a=n.URL||n.webkitURL,c=r.createElement("a"),d=`${o.options.filename}.${o.options.fileExtension}`;if(c.download!==void 0){let u=a.createObjectURL(s);c.style.display="none",c.setAttribute("href",u),c.setAttribute("download",d),r.body.appendChild(c),c.dispatchEvent(new MouseEvent("click")),r.body.removeChild(c),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,d)}_createTypeFormatter(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e3[e])throw new Error(`Export format type "${e}" is not supported.`);return CG(e,new H1e(this.hot),i)}_createBlob(e){let i=null;return typeof Blob<"u"&&(i=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),i}};var t4i=U($e(),1),i4i=U(dt(),1),r4i=U(m9(),1);var aBi=U($e(),1),lBi=U(dt(),1);var PFi=U($e(),1);function IS(t,e,i){return e=Fmt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Fmt(t){var e=Hmt(t,"string");return typeof e=="symbol"?e:e+""}function Hmt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fh=class{constructor(e,i){let{id:r,stateless:n=!0}=i;IS(this,"hot",void 0),IS(this,"id",void 0),IS(this,"elements",[]),IS(this,"hidden",!1),IS(this,"stateId",""),IS(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Nf)}getElements(){return this.elements}reset(){Ce(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Ce(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}};Mi(fh,En);var dHi=U(dt(),1);var jFi=U($e(),1),Ek={};function Dc(t,e){if(!Ek[t])throw Error(`Filter condition "${t}" does not exist.`);let{condition:i,descriptor:r}=Ek[t],n=e;return r.inputValuesDecorator&&(n=r.inputValuesDecorator(n)),function(o){return i.apply(o.meta.instance,[].concat([o],[n]))}}function qf(t){if(!Ek[t])throw Error(`Filter condition "${t}" does not exist.`);return Ek[t].descriptor}function er(t,e,i){i.key=t,Ek[t]={condition:e,descriptor:i}}var qo="none";function Bmt(){return!0}er(qo,Bmt,{name:iy,inputsCount:0,showOperators:!1});var Ay="empty";function Vmt(t){return jr(t.value)}er(Ay,Vmt,{name:GD,inputsCount:0,showOperators:!0});var Tk="not_empty";function jmt(t,e){return!Dc(Ay,e)(t)}er(Tk,jmt,{name:XD,inputsCount:0,showOperators:!0});var Iy="eq";function zmt(t,e){let[i]=e;return Vr(t.value).toLocaleLowerCase(t.meta.locale)===Vr(i)}er(Iy,zmt,{name:KD,inputsCount:1,showOperators:!0});var Rk="neq";function Wmt(t,e){return!Dc(Iy,e)(t)}er(Rk,Wmt,{name:ZD,inputsCount:1,showOperators:!0});var xG="gt";function Umt(t,e){let[i]=e,r=i;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}er(xG,Umt,{name:iM,inputsCount:1,showOperators:!0});var SG="gte";function qmt(t,e){let[i]=e,r=i;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}er(SG,qmt,{name:rM,inputsCount:1,showOperators:!0});var EG="lt";function Ymt(t,e){let[i]=e,r=i;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}er(EG,Ymt,{name:nM,inputsCount:1,showOperators:!0});var TG="lte";function $mt(t,e){let[i]=e,r=i;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}er(TG,$mt,{name:oM,inputsCount:1,showOperators:!0});var RG=U(nl(),1);var Ak="date_after";function Gmt(t,e){let[i]=e,r=(0,RG.default)(t.value,t.meta.dateFormat),n=(0,RG.default)(i,t.meta.dateFormat);return!r.isValid()||!n.isValid()?!1:r.diff(n)>=0}er(Ak,Gmt,{name:lM,inputsCount:1,showOperators:!0});var AG=U(nl(),1);var Ik="date_before";function Xmt(t,e){let[i]=e,r=(0,AG.default)(t.value,t.meta.dateFormat),n=(0,AG.default)(i,t.meta.dateFormat);return!r.isValid()||!n.isValid()?!1:r.diff(n)<=0}er(Ik,Xmt,{name:cM,inputsCount:1,showOperators:!0});var DS="between";function Kmt(t,e){let[i,r]=e,n=i,o=r;if(t.meta.type==="numeric"){let s=parseFloat(n,10),a=parseFloat(o,10);n=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){let s=Dc(Ik,[o]),a=Dc(Ak,[n]);return s(t)&&a(t)}return t.value>=n&&t.value<=o}er(DS,Kmt,{name:sM,inputsCount:2,showOperators:!0});var IG="not_between";function Zmt(t,e){return!Dc(DS,e)(t)}er(IG,Zmt,{name:aM,inputsCount:2,showOperators:!0});var DG="begins_with";function Qmt(t,e){let[i]=e;return Vr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Vr(i))}er(DG,Qmt,{name:QD,inputsCount:1,showOperators:!0});var MG="ends_with";function Jmt(t,e){let[i]=e;return Vr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Vr(i))}er(MG,Jmt,{name:JD,inputsCount:1,showOperators:!0});var Dk="contains";function egt(t,e){let[i]=e;return Vr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Vr(i))>=0}er(Dk,egt,{name:eM,inputsCount:1,showOperators:!0});var kG="not_contains";function tgt(t,e){return!Dc(Dk,e)(t)}er(kG,tgt,{name:tM,inputsCount:1,showOperators:!0});var OG=U(nl(),1);var NG="date_tomorrow";function igt(t){let e=(0,OG.default)(t.value,t.meta.dateFormat);return e.isValid()?e.isSame((0,OG.default)().subtract(-1,"days").startOf("day"),"d"):!1}er(NG,igt,{name:uM,inputsCount:0});var PG=U(nl(),1);var LG="date_today";function rgt(t){let e=(0,PG.default)(t.value,t.meta.dateFormat);return e.isValid()?e.isSame((0,PG.default)().startOf("day"),"d"):!1}er(LG,rgt,{name:dM,inputsCount:0});var FG=U(nl(),1);var HG="date_yesterday";function ngt(t){let e=(0,FG.default)(t.value,t.meta.dateFormat);return e.isValid()?e.isSame((0,FG.default)().subtract(1,"days").startOf("day"),"d"):!1}er(HG,ngt,{name:hM,inputsCount:0});var V5i=U(dt(),1),j5i=U(ln(),1),z5i=U(cn(),1),W5i=U(dn(),1),U5i=U(un(),1),q5i=U(hn(),1),Y5i=U(fn(),1),$5i=U(pn(),1);var K5i=W0e();function ogt(t,e){let i=t;return i===""&&(i=`(${e})`),i}var BG=new Set([1]).has(1),sgt=BG&&typeof Array.from=="function";function Mm(t){let e=t;return BG&&(e=new Set(e)),function(i){let r;return BG?r=e.has(i):r=!!~e.indexOf(i),r}}function t3(t){return t??""}function Mk(t){let e=t;return sgt?e=Array.from(new Set(e)):e=o5(e),e=e.sort((i,r)=>typeof i=="number"&&typeof r=="number"?i-r:i===r?0:i>r?1:-1),e}function VG(t,e,i,r){let n=[],o=t===e,s;return o||(s=Mm(e)),Ce(t,a=>{let c=!1;(o||s(a))&&(c=!0);let d={checked:c,value:a,visualValue:ogt(a,i)};r&&r(d),n.push(d)}),n}var Yf="by_value";function agt(t,e){let[i]=e;return i(t.value)}er(Yf,agt,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Mm(e)]},showOperators:!1});var tHi=U($e(),1),MS={};function U1e(t){if(!MS[t])throw Error(`Operation with id "${t}" does not exist.`);let e=MS[t].func;return function(i,r){return e(i,r)}}function q1e(t){return MS[t].name}function kS(t,e,i){MS[t]={name:e,func:i}}var pu="conjunction",lgt=mM;function cgt(t,e){return t.every(i=>i.func(e))}kS(pu,lgt,cgt);var Dy="disjunction",dgt=ry;function ugt(t,e){return t.some(i=>i.func(e))}kS(Dy,dgt,ugt);var aHi=U($e(),1);var OS="disjunctionWithExtraCondition",hgt=ry;function fgt(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(i=>i.func(e))&&t[t.length-1].func(e)}kS(OS,hgt,fgt);var pgt="numeric",$1e="text",mgt="date",Y1e={[pgt]:[qo,gi,Ay,Tk,gi,Iy,Rk,gi,xG,SG,EG,TG,DS,IG],[$1e]:[qo,gi,Ay,Tk,gi,Iy,Rk,gi,DG,MG,gi,Dk,kG],[mgt]:[qo,gi,Ay,Tk,gi,Iy,Rk,gi,Ik,Ak,DS,gi,NG,LG,HG]};function jG(t){let e=[],i=t;return Y1e[i]||(i=$1e),Ce(Y1e[i],r=>{let n;r===gi?n={name:gi}:n=as(qf(r)),e.push(n)}),e}var $Hi=U($e(),1);var VHi=U($e(),1);function kk(t,e,i){return e=ggt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ggt(t){var e=vgt(t,"string");return typeof e=="symbol"?e:e+""}function vgt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zG="built",WG="building",G1e=["click","input","keydown","keypress","keyup","focus","blur","change"],Vs=class t{static get DEFAULTS(){return as({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,i){kk(this,"hot",void 0),kk(this,"eventManager",new cs(this)),kk(this,"options",void 0),kk(this,"_element",void 0),kk(this,"buildState",void 0),this.hot=e,this.options=Sr(t.DEFAULTS,i),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===WG?this._element:this.buildState===zG?(this.update(),this._element):(this.buildState=WG,this.build(),this.buildState=zG,this._element)}isBuilt(){return this.buildState===zG}translateIfPossible(e){return typeof e=="string"&&e.startsWith(dl)?this.hot.getTranslatedPhrase(e):e}build(){let e=(i,r)=>{this.eventManager.addEventListener(i,r,n=>this.runLocalHooks(r,n,this))};if(this.buildState||(this.buildState=WG),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Qe(this._element,this.options.className),this.options.children.length)Ce(this.options.children,i=>this._element.appendChild(i.element));else if(this.options.wrapIt){let i=this.hot.rootDocument.createElement(this.options.tagName);i.setAttribute("data-hot-input",!0),Kt(this.options,(r,n)=>{i[n]!==void 0&&n!=="className"&&n!=="tagName"&&n!=="children"&&(i[n]=this.translateIfPossible(r))}),this._element.appendChild(i),Ce(G1e,r=>e(i,r))}else Ce(G1e,i=>e(this._element,i))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Mi(Vs,En);function bgt(t,e){K1e(t,e),e.add(t)}function _gt(t,e,i){K1e(t,e),e.set(t,i)}function K1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i3(t,e){return t.get(UG(t,e))}function ygt(t,e,i){return t.set(UG(t,e),i),i}function UG(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var NS=new WeakMap,X1e=new WeakSet,ph=class t extends Vs{static get DEFAULTS(){return as({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,i){super(e,Sr(t.DEFAULTS,i)),bgt(this,X1e),_gt(this,NS,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>UG(X1e,this,wgt).call(this,e))}build(){super.build();let e=this.hot.rootDocument.createElement("div");ygt(NS,this,this._element.firstChild),Qe(this._element,"htUIInput"),Qe(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(i3(NS,this).type=this.options.type,i3(NS,this).placeholder=this.translateIfPossible(this.options.placeholder),i3(NS,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&i3(NS,this).focus()}};function wgt(t){this.options.value=t.target.value}var QHi=U($e(),1);function Cgt(t,e){Z1e(t,e),e.add(t)}function Ok(t,e,i){Z1e(t,e),e.set(t,i)}function Z1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e,i){return t.set(Nk(t,e),i),i}function Io(t,e){return t.get(Nk(t,e))}function Nk(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var js=new WeakMap,r3=new WeakMap,n3=new WeakMap,qG=new WeakMap,o3=new WeakMap,s3=new WeakSet,My=class t extends Vs{static get DEFAULTS(){return as({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,i){super(e,Sr(t.DEFAULTS,i)),Cgt(this,s3),Ok(this,js,null),Ok(this,r3,[]),Ok(this,n3,void 0),Ok(this,qG,void 0),Ok(this,o3,void 0),this.registerHooks()}getMenu(){return Io(js,this)}registerHooks(){this.addLocalHook("click",()=>Nk(s3,this,Egt).call(this))}setItems(e){PS(r3,this,this.translateNames(e)),Io(js,this)&&Io(js,this).setMenuItems(Io(r3,this))}translateNames(e){return Ce(e,i=>{i.name=this.translateIfPossible(i.name)}),e}build(){super.build(),PS(js,this,new Dm(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Io(js,this).setMenuItems(Io(r3,this));let e=new Vs(this.hot,{className:"htUISelectCaption"}),i=new Vs(this.hot,{className:"htUISelectDropdown"});PS(n3,this,e),PS(qG,this,e.element),PS(o3,this,i),this.hot.getSettings().ariaTags&&(Ht(i.element,[ta()]),Ht(this._element,[u5()])),Ce([e,i],r=>this._element.appendChild(r.element)),Io(js,this).addLocalHook("select",r=>Nk(s3,this,xgt).call(this,r)),Io(js,this).addLocalHook("afterClose",()=>Nk(s3,this,Sgt).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Io(js,this).hot.getTranslatedPhrase(iy),Io(qG,this).textContent=e,super.update()}openOptions(){let e=this.element.getBoundingClientRect();Io(js,this)&&(Io(js,this).open(),Io(js,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Io(js,this).getNavigator().toFirstItem(),Io(js,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:i=>{this.closeOptions(),this.runLocalHooks("tabKeydown",i)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Io(js,this)&&Io(js,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Io(js,this)&&(Io(js,this).destroy(),PS(js,this,null)),Io(n3,this)&&Io(n3,this).destroy(),Io(o3,this)&&Io(o3,this).destroy(),super.destroy()}};function xgt(t){t.name!==gi&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Sgt(){this.runLocalHooks("afterClose")}function Egt(){this.openOptions()}function Tgt(t,e){Rgt(t,e),e.add(t)}function Rgt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Q1e(t,e,i){return e=Agt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Agt(t){var e=Igt(t,"string");return typeof e=="symbol"?e:e+""}function Igt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function J1e(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var YG=new WeakSet,LS=class extends fh{constructor(e,i){super(e,{id:i.id,stateless:!1}),Tgt(this,YG),Q1e(this,"name",""),Q1e(this,"addSeparator",!1),this.name=i.name,this.addSeparator=i.addSeparator,this.elements.push(new My(this.hot,{menuContainer:i.menuContainer})),this.elements.push(new ph(this.hot,{placeholder:wM})),this.elements.push(new ph(this.hot,{placeholder:CM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>J1e(YG,this,Dgt).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),Ce(this.getInputElements(),e=>{e.addLocalHook("keydown",i=>J1e(YG,this,Mgt).call(this,i))})}setState(e){if(this.reset(),!e)return;let i=as(e.command);i.name.startsWith(wo)&&(i.name=this.hot.getTranslatedPhrase(i.name)),this.getSelectElement().setValue(i),Ce(e.args,(r,n)=>{if(n>i.inputsCount-1)return!1;let o=this.getInputElement(n);o.setValue(r),o[i.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){let e=this.getSelectElement().getValue()||qf(qo),i=[];return Ce(this.getInputElements(),(r,n)=>{e.inputsCount>n&&i.push(r.getValue())}),{command:e,args:i}}updateState(e,i){let r=e?qf(e.name):qf(qo);this.state.setValueAtIndex(i,{command:r,args:e?e.args:[]}),e||Ce(this.getInputElements(),n=>n.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof My)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ph)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,i,r,n,o,s)=>{Qe(i.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Qe(i.parentNode,"border");let a=this.hot.rootDocument.createElement("div");return Qe(a,"htFiltersMenuLabel"),a.textContent=s,i.appendChild(a),Ce(this.elements,c=>i.appendChild(c.element)),i}}}reset(){let e=this.hot.getPlugin("filters").getSelectedColumn(),i=[qf(qo)];if(e!==null){let{visualIndex:r}=e;i=jG(this.hot.getDataType(0,r,this.hot.countRows(),r))}Ce(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(i),super.reset(),this.getSelectElement().setValue(i[0])}};function Dgt(t){Ce(this.getInputElements(),(e,i)=>{e[t.inputsCount>i?"show":"hide"](),i===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Mgt(t){Tf(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Uo(t))}var SBi=U($e(),1),EBi=U(dt(),1);var yBi=U($e(),1);function eSe(t,e,i){kgt(t,e),e.set(t,i)}function kgt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pk(t,e){return t.get(iSe(t,e))}function tSe(t,e,i){return t.set(iSe(t,e),i),i}function iSe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var FS=new WeakMap,$G=new WeakMap,Lk=class t extends Vs{static get DEFAULTS(){return as({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,i){super(e,Sr(t.DEFAULTS,i)),eSe(this,FS,void 0),eSe(this,$G,void 0)}build(){super.build();let e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),tSe($G,this,e),tSe(FS,this,this._element.firstChild),Pk(FS,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Pk($G,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Pk(FS,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Pk(FS,this).checked=e)}focus(){this.isBuilt()&&Pk(FS,this).focus()}};function Ogt(t,e){Ngt(t,e),e.add(t)}function Ngt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pgt(t,e,i){return e=Lgt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Lgt(t){var e=Fgt(t,"string");return typeof e=="symbol"?e:e+""}function Fgt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hgt(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var rSe=0,nSe=new WeakSet,a3=class extends fh{constructor(e,i){super(e,{id:i.id,stateless:!1}),Ogt(this,nSe),Pgt(this,"name",""),this.name=i.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,i)=>(Qe(i.parentNode,"htFiltersMenuOperators"),Ce(this.elements,r=>i.appendChild(r.element)),i)}}buildOperatorsElement(){let e=[pu,Dy];Ce(e,i=>{let r=new Lk(this.hot,{name:"operator",label:{htmlFor:i,textContent:q1e(i)},value:i,checked:i===e[rSe],id:i});r.addLocalHook("change",n=>Hgt(nSe,this,Bgt).call(this,n)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(Ai`Radio button with index ${e} doesn't exist.`);Ce(this.elements,(i,r)=>{i.setChecked(r===e)})}getActiveOperationId(){let e=this.elements.find(i=>i instanceof Lk&&i.isChecked());return e?e.getValue():pu}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Ce(this.elements,i=>{i.setChecked(i.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pu,i=arguments.length>1?arguments[1]:void 0,r=e;r===OS&&(r=Dy),this.state.setValueAtIndex(i,r)}reset(){this.setChecked(rSe)}};function Bgt(t){this.setState(t.target.value)}var JBi=U($e(),1),e3i=U(dt(),1);var VBi=U($e(),1),jBi=U(dt(),1);var LBi=U($e(),1);function Vgt(t,e,i){jgt(t,e),e.set(t,i)}function jgt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GG(t,e){return t.get(oSe(t,e))}function zgt(t,e,i){return t.set(oSe(t,e),i),i}function oSe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var Fk=new WeakMap,ky=class t extends Vs{static get DEFAULTS(){return as({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,i){super(e,Sr(t.DEFAULTS,i)),Vgt(this,Fk,void 0)}build(){super.build(),zgt(Fk,this,this._element.firstChild)}update(){this.isBuilt()&&(GG(Fk,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&GG(Fk,this).focus()}activate(){GG(Fk,this).click()}};function Wgt(t,e){aSe(t,e),e.add(t)}function HS(t,e,i){aSe(t,e),e.set(t,i)}function aSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bi(t,e){return t.get(BS(t,e))}function mh(t,e,i){return t.set(BS(t,e),i),i}function BS(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var sSe="multipleSelect.itemBox",gh=new WeakMap,Co=new WeakMap,XG=new WeakMap,km=new WeakMap,yb=new WeakMap,wb=new WeakMap,Hk=new WeakSet,Oy=class t extends Vs{static get DEFAULTS(){return as({className:"htUIMultipleSelect",value:[]})}constructor(e,i){super(e,Sr(t.DEFAULTS,i)),Wgt(this,Hk),HS(this,gh,[]),HS(this,Co,void 0),HS(this,XG,void 0),HS(this,km,void 0),HS(this,yb,void 0),HS(this,wb,void 0),mh(km,this,new ph(this.hot,{placeholder:yM,className:"htUIMultipleSelectSearch"})),mh(yb,this,new ky(this.hot,{textContent:gM,className:"htUISelectAll"})),mh(wb,this,new ky(this.hot,{textContent:vM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Bi(Co,this)}registerHooks(){Bi(km,this).addLocalHook("keydown",e=>BS(Hk,this,qgt).call(this,e)),Bi(km,this).addLocalHook("input",e=>BS(Hk,this,Ugt).call(this,e)),Bi(yb,this).addLocalHook("click",e=>BS(Hk,this,Ygt).call(this,e)),Bi(wb,this).addLocalHook("click",e=>BS(Hk,this,$gt).call(this,e))}setItems(e){mh(gh,this,e),Bi(Co,this)&&Bi(Co,this).loadData(Bi(gh,this))}setLocale(e){mh(XG,this,e)}getLocale(){return Bi(XG,this)}getItems(){return[...Bi(gh,this)]}getValue(){return Xgt(Bi(gh,this))}getSearchInputElement(){return Bi(km,this)}getSelectAllElement(){return Bi(yb,this)}getClearAllElement(){return Bi(wb,this)}isSelectedAllValues(){return Bi(gh,this).length===this.getValue().length}build(){super.build();let{rootDocument:e}=this.hot,i=e.createElement("div"),r=new Vs(this.hot,{className:"htUISelectionControls",children:[Bi(yb,this),Bi(wb,this)]});this._element.appendChild(Bi(km,this).element),this._element.appendChild(r.element),this._element.appendChild(i);let n=o=>{if(!this._element)return;Bi(Co,this)&&Bi(Co,this).destroy(),Qe(o,"htUIMultipleSelectHot"),mh(Co,this,new this.hot.constructor(o,{data:Bi(gh,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,d,u,h,p,f)=>{c.title=f.instance.getDataAtRowProp(d,f.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Bi(Co,this).listen()},colWidths:()=>Bi(Co,this).container.scrollWidth-mn(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Bi(Co,this).init();let a=Bi(Co,this).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:sSe}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:c=>{Bi(Co,this).deselectCell(),this.runLocalHooks("keydown",c,this),this.runLocalHooks("listTabKeydown",c,this)},group:sSe})};n(i),this.hot._registerTimeout(()=>n(i),100)}focus(){this.isBuilt()&&Bi(Co,this).listen()}reset(){Bi(km,this).reset(),Bi(yb,this).reset(),Bi(wb,this).reset()}update(){this.isBuilt()&&(Bi(Co,this).loadData(Ggt(Bi(gh,this),this.options.value)),super.update())}destroy(){Bi(Co,this)&&Bi(Co,this).destroy(),Bi(km,this).destroy(),Bi(wb,this).destroy(),Bi(yb,this).destroy(),mh(km,this,null),mh(wb,this,null),mh(yb,this,null),mh(Co,this,null),mh(gh,this,null),super.destroy()}};function Ugt(t){let e=t.target.value.toLocaleLowerCase(this.getLocale()),i;e===""?i=[...Bi(gh,this)]:i=Bi(gh,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Bi(Co,this).loadData(i)}function qgt(t){this.runLocalHooks("keydown",t,this),y5(Tf,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Uo(t),Bi(Co,this).listen(),Bi(Co,this).selectCell(0,0))}function Ygt(t){let e=[];t.preventDefault(),Bi(Co,this).getSourceData().forEach((i,r)=>{i.checked=!0,e.push(D9(i,r)[0])}),Bi(Co,this).setSourceDataAtCell(e)}function $gt(t){let e=[];t.preventDefault(),Bi(Co,this).getSourceData().forEach((i,r)=>{i.checked=!1,e.push(D9(i,r)[0])}),Bi(Co,this).setSourceDataAtCell(e)}function Ggt(t,e){let i=Mm(e);return t.map(r=>(r.checked=i(r.value),r))}function Xgt(t){let e=[];return t.forEach(i=>{i.checked&&e.push(i.value)}),e}function Kgt(t,e){Zgt(t,e),e.add(t)}function Zgt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qgt(t,e,i){return e=Jgt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Jgt(t){var e=evt(t,"string");return typeof e=="symbol"?e:e+""}function evt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l3(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var Bk=new WeakSet,c3=class extends fh{constructor(e,i){super(e,{id:i.id,stateless:!1}),Kgt(this,Bk),Qgt(this,"name",""),this.name=i.name,this.elements.push(new Oy(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>l3(Bk,this,tvt).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,i)=>l3(Bk,this,ivt).call(this,e,i))}getElements(){let e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Yf){let i=this.getMultipleSelectElement();i.setItems(e.itemsSnapshot),i.setValue(e.args[0]),i.setLocale(e.locale)}}getState(){let e=this.getMultipleSelectElement(),i=e.getItems();return{command:{key:e.isSelectedAllValues()||!i.length?qo:Yf},args:[e.getValue()],itemsSnapshot:i}}updateState(e){let i=(r,n,o,s,a)=>{let[c]=xs(n,h=>h.name===Yf),d={},u=this.hot.getTranslatedPhrase(O1);if(c){let h=s(r,a),p=ri(h,x=>x.value),f=new Map(h.map(x=>[x.value,this.hot.getCellMeta(x.meta.visualRow,x.meta.visualCol)])),m=Mk(p);o&&(c.args[0]=o);let g=[],y=VG(m,c.args[0],u,x=>{x.checked&&g.push(x.value),l3(Bk,this,lSe).call(this,x,f)}),w=e.editedConditionStack.column;d.locale=this.hot.getCellMeta(0,w).locale,d.args=[g],d.command=qf(Yf),d.itemsSnapshot=y}else d.args=[],d.command=qf(qo);this.state.setValueAtIndex(r,d)};i(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&i(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Oy)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,i,r,n,o,s)=>{Qe(i.parentNode,"htFiltersMenuValue");let a=this.hot.rootDocument.createElement("div");return Qe(a,"htFiltersMenuLabel"),a.textContent=s,i.appendChild(a),Ce(this.elements,c=>i.appendChild(c.element)),i}}}reset(){let e=this.hot.getTranslatedPhrase(O1),i=this._getColumnVisibleValues(),r=i.map(c=>c.value),n=new Map(i.map(c=>[c.value,c.meta])),o=Mk(r),s=VG(o,o,e,c=>{l3(Bk,this,lSe).call(this,c,n)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);let a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){let e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:ri(this.hot.getDataAtCol(e.visualIndex),(i,r)=>({value:t3(i),meta:this.hot.getCellMeta(r,e.visualIndex)}))}};function tvt(t){Tf(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Uo(t))}function lSe(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function ivt(t,e){switch(e.type){case"numeric":return hB(t,e);default:return t}}var h3i=U($e(),1),f3i=U(dt(),1);var dSe;function rvt(t,e){nvt(t,e),e.add(t)}function nvt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ovt(t,e,i){return e=svt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function svt(t){var e=avt(t,"string");return typeof e=="symbol"?e:e+""}function avt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lvt(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var cSe=new WeakSet,Vk=class t extends fh{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,i){super(e,{id:i.id,stateless:!0}),rvt(this,cSe),ovt(this,"name",""),this.name=i.name,this.elements.push(new ph(this.hot,{type:"button",value:bM,className:"htUIButton htUIButtonOK",identifier:t.BUTTON_OK})),this.elements.push(new ph(this.hot,{type:"button",value:_M,className:"htUIButton htUIButtonCancel",identifier:t.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Ce(this.elements,e=>{e.addLocalHook("click",(i,r)=>lvt(cSe,this,cvt).call(this,i,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,i)=>(Qe(i.parentNode,"htFiltersMenuActionBar"),Ce(this.elements,r=>i.appendChild(r.element)),i)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}};dSe=Vk;function cvt(t,e){e.options.identifier===dSe.BUTTON_OK?this.accept():this.cancel()}var _3i=U($e(),1),y3i=U(dt(),1);function KG(t,e,i){return e=dvt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function dvt(t){var e=uvt(t,"string");return typeof e=="symbol"?e:e+""}function uvt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uSe="ConditionCollection.filteringStates",d3=class{constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;KG(this,"hot",void 0),KG(this,"isMapRegistrable",void 0),KG(this,"filteringStates",new Nf),this.hot=e,this.isMapRegistrable=i,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(uSe,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,i){var r;let n=this.filteringStates.getValueAtIndex(i),o=(r=n?.conditions)!==null&&r!==void 0?r:[],s=n?.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pu;return e.length?U1e(r)(e,i):!0}addCondition(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pu,n=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,e).locale,s=ri(i.args,u=>typeof u=="string"?u.toLocaleLowerCase(o):u),a=i.name||i.command.key;this.runLocalHooks("beforeAdd",e);let c=this.getOperation(e);if(c){if(c!==r)throw Error(Ai`The column of index ${e} has been already applied with a \`${c}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Qi(MS[r]))throw new Error(Ai`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let d=this.getConditions(e);d.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Dc(a,s)}]},n):d.push({name:a,args:s,func:Dc(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var i,r;return(i=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&i!==void 0?i:[]}getOperation(e){var i;return(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[i]=e;return i})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Gr(this.filteringStates.getEntries(),(e,i)=>{let[r,{operation:n,conditions:o}]=i;return e.push({column:r,operation:n,conditions:ri(o,s=>{let{name:a,args:c}=s;return{name:a,args:c}})}),e},[])}importAllConditions(e){this.clean(),Ce(e,i=>{Ce(i.conditions,r=>this.addCondition(i.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,i){let r=this.getConditions(e);return i?r.some(n=>n.name===i):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(uSe),this.filteringStates=null,this.clearLocalHooks()}};Mi(d3,En);var u3=d3;var M3i=U($e(),1),k3i=U(dt(),1);function hSe(t,e,i){return e=hvt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function hvt(t){var e=fvt(t,"string");return typeof e=="symbol"?e:e+""}function fvt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZG=class{constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];hSe(this,"conditionCollection",void 0),hSe(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=i}filter(){let e=[];return Ce(this.conditionCollection.getFilteredColumns(),(i,r)=>{let n=this.columnDataFactory(i);r&&(n=this._getIntersectData(n,e)),e=this.filterByColumn(i,n)}),e}filterByColumn(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=[];return Ce(i,n=>{n!==void 0&&this.conditionCollection.isMatch(n,e)&&r.push(n)}),r}_getIntersectData(e,i){let r=[];return Ce(i,n=>{let o=n.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}},h3=ZG;var P3i=U($e(),1),L3i=U(dt(),1);function pvt(t,e){mvt(t,e),e.add(t)}function mvt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ny(t,e,i){return e=gvt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function gvt(t){var e=vvt(t,"string");return typeof e=="symbol"?e:e+""}function vvt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QG(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var f3=new WeakSet,p3=class{constructor(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];pvt(this,f3),Ny(this,"hot",void 0),Ny(this,"conditionCollection",void 0),Ny(this,"columnDataFactory",void 0),Ny(this,"changes",[]),Ny(this,"grouping",!1),Ny(this,"latestEditedColumnPosition",-1),Ny(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=i,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",n=>QG(f3,this,bvt).call(this,n)),this.conditionCollection.addLocalHook("afterRemove",n=>this.updateStatesAtColumn(n)),this.conditionCollection.addLocalHook("afterAdd",n=>this.updateStatesAtColumn(n)),this.conditionCollection.addLocalHook("beforeClean",()=>QG(f3,this,_vt).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>QG(f3,this,yvt).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Ce(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,i){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}let n=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);let s=n.slice(0,o),a=n.slice(o);a.length&&a[0].column===e&&a.shift();let c=S0e(function(u,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],f=new u3(r.hot,!1),m=[].concat(u,p);f.importAllConditions(m);let g=r.columnDataFactory(h),y;f.isEmpty()?y=g:y=new h3(f,x=>r.columnDataFactory(x)).filter(),y=ri(y,x=>x.meta.visualRow);let w=Mm(y);return f.destroy(),xs(g,x=>w(x.meta.visualRow))})(s),d=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:d},dependentConditionStacks:a,filteredRowsFactory:c,conditionArgsChange:i})}destroy(){this.clearLocalHooks(),Kt(this,(e,i)=>{this[i]=null})}};function bvt(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function _vt(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function yvt(){Ce(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Mi(p3,En);var fSe=p3;function pSe(t){return LB({initialPage:0,size:()=>t.length,onItemSelect:(i,r)=>{let n=t[i];if(n instanceof Oy)return r;if(n.element&&!Xd(n.element))return!1;n.focus()}})}var jk="filters";function mSe(t,e){let i=-1,r=pSe(e),n=c=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(jk),r.setCurrentPage(e.indexOf(c))};e.forEach(c=>{c instanceof Vs&&(c.addLocalHook("click",n(c)),c.addLocalHook("focus",n(c)),c.addLocalHook("afterClose",n(c)))}),t.addLocalHook("afterSelectionChange",c=>{c.key.startsWith("filter_")||r.clear()});function o(c){let d=t.getKeyboardShortcutsCtrl(),u=c.getKeyboardShortcutsCtrl();r.clear(),u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(jk),callback:()=>{c.isSubMenu()&&c.close(),d.listen(jk)}}]),!c.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{let p=t.getNavigator();p.getCurrentPage()>-1&&(i=p.getCurrentPage()),p.clear(),h.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{let p=e[r.getCurrentPage()];p instanceof My&&(p.openOptions(),h.preventDefault()),p instanceof ky&&(p.activate(),h.preventDefault()),p instanceof Vs||h.preventDefault()}}],jk)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(jk)}function a(){return i}return Lt(Ke({},r),{listen:s,getLastMenuPage:a})}function wvt(t,e){_Se(t,e),e.add(t)}function Cvt(t,e,i){_Se(t,e),e.set(t,i)}function _Se(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zk(t,e,i){return e=xvt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function xvt(t){var e=Svt(t,"string");return typeof e=="symbol"?e:e+""}function Svt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Evt(t,e,i){return t.set(ud(t,e),i),i}function Wk(t,e){return t.get(ud(t,e))}function ud(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var m3="filters",ySe=250,gSe=m3,Py=new WeakMap,mu=new WeakSet,Uk=class extends Zt{static get PLUGIN_KEY(){return m3}static get PLUGIN_PRIORITY(){return ySe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),wvt(this,mu),zk(this,"dropdownMenuPlugin",null),zk(this,"conditionCollection",null),zk(this,"conditionUpdateObserver",null),zk(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),zk(this,"filtersRowsMap",null),Cvt(this,Py,void 0),this.hot.addHook("afterGetColHeader",(i,r)=>ud(mu,this,Mvt).call(this,i,r))}isEnabled(){return!!this.hot.getSettings()[m3]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new au),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let e=this.hot.getSettings().dropdownMenu,i=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>ud(mu,this,vSe).call(this,"accept")),s.addLocalHook("cancel",()=>ud(mu,this,vSe).call(this,"cancel")),s.addLocalHook("change",a=>ud(mu,this,Dvt).call(this,s,a)),s),n=()=>`${this.hot.getTranslatedPhrase(fM)}:`,o=()=>`${this.hot.getTranslatedPhrase(pM)}:`;if(!this.components.get("filter_by_condition")){let s=new LS(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:i});s.addLocalHook("afterClose",()=>ud(mu,this,bSe).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new a3(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let s=new LS(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});s.addLocalHook("afterClose",()=>ud(mu,this,bSe).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new c3(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Vk(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new u3(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new fSe(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>ud(mu,this,kvt).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>ud(mu,this,Ivt).call(this,s)),this.addHook("afterDropdownMenuShow",()=>ud(mu,this,Rvt).call(this)),this.addHook("afterDropdownMenuHide",()=>ud(mu,this,Avt).call(this)),this.addHook("afterChange",s=>ud(mu,this,Tvt).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Wk(Py,this)&&this.dropdownMenuPlugin.enabled){let s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{let d=s.getNavigator(),u=Wk(Py,this).getLastMenuPage();s.focus(),u>0?d.setCurrentPage(u):d.toFirstItem()}},...Array.from(this.components).map(d=>{let[,u]=d;return u.getElements()}).flat()];Evt(Py,this,mSe(s,a));let c=d=>{Wk(Py,this).listen(),d.preventDefault(),Tf(d.keyCode,"TAB")&&(d.shiftKey?Wk(Py,this).toPreviousItem():Wk(Py,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",c),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",c)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((i,r)=>{i.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:gSe})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gSe)}addCondition(e,i,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:pu,o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:i},args:r},n)}removeConditions(e){let i=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(i)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{let i=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(i)}}filter(){let{navigableHeaders:e}=this.hot.getSettings(),i=this._createDataFilter(),r=!this.conditionCollection.isEmpty(),n=[],o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){let a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),n=ri(i.filter(),d=>d.meta.visualRow);let c=Mm(n);_t(this.hot.countSourceRows()-1,d=>{c(d)||a.push(d)}),Ce(a,d=>{this.filtersRowsMap.setValueAtIndex(d,!0)})},!0),!e&&!n.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;let i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}getDataMapAtColumn(e){let i=this.hot.toVisualColumn(e),r=[];return Ce(this.hot.getSourceDataAtCol(i),(n,o)=>{var s;let{row:a,col:c,visualCol:d,visualRow:u,type:h,instance:p,dateFormat:f,locale:m}=this.hot.getCellMeta(o,i),g=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),i))!==null&&s!==void 0?s:n;r.push({meta:{row:a,col:c,visualCol:d,visualRow:u,type:h,instance:p,dateFormat:f,locale:m},value:t3(g)})}),r}updateValueComponentCondition(e){let i=this.hot.getDataAtCol(e),r=Mk(i);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var i;let r=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;e.forEach(n=>{n.isHidden()||n.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,i,r,n){let o=e;return o===Dy&&i.command.key!==qo&&r.command.key!==qo&&n.command.key!==qo?o=OS:n.command.key!==qo&&(i.command.key===qo||r.command.key===qo)&&(o=pu),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let e=this.components.get("filter_by_condition"),{command:i}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];i.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new h3(e,i=>this.getDataMapAtColumn(i))}getIndexesOfComponents(){let e=[];if(!this.dropdownMenuPlugin)return e;let i=this.dropdownMenuPlugin.menu;for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Ce(n,s=>{Ce(i.menuItems,(a,c)=>{a.key===s.getMenuItemDescriptor().key&&e.push(c)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;let r=this.dropdownMenuPlugin.menu.hotMenu,n=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];let c=this.getIndexesOfComponents(...s);e?n.showRows(c):n.hideRows(c),r.render()}hideComponents(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];this.changeComponentsVisibility(!1,...i)}showComponents(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];this.changeComponentsVisibility(!0,...i)}destroy(){this.enabled&&(this.components.forEach((e,i)=>{e!==null&&(e.destroy(),this.components.set(i,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}};function Tvt(t){t&&Ce(t,e=>{let[,i]=e,r=this.hot.propToCol(i);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Rvt(){this.restoreComponents(Array.from(this.components.values()))}function Avt(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Ivt(t){t.items.push({name:gi}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function vSe(t){var e;if(t==="accept"){let r=this.getSelectedColumn();if(r===null){var i;(i=this.dropdownMenuPlugin)===null||i===void 0||i.close();return}let{physicalIndex:n}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),c=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let d=this.conditionCollection.getColumnStackPosition(n);d===-1&&(d=void 0),this.conditionCollection.removeConditions(n),o.command.key!==qo&&(this.conditionCollection.addCondition(n,o,c,d),s.command.key!==qo&&this.conditionCollection.addCondition(n,s,c,d)),a.command.key!==qo&&this.conditionCollection.addCondition(n,a,c,d),this.conditionUpdateObserver.flush(),this.components.forEach(u=>u.saveState(n)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Dvt(t,e){this.updateDependentComponentsVisibility(),t.constructor===LS&&!e.inputsCount&&this.setListeningDropdownMenu()}function bSe(){this.setListeningDropdownMenu()}function Mvt(t,e){let i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)?Qe(e,"htFiltersActive"):Gt(e,"htFiltersActive")}function kvt(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;let{editedConditionStack:{conditions:i,column:r}}=t,n=i.filter(s=>s.name===Yf),o=i.filter(s=>s.name!==Yf);if(n.length>=2||o.length>=3)Zi(Ai`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}var X4i=U($e(),1),K4i=U(dt(),1),Z4i=U(C5(),1),Q4i=U(ln(),1),J4i=U(cn(),1),eVi=U(dn(),1),tVi=U(un(),1),iVi=U(hn(),1),rVi=U(fn(),1),nVi=U(pn(),1);var I4i=U(dt(),1);var JG="internal-use-in-handsontable",g3={licenseKey:JG,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function wSe(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[zs])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function CSe(t){return Object.keys(t).reduce((e,i)=>(i!=="hyperformula"&&(e[i]=t[i]),e),{})}function xSe(t){var e;let i=t[zs],r=CSe(i!=null&&(e=i.engine)!==null&&e!==void 0&&e.hyperformula?i.engine:{}),n=wSe(t);return Ke(Ke(Ke({},g3),r),n)}function SSe(t){var e;let i=t[zs],r=CSe(i!=null&&(e=i.engine)!==null&&e!==void 0&&e.hyperformula?i.engine:{}),n=wSe(t);return Ke(Ke({},r),n)}function ESe(t,e){return Object.keys(e).some(i=>e[i]!==void 0&&e[i]!==t[i])}function v3(){let t="engine_relationship",e=ls(zs);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function eX(){let t="shared_engine_usage",e=ls(zs);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function TSe(t){let e=t.getSettings(),i=e[zs],r=i?.engine;if(i===!0||Qi(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var n;return Ovt((n=r.hyperformula)!==null&&n!==void 0?n:r,e,t)}else if(typeof r=="object"&&Qi(r.hyperformula)){let o=v3(),s=eX().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:JG}),(r.getConfig().leapYear1900!==g3.leapYear1900||s1(r.getConfig().nullDate,g3.nullDate)===!1)&&Zi(Ai`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Ovt(t,e,i){let r=e[zs],n=xSe(e),o=v3(),s=eX();Nvt(t,r.functions),Pvt(t,r.language);let a=t.buildEmpty(n);return o.set(a,[i]),s.set(a,[i.guid]),Lvt(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function tX(t){var e;let i=v3(),r=i.size===0?[]:Array.from((e=i.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(n=>[n.getPlugin("formulas").sheetId,n]))}function iX(t,e){if(t){let i=v3(),r=i.get(t),n=eX(),o=n.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&i.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(n.delete(t),t.destroy()))}}function Nvt(t,e){e&&e.forEach(i=>{let{name:r,plugin:n,translations:o}=i;try{t.registerFunction(r,n,o)}catch(s){Zi(s.message)}})}function Pvt(t,e){if(e){let{langCode:i}=e;try{t.registerLanguage(i,e)}catch(r){Zi(r.message)}}}function Lvt(t,e){e&&(t.suspendEvaluation(),e.forEach(i=>{let{name:r,expression:n,scope:o,options:s}=i;try{t.addNamedExpression(r,n,o,s)}catch(a){Zi(a.message)}}),t.resumeEvaluation())}function RSe(t,e){return(Qi(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}var qk=U(nl(),1),ASe="DD/MM/YYYY";function rX(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function ISe(t){return rX(t)?t.substr(1):t}function DSe(t){return typeof t=="string"&&t.startsWith("=")}function b3(t,e){return typeof t=="string"&&e==="date"}function nX(t,e){return(0,qk.default)(t,e,!0).isValid()}function oX(t,e){return(0,qk.default)(t,e,!0).format(ASe)}function MSe(t,e){return(0,qk.default)(t,ASe,!0).format(e)}function sX(t,e){let r=new Date(Date.UTC(0,0,t+-1));return(0,qk.default)(r).format(e)}var Y4i=U($e(),1);var j4i=U($e(),1),z4i=U(dt(),1);var B4i=U(dt(),1);function Fvt(t,e,i){let r=Array.from(Array(i).keys()).filter(o=>t.includes(o)===!1);if(e===0){var n;return(n=r[e])!==null&&n!==void 0?n:0}return r[e-1]+1}function Hvt(t,e){let i=[];return t.forEach(r=>{let n={from:r,to:e};i.forEach(o=>{let s=o.from>o.to,a=o.to<=n.from;o.from>n.from&&a&&s&&(n.from+=1)}),n.from>=e&&(e+=1),i.push(n)}),i}function Bvt(t){return t.forEach((e,i)=>{t.slice(i+1).forEach(n=>{let o=n.from<n.to;n.from>e.from&&o&&(n.from-=1)})}),t}function Yk(t,e,i){let r=Hvt(t,Fvt(t,e,i));return Bvt(r)}function Ly(t,e,i){Vvt(t,e),e.set(t,i)}function Vvt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ro(t,e){return t.get(kSe(t,e))}function Cb(t,e,i){return t.set(kSe(t,e),i),i}function kSe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var $k=new WeakMap,xb=new WeakMap,hd=new WeakMap,_3=new WeakMap,aX=new WeakMap,lX=new WeakMap,y3=new WeakMap,cX=class{constructor(e,i,r){Ly(this,$k,void 0),Ly(this,xb,void 0),Ly(this,hd,void 0),Ly(this,_3,[]),Ly(this,aX,[]),Ly(this,lX,void 0),Ly(this,y3,[]),Cb($k,this,e),Cb(xb,this,i),Cb(hd,this,r)}setRemovedHfIndexes(e){return Cb(y3,this,e.map(i=>{let r=ro(xb,this).getVisualFromPhysicalIndex(i);return this.getHfIndexFromVisualIndex(r)})),ro(y3,this)}getRemovedHfIndexes(){return ro(y3,this)}getHfIndexFromVisualIndex(e){let i=ro(xb,this).getIndexesSequence(),r=ro(xb,this).getNotTrimmedIndexes();return i.indexOf(r[e])}syncMoves(e){let r=`move${ka(ro($k,this))}s`;ro(hd,this).getEngine().batch(()=>{e.forEach(n=>{let o=n.from!==n.to,s=n.from+1!==n.to;o&&s&&ro(hd,this).getEngine()[r](ro(hd,this).getSheetId(),n.from,1,n.to)})})}storeMovesInformation(e,i,r){r!==!1&&(Cb(aX,this,e.map(n=>this.getHfIndexFromVisualIndex(n))),Cb(lX,this,this.getHfIndexFromVisualIndex(i)))}calculateAndSyncMoves(e,i){if(ro(hd,this).isPerformingUndoRedo()||e===!1||i===!1)return;let r=Yk(ro(aX,this),ro(lX,this),ro(xb,this).getNumberOfIndexes());ro(hd,this).getSheetId()===null?ro(hd,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){let e=`set${ka(ro($k,this))}Order`;return i=>{if(ro(hd,this).isPerformingUndoRedo())return;let r=ro(xb,this).getIndexesSequence();if(i==="update"&&r.length>0){let n=ro(_3,this).map(c=>r.indexOf(c)),o=ro(hd,this).getEngine().getSheetDimensions(ro(hd,this).getSheetId()),s;ro($k,this)==="row"?s=o.height:s=o.width;let a=n.length;for(let c=a;c<s;c+=1)n.push(c);ro(hd,this).getEngine()[e](ro(hd,this).getSheetId(),n)}Cb(_3,this,r)}}init(){Cb(_3,this,ro(xb,this).getIndexesSequence())}},dX=cX;function Fy(t,e,i){jvt(t,e),e.set(t,i)}function jvt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Om(t,e){return t.get(OSe(t,e))}function Hy(t,e,i){return t.set(OSe(t,e),i),i}function OSe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var w3=new WeakMap,C3=new WeakMap,uX=new WeakMap,hX=new WeakMap,fX=new WeakMap,pX=new WeakMap,mX=new WeakMap,gX=class{constructor(e,i,r){Fy(this,w3,void 0),Fy(this,C3,void 0),Fy(this,uX,void 0),Fy(this,hX,!1),Fy(this,fX,!1),Fy(this,pX,null),Fy(this,mX,null),Hy(w3,this,new dX("row",e,this)),Hy(C3,this,new dX("column",i,this)),Hy(uX,this,r)}getForAxis(e){return e==="row"?Om(w3,this):Om(C3,this)}setPerformUndo(e){Hy(hX,this,e)}setPerformRedo(e){Hy(fX,this,e)}isPerformingUndoRedo(){return Om(hX,this)||Om(fX,this)}getSheetId(){return Om(mX,this)}getEngine(){return Om(pX,this)}getPostponeAction(){return Om(uX,this)}setupSyncEndpoint(e,i){Hy(pX,this,e),Hy(mX,this,i),Om(w3,this).init(),Om(C3,this).init()}},NSe=gX;function zvt(t,e){HSe(t,e),e.add(t)}function VS(t,e,i){return e=Wvt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Wvt(t){var e=Uvt(t,"string");return typeof e=="symbol"?e:e+""}function Uvt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vX(t,e,i){HSe(t,e),e.set(t,i)}function HSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sb(t,e,i){return t.set(yn(t,e),i),i}function jS(t,e){return t.get(yn(t,e))}function yn(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var zs="formulas",qvt=["maxRows","maxColumns","language"],BSe=260;Ct.getSingleton().register("afterNamedExpressionAdded");Ct.getSingleton().register("afterNamedExpressionRemoved");Ct.getSingleton().register("afterSheetAdded");Ct.getSingleton().register("afterSheetRemoved");Ct.getSingleton().register("afterSheetRenamed");Ct.getSingleton().register("afterFormulasValuesUpdate");var zS=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto",Nm=new WeakMap,bX=new WeakMap,Gk=new WeakMap,An=new WeakSet,Xk=class extends Zt{constructor(){var e;super(...arguments),e=this,zvt(this,An),vX(this,Nm,!1),vX(this,bX,!1),vX(this,Gk,[["valuesUpdated",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return yn(An,e,abt).call(e,...r)}],["namedExpressionAdded",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return yn(An,e,lbt).call(e,...r)}],["namedExpressionRemoved",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return yn(An,e,cbt).call(e,...r)}],["sheetAdded",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return yn(An,e,dbt).call(e,...r)}],["sheetRenamed",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return yn(An,e,ubt).call(e,...r)}],["sheetRemoved",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return yn(An,e,hbt).call(e,...r)}]]),VS(this,"staticRegister",ls("formulas")),VS(this,"engine",null),VS(this,"sheetName",null),VS(this,"indexSyncer",null),VS(this,"rowAxisSyncer",null),VS(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return zs}static get PLUGIN_PRIORITY(){return BSe}static get SETTING_KEYS(){return[zs,...qvt]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[zs]}enablePlugin(){var e,i=this;if(!this.enabled){if(this.engine=(e=TSe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Zi("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){let r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,PSe).call(i,...n)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,LSe).call(i,...n)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,PSe).call(i,...n)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,LSe).call(i,...n)}),this.addHook("modifyData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,Xvt).call(i,...n)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,Kvt).call(i,...n)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,Yvt).call(i,...n)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,Zvt).call(i,...n)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,FSe).call(i,...n)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,FSe).call(i,...n)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,Qvt).call(i,...n)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,Jvt).call(i,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,ibt).call(i,...n)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,rbt).call(i,...n)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,ebt).call(i,...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,tbt).call(i,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,nbt).call(i,...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,obt).call(i,...n)}),this.indexSyncer=new NSe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,n,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,n,s)}),this.hot.addHook("beforeColumnMove",(r,n,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,n,s)}),this.hot.addHook("afterRowMove",(r,n,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,n,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,n)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,n)}),this.hot.addHook("afterColumnFreeze",(r,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,n)}),this.hot.addHook("beforeColumnUnfreeze",(r,n)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,n)}),this.hot.addHook("afterColumnUnfreeze",(r,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,n)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,Gvt).call(i,...n)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,sbt).call(i,...n)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return yn(An,i,$vt).call(i,...n)}),jS(Gk,this).forEach(r=>{let[n,o]=r;return this.engine.on(n,o)}),super.enablePlugin()}}disablePlugin(){jS(Gk,this).forEach(e=>{let[i,r]=e;return this.engine.off(i,r)}),iX(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){let i=SSe(this.hot.getSettings());ESe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);let r=this.hot.getSettings()[zs];if(wt(r)&&wt(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){let n=this.hot.getSettings()[zs].sheetName;n&&this.engine.doesSheetExist(n)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(n??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){jS(Gk,this).forEach(e=>{var i;let[r,n]=e;return(i=this.engine)===null||i===void 0?void 0:i.off(r,n)}),Sb(Gk,this,null),iX(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,i){if(wt(i)&&!gye(i))return Zi("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Zi("Sheet with the provided name already exists."),!1;try{let r=this.engine.addSheet(e??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(r),i),r}catch(r){return Zi(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){f1(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;let i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,`${ka(zs)}.switchSheet`)}getCellType(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,n=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(i);return n!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}isFormulaCellType(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}renderDependentSheets(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=new Set;e.forEach(n=>{var o;let s=n==null||(o=n.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),tX(this.engine).forEach((n,o)=>{if((i||o!==this.sheetId)&&r.has(o)){var s;n.render(),(s=n.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=o=>{var s;let{row:a,col:c,sheet:d}=(s=o?.address)!==null&&s!==void 0?s:{};return wt(d)?`${d}:${a}x${c}`:""},n=new Set(i.map(o=>r(o)));e.forEach(o=>{var s,a;let{row:c,col:d}=(s=o.address)!==null&&s!==void 0?s:{};if(wt(c)===!1||wt(d)===!1||c>=this.hot.countRows()||d>=this.hot.countCols())return;let u=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(u!==void 0&&!n.has(h)){let p=tX(this.engine).get(u);if(!p)return;p.validateCell(p.getDataAtCell(c,d),p.getCellMeta(c,d),()=>{})}})}syncChangeWithEngine(e,i,r){let n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(n)){Zi(`Not possible to set cell data at ${JSON.stringify(n)}`);return}let o=this.hot.getCellMeta(e,i);return b3(r,o.type)&&(nX(r,o.dateFormat)?r=oX(r,o.dateFormat):DSe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(n,r)}};function Yvt(t,e,i){let r=this.hot.propToCol(i);if(this.isFormulaCellType(e,r)){let n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r),s=this.engine.getCellValue(n);return o.type==="date"&&ds(s)&&(s=sX(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function $vt(t,e,i){let{row:r,col:n}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:c}=i.getTopStartCorner(),{row:d,col:u}=i.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},p={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(p)===!1)return!1;let f=this.engine.getFillRangeData(h,p),{row:m,col:g}=h.start,{row:y,col:w}=h.end,x=y-m+1,T=w-g+1;for(let M=0;M<f.length;M+=1)for(let B=0;B<f[M].length;B+=1){let G=f[M][B],F=M%x,O=B%T,V=this.hot.getCellMeta(F,O);b3(G,V.type)&&(G.startsWith("'")?f[M][B]=G.slice(1):this.isFormulaCellType(F,O,this.sheetId)===!1&&(f[M][B]=MSe(G,V.dateFormat)))}return f}function PSe(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(ka(zs))||Sb(bX,this,Qi(this.hot.getSettings().data))}function Gvt(){let t=this.hot.getSourceDataArray(),e=!1;t.forEach((i,r)=>{i.forEach((n,o)=>{let s=this.hot.getCellMeta(r,o),a=s.dateFormat;b3(n,s.type)&&(e=!0,nX(n,a)?t[r][o]=oX(n,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${n}`))})}),e===!0&&(Sb(Nm,this,!0),this.engine.setSheetContent(this.sheetId,t),Sb(Nm,this,!1))}function LSe(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(ka(zs)))if(this.sheetName=RSe(this.engine,this.hot.getSettings()[zs].sheetName),jS(bX,this))this.switchSheet(this.sheetName);else{let r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Sb(Nm,this,!0);let n=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(n),Sb(Nm,this,!1)}}}function Xvt(t,e,i,r){if(r!=="get"||jS(Nm,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;let n=this.hot.toVisualRow(t);if(n===null||e===null)return;if(!this.isFormulaCellType(n,e)&&this.getCellType(n,e)!=="ARRAY"){rX(i.value)&&(i.value=ISe(i.value));return}let s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},a=this.engine.getCellValue(s),c=this.hot.getCellsMeta().find(u=>u.visualRow===n&&u.visualCol===e);c===void 0&&(c={}),c.type==="date"&&ds(a)&&(a=sX(a,c.dateFormat));let d=typeof a=="object"&&a!==null?a.value:a;i.value=d}function Kvt(t,e,i,r){if(r!=="get"||jS(Nm,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;let n=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(n===null||o===null||!this.isFormulaCellType(n,o)&&this.getCellType(n,o)!=="ARRAY")return;let a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;let c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};i.value=this.engine.getCellSerialized(c)}function FSe(t,e){if(zS(e))return;let i=[],r=[],n=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,c]=o,d=this.hot.propToCol(a),u=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(d),p={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};u!==null&&h!==null?this.syncChangeWithEngine(s,d,c):i.push([s,d,c]),r.push({address:p})})});i.length&&this.hot.addHookOnce("afterChange",()=>{let o=this.engine.batch(()=>{i.forEach(s=>{let[a,c,d]=s;this.syncChangeWithEngine(a,c,d)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Zvt(t,e){if(zS(e))return;let i=[],r=[];t.forEach(n=>{let[o,s,,a]=n,c=this.hot.propToCol(s);if(!ds(c))return;let d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){Zi(`Not possible to set source cell data at ${JSON.stringify(d)}`);return}r.push({address:d}),i.push(...this.engine.setCellContents(d,a))}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Qvt(t,e){let i=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(i=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[i,e]))return!1}function Jvt(t,e){let i=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(i=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[i,e]))return!1}function ebt(t,e,i){return this.rowAxisSyncer.setRemovedHfIndexes(i).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function tbt(t,e,i){return this.columnAxisSyncer.setRemovedHfIndexes(i).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function ibt(t,e,i){if(zS(i))return;let r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function rbt(t,e,i){if(zS(i))return;let r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function nbt(t,e,i,r){if(zS(r))return;let n=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{n.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function obt(t,e,i,r){if(zS(r))return;let n=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{n.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function sbt(t,e,i){var r;Sb(Nm,this,!0);let n=this.hot.getSourceDataArray(i,0,i+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Sb(Nm,this,!1),n.forEach((o,s)=>{o.forEach((a,c)=>{this.engine.setCellContents({col:c,row:i+s,sheet:this.sheetId},[[a]])})})}function abt(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function lbt(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function cbt(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function dbt(t){this.hot.runHooks("afterSheetAdded",t)}function ubt(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function hbt(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}var EVi=U($e(),1),TVi=U(dt(),1),RVi=U(ln(),1),AVi=U(cn(),1),IVi=U(dn(),1),DVi=U(un(),1),MVi=U(hn(),1),kVi=U(fn(),1),OVi=U(pn(),1);var yVi=U(dt(),1);function _X(t){return{key:"hidden_columns_hide",name(){let e=this.getSelectedLast(),i=0;if(Array.isArray(e)){let[,r,,n]=e;r-n!==0&&(i=1)}return this.getTranslatedPhrase(UD,i)},callback(){let{from:e,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,i.col),0),n=Math.max(e.col,i.col),o=[];for(let c=r;c<=n;c+=1)o.push(c);t.hideColumns(o);let s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}var CVi=U(dt(),1);function yX(t){let e=[];return{key:"hidden_columns_show",name(){let i=e.length>1?1:0;return this.getTranslatedPhrase(qD,i)},callback(){var i,r;if(e.length===0)return;let n=e[0],o=e[e.length-1];n=(i=this.columnIndexMapper.getNearestNotHiddenIndex(n-1,-1))!==null&&i!==void 0?i:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-n+1===this.countCols()||this.selectColumns(n,o)},disabled:!1,hidden(){let i=ri(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(n),c=s.getRenderableFromVisualIndex(o),d=s.getNotTrimmedIndexes(),u=[];if(n!==o){let h=o-n+1,p=c-a+1;if(h>p){let f=d.slice(n,o+1);u.push(...f.filter(m=>i.includes(m)))}}else if(a===0&&a<n)u.push(...d.slice(0,n));else if(a===null)u.push(...d.slice(0,this.countCols()));else{let h=this.countCols()-1,p=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));c===p&&h>o&&u.push(...d.slice(o+1))}return Ce(u,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function fbt(t,e){jSe(t,e),e.add(t)}function VSe(t,e,i){jSe(t,e),e.set(t,i)}function jSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fd(t,e){return t.get(Eb(t,e))}function Kk(t,e,i){return t.set(Eb(t,e),i),i}function Eb(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("beforeHideColumns");Ct.getSingleton().register("afterHideColumns");Ct.getSingleton().register("beforeUnhideColumns");Ct.getSingleton().register("afterUnhideColumns");var x3="hiddenColumns",zSe=310,Gf=new WeakMap,$f=new WeakMap,By=new WeakSet,Zk=class extends Zt{constructor(){super(...arguments),fbt(this,By),VSe(this,Gf,{}),VSe(this,$f,null)}static get PLUGIN_KEY(){return x3}static get PLUGIN_PRIORITY(){return zSe}isEnabled(){return!!this.hot.getSettings()[x3]}enablePlugin(){var e=this;if(this.enabled)return;let i=this.hot.getSettings()[x3];Xt(i)&&(Kk(Gf,this,i),Qi(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Kk($f,this,new Of),fd($f,this).addLocalHook("init",()=>Eb(By,this,_bt).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,fd($f,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Eb(By,e,bbt).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,o)=>Eb(By,this,mbt).call(this,r,n,o)),this.addHook("modifyColWidth",(r,n)=>Eb(By,this,pbt).call(this,r,n),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Eb(By,e,vbt).call(e,...n)}),this.addHook("modifyCopyableRange",r=>Eb(By,this,gbt).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Kk(Gf,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){let i=this.getHiddenColumns(),r=this.isValidConfig(e),n=i,o=fd($f,this).getValues().slice(),s=e.length>0;if(r&&s){let c=e.map(d=>this.hot.toPhysicalColumn(d));Ce(c,d=>{o[d]=!1}),n=Gr(o,(d,u,h)=>(u&&d.push(this.hot.toVisualColumn(h)),d),[])}this.hot.runHooks("beforeUnhideColumns",i,n,r&&s)!==!1&&(r&&s&&fd($f,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",i,n,r&&s,r&&n.length<i.length))}showColumn(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];this.showColumns(i)}hideColumns(e){let i=this.getHiddenColumns(),r=this.isValidConfig(e),n=i;r&&(n=Array.from(new Set(i.concat(e)))),this.hot.runHooks("beforeHideColumns",i,n,r)!==!1&&(r&&this.hot.batchExecution(()=>{Ce(e,s=>{fd($f,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",i,n,r,r&&n.length>i.length))}hideColumn(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];this.hideColumns(i)}getHiddenColumns(){return ri(fd($f,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return fd($f,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){let i=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<i):!1}resetCellsMeta(){Ce(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Kk(Gf,this,null),Kk($f,this,null),super.destroy()}};function pbt(t,e){if(this.isHidden(e))return 0;if(fd(Gf,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function mbt(t,e,i){if(fd(Gf,this).copyPasteEnabled===!1&&this.isHidden(e)&&(i.skipColumnOnPaste=!0),this.isHidden(e-1))i.className=i.className||"",i.className.indexOf("afterHiddenColumn")===-1&&(i.className+=" afterHiddenColumn");else if(i.className){let r=i.className.split(" ");if(r.length>0){let n=r.indexOf("afterHiddenColumn");n>-1&&r.splice(n,1),i.className=r.join(" ")}}}function gbt(t){if(fd(Gf,this).copyPasteEnabled)return t;let e=[],i=(r,n,o,s)=>{e.push({startRow:r,endRow:n,startCol:o,endCol:s})};return Ce(t,r=>{let n=!0,o=0;_t(r.startCol,r.endCol,s=>{this.isHidden(s)?(n||i(r.startRow,r.endRow,o,s-1),n=!0):(n&&(o=s),s===r.endCol&&i(r.startRow,r.endRow,o,s),n=!1)})}),e}function vbt(t,e){if(!fd(Gf,this).indicators||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&i.push("beforeHiddenColumn"),Qe(e,i)}function bbt(t){t.items.push({name:gi},_X(this),yX(this))}function _bt(){Array.isArray(fd(Gf,this).columns)&&this.hideColumns(fd(Gf,this).columns)}var JVi=U($e(),1),eji=U(dt(),1),tji=U(ln(),1),iji=U(cn(),1),rji=U(dn(),1),nji=U(un(),1),oji=U(hn(),1),sji=U(fn(),1),aji=U(pn(),1);var GVi=U(dt(),1);function wX(t){return{key:"hidden_rows_hide",name(){let e=this.getSelectedLast(),i=0;if(Array.isArray(e)){let[r,,n]=e;r-n!==0&&(i=1)}return this.getTranslatedPhrase(YD,i)},callback(){let{from:e,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,i.row),0),n=Math.max(e.row,i.row),o=[];for(let c=r;c<=n;c+=1)o.push(c);t.hideRows(o);let s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}var KVi=U(dt(),1);function CX(t){let e=[];return{key:"hidden_rows_show",name(){let i=e.length>1?1:0;return this.getTranslatedPhrase($D,i)},callback(){var i,r;if(e.length===0)return;let n=e[0],o=e[e.length-1];n=(i=this.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1))!==null&&i!==void 0?i:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-n+1===this.countRows()||this.selectRows(n,o)},disabled:!1,hidden(){let i=ri(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(n),c=s.getRenderableFromVisualIndex(o),d=s.getNotTrimmedIndexes(),u=[];if(n!==o){let h=o-n+1,p=c-a+1;if(h>p){let f=d.slice(n,o+1);u.push(...f.filter(m=>i.includes(m)))}}else if(a===0&&a<n)u.push(...d.slice(0,n));else if(a===null)u.push(...d.slice(0,this.countRows()));else{let h=this.countRows()-1,p=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));c===p&&h>o&&u.push(...d.slice(o+1))}return Ce(u,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function ybt(t,e){USe(t,e),e.add(t)}function WSe(t,e,i){USe(t,e),e.set(t,i)}function USe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gu(t,e){return t.get(Tb(t,e))}function Qk(t,e,i){return t.set(Tb(t,e),i),i}function Tb(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("beforeHideRows");Ct.getSingleton().register("afterHideRows");Ct.getSingleton().register("beforeUnhideRows");Ct.getSingleton().register("afterUnhideRows");var S3="hiddenRows",qSe=320,Pm=new WeakMap,Xf=new WeakMap,Vy=new WeakSet,Jk=class extends Zt{constructor(){super(...arguments),ybt(this,Vy),WSe(this,Pm,{}),WSe(this,Xf,null)}static get PLUGIN_KEY(){return S3}static get PLUGIN_PRIORITY(){return qSe}isEnabled(){return!!this.hot.getSettings()[S3]}enablePlugin(){var e=this;if(this.enabled)return;let i=this.hot.getSettings()[S3];Xt(i)&&(Qk(Pm,this,i),Qi(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Qk(Xf,this,new Of),gu(Xf,this).addLocalHook("init",()=>Tb(Vy,this,Tbt).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,gu(Xf,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Tb(Vy,e,Ebt).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,o)=>Tb(Vy,this,Cbt).call(this,r,n,o)),this.addHook("modifyRowHeight",(r,n)=>Tb(Vy,this,wbt).call(this,r,n)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Tb(Vy,e,Sbt).call(e,...n)}),this.addHook("modifyCopyableRange",r=>Tb(Vy,this,xbt).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Qk(Pm,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){let i=this.getHiddenRows(),r=this.isValidConfig(e),n=i,o=gu(Xf,this).getValues().slice(),s=e.length>0;if(r&&s){let c=e.map(d=>this.hot.toPhysicalRow(d));Ce(c,d=>{o[d]=!1}),n=Gr(o,(d,u,h)=>(u&&d.push(this.hot.toVisualRow(h)),d),[])}this.hot.runHooks("beforeUnhideRows",i,n,r&&s)!==!1&&(r&&s&&gu(Xf,this).setValues(o),this.hot.runHooks("afterUnhideRows",i,n,r&&s,r&&n.length<i.length))}showRow(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];this.showRows(i)}hideRows(e){let i=this.getHiddenRows(),r=this.isValidConfig(e),n=i;r&&(n=Array.from(new Set(i.concat(e)))),this.hot.runHooks("beforeHideRows",i,n,r)!==!1&&(r&&this.hot.batchExecution(()=>{Ce(e,s=>{gu(Xf,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",i,n,r,r&&n.length>i.length))}hideRow(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];this.hideRows(i)}getHiddenRows(){return ri(gu(Xf,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return gu(Xf,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){let i=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<i):!1}resetCellsMeta(){Ce(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Qk(Pm,this,null),Qk(Xf,this,null),super.destroy()}};function wbt(t,e){return this.isHidden(e)?0:t}function Cbt(t,e,i){if(gu(Pm,this).copyPasteEnabled===!1&&this.isHidden(t)&&(i.skipRowOnPaste=!0),this.isHidden(t-1))i.className=i.className||"",i.className.indexOf("afterHiddenRow")===-1&&(i.className+=" afterHiddenRow");else if(i.className){let r=i.className.split(" ");if(r.length>0){let n=r.indexOf("afterHiddenRow");n>-1&&r.splice(n,1),i.className=r.join(" ")}}}function xbt(t){if(gu(Pm,this).copyPasteEnabled)return t;let e=[],i=(r,n,o,s)=>{e.push({startRow:r,endRow:n,startCol:o,endCol:s})};return Ce(t,r=>{let n=!0,o=0;_t(r.startRow,r.endRow,s=>{this.isHidden(s)?(n||i(o,s-1,r.startCol,r.endCol),n=!0):(n&&(o=s),s===r.endRow&&i(o,s,r.startCol,r.endCol),n=!1)})}),e}function Sbt(t,e){if(!gu(Pm,this).indicators||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&i.push("beforeHiddenRow"),Qe(e,i)}function Ebt(t){t.items.push({name:gi},wX(this),CX(this))}function Tbt(){Array.isArray(gu(Pm,this).rows)&&this.hideRows(gu(Pm,this).rows)}var Sji=U($e(),1),Eji=U(dt(),1);function xX(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(yD)},callback(e,i){let[{start:{col:r}}]=i;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){let e=this.getSelectedRange(),i=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(i=!0),i}}}function SX(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(wD)},callback(e,i){let[{start:{col:r}}]=i;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){let e=this.getSelectedRange(),i=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(i=!0),i}}}function Rbt(t,e){YSe(t,e),e.add(t)}function Abt(t,e,i){YSe(t,e),e.set(t,i)}function YSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RX(t,e){return t.get(E3(t,e))}function EX(t,e,i){return t.set(E3(t,e),i),i}function E3(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("beforeColumnFreeze");Ct.getSingleton().register("afterColumnFreeze");Ct.getSingleton().register("beforeColumnUnfreeze");Ct.getSingleton().register("afterColumnUnfreeze");var AX="manualColumnFreeze",$Se=110,jy=new WeakMap,TX=new WeakSet,eO=class extends Zt{constructor(){super(...arguments),Rbt(this,TX),Abt(this,jy,!1)}static get PLUGIN_KEY(){return AX}static get PLUGIN_PRIORITY(){return $Se}isEnabled(){return!!this.hot.getSettings()[AX]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>E3(TX,this,Ibt).call(this,e)),this.addHook("beforeColumnMove",(e,i)=>E3(TX,this,Dbt).call(this,e,i)),super.enablePlugin())}disablePlugin(){EX(jy,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){let i=this.hot.getSettings(),r=i.fixedColumnsStart<this.hot.countCols()&&e>i.fixedColumnsStart-1;RX(jy,this)||EX(jy,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,i.fixedColumnsStart),i._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){let i=this.hot.getSettings(),r=i.fixedColumnsStart>0&&e<=i.fixedColumnsStart-1;RX(jy,this)||EX(jy,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(i._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,i.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}};function Ibt(t){t.items.push({name:"---------"},xX(this),SX(this))}function Dbt(t,e){if(RX(jy,this)){let i=this.hot.getSettings().fixedColumnsStart;if(e<i||t.some(r=>r<i))return!1}}var Wji=U($e(),1),Uji=U(dt(),1);var Oji=U($e(),1);function T3(t,e,i){return e=Mbt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Mbt(t){var e=kbt(t,"string");return typeof e=="symbol"?e:e+""}function kbt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var IX=0,GSe=1,XSe=2,WS="px",DX=class{constructor(e){T3(this,"hot",void 0),T3(this,"_element",null),T3(this,"state",IX),T3(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=XSe}build(){this.state===IX&&(this._element=this.hot.rootDocument.createElement("div"),this.state=GSe)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=IX}isAppended(){return this.state===XSe}isBuilt(){return this.state>=GSe}setPosition(e,i){ds(e)&&(this._element.style.top=e+WS),ds(i)&&(this._element.style[this.inlineProperty]=i+WS)}getPosition(){let e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,i){ds(e)&&(this._element.style.width=e+WS),ds(i)&&(this._element.style.height=i+WS)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,i){ds(e)&&(this._element.style.marginTop=e+WS),ds(i)&&(this._element.style[`margin${ka(this.inlineProperty)}`]=i+WS)}getOffset(){let e=this._element.style,i=`margin${ka(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[i]?parseInt(e[i],10):0}}},R3=DX;var Obt="ht__manualColumnMove--backlight",MX=class extends R3{build(){super.build(),Qe(this._element,Obt)}},KSe=MX;var Nbt="ht__manualColumnMove--guideline",kX=class extends R3{build(){super.build(),Qe(this._element,Nbt)}},ZSe=kX;function Pbt(t,e){JSe(t,e),e.add(t)}function vh(t,e,i){JSe(t,e),e.set(t,i)}function JSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mc(t,e,i){return t.set(Rb(t,e),i),i}function Qt(t,e){return t.get(Rb(t,e))}function Rb(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("beforeColumnMove");Ct.getSingleton().register("afterColumnMove");var I3="manualColumnMove",eEe=120,QSe="ht__manualColumnMove",M3="show-ui",OX="on-moving--columns",NX="after-selection--columns",Ul=new WeakMap,Ab=new WeakMap,Lm=new WeakMap,D3=new WeakMap,Ib=new WeakMap,Wl=new WeakMap,A3=new WeakMap,vu=new WeakMap,US=new WeakMap,k3=new WeakMap,tO=new WeakMap,zy=new WeakSet,iO=class extends Zt{constructor(){super(...arguments),Pbt(this,zy),vh(this,Ul,new KSe(this.hot)),vh(this,Ab,new ZSe(this.hot)),vh(this,Lm,[]),vh(this,D3,0),vh(this,Ib,!1),vh(this,Wl,{}),vh(this,A3,void 0),vh(this,vu,void 0),vh(this,US,void 0),vh(this,k3,void 0),vh(this,tO,void 0)}static get PLUGIN_KEY(){return I3}static get PLUGIN_PRIORITY(){return eEe}isEnabled(){return!!this.hot.getSettings()[I3]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Rb(zy,e,Lbt).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Rb(zy,e,Hbt).call(e,...r)}),this.addHook("afterScrollVertically",()=>Rb(zy,this,Vbt).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Rb(zy,e,jbt).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Qe(this.hot.rootElement,QSe),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Gt(this.hot.rootElement,QSe),this.unregisterEvents(),Qt(Ul,this).destroy(),Qt(Ab,this).destroy(),super.disablePlugin()}moveColumn(e,i){return this.moveColumns([e],i)}moveColumns(e,i){let r=Qt(A3,this),n=this.isMovePossible(e,i),o=this.hot.runHooks("beforeColumnMove",e,i,r,n);if(Mc(A3,this,void 0),o===!1)return;n&&this.hot.columnIndexMapper.moveIndexes(e,i);let s=n&&this.isColumnOrderChanged(e,i);return this.hot.runHooks("afterColumnMove",e,i,r,n,s),s}dragColumn(e,i){return this.dragColumns([e],i)}dragColumns(e,i){let r=this.countFinalIndex(e,i);return Mc(A3,this,i),this.moveColumns(e,r)}isMovePossible(e,i){let r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=e.length+i>r,o=i<0,s=e.some(c=>c<0),a=e.some(c=>c>=r);return!(n||o||s||a)}isColumnOrderChanged(e,i){return e.some((r,n)=>r-n!==i)}countFinalIndex(e,i){let r=Gr(e,(n,o)=>(o<i&&(n+=1),n),0);return i-r}getColumnsWidth(e,i){let r=this.hot.columnIndexMapper,n=0;for(let o=e;o<=i;o+=1){let s=r.getRenderableFromVisualIndex(o);o<0?n+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return n}moveBySettingsOrLoad(){let e=this.hot.getSettings()[I3];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){let i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){let e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,i){let r=[];return _t(e,i,n=>{r.push(n)}),r}refreshPositions(){let e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Qt(vu,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});let i=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,n=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft,o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Qt(vu,this)-1),s=i.hider.offsetWidth,a=i.TBODY.offsetLeft,c=Qt(Ul,this).getOffset().start,d=Qt(Ul,this).getSize().width,u=0,h=0;if(this.hot.isRtl()){let m=this.hot.rootWindow,g=Ji(this.hot.rootElement),y=m.innerWidth-Qt(US,this)-g;h=m.innerWidth-Qt(Wl,this).eventPageX-y-(r.scrollX===void 0?n:0)}else h=Qt(Wl,this).eventPageX-(Qt(US,this)-(r.scrollX===void 0?n:0));if(Qt(k3,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Qt(vu,this))&&(o+=n),o+=u,Qt(vu,this)<0)Qt(tO,this)>0?Qt(Wl,this).col=0:Qt(Wl,this).col=e>0?e-1:e;else if(Qt(Wl,this).TD.offsetWidth/2+o<=h){let m=Qt(vu,this)>=Qt(D3,this)?Qt(D3,this)-1:Qt(vu,this);Qt(Wl,this).col=m+1,o+=Qt(Wl,this).TD.offsetWidth}else Qt(Wl,this).col=Qt(vu,this);let p=h,f=o;h+d+c>=s?p=s-d-c:h+c<a+u&&(p=a+u+Math.abs(c)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&Qt(vu,this)<Qt(tO,this)&&(f-=Qt(US,this)<=r.scrollX?Qt(US,this):0),Qt(Ul,this).setPosition(null,p),Qt(Ab,this).setPosition(null,f)}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",i=>Rb(zy,this,Fbt).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Rb(zy,this,Bbt).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Qt(Ul,this).build(),Qt(Ab,this).build()}destroy(){Qt(Ul,this).destroy(),Qt(Ab,this).destroy(),super.destroy()}};function Lbt(t,e,i,r){let n=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Bt(t.target,"sortAction");if(!s||!o||Qt(Ib,this)||t.button!==0||a){Mc(Ib,this,!1),Qt(Lm,this).length=0,Gt(this.hot.rootElement,[OX,M3]);return}let c=Qt(Ab,this).isBuilt()&&!Qt(Ab,this).isAppended(),d=Qt(Ul,this).isBuilt()&&!Qt(Ul,this).isAppended();c&&d&&(Qt(Ab,this).appendTo(n.hider),Qt(Ul,this).appendTo(n.hider));let{from:u,to:h}=s,p=Math.min(u.col,h.col),f=Math.max(u.col,h.col);if(e.row<0&&e.col>=p&&e.col<=f){r.column=!0,Mc(Ib,this,!0);let m=i.firstChild?X0e(t,i.firstChild).x:t.offsetX;Qt(Wl,this).eventPageX=t.pageX,Mc(vu,this,e.col),Qt(Wl,this).TD=i,Qt(Wl,this).col=e.col,Mc(Lm,this,this.prepareColumnsToMoving(p,f)),Mc(k3,this,!!this.hot.getSettings().rowHeaders),Mc(D3,this,this.hot.countCols()),Mc(tO,this,this.hot.getSettings().fixedColumnsStart),Mc(US,this,Nn(this.hot.rootElement).left);let g=Qt(k3,this)?-1:0,y=n.holder.scrollTop+n.getColumnHeaderHeight(0)+1,w=e.col<Qt(tO,this),x=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(m-(this.hot.isRtl()?i.offsetWidth:0)),M=this.getColumnsWidth(p,e.col-1)+T,B=this.getColumnsWidth(g,p-1)+(w?x:0)+M;Qt(Ul,this).setPosition(y,B),Qt(Ul,this).setSize(this.getColumnsWidth(p,f),n.hider.offsetHeight-y),Qt(Ul,this).setOffset(null,-M),Qe(this.hot.rootElement,OX)}else Gt(this.hot.rootElement,NX),Mc(Ib,this,!1),Qt(Lm,this).length=0}function Fbt(t){Qt(Ib,this)&&(Qt(Wl,this).eventPageX=t.pageX,this.refreshPositions())}function Hbt(t,e,i,r){!this.hot.getSelectedRangeLast()||!Qt(Ib,this)||(Qt(Lm,this).indexOf(e.col)>-1?Gt(this.hot.rootElement,M3):Qe(this.hot.rootElement,M3),r.row=!0,r.column=!0,r.cell=!0,Mc(vu,this,e.col),Qt(Wl,this).TD=i)}function Bbt(){let t=Qt(Wl,this).col,e=Qt(Lm,this).length;if(Mc(vu,this,void 0),Mc(Ib,this,!1),Gt(this.hot.rootElement,[OX,M3,NX]),this.hot.selection.isSelectedByColumnHeader()&&Qe(this.hot.rootElement,NX),e<1||t===void 0)return;let i=Qt(Lm,this)[0],r=this.hot.toPhysicalColumn(i),n=this.dragColumns(Qt(Lm,this),t);if(Qt(Lm,this).length=0,n===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();let o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Vbt(){let t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,i=t.holder.scrollTop,r=e+i;Qt(Ul,this).setPosition(r),Qt(Ul,this).setSize(null,t.hider.offsetHeight-r)}function jbt(){this.moveBySettingsOrLoad()}var i6i=U($e(),1),r6i=U(dt(),1);function zbt(t,e){iEe(t,e),e.add(t)}function pl(t,e,i){iEe(t,e),e.set(t,i)}function iEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yo(t,e,i){return t.set(bh(t,e),i),i}function jt(t,e){return t.get(bh(t,e))}function bh(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var sO="manualColumnResize",rEe=130,tEe="manualColumnWidths",Hm=new WeakMap,O3=new WeakMap,pd=new WeakMap,P3=new WeakMap,Zf=new WeakMap,Wbt=new WeakMap,qS=new WeakMap,N3=new WeakMap,kc=new WeakMap,Fm=new WeakMap,Wy=new WeakMap,L3=new WeakMap,rO=new WeakMap,nO=new WeakMap,md=new WeakMap,oO=new WeakMap,Kf=new WeakSet,aO=class extends Zt{static get PLUGIN_KEY(){return sO}static get PLUGIN_PRIORITY(){return rEe}constructor(e){super(e),zbt(this,Kf),pl(this,Hm,null),pl(this,O3,null),pl(this,pd,[]),pl(this,P3,null),pl(this,Zf,null),pl(this,Wbt,null),pl(this,qS,null),pl(this,N3,null),pl(this,kc,this.hot.rootDocument.createElement("DIV")),pl(this,Fm,this.hot.rootDocument.createElement("DIV")),pl(this,Wy,null),pl(this,L3,!1),pl(this,rO,0),pl(this,nO,null),pl(this,md,void 0),pl(this,oO,void 0),Qe(jt(kc,this),"manualColumnResizer"),Qe(jt(Fm,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[sO]}enablePlugin(){this.enabled||(Yo(md,this,new la),jt(md,this).addLocalHook("init",()=>bh(Kf,this,Ubt).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,jt(md,this)),this.addHook("modifyColWidth",(e,i)=>bh(Kf,this,Kbt).call(this,e,i),1),this.addHook("beforeStretchingColumnWidth",(e,i)=>bh(Kf,this,Zbt).call(this,e,i)),this.addHook("beforeColumnResize",(e,i,r)=>bh(Kf,this,Qbt).call(this,e,i,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Yo(oO,this,jt(md,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",tEe,jt(md,this).getValues())}loadManualColumnWidths(){let e={};return this.hot.runHooks("persistentStateLoad",tEe,e),e.value}setManualSize(e,i){let r=Math.max(i,20),n=this.hot.toPhysicalColumn(e);return jt(md,this).setValueAtIndex(n,r),r}clearManualSize(e){let i=this.hot.toPhysicalColumn(e);jt(md,this).setValueAtIndex(i,null)}setupHandlePosition(e){if(!e.parentNode)return;Yo(Hm,this,e);let{_wt:i}=this.hot.view,r=i.wtTable.getCoords(jt(Hm,this)),n=r.col;if(n<0)return;let o=ur(jt(Hm,this)),s=jt(Hm,this).getBoundingClientRect(),a=n<i.getSetting("fixedColumnsStart"),c;a&&(c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(jt(Hm,this),r.row,r.col)),c||(c=i.wtOverlays.topOverlay.getRelativeCellPosition(jt(Hm,this),r.row,r.col)),Yo(O3,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)),Yo(pd,this,[]);let d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){let u=this.hot.getSelectedRange();Ce(u,h=>{let p=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;_t(p,f,m=>{jt(pd,this).includes(m)||jt(pd,this).push(m)})})}jt(pd,this).includes(jt(O3,this))||Yo(pd,this,[jt(O3,this)]),Yo(N3,this,c.start-6),Yo(qS,this,parseInt(s.width,10)),jt(kc,this).style.top=`${c.top}px`,jt(kc,this).style[this.inlineDir]=`${jt(N3,this)+jt(qS,this)}px`,jt(kc,this).style.height=`${o}px`,this.hot.rootElement.appendChild(jt(kc,this))}refreshHandlePosition(){jt(kc,this).style[this.inlineDir]=`${jt(N3,this)+jt(P3,this)}px`}setupGuidePosition(){let e=parseInt(ur(jt(kc,this)),10),i=parseInt(jt(kc,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Qe(jt(kc,this),"active"),Qe(jt(Fm,this),"active"),jt(Fm,this).style.top=`${i}px`,this.refreshGuidePosition(),jt(Fm,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(jt(Fm,this))}refreshGuidePosition(){jt(Fm,this).style[this.inlineDir]=jt(kc,this).style[this.inlineDir]}hideHandleAndGuide(){Gt(jt(kc,this),"active"),Gt(jt(Fm,this),"active")}checkIfColumnHeader(e){let i=Ku(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,n.clone.wtTable.THEAD].includes(i)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){let e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},i=(r,n)=>{let o=this.hot.runHooks("beforeColumnResize",jt(Zf,this),r,!0);o!==void 0&&Yo(Zf,this,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,jt(Zf,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",jt(Zf,this),r,!0),n&&e()};jt(rO,this)>=2&&(jt(pd,this).length>1?(Ce(jt(pd,this),n=>{i(n)}),e()):Ce(jt(pd,this),n=>{i(n,!0)})),Yo(rO,this,0),Yo(nO,this,null)}bindEvents(){let{rootWindow:e,rootElement:i}=this.hot;this.eventManager.addEventListener(i,"mouseover",r=>bh(Kf,this,qbt).call(this,r)),this.eventManager.addEventListener(i,"mousedown",r=>bh(Kf,this,Ybt).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>bh(Kf,this,$bt).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>bh(Kf,this,Gbt).call(this)),this.eventManager.addEventListener(jt(kc,this),"contextmenu",()=>bh(Kf,this,Xbt).call(this))}destroy(){super.destroy()}};function Ubt(){let t=this.hot.getSettings()[sO],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((i,r)=>{jt(md,this).setValueAtIndex(r,i)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((i,r)=>{jt(md,this).setValueAtIndex(r,i)})},!0),Yo(oO,this,t)):t===!0&&Array.isArray(jt(oO,this))&&this.hot.batchExecution(()=>{jt(oO,this).forEach((i,r)=>{jt(md,this).setValueAtIndex(r,i)})},!0)}function qbt(t){if(!_5(t.target)&&jt(L3,this)!==!0&&this.checkIfColumnHeader(t.target)){let e=this.getClosestTHParent(t.target);if(!e)return;let i=e.getAttribute("colspan");e&&(i===null||i==="1")&&(jt(Wy,this)||this.setupHandlePosition(e))}}function Ybt(t){t.target.parentNode===this.hot.rootElement&&Bt(t.target,"manualColumnResizer")&&(this.setupHandlePosition(jt(Hm,this)),this.setupGuidePosition(),Yo(Wy,this,!0),jt(nO,this)===null&&(Yo(nO,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(jt(nO,this))),Yo(rO,this,jt(rO,this)+1),this.startX=t.pageX,Yo(Zf,this,jt(qS,this)))}function $bt(t){if(jt(Wy,this)){let e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Yo(P3,this,jt(qS,this)+e),Ce(jt(pd,this),i=>{Yo(Zf,this,this.setManualSize(i,jt(P3,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Gbt(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(i,r)=>{this.hot.runHooks("beforeColumnResize",jt(Zf,this),i,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",jt(Zf,this),i,!1)};jt(Wy,this)&&(this.hideHandleAndGuide(),Yo(Wy,this,!1),jt(Zf,this)!==jt(qS,this)&&(jt(pd,this).length>1?(Ce(jt(pd,this),r=>{e(r)}),t()):Ce(jt(pd,this),r=>{e(r,!0)})),this.setupHandlePosition(jt(Hm,this)))}function Xbt(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(jt(kc,this)),this.hot.rootElement.removeChild(jt(Fm,this)),Yo(Wy,this,!1),Yo(L3,this,!0),this.hot._registerImmediate(()=>{Yo(L3,this,!1)})}function Kbt(t,e){let i=t;if(this.enabled){let r=this.hot.toPhysicalColumn(e),n=jt(md,this).getValueAtIndex(r);this.hot.getSettings()[sO]&&n&&(i=n)}return i}function Zbt(t,e){let i=jt(md,this).getValueAtIndex(e);return i===null&&(i=t),i}function Qbt(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}var y6i=U($e(),1),w6i=U(dt(),1);var h6i=U($e(),1);function PX(t,e,i){return e=Jbt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Jbt(t){var e=e0t(t,"string");return typeof e=="symbol"?e:e+""}function e0t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LX=0,nEe=1,oEe=2,YS="px",FX=class{constructor(e){PX(this,"hot",void 0),PX(this,"_element",null),PX(this,"state",LX),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=oEe}build(){this.state===LX&&(this._element=this.hot.rootDocument.createElement("div"),this.state=nEe)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=LX}isAppended(){return this.state===oEe}isBuilt(){return this.state>=nEe}setPosition(e,i){e!==void 0&&(this._element.style.top=e+YS),i!==void 0&&(this._element.style.left=i+YS)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,i){e&&(this._element.style.width=e+YS),i&&(this._element.style.height=i+YS)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,i){e&&(this._element.style.marginTop=e+YS),i&&(this._element.style.marginLeft=i+YS)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},F3=FX;var t0t="ht__manualRowMove--backlight",HX=class extends F3{build(){super.build(),Qe(this._element,t0t)}},sEe=HX;var i0t="ht__manualRowMove--guideline",BX=class extends F3{build(){super.build(),Qe(this._element,i0t)}},aEe=BX;function r0t(t,e){cEe(t,e),e.add(t)}function $S(t,e,i){cEe(t,e),e.set(t,i)}function cEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qy(t,e,i){return t.set(Db(t,e),i),i}function Wi(t,e){return t.get(Db(t,e))}function Db(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("beforeRowMove");Ct.getSingleton().register("afterRowMove");var B3="manualRowMove",dEe=140,lEe="ht__manualRowMove",V3="show-ui",VX="on-moving--rows",jX="after-selection--rows",ql=new WeakMap,Mb=new WeakMap,Bm=new WeakMap,kb=new WeakMap,Oc=new WeakMap,H3=new WeakMap,Uy=new WeakSet,lO=class extends Zt{constructor(){super(...arguments),r0t(this,Uy),$S(this,ql,new sEe(this.hot)),$S(this,Mb,new aEe(this.hot)),$S(this,Bm,[]),$S(this,kb,void 0),$S(this,Oc,{}),$S(this,H3,void 0)}static get PLUGIN_KEY(){return B3}static get PLUGIN_PRIORITY(){return dEe}isEnabled(){return!!this.hot.getSettings()[B3]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Db(Uy,e,n0t).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Db(Uy,e,s0t).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Db(Uy,this,l0t).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Db(Uy,e,c0t).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Qe(this.hot.rootElement,lEe),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Gt(this.hot.rootElement,lEe),this.unregisterEvents(),Wi(ql,this).destroy(),Wi(Mb,this).destroy(),super.disablePlugin()}moveRow(e,i){return this.moveRows([e],i)}moveRows(e,i){let r=Wi(H3,this),n=this.isMovePossible(e,i),o=this.hot.runHooks("beforeRowMove",e,i,r,n);if(qy(H3,this,void 0),o===!1)return;n&&this.hot.rowIndexMapper.moveIndexes(e,i);let s=n&&this.isRowOrderChanged(e,i);return this.hot.runHooks("afterRowMove",e,i,r,n,s),s}dragRow(e,i){return this.dragRows([e],i)}dragRows(e,i){let r=this.countFinalIndex(e,i);return qy(H3,this,i),this.moveRows(e,r)}isMovePossible(e,i){let r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=e.length+i>r,o=i<0,s=e.some(c=>c<0),a=e.some(c=>c>=r);return!(n||o||s||a)}isRowOrderChanged(e,i){return e.some((r,n)=>r-n!==i)}countFinalIndex(e,i){let r=Gr(e,(n,o)=>(o<i&&(n+=1),n),0);return i-r}getRowsHeight(e,i){let r=this.hot.rowIndexMapper,n=0;for(let o=e;o<=i;o++){let s=r.getRenderableFromVisualIndex(o);s!==null&&(n+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return n}moveBySettingsOrLoad(){let e=this.hot.getSettings()[B3];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){let i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){let e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){let e=this.hot.getSelectedRangeLast(),i=[];if(!e)return i;let{from:r,to:n}=e,o=Math.min(r.row,n.row),s=Math.max(r.row,n.row);return _t(o,s,a=>{i.push(a)}),i}refreshPositions(){let e=Wi(Oc,this).coords,i=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),n=this.hot.countRows();this.isFixedRowTop(e.row)&&i>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1)),this.isFixedRowBottom(e.row)&&r<n&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);let o=this.hot.view._wt.wtTable,s=Wi(Oc,this).TD,a=this.hot.rootElement,c=Nn(a),d=Qu(a),u=o.holder.scrollTop,h=this.hot.rootWindow!==d?d.scrollTop:0,p=c.top-h,f=Wi(Oc,this).eventPageY-p+u,m=o.hider.offsetHeight,g=o.TBODY.offsetTop,y=Wi(ql,this).getOffset().top,w=Wi(ql,this).getSize().height,x=s.offsetHeight/2,T=s.offsetHeight,M=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1),B=f>=M+x;this.isFixedRowTop(e.row)&&(M+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Wi(Oc,this).row=i>0?i-1:i:B?(Wi(Oc,this).row=e.row+1,M+=e.row===0?T-1:T):Wi(Oc,this).row=e.row;let G=f,F=M;f+w+y>=m?G=m-w-y:f+y<g&&(G=g+Math.abs(y)),M>=m-1&&(F=m-1),Wi(ql,this).setPosition(G),Wi(Mb,this).setPosition(F)}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",i=>Db(Uy,this,o0t).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Db(Uy,this,a0t).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Wi(ql,this).build(),Wi(Mb,this).build()}destroy(){Wi(ql,this).destroy(),Wi(Mb,this).destroy(),super.destroy()}};function n0t(t,e,i,r){let{wtTable:n,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Wi(kb,this)||t.button!==0){qy(kb,this,!1),Wi(Bm,this).length=0,Gt(this.hot.rootElement,[VX,V3]);return}let c=Wi(Mb,this).isBuilt()&&!Wi(Mb,this).isAppended(),d=Wi(ql,this).isBuilt()&&!Wi(ql,this).isAppended();c&&d&&(Wi(Mb,this).appendTo(n.hider),Wi(ql,this).appendTo(n.hider));let{from:u,to:h}=a,p=Math.min(u.row,h.row),f=Math.max(u.row,h.row);if(e.col<0&&e.row>=p&&e.row<=f){r.row=!0,qy(kb,this,!0),Wi(Oc,this).eventPageY=t.pageY,Wi(Oc,this).coords=e,Wi(Oc,this).TD=i,qy(Bm,this,this.prepareRowsToMoving());let m=n.holder.scrollLeft+o.getRowHeaderWidth(),g=this.getRowsHeight(p,e.row-1)+t.offsetY;Wi(ql,this).setPosition(null,m),Wi(ql,this).setSize(n.hider.offsetWidth-m,this.getRowsHeight(p,f)),Wi(ql,this).setOffset(-g,null),Qe(this.hot.rootElement,VX),this.refreshPositions()}else Gt(this.hot.rootElement,jX),qy(kb,this,!1),Wi(Bm,this).length=0}function o0t(t){Wi(kb,this)&&(Wi(Oc,this).eventPageY=t.pageY,this.refreshPositions())}function s0t(t,e,i,r){!this.hot.getSelectedRangeLast()||!Wi(kb,this)||(Wi(Bm,this).indexOf(e.row)>-1?Gt(this.hot.rootElement,V3):Qe(this.hot.rootElement,V3),r.row=!0,r.column=!0,r.cell=!0,Wi(Oc,this).coords=e,Wi(Oc,this).TD=i)}function a0t(){let t=Wi(Oc,this).row,e=Wi(Bm,this).length;if(qy(kb,this,!1),Gt(this.hot.rootElement,[VX,V3,jX]),this.hot.selection.isSelectedByRowHeader()&&Qe(this.hot.rootElement,jX),e<1||t===void 0)return;let i=Wi(Bm,this)[0],r=this.hot.toPhysicalRow(i),n=this.dragRows(Wi(Bm,this),t);if(Wi(Bm,this).length=0,n===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();let o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function l0t(){let t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),i=t.holder.scrollLeft,r=e+i;Wi(ql,this).setPosition(null,r),Wi(ql,this).setSize(t.hider.offsetWidth-r)}function c0t(){this.moveBySettingsOrLoad()}var k6i=U($e(),1),O6i=U(dt(),1);function d0t(t,e){hEe(t,e),e.add(t)}function ml(t,e,i){hEe(t,e),e.set(t,i)}function hEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Do(t,e,i){return t.set(Vm(t,e),i),i}function Vt(t,e){return t.get(Vm(t,e))}function Vm(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var fO="manualRowResize",fEe=30,uEe="manualRowHeights",Jf=new WeakMap,j3=new WeakMap,gd=new WeakMap,cO=new WeakMap,Nb=new WeakMap,zX=new WeakMap,GS=new WeakMap,z3=new WeakMap,Yl=new WeakMap,Qf=new WeakMap,Yy=new WeakMap,W3=new WeakMap,dO=new WeakMap,uO=new WeakMap,_h=new WeakMap,hO=new WeakMap,Ob=new WeakSet,pO=class extends Zt{static get PLUGIN_KEY(){return fO}static get PLUGIN_PRIORITY(){return fEe}constructor(e){super(e),d0t(this,Ob),ml(this,Jf,null),ml(this,j3,null),ml(this,gd,[]),ml(this,cO,null),ml(this,Nb,null),ml(this,zX,null),ml(this,GS,null),ml(this,z3,null),ml(this,Yl,this.hot.rootDocument.createElement("DIV")),ml(this,Qf,this.hot.rootDocument.createElement("DIV")),ml(this,Yy,!1),ml(this,W3,!1),ml(this,dO,0),ml(this,uO,null),ml(this,_h,void 0),ml(this,hO,void 0),Qe(Vt(Yl,this),"manualRowResizer"),Qe(Vt(Qf,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[fO]}enablePlugin(){this.enabled||(Do(_h,this,new la),Vt(_h,this).addLocalHook("init",()=>Vm(Ob,this,v0t).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Vt(_h,this)),this.addHook("modifyRowHeight",(e,i)=>Vm(Ob,this,g0t).call(this,e,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Do(hO,this,Vt(_h,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",uEe,Vt(_h,this).getValues())}loadManualRowHeights(){let e={};return this.hot.runHooks("persistentStateLoad",uEe,e),e.value}setManualSize(e,i){let r=this.hot.toPhysicalRow(e),n=Math.max(i,$v.DEFAULT_HEIGHT);return Vt(_h,this).setValueAtIndex(r,n),n}getLastDesiredRowHeight(){return Vt(cO,this)}setupHandlePosition(e){Do(Jf,this,e);let{view:i}=this.hot,{_wt:r}=i,n=r.wtTable.getCoords(Vt(Jf,this)),o=n.row;if(o<0)return;let s=Ji(Vt(Jf,this)),a=Vt(Jf,this).getBoundingClientRect(),c=o<r.getSetting("fixedRowsTop"),d=o>=i.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom"),u;c?u=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Vt(Jf,this),n.row,n.col):d&&(u=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Vt(Jf,this),n.row,n.col)),u||(u=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Vt(Jf,this),n.row,n.col)),Do(j3,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Do(gd,this,[]);let h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){let p=this.hot.getSelectedRange();Ce(p,f=>{let m=f.getTopStartCorner().row,g=f.getBottomStartCorner().row;_t(m,g,y=>{Vt(gd,this).includes(y)||Vt(gd,this).push(y)})})}Vt(gd,this).includes(Vt(j3,this))||Do(gd,this,[Vt(j3,this)]),Do(z3,this,u.top-6),Do(GS,this,parseInt(a.height,10)),Vt(Yl,this).style.top=`${Vt(z3,this)+Vt(GS,this)}px`,Vt(Yl,this).style[this.inlineDir]=`${u.start}px`,Vt(Yl,this).style.width=`${s}px`,this.hot.rootElement.appendChild(Vt(Yl,this))}refreshHandlePosition(){Vt(Yl,this).style.top=`${Vt(z3,this)+Vt(cO,this)}px`}setupGuidePosition(){let e=parseInt(Ji(Vt(Yl,this)),10),i=parseInt(Vt(Yl,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Qe(Vt(Yl,this),"active"),Qe(Vt(Qf,this),"active"),Vt(Qf,this).style.top=Vt(Yl,this).style.top,Vt(Qf,this).style[this.inlineDir]=`${i}px`,Vt(Qf,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(Vt(Qf,this))}refreshGuidePosition(){Vt(Qf,this).style.top=Vt(Yl,this).style.top}hideHandleAndGuide(){Gt(Vt(Yl,this),"active"),Gt(Vt(Qf,this),"active")}checkIfRowHeader(e){let i=Ku(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,n.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(i)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){let i=this.hot.view._wt.wtTable.getRowHeight(e);return i!==void 0&&Vt(Nb,this)<i?i:Vt(Nb,this)}afterMouseDownTimeout(){let e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},i=(r,n)=>{let o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Do(Nb,this,o),this.setManualSize(r,Vt(Nb,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),n&&e()};Vt(dO,this)>=2&&(Vt(gd,this).length>1?(Ce(Vt(gd,this),n=>{i(n)}),e()):Ce(Vt(gd,this),n=>{i(n,!0)})),Do(dO,this,0),Do(uO,this,null)}bindEvents(){let{rootElement:e,rootWindow:i}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Vm(Ob,this,u0t).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Vm(Ob,this,h0t).call(this,r)),this.eventManager.addEventListener(i,"mousemove",r=>Vm(Ob,this,f0t).call(this,r)),this.eventManager.addEventListener(i,"mouseup",()=>Vm(Ob,this,p0t).call(this)),this.eventManager.addEventListener(Vt(Yl,this),"contextmenu",()=>Vm(Ob,this,m0t).call(this))}destroy(){super.destroy()}};function u0t(t){if(!_5(t.target)&&Vt(W3,this)!==!0&&this.checkIfRowHeader(t.target)){let e=this.getClosestTHParent(t.target);e&&(Vt(Yy,this)||this.setupHandlePosition(e))}}function h0t(t){Bt(t.target,"manualRowResizer")&&(this.setupHandlePosition(Vt(Jf,this)),this.setupGuidePosition(),Do(Yy,this,!0),Vt(uO,this)===null&&(Do(uO,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Vt(uO,this))),Do(dO,this,Vt(dO,this)+1),Do(zX,this,t.pageY),Do(Nb,this,Vt(GS,this)))}function f0t(t){Vt(Yy,this)&&(Do(cO,this,Vt(GS,this)+(t.pageY-Vt(zX,this))),Ce(Vt(gd,this),e=>{Do(Nb,this,this.setManualSize(e,Vt(cO,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function p0t(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(i,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!1)};Vt(Yy,this)&&(this.hideHandleAndGuide(),Do(Yy,this,!1),Vt(Nb,this)!==Vt(GS,this)&&(Vt(gd,this).length>1?(Ce(Vt(gd,this),r=>{e(r)}),t()):Ce(Vt(gd,this),r=>{e(r,!0)})),this.setupHandlePosition(Vt(Jf,this)))}function m0t(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Vt(Yl,this)),this.hot.rootElement.removeChild(Vt(Qf,this)),Do(Yy,this,!1),Do(W3,this,!0),this.hot._registerImmediate(()=>{Do(W3,this,!1)})}function g0t(t,e){let i=t;if(this.enabled){let r=this.hot.toPhysicalRow(e),n=Vt(_h,this).getValueAtIndex(r);this.hot.getSettings()[fO]&&n&&(i=n)}return i}function v0t(){let t=this.hot.getSettings()[fO],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((i,r)=>{Vt(_h,this).setValueAtIndex(r,i)}):Array.isArray(t)?(t.forEach((i,r)=>{Vt(_h,this).setValueAtIndex(r,i)}),Do(hO,this,t)):t===!0&&Array.isArray(Vt(hO,this))&&Vt(hO,this).forEach((i,r)=>{Vt(_h,this).setValueAtIndex(r,i)})},!0)}var E8i=U($e(),1),T8i=U(dt(),1),R8i=U(ln(),1),A8i=U(cn(),1),I8i=U(dn(),1),D8i=U(un(),1),M8i=U(hn(),1),k8i=U(fn(),1),O8i=U(pn(),1);var $6i=U($e(),1),G6i=U(dt(),1),X6i=U(M7(),1),K6i=U(ln(),1),Z6i=U(cn(),1),Q6i=U(dn(),1),J6i=U(un(),1),e8i=U(hn(),1),t8i=U(fn(),1),i8i=U(pn(),1);var W6i=U($e(),1);function $y(t,e,i){return e=b0t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function b0t(t){var e=_0t(t,"string");return typeof e=="symbol"?e:e+""}function _0t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var WX=class{constructor(e,i,r,n,o,s){$y(this,"row",void 0),$y(this,"col",void 0),$y(this,"rowspan",void 0),$y(this,"colspan",void 0),$y(this,"removed",!1),$y(this,"cellCoordsFactory",void 0),$y(this,"cellRangeFactory",void 0),this.row=e,this.col=i,this.rowspan=r,this.colspan=n,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return Ai`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return Ai`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return Ai`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return Ai`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,i,r){return e.row<0||e.col<0||e.row>=i||e.row+e.rowspan-1>=i||e.col>=r||e.col+e.colspan-1>=r}normalize(e){let i=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>i-1&&(this.row=i-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>i-1&&(this.rowspan=i-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,i){return this.row<=e&&this.col<=i&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=i}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,i){let r=e[0]||e[1],n=i+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(i,n),c=Math.max(i,n),d=this[s],u=this[s]+this[o]-1;if(d>=i&&(this[s]+=r),r>0)i<=u&&i>d&&(this[o]+=r);else if(r<0){if(a<=d&&c>=u)return this.removed=!0,!1;if(d>=a&&d<=c){let h=c-d+1,p=Math.abs(r)-h;this[s]-=p+r,this[o]-=h}else if(d<=a&&u>=c)this[o]+=r;else if(d<=a&&u>=a&&u<c){let h=u-a+1;this[o]-=h}}return!0}isFarther(e,i){return e?i==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:i==="up"?e.row>this.row:i==="right"?e.col+e.colspan-1<this.col+this.colspan-1:i==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}},vd=WX;function mO(t,e,i,r){e?e.row===i&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function y0t(t,e){w0t(t,e),e.add(t)}function w0t(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UX(t,e,i){return e=C0t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function C0t(t){var e=x0t(t,"string");return typeof e=="symbol"?e:e+""}function x0t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U3(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var gO=new WeakSet,qX=class t{constructor(e){y0t(this,gO),UX(this,"plugin",void 0),UX(this,"mergedCells",[]),UX(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return Ai`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,i){let r=this.mergedCells,n=!1;return Ce(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=i&&o.col+o.colspan-1>=i?(n=o,!1):!0),n}getByRange(e){let i=this.mergedCells,r=!1;return Ce(i,n=>n.row<=e.from.row&&n.row+n.rowspan-1>=e.to.row&&n.col<=e.from.col&&n.col+n.colspan-1>=e.to.col?(r=n,r):!0),r}getWithinRange(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=this.mergedCells,n=[],o=e;if(!o.includesRange){let s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return Ce(r,s=>{let a=this.hot._createCellCoords(s.row,s.col),c=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),d=this.hot._createCellRange(a,a,c);i?o.overlaps(d)&&n.push(s):o.includesRange(d)&&n.push(s)}),n.length?n:!1}add(e){let i=this.mergedCells,r=e.row,n=e.col,o=e.rowspan,s=e.colspan,a=new vd(r,n,o,s,this.hot._createCellCoords,this.hot._createCellRange),c=this.get(r,n),d=this.isOverlapping(a);return!c&&!d?(this.hot&&a.normalize(this.hot),i.push(a),a):(Zi(t.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,i){let r=this.mergedCells,n=this.get(e,i),o=n?this.mergedCells.indexOf(n):-1;return n&&o!==-1?(r.splice(o,1),n):!1}clear(){let e=this.mergedCells,i=[],r=[];Ce(e,n=>{let o=this.hot.getCell(n.row,n.col);o&&i.push([o,this.get(n.row,n.col),n.row,n.col])}),this.mergedCells.length=0,Ce(i,(n,o)=>{_t(0,n.rowspan-1,s=>{_t(0,n.colspan-1,a=>{if(a!==0||s!==0){let c=this.hot.getCell(n.row+s,n.col+a);c&&r.push([c,null,null,null])}})}),i[o][1]=null}),Ce(i,n=>{mO(...n)}),Ce(r,n=>{mO(...n)})}isOverlapping(e){let i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)),r=!1;return Ce(this.mergedCells,n=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(n.row,n.col),this.hot._createCellCoords(n.row+n.rowspan-1,n.col+n.colspan-1)).overlaps(i)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,i){let r=this.get(e,i);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===i}getFirstRenderableCoords(e,i){let r=this.get(e,i);if(!r||this.isFirstRenderableMergedCell(e,i))return this.hot._createCellCoords(e,i);let n=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(n,o)}getStartMostColumnIndex(e,i){let r=U3(gO,this,q3).call(this,e,"col",-1),n=i;for(let o=0;o<r.length;o++)if(r[o]<=i){n=r[o];break}return n}getEndMostColumnIndex(e,i){let r=U3(gO,this,q3).call(this,e,"col",1),n=i;for(let o=0;o<r.length;o++)if(r[o]>=i){n=r[o];break}return n}getTopMostRowIndex(e,i){let r=U3(gO,this,q3).call(this,e,"row",-1),n=i;for(let o=0;o<r.length;o++)if(r[o]<=i){n=r[o];break}return n}getBottomMostRowIndex(e,i){let r=U3(gO,this,q3).call(this,e,"row",1),n=i;for(let o=0;o<r.length;o++)if(r[o]>=i){n=r[o];break}return n}shiftCollections(e,i,r){let n=[0,0];switch(e){case"right":n[0]+=r;break;case"left":n[0]-=r;break;case"down":n[1]+=r;break;case"up":n[1]-=r;break;default:}Ce(this.mergedCells,o=>{o.shift(n,i)}),xI(this.mergedCells.length-1,0,o=>{let s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}};function q3(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=new Map,n=i===1?t.getTopStartCorner():t.getBottomEndCorner(),o=i===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=n.row;i===1?s<=o.row:s>=o.row;s+=i)for(let a=n.col;i===1?a<=o.col:a>=o.col;a+=i){let c=e==="row"?s:a,d=this.get(s,a),u=c;d&&(u=i===1?d[e]+d[`${e}span`]-1:d[e]),r.has(c)||r.set(c,new Set),r.get(c).add(u)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}var pEe=qX;var d8i=U($e(),1);function YX(t,e,i){return e=S0t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function S0t(t){var e=E0t(t,"string");return typeof e=="symbol"?e:e+""}function E0t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $X=class{constructor(e){YX(this,"plugin",void 0),YX(this,"mergedCellsCollection",void 0),YX(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){let i=this.mergedCellsCollection.get(e[0],e[1]);i&&(e[2]=e[0]+i.rowspan-1,e[3]=e[1]+i.colspan-1)}}getDirection(e,i){let r=null;return i[0]===e[0]&&i[1]===e[1]&&i[3]===e[3]?r="down":i[2]===e[2]&&i[1]===e[1]&&i[3]===e[3]?r="up":i[1]===e[1]&&i[2]===e[2]?r="right":r="left",r}snapDragArea(e,i,r,n){let o=i.slice(0),s=this.getAutofillSize(e,i,r),[a,c,d,u]=e,p=["up","down"].indexOf(r)>-1?d-a+1:u-c+1,f=Math.floor(s/p)*p,m=s-f,g=this.getFarthestCollection(e,i,r,n);if(g){if(r==="down"){let y=g.row+g.rowspan-a-m;o[2]+y>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?y:0}else if(r==="right"){let y=g.col+g.colspan-c-m;o[3]+y>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?y:0}else if(r==="up"){let y=d-m-g.row+1;o[0]+y<0?o[0]+=m:o[0]-=m?y:0}else if(r==="left"){let y=u-m-g.col+1;o[1]+y<0?o[1]+=m:o[1]-=m?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:n,fillSize:s,dragArea:o,cycleLength:p}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Sr(this.currentFillData,e)}getAutofillSize(e,i,r){let[n,o,s,a]=e,[c,d,u,h]=i;switch(r){case"up":return n-c;case"down":return u-s;case"left":return o-d;case"right":return h-a;default:return null}}getDragArea(e,i,r){let[n,o,s,a]=e,[c,d,u,h]=i;switch(r){case"up":return[c,d,n-1,a];case"down":return[s+1,o,u,a];case"left":return[c,d,s,o-1];case"right":return[n,a+1,u,h];default:return null}}getFarthestCollection(e,i,r,n){let[o,s,a,c]=e,d=["up","down"].indexOf(r)>-1,u=d?a:c,h=d?o:s,p=this.getAutofillSize(e,i,r),f=d?a-o+1:c-s+1,m=Math.floor(p/f)*f,g=p-m,y=null,w=null,x=null;switch(r){case"up":y="includesVertically",x=u-g+1;break;case"left":y="includesHorizontally",x=u-g+1;break;case"down":y="includesVertically",x=h+g-1;break;case"right":y="includesHorizontally",x=h+g-1;break;default:}return Ce(n,T=>{T[y](x)&&T.isFarther(w,r)&&(w=T)}),w}recreateAfterDataPopulation(e){if(!this.currentFillData)return;let i=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,o=(d,u)=>{switch(n){case"up":return d.row-u>=i.from.row;case"down":return d.row+d.rowspan-1+u<=i.to.row;case"left":return d.col-u>=i.from.column;case"right":return d.col+d.colspan-1+u<=i.to.column;default:return null}},s=0,a=null,c=1;do for(let d=0;d<r.length;d+=1){if(a=r[d],s=c*this.currentFillData.cycleLength,o(a,s))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break;default:}d===r.length-1&&(c+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){let i={min:null,max:null},r={min:null,max:null};return Ce(e,n=>{let o=n[0],s=this.plugin.hot.propToCol(n[1]);(i.min===null||o<i.min)&&(i.min=o),(i.max===null||o>i.max)&&(i.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:i.min,column:r.min},to:{row:i.max,column:r.max}}}dragAreaOverlapsCollections(e,i,r){let n=this.getDragArea(e,i,r),[o,s,a,c]=n,d=this.plugin.hot._createCellCoords(o,s),u=this.plugin.hot._createCellCoords(a,c),h=this.plugin.hot._createCellRange(d,d,u);return!!this.mergedCellsCollection.getWithinRange(h,!0)}},mEe=$X;var p8i=U($e(),1),m8i=U(dt(),1);function GX(t,e,i){return e=T0t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function T0t(t){var e=R0t(t,"string");return typeof e=="symbol"?e:e+""}function R0t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var XX=class{constructor(e){GX(this,"plugin",void 0),GX(this,"hot",void 0),GX(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,i,r,n){let o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]);if(n===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,i))return;let u=this.plugin.mergedCellsCollection.get(e,i);if(!u)return;let h=u.getLastRow(),p=u.getLastColumn();if(o<=u.row&&s<=u.col&&a>=h&&c>=p)return`${this.fullySelectedMergedCellClassName}-${n}`;if(this.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,i){let r=[];if(!i||!e)return!1;for(let n=0;n<e.rowspan;n+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+n,e.col+o));for(let n=0;n<r.length;n+=1){let o=[];for(let s=0;s<i.length;s+=1)o[s]=i[s].includes(r[n]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){let e=[];for(let i=0;i<=7;i+=1)e.push(`${this.fullySelectedMergedCellClassName}-${i}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}},gEe=XX;function KX(t){return{key:"mergeCells",name(){let e=this.getSelectedLast();if(e){let i=t.mergedCellsCollection.get(e[0],e[1]);if(i.row===e[0]&&i.col===e[1]&&i.row+i.rowspan-1===e[2]&&i.col+i.colspan-1===e[3])return this.getTranslatedPhrase(xD)}return this.getTranslatedPhrase(CD)},callback(){let e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");let{from:i,to:r}=e;t.toggleMerge(e),this.selectCell(i.row,i.col,r.row,r.col,!1)},disabled(){let e=this.getSelectedLast();return e?vd.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}var w8i=U($e(),1),C8i=U(dt(),1);var _8i=U($e(),1);function vO(t,e,i){return e=A0t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function A0t(t){var e=I0t(t,"string");return typeof e=="symbol"?e:e+""}function I0t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Y3=class{constructor(e){vO(this,"data",void 0),vO(this,"next",null),vO(this,"prev",null),this.data=e}},ZX=class{constructor(){vO(this,"first",null),vO(this,"last",null)}push(e){let i=new Y3(e);if(this.first===null)this.first=i,this.last=i;else{let r=this.last;this.last=i,i.prev=r,r.next=i}return i}unshift(e){let i=new Y3(e);if(this.first===null)this.first=i,this.last=i;else{let r=this.first;this.first=i,i.next=r,r.prev=i}}inorder(e){let i=this.first;for(;i;){let r=e(i);if(i===this.last||r===!0)break;i=i.next}}remove(e){if(this.first===null)return!1;let i=this.first,r,n;for(;i;){if(i.data===e)return r=i.next,n=i.prev,r&&(r.prev=n),n&&(n.next=r),i===this.first&&(this.first=r),i===this.last&&(this.last=n),!0;i=i.next}return!1}hasCycle(){let e=this.first,i=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,i=i.next,e===i)return!0}}pop(){if(this.last===null)return null;let e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;let e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,n){n&&(e(n,n.next),n.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;let i=this.first;this.first=this.last,this.last=i}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,i=this.first,r;for(;e;)r=e.next,e.next=i,i.prev=e,i=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=i,this.last=r}};var bO=ZX;function D0t(t,e){bEe(t,e),e.add(t)}function Gy(t,e,i){bEe(t,e),e.set(t,i)}function bEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xr(t,e){return t.get(X3(t,e))}function bd(t,e,i){return t.set(X3(t,e),i),i}function X3(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var ep=new WeakMap,tp=new WeakMap,ip=new WeakMap,rp=new WeakMap,JX=new WeakMap,$3=new WeakMap,G3=new WeakMap,QX=new WeakSet,K3=class{constructor(e){let{mergedCellsGetter:i,rowIndexMapper:r,columnIndexMapper:n}=e;D0t(this,QX),Gy(this,ep,new bO),Gy(this,tp,new bO),Gy(this,ip,null),Gy(this,rp,null),Gy(this,JX,null),Gy(this,$3,null),Gy(this,G3,null),bd(JX,this,i),bd($3,this,r),bd(G3,this,n)}getCurrentVerticalNode(){return Xr(rp,this).data}getFirstVerticalNode(){return Xr(tp,this).first.data}getNextVerticalNode(){return Xr(rp,this).next.data}getPrevVerticalNode(){return Xr(rp,this).prev.data}getCurrentHorizontalNode(){return Xr(ip,this).data}getFirstHorizontalNode(){return Xr(ep,this).first.data}getNextHorizontalNode(){return Xr(ip,this).next.data}getPrevHorizontalNode(){return Xr(ip,this).prev.data}setPrevNodeAsActive(){bd(rp,this,Xr(rp,this).prev),bd(ip,this,Xr(ip,this).prev)}setNextNodeAsActive(){bd(rp,this,Xr(rp,this).next),bd(ip,this,Xr(ip,this).next)}buildFocusOrder(e){let i=e.getTopStartCorner(),r=e.getBottomEndCorner(),n=new WeakSet;bd(ep,this,new bO);for(let s=i.row;s<=r.row;s++)if(!Xr($3,this).isHidden(s))for(let a=i.col;a<=r.col;a++){if(Xr(G3,this).isHidden(a))continue;let c=X3(QX,this,vEe).call(this,e,Xr(ep,this),n,s,a);c&&bd(ip,this,c)}Xr(ep,this).first&&(Xr(ep,this).first.prev=Xr(ep,this).last,Xr(ep,this).last.next=Xr(ep,this).first);let o=new WeakSet;bd(tp,this,new bO);for(let s=i.col;s<=r.col;s++)if(!Xr(G3,this).isHidden(s))for(let a=i.row;a<=r.row;a++){if(Xr($3,this).isHidden(a))continue;let c=X3(QX,this,vEe).call(this,e,Xr(tp,this),o,a,s);c&&bd(rp,this,c)}Xr(tp,this).first&&(Xr(tp,this).first.prev=Xr(tp,this).last,Xr(tp,this).last.next=Xr(tp,this).first)}setActiveNode(e,i){return Xr(ep,this).inorder(r=>{let{rowStart:n,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=n&&e<=o&&i>=s&&i<=a)return bd(ip,this,r),!1}),Xr(tp,this).inorder(r=>{let{rowStart:n,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=n&&e<=o&&i>=s&&i<=a)return bd(rp,this,r),!1}),this}};function vEe(t,e,i,r,n){let o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),c=Xr(JX,this).call(this,r,n);if(c&&i.has(c))return null;let d={colStart:n,colEnd:n,rowStart:r,rowEnd:r};if(c){if(i.add(c),c.row<o.row||c.row+c.rowspan-1>s.row||c.col<o.col||c.col+c.colspan-1>s.col)return null;d.colStart=c.col,d.colEnd=c.col+c.colspan-1,d.rowStart=c.row,d.rowEnd=c.row+c.rowspan-1}let u=e.push(d);return r===a.row&&n===a.col||c&&a.row>=c.row&&a.row<=c.row+c.rowspan-1&&a.col>=c.col&&a.col<=c.col+c.colspan-1?u:null}function M0t(t,e){wEe(t,e),e.add(t)}function eK(t,e,i){wEe(t,e),e.set(t,i)}function wEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tK(t,e,i){return e=k0t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function k0t(t){var e=O0t(t,"string");return typeof e=="symbol"?e:e+""}function O0t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _O(t,e,i){return t.set(wn(t,e),i),i}function Gn(t,e){return t.get(wn(t,e))}function wn(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Ct.getSingleton().register("beforeMergeCells");Ct.getSingleton().register("afterMergeCells");Ct.getSingleton().register("beforeUnmergeCells");Ct.getSingleton().register("afterUnmergeCells");var XS="mergeCells",CEe=150,_Ee=XS,bu=new WeakMap,_u=new WeakMap,np=new WeakMap,In=new WeakSet,yO=class extends Zt{constructor(){super(...arguments),M0t(this,In),tK(this,"mergedCellsCollection",null),tK(this,"autofillCalculations",null),tK(this,"selectionCalculations",null),eK(this,bu,null),eK(this,_u,{row:0,col:0}),eK(this,np,new K3({mergedCellsGetter:(e,i)=>this.mergedCellsCollection.get(e,i),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper}))}static get PLUGIN_KEY(){return XS}static get PLUGIN_PRIORITY(){return CEe}isEnabled(){return!!this.hot.getSettings()[XS]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new pEe(this),this.autofillCalculations=new mEe(this),this.selectionCalculations=new gEe(this),this.addHook("afterInit",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,N0t).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,L0t).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,F0t).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,H0t).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,B0t).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,yEe).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,yEe).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,W0t).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,U0t).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,q0t).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,V0t).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,P0t).call(e,...r)}),this.addHook("afterRenderer",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,z0t).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,j0t).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,Y0t).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,$0t).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,G0t).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,X0t).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,K0t).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,Z0t).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,Q0t).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,J0t).call(e,...r)}),this.addHook("afterChange",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,e_t).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,t_t).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,i_t).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,r_t).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return wn(In,e,n_t).call(e,...r)}),this.addHook("beforeUndoStackChange",(i,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){let e=this.hot.getSettings()[XS];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!E5())return;let e=[],i=[];this.mergedCellsCollection.mergedCells.forEach(r=>{let{row:n,rowspan:o}=r;for(let s=n+1;s<n+o;s++)i.push(s)}),i=[...new Set(i)],i.forEach(r=>{let n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{let s=o.getRow(n);s&&(s.style.background=Fv(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Fv(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let i=!0;return e?(vd.containsNegativeValues(e)?(Zi(vd.NEGATIVE_VALUES_WARNING(e)),i=!1):vd.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Zi(vd.IS_OUT_OF_BOUNDS_WARNING(e)),i=!1):vd.isSingleCell(e)?(Zi(vd.IS_SINGLE_CELL(e)),i=!1):vd.containsZeroSpan(e)&&(Zi(vd.ZERO_SPAN_WARNING(e)),i=!1),i):!1}generateFromSettings(e){if(Array.isArray(e)){let i=[];if(Ce(e,r=>{if(!this.validateSetting(r))return;let n=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(n,n,o);this.mergeRange(s,!0,!0),_t(r.row,r.row+r.rowspan-1,a=>{_t(r.col,r.col+r.colspan-1,c=>{a===r.row&&c===r.col||i.push([a,c,null])})})}),i.length===0)return;this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:i,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(i.row,i.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;let{from:i,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(i.row,i.col,r.row,r.col,!1)}mergeRange(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:n.row,col:n.col,rowspan:o.row-n.row+1,colspan:o.col-n.col+1},a=[],c=null;return this.canMergeRange(s,i)?(this.hot.runHooks("beforeMergeCells",e,i),_t(0,s.rowspan-1,u=>{_t(0,s.colspan-1,h=>{let p=null;a[u]||(a[u]=[]),u===0&&h===0?p=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+u,s.col+h,"hidden",!0),a[u][h]=p})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?c=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),i||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,i),c):!0):!1}unmergeRange(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,i),Ce(r,n=>{this.mergedCellsCollection.remove(n.row,n.col),_t(0,n.rowspan-1,o=>{_t(0,n.colspan-1,s=>{this.hot.removeCellMeta(n.row+o,n.col+s,"hidden"),this.hot.removeCellMeta(n.row+o,n.col+s,"copyable")})}),this.hot.removeCellMeta(n.row,n.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,i),this.hot.render())}toggleMerge(e){let i=this.mergedCellsCollection.get(e.from.row,e.from.col);i.row===e.from.row&&i.col===e.from.col&&i.row+i.rowspan-1===e.to.row&&i.col+i.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,i,r,n){let o=this.hot._createCellCoords(e,i),s=this.hot._createCellCoords(r,n);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,i,r,n){let o=this.hot._createCellCoords(e,i),s=this.hot._createCellCoords(r,n);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{let r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:_Ee})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_Ee)}modifyViewportRowStart(e,i){let r=this.hot.rowIndexMapper,n=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<i;o+=1){let s=this.mergedCellsCollection.get(n,o);if(Xt(s)){let a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,i);return}}}}modifyViewportRowEnd(e,i){let r=this.hot.rowIndexMapper,n=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<i;o+=1){let s=this.mergedCellsCollection.get(n,o);if(Xt(s)){let a=s.row+s.rowspan-1,c=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(c>e.endRow){e.endRow=c,this.modifyViewportRowEnd(e,i);return}}}}modifyViewportColumnStart(e,i){let r=this.hot.columnIndexMapper,n=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<i;o+=1){let s=this.mergedCellsCollection.get(o,n);if(Xt(s)){let a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,i);return}}}}modifyViewportColumnEnd(e,i){let r=this.hot.columnIndexMapper,n=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<i;o+=1){let s=this.mergedCellsCollection.get(o,n);if(Xt(s)){let a=s.col+s.colspan-1,c=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(c>e.endColumn){e.endColumn=c,this.modifyViewportColumnEnd(e,i);return}}}}translateMergedCellToRenderable(e,i,r,n){let{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a,c;i===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+i-1,-1),n===0?c=s.getNearestNotHiddenIndex(r,1):c=s.getNearestNotHiddenIndex(r+n-1,-1);let d=e>=0?o.getRenderableFromVisualIndex(a):e,u=r>=0?s.getRenderableFromVisualIndex(c):r;return[d,u]}};function N0t(){this.generateFromSettings(this.hot.getSettings()[XS]),this.hot.render()}function P0t(t){if(t){let e=this.mergedCellsCollection.mergedCells,i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),n=i.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&n.row===e[o].row+e[o].rowspan-1&&n.col===e[o].col+e[o].colspan-1)return!1}return t}function L0t(t){Gn(_u,this).row=t.row,Gn(_u,this).col=t.col}function F0t(t){let e=this.hot.getSelectedRangeLast(),{highlight:i}=e,{columnIndexMapper:r,rowIndexMapper:n}=this.hot;Gn(bu,this)&&(n.getRenderableFromVisualIndex(Gn(bu,this).row)!==null&&(i.row=Gn(bu,this).row),r.getRenderableFromVisualIndex(Gn(bu,this).col)!==null&&(i.col=Gn(bu,this).col),_O(bu,this,null));let o=this.mergedCellsCollection.get(i.row,i.col);if(!o)return;let s=o.col,a=o.col+o.colspan-1;if(t.col<0){let u=i.col>=s&&i.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(u,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,i.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,i.col)-1,1)}else if(t.col>0){let u=i.col>=s&&i.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(u,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(i.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,h)-1,1)}let c=o.row,d=o.row+o.rowspan-1;if(t.row<0){let u=i.row>=c&&i.row<=d?c-1:d,h=n.getNearestNotHiddenIndex(u,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,i.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,i.row)-1,1)}else if(t.row>0){let u=i.row>=c&&i.row<=d?d+1:c,h=n.getNearestNotHiddenIndex(u,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(i.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,h)-1,1)}}function H0t(t){let e=this.hot.getSelectedRangeLast(),i=e.clone(),{to:r}=e,{columnIndexMapper:n,rowIndexMapper:o}=this.hot,s=(a,c)=>{i.expand(this.hot._createCellCoords(a,c));for(let d=0;d<this.mergedCellsCollection.mergedCells.length;d+=1)i.expandByRange(this.mergedCellsCollection.mergedCells[d].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&i.getHorizontalDirection()==="E-W"&&(a=i.getTopStartCorner().col);let c=n.getNearestNotHiddenIndex(a,1);c!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(c,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&i.getHorizontalDirection()==="W-E"&&(a=i.getBottomEndCorner().col);let c=n.getNearestNotHiddenIndex(a,-1);c!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,c)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&i.getVerticalDirection()==="S-N"&&(a=i.getTopStartCorner().row);let c=o.getNearestNotHiddenIndex(a,1);c!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(c,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&i.getVerticalDirection()==="N-S"&&(a=i.getBottomStartCorner().row);let c=o.getNearestNotHiddenIndex(a,-1);c!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,c)-1,1))}}function B0t(){let t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){_O(bu,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);let i=this.mergedCellsCollection.get(e.row,e.col);_O(bu,this,e.clone()),i&&e.assign(i)}function V0t(t,e){if(t<0||e<0)return;let i=this.mergedCellsCollection.get(t,e);if(!i)return;let{row:r,col:n,colspan:o,rowspan:s}=i;return[r,n,r+s-1,n+o-1]}function j0t(t){t.items.push({name:"---------"},KX(this))}function z0t(t,e,i){let r=this.mergedCellsCollection.get(e,i),n=Xt(r)?as(r):void 0;if(Xt(n)){let{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:c,colspan:d,rowspan:u}=n,[h,p]=this.translateMergedCellToRenderable(a,u,c,d),f=o.getRenderableFromVisualIndex(e),m=s.getRenderableFromVisualIndex(i),g=h-f+1,y=p-m+1;n.row=o.getNearestNotHiddenIndex(n.row,1),n.col=s.getNearestNotHiddenIndex(n.col,1),n.rowspan=Math.min(n.rowspan,g),n.colspan=Math.min(n.colspan,y)}mO(t,n,e,i)}function yEe(){_O(bu,this,null)}function W0t(){if(Gn(bu,this).isCell())return;let t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),i=t.getHorizontalDirection(),r=Gn(bu,this).clone().normalize();Gn(np,this).setActiveNode(r.row,r.col),Gn(_u,this).row>0||Gn(_u,this).col>0?Gn(np,this).setPrevNodeAsActive():(i==="E-W"&&Gn(_u,this).col<0||e==="S-N"&&Gn(_u,this).row<0)&&Gn(np,this).setNextNodeAsActive()}function U0t(t,e){let i=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:n}=this.hot,o=null,s=null;if(Gn(_u,this).col<0){let{rowEnd:a,colEnd:c}=Gn(np,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(c,-1),o=n.getNearestNotHiddenIndex(a,-1)}else if(Gn(_u,this).col>0){let{rowStart:a,colStart:c}=Gn(np,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(c,1),o=n.getNearestNotHiddenIndex(a,1)}else if(Gn(_u,this).row<0){let{rowEnd:a,colEnd:c}=Gn(np,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(c,-1),o=n.getNearestNotHiddenIndex(a,-1)}else if(Gn(_u,this).row>0){let{rowStart:a,colStart:c}=Gn(np,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(c,1),o=n.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){let a=this.hot._createCellCoords(o,s),c=this.mergedCellsCollection.get(a.row,a.col),d=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,c?i.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(c.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(c.col,1)}):i.highlight.assign(a),d.clear(),d.add(a).commit()}Gn(np,this).setActiveNode(t,e),_O(_u,this,{row:0,col:0})}function q0t(){this.hot.getSelectedRangeLast().isHeader()||Gn(np,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Y0t(t,e,i){let r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?i.copyable=!1:(i.rowspan=r.rowspan,i.colspan=r.colspan))}function $0t(t){let e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function G0t(t){let e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function X0t(t,e){this.autofillCalculations.correctSelectionAreaSize(e);let i=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,i))return r=e,r;let n=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return n&&(r=this.autofillCalculations.snapDragArea(e,r,i,n)),r}function K0t(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Z0t(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Q0t(t,e,i){i!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function J0t(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function e_t(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function t_t(t,e){if(e&&e==="area"){let i=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(i);Ce(r,n=>{i.getBottomEndCorner().row===n.getLastRow()&&i.getBottomEndCorner().col===n.getLastColumn()&&(t[2]=n.row,t[3]=n.col)})}}function i_t(t,e,i,r){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,i,r)}function r_t(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function n_t(t,e,i,r){if(!(r instanceof MouseEvent))return;let n=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(n);if(!o)return;let s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&n.isEqual(this.hot._createCellRange(s,s,a))}var ozi=U($e(),1);function xEe(t,e){return function(i,r){let[,...n]=i,[,...o]=r;return function s(a){let c=t[a],d=e[a],u=n[a],h=o[a],p=d.multiColumnSorting,m=(p.compareFunctionFactory?p.compareFunctionFactory:QM(d.type))(c,d,p)(u,h);if(m===hl){let g=a+1;if(typeof e[g]<"u")return s(g)}return m}(0)}}function iK(){Zi(Ai`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}var rzi=U(dt(),1),SEe="sort";function EEe(t,e,i){let r=[];return i===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${SEe}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function TEe(t){let e=t.className.split(" "),i=new RegExp(`^${SEe}-[0-9]{1,2}$`);return e.filter(r=>i.test(r))}function o_t(t,e,i){return e=s_t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s_t(t){var e=a_t(t,"string");return typeof e=="symbol"?e:e+""}function a_t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wO="multiColumnSorting",IEe=170,REe="columnSorting",AEe=wO;ZM(wO,xEe);var CO=class extends _y{constructor(){super(...arguments),o_t(this,"pluginKey",wO)}static get PLUGIN_KEY(){return wO}static get PLUGIN_PRIORITY(){return IEe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[REe]&&iK(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,uS)),!1},runOnlyIf:()=>{var e,i;let r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:ul,position:"before",group:AEe})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AEe)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];super.updateHeaderClasses(e,...r),Gt(e,TEe(e)),this.enabled!==!1&&Qe(e,EEe(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[REe]&&iK(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,i){tk(i.row,i.col,e)!==!1&&this.wasClickableHeaderClicked(e,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,uS))):this.sort(this.getColumnNextConfig(i.col)))}};var vzi=U($e(),1),bzi=U(dt(),1);function DEe(t,e,i){return e=l_t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l_t(t){var e=c_t(t,"string");return typeof e=="symbol"?e:e+""}function c_t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MEe="multipleSelectionHandles",kEe=160,xO=class extends Zt{constructor(){super(...arguments),DEe(this,"dragged",[]),DEe(this,"lastSetCell",null)}static get PLUGIN_KEY(){return MEe}static get PLUGIN_PRIORITY(){return kEe}isEnabled(){return rd()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){let e=this,{rootElement:i}=this.hot;function r(n){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;let o=e.dragged.indexOf(n);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(i,"touchstart",n=>{let o;if(Bt(n.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},n.preventDefault(),!1;if(Bt(n.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},n.preventDefault(),!1}),this.eventManager.addEventListener(i,"touchend",n=>{if(Bt(n.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,n.preventDefault(),!1;if(Bt(n.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,n.preventDefault(),!1}),this.eventManager.addEventListener(i,"touchmove",n=>{let{rootDocument:o}=this.hot,s,a,c,d,u,h;if(e.dragged.length===0)return;let p=o.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);!p||p===e.lastSetCell||((p.nodeName==="TD"||p.nodeName==="TH")&&(s=e.hot.getCoords(p),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),c=a.getWidth(),d=a.getHeight(),u=a.getDirection(),c===1&&d===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,u,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=p),n.preventDefault())})}getCurrentRangeCoords(e,i,r,n,o){let s=e.getTopStartCorner(),a=e.getBottomEndCorner(),c=e.getBottomStartCorner(),d=e.getTopEndCorner(),u={start:null,end:null};switch(r){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":o==="top"?u={start:this.hot._createCellCoords(i.row,e.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:u={start:this.hot._createCellCoords(e.highlight.row,i.col),end:this.hot._createCellCoords(i.row,s.col)};break;case"SE-NW":o==="bottom"&&(u={start:this.hot._createCellCoords(a.row,i.col),end:this.hot._createCellCoords(i.row,s.col)});break;default:break}break;case"NW-SE":switch(n){case"NE-SW":o==="top"?u={start:i,end:c}:u.end=i;break;case"NW-SE":o==="top"?u={start:i,end:a}:u.end=i;break;case"SE-NW":o==="top"?u={start:i,end:s}:u.end=i;break;case"SW-NE":o==="top"?u={start:i,end:d}:u.end=i;break;default:break}break;case"SW-NE":switch(n){case"NW-SE":o==="bottom"?u={start:this.hot._createCellCoords(i.row,s.col),end:this.hot._createCellCoords(c.row,i.col)}:u={start:this.hot._createCellCoords(s.row,i.col),end:this.hot._createCellCoords(i.row,a.col)};break;case"SW-NE":o==="top"?u={start:this.hot._createCellCoords(e.highlight.row,i.col),end:this.hot._createCellCoords(i.row,a.col)}:u={start:this.hot._createCellCoords(i.row,s.col),end:this.hot._createCellCoords(s.row,i.col)};break;case"SE-NW":o==="bottom"?u={start:this.hot._createCellCoords(i.row,d.col),end:this.hot._createCellCoords(s.row,i.col)}:o==="top"&&(u={start:c,end:i});break;default:break}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(u.end=i);break;case"SE-NW":o==="top"?u.end=i:u={start:i,end:s};break;default:break}break;default:break}return u}isDragged(){return this.dragged.length>0}};var GWi=U($e(),1),XWi=U(dt(),1);var PWi=U($e(),1),LWi=U(dt(),1);var kzi=U($e(),1),Ozi=U(dt(),1);var Tzi=U(dt(),1);function SO(){let{label:t="",colspan:e=1,origColspan:i=1,collapsible:r=!1,crossHiddenColumns:n=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:c=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:i,collapsible:r,isCollapsed:o,crossHiddenColumns:n,isHidden:s,isRoot:a,isPlaceholder:c}}function Z3(){return{label:"",isPlaceholder:!0}}function OEe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,i=[];if(e===0)return i;Ce(t,n=>{let o=[],s=0;i.push(o),Ce(n,a=>{let c=SO();if(Xt(a)){let{label:u,colspan:h}=a;c.label=Vr(u),typeof h=="number"&&h>1&&(c.colspan=h,c.origColspan=h)}else c.label=Vr(a);s+=c.origColspan;let d=!1;if(s>=e&&(c.colspan=c.origColspan-(s-e),c.origColspan=c.colspan,d=!0),o.push(c),c.colspan>1)for(let u=0;u<c.colspan-1;u++)o.push(Z3());return!d})});let r=Math.max(...ri(i,n=>n.length));return Ce(i,n=>{if(n.length<r){let o=ri(new Array(r-n.length),()=>SO());n.splice(n.length,0,...o)}}),i}function rK(t,e,i){d_t(t,e),e.set(t,i)}function d_t(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yh(t,e){return t.get(PEe(t,e))}function EO(t,e,i){return t.set(PEe(t,e),i),i}function PEe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var NEe=["label","collapsible"],jm=new WeakMap,Xy=new WeakMap,nK=new WeakMap,Q3=class{constructor(){rK(this,jm,[]),rK(this,Xy,0),rK(this,nK,1/0)}setColumnsLimit(e){EO(nK,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];EO(jm,this,OEe(e,yh(nK,this))),EO(Xy,this,yh(jm,this).length)}getData(){return yh(jm,this)}mergeWith(e){Ce(e,i=>{let a=i,{row:r,col:n}=a,o=Mn(a,["row","col"]),s=this.getHeaderSettings(r,n);s!==null&&Sr(s,o,NEe)})}map(e){Ce(yh(jm,this),i=>{Ce(i,r=>{let n=e(Ke({},r));Xt(n)&&Sr(r,n,NEe)})})}getHeaderSettings(e,i){var r;if(e>=yh(Xy,this)||e<0)return null;let n=yh(jm,this)[e];return Array.isArray(n)===!1||i>=n.length?null:(r=n[i])!==null&&r!==void 0?r:null}getHeadersSettings(e,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=[];if(e>=yh(Xy,this)||e<0)return n;let o=yh(jm,this)[e],s=0;for(let a=i;a<o.length;a++){let c=o[a];if(c.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=c.colspan,n.push(c),c.colspan>1&&(a+=c.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return n}getLayersCount(){return yh(Xy,this)}getColumnsCount(){return yh(Xy,this)>0?yh(jm,this)[0].length:0}clear(){EO(jm,this,[]),EO(Xy,this,0)}};var Wzi=U($e(),1);var Bzi=U($e(),1),Vzi=U(dt(),1);function oK(t,e,i){return e=u_t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u_t(t){var e=h_t(t,"string");return typeof e=="symbol"?e:e+""}function h_t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sK="DF-pre-order";function FEe(t,e){let i=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(i===!1)return!1;i=FEe.call(this.childs[r],t,e)}return i}var f_t="DF-post-order";function HEe(t,e){for(let i=0;i<this.childs.length;i++)if(HEe.call(this.childs[i],t,e)===!1)return!1;return t.call(e,this)}var BEe="BF";function p_t(t,e){let i=[this];function r(){if(i.length===0)return;let n=i.shift();i.push(...n.childs),t.call(e,n)!==!1&&r()}r()}var m_t=BEe,LEe=new Map([[sK,FEe],[f_t,HEe],[BEe,p_t]]),TO=class t{constructor(e){oK(this,"data",{}),oK(this,"parent",null),oK(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,i=new t(Ke({},e.data));for(let r=0;r<e.childs.length;r++)i.addChild(this.cloneTree(e.childs[r]));return i}replaceTreeWith(e){this.data=Ke({},e.data),this.childs=[];for(let i=0;i<e.childs.length;i++)this.addChild(e.childs[i])}walkDown(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m_t;if(!LEe.has(i))throw new Error(`Traversal strategy "${i}" does not exist`);LEe.get(i).call(this,e,this)}walkUp(e){let i=this,r=n=>{e.call(i,n)!==!1&&n.parent!==null&&r(n.parent)};r(this)}};function aK(t,e,i){g_t(t,e),e.set(t,i)}function g_t(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $l(t,e){return t.get(VEe(t,e))}function v_t(t,e,i){return t.set(VEe(t,e),i),i}function VEe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var KS=new WeakMap,Ky=new WeakMap,ZS=new WeakMap,J3=class{constructor(e){aK(this,KS,new Map),aK(this,Ky,new Map),aK(this,ZS,null),v_t(ZS,this,e)}getRoots(){return Array.from($l(KS,this).values())}getRootByColumn(e){let i;return $l(Ky,this).has(e)&&(i=$l(KS,this).get($l(Ky,this).get(e))),i}getNode(e,i){let r=this.getRootByColumn(i);if(!r)return;let n=i-$l(Ky,this).get(i),o=0,s;return r.walkDown(a=>{let{data:{origColspan:c,headerLevel:d}}=a;if(e===d){if(n>=o&&n<=o+c-1)return s=a,s.data.isRoot=i===s.data.columnIndex,!1;o+=c}}),s}rebuildTreeIndex(){let e=0;$l(Ky,this).clear(),Ce($l(KS,this),i=>{let[,{data:{colspan:r}}]=i;for(let n=e;n<e+r;n++)$l(Ky,this).set(n,e);e+=r})}buildTree(){this.clear();let e=$l(ZS,this).getColumnsCount(),i=0;for(;i<e;){let r=$l(ZS,this).getHeaderSettings(0,i),n=new TO;$l(KS,this).set(i,n),this.buildLeaves(n,i,0,r.origColspan),i+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,i,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=$l(ZS,this).getHeadersSettings(r,i,n);r+=1,Ce(o,s=>{let a=Lt(Ke({},s),{headerLevel:r-1,columnIndex:i}),c;r===1?(e.data=a,c=e):(c=new TO(a),e.addChild(c)),r<$l(ZS,this).getLayersCount()&&this.buildLeaves(c,i,r,s.origColspan),i+=s.origColspan})}clear(){$l(KS,this).clear(),$l(Ky,this).clear()}};var SWi=U($e(),1);var sWi=U(ln(),1),aWi=U(cn(),1),lWi=U(dn(),1),cWi=U(un(),1),dWi=U(hn(),1),uWi=U(fn(),1),hWi=U(pn(),1);var Xzi=U(ln(),1),Kzi=U(cn(),1),Zzi=U(dn(),1),Qzi=U(un(),1),Jzi=U(hn(),1),eWi=U(fn(),1),tWi=U(pn(),1);function e4(t,e){t.walkDown(i=>{let{data:r,childs:n}=i;if(!r.isHidden&&(e(r.columnIndex),n.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function QS(t,e){let{childs:i}=t;if(i.length!==0)return i[0].data[e]}function JS(t){return QS(t,"origColspan")===t.data.origColspan}function RO(t){let{data:e,childs:i}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(JS(t))return RO(i[0]);e.isCollapsed=!1;let n=i.slice(1),o=new Set,s=0;if(n.length>0)Ce(n,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;let c=a.data;s+=c.colspan,e4(a,d=>{o.add(d)})});else{let{colspan:a,origColspan:c,columnIndex:d}=e;s=c-a;for(let u=1;u<c;u++)o.add(d+u)}return t.walkUp(a=>{let{data:c}=a;c.colspan+=s,c.colspan>=c.origColspan?(c.colspan=c.origColspan,c.isCollapsed=!1):JS(a)&&(c.isCollapsed=QS(a,"isCollapsed"))}),{rollbackModification:()=>AO(t),affectedColumns:Array.from(o),colspanCompensation:s}}function AO(t){var e;let{data:i,childs:r}=t;if(i.isCollapsed||i.isHidden||i.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(JS(t))return AO(r[0]);i.isCollapsed=!0;let o=r.slice(1),s=new Set;if(o.length>0)Ce(o,c=>{e4(c,d=>{s.add(d)}),c.data.clonedTree=c.cloneTree(),c.walkDown(d=>{let{data:u}=d;u.isHidden=!0})});else{let{origColspan:c,columnIndex:d}=i;for(let u=1;u<c;u++){let h=d+u;s.add(h)}}let a=i.colspan-((e=QS(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(c=>{let{data:d}=c;d.colspan-=a,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):JS(c)&&(d.isCollapsed=QS(c,"isCollapsed"))}),{rollbackModification:()=>RO(t),affectedColumns:Array.from(s),colspanCompensation:a}}var vWi=U($e(),1),bWi=U(dt(),1);function jEe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ai`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);let{crossHiddenColumns:i}=t.data;if(i.includes(e))return;let r=!1;t.walkUp(n=>{let{data:{collapsible:o}}=n;if(o)return r=!0,!1}),!r&&t.walkUp(n=>{let{data:o}=n;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}var wWi=U($e(),1);function zEe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ai`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);let{crossHiddenColumns:i}=t.data;if(!i.includes(e))return;let r=!1;t.walkUp(n=>{let{data:{collapsible:o}}=n;if(o)return r=!0,!1}),!r&&t.walkUp(n=>{let{data:o}=n;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}var WEe=new Map([["collapse",AO],["expand",RO],["hide-column",jEe],["show-column",zEe]]);function UEe(t,e,i){if(!WEe.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return WEe.get(t)(e,i)}var DWi=U(dt(),1);function IO(t){let e=[];return Ce(t,i=>{i.walkDown(r=>{let n=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:c}=n,d=__t(e,a),u=!1;for(let h=s;h<s+o;h++)if(c.includes(h)||u)d.push(Z3(n));else{let f=b_t(n);f.isRoot=!0,d.push(f),u=!0}})}),e}function b_t(t){let r=SO(t),{crossHiddenColumns:e}=r;return Mn(r,["crossHiddenColumns"])}function __t(t,e){let i;return Array.isArray(t[e])?i=t[e]:(i=[],t[e]=i),i}function lK(t,e,i){y_t(t,e),e.set(t,i)}function y_t(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DO(t,e,i){return t.set(qEe(t,e),i),i}function Mo(t,e){return t.get(qEe(t,e))}function qEe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var op=new WeakMap,Nc=new WeakMap,Zy=new WeakMap,t4=class{constructor(){lK(this,op,new Q3),lK(this,Nc,new J3(Mo(op,this))),lK(this,Zy,[[]])}setState(e){Mo(op,this).setData(e);let i=!1;try{Mo(Nc,this).buildTree()}catch{Mo(Nc,this).clear(),Mo(op,this).clear(),i=!0}return DO(Zy,this,IO(Mo(Nc,this).getRoots())),i}setColumnsLimit(e){Mo(op,this).setColumnsLimit(e)}mergeStateWith(e){let i=ri(e,r=>{let s=r,{row:n}=s,o=Mn(s,["row"]);return Ke({row:n<0?this.rowCoordsToLevel(n):n},o)});Mo(op,this).mergeWith(i),Mo(Nc,this).buildTree(),DO(Zy,this,IO(Mo(Nc,this).getRoots()))}mapState(e){Mo(op,this).map(e),Mo(Nc,this).buildTree(),DO(Zy,this,IO(Mo(Nc,this).getRoots()))}mapNodes(e){return Gr(Mo(Nc,this).getRoots(),(i,r)=>(r.walkDown(n=>{let o=e(n.data);o!==void 0&&i.push(o)}),i),[])}triggerNodeModification(e,i,r){i<0&&(i=this.rowCoordsToLevel(i));let n=Mo(Nc,this).getNode(i,r),o;return n&&(o=UEe(e,n,r),DO(Zy,this,IO(Mo(Nc,this).getRoots()))),o}triggerColumnModification(e,i){return this.triggerNodeModification(e,-1,i)}rowCoordsToLevel(e){if(e>=0)return null;let i=e+Math.max(this.getLayersCount(),1);return i<0?null:i}levelToRowCoords(e){if(e<0)return null;let i=e-Math.max(this.getLayersCount(),1);return i>=0?null:i}getHeaderSettings(e,i){var r,n;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(n=Mo(Zy,this)[e])===null||n===void 0?void 0:n[i])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,i){let r=this.getHeaderTreeNode(e,i);return r?Ke({},r.data):null}getHeaderTreeNode(e,i){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;let r=Mo(Nc,this).getNode(e,i);return r||null}findTopMostEntireHeaderLevel(e){var i;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=r-e+1,o=!1,s=null;for(let a=e;a<=r;a++){let c=Mo(Nc,this).getRootByColumn(a);if(!c)break;o=!0,c.walkDown(d=>{let{columnIndex:u,headerLevel:h,origColspan:p,isHidden:f}=d.data;f||p<=n&&u>=e&&u+p-1<=r&&(s===null||h<s)&&(s=h)},sK)}return o&&s===null?-1:this.levelToRowCoords((i=s)!==null&&i!==void 0?i:0)}findLeftMostColumnIndex(e,i){var r;let{isRoot:n}=(r=this.getHeaderSettings(e,i))!==null&&r!==void 0?r:{isRoot:!0};if(n)return i;let o=i-1;for(;o>=0;){var s;let{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,i){var r;let{isRoot:n,origColspan:o}=(r=this.getHeaderSettings(e,i))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(n)return i+o-1;let s=i+1;for(;s<this.getColumnsCount();){var a;let{isRoot:c}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(c)break;s+=1}return s-1}getLayersCount(){return Mo(op,this).getLayersCount()}getColumnsCount(){return Mo(op,this).getColumnsCount()}clear(){DO(Zy,this,[]),Mo(op,this).clear(),Mo(Nc,this).clear()}};var qWi=U($e(),1);function MO(t,e,i){return e=w_t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function w_t(t){var e=C_t(t,"string");return typeof e=="symbol"?e:e+""}function C_t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cK=class{constructor(e,i){MO(this,"hot",void 0),MO(this,"nestedHeaderSettingsGetter",void 0),MO(this,"layersCount",0),MO(this,"container",void 0),MO(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=i,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);let e=this.container.querySelectorAll("tr:last-of-type th"),i=e.length;this.widthsMap.clear();for(let r=0;r<i;r++){let n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(n);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){let{rootDocument:i,columnIndexMapper:r}=this.hot,n=i.createDocumentFragment(),o=i.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let c=0;c<this.layersCount;c++){let d=i.createElement("tr");for(let u=0;u<a;u++){let h=r.getVisualFromRenderableIndex(u);h===null&&(h=u);let p=i.createElement("th"),f=this.nestedHeaderSettingsGetter(c,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;s&&(m+='<button class="changeType"></button>'),Zd(p,m),p.colSpan=f.colspan,d.appendChild(p)}}o.appendChild(d)}n.appendChild(o),e.appendChild(n)}clear(){this.widthsMap.clear(),this.container=null}},YEe=cK;function x_t(t,e){GEe(t,e),e.add(t)}function $Ee(t,e,i){return e=S_t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function S_t(t){var e=E_t(t,"string");return typeof e=="symbol"?e:e+""}function E_t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i4(t,e,i){GEe(t,e),e.set(t,i)}function GEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qy(t,e,i){return t.set(ko(t,e),i),i}function Ar(t,e){return t.get(ko(t,e))}function ko(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var dK="nestedHeaders",XEe=280,Cn=new WeakMap,Pb=new WeakMap,kO=new WeakMap,n4=new WeakMap,$o=new WeakSet,OO=class extends Zt{constructor(){super(...arguments),x_t(this,$o),i4(this,Cn,new t4),i4(this,Pb,null),i4(this,kO,null),i4(this,n4,!1),$Ee(this,"ghostTable",new YEe(this.hot,(e,i)=>this.getHeaderSettings(e,i))),$Ee(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return dK}static get PLUGIN_PRIORITY(){return XEe}isEnabled(){return!!this.hot.getSettings()[dK]}enablePlugin(){var e=this;if(this.enabled)return;let{nestedHeaders:i}=this.hot.getSettings();(!Array.isArray(i)||!Array.isArray(i[0]))&&Zi(Ai`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>ko($o,this,j_t).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,z_t).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,I_t).call(e,...n)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,D_t).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,M_t).call(e,...n)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,k_t).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,O_t).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,N_t).call(e,...n)}),this.addHook("afterSelection",()=>ko($o,this,r4).call(this)),this.addHook("afterSelectionFocusSet",()=>ko($o,this,r4).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,T_t).call(e,...n)}),this.addHook("afterGetColumnHeaderRenderers",r=>ko($o,this,L_t).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,H_t).call(e,...n)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,B_t).call(e,...n)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,R_t).call(e,...n)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,A_t).call(e,...n)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,P_t).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,F_t).call(e,...n)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ko($o,e,V_t).call(e,...n)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>ko($o,this,r4).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>ko($o,this,r4).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;let{nestedHeaders:e}=this.hot.getSettings();Ar(Cn,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ar(Cn,this).setState(e)),this.detectedOverlappedHeaders&&Zi(Ai`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((i,r)=>{let n=i===!0?"hide-column":"show-column";Ar(Cn,this).triggerColumnModification(n,r)}),!Ar(Pb,this)&&this.enabled&&Qy(Pb,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(i=>{i.forEach(r=>{let{op:n,index:o,newValue:s}=r;if(n==="replace"){let a=s===!0?"hide-column":"show-column";Ar(Cn,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ar(Cn,this).clear(),Ar(Pb,this).unsubscribe(),Qy(Pb,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ar(Cn,this)}getLayersCount(){return Ar(Cn,this).getLayersCount()}getHeaderSettings(e,i){return Ar(Cn,this).getHeaderSettings(e,i)}clearColspans(){if(!this.hot.view)return;let{_wt:e}=this.hot.view,i=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,n=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<i;s++){let a=r.childNodes[s];if(!a)break;let c=n.childNodes[s],d=o?o.childNodes[s]:null;for(let u=0,h=a.childNodes.length;u<h;u++)a.childNodes[u].removeAttribute("colspan"),Gt(a.childNodes[u],"hiddenHeader"),c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),Gt(c.childNodes[u],"hiddenHeader")),o&&d&&d.childNodes[u]&&(d.childNodes[u].removeAttribute("colspan"),Gt(d.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var i=this;let r=this.hot.view._wt.getSetting("fixedColumnsStart");return(n,o)=>{var s;let{columnIndexMapper:a,view:c}=this.hot,d=a.getVisualFromRenderableIndex(n);d===null&&(d=n),o.removeAttribute("colspan"),Gt(o,"hiddenHeader");let{colspan:u,isHidden:h,isPlaceholder:p}=(s=Ar(Cn,this).getHeaderSettings(e,d))!==null&&s!==void 0?s:{label:""};if(p||h)Qe(o,"hiddenHeader");else if(u>1){var f,m;let{wtOverlays:g}=c._wt,y=(f=g.topInlineStartCornerOverlay)===null||f===void 0?void 0:f.clone.wtTable.THEAD.contains(o),w=(m=g.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),x=y||w?Math.min(u,r-n):u;x>1&&o.setAttribute("colspan",x)}this.hot.view.appendColHeader(d,o,function(){return i.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,i){var r;let{isHidden:n,isPlaceholder:o}=(r=Ar(Cn,this).getHeaderSettings(i,e))!==null&&r!==void 0?r:{};return o||n?"":this.hot.getColHeader(e,i)}destroy(){Qy(Cn,this,null),Ar(Pb,this)!==null&&(Ar(Pb,this).unsubscribe(),Qy(Pb,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ar(Cn,this).getHeaderTreeNodeData(e.row,e.col)}};function r4(){var t;let e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;let{highlight:i}=e;if(i.isHeader()&&i.col>=0){let n=Ar(Cn,this).findLeftMostColumnIndex(i.row,i.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=n,o.visualCellRange.from.col=n,o.visualCellRange.to.col=n,o.commit()}}function T_t(t){let e=this.hot.getSelectedRangeLast();if(!e)return t;let{highlight:i}=e;if(!(i.isHeader()&&i.col>=0))return t;let n=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=Ar(Cn,this).findLeftMostColumnIndex(i.row,i.col),a=Ar(Cn,this).findRightMostColumnIndex(i.row,i.col);return s<n&&a>o?t:s<n?s:a}function R_t(t,e,i){let r=Ar(Cn,this).getHeaderTreeNodeData(e,t);if(!r)return t;let{columnCursor:n,selectionType:o,selectionWidth:s}=i,{isRoot:a,colspan:c}=Ar(Cn,this).getHeaderSettings(e,t);if(o===Zv){if(!a)return r.columnIndex}else if(o===S1&&(c>s-n||!a))return null;return t}function A_t(t,e,i){let{columnHeadersCount:r}=i;if(r!==0)for(let o=0;o<e.length;o++){let{startRow:s,startCol:a,endRow:c,endCol:d}=e[o],u=c-s+1,h=a-d+1;if(s>=0||h===1)break;for(let p=a;p<=d;p++)for(let f=s;f<=c;f++){var n;let m=u+f,g=p-a;if(g===0)continue;((n=Ar(Cn,this).getHeaderTreeNodeData(f,p))===null||n===void 0?void 0:n.isRoot)===!1&&(t[m][g]="")}}}function I_t(t,e,i,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function D_t(t,e){let i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;Qy(kO,this,e.clone()),Qy(n4,this,!0);let{selection:r}=this.hot,n=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=i,c=!r.inInSelection(e);t.shiftKey&&n?e.col<n.from.col?o.push(n.getTopEndCorner().col,s,e.row):e.col>n.from.col?o.push(n.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(h1(t)||nd(t)&&c)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function M_t(t,e,i,r){if(!this.hot.view.isMouseDown())return;let n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;let{columnIndex:o,origColspan:s}=n,a=this.hot.getSelectedRangeLast(),c=a.getTopStartCorner(),d=a.getBottomEndCorner(),{from:u}=a;r.column=!0,r.cell=!0;let h=[],p=Rr(e.row,-1/0,-1);e.col<u.col?h.push(d.col,o,p):e.col>u.col?h.push(c.col,o+s-1,p):h.push(o,o+s-1,p),this.hot.selection.selectColumns(...h)}function k_t(){Qy(n4,this,!1)}function O_t(){let{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ar(n4,this)||!t)return;let e=this.hot.getSelectedRangeLast(),i=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:n,origColspan:o}=Ar(Cn,this).getHeaderTreeNodeData(Ar(kO,this).row,Ar(kO,this).col);if(e.setHighlight(Ar(kO,this)),o>e.getWidth()||n<i||n+o-1>r){let s=Ar(Cn,this).findTopMostEntireHeaderLevel(Rr(i,n,n+o-1),Rr(r,n,n+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function N_t(t){let{highlight:e}=this.hot.getSelectedRangeLast(),i=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(i.isHeader()&&i.col>=0))return;let n=Ar(Cn,this).findLeftMostColumnIndex(i.row,i.col),o=Ar(Cn,this).findRightMostColumnIndex(i.row,i.col);if(t.col<0){let s=e.col>=n&&e.col<=o?n-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){let s=e.col>=n&&e.col<=o?o+1:n,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function P_t(t,e){let i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),n=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),n&&(e.col=n.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),n&&(e.col=n.columnIndex+n.origColspan-1))}function L_t(t){t.length=0;for(let e=0;e<Ar(Cn,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function F_t(t){let e=Ar(Cn,this).getLayersCount(),i=t.startColumn,r=!!e;for(let n=0;n<e;n++){let o=Ar(Cn,this).findLeftMostColumnIndex(n,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),ds(s)&&s<t.startColumn){i=s;break}}t.startColumn=r?Ar(Cn,this).getHeaderTreeNodeData(0,i).columnIndex:i}function H_t(t,e){let i=this.ghostTable.getWidth(e);return t>i?t:i}function B_t(t,e,i){var r;let{label:n}=(r=Ar(Cn,this).getHeaderTreeNodeData(i,e))!==null&&r!==void 0?r:{label:""};return n}function V_t(t,e){if(t<0)return this.hot.getCell(t,Ar(Cn,this).findLeftMostColumnIndex(t,e),!0)}function j_t(){this.updatePlugin()}function z_t(t,e){e||this.updatePlugin()}var jUi=U($e(),1),zUi=U(dt(),1),WUi=U(ln(),1),UUi=U(cn(),1),qUi=U(dn(),1),YUi=U(un(),1),$Ui=U(hn(),1),GUi=U(fn(),1),XUi=U(pn(),1);var lUi=U($e(),1),cUi=U(dt(),1);function NO(t,e,i){return e=W_t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function W_t(t){var e=U_t(t,"string");return typeof e=="symbol"?e:e+""}function U_t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uK=class{constructor(e,i){NO(this,"hot",void 0),NO(this,"data",null),NO(this,"plugin",void 0),NO(this,"parentReference",new WeakMap),NO(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=i,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},_t(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,i,r){this.cache.levels[i]||(this.cache.levels[i]=[],this.cache.levelCount+=1),this.cache.levels[i].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:i}),this.hasChildren(e)&&Ce(e.__children,n=>{this.cacheNode(n,i+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,i,r,n){let o=!1,s=i;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:n!=null&&a===n?{result:s,end:!0}:(s+=1,a.__children&&Ce(a.__children,c=>{if(this.parentReference.set(c,o?null:a),s=this.readTreeNodes(c,s,r,n),isNaN(s)&&s.end)return!1}),s)}mockParent(){let e=this.mockNode();return e.__children=this.data,e}mockNode(){let e={};return Kt(this.data[0],(i,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let i=null;isNaN(e)?i=e:i=this.getDataObject(e);let r=this.getRowParent(e);return r==null?this.data.indexOf(i):r.__children.indexOf(i)}countAllRows(){let e={__children:this.data};return this.countChildren(e)}countChildren(e){let i=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(Ce(r.__children,n=>{i+=1,n.__children&&(i+=this.countChildren(n))}),i)}getRowParent(e){let i;return isNaN(e)?i=e:i=this.getDataObject(e),this.getRowObjectParent(i)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let i=null;return isNaN(e)?i=e:i=this.getDataObject(e),i?this.getRowObjectLevel(i):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let i=e;return isNaN(i)||(i=this.getDataObject(i)),!!(i.__children&&i.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,i){var r;return((r=e.__children)===null||r===void 0?void 0:r[i])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var i;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((i=r.__children)===null||i===void 0?void 0:i.length)!==0}addChild(e,i){let r=i;this.hot.runHooks("beforeAddChild",e,r);let n=null;e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();let s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,i,r){let n=r,o;if(n||(n=this.mockNode()),this.hot.runHooks("beforeAddChild",e,n,i),e){let a=this.getRowIndex(e)+i+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(i,null,n),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",i,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[i]);n=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,n,i)}addSibling(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",r=this.translateTrimmedRow(e),n=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(i){case"below":this.addChildAtIndex(n,o+1,null);break;case"above":this.addChildAtIndex(n,o,null);break;default:break}}detachFromParent(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null,n=[];Array.isArray(e)?(_t(e[0],e[2],p=>{let f=this.translateTrimmedRow(p);n.push(this.getDataObject(f))}),_t(0,n.length-2,p=>{this.detachFromParent(n[p],!1)}),r=n[n.length-1]):r=e;let o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),c=this.getRowParent(r),d=this.getRowParent(c),u=this.getRowIndex(d),h=null;if(this.hot.runHooks("beforeDetachChild",c,r),a!=null){let p=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,p,this.plugin.pluginName),c.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,p,this.plugin.pluginName),d){h=u+this.countChildren(d);let f=this.getChild(d,this.countChildren(d)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),d.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,r,this.getRowIndex(r)),i&&this.hot.render()}filterData(e,i,r){let n=[];Ce(r,o=>{n.push(this.getDataObject(o))}),Ce(n,o=>{let s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,i,r){let n=this.getDataObject(e-1),o=null,s=e;n&&n.__children&&n.__children.length===0?(o=n,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,i,...r):o.__children.splice(s,i):r?this.data.splice(s,i,...r):this.data.splice(s,i),this.rewriteCache()}syncRowWithRawSource(e){let i=e,r=null;do r=this.getRowParent(r),r!==null&&(i=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(i),"__children",i.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,i,r,n){let o=i===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),c=s.__children.slice(a,a+1),d=e>i,u=o?this.getRowParent(i-1):this.getRowParent(i);u==null&&(u=this.getRowParent(i-1)),u==null&&(u=this.getDataObject(i-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(i),u.__children=[]);let h=o||r||n?u.__children.length:this.getRowIndexWithinParent(i),p=s===u;u.__children.splice(h,0,c[0]),s.__children.splice(a+(d&&p?1:0),1),this.syncRowWithRawSource(s),p||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}},KEe=uK;var CUi=U(dt(),1);var pUi=U($e(),1);function ZEe(t,e,i){return e=q_t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function q_t(t){var e=Y_t(t,"string");return typeof e=="symbol"?e:e+""}function Y_t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hK=class{constructor(e,i){ZEe(this,"hot",void 0),ZEe(this,"plugin",void 0),this.hot=i,this.plugin=e}},eE=hK;var fK=class t extends eE{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,i){super(e,i),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,i){let r=this.hot.toPhysicalRow(e),n=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=i.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),c=s.querySelectorAll('[class^="ht_nesting"]'),d=this.hot.getSettings().ariaTags;if(Ce(c,u=>{u&&s.removeChild(u)}),Qe(i,t.CSS_CLASSES.indicatorContainer),n){let{rootDocument:u}=this.hot,h=a.cloneNode(!0);s.innerHTML="",_t(0,n-1,()=>{let p=u.createElement("SPAN");Qe(p,t.CSS_CLASSES.emptyIndicator),s.appendChild(p)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){let u=this.hot.rootDocument.createElement("DIV");d&&Ht(u,[ta()]),Qe(i,t.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(Qe(u,`${t.CSS_CLASSES.button} ${t.CSS_CLASSES.expandButton}`),d&&Ht(i,[Oa(!1)])):(Qe(u,`${t.CSS_CLASSES.button} ${t.CSS_CLASSES.collapseButton}`),d&&Ht(i,[Oa(!0)])),s.appendChild(u)}}updateRowHeaderWidth(e){let i=e;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}},o4=fK;var pK=class extends eE{constructor(e,i){var r;super(e,i),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,n)},shiftStash:function(n,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),Ce(r.lastCollapsedRows,(a,c)=>{a>=n&&a<o&&(r.lastCollapsedRows[c]=a+s)})},applyStash:function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,n),r.lastCollapsedRows=void 0},trimStash:(n,o)=>{_t(n,n+o-1,s=>{let a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=[],o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&Ce(o.__children,c=>{n.push(this.dataManager.getRowIndex(c))}),a=this.collapseRows(n,!0,!1),r&&this.trimRows(a),i&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=[];Ce(e,o=>{n.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(n),i&&this.renderAndAdjust()}collapseRow(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],i)}collapseRows(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=[];return Ce(e,o=>{n.push(o),i&&this.collapseChildRows(o,n)}),r&&this.trimRows(n),n}collapseChildRows(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){let o=this.dataManager.getDataObject(e);Ce(o.__children,s=>{let a=this.dataManager.getRowIndex(s);i.push(a),this.collapseChildRows(a,i)})}n&&this.trimRows(i)}expandRow(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],i)}expandRows(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=[];return Ce(e,o=>{n.push(o),i&&this.expandChildRows(o,n)}),r&&this.untrimRows(n),n}expandChildRows(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){let o=this.dataManager.getDataObject(e);Ce(o.__children,s=>{if(!this.isAnyParentCollapsed(s)){let a=this.dataManager.getRowIndex(s);i.push(a),this.expandChildRows(a,i)}})}n&&this.untrimRows(i)}expandChildren(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=[],o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&Ce(o.__children,c=>{let d=this.dataManager.getRowIndex(c);n.push(d)}),a=this.expandRows(n,!0,!1),r&&this.untrimRows(a),i&&this.renderAndAdjust(),a}expandMultipleChildren(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=[];Ce(e,o=>{n.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(n),i&&this.renderAndAdjust()}collapseAll(){let e=this.dataManager.getData(),i=[];Ce(e,r=>{this.dataManager.hasChildren(r)&&i.push(r)}),this.collapseMultipleChildren(i),this.renderAndAdjust()}expandAll(){let e=this.dataManager.getData(),i=[];Ce(e,r=>{this.dataManager.hasChildren(r)&&i.push(r)}),this.expandMultipleChildren(i),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{Ce(e,i=>{this.plugin.collapsedRowsMap.setValueAtIndex(i,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{Ce(e,i=>{this.plugin.collapsedRowsMap.setValueAtIndex(i,!1)})},!0)}areChildrenCollapsed(e){let i=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return i===null&&(i={__children:this.dataManager.data}),this.dataManager.hasChildren(i)&&Ce(i.__children,n=>{let o=this.dataManager.getRowIndex(n);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let i=e;for(;i!==null;){i=this.dataManager.getRowParent(i);let r=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,i){if(i.col>=0)return;let r=this.translateTrimmedRow(i.row);Bt(e.target,o4.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Uo(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}},QEe=pK;var DUi=U($e(),1);function $_t(t,e,i){G_t(t,e),e.set(t,i)}function G_t(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X_t(t,e,i){return e=K_t(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function K_t(t){var e=Z_t(t,"string");return typeof e=="symbol"?e:e+""}function Z_t(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Q_t(t,e){return t.get(J_t(t,e))}function J_t(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var JEe=new WeakMap,mK=class extends eE{constructor(){super(...arguments),X_t(this,"dataManager",this.plugin.dataManager),$_t(this,JEe,{row_above:(e,i)=>{let r=i[i.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,i)=>{let r=i[i.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){let i=[{key:"add_child",name(){return this.getTranslatedPhrase(zD)},callback:()=>{let r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),n=this.dataManager.getDataObject(r);this.dataManager.addChild(n)},disabled:()=>{let r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(WD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{let r=this.hot.getSelectedLast(),n=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(n)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return _t(0,e.items.length-1,r=>{if(r===0)return Ce(i,(n,o)=>{e.items.splice(r+o,0,n)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return _t(0,e.items.length-1,i=>{let r=Q_t(JEe,this)[e.items[i].key];r!=null&&(e.items[i].callback=r)}),e}},eTe=mK;var PUi=U($e(),1),LUi=U(dt(),1);function s4(t,e,i){return e=eyt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function eyt(t){var e=tyt(t,"string");return typeof e=="symbol"?e:e+""}function tyt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var a4=class{constructor(e){s4(this,"plugin",void 0),s4(this,"hot",void 0),s4(this,"dataManager",void 0),s4(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,i,r,n){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:i,dropIndex:r,movePossible:n}))return!1;this.movedToCollapsed=!1;let s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r),c=!0,d=e.map(m=>{if(!c)return!1;let g=this.dataManager.translateTrimmedRow(m);return c=this.shouldAllowMoving(g,a),g}),u=d.indexOf(a)===-1;if(!c||!u)return!1;let h=this.getBaseParent(d),p=this.getTargetParent(s,a),f=h===p;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(p),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(d,a,f),this.moveRows(d,a,p),this.dataManager.rewriteCache(),this.moveCellsMeta(d,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,i,r,n,n&&this.isRowOrderChanged(e,i)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){let{rows:i,finalIndex:r,dropIndex:n,movePossible:o}=e,s=!1;return Qi(n)&&(Zi(Ai`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",i,r,n,o,!1),s=!0),s}shouldAllowMoving(e,i){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===i||i===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,i){let r=this.dataManager.getRowParent(e?i-1:i);return r==null&&(r=this.dataManager.getRowParent(i-1)),r}shiftCollapsibleParentsLocations(e,i,r){r||(Math.max(...e)<=i?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],i,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(i,e[0],e.length))}moveRows(e,i,r){let n=i===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,i,this.movedToCollapsed,n)})})}moveCellsMeta(e,i){let r=[],n=Math.max(...e)<i;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(i-(n?r.length:0),0,...r)}selectCells(e,i){let r=e.length,n=0,o=0,s=null,a=null;if(this.movedToCollapsed){let c=null;e[r-1]<i?c=this.dataManager.translateTrimmedRow(i-r):c=this.dataManager.translateTrimmedRow(i);let d=this.dataManager.getRowParent(c===null?this.hot.countSourceRows()-1:c-1),u=this.dataManager.getRowIndex(d);n=this.dataManager.untranslateTrimmedRow(u),o=n}else e[r-1]<i?(o=i-1,n=o-r+1):(n=i,o=n+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(n,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,i){return e.some((r,n)=>r-n!==i)}};function iyt(t,e){nTe(t,e),e.add(t)}function tTe(t,e,i){nTe(t,e),e.set(t,i)}function nTe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gK(t,e,i){return e=ryt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ryt(t){var e=nyt(t,"string");return typeof e=="symbol"?e:e+""}function nyt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l4(t,e){return t.get(Ws(t,e))}function c4(t,e,i){return t.set(Ws(t,e),i),i}function Ws(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var PO="nestedRows",oTe=300,iTe=PO,oyt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",d4=new WeakMap,tE=new WeakMap,ua=new WeakSet,LO=class extends Zt{constructor(){super(...arguments),iyt(this,ua),gK(this,"dataManager",null),gK(this,"headersUI",null),gK(this,"collapsedRowsMap",null),tTe(this,d4,!1),tTe(this,tE,!1)}static get PLUGIN_KEY(){return PO}static get PLUGIN_PRIORITY(){return oTe}isEnabled(){return!!this.hot.getSettings()[PO]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new au),this.dataManager=new KEe(this,this.hot),this.collapsingUI=new QEe(this,this.hot),this.headersUI=new o4(this,this.hot),this.contextMenuUI=new eTe(this,this.hot),this.rowMoveController=new a4(this),this.addHook("afterInit",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,_yt).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,yyt).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,lyt).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,cyt).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,dyt).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,ayt).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,fyt).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,hyt).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,pyt).call(e,...r)}),this.addHook("afterAddChild",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,myt).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,gyt).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,vyt).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,uyt).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,byt).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return Ws(ua,e,syt).call(e,...r)}),this.addHook("beforeLoadData",i=>Ws(ua,this,rTe).call(this,i)),this.addHook("beforeUpdateData",i=>Ws(ua,this,rTe).call(this,i)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();let e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast(),i=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(i)?this.collapsingUI.expandChildren(i):this.collapsingUI.collapseChildren(i),!1},runOnlyIf:()=>{var e,i;let r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:iTe,relativeToGroup:ul,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iTe)}disableCoreAPIModifiers(){c4(tE,this,!0)}enableCoreAPIModifiers(){c4(tE,this,!1)}onModifyRowData(e){if(!l4(tE,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!l4(tE,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,i,r){return l4(tE,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,i,r),!1)}destroy(){super.destroy()}};function syt(t,e,i,r){return this.rowMoveController.onBeforeRowMove(t,e,i,r)}function ayt(t,e,i){this.collapsingUI.toggleState(t,e,i)}function lyt(t,e,i){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*e),this.dataManager.filterData(t,e,i),c4(d4,this,!0),this.dataManager.getData().slice()}function cyt(t){return this.contextMenuUI.appendOptions(t)}function dyt(t,e){this.headersUI.appendLevelIndicators(t,e)}function uyt(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function hyt(t,e,i,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{c4(d4,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function fyt(t,e,i){let r=Array.from(i.reduce((n,o)=>{if(this.dataManager.isParent(o)){let s=this.dataManager.getDataObject(o).__children;return n.add(o),Array.isArray(s)&&s.forEach(a=>n.add(this.dataManager.getRowIndex(a))),n}return n.add(o)},new Set));i.length=0,i.push(...r)}function pyt(){this.collapsingUI.collapsedRowsStash.stash()}function myt(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function gyt(){this.collapsingUI.collapsedRowsStash.stash()}function vyt(t,e,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function byt(){this.dataManager.rewriteCache()}function _yt(){this.headersUI.updateRowHeaderWidth()}function yyt(t,e){l4(d4,this)&&(e.skipRender=!0)}function rTe(t){if(!vye(t)){f1(oyt),this.hot.getSettings()[PO]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}var pqi=U($e(),1);var cqi=U($e(),1),dqi=U(dt(),1),uqi=U(C5(),1);function vK(t,e,i){return e=wyt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function wyt(t){var e=Cyt(t,"string");return typeof e=="symbol"?e:e+""}function Cyt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bK=class{constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;vK(this,"rootWindow",void 0),vK(this,"prefix",void 0),vK(this,"savedKeys",[]),this.rootWindow=i,this.prefix=e,this.loadSavedKeys()}saveValue(e,i){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(i)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,i){let r=typeof e>"u"?i:e,n=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return n===null?void 0:JSON.parse(n)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Ce(this.savedKeys,(e,i)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[i]}`)}),this.clearSavedKeys()}loadSavedKeys(){let e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),i=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=i||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}},sTe=bK;function xyt(t,e,i){return e=Syt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Syt(t){var e=Eyt(t,"string");return typeof e=="symbol"?e:e+""}function Eyt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Ct.getSingleton().register("persistentStateSave");Ct.getSingleton().register("persistentStateLoad");Ct.getSingleton().register("persistentStateReset");var _K="persistentState",aTe=0,FO=class extends Zt{constructor(){super(...arguments),xyt(this,"storage",void 0)}static get PLUGIN_KEY(){return _K}static get PLUGIN_PRIORITY(){return aTe}isEnabled(){return!!this.hot.getSettings()[_K]}enablePlugin(){this.enabled||(this.storage||(this.storage=new sTe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,i)=>this.saveValue(e,i)),this.addHook("persistentStateLoad",(e,i)=>this.loadValue(e,i)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,i){i.value=this.storage.loadValue(e)}saveValue(e,i){this.storage.saveValue(e,i)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}};var wqi=U($e(),1),Cqi=U(dt(),1);function Tyt(t,e){Ryt(t,e),e.add(t)}function Ryt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yK(t,e,i){return e=Ayt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ayt(t){var e=Iyt(t,"string");return typeof e=="symbol"?e:e+""}function Iyt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lTe(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var u4="search",dTe=190,Dyt="htSearchResult",Myt=function(t,e,i,r,n){t.getCellMeta(e,i).isSearchResult=n},kyt=function(t,e,i){return Qi(t)||t===null||!t.toLocaleLowerCase||t.length===0||Qi(e)||e===null?!1:e.toString().toLocaleLowerCase(i.locale).indexOf(t.toLocaleLowerCase(i.locale))!==-1},wK=new WeakSet,HO=class extends Zt{constructor(){super(...arguments),Tyt(this,wK),yK(this,"callback",Myt),yK(this,"queryMethod",kyt),yK(this,"searchResultClass",Dyt)}static get PLUGIN_KEY(){return u4}static get PLUGIN_PRIORITY(){return dTe}isEnabled(){return this.hot.getSettings()[u4]}enablePlugin(){var e=this;if(this.enabled)return;let i=this.hot.getSettings()[u4];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return lTe(wK,e,cTe).call(e,...n)}),super.enablePlugin()}disablePlugin(){var e=this;let i=function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return lTe(wK,e,cTe).call(e,...n)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",i)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),n=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return _t(0,n-1,c=>{_t(0,o-1,d=>{let u=this.hot.getDataAtCell(c,d),h=this.hot.getCellMeta(c,d),p=h.search.callback||i,m=(h.search.queryMethod||r)(e,u,h);if(m){let g={row:c,col:d,data:u};s.push(g)}p&&p(a,c,d,u,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Xt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}};function cTe(t,e,i,r,n,o){let s=o.className||[],a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}var Dqi=U($e(),1),Mqi=U(dt(),1);function Oyt(t,e){Nyt(t,e),e.add(t)}function Nyt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h4(t,e,i){return e=Pyt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Pyt(t){var e=Lyt(t,"string");return typeof e=="symbol"?e:e+""}function Lyt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CK(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var uTe="touchScroll",hTe=200,f4=new WeakSet,BO=class extends Zt{constructor(){super(...arguments),Oyt(this,f4),h4(this,"scrollbars",[]),h4(this,"clones",[]),h4(this,"lockedCollection",!1),h4(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return uTe}static get PLUGIN_PRIORITY(){return hTe}static get SETTING_KEYS(){return!0}isEnabled(){return S5()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>CK(f4,this,Fyt).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>CK(f4,this,Hyt).call(this)),this.addHook("afterMomentumScroll",()=>CK(f4,this,Byt).call(this))}};function Fyt(){if(this.lockedCollection)return;let{topOverlay:t,bottomOverlay:e,inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(i),r&&this.scrollbars.push(r),n&&n.clone&&this.scrollbars.push(n),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&n.clone&&this.clones.push(n.clone.wtTable.holder.parentNode)}function Hyt(){this.freezeOverlays=!0,Ce(this.clones,t=>{Qe(t,"hide-tween")})}function Byt(){this.freezeOverlays=!1,Ce(this.clones,t=>{Gt(t,"hide-tween"),Qe(t,"show-tween")}),this.hot._registerTimeout(()=>{Ce(this.clones,t=>{Gt(t,"show-tween")})},400),Ce(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}var Bqi=U($e(),1),Vqi=U(dt(),1),jqi=U(ln(),1),zqi=U(cn(),1),Wqi=U(dn(),1),Uqi=U(un(),1),qqi=U(hn(),1),Yqi=U(fn(),1),$qi=U(pn(),1);function Vyt(t,e){jyt(t,e),e.add(t)}function jyt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zyt(t,e,i){return e=Wyt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Wyt(t){var e=Uyt(t,"string");return typeof e=="symbol"?e:e+""}function Uyt(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qyt(t,e,i){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}var VO="trimRows",pTe=330,fTe=new WeakSet,jO=class extends Zt{constructor(){super(...arguments),Vyt(this,fTe),zyt(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return VO}static get PLUGIN_PRIORITY(){return pTe}isEnabled(){return!!this.hot.getSettings()[VO]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new au),this.trimmedRowsMap.addLocalHook("init",()=>qyt(fTe,this,Yyt).call(this)),super.enablePlugin())}updatePlugin(){let e=this.hot.getSettings()[VO];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),Ce(e,i=>{this.trimmedRowsMap.setValueAtIndex(i,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){let i=this.getTrimmedRows(),r=this.isValidConfig(e),n=i;r&&(n=Array.from(new Set(i.concat(e)))),this.hot.runHooks("beforeTrimRow",i,n,r)!==!1&&(r&&this.hot.batchExecution(()=>{Ce(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",i,n,r,r&&n.length>i.length))}trimRow(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];this.trimRows(i)}untrimRows(e){let i=this.getTrimmedRows(),r=this.isValidConfig(e),n=i,o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(Ce(e,c=>{o[c]=!1}),n=Gr(o,(c,d,u)=>(d&&c.push(u),c),[])),this.hot.runHooks("beforeUntrimRow",i,n,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",i,n,r&&s,r&&n.length<i.length))}untrimRow(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];this.untrimRows(i)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){let i=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<i)}destroy(){super.destroy()}};function Yyt(){let t=this.hot.getSettings()[VO];Array.isArray(t)&&this.hot.batchExecution(()=>{Ce(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var r7i=U(dt(),1),n7i=U(vTe(),1);var bTe="undoRedo",_Te="undoRedo";function Pt(t){let e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,n){let o=r&&r.length;if(!o||!r.find(c=>{let[,,d,u]=c;return d!==u}))return;let a=()=>{let c=r.reduce((u,h)=>(u.push([...h]),u),[]);Ce(c,u=>{u[1]=t.propToCol(u[1])});let d=o>1?this.getSelected():[[c[0][0],c[0][1]]];return new Pt.ChangeAction(c,d)};e.done(a,n)}),t.addHook("afterCreateRow",(r,n,o)=>{e.done(()=>new Pt.CreateRowAction(r,n),o)});let i=(r,n,o,s)=>{let a=["visualRow","visualCol","row","col","prop"],c=a.length,d=[];return _t(o,s,u=>{_t(r,n,h=>{let p=t.getCellMeta(h,u);if(Object.keys(p).length!==c){let f=Object.fromEntries(Object.entries(p).filter(m=>{let[g]=m;return a.includes(g)===!1}));d.push([p.visualRow,p.visualCol,f])}})}),d};t.addHook("beforeRemoveRow",(r,n,o,s)=>{let a=()=>{let c=t.toPhysicalRow(r),d=c+n-1,u=Wo(e.instance.getSourceData(c,0,c+n-1,e.instance.countSourceCols()-1));return new Pt.RemoveRowAction(c,u,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),i(c,d,0,t.countCols()-1))};e.done(a,s)}),t.addHook("afterCreateCol",(r,n,o)=>{e.done(()=>new Pt.CreateColumnAction(r,n),o)}),t.addHook("beforeRemoveCol",(r,n,o,s)=>{let a=()=>{let c=e.instance.getSourceDataArray(),d=(e.instance.countCols()+r)%e.instance.countCols(),u=d+n-1,h=[],p=[],f=[];_t(c.length-1,y=>{let w=[],x=c[y];_t(d,u,T=>{w.push(x[t.toPhysicalColumn(T)])}),h.push(w)}),_t(n-1,y=>{f.push(t.toPhysicalColumn(d+y))}),Array.isArray(t.getSettings().colHeaders)&&_t(n-1,y=>{p.push(t.getSettings().colHeaders[t.toPhysicalColumn(d+y)]||null)});let m=t.columnIndexMapper.getIndexesSequence(),g=t.rowIndexMapper.getIndexesSequence();return new Pt.RemoveColumnAction(d,f,h,p,m,g,t.getSettings().fixedColumnsStart,i(0,t.countRows(),d,u))};e.done(a,s)}),t.addHook("beforeCellAlignment",(r,n,o,s)=>{e.done(()=>new Pt.CellAlignmentAction(r,n,o,s))}),t.addHook("beforeFilter",r=>{e.done(()=>new Pt.FiltersAction(r))}),t.addHook("beforeRowMove",(r,n)=>{r!==!1&&e.done(()=>new Pt.RowMoveAction(r,n))}),t.addHook("beforeColumnMove",(r,n)=>{r!==!1&&e.done(()=>new Pt.ColumnMoveAction(r,n))}),t.addHook("beforeMergeCells",(r,n)=>{n||e.done(()=>new Pt.MergeCellsAction(t,r))}),t.addHook("afterUnmergeCells",(r,n)=>{n||e.done(()=>new Pt.UnmergeCellsAction(t,r))}),t.addHook("afterInit",()=>{e.init()})}Pt.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;let r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;let o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};Pt.prototype.undo=function(){if(this.isUndoAvailable()){let t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);let e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());let i=Wo(e);if(this.instance.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;let n=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{n.ignoreNewActions=!1,n.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",i)}};Pt.prototype.redo=function(){if(this.isRedoAvailable()){let t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);let e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());let i=Wo(e);if(this.instance.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;let n=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{n.ignoreNewActions=!1,n.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",i)}};Pt.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Pt.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Pt.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Pt.prototype.isEnabled=function(){return this.enabled};Pt.prototype.enable=function(){if(this.isEnabled())return;let t=this.instance;this.enabled=!0,Jyt(t),this.registerShortcuts(),t.addHook("afterChange",yTe)};Pt.prototype.disable=function(){if(!this.isEnabled())return;let t=this.instance;this.enabled=!1,ewt(t),this.unregisterShortcuts(),t.removeHook("afterChange",yTe)};Pt.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Pt.Action=function(){};Pt.Action.prototype.undo=function(){};Pt.Action.prototype.redo=function(){};Pt.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Ju(Pt.ChangeAction,Pt.Action);Pt.ChangeAction.prototype.undo=function(t,e){let i=Wo(this.changes),r=t.countEmptyRows(!0),n=t.countEmptyCols(!0);for(let s=0,a=i.length;s<a;s++)i[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(i,null,null,"UndoRedo.undo");for(let s=0,a=i.length;s<a;s++){let[c,d]=i[s];t.getSettings().minSpareRows&&c+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(c+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&d+1+t.getSettings().minSpareCols===t.countCols()&&n===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(d+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}let o=t.getSelectedLast();if(o!==void 0){let[s,a]=i[0],[c,d]=o,u=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),p=s>=u,f=a>=h;if((p&&f)===!1&&(c!==s||d!==a)===!0){let y={row:s,col:a};p===!1&&(y.verticalSnap="top"),f===!1&&(y.horizontalSnap="start"),t.scrollViewportTo(y)}}t.selectCells(this.selected,!1,!1)};Pt.ChangeAction.prototype.redo=function(t,e){let i=Wo(this.changes);for(let r=0,n=i.length;r<n;r++)i[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};Pt.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Ju(Pt.CreateRowAction,Pt.Action);Pt.CreateRowAction.prototype.undo=function(t,e){let i=t.countRows(),r=t.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Pt.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};Pt.RemoveRowAction=function(t,e,i,r,n,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=i,this.fixedRowsTop=r,this.rowIndexesSequence=n,this.removedCellMetas=o};Ju(Pt.RemoveRowAction,Pt.Action);Pt.RemoveRowAction.prototype.undo=function(t,e){let i=t.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((n,o)=>{Object.keys(n).forEach(s=>{let a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,n[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(n=>{let[o,s,a]=n;t.setCellMetaObject(o,s,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};Pt.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Pt.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Ju(Pt.CreateColumnAction,Pt.Action);Pt.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Pt.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};Pt.RemoveColumnAction=function(t,e,i,r,n,o,s,a){this.index=t,this.indexes=e,this.data=i,this.amount=this.data[0].length,this.headers=r,this.columnPositions=n.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a};Ju(Pt.RemoveColumnAction,Pt.Action);Pt.RemoveColumnAction.prototype.undo=function(t,e){let i=t.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;let r=this.indexes.slice(0).sort(),n=(d,u,h)=>h[this.indexes.indexOf(r[u])],o=this.data.length,s=[];for(let d=0;d<o;d++)s.push(ri(this.data[d],n));let a=ri(this.headers,n),c=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Ce(t.getSourceDataArray(),(d,u)=>{Ce(r,(h,p)=>{d[h]=s[u][p],c.push([u,h,d[h]])})}),t.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&Ce(a,(d,u)=>{t.getSettings().colHeaders[r[u]]=d}),this.removedCellMetas.forEach(d=>{let[u,h,p]=d;t.setCellMetaObject(u,h,p)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};Pt.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Pt.CellAlignmentAction=function(t,e,i,r){this.stateBefore=t,this.range=e,this.type=i,this.alignment=r};Pt.CellAlignmentAction.prototype.undo=function(t,e){Ce(this.range,i=>{i.forAll((r,n)=>{r>=0&&n>=0&&t.setCellMeta(r,n,"className",this.stateBefore[r][n]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};Pt.CellAlignmentAction.prototype.redo=function(t,e){zf(this.range,this.type,this.alignment,(i,r)=>t.getCellMeta(i,r),(i,r,n,o)=>t.setCellMeta(i,r,n,o)),t.addHookOnce("afterViewRender",e),t.render()};Pt.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Ju(Pt.FiltersAction,Pt.Action);Pt.FiltersAction.prototype.undo=function(t,e){let i=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),i.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),i.filter()};Pt.FiltersAction.prototype.redo=function(t,e){let i=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),i.conditionCollection.importAllConditions(this.conditionsStack),i.filter()};var xK=class extends Pt.Action{constructor(e,i){super(),this.cellRange=i;let r=this.cellRange.getTopStartCorner(),n=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,n.row,n.col)}undo(e,i){let r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",i),r.unmergeRange(this.cellRange,!0);let n=this.cellRange.getTopStartCorner();e.populateFromArray(n.row,n.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,i){let r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",i),r.mergeRange(this.cellRange)}};Pt.MergeCellsAction=xK;var SK=class extends Pt.Action{constructor(e,i){super(),this.cellRange=i}undo(e,i){let r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",i),r.mergeRange(this.cellRange,!0)}redo(e,i){let r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",i),r.unmergeRange(this.cellRange,!0),e.render()}};Pt.UnmergeCellsAction=SK;Pt.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Ju(Pt.RowMoveAction,Pt.Action);Pt.RowMoveAction.prototype.undo=function(t,e){let i=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),Yk(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(n=>{let{from:o,to:s}=n;o<s&&(s-=1),i.moveRow(s,o)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Pt.RowMoveAction.prototype.redo=function(t,e){let i=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),i.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};Pt.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Ju(Pt.ColumnMoveAction,Pt.Action);Pt.ColumnMoveAction.prototype.undo=function(t,e){let i=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),Yk(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(n=>{let{from:o,to:s}=n;o<s&&(s-=1),i.moveColumn(s,o)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};Pt.ColumnMoveAction.prototype.redo=function(t,e){let i=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),i.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};Pt.prototype.init=function(){let t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};Pt.prototype.registerShortcuts=function(){let e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:n=>!n.altKey,group:bTe};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};Pt.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(bTe)};function yTe(t,e){let i=this;if(e==="loadData")return i.undoRedo.clear()}function Jyt(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function ewt(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}var zO=Ct.getSingleton();zO.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});zO.register("beforeUndo");zO.register("afterUndo");zO.register("beforeRedo");zO.register("afterRedo");Pt.PLUGIN_KEY=_Te;Pt.SETTING_KEYS=!0;var EK=Pt;function wTe(){Or(VM),Or(zM),Or(qM),Or(YM),Or(XM),Or(_y),Or(nk),Or(ak),Or(yS),Or(_k),Or(wk),Or(Ck),Or(AS),Or(Sk),Or(Uk),Or(Xk),Or(Zk),Or(Jk),Or(eO),Or(iO),Or(aO),Or(lO),Or(pO),Or(yO),Or(CO),Or(xO),Or(OO),Or(LO),Or(FO),Or(HO),Or(BO),Or(jO),Or(EK)}function p4(){HCe(),WCe(),$Ce(),XCe(),wTe()}var twt=["mat-calendar-body",""];function iwt(t,e){return this._trackRow(e)}var ITe=(t,e)=>e.id;function rwt(t,e){if(t&1&&(ae(0,"tr",0)(1,"td",3),_e(2),ne()()),t&2){let i=$t();Ye(),tl("padding-top",i._cellPadding)("padding-bottom",i._cellPadding),mi("colspan",i.numCols),Ye(),ji(" ",i.label," ")}}function nwt(t,e){if(t&1&&(ae(0,"td",3),_e(1),ne()),t&2){let i=$t(2);tl("padding-top",i._cellPadding)("padding-bottom",i._cellPadding),mi("colspan",i._firstRowOffset),Ye(),ji(" ",i._firstRowOffset>=i.labelMinRequiredCells?i.label:""," ")}}function owt(t,e){if(t&1){let i=eo();ae(0,"td",6)(1,"button",7),At("click",function(n){let o=_i(i).$implicit,s=$t(2);return yi(s._cellClicked(o,n))})("focus",function(n){let o=_i(i).$implicit,s=$t(2);return yi(s._emitActiveDateChange(o,n))}),ae(2,"span",8),_e(3),ne(),bt(4,"span",9),ne()()}if(t&2){let i=e.$implicit,r=e.$index,n=$t().$index,o=$t();tl("width",o._cellWidth)("padding-top",o._cellPadding)("padding-bottom",o._cellPadding),mi("data-mat-row",n)("data-mat-col",r),Ye(),hi("mat-calendar-body-disabled",!i.enabled)("mat-calendar-body-active",o._isActiveCell(n,r))("mat-calendar-body-range-start",o._isRangeStart(i.compareValue))("mat-calendar-body-range-end",o._isRangeEnd(i.compareValue))("mat-calendar-body-in-range",o._isInRange(i.compareValue))("mat-calendar-body-comparison-bridge-start",o._isComparisonBridgeStart(i.compareValue,n,r))("mat-calendar-body-comparison-bridge-end",o._isComparisonBridgeEnd(i.compareValue,n,r))("mat-calendar-body-comparison-start",o._isComparisonStart(i.compareValue))("mat-calendar-body-comparison-end",o._isComparisonEnd(i.compareValue))("mat-calendar-body-in-comparison-range",o._isInComparisonRange(i.compareValue))("mat-calendar-body-preview-start",o._isPreviewStart(i.compareValue))("mat-calendar-body-preview-end",o._isPreviewEnd(i.compareValue))("mat-calendar-body-in-preview",o._isInPreview(i.compareValue)),ht("ngClass",i.cssClasses)("tabindex",o._isActiveCell(n,r)?0:-1),mi("aria-label",i.ariaLabel)("aria-disabled",!i.enabled||null)("aria-pressed",o._isSelected(i.compareValue))("aria-current",o.todayValue===i.compareValue?"date":null)("aria-describedby",o._getDescribedby(i.compareValue)),Ye(),hi("mat-calendar-body-selected",o._isSelected(i.compareValue))("mat-calendar-body-comparison-identical",o._isComparisonIdentical(i.compareValue))("mat-calendar-body-today",o.todayValue===i.compareValue),Ye(),ji(" ",i.displayValue," ")}}function swt(t,e){if(t&1&&(ae(0,"tr",1),wi(1,nwt,2,6,"td",4),rA(2,owt,5,48,"td",5,ITe),ne()),t&2){let i=e.$implicit,r=e.$index,n=$t();Ye(),Mr(r===0&&n._firstRowOffset?1:-1),Ye(),nA(i)}}function awt(t,e){if(t&1&&(ae(0,"th",2)(1,"span",6),_e(2),ne(),ae(3,"span",3),_e(4),ne()()),t&2){let i=e.$implicit;Ye(2),zn(i.long),Ye(2),zn(i.narrow)}}var lwt=["*"];function cwt(t,e){}function dwt(t,e){if(t&1){let i=eo();ae(0,"mat-month-view",4),QC("activeDateChange",function(n){_i(i);let o=$t();return ZC(o.activeDate,n)||(o.activeDate=n),yi(n)}),At("_userSelection",function(n){_i(i);let o=$t();return yi(o._dateSelected(n))})("dragStarted",function(n){_i(i);let o=$t();return yi(o._dragStarted(n))})("dragEnded",function(n){_i(i);let o=$t();return yi(o._dragEnded(n))}),ne()}if(t&2){let i=$t();KC("activeDate",i.activeDate),ht("selected",i.selected)("dateFilter",i.dateFilter)("maxDate",i.maxDate)("minDate",i.minDate)("dateClass",i.dateClass)("comparisonStart",i.comparisonStart)("comparisonEnd",i.comparisonEnd)("startDateAccessibleName",i.startDateAccessibleName)("endDateAccessibleName",i.endDateAccessibleName)("activeDrag",i._activeDrag)}}function uwt(t,e){if(t&1){let i=eo();ae(0,"mat-year-view",5),QC("activeDateChange",function(n){_i(i);let o=$t();return ZC(o.activeDate,n)||(o.activeDate=n),yi(n)}),At("monthSelected",function(n){_i(i);let o=$t();return yi(o._monthSelectedInYearView(n))})("selectedChange",function(n){_i(i);let o=$t();return yi(o._goToDateInView(n,"month"))}),ne()}if(t&2){let i=$t();KC("activeDate",i.activeDate),ht("selected",i.selected)("dateFilter",i.dateFilter)("maxDate",i.maxDate)("minDate",i.minDate)("dateClass",i.dateClass)}}function hwt(t,e){if(t&1){let i=eo();ae(0,"mat-multi-year-view",6),QC("activeDateChange",function(n){_i(i);let o=$t();return ZC(o.activeDate,n)||(o.activeDate=n),yi(n)}),At("yearSelected",function(n){_i(i);let o=$t();return yi(o._yearSelectedInMultiYearView(n))})("selectedChange",function(n){_i(i);let o=$t();return yi(o._goToDateInView(n,"year"))}),ne()}if(t&2){let i=$t();KC("activeDate",i.activeDate),ht("selected",i.selected)("dateFilter",i.dateFilter)("maxDate",i.maxDate)("minDate",i.minDate)("dateClass",i.dateClass)}}function fwt(t,e){}var pwt=["button"],mwt=[[["","matDatepickerToggleIcon",""]]],gwt=["[matDatepickerToggleIcon]"];function vwt(t,e){t&1&&(cf(),ae(0,"svg",2),bt(1,"path",3),ne())}var YO=(()=>{let e=class e{constructor(){this.changes=new Ft,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(r,n){return`${r} \u2013 ${n}`}formatYearRangeLabel(r,n){return`${r} to ${n}`}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),bwt=0,UO=class{constructor(e,i,r,n,o={},s=e,a){this.value=e,this.displayValue=i,this.ariaLabel=r,this.enabled=n,this.cssClasses=o,this.compareValue=s,this.rawValue=a,this.id=bwt++}},_wt=1,CTe=pc({passive:!1,capture:!0}),Lb=pc({passive:!0,capture:!0}),m4=pc({passive:!0}),rE=(()=>{let e=class e{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(r,n){this._elementRef=r,this._ngZone=n,this._platform=Jt(yr),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new Nt,this.previewChange=new Nt,this.activeDateChange=new Nt,this.dragStarted=new Nt,this.dragEnded=new Nt,this._didDragSinceMouseDown=!1,this._injector=Jt(kn),this._trackRow=o=>o,this._enterHandler=o=>{if(this._skipNextFocus&&o.type==="focus"){this._skipNextFocus=!1;return}if(o.target&&this.isRange){let s=this._getCellFromElement(o.target);s&&this._ngZone.run(()=>this.previewChange.emit({value:s.enabled?s:null,event:o}))}},this._touchmoveHandler=o=>{if(!this.isRange)return;let s=xTe(o),a=s?this._getCellFromElement(s):null;s!==o.target&&(this._didDragSinceMouseDown=!0),RK(o.target)&&o.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:a?.enabled?a:null,event:o}))},this._leaveHandler=o=>{this.previewEnd!==null&&this.isRange&&(o.type!=="blur"&&(this._didDragSinceMouseDown=!0),o.target&&this._getCellFromElement(o.target)&&!(o.relatedTarget&&this._getCellFromElement(o.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:o})))},this._mousedownHandler=o=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;let s=o.target&&this._getCellFromElement(o.target);!s||!this._isInRange(s.compareValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:s.rawValue,event:o})})},this._mouseupHandler=o=>{if(!this.isRange)return;let s=RK(o.target);if(!s){this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:o})});return}s.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{let a=this._getCellFromElement(s);this.dragEnded.emit({value:a?.rawValue??null,event:o})})},this._touchendHandler=o=>{let s=xTe(o);s&&this._mouseupHandler({target:s})},this._id=`mat-calendar-body-${_wt++}`,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,n.runOutsideAngular(()=>{let o=r.nativeElement;o.addEventListener("touchmove",this._touchmoveHandler,CTe),o.addEventListener("mouseenter",this._enterHandler,Lb),o.addEventListener("focus",this._enterHandler,Lb),o.addEventListener("mouseleave",this._leaveHandler,Lb),o.addEventListener("blur",this._leaveHandler,Lb),o.addEventListener("mousedown",this._mousedownHandler,m4),o.addEventListener("touchstart",this._mousedownHandler,m4),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(r,n){this._didDragSinceMouseDown||r.enabled&&this.selectedValueChange.emit({value:r.value,event:n})}_emitActiveDateChange(r,n){r.enabled&&this.activeDateChange.emit({value:r.value,event:n})}_isSelected(r){return this.startValue===r||this.endValue===r}ngOnChanges(r){let n=r.numCols,{rows:o,numCols:s}=this;(r.rows||n)&&(this._firstRowOffset=o&&o.length&&o[0].length?s-o[0].length:0),(r.cellAspectRatio||n||!this._cellPadding)&&(this._cellPadding=`${50*this.cellAspectRatio/s}%`),(n||!this._cellWidth)&&(this._cellWidth=`${100/s}%`)}ngOnDestroy(){let r=this._elementRef.nativeElement;r.removeEventListener("touchmove",this._touchmoveHandler,CTe),r.removeEventListener("mouseenter",this._enterHandler,Lb),r.removeEventListener("focus",this._enterHandler,Lb),r.removeEventListener("mouseleave",this._leaveHandler,Lb),r.removeEventListener("blur",this._leaveHandler,Lb),r.removeEventListener("mousedown",this._mousedownHandler,m4),r.removeEventListener("touchstart",this._mousedownHandler,m4),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(r,n){let o=r*this.numCols+n;return r&&(o-=this._firstRowOffset),o==this.activeCell}_focusActiveCell(r=!0){ed(()=>{setTimeout(()=>{let n=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");n&&(r||(this._skipNextFocus=!0),n.focus())})},{injector:this._injector})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(r){return AK(r,this.startValue,this.endValue)}_isRangeEnd(r){return IK(r,this.startValue,this.endValue)}_isInRange(r){return DK(r,this.startValue,this.endValue,this.isRange)}_isComparisonStart(r){return AK(r,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(r,n,o){if(!this._isComparisonStart(r)||this._isRangeStart(r)||!this._isInRange(r))return!1;let s=this.rows[n][o-1];if(!s){let a=this.rows[n-1];s=a&&a[a.length-1]}return s&&!this._isRangeEnd(s.compareValue)}_isComparisonBridgeEnd(r,n,o){if(!this._isComparisonEnd(r)||this._isRangeEnd(r)||!this._isInRange(r))return!1;let s=this.rows[n][o+1];if(!s){let a=this.rows[n+1];s=a&&a[0]}return s&&!this._isRangeStart(s.compareValue)}_isComparisonEnd(r){return IK(r,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(r){return DK(r,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(r){return this.comparisonStart===this.comparisonEnd&&r===this.comparisonStart}_isPreviewStart(r){return AK(r,this.previewStart,this.previewEnd)}_isPreviewEnd(r){return IK(r,this.previewStart,this.previewEnd)}_isInPreview(r){return DK(r,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(r){return this.isRange?this.startValue===r&&this.endValue===r?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===r?this._startDateLabelId:this.endValue===r?this._endDateLabelId:null:null}_getCellFromElement(r){let n=RK(r);if(n){let o=n.getAttribute("data-mat-row"),s=n.getAttribute("data-mat-col");if(o&&s)return this.rows[parseInt(o)][parseInt(s)]}return null}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(ni))},e.\u0275cmp=Tt({type:e,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],standalone:!0,features:[Li,zt],attrs:twt,decls:7,vars:5,consts:[["aria-hidden","true"],["role","row"],[1,"mat-calendar-body-hidden-label",3,"id"],[1,"mat-calendar-body-label"],[1,"mat-calendar-body-label",3,"paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"click","focus","ngClass","tabindex"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(n,o){n&1&&(wi(0,rwt,3,6,"tr",0),rA(1,swt,4,1,"tr",1,iwt,!0),ae(3,"span",2),_e(4),ne(),ae(5,"span",2),_e(6),ne()),n&2&&(Mr(o._firstRowOffset<o.labelMinRequiredCells?0:-1),Ye(),nA(o.rows),Ye(2),ht("id",o._startDateLabelId),Ye(),ji(" ",o.startDateAccessibleName,`
`),Ye(),ht("id",o._endDateLabelId),Ye(),ji(" ",o.endDateAccessibleName,`
`))},dependencies:[JC],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color, var(--mat-app-primary))}.mat-calendar-body-label{height:0;line-height:0;text-align:start;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-datepicker-calendar-body-label-text-weight, var(--mat-app-title-small-weight));color:var(--mat-datepicker-calendar-body-label-text-color, var(--mat-app-on-surface))}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0;font-family:var(--mat-datepicker-calendar-text-font, var(--mat-app-body-medium-font));font-size:var(--mat-datepicker-calendar-text-size, var(--mat-app-body-medium-size))}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color, var(--mat-app-primary))}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color)}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color, var(--mat-app-on-surface));border-color:var(--mat-datepicker-calendar-date-outline-color)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color)}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color)}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color, var(--mat-app-primary));color:var(--mat-datepicker-calendar-date-selected-state-text-color, var(--mat-app-on-primary))}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color)}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color, var(--mat-app-primary))}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-app-primary-container))}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-app-tertiary-container))}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-app-tertiary-container))}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-app-primary-container)) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-app-tertiary-container)) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-app-primary-container)) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-app-tertiary-container)) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color, var(--mat-app-secondary-container))}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color, var(--mat-app-secondary))}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}'],encapsulation:2,changeDetection:0});let t=e;return t})();function TK(t){return t?.nodeName==="TD"}function RK(t){let e;return TK(t)?e=t:TK(t.parentNode)?e=t.parentNode:TK(t.parentNode?.parentNode)&&(e=t.parentNode.parentNode),e?.getAttribute("data-mat-row")!=null?e:null}function AK(t,e,i){return i!==null&&e!==i&&t<i&&t===e}function IK(t,e,i){return e!==null&&e!==i&&t>=e&&t===i}function DK(t,e,i,r){return r&&e!==null&&i!==null&&e!==i&&t>=e&&t<=i}function xTe(t){let e=t.changedTouches[0];return document.elementFromPoint(e.clientX,e.clientY)}var yu=class{constructor(e,i){this.start=e,this.end=i}},qO=(()=>{let e=class e{constructor(r,n){this.selection=r,this._adapter=n,this._selectionChanged=new Ft,this.selectionChanged=this._selectionChanged,this.selection=r}updateSelection(r,n){let o=this.selection;this.selection=r,this._selectionChanged.next({selection:r,source:n,oldValue:o})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(r){return this._adapter.isDateInstance(r)&&this._adapter.isValid(r)}};e.\u0275fac=function(n){tA()},e.\u0275prov=kt({token:e,factory:e.\u0275fac});let t=e;return t})(),ywt=(()=>{let e=class e extends qO{constructor(r){super(null,r)}add(r){super.updateSelection(r,this)}isValid(){return this.selection!=null&&this._isValidDateInstance(this.selection)}isComplete(){return this.selection!=null}clone(){let r=new e(this._adapter);return r.updateSelection(this.selection,this),r}};e.\u0275fac=function(n){return new(n||e)(lt(ea))},e.\u0275prov=kt({token:e,factory:e.\u0275fac});let t=e;return t})();function wwt(t,e){return t||new ywt(e)}var DTe={provide:qO,deps:[[new QR,new JR,qO],ea],useFactory:wwt};var MTe=new St("MAT_DATE_RANGE_SELECTION_STRATEGY");var MK=7,Cwt=0,STe=(()=>{let e=class e{get activeDate(){return this._activeDate}set activeDate(r){let n=this._activeDate,o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),this._hasSameMonthAndYear(n,this._activeDate)||this._init()}get selected(){return this._selected}set selected(r){r instanceof yu?this._selected=r:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(r){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}get maxDate(){return this._maxDate}set maxDate(r){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}constructor(r,n,o,s,a){this._changeDetectorRef=r,this._dateFormats=n,this._dateAdapter=o,this._dir=s,this._rangeStrategy=a,this._rerenderSubscription=jn.EMPTY,this.activeDrag=null,this.selectedChange=new Nt,this._userSelection=new Nt,this.dragStarted=new Nt,this.dragEnded=new Nt,this.activeDateChange=new Nt,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Fs(null)).subscribe(()=>this._init())}ngOnChanges(r){let n=r.comparisonStart||r.comparisonEnd;n&&!n.firstChange&&this._setRanges(this.selected),r.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(r){let n=r.value,o=this._getDateFromDayOfMonth(n),s,a;this._selected instanceof yu?(s=this._getDateInCurrentMonth(this._selected.start),a=this._getDateInCurrentMonth(this._selected.end)):s=a=this._getDateInCurrentMonth(this._selected),(s!==n||a!==n)&&this.selectedChange.emit(o),this._userSelection.emit({value:o,event:r.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(r){let n=r.value,o=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(n),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(r){let n=this._activeDate,o=this._isRtl();switch(r.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=r.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=r.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:this._selectionKeyPressed=!0,this._canSelect(this._activeDate)&&r.preventDefault();return;case 27:this._previewEnd!=null&&!jo(r)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:r}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:r})),r.preventDefault(),r.stopPropagation());return;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),r.preventDefault()}_handleCalendarBodyKeyup(r){(r.keyCode===32||r.keyCode===13)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:r}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(MK+this._dateAdapter.getDayOfWeek(r)-this._dateAdapter.getFirstDayOfWeek())%MK,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(r){this._matCalendarBody._focusActiveCell(r)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:r,value:n}){if(this._rangeStrategy){let o=n?n.rawValue:null,s=this._rangeStrategy.createPreview(o,this.selected,r);if(this._previewStart=this._getCellCompareValue(s.start),this._previewEnd=this._getCellCompareValue(s.end),this.activeDrag&&o){let a=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,o,r);a&&(this._previewStart=this._getCellCompareValue(a.start),this._previewEnd=this._getCellCompareValue(a.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(r){if(this.activeDrag)if(r.value){let n=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,r.value,r.event);this.dragEnded.emit({value:n??null,event:r.event})}else this.dragEnded.emit({value:null,event:r.event})}_getDateFromDayOfMonth(r){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),r)}_initWeekdays(){let r=this._dateAdapter.getFirstDayOfWeek(),n=this._dateAdapter.getDayOfWeekNames("narrow"),s=this._dateAdapter.getDayOfWeekNames("long").map((a,c)=>({long:a,narrow:n[c],id:Cwt++}));this._weekdays=s.slice(r).concat(s.slice(0,r))}_createWeekCells(){let r=this._dateAdapter.getNumDaysInMonth(this.activeDate),n=this._dateAdapter.getDateNames();this._weeks=[[]];for(let o=0,s=this._firstWeekOffset;o<r;o++,s++){s==MK&&(this._weeks.push([]),s=0);let a=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),o+1),c=this._shouldEnableDate(a),d=this._dateAdapter.format(a,this._dateFormats.display.dateA11yLabel),u=this.dateClass?this.dateClass(a,"month"):void 0;this._weeks[this._weeks.length-1].push(new UO(o+1,n[o],d,c,u,this._getCellCompareValue(a),a))}}_shouldEnableDate(r){return!!r&&(!this.minDate||this._dateAdapter.compareDate(r,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(r,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(r))}_getDateInCurrentMonth(r){return r&&this._hasSameMonthAndYear(r,this.activeDate)?this._dateAdapter.getDate(r):null}_hasSameMonthAndYear(r,n){return!!(r&&n&&this._dateAdapter.getMonth(r)==this._dateAdapter.getMonth(n)&&this._dateAdapter.getYear(r)==this._dateAdapter.getYear(n))}_getCellCompareValue(r){if(r){let n=this._dateAdapter.getYear(r),o=this._dateAdapter.getMonth(r),s=this._dateAdapter.getDate(r);return new Date(n,o,s).getTime()}return null}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setRanges(r){r instanceof yu?(this._rangeStart=this._getCellCompareValue(r.start),this._rangeEnd=this._getCellCompareValue(r.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(r),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(r){return!this.dateFilter||this.dateFilter(r)}_clearPreview(){this._previewStart=this._previewEnd=null}};e.\u0275fac=function(n){return new(n||e)(Te(Xi),Te(Jp,8),Te(ea,8),Te(ss,8),Te(MTe,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-month-view"]],viewQuery:function(n,o){if(n&1&&Ii(rE,5),n&2){let s;ai(s=li())&&(o._matCalendarBody=s.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],standalone:!0,features:[Li,zt],decls:8,vars:14,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col"],["aria-hidden","true"],["colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown","label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName"],[1,"cdk-visually-hidden"]],template:function(n,o){n&1&&(ae(0,"table",0)(1,"thead",1)(2,"tr"),rA(3,awt,5,2,"th",2,ITe),ne(),ae(5,"tr",3),bt(6,"th",4),ne()(),ae(7,"tbody",5),At("selectedValueChange",function(a){return o._dateSelected(a)})("activeDateChange",function(a){return o._updateActiveDate(a)})("previewChange",function(a){return o._previewChanged(a)})("dragStarted",function(a){return o.dragStarted.emit(a)})("dragEnded",function(a){return o._dragEnded(a)})("keyup",function(a){return o._handleCalendarBodyKeyup(a)})("keydown",function(a){return o._handleCalendarBodyKeydown(a)}),ne()()),n&2&&(Ye(3),nA(o._weekdays),Ye(4),ht("label",o._monthLabel)("rows",o._weeks)("todayValue",o._todayDate)("startValue",o._rangeStart)("endValue",o._rangeEnd)("comparisonStart",o._comparisonRangeStart)("comparisonEnd",o._comparisonRangeEnd)("previewStart",o._previewStart)("previewEnd",o._previewEnd)("isRange",o._isRange)("labelMinRequiredCells",3)("activeCell",o._dateAdapter.getDate(o.activeDate)-1)("startDateAccessibleName",o.startDateAccessibleName)("endDateAccessibleName",o.endDateAccessibleName))},dependencies:[rE],encapsulation:2,changeDetection:0});let t=e;return t})(),_d=24,kK=4,ETe=(()=>{let e=class e{get activeDate(){return this._activeDate}set activeDate(r){let n=this._activeDate,o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),kTe(this._dateAdapter,n,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(r){r instanceof yu?this._selected=r:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r)),this._setSelectedYear(r)}get minDate(){return this._minDate}set minDate(r){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}get maxDate(){return this._maxDate}set maxDate(r){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}constructor(r,n,o){this._changeDetectorRef=r,this._dateAdapter=n,this._dir=o,this._rerenderSubscription=jn.EMPTY,this.selectedChange=new Nt,this.yearSelected=new Nt,this.activeDateChange=new Nt,this._dateAdapter,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Fs(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());let n=this._dateAdapter.getYear(this._activeDate)-WO(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let o=0,s=[];o<_d;o++)s.push(n+o),s.length==kK&&(this._years.push(s.map(a=>this._createCellForYear(a))),s=[]);this._changeDetectorRef.markForCheck()}_yearSelected(r){let n=r.value,o=this._dateAdapter.createDate(n,0,1),s=this._getDateFromYear(n);this.yearSelected.emit(o),this.selectedChange.emit(s)}_updateActiveDate(r){let n=r.value,o=this._activeDate;this.activeDate=this._getDateFromYear(n),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(r){let n=this._activeDate,o=this._isRtl();switch(r.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-kK);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,kK);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-WO(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,_d-WO(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r.altKey?-_d*10:-_d);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r.altKey?_d*10:_d);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),r.preventDefault()}_handleCalendarBodyKeyup(r){(r.keyCode===32||r.keyCode===13)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:r}),this._selectionKeyPressed=!1)}_getActiveCell(){return WO(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(r){let n=this._dateAdapter.getMonth(this.activeDate),o=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(r,n,1));return this._dateAdapter.createDate(r,n,Math.min(this._dateAdapter.getDate(this.activeDate),o))}_createCellForYear(r){let n=this._dateAdapter.createDate(r,0,1),o=this._dateAdapter.getYearName(n),s=this.dateClass?this.dateClass(n,"multi-year"):void 0;return new UO(r,o,o,this._shouldEnableYear(r),s)}_shouldEnableYear(r){if(r==null||this.maxDate&&r>this._dateAdapter.getYear(this.maxDate)||this.minDate&&r<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;let n=this._dateAdapter.createDate(r,0,1);for(let o=n;this._dateAdapter.getYear(o)==r;o=this._dateAdapter.addCalendarDays(o,1))if(this.dateFilter(o))return!0;return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedYear(r){if(this._selectedYear=null,r instanceof yu){let n=r.start||r.end;n&&(this._selectedYear=this._dateAdapter.getYear(n))}else r&&(this._selectedYear=this._dateAdapter.getYear(r))}};e.\u0275fac=function(n){return new(n||e)(Te(Xi),Te(ea,8),Te(ss,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-multi-year-view"]],viewQuery:function(n,o){if(n&1&&Ii(rE,5),n&2){let s;ai(s=li())&&(o._matCalendarBody=s.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],standalone:!0,features:[zt],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell"]],template:function(n,o){n&1&&(ae(0,"table",0)(1,"thead",1)(2,"tr"),bt(3,"th",2),ne()(),ae(4,"tbody",3),At("selectedValueChange",function(a){return o._yearSelected(a)})("activeDateChange",function(a){return o._updateActiveDate(a)})("keyup",function(a){return o._handleCalendarBodyKeyup(a)})("keydown",function(a){return o._handleCalendarBodyKeydown(a)}),ne()()),n&2&&(Ye(4),ht("rows",o._years)("todayValue",o._todayYear)("startValue",o._selectedYear)("endValue",o._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",o._getActiveCell()))},dependencies:[rE],encapsulation:2,changeDetection:0});let t=e;return t})();function kTe(t,e,i,r,n){let o=t.getYear(e),s=t.getYear(i),a=OTe(t,r,n);return Math.floor((o-a)/_d)===Math.floor((s-a)/_d)}function WO(t,e,i,r){let n=t.getYear(e);return xwt(n-OTe(t,i,r),_d)}function OTe(t,e,i){let r=0;return i?r=t.getYear(i)-_d+1:e&&(r=t.getYear(e)),r}function xwt(t,e){return(t%e+e)%e}var TTe=(()=>{let e=class e{get activeDate(){return this._activeDate}set activeDate(r){let n=this._activeDate,o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),this._dateAdapter.getYear(n)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(r){r instanceof yu?this._selected=r:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r)),this._setSelectedMonth(r)}get minDate(){return this._minDate}set minDate(r){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}get maxDate(){return this._maxDate}set maxDate(r){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}constructor(r,n,o,s){this._changeDetectorRef=r,this._dateFormats=n,this._dateAdapter=o,this._dir=s,this._rerenderSubscription=jn.EMPTY,this.selectedChange=new Nt,this.monthSelected=new Nt,this.activeDateChange=new Nt,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Fs(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(r){let n=r.value,o=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1);this.monthSelected.emit(o);let s=this._getDateFromMonth(n);this.selectedChange.emit(s)}_updateActiveDate(r){let n=r.value,o=this._activeDate;this.activeDate=this._getDateFromMonth(n),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(r){let n=this._activeDate,o=this._isRtl();switch(r.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),r.preventDefault()}_handleCalendarBodyKeyup(r){(r.keyCode===32||r.keyCode===13)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:r}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let r=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(n=>n.map(o=>this._createCellForMonth(o,r[o]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(r){return r&&this._dateAdapter.getYear(r)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(r):null}_getDateFromMonth(r){let n=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),r,1),o=this._dateAdapter.getNumDaysInMonth(n);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),r,Math.min(this._dateAdapter.getDate(this.activeDate),o))}_createCellForMonth(r,n){let o=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),r,1),s=this._dateAdapter.format(o,this._dateFormats.display.monthYearA11yLabel),a=this.dateClass?this.dateClass(o,"year"):void 0;return new UO(r,n.toLocaleUpperCase(),s,this._shouldEnableMonth(r),a)}_shouldEnableMonth(r){let n=this._dateAdapter.getYear(this.activeDate);if(r==null||this._isYearAndMonthAfterMaxDate(n,r)||this._isYearAndMonthBeforeMinDate(n,r))return!1;if(!this.dateFilter)return!0;let o=this._dateAdapter.createDate(n,r,1);for(let s=o;this._dateAdapter.getMonth(s)==r;s=this._dateAdapter.addCalendarDays(s,1))if(this.dateFilter(s))return!0;return!1}_isYearAndMonthAfterMaxDate(r,n){if(this.maxDate){let o=this._dateAdapter.getYear(this.maxDate),s=this._dateAdapter.getMonth(this.maxDate);return r>o||r===o&&n>s}return!1}_isYearAndMonthBeforeMinDate(r,n){if(this.minDate){let o=this._dateAdapter.getYear(this.minDate),s=this._dateAdapter.getMonth(this.minDate);return r<o||r===o&&n<s}return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedMonth(r){r instanceof yu?this._selectedMonth=this._getMonthInCurrentYear(r.start)||this._getMonthInCurrentYear(r.end):this._selectedMonth=this._getMonthInCurrentYear(r)}};e.\u0275fac=function(n){return new(n||e)(Te(Xi),Te(Jp,8),Te(ea,8),Te(ss,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-year-view"]],viewQuery:function(n,o){if(n&1&&Ii(rE,5),n&2){let s;ai(s=li())&&(o._matCalendarBody=s.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],standalone:!0,features:[zt],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell"]],template:function(n,o){n&1&&(ae(0,"table",0)(1,"thead",1)(2,"tr"),bt(3,"th",2),ne()(),ae(4,"tbody",3),At("selectedValueChange",function(a){return o._monthSelected(a)})("activeDateChange",function(a){return o._updateActiveDate(a)})("keyup",function(a){return o._handleCalendarBodyKeyup(a)})("keydown",function(a){return o._handleCalendarBodyKeydown(a)}),ne()()),n&2&&(Ye(4),ht("label",o._yearLabel)("rows",o._months)("todayValue",o._todayMonth)("startValue",o._selectedMonth)("endValue",o._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",o._dateAdapter.getMonth(o.activeDate)))},dependencies:[rE],encapsulation:2,changeDetection:0});let t=e;return t})(),Swt=1,NTe=(()=>{let e=class e{constructor(r,n,o,s,a){this._intl=r,this.calendar=n,this._dateAdapter=o,this._dateFormats=s,this._id=`mat-calendar-header-${Swt++}`,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>a.markForCheck())}get periodButtonText(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return this.calendar.currentView=="month"?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView=this.calendar.currentView=="month"?"multi-year":"month"}previousClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?-1:-_d)}nextClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?1:_d)}previousEnabled(){return this.calendar.minDate?!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate):!0}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(r,n){return this.calendar.currentView=="month"?this._dateAdapter.getYear(r)==this._dateAdapter.getYear(n)&&this._dateAdapter.getMonth(r)==this._dateAdapter.getMonth(n):this.calendar.currentView=="year"?this._dateAdapter.getYear(r)==this._dateAdapter.getYear(n):kTe(this._dateAdapter,r,n,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){let n=this._dateAdapter.getYear(this.calendar.activeDate)-WO(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),o=n+_d-1,s=this._dateAdapter.getYearName(this._dateAdapter.createDate(n,0,1)),a=this._dateAdapter.getYearName(this._dateAdapter.createDate(o,0,1));return[s,a]}};e.\u0275fac=function(n){return new(n||e)(Te(YO),Te(hc(()=>OK)),Te(ea,8),Te(Jp,8),Te(Xi))},e.\u0275cmp=Tt({type:e,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],standalone:!0,features:[zt],ngContentSelectors:lwt,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["aria-live","polite",1,"cdk-visually-hidden",3,"id"],["mat-button","","type","button",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"click","disabled"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"click","disabled"]],template:function(n,o){n&1&&(Br(),ae(0,"div",0)(1,"div",1)(2,"span",2),_e(3),ne(),ae(4,"button",3),At("click",function(){return o.currentPeriodClicked()}),ae(5,"span",4),_e(6),ne(),cf(),ae(7,"svg",5),bt(8,"polygon",6),ne()(),$C(),bt(9,"div",7),Ri(10),ae(11,"button",8),At("click",function(){return o.previousClicked()}),ne(),ae(12,"button",9),At("click",function(){return o.nextClicked()}),ne()()()),n&2&&(Ye(2),ht("id",o._periodButtonLabelId),Ye(),zn(o.periodButtonDescription),Ye(),mi("aria-label",o.periodButtonLabel)("aria-describedby",o._periodButtonLabelId),Ye(2),zn(o.periodButtonText),Ye(),hi("mat-calendar-invert",o.calendar.currentView!=="month"),Ye(4),ht("disabled",!o.previousEnabled()),mi("aria-label",o.prevButtonLabel),Ye(),ht("disabled",!o.nextEnabled()),mi("aria-label",o.nextButtonLabel))},dependencies:[$d,aI],encapsulation:2,changeDetection:0});let t=e;return t})(),OK=(()=>{let e=class e{get startAt(){return this._startAt}set startAt(r){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}get selected(){return this._selected}set selected(r){r instanceof yu?this._selected=r:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}get minDate(){return this._minDate}set minDate(r){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}get maxDate(){return this._maxDate}set maxDate(r){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}get activeDate(){return this._clampedActiveDate}set activeDate(r){this._clampedActiveDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(r){let n=this._currentView!==r?r:null;this._currentView=r,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),n&&this.viewChanged.emit(n)}constructor(r,n,o,s){this._dateAdapter=n,this._dateFormats=o,this._changeDetectorRef=s,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new Nt,this.yearSelected=new Nt,this.monthSelected=new Nt,this.viewChanged=new Nt(!0),this._userSelection=new Nt,this._userDragDrop=new Nt,this._activeDrag=null,this.stateChanges=new Ft,this._intlChanges=r.changes.subscribe(()=>{s.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new qu(this.headerComponent||NTe),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(r){let n=r.minDate&&!this._dateAdapter.sameDate(r.minDate.previousValue,r.minDate.currentValue)?r.minDate:void 0,o=r.maxDate&&!this._dateAdapter.sameDate(r.maxDate.previousValue,r.maxDate.currentValue)?r.maxDate:void 0,s=n||o||r.dateFilter;if(s&&!s.firstChange){let a=this._getCurrentViewComponent();a&&(this._moveFocusOnNextTick=!0,this._changeDetectorRef.detectChanges(),a._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(r){let n=r.value;(this.selected instanceof yu||n&&!this._dateAdapter.sameDate(n,this.selected))&&this.selectedChange.emit(n),this._userSelection.emit(r)}_yearSelectedInMultiYearView(r){this.yearSelected.emit(r)}_monthSelectedInYearView(r){this.monthSelected.emit(r)}_goToDateInView(r,n){this.activeDate=r,this.currentView=n}_dragStarted(r){this._activeDrag=r}_dragEnded(r){this._activeDrag&&(r.value&&this._userDragDrop.emit(r),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}};e.\u0275fac=function(n){return new(n||e)(Te(YO),Te(ea,8),Te(Jp,8),Te(Xi))},e.\u0275cmp=Tt({type:e,selectors:[["mat-calendar"]],viewQuery:function(n,o){if(n&1&&(Ii(STe,5),Ii(TTe,5),Ii(ETe,5)),n&2){let s;ai(s=li())&&(o.monthView=s.first),ai(s=li())&&(o.yearView=s.first),ai(s=li())&&(o.multiYearView=s.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],standalone:!0,features:[zi([DTe]),Li,zt],decls:5,vars:2,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","_userSelection","dragStarted","dragEnded","activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDateChange","monthSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","yearSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"]],template:function(n,o){if(n&1&&(wi(0,cwt,0,0,"ng-template",0),ae(1,"div",1),wi(2,dwt,1,11,"mat-month-view",2)(3,uwt,1,6,"mat-year-view",3)(4,hwt,1,6,"mat-multi-year-view",3),ne()),n&2){let s;ht("cdkPortalOutlet",o._calendarHeaderPortal),Ye(2),Mr((s=o.currentView)==="month"?2:s==="year"?3:s==="multi-year"?4:-1)}},dependencies:[sv,uue,STe,TTe,ETe],styles:['.mat-calendar{display:block;line-height:normal;font-family:var(--mat-datepicker-calendar-text-font, var(--mat-app-body-medium-font));font-size:var(--mat-datepicker-calendar-text-size, var(--mat-app-body-medium-size))}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-datepicker-calendar-period-button-text-weight, var(--mat-app-title-small-weight));--mdc-text-button-label-text-color:var(--mat-datepicker-calendar-period-button-text-color, var(--mat-app-on-surface-variant))}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color, var(--mat-app-on-surface-variant))}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-datepicker-content .mat-calendar-previous-button:not(.mat-mdc-button-disabled),.mat-datepicker-content .mat-calendar-next-button:not(.mat-mdc-button-disabled){color:var(--mat-datepicker-calendar-navigation-button-icon-color, var(--mat-app-on-surface-variant))}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color, var(--mat-app-on-surface-variant));font-size:var(--mat-datepicker-calendar-header-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-datepicker-calendar-header-text-weight, var(--mat-app-title-small-weight))}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0});let t=e;return t})(),RTe={transformPanel:zu("transformPanel",[Ll("void => enter-dropdown",fc("120ms cubic-bezier(0, 0, 0.2, 1)",SW([ns({opacity:0,transform:"scale(1, 0.8)"}),ns({opacity:1,transform:"scale(1, 1)"})]))),Ll("void => enter-dialog",fc("150ms cubic-bezier(0, 0, 0.2, 1)",SW([ns({opacity:0,transform:"scale(0.7)"}),ns({transform:"none",opacity:1})]))),Ll("* => void",fc("100ms linear",ns({opacity:0})))]),fadeInCalendar:zu("fadeInCalendar",[df("void",ns({opacity:0})),df("enter",ns({opacity:1})),Ll("void => *",fc("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])},Ewt=0,PTe=new St("mat-datepicker-scroll-strategy",{providedIn:"root",factory:()=>{let t=Jt($r);return()=>t.scrollStrategies.reposition()}});function Twt(t){return()=>t.scrollStrategies.reposition()}var Rwt={provide:PTe,deps:[$r],useFactory:Twt},LTe=(()=>{let e=class e{constructor(r,n,o,s,a,c){this._elementRef=r,this._changeDetectorRef=n,this._globalModel=o,this._dateAdapter=s,this._rangeSelectionStrategy=a,this._subscriptions=new jn,this._animationDone=new Ft,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=c.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(r){let n=this._model.selection,o=r.value,s=n instanceof yu;if(s&&this._rangeSelectionStrategy){let a=this._rangeSelectionStrategy.selectionFinished(o,n,r.event);this._model.updateSelection(a,this)}else o&&(s||!this._dateAdapter.sameDate(o,n))&&this._model.add(o);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(r){this._model.updateSelection(r.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(r){this._isAnimating=r.phaseName==="start",this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(r,n){this._model=r?this._globalModel.clone():this._globalModel,this._actionsPortal=r,n&&this._changeDetectorRef.detectChanges()}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(Xi),Te(qO),Te(ea),Te(MTe,8),Te(YO))},e.\u0275cmp=Tt({type:e,selectors:[["mat-datepicker-content"]],viewQuery:function(n,o){if(n&1&&Ii(OK,5),n&2){let s;ai(s=li())&&(o._calendar=s.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:5,hostBindings:function(n,o){n&1&&fde("@transformPanel.start",function(a){return o._handleAnimationEvent(a)})("@transformPanel.done",function(a){return o._handleAnimationEvent(a)}),n&2&&(hde("@transformPanel",o._animationState),Aa(o.color?"mat-"+o.color:""),hi("mat-datepicker-content-touch",o.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],standalone:!0,features:[zt],decls:5,vars:27,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop","id","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"focus","blur","click","color"]],template:function(n,o){if(n&1&&(ae(0,"div",0)(1,"mat-calendar",1),At("yearSelected",function(a){return o.datepicker._selectYear(a)})("monthSelected",function(a){return o.datepicker._selectMonth(a)})("viewChanged",function(a){return o.datepicker._viewChanged(a)})("_userSelection",function(a){return o._handleUserSelection(a)})("_userDragDrop",function(a){return o._handleUserDragDrop(a)}),ne(),wi(2,fwt,0,0,"ng-template",2),ae(3,"button",3),At("focus",function(){return o._closeButtonFocused=!0})("blur",function(){return o._closeButtonFocused=!1})("click",function(){return o.datepicker.close()}),_e(4),ne()()),n&2){let s;hi("mat-datepicker-content-container-with-custom-header",o.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",o._actionsPortal),mi("aria-modal",!0)("aria-labelledby",(s=o._dialogLabelId)!==null&&s!==void 0?s:void 0),Ye(),Aa(o.datepicker.panelClass),ht("id",o.datepicker.id)("startAt",o.datepicker.startAt)("startView",o.datepicker.startView)("minDate",o.datepicker._getMinDate())("maxDate",o.datepicker._getMaxDate())("dateFilter",o.datepicker._getDateFilter())("headerComponent",o.datepicker.calendarHeaderComponent)("selected",o._getSelected())("dateClass",o.datepicker.dateClass)("comparisonStart",o.comparisonStart)("comparisonEnd",o.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",o.startDateAccessibleName)("endDateAccessibleName",o.endDateAccessibleName),Ye(),ht("cdkPortalOutlet",o._actionsPortal),Ye(),hi("cdk-visually-hidden",!o._closeButtonFocused),ht("color",o.color||"primary"),Ye(),zn(o._closeButtonText)}},dependencies:[cue,OK,sv,$d],styles:[".mat-datepicker-content{display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color, var(--mat-app-surface-container-high));color:var(--mat-datepicker-calendar-container-text-color, var(--mat-app-on-surface));box-shadow:var(--mat-datepicker-calendar-container-elevation-shadow);border-radius:var(--mat-datepicker-calendar-container-shape, var(--mat-app-corner-large))}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;box-shadow:var(--mat-datepicker-calendar-container-touch-elevation-shadow);border-radius:var(--mat-datepicker-calendar-container-touch-shape, var(--mat-app-corner-extra-large));position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[RTe.transformPanel,RTe.fadeInCalendar]},changeDetection:0});let t=e;return t})(),ATe=(()=>{let e=class e{get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(r){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(r){this._color=r}get disabled(){return this._disabled===void 0&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(r){r!==this._disabled&&(this._disabled=r,this.stateChanges.next(void 0))}get panelClass(){return this._panelClass}set panelClass(r){this._panelClass=Kde(r)}get opened(){return this._opened}set opened(r){r?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}constructor(r,n,o,s,a,c,d){this._overlay=r,this._viewContainerRef=o,this._dateAdapter=a,this._dir=c,this._model=d,this._inputStateChanges=jn.EMPTY,this._document=Jt(ir),this.startView="month",this.touchUi=!1,this.xPosition="start",this.yPosition="below",this.restoreFocus=!0,this.yearSelected=new Nt,this.monthSelected=new Nt,this.viewChanged=new Nt(!0),this.openedStream=new Nt,this.closedStream=new Nt,this._opened=!1,this.id=`mat-datepicker-${Ewt++}`,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new Ft,this._injector=Jt(kn),this._changeDetectorRef=Jt(Xi),this._dateAdapter,this._scrollStrategy=s,this._model.selectionChanged.subscribe(()=>{this._changeDetectorRef.markForCheck()})}ngOnChanges(r){let n=r.xPosition||r.yPosition;if(n&&!n.firstChange&&this._overlayRef){let o=this._overlayRef.getConfig().positionStrategy;o instanceof DA&&(this._setConnectedPositions(o),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(r){this._model.add(r)}_selectYear(r){this.yearSelected.emit(r)}_selectMonth(r){this.monthSelected.emit(r)}_viewChanged(r){this.viewChanged.emit(r)}registerInput(r){return this.datepickerInput,this._inputStateChanges.unsubscribe(),this.datepickerInput=r,this._inputStateChanges=r.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(r){this._actionsPortal,this._actionsPortal=r,this._componentRef?.instance._assignActions(r,!0)}removeActions(r){r===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this.datepickerInput,this._focusedElementBeforeOpen=tv(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;let r=this.restoreFocus&&this._focusedElementBeforeOpen&&typeof this._focusedElementBeforeOpen.focus=="function",n=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){let{instance:o,location:s}=this._componentRef;o._startExitAnimation(),o._animationDone.pipe(Vo(1)).subscribe(()=>{let a=this._document.activeElement;r&&(!a||a===this._document.activeElement||s.nativeElement.contains(a))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}r?setTimeout(n):n()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(r){r.datepicker=this,r.color=this.color,r._dialogLabelId=this.datepickerInput.getOverlayLabelId(),r._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();let r=this.touchUi,n=new qu(LTe,this._viewContainerRef),o=this._overlayRef=this._overlay.create(new mf({positionStrategy:r?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[r?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:r?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:`mat-datepicker-${r?"dialog":"popup"}`}));this._getCloseStream(o).subscribe(s=>{s&&s.preventDefault(),this.close()}),o.keydownEvents().subscribe(s=>{let a=s.keyCode;(a===38||a===40||a===37||a===39||a===33||a===34)&&s.preventDefault()}),this._componentRef=o.attach(n),this._forwardContentValues(this._componentRef.instance),r||ed(()=>{o.updatePosition()},{injector:this._injector})}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){let r=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(r)}_setConnectedPositions(r){let n=this.xPosition==="end"?"end":"start",o=n==="start"?"end":"start",s=this.yPosition==="above"?"bottom":"top",a=s==="top"?"bottom":"top";return r.withPositions([{originX:n,originY:a,overlayX:n,overlayY:s},{originX:n,originY:s,overlayX:n,overlayY:a},{originX:o,originY:a,overlayX:o,overlayY:s},{originX:o,originY:s,overlayX:o,overlayY:a}])}_getCloseStream(r){let n=["ctrlKey","shiftKey","metaKey"];return Ra(r.backdropClick(),r.detachments(),r.keydownEvents().pipe(Ls(o=>o.keyCode===27&&!jo(o)||this.datepickerInput&&jo(o,"altKey")&&o.keyCode===38&&n.every(s=>!jo(o,s)))))}};e.\u0275fac=function(n){return new(n||e)(Te($r),Te(ni),Te(Qs),Te(PTe),Te(ea,8),Te(ss,8),Te(qO))},e.\u0275dir=Ot({type:e,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:[2,"touchUi","touchUi",bi],disabled:[2,"disabled","disabled",bi],xPosition:"xPosition",yPosition:"yPosition",restoreFocus:[2,"restoreFocus","restoreFocus",bi],dateClass:"dateClass",panelClass:"panelClass",opened:[2,"opened","opened",bi]},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[ar,Li]});let t=e;return t})(),FTe=(()=>{let e=class e extends ATe{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=el(e)))(o||e)}})(),e.\u0275cmp=Tt({type:e,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],standalone:!0,features:[zi([DTe,{provide:ATe,useExisting:e}]),vr,zt],decls:0,vars:0,template:function(n,o){},encapsulation:2,changeDetection:0});let t=e;return t})(),iE=class{constructor(e,i){this.target=e,this.targetElement=i,this.value=this.target.value}},Awt=(()=>{let e=class e{get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(r){this._assignValueProgrammatically(r)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(r){let n=r,o=this._elementRef.nativeElement;this._disabled!==n&&(this._disabled=n,this.stateChanges.next(void 0)),n&&this._isInitialized&&o.blur&&o.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(r){this._model=r,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(n=>{if(this._shouldHandleChangeEvent(n)){let o=this._getValueFromModel(n.selection);this._lastValueValid=this._isValidValue(o),this._cvaOnChange(o),this._onTouched(),this._formatValue(o),this.dateInput.emit(new iE(this,this._elementRef.nativeElement)),this.dateChange.emit(new iE(this,this._elementRef.nativeElement))}})}constructor(r,n,o){this._elementRef=r,this._dateAdapter=n,this._dateFormats=o,this.dateChange=new Nt,this.dateInput=new Nt,this.stateChanges=new Ft,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=jn.EMPTY,this._localeSubscription=jn.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=s=>{let a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value));return!a||this._matchesFilter(a)?null:{matDatepickerFilter:!0}},this._minValidator=s=>{let a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value)),c=this._getMinDate();return!c||!a||this._dateAdapter.compareDate(c,a)<=0?null:{matDatepickerMin:{min:c,actual:a}}},this._maxValidator=s=>{let a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value)),c=this._getMaxDate();return!c||!a||this._dateAdapter.compareDate(c,a)>=0?null:{matDatepickerMax:{max:c,actual:a}}},this._lastValueValid=!1,this._localeSubscription=n.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(r){Iwt(r,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(r){this._validatorOnChange=r}validate(r){return this._validator?this._validator(r):null}writeValue(r){this._assignValueProgrammatically(r)}registerOnChange(r){this._cvaOnChange=r}registerOnTouched(r){this._onTouched=r}setDisabledState(r){this.disabled=r}_onKeydown(r){let n=["ctrlKey","shiftKey","metaKey"];jo(r,"altKey")&&r.keyCode===40&&n.every(s=>!jo(r,s))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),r.preventDefault())}_onInput(r){let n=this._lastValueValid,o=this._dateAdapter.parse(r,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(o),o=this._dateAdapter.getValidDateOrNull(o);let s=!this._dateAdapter.sameDate(o,this.value);!o||s?this._cvaOnChange(o):(r&&!this.value&&this._cvaOnChange(o),n!==this._lastValueValid&&this._validatorOnChange()),s&&(this._assignValue(o),this.dateInput.emit(new iE(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new iE(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(r){this._elementRef.nativeElement.value=r!=null?this._dateAdapter.format(r,this._dateFormats.display.dateInput):""}_assignValue(r){this._model?(this._assignValueToModel(r),this._pendingValue=null):this._pendingValue=r}_isValidValue(r){return!r||this._dateAdapter.isValid(r)}_parentDisabled(){return!1}_assignValueProgrammatically(r){r=this._dateAdapter.deserialize(r),this._lastValueValid=this._isValidValue(r),r=this._dateAdapter.getValidDateOrNull(r),this._assignValue(r),this._formatValue(r)}_matchesFilter(r){let n=this._getDateFilter();return!n||n(r)}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(ea,8),Te(Jp,8))},e.\u0275dir=Ot({type:e,inputs:{value:"value",disabled:[2,"disabled","disabled",bi]},outputs:{dateChange:"dateChange",dateInput:"dateInput"},standalone:!0,features:[ar,Li]});let t=e;return t})();function Iwt(t,e){let i=Object.keys(t);for(let r of i){let{previousValue:n,currentValue:o}=t[r];if(e.isDateInstance(n)&&e.isDateInstance(o)){if(!e.sameDate(n,o))return!0}else return!0}return!1}var Dwt={provide:R_,useExisting:hc(()=>g4),multi:!0},Mwt={provide:em,useExisting:hc(()=>g4),multi:!0},g4=(()=>{let e=class e extends Awt{set matDatepicker(r){r&&(this._datepicker=r,this._ariaOwns.set(r.opened?r.id:null),this._closedSubscription=r.closedStream.subscribe(()=>{this._onTouched(),this._ariaOwns.set(null)}),this._openedSubscription=r.openedStream.subscribe(()=>{this._ariaOwns.set(r.id)}),this._registerModel(r.registerInput(this)))}get min(){return this._min}set min(r){let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r));this._dateAdapter.sameDate(n,this._min)||(this._min=n,this._validatorOnChange())}get max(){return this._max}set max(r){let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(r));this._dateAdapter.sameDate(n,this._max)||(this._max=n,this._validatorOnChange())}get dateFilter(){return this._dateFilter}set dateFilter(r){let n=this._matchesFilter(this.value);this._dateFilter=r,this._matchesFilter(this.value)!==n&&this._validatorOnChange()}constructor(r,n,o,s){super(r,n,o),this._formField=s,this._closedSubscription=jn.EMPTY,this._openedSubscription=jn.EMPTY,this._ariaOwns=iA(null),this._validator=lv.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe(),this._openedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(r){return r}_assignValueToModel(r){this._model&&this._model.updateSelection(r,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(r){return r.source!==this}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(ea,8),Te(Jp,8),Te(M_,8))},e.\u0275dir=Ot({type:e,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(n,o){n&1&&At("input",function(a){return o._onInput(a.target.value)})("change",function(){return o._onChange()})("blur",function(){return o._onBlur()})("keydown",function(a){return o._onKeydown(a)}),n&2&&(il("disabled",o.disabled),mi("aria-haspopup",o._datepicker?"dialog":null)("aria-owns",o._ariaOwns())("min",o.min?o._dateAdapter.toIso8601(o.min):null)("max",o.max?o._dateAdapter.toIso8601(o.max):null)("data-mat-calendar",o._datepicker?o._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:[0,"matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],standalone:!0,features:[zi([Dwt,Mwt,{provide:_U,useExisting:e}]),vr]});let t=e;return t})(),NK=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,selectors:[["","matDatepickerToggleIcon",""]],standalone:!0});let t=e;return t})(),PK=(()=>{let e=class e{get disabled(){return this._disabled===void 0&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(r){this._disabled=r}constructor(r,n,o){this._intl=r,this._changeDetectorRef=n,this._stateChanges=jn.EMPTY;let s=Number(o);this.tabIndex=s||s===0?s:null}ngOnChanges(r){r.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(r){this.datepicker&&!this.disabled&&(this.datepicker.open(),r.stopPropagation())}_watchStateChanges(){let r=this.datepicker?this.datepicker.stateChanges:qi(),n=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:qi(),o=this.datepicker?Ra(this.datepicker.openedStream,this.datepicker.closedStream):qi();this._stateChanges.unsubscribe(),this._stateChanges=Ra(this._intl.changes,r,n,o).subscribe(()=>this._changeDetectorRef.markForCheck())}};e.\u0275fac=function(n){return new(n||e)(Te(YO),Te(Xi),Jc("tabindex"))},e.\u0275cmp=Tt({type:e,selectors:[["mat-datepicker-toggle"]],contentQueries:function(n,o,s){if(n&1&&ws(s,NK,5),n&2){let a;ai(a=li())&&(o._customIcon=a.first)}},viewQuery:function(n,o){if(n&1&&Ii(pwt,5),n&2){let s;ai(s=li())&&(o._button=s.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(n,o){n&1&&At("click",function(a){return o._open(a)}),n&2&&(mi("tabindex",null)("data-mat-calendar",o.datepicker?o.datepicker.id:null),hi("mat-datepicker-toggle-active",o.datepicker&&o.datepicker.opened)("mat-accent",o.datepicker&&o.datepicker.color==="accent")("mat-warn",o.datepicker&&o.datepicker.color==="warn"))},inputs:{datepicker:[0,"for","datepicker"],tabIndex:"tabIndex",ariaLabel:[0,"aria-label","ariaLabel"],disabled:[2,"disabled","disabled",bi],disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],standalone:!0,features:[ar,Li,zt],ngContentSelectors:gwt,decls:4,vars:6,consts:[["button",""],["mat-icon-button","","type","button",3,"disabled","disableRipple"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(n,o){n&1&&(Br(mwt),ae(0,"button",1,0),wi(2,vwt,2,0,":svg:svg",2),Ri(3),ne()),n&2&&(ht("disabled",o.disabled)("disableRipple",o.disableRipple),mi("aria-haspopup",o.datepicker?"dialog":null)("aria-label",o.ariaLabel||o._intl.openCalendarLabel)("tabindex",o.disabled?-1:o.tabIndex),Ye(2),Mr(o._customIcon?-1:2))},dependencies:[aI],styles:[".mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color, var(--mat-app-on-surface-variant))}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color, var(--mat-app-on-surface-variant))}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0});let t=e;return t})();var HTe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({providers:[YO,Rwt],imports:[Wn,Gu,Wd,DL,hx,oi,LTe,PK,NTe,Vd]});let t=e;return t})();var BTe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[Wn,oi]});let t=e;return t})();function Owt(t,e){t&1&&bt(0,"div",2)}var Nwt=new St("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");var v4=(()=>{let e=class e{constructor(r,n,o,s,a){this._elementRef=r,this._ngZone=n,this._changeDetectorRef=o,this._animationMode=s,this._isNoopAnimation=!1,this._defaultColor="primary",this._value=0,this._bufferValue=0,this.animationEnd=new Nt,this._mode="determinate",this._transitionendHandler=c=>{this.animationEnd.observers.length===0||!c.target||!c.target.classList.contains("mdc-linear-progress__primary-bar")||(this.mode==="determinate"||this.mode==="buffer")&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))},this._isNoopAnimation=s==="NoopAnimations",a&&(a.color&&(this.color=this._defaultColor=a.color),this.mode=a.mode||this.mode)}get color(){return this._color||this._defaultColor}set color(r){this._color=r}get value(){return this._value}set value(r){this._value=VTe(r||0),this._changeDetectorRef.markForCheck()}get bufferValue(){return this._bufferValue||0}set bufferValue(r){this._bufferValue=VTe(r||0),this._changeDetectorRef.markForCheck()}get mode(){return this._mode}set mode(r){this._mode=r,this._changeDetectorRef.markForCheck()}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("transitionend",this._transitionendHandler)})}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._transitionendHandler)}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${this.mode==="buffer"?this.bufferValue:100}%`}_isIndeterminate(){return this.mode==="indeterminate"||this.mode==="query"}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(ni),Te(Xi),Te(rs,8),Te(Nwt,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(n,o){n&2&&(mi("aria-valuenow",o._isIndeterminate()?null:o.value)("mode",o.mode),Aa("mat-"+o.color),hi("_mat-animation-noopable",o._isNoopAnimation)("mdc-linear-progress--animation-ready",!o._isNoopAnimation)("mdc-linear-progress--indeterminate",o._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",Ia],bufferValue:[2,"bufferValue","bufferValue",Ia],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],standalone:!0,features:[ar,zt],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(n,o){n&1&&(ae(0,"div",0),bt(1,"div",1),wi(2,Owt,1,0,"div",2),ne(),ae(3,"div",3),bt(4,"span",4),ne(),ae(5,"div",5),bt(6,"span",4),ne()),n&2&&(Ye(),tl("flex-basis",o._getBufferBarFlexBasis()),Ye(),Mr(o.mode==="buffer"?2:-1),Ye(),tl("transform",o._getPrimaryBarTransform()))},styles:[`.mat-mdc-progress-bar{display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mdc-linear-progress-track-height),var(--mdc-linear-progress-active-indicator-height))}.cdk-high-contrast-active .mdc-linear-progress{outline-color:CanvasText}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mdc-linear-progress-active-indicator-height)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mdc-linear-progress-active-indicator-color, var(--mat-app-primary));border-top-width:var(--mdc-linear-progress-active-indicator-height)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mdc-linear-progress-track-height);border-radius:var(--mdc-linear-progress-track-shape, var(--mat-app-corner-none))}.mdc-linear-progress__buffer-dots{-webkit-mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear;background-color:var(--mdc-linear-progress-track-color, var(--mat-app-surface-variant))}.cdk-high-contrast-active .mdc-linear-progress__buffer-dots{background-color:ButtonBorder}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mdc-linear-progress-track-color, var(--mat-app-surface-variant))}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mdc-linear-progress-track-height) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}`],encapsulation:2,changeDetection:0});let t=e;return t})();function VTe(t,e=0,i=100){return Math.max(e,Math.min(i,t))}var b4=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi]});let t=e;return t})();var jTe=(()=>{let e=class e{constructor(r){this.http=r,this.baseUrl="https://borealisdata.ca/api/info/metrics"}getDataverseCollections(){let r=`${this.baseUrl}/tree`;return this.http.get(r)}getMonthlyDownloads(r){let n=r?`?parentAlias=${r}`:"",o=`${this.baseUrl}/downloads/monthly/${n}`;return this.http.get(o)}getMonthlyDatasets(r){let n=r?`?parentAlias=${r}`:"",o=`${this.baseUrl}/datasets/monthly/${n}`;return this.http.get(o)}getMonthlyFiles(r){let n=r?`?parentAlias=${r}`:"",o=`${this.baseUrl}/files/monthly/${n}`;return this.http.get(o)}getMonthlyUsers(r){let n=`${this.baseUrl}/accounts/monthly/`;return this.http.get(n)}getSubjectData(r,n){let o=n?`?parentAlias=${n}`:"",s=`${this.baseUrl}/datasets/bySubject/toMonth/${r}${o}`;return this.http.get(s)}getFileContentData(r){let n=r?`?parentAlias=${r}`:"",o=`${this.baseUrl}/files/byType/monthly/${n}`;return this.http.get(o)}getDataverseCount(r,n){let o=n?`?parentAlias=${n}`:"",s=`${this.baseUrl}/dataverses/toMonth/${r}${o}`;return this.http.get(s)}getDataverseCreationDate(r=""){let n=`https://borealisdata.ca/api/dataverses/${r||":root"}`;return this.http.get(n).pipe(Gi(o=>{let s=o?.data?.creationDate??"";return{data:{date:s?s.slice(0,7):""}}}),g_(()=>qi({data:{date:""}})))}getUniqueAuthors(r){let s=d=>{console.log(`Fetching page starting from: ${d}`);let u=Date.now();return this.getDatasets(r,d,500).pipe(Gi(h=>{let p=Date.now();return console.log(`Fetched page starting at ${d} in ${p-u}ms`),h?.data?.items||[]}))},c=Array.from({length:10},(d,u)=>u*500).map(d=>s(d));return lf(c).pipe(Gi(d=>d.flat()),Gi(d=>{console.log(`Total items fetched: ${d.length}`);let u={};return d.forEach(h=>{let p=h.published_at||h.publicationDate;if(!p)return;let f=p.slice(0,7);u[f]||(u[f]=new Set),(h.authors||[]).forEach(m=>{let g=m.trim().toLowerCase();g&&u[f].add(g)})}),u}),Gi(d=>{let u=Object.keys(d).sort();if(u.length===0)return{data:[{date:"",count:0}]};let h=x=>{let[T,M]=x.split("-").map(Number);return M++,M>12&&(M=1,T++),`${T}-${M.toString().padStart(2,"0")}`},p=u[0],f=new Date,m=`${f.getFullYear()}-${(f.getMonth()+1).toString().padStart(2,"0")}`,g=new Set,y=[],w=p;for(;w<=m;)d[w]&&d[w].forEach(x=>g.add(x)),y.push({date:w,count:g.size}),w=h(w);return{data:y}}))}getAllMetrics(r="",n=""){let o=!1,s=()=>o=!0,a=r?this.withErrorHandling(this.getMonthlyUsers(r),s):this.withErrorHandling(this.getMonthlyUsers(r),s);return lf([this.withErrorHandling(this.getDataverseCollections(),s),this.withErrorHandling(this.getMonthlyDownloads(r),s),this.withErrorHandling(this.getMonthlyDatasets(r),s),this.withErrorHandling(this.getMonthlyFiles(r),s),a,this.withErrorHandling(this.getSubjectData(n,r),s),this.withErrorHandling(this.getFileContentData(r),s),this.withErrorHandling(this.getDataverseCount(n,r),s),this.withErrorHandling(this.getDataverseCreationDate(r),s)]).pipe(Gi(c=>({data:c,errorOccurredFlag:o})))}getDatasets(r="",n=0,o=1e3){let s="https://borealisdata.ca/api/search",a={q:"*",type:"dataset",start:n.toString(),per_page:o.toString()};return r&&(a.subtree=r),this.http.get(s,{params:a})}withErrorHandling(r,n){return r.pipe(g_(o=>(n(),qi({}))))}};e.\u0275fac=function(n){return new(n||e)(lt(ev))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var _4=(()=>{let e=class e{constructor(){this._isLoading=new Ta(!1),this.isLoading$=this._isLoading.asObservable()}show(){this._isLoading.next(!0)}hide(){this._isLoading.next(!1)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var WTe=(()=>{let e=class e{constructor(r,n){this.apiService=r,this.loadingService=n,this.collectionSelected="",this.collectionSelectedName="",this.start_on=!1,this.startDate="",this.endDate="",this.downloads_rsp=[],this.datasets_rsp=[],this.files_rsp=[],this.users_rsp=[],this.subject_rsp=[],this.filecontent_rsp=[],this.filecontent_rsp_date_range=[],this.data=[],this.dataversesDataTree=[],this.dataverseCollections=[],this.dataverseAlias=[],this.dataverseCollectionsDropDown=[],this.table_dataset_rsp={},this.table_file_rsp={},this.dataverseCount=0,this.datasetURL="",this.fileURL="",this.subjectURL="",this.fileContentURL="",this.datasetsContents=[],this.datasets=[],this.filesContents=[],this.files=[],this.subjectContents=[],this.subjectLabels=[],this.subjectData=[],this.subjectContentFullData=[],this.fileContentHash={},this.fileContentDetailHash={},this.fileContentLabels=[],this.fileContentData=[],this.fileContentFullData=[],this.months=[],this.monthsDate=[],this.monthlyDownloads=[],this.monthlyDatasets=[],this.monthlyFiles=[],this.monthlyUsers=[],this.monthlyAggDownloads=[],this.monthlyAggDatasets=[],this.monthlyAggFiles=[],this.monthlyAggUsers=[],this.fileSizeHash={},this.sizeLabels=[],this.monthlySize=[],this.monthlyAggSize=[],this.observables=[],this.isLoading=!1,this.firstAPIGet=!0,this.dateRangeOn=!1,this.errorFlag=!1,this.messageEvent=new Nt}ngOnChanges(){this.firstAPIGet||(this.cleanTempData(),console.log("Clean Up Time")),this.populateMonths(),console.log(this.months),console.log("date",this.dateRangeOn,this.startDate,this.endDate),this.apiService.getAllMetrics(this.cleanedParentAlias,this.months[0]).subscribe(({data:r,errorOccurredFlag:n})=>{this.loadingService.hide(),console.log("raw responses,",r),this.errorFlag=n,[this.data_rsp,this.downloads_rsp,this.datasets_rsp,this.files_rsp,this.users_rsp,this.subject_rsp,this.filecontent_rsp,this.dataverse_rsp,this.creation_date_rs]=r.map((u,h)=>u&&typeof u.data=="object"&&Object.keys(u.data).length===0?[0,7,8].includes(h)?{}:[]:u.data),console.log(this.creation_date_rs),this.creation_date_rs?.date&&(this.creationDate=this.creation_date_rs.date),this.dataversesDataTree=Array.isArray(this.data_rsp?.children)?this.data_rsp.children:[],this.dataverseCollections=this.dataversesDataTree.map(u=>({name:u.name})),this.firstAPIGet||(this.dataverseAlias=this.dataversesDataTree.map(u=>({alias:u.alias,name:u.name})),this.dataverseCollectionsDropDown=this.dataversesDataTree.map(u=>u.name)),console.log("look at the months,",this.months),(!Array.isArray(this.downloads_rsp)||this.downloads_rsp.length<this.months.length)&&(this.months=Array.isArray(this.downloads_rsp)?this.downloads_rsp.map(u=>u.date).reverse():this.months);for(let u=0;u<this.months.length-1;u++){let h=this.months[u],p=this.months[u+1],f=x=>T=>x.find(M=>M.date===T)?.count??0,m=Array.isArray(this.downloads_rsp)?f(this.downloads_rsp):()=>0,g=Array.isArray(this.datasets_rsp)?f(this.datasets_rsp):()=>0,y=Array.isArray(this.files_rsp)?f(this.files_rsp):()=>0,w=Array.isArray(this.users_rsp)?f(this.users_rsp):()=>0;this.monthlyDownloads.push(m(h)),this.monthlyAggDownloads.push(m(h)-m(p)),this.monthlyDatasets.push(g(h)),this.monthlyAggDatasets.push(g(h)-g(p)),this.monthlyFiles.push(y(h)),this.monthlyAggFiles.push(y(h)-y(p)),this.monthlyUsers.push(w(h)),this.monthlyAggUsers.push(w(h)-w(p))}let o=Array.isArray(this.subject_rsp)?this.subject_rsp.reduce((u,h)=>u+h.count,0):0;this.subjectContentFullData=this.subject_rsp.map(u=>({subject:u.subject,count:u.count,percent:o>0?(u.count/o).toFixed(4):"0.0000"})),this.subjectLabels=Array.isArray(this.subject_rsp)?this.subject_rsp.map(u=>u.subject):[],this.subjectData=Array.isArray(this.subject_rsp)?this.subject_rsp.map(u=>u.count):[];let s=Array.isArray(this.filecontent_rsp)?this.filecontent_rsp.reduce((u,h)=>u+h.count,0):0;this.fileSizeHash=Array.isArray(this.filecontent_rsp)?this.filecontent_rsp.reduce((u,h)=>{let p=h.date,f=parseFloat((h.size/Math.pow(1024,3)).toFixed(4));return u[p]=(u[p]||0)+f,u},{}):{};let c=Object.entries(this.fileSizeHash).filter(([u])=>this.months.includes(String(u)));this.sizeLabels=[],this.monthlySize=[],this.monthlyAggSize=[];for(let u=0;u<c.length-1;u++)this.sizeLabels.push(c[u][0]),this.monthlySize.push(c[u][1]),this.monthlyAggSize.push(c[u+1][1]-c[u][1]);this.monthlySize.reverse(),this.monthlyAggSize.reverse(),console.log("size stuff",this.monthlySize,this.monthlyAggSize),this.dataverseCount=this.dataverse_rsp?.count??0,this.start_on?this.filecontent_rsp_date_range=Array.isArray(this.filecontent_rsp)?this.filecontent_rsp.filter(u=>this.months.slice(0,-1).includes(u.date)):[]:this.filecontent_rsp_date_range=Array.isArray(this.filecontent_rsp)?this.filecontent_rsp:[],console.log(this.filecontent_rsp_date_range),this.fileContentHash={},this.fileContentDetailHash={},this.filecontent_rsp_date_range.forEach(u=>{let h=u.contenttype?.split("/")[0]??"",p=u.count??0;u.date===this.months[0]&&(this.fileContentHash[h]=(this.fileContentHash[h]||0)+p,this.fileContentDetailHash[u.contenttype]=(this.fileContentDetailHash[u.contenttype]||0)+p)});let d=Object.values(this.fileContentHash).reduce((u,h)=>u+h,0);console.log("count",d),this.fileContentFullData=Object.entries(this.fileContentDetailHash).map(([u,h])=>{let p=u.split("/")[0];return{type:p,contenttype:u,count:h,percent:d>0?(this.fileContentHash[p]/d).toFixed(4):"0"}}),console.log(this.fileContentHash),console.log(this.fileContentDetailHash),this.fileContentLabels=Object.keys(this.fileContentHash),this.fileContentData=Object.values(this.fileContentHash),this.monthlyDownloads.reverse(),this.monthlyDatasets.reverse(),this.monthlyFiles.reverse(),this.monthlyUsers.reverse(),this.monthlySize.reverse(),this.monthlyAggDownloads.reverse(),this.monthlyAggDatasets.reverse(),this.monthlyAggFiles.reverse(),this.monthlyAggUsers.reverse(),this.monthlyAggSize.reverse(),this.months.reverse(),this.months.shift(),this.sendData()},r=>{console.error("API Error:",r),this.data_rsp={},this.downloads_rsp=[],this.datasets_rsp=[],this.files_rsp=[],this.users_rsp=[],this.subject_rsp=[],this.filecontent_rsp=[],this.dataverse_rsp={},this.authors_rsp={},this.loadingService.show(),this.firstAPIGet=!1}),this.loadingService.show(),this.firstAPIGet=!1}sendData(){var r={table_data:this.dataverseCollections,alias_data:this.dataverseAlias,downloads_graph_data:this.monthlyDownloads,dataverse_count:this.dataverseCount,datasets_graph_data:this.monthlyDatasets,files_graph_data:this.monthlyFiles,users_graph_data:this.monthlyUsers,size_graph_data:this.monthlySize,downloads_graph_agg_data:this.monthlyAggDownloads,datasets_graph_agg_data:this.monthlyAggDatasets,files_graph_agg_data:this.monthlyAggFiles,users_graph_agg_data:this.monthlyAggUsers,size_graph_agg_data:this.monthlyAggSize,subject_label_data:this.subjectLabels,subject_data:this.subjectData,subject_full_data:this.subjectContentFullData,file_content_label_data:this.fileContentLabels,file_content_data:this.fileContentData,file_content_full_data:this.fileContentFullData,name_dropdown_data:this.dataverseCollectionsDropDown,creation_date:this.creationDate,months:this.months,error_flag:this.errorFlag};console.log(r),this.messageEvent.emit({DataverseTabData:r})}populateMonths(){this.months=[];let r=24;this.start_on&&this.startDate&&this.endDate&&(r=this.monthAmount(this.startDate,this.endDate));let n=this.endDate?new Date(Date.parse(this.endDate+"-02")):new Date;console.log("months",n,this.startDate,this.endDate),new Date().getDate()<7&&!this.start_on&&n.setMonth(n.getMonth()-1),console.log("months",n);let o=!1;console.log("months diff",r,this.startDate,this.endDate);for(let s=0;s<=r;s++){let a=n.getMonth()+1,d=`${n.getFullYear()}-${String(a).padStart(2,"0")}`;console.log("months one by one",d,s),this.months.push(d),console.log(this.months),this.start_on&&d===this.startDate&&(o=!0),n.setMonth(n.getMonth()-1)}this.months.sort((s,a)=>s<a?1:-1)}monthAmount(r,n){let o=new Date(Date.parse(r+"-01")),s=new Date(Date.parse(n+"-01")),a=(s.getFullYear()-o.getFullYear())*12+(s.getMonth()-o.getMonth());return a===0?1:a===1?2:Math.abs(a)+1}cleanTempData(){this.dataverseCollectionsDropDown=[],this.dataverseCollections=[],this.dataverseAlias=[],this.dataversesDataTree=[],this.dataverse_rsp=[],this.filecontent_rsp=[],this.filecontent_rsp_date_range=[],this.observables=[],this.monthlyDownloads=[],this.monthlyDatasets=[],this.monthlyFiles=[],this.monthlyUsers=[],this.monthlySize=[],this.monthlyAggDownloads=[],this.monthlyAggDatasets=[],this.monthlyAggFiles=[],this.monthlyAggUsers=[],this.monthlyAggSize=[],this.datasetURL="",this.datasetsContents=[],this.datasets=[],this.subjectURL="",this.subjectContents=[],this.subjectLabels=[],this.subjectData=[],this.subjectContentFullData=[],this.fileContentURL="",this.fileContentHash={},this.fileSizeHash={},this.fileContentDetailHash={},this.fileContentLabels=[],this.fileContentData=[],this.fileContentFullData=[],this.dataverseCount=0,this.months=[],this.creation_date_rs="",this.creationDate="",this.errorFlag=!1}get cleanedParentAlias(){return this.collectionSelected==="(All)"?"":this.collectionSelected}findAliasRow(r,n){for(let o=0;o<=r.length;o++)if(r[o]&&r[o].alias===n)return o;return-1}};e.\u0275fac=function(n){return new(n||e)(Te(jTe),Te(_4))},e.\u0275cmp=Tt({type:e,selectors:[["app-posts"]],inputs:{collectionSelected:"collectionSelected",collectionSelectedName:"collectionSelectedName",start_on:"start_on",startDate:"startDate",endDate:"endDate"},outputs:{messageEvent:"messageEvent"},standalone:!0,features:[Li,zt],decls:0,vars:0,template:function(n,o){},dependencies:[Rde,BTe,Wn,b4],styles:[".loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0000004d;z-index:9999}"]});let t=e;return t})();var LK=class{constructor(){this.expansionModel=new T_(!0)}toggle(e){this.expansionModel.toggle(this._trackByValue(e))}expand(e){this.expansionModel.select(this._trackByValue(e))}collapse(e){this.expansionModel.deselect(this._trackByValue(e))}isExpanded(e){return this.expansionModel.isSelected(this._trackByValue(e))}toggleDescendants(e){this.expansionModel.isSelected(this._trackByValue(e))?this.collapseDescendants(e):this.expandDescendants(e)}collapseAll(){this.expansionModel.clear()}expandDescendants(e){let i=[e];i.push(...this.getDescendants(e)),this.expansionModel.select(...i.map(r=>this._trackByValue(r)))}collapseDescendants(e){let i=[e];i.push(...this.getDescendants(e)),this.expansionModel.deselect(...i.map(r=>this._trackByValue(r)))}_trackByValue(e){return this.trackBy?this.trackBy(e):e}},y4=class extends LK{constructor(e,i,r){super(),this.getLevel=e,this.isExpandable=i,this.options=r,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(e){let i=this.dataNodes.indexOf(e),r=[];for(let n=i+1;n<this.dataNodes.length&&this.getLevel(e)<this.getLevel(this.dataNodes[n]);n++)r.push(this.dataNodes[n]);return r}expandAll(){this.expansionModel.select(...this.dataNodes.map(e=>this._trackByValue(e)))}};var HK=new St("CDK_TREE_NODE_OUTLET_NODE"),w4=(()=>{let e=class e{constructor(r,n){this.viewContainer=r,this._node=n}};e.\u0275fac=function(n){return new(n||e)(Te(Qs),Te(HK,8))},e.\u0275dir=Ot({type:e,selectors:[["","cdkTreeNodeOutlet",""]],standalone:!0});let t=e;return t})(),FK=class{constructor(e){this.$implicit=e}},C4=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(n){return new(n||e)(Te(Pl))},e.\u0275dir=Ot({type:e,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:[0,"cdkTreeNodeDefWhen","when"]},standalone:!0});let t=e;return t})();function UTe(){return Error("Could not find a tree control, levelAccessor, or childrenAccessor for the tree.")}var Fb=(()=>{let e=class e{get dataSource(){return this._dataSource}set dataSource(r){this._dataSource!==r&&this._switchDataSource(r)}constructor(r,n){this._differs=r,this._changeDetectorRef=n,this._dir=Jt(ss),this._onDestroy=new Ft,this._levels=new Map,this._parents=new Map,this._ariaSets=new Map,this.viewChange=new Ta({start:0,end:Number.MAX_VALUE}),this._flattenedNodes=new Ta([]),this._nodeType=new Ta(null),this._nodes=new Ta(new Map),this._keyManagerNodes=new Ta([]),this._keyManagerFactory=Jt(aue),this._viewInit=!1}ngAfterContentInit(){this._initializeKeyManager()}ngAfterContentChecked(){this._updateDefaultNodeDefinition(),this._subscribeToDataChanges()}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&typeof this._dataSource.disconnect=="function"&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),this._keyManager?.destroy()}ngOnInit(){this._checkTreeControlUsage(),this._initializeDataDiffer()}ngAfterViewInit(){this._viewInit=!0}_updateDefaultNodeDefinition(){let r=this._nodeDefs.filter(n=>!n.when);r.length>1,this._defaultNodeDef=r[0]}_setNodeTypeIfUnset(r){this._nodeType.value===null&&this._nodeType.next(r)}_switchDataSource(r){this._dataSource&&typeof this._dataSource.disconnect=="function"&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),r||this._nodeOutlet.viewContainer.clear(),this._dataSource=r,this._nodeDefs&&this._subscribeToDataChanges()}_getExpansionModel(){return this.treeControl?this.treeControl.expansionModel:(this._expansionModel??=new T_(!0),this._expansionModel)}_subscribeToDataChanges(){if(this._dataSubscription)return;let r;Sue(this._dataSource)?r=this._dataSource.connect(this):Qg(this._dataSource)?r=this._dataSource:Array.isArray(this._dataSource)&&(r=qi(this._dataSource)),r&&(this._dataSubscription=this._getRenderData(r).pipe(Hr(this._onDestroy)).subscribe(n=>{this._renderDataChanges(n)}))}_getRenderData(r){let n=this._getExpansionModel();return Jg([r,this._nodeType,n.changed.pipe(Fs(null),Qc(o=>{this._emitExpansionChanges(o)}))]).pipe(uc(([o,s])=>s===null?qi({renderNodes:o,flattenedNodes:null,nodeType:s}):this._computeRenderingData(o,s).pipe(Gi(a=>Lt(Ke({},a),{nodeType:s})))))}_renderDataChanges(r){if(r.nodeType===null){this.renderNodeChanges(r.renderNodes);return}this._updateCachedData(r.flattenedNodes),this.renderNodeChanges(r.renderNodes),this._updateKeyManagerItems(r.flattenedNodes)}_emitExpansionChanges(r){if(!r)return;let n=this._nodes.value;for(let o of r.added)n.get(o)?._emitExpansionState(!0);for(let o of r.removed)n.get(o)?._emitExpansionState(!1)}_initializeKeyManager(){let r=Jg([this._keyManagerNodes,this._nodes]).pipe(Gi(([o,s])=>o.reduce((a,c)=>{let d=s.get(this._getExpansionKey(c));return d&&a.push(d),a},[]))),n={trackBy:o=>this._getExpansionKey(o.data),skipPredicate:o=>!!o.isDisabled,typeAheadDebounceInterval:!0,horizontalOrientation:this._dir.value};this._keyManager=this._keyManagerFactory(r,n)}_initializeDataDiffer(){let r=this.trackBy??((n,o)=>this._getExpansionKey(o));this._dataDiffer=this._differs.find([]).create(r)}_checkTreeControlUsage(){}renderNodeChanges(r,n=this._dataDiffer,o=this._nodeOutlet.viewContainer,s){let a=n.diff(r);!a&&!this._viewInit||(a?.forEachOperation((c,d,u)=>{if(c.previousIndex==null)this.insertNode(r[u],u,o,s);else if(u==null)o.remove(d);else{let h=o.get(d);o.move(h,u)}}),a?.forEachIdentityChange(c=>{let d=c.item;if(c.currentIndex!=null){let u=o.get(c.currentIndex);u.context.$implicit=d}}),s?this._changeDetectorRef.markForCheck():this._changeDetectorRef.detectChanges())}_getNodeDef(r,n){if(this._nodeDefs.length===1)return this._nodeDefs.first;let o=this._nodeDefs.find(s=>s.when&&s.when(n,r))||this._defaultNodeDef;return o}insertNode(r,n,o,s){let a=this._getLevelAccessor(),c=this._getNodeDef(r,n),d=this._getExpansionKey(r),u=new FK(r);s??=this._parents.get(d)??void 0,a?u.level=a(r):s!==void 0&&this._levels.has(this._getExpansionKey(s))?u.level=this._levels.get(this._getExpansionKey(s))+1:u.level=0,this._levels.set(d,u.level),(o||this._nodeOutlet.viewContainer).createEmbeddedView(c.template,u,n),Jy.mostRecentTreeNode&&(Jy.mostRecentTreeNode.data=r)}isExpanded(r){return!!(this.treeControl?.isExpanded(r)||this._expansionModel?.isSelected(this._getExpansionKey(r)))}toggle(r){this.treeControl?this.treeControl.toggle(r):this._expansionModel&&this._expansionModel.toggle(this._getExpansionKey(r))}expand(r){this.treeControl?this.treeControl.expand(r):this._expansionModel&&this._expansionModel.select(this._getExpansionKey(r))}collapse(r){this.treeControl?this.treeControl.collapse(r):this._expansionModel&&this._expansionModel.deselect(this._getExpansionKey(r))}toggleDescendants(r){this.treeControl?this.treeControl.toggleDescendants(r):this._expansionModel&&(this.isExpanded(r)?this.collapseDescendants(r):this.expandDescendants(r))}expandDescendants(r){if(this.treeControl)this.treeControl.expandDescendants(r);else if(this._expansionModel){let n=this._expansionModel;n.select(this._getExpansionKey(r)),this._getDescendants(r).pipe(Vo(1),Hr(this._onDestroy)).subscribe(o=>{n.select(...o.map(s=>this._getExpansionKey(s)))})}}collapseDescendants(r){if(this.treeControl)this.treeControl.collapseDescendants(r);else if(this._expansionModel){let n=this._expansionModel;n.deselect(this._getExpansionKey(r)),this._getDescendants(r).pipe(Vo(1),Hr(this._onDestroy)).subscribe(o=>{n.deselect(...o.map(s=>this._getExpansionKey(s)))})}}expandAll(){this.treeControl?this.treeControl.expandAll():this._expansionModel&&this._expansionModel.select(...this._flattenedNodes.value.map(n=>this._getExpansionKey(n)))}collapseAll(){this.treeControl?this.treeControl.collapseAll():this._expansionModel&&this._expansionModel.deselect(...this._flattenedNodes.value.map(n=>this._getExpansionKey(n)))}_getLevelAccessor(){return this.treeControl?.getLevel?.bind(this.treeControl)??this.levelAccessor}_getChildrenAccessor(){return this.treeControl?.getChildren?.bind(this.treeControl)??this.childrenAccessor}_getDirectChildren(r){let n=this._getLevelAccessor(),o=this._expansionModel??this.treeControl?.expansionModel;if(!o)return qi([]);let s=this._getExpansionKey(r),a=o.changed.pipe(uc(d=>d.added.includes(s)?qi(!0):d.removed.includes(s)?qi(!1):qC),Fs(this.isExpanded(r)));if(n)return Jg([a,this._flattenedNodes]).pipe(Gi(([d,u])=>d?this._findChildrenByLevel(n,u,r,1):[]));let c=this._getChildrenAccessor();if(c)return y_(c(r)??[]);throw UTe()}_findChildrenByLevel(r,n,o,s){let a=this._getExpansionKey(o),c=n.findIndex(p=>this._getExpansionKey(p)===a),d=r(o),u=d+s,h=[];for(let p=c+1;p<n.length;p++){let f=r(n[p]);if(f<=d)break;f<=u&&h.push(n[p])}return h}_registerNode(r){this._nodes.value.set(this._getExpansionKey(r.data),r),this._nodes.next(this._nodes.value)}_unregisterNode(r){this._nodes.value.delete(this._getExpansionKey(r.data)),this._nodes.next(this._nodes.value)}_getLevel(r){return this._levels.get(this._getExpansionKey(r))}_getSetSize(r){return this._getAriaSet(r).length}_getPositionInSet(r){let n=this._getAriaSet(r),o=this._getExpansionKey(r);return n.findIndex(s=>this._getExpansionKey(s)===o)+1}_getNodeParent(r){let n=this._parents.get(this._getExpansionKey(r.data));return n&&this._nodes.value.get(this._getExpansionKey(n))}_getNodeChildren(r){return this._getDirectChildren(r.data).pipe(Gi(n=>n.reduce((o,s)=>{let a=this._nodes.value.get(this._getExpansionKey(s));return a&&o.push(a),o},[])))}_sendKeydownToKeyManager(r){this._keyManager.onKeydown(r)}_getDescendants(r){if(this.treeControl)return qi(this.treeControl.getDescendants(r));if(this.levelAccessor){let n=this._findChildrenByLevel(this.levelAccessor,this._flattenedNodes.value,r,1/0);return qi(n)}if(this.childrenAccessor)return this._getAllChildrenRecursively(r).pipe(gW((n,o)=>(n.push(...o),n),[]));throw UTe()}_getAllChildrenRecursively(r){return this.childrenAccessor?y_(this.childrenAccessor(r)).pipe(Vo(1),uc(n=>{for(let o of n)this._parents.set(this._getExpansionKey(o),r);return qi(...n).pipe(vW(o=>KR(qi([o]),this._getAllChildrenRecursively(o))))})):qi([])}_getExpansionKey(r){return this.expansionKey?.(r)??r}_getAriaSet(r){let n=this._getExpansionKey(r),o=this._parents.get(n),s=o?this._getExpansionKey(o):null;return this._ariaSets.get(s)??[r]}_findParentForNode(r,n,o){if(!o.length)return null;let s=this._levels.get(this._getExpansionKey(r))??0;for(let a=n-1;a>=0;a--){let c=o[a];if((this._levels.get(this._getExpansionKey(c))??0)<s)return c}return null}_flattenNestedNodesWithExpansion(r,n=0){let o=this._getChildrenAccessor();return o?qi(...r).pipe(vW(s=>{let a=this._getExpansionKey(s);this._parents.has(a)||this._parents.set(a,null),this._levels.set(a,n);let c=y_(o(s));return KR(qi([s]),c.pipe(Vo(1),Qc(d=>{this._ariaSets.set(a,[...d??[]]);for(let u of d??[]){let h=this._getExpansionKey(u);this._parents.set(h,s),this._levels.set(h,n+1)}}),uc(d=>d?this._flattenNestedNodesWithExpansion(d,n+1).pipe(Gi(u=>this.isExpanded(s)?u:[])):qi([]))))}),gW((s,a)=>(s.push(...a),s),[])):qi([...r])}_computeRenderingData(r,n){if(this.childrenAccessor&&n==="flat")return this._ariaSets.set(null,[...r]),this._flattenNestedNodesWithExpansion(r).pipe(Gi(o=>({renderNodes:o,flattenedNodes:o})));if(this.levelAccessor&&n==="nested"){let o=this.levelAccessor;return qi(r.filter(s=>o(s)===0)).pipe(Gi(s=>({renderNodes:s,flattenedNodes:r})),Qc(({flattenedNodes:s})=>{this._calculateParents(s)}))}else return n==="flat"?qi({renderNodes:r,flattenedNodes:r}).pipe(Qc(({flattenedNodes:o})=>{this._calculateParents(o)})):(this._ariaSets.set(null,[...r]),this._flattenNestedNodesWithExpansion(r).pipe(Gi(o=>({renderNodes:r,flattenedNodes:o}))))}_updateCachedData(r){this._flattenedNodes.next(r)}_updateKeyManagerItems(r){this._keyManagerNodes.next(r)}_calculateParents(r){let n=this._getLevelAccessor();if(n){this._parents.clear(),this._ariaSets.clear();for(let o=0;o<r.length;o++){let s=r[o],a=this._getExpansionKey(s);this._levels.set(a,n(s));let c=this._findParentForNode(s,o,r);this._parents.set(a,c);let d=c?this._getExpansionKey(c):null,u=this._ariaSets.get(d)??[];u.splice(o,0,s),this._ariaSets.set(d,u)}}}};e.\u0275fac=function(n){return new(n||e)(Te(sA),Te(Xi))},e.\u0275cmp=Tt({type:e,selectors:[["cdk-tree"]],contentQueries:function(n,o,s){if(n&1&&ws(s,C4,5),n&2){let a;ai(a=li())&&(o._nodeDefs=a)}},viewQuery:function(n,o){if(n&1&&Ii(w4,7),n&2){let s;ai(s=li())&&(o._nodeOutlet=s.first)}},hostAttrs:["role","tree",1,"cdk-tree"],hostBindings:function(n,o){n&1&&At("keydown",function(a){return o._sendKeydownToKeyManager(a)})},inputs:{dataSource:"dataSource",treeControl:"treeControl",levelAccessor:"levelAccessor",childrenAccessor:"childrenAccessor",trackBy:"trackBy",expansionKey:"expansionKey"},exportAs:["cdkTree"],standalone:!0,features:[zt],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(n,o){n&1&&b_(0,0)},dependencies:[w4],encapsulation:2});let t=e;return t})(),Jy=(()=>{let e=class e{get role(){return"treeitem"}set role(r){}get isExpandable(){return this._isExpandable()}set isExpandable(r){this._inputIsExpandable=r,!(this.data&&!this._isExpandable||!this._inputIsExpandable)&&(this._inputIsExpanded?this.expand():this._inputIsExpanded===!1&&this.collapse())}get isExpanded(){return this._tree.isExpanded(this._data)}set isExpanded(r){this._inputIsExpanded=r,r?this.expand():this.collapse()}getLabel(){return this.typeaheadLabel||this._elementRef.nativeElement.textContent?.trim()||""}get data(){return this._data}set data(r){r!==this._data&&(this._data=r,this._dataChanges.next())}get isLeafNode(){return this._tree.treeControl?.isExpandable!==void 0&&!this._tree.treeControl.isExpandable(this._data)?!0:this._tree.treeControl?.isExpandable===void 0&&this._tree.treeControl?.getDescendants(this._data).length===0}get level(){return this._tree._getLevel(this._data)??this._parentNodeAriaLevel}_isExpandable(){return this._tree.treeControl?!this.isLeafNode:this._inputIsExpandable}_getAriaExpanded(){return this._isExpandable()?String(this.isExpanded):null}_getSetSize(){return this._tree._getSetSize(this._data)}_getPositionInSet(){return this._tree._getPositionInSet(this._data)}constructor(r,n){this._elementRef=r,this._tree=n,this._tabindex=-1,this.activation=new Nt,this.expandedChange=new Nt,this._destroyed=new Ft,this._dataChanges=new Ft,this._inputIsExpandable=!1,this._inputIsExpanded=void 0,this._shouldFocus=!0,this._changeDetectorRef=Jt(Xi),e.mostRecentTreeNode=this}ngOnInit(){this._parentNodeAriaLevel=Fwt(this._elementRef.nativeElement),this._tree._getExpansionModel().changed.pipe(Gi(()=>this.isExpanded),Kp()).subscribe(()=>{this._changeDetectorRef.markForCheck()}),this._tree._setNodeTypeIfUnset("flat"),this._tree._registerNode(this)}ngOnDestroy(){e.mostRecentTreeNode===this&&(e.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}getParent(){return this._tree._getNodeParent(this)??null}getChildren(){return this._tree._getNodeChildren(this)}focus(){this._tabindex=0,this._shouldFocus&&this._elementRef.nativeElement.focus(),this._changeDetectorRef.markForCheck()}unfocus(){this._tabindex=-1,this._changeDetectorRef.markForCheck()}activate(){this.isDisabled||this.activation.next(this._data)}collapse(){this.isExpandable&&this._tree.collapse(this._data)}expand(){this.isExpandable&&this._tree.expand(this._data)}makeFocusable(){this._tabindex=0,this._changeDetectorRef.markForCheck()}_focusItem(){this.isDisabled||this._tree._keyManager.focusItem(this)}_setActiveItem(){this.isDisabled||(this._shouldFocus=!1,this._tree._keyManager.focusItem(this),this._shouldFocus=!0)}_emitExpansionState(r){this.expandedChange.emit(r)}};e.mostRecentTreeNode=null,e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(Fb))},e.\u0275dir=Ot({type:e,selectors:[["cdk-tree-node"]],hostAttrs:["role","treeitem",1,"cdk-tree-node"],hostVars:5,hostBindings:function(n,o){n&1&&At("click",function(){return o._setActiveItem()})("focus",function(){return o._focusItem()}),n&2&&(il("tabindex",o._tabindex),mi("aria-expanded",o._getAriaExpanded())("aria-level",o.level+1)("aria-posinset",o._getPositionInSet())("aria-setsize",o._getSetSize()))},inputs:{role:"role",isExpandable:[2,"isExpandable","isExpandable",bi],isExpanded:"isExpanded",isDisabled:[2,"isDisabled","isDisabled",bi],typeaheadLabel:[0,"cdkTreeNodeTypeaheadLabel","typeaheadLabel"]},outputs:{activation:"activation",expandedChange:"expandedChange"},exportAs:["cdkTreeNode"],standalone:!0,features:[ar]});let t=e;return t})();function Fwt(t){let e=t.parentElement;for(;e&&!Hwt(e);)e=e.parentElement;return e?e.classList.contains("cdk-nested-tree-node")?Ia(e.getAttribute("aria-level")):0:-1}function Hwt(t){let e=t.classList;return!!(e?.contains("cdk-nested-tree-node")||e?.contains("cdk-tree"))}var Bwt=/([A-Za-z%]+)$/,BK=(()=>{let e=class e{get level(){return this._level}set level(r){this._setLevelInput(r)}get indent(){return this._indent}set indent(r){this._setIndentInput(r)}constructor(r,n,o,s){this._treeNode=r,this._tree=n,this._element=o,this._dir=s,this._destroyed=new Ft,this.indentUnits="px",this._indent=40,this._setPadding(),s&&s.change.pipe(Hr(this._destroyed)).subscribe(()=>this._setPadding(!0)),r._dataChanges.subscribe(()=>this._setPadding())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){let r=(this._treeNode.data&&this._tree._getLevel(this._treeNode.data))??null,n=this._level==null?r:this._level;return typeof n=="number"?`${n*this._indent}${this.indentUnits}`:null}_setPadding(r=!1){let n=this._paddingIndent();if(n!==this._currentPadding||r){let o=this._element.nativeElement,s=this._dir&&this._dir.value==="rtl"?"paddingRight":"paddingLeft",a=s==="paddingLeft"?"paddingRight":"paddingLeft";o.style[s]=n||"",o.style[a]="",this._currentPadding=n}}_setLevelInput(r){this._level=isNaN(r)?null:r,this._setPadding()}_setIndentInput(r){let n=r,o="px";if(typeof r=="string"){let s=r.split(Bwt);n=s[0],o=s[1]||o}this.indentUnits=o,this._indent=Ia(n),this._setPadding()}};e.\u0275fac=function(n){return new(n||e)(Te(Jy),Te(Fb),Te(qt),Te(ss,8))},e.\u0275dir=Ot({type:e,selectors:[["","cdkTreeNodePadding",""]],inputs:{level:[2,"cdkTreeNodePadding","level",Ia],indent:[0,"cdkTreeNodePaddingIndent","indent"]},standalone:!0,features:[ar]});let t=e;return t})(),VK=(()=>{let e=class e{constructor(r,n){this._tree=r,this._treeNode=n,this.recursive=!1}_toggle(){this.recursive?this._tree.toggleDescendants(this._treeNode.data):this._tree.toggle(this._treeNode.data),this._tree._keyManager.focusItem(this._treeNode)}};e.\u0275fac=function(n){return new(n||e)(Te(Fb),Te(Jy))},e.\u0275dir=Ot({type:e,selectors:[["","cdkTreeNodeToggle",""]],hostAttrs:["tabindex","-1"],hostBindings:function(n,o){n&1&&At("click",function(a){return o._toggle(),a.stopPropagation()})("keydown.Enter",function(a){return o._toggle(),a.preventDefault()})("keydown.Space",function(a){return o._toggle(),a.preventDefault()})},inputs:{recursive:[2,"cdkTreeNodeToggleRecursive","recursive",bi]},standalone:!0,features:[ar]});let t=e;return t})();var qTe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({});let t=e;return t})();function jwt(t){return!!t._isNoopTreeKeyManager}var $Te=(()=>{let e=class e extends Jy{get tabIndexInputBinding(){return this._tabIndexInputBinding}set tabIndexInputBinding(r){this._tabIndexInputBinding=r}_getTabindexAttribute(){return jwt(this._tree._keyManager)?this.tabIndexInputBinding:this._tabindex}get disabled(){return this.isDisabled}set disabled(r){this.isDisabled=r}constructor(r,n,o){super(r,n),this.defaultTabIndex=0,this.tabIndexInputBinding=Number(o)||this.defaultTabIndex}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(Fb),Jc("tabindex"))},e.\u0275dir=Ot({type:e,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],hostVars:5,hostBindings:function(n,o){n&1&&At("click",function(){return o._focusItem()}),n&2&&(il("tabindex",o._getTabindexAttribute()),mi("aria-expanded",o._getAriaExpanded())("aria-level",o.level+1)("aria-posinset",o._getPositionInSet())("aria-setsize",o._getSetSize()))},inputs:{tabIndexInputBinding:[2,"tabIndex","tabIndexInputBinding",r=>r==null?0:Ia(r)],disabled:[2,"disabled","disabled",bi]},outputs:{activation:"activation",expandedChange:"expandedChange"},exportAs:["matTreeNode"],standalone:!0,features:[zi([{provide:Jy,useExisting:e}]),ar,vr]});let t=e;return t})(),GTe=(()=>{let e=class e extends C4{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=el(e)))(o||e)}})(),e.\u0275dir=Ot({type:e,selectors:[["","matTreeNodeDef",""]],inputs:{when:[0,"matTreeNodeDefWhen","when"],data:[0,"matTreeNode","data"]},standalone:!0,features:[zi([{provide:C4,useExisting:e}]),vr]});let t=e;return t})();var XTe=(()=>{let e=class e extends BK{get level(){return this._level}set level(r){this._setLevelInput(r)}get indent(){return this._indent}set indent(r){this._setIndentInput(r)}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=el(e)))(o||e)}})(),e.\u0275dir=Ot({type:e,selectors:[["","matTreeNodePadding",""]],inputs:{level:[2,"matTreeNodePadding","level",Ia],indent:[0,"matTreeNodePaddingIndent","indent"]},standalone:!0,features:[zi([{provide:BK,useExisting:e}]),ar,vr]});let t=e;return t})(),YTe=(()=>{let e=class e{constructor(r,n){this.viewContainer=r,this._node=n}};e.\u0275fac=function(n){return new(n||e)(Te(Qs),Te(HK,8))},e.\u0275dir=Ot({type:e,selectors:[["","matTreeNodeOutlet",""]],standalone:!0,features:[zi([{provide:w4,useExisting:e}])]});let t=e;return t})(),KTe=(()=>{let e=class e extends Fb{constructor(){super(...arguments),this._nodeOutlet=void 0}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=el(e)))(o||e)}})(),e.\u0275cmp=Tt({type:e,selectors:[["mat-tree"]],viewQuery:function(n,o){if(n&1&&Ii(YTe,7),n&2){let s;ai(s=li())&&(o._nodeOutlet=s.first)}},hostAttrs:[1,"mat-tree"],exportAs:["matTree"],standalone:!0,features:[zi([{provide:Fb,useExisting:e}]),vr,zt],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(n,o){n&1&&b_(0,0)},dependencies:[YTe],styles:[".mat-tree{display:block;background-color:var(--mat-tree-container-background-color, var(--mat-app-surface))}.mat-tree-node,.mat-nested-tree-node{color:var(--mat-tree-node-text-color, var(--mat-app-on-surface));font-family:var(--mat-tree-node-text-font, var(--mat-app-body-large-font));font-size:var(--mat-tree-node-text-size, var(--mat-app-body-large-size));font-weight:var(--mat-tree-node-text-weight, var(--mat-app-body-large-weight))}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word;min-height:var(--mat-tree-node-min-height)}.mat-nested-tree-node{border-bottom-width:0}"],encapsulation:2});let t=e;return t})(),ZTe=(()=>{let e=class e extends VK{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=el(e)))(o||e)}})(),e.\u0275dir=Ot({type:e,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:[0,"matTreeNodeToggleRecursive","recursive"]},standalone:!0,features:[zi([{provide:VK,useExisting:e}]),vr]});let t=e;return t})();var QTe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[qTe,oi,oi]});let t=e;return t})();var Wwt=["*"],Uwt=[[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],[["","mat-card-image",""],["","matCardImage",""],["","mat-card-sm-image",""],["","matCardImageSmall",""],["","mat-card-md-image",""],["","matCardImageMedium",""],["","mat-card-lg-image",""],["","matCardImageLarge",""],["","mat-card-xl-image",""],["","matCardImageXLarge",""]],"*"],qwt=[`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,`[mat-card-image], [matCardImage],
                    [mat-card-sm-image], [matCardImageSmall],
                    [mat-card-md-image], [matCardImageMedium],
                    [mat-card-lg-image], [matCardImageLarge],
                    [mat-card-xl-image], [matCardImageXLarge]`,"*"],Ywt=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],$wt=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],Gwt=new St("MAT_CARD_CONFIG"),nE=(()=>{let e=class e{constructor(r){this.appearance=r?.appearance||"raised"}};e.\u0275fac=function(n){return new(n||e)(Te(Gwt,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(n,o){n&2&&hi("mat-mdc-card-outlined",o.appearance==="outlined")("mdc-card--outlined",o.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],standalone:!0,features:[zt],ngContentSelectors:Wwt,decls:1,vars:0,template:function(n,o){n&1&&(Br(),Ri(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-app-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-app-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-app-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-app-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-app-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-app-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-app-corner-medium));border-width:var(--mdc-outlined-card-outline-width);border-color:var(--mdc-outlined-card-outline-color, var(--mat-app-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-app-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-app-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-app-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-app-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-app-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-app-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-app-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-app-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-app-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-app-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-app-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-app-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0});let t=e;return t})(),x4=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"],standalone:!0});let t=e;return t})(),S4=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Tt({type:e,selectors:[["mat-card-title-group"]],hostAttrs:[1,"mat-mdc-card-title-group"],standalone:!0,features:[zt],ngContentSelectors:qwt,decls:4,vars:0,template:function(n,o){n&1&&(Br(Uwt),ae(0,"div"),Ri(1),ne(),Ri(2,1),Ri(3,2))},encapsulation:2,changeDetection:0});let t=e;return t})(),oE=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"],standalone:!0});let t=e;return t})(),E4=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=Ot({type:e,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"],standalone:!0});let t=e;return t})();var T4=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Tt({type:e,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],standalone:!0,features:[zt],ngContentSelectors:$wt,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(n,o){n&1&&(Br(Ywt),Ri(0),ae(1,"div",0),Ri(2,1),ne(),Ri(3,2))},encapsulation:2,changeDetection:0});let t=e;return t})();var sE=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,Wn,oi]});let t=e;return t})();var Xwt=(t,e)=>({color:t,"font-weight":e});function Kwt(t,e){t&1&&bt(0,"mat-progress-bar",12)}function Zwt(t,e){if(t&1&&(ae(0,"mat-tree-node",8)(1,"button",9)(2,"mat-icon"),_e(3),ne()(),ae(4,"span",10),_e(5),ne(),wi(6,Kwt,1,0,"mat-progress-bar",11),ne()),t&2){let i=e.$implicit,r=$t();tl("display",r.shouldShowNode(i)?"":"none"),ht("cdkTreeNodeTypeaheadLabel",i.item),Ye(),mi("aria-label","toggle "+i.item),Ye(2),ji(" ",r.treeControl.isExpanded(i)?"expand_more":"chevron_right"," "),Ye(),ht("ngStyle",oA(8,Xwt,i.item===r.current_active?"purple":"black",i.item===r.current_active?"bold":"normal")),Ye(),ji(" ",i.item," "),Ye(),ht("ngIf",i.isLoading())}}function Qwt(t,e){if(t&1&&(ae(0,"mat-tree-node",13),_e(1),ne()),t&2){let i=e.$implicit,r=$t();tl("display",r.shouldShowNode(i)?"":"none"),Ye(),ji(" ",i.item," ")}}function Jwt(t,e){if(t&1){let i=eo();ae(0,"mat-tree-node",13)(1,"button",14),At("click",function(){let n=_i(i).$implicit,o=$t();return yi(o.fullReportButton(n.item.replace("__CARD__","")))}),ae(2,"mat-icon"),_e(3," dashboard "),ne(),_e(4," FULL REPORT "),ne()()}if(t&2){let i=e.$implicit,r=$t();tl("display",r.shouldShowNode(i)?"":"none")}}var $O=class{constructor(e,i,r=1,n=!1,o=iA(!1),s=!1){this.item=e,this.alias=i,this.level=r,this.expandable=n,this.isLoading=o,this.isCardNode=s}},R4=[],eCt=[],Pc=[],Hb=new Map,eRe=(()=>{let e=class e{constructor(r,n){this.http=r,this.database=n,this.dataEvent=new Nt,this.searchString="",this.dataMap2=new Map,this.getLevel=o=>o.level,this.isParentNode=(o,s)=>s.expandable&&!this.isCardNode(o,s),this.hasChild=(o,s)=>this.database.isExpandable(s.item),this.noChild=(o,s)=>!this.hasChild(o,s)&&!this.isCardNode(o,s),this.isCardNode=(o,s)=>s.item.startsWith("__CARD__")}ngOnInit(){this.treeControl=new y4(r=>r.level,r=>r.expandable),this.dataSource=new jK(this.treeControl,this.database,this.http),console.log(this.data),console.log(this.dataMap2)}ngOnChanges(r){if(!this.treeControl||!this.dataSource)return;let n=this.getExpandedNodes();if(this.data!=null){Pc=this.data.alias_data,console.log(Pc),R4=Pc.map(o=>o.name),eCt=Pc.map(o=>o.alias),R4.sort(),Hb.clear();for(let o of R4)Hb.set(o,[])}this.database.changeRootLevelNodes(R4),this.dataSource.data=this.database.initialData(),setTimeout(()=>{this.restoreExpandedNodes(n)})}isExpandable(r){let n=this.dataMap2.get(r),o=!!n&&n.length>0;return console.log(`Checking if "${r}" is expandable: ${o}`),o}nodeMatchesFilter(r){if(!this.searchString)return!0;let n=this.normalizeString(this.searchString),o=this.normalizeString(r.item),s=this.normalizeString(r.alias);return o.includes(n)||s.includes(n)}normalizeString(r){return r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}nodeOrDescendantsMatch(r){return this.nodeMatchesFilter(r)?!0:this.treeControl.getDescendants(r).some(o=>this.nodeMatchesFilter(o))}shouldShowNode(r){if(!this.searchString||this.nodeMatchesFilter(r))return!0;let n=this.getParentNode(r);for(;n;){if(this.nodeMatchesFilter(n))return!0;n=this.getParentNode(n)}return!1}getExpandedNodes(){let r=new Set;return!this.treeControl||!this.treeControl.dataNodes||this.treeControl.dataNodes.forEach(n=>{this.treeControl.isExpanded(n)&&r.add(n.item)}),r}restoreExpandedNodes(r){this.treeControl.dataNodes.forEach(n=>{r.has(n.item)&&this.treeControl.expand(n)})}cardNodeMatchesFilter(r){if(!this.searchString)return!0;let n=r.item.replace("__CARD__","");if(n.toLowerCase().includes(this.searchString.toLowerCase()))return!0;let o=this.treeControl.dataNodes.find(a=>a.item===n);return o?this.treeControl.getDescendants(o).some(a=>a.item.toLowerCase().includes(this.searchString.toLowerCase())):!1}getParentNode(r){let n=this.treeControl.dataNodes.indexOf(r);for(let o=n-1;o>=0;o--){let s=this.treeControl.dataNodes[o];if(s.level<r.level)return s}return null}fullReportButton(r){console.log("Looking for name:",r),console.log("alias_data:",Pc),r==="(All)"&&this.dataEvent.emit(["(All)","(All)"]);let n="";for(let o=0;o<Pc.length;o++)if(console.log(Pc[o]),Pc[o].name===r){n=Pc[o].alias;break}console.log("Found name:",r),console.log("Emitting:",[r,n]),this.dataEvent.emit([r,n])}};e.\u0275fac=function(n){return new(n||e)(Te(ev),Te(tCt))},e.\u0275cmp=Tt({type:e,selectors:[["app-tree"]],inputs:{data:"data",current_active:"current_active"},outputs:{dataEvent:"dataEvent"},standalone:!0,features:[Li,zt],decls:12,vars:13,consts:[[2,"display","flex","flex-direction","column","align-items","center","padding-bottom","30px","position","relative"],[2,"display","flex","justify-content","center","width","100%","margin-top","10px"],[2,"width","190px",3,"ngModelChange","ngModel","placeholder"],["mat-button","",1,"mat-small",2,"margin-left","10px","width","120px","height","32px","border-width","1px","border-style","solid",3,"click"],[2,"padding-top","10px"],[3,"dataSource","treeControl"],["matTreeNodePadding","","matTreeNodeToggle","","style","max-height: 100px; overflow: hidden; text-overflow: ellipsis; width: 100%; font-size: 12px;",3,"display","cdkTreeNodeTypeaheadLabel",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodePadding","",3,"display",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodePadding","","matTreeNodeToggle","",2,"max-height","100px","overflow","hidden","text-overflow","ellipsis","width","100%","font-size","12px",3,"cdkTreeNodeTypeaheadLabel"],["mat-icon-button","","matTreeNodeToggle",""],[3,"ngStyle"],["mode","indeterminate",4,"ngIf"],["mode","indeterminate"],["matTreeNodePadding",""],["mat-button","",1,"mat-small",2,"border-width","1px","font-size","12px","border-style","solid","width","150px","height","35px","margin-left","50px","display","flex","justify-content","flex-start","align-items","center","margin-bottom","10px","gap","8px","text-align","left",3,"click"]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"div",1)(2,"input",2),br(3,"transloco"),QC("ngModelChange",function(a){return ZC(o.searchString,a)||(o.searchString=a),a}),ne(),ae(4,"button",3),At("click",function(){return o.fullReportButton("(All)")}),_e(5),br(6,"transloco"),ne()()(),ae(7,"div",4)(8,"mat-tree",5),wi(9,Zwt,7,11,"mat-tree-node",6)(10,Qwt,2,3,"mat-tree-node",7)(11,Jwt,5,2,"mat-tree-node",7),ne()()),n&2&&(Ye(2),pde("placeholder","",_r(3,9,"Filter")," \u{1F50E}"),KC("ngModel",o.searchString),Ye(3),ji(" ",_r(6,11,"All")," "),Ye(3),ht("dataSource",o.dataSource)("treeControl",o.treeControl),Ye(),ht("matTreeNodeDefWhen",o.isParentNode),Ye(),ht("matTreeNodeDefWhen",o.noChild),Ye(),ht("matTreeNodeDefWhen",o.isCardNode))},dependencies:[QTe,GTe,XTe,ZTe,KTe,$Te,Gu,$d,aI,Gx,Mv,b4,v4,sE,AA,A_,TA,bx,Wn,ex,gL,Dv,Iv],changeDetection:0});let t=e;return t})(),tCt=(()=>{let e=class e{constructor(){this.rootLevelNodesSource=new Ta(["test"]),this.rootLevelNodes$=this.rootLevelNodesSource.asObservable()}initialData(){return this.rootLevelNodesSource.value.map(n=>{let s=Pc.find(a=>a.name===n)?.alias||"";return new $O(n,s,0,this.isExpandable(n))})}getChildren(r){return Hb.get(r)}isExpandable(r){return Hb.has(r)}changeRootLevelNodes(r){this.rootLevelNodesSource.next(r)}updateChildren(r,n,o){Hb.set(r,n);for(let s=0;s<n.length;s++)Hb.set(n[s],[]),Pc.push({alias:o[s],name:n[s]})}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),jK=class{get data(){return this.dataChange.value}set data(e){this._treeControl.dataNodes=e,this.dataChange.next(e)}constructor(e,i,r){this._treeControl=e,this._database=i,this.http=r,this.dataChange=new Ta([])}connect(e){return this._treeControl.expansionModel.changed.subscribe(i=>{(i.added||i.removed)&&this.handleTreeControl(i)}),Ra(e.viewChange,this.dataChange).pipe(Gi(()=>this.data))}disconnect(e){}handleTreeControl(e){e.added&&e.added.forEach(i=>this.toggleNode(i,!0)),e.removed&&e.removed.slice().reverse().forEach(i=>this.toggleNode(i,!1))}toggleNode(e,i){e.isLoading.set(!0),setTimeout(()=>{let n=Pc.find(o=>o.name.trim().toLowerCase()===e.item.trim().toLowerCase())?.alias||"";if(!n){e.isLoading.set(!1);return}if(!i){let o=this.data.indexOf(e);if(o<0)return;let s=0;for(let a=o+1;a<this.data.length&&this.data[a].level>e.level;a++)s++;this.data.splice(o+1,s),this.dataChange.next(this.data),e.isLoading.set(!1);return}this.http.get(`https://borealisdata.ca/api/info/metrics/tree/?parentAlias=${n}`).subscribe(o=>{let s=o?.data?.children?.map(f=>f.name)||[],a=o?.data?.children?.map(f=>f.alias)||[];Hb.set(e.item,s);for(let f=0;f<s.length;f++){let m=s[f],g=a[f];Pc.push({alias:g,name:m}),Hb.set(m,[])}let c=this._database.getChildren(e.item),d=this.data.indexOf(e);if(d<0)return;if(this.data[d+1]?.item===`__CARD__${e.item}`){e.isLoading.set(!1);return}let h=new $O(`__CARD__${e.item}`,"",e.level+1,!1,iA(!1),!0),p=(c||[]).map(f=>{let g=Pc.find(w=>w.name===f)?.alias||"",y=!!this._database.isExpandable(f);return new $O(f,g,e.level+1,y)});this.data.splice(d+1,0,h,...p),this.dataChange.next(this.data),e.isLoading.set(!1)})},500)}};p4();var tRe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Tt({type:e,selectors:[["app-generic-table"]],inputs:{data:"data",colHeaders:"colHeaders",colWidths:"colWidths",rowHeaders:"rowHeaders",height:"height",columnSorting:"columnSorting",columns:"columns",dropdownMenu:"dropdownMenu",filters:"filters"},standalone:!0,features:[zt],decls:1,vars:9,consts:[["licenseKey","non-commercial-and-evaluation",1,"hot","hide-scrollbar",2,"overflow-y","hidden","overflow-y","hidden !important",3,"data","colHeaders","colWidths","rowHeaders","height","columnSorting","columns","dropdownMenu","filters"]],template:function(n,o){n&1&&bt(0,"hot-table",0),n&2&&ht("data",o.data)("colHeaders",o.colHeaders)("colWidths",o.colWidths)("rowHeaders",o.rowHeaders)("height",o.height)("columnSorting",o.columnSorting)("columns",o.columns)("dropdownMenu",o.dropdownMenu)("filters",o.filters)},dependencies:[oB,ICe],styles:["*[_ngcontent-%COMP%]{font-family:Verdana,Helvetica,Arial,FreeSans,sans-serif important!;font-size:12px important!}.hide-scrollbar[_ngcontent-%COMP%]{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.hide-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"]});let t=e;return t})();var iCt=["input"],rCt=["label"],nCt=["*"],oCt=new St("mat-checkbox-default-options",{providedIn:"root",factory:rRe});function rRe(){return{color:"accent",clickAction:"check-indeterminate",disabledInteractive:!1}}var gl=function(t){return t[t.Init=0]="Init",t[t.Checked=1]="Checked",t[t.Unchecked=2]="Unchecked",t[t.Indeterminate=3]="Indeterminate",t}(gl||{}),sCt={provide:R_,useExisting:hc(()=>A4),multi:!0},zK=class{},aCt=0,iRe=rRe(),A4=(()=>{let e=class e{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(r){let n=new zK;return n.source=this,n.checked=r,n}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(r,n,o,s,a,c){this._elementRef=r,this._changeDetectorRef=n,this._ngZone=o,this._animationMode=a,this._options=c,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new Nt,this.indeterminateChange=new Nt,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=gl.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||iRe,this.color=this._options.color||iRe.color,this.tabIndex=parseInt(s)||0,this.id=this._uniqueId=`mat-mdc-checkbox-${++aCt}`,this.disabledInteractive=c?.disabledInteractive??!1}ngOnChanges(r){r.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(r){r!=this.checked&&(this._checked=r,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(r){r!==this.disabled&&(this._disabled=r,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(r){let n=r!=this._indeterminate;this._indeterminate=r,n&&(this._indeterminate?this._transitionCheckState(gl.Indeterminate):this._transitionCheckState(this.checked?gl.Checked:gl.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(r){this.checked=!!r}registerOnChange(r){this._controlValueAccessorChangeFn=r}registerOnTouched(r){this._onTouched=r}setDisabledState(r){this.disabled=r}validate(r){return this.required&&r.value!==!0?{required:!0}:null}registerOnValidatorChange(r){this._validatorChangeFn=r}_transitionCheckState(r){let n=this._currentCheckState,o=this._getAnimationTargetElement();if(!(n===r||!o)&&(this._currentAnimationClass&&o.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(n,r),this._currentCheckState=r,this._currentAnimationClass.length>0)){o.classList.add(this._currentAnimationClass);let s=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{o.classList.remove(s)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){let r=this._options?.clickAction;!this.disabled&&r!=="noop"?(this.indeterminate&&r!=="check"&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?gl.Checked:gl.Unchecked),this._emitChangeEvent()):(this.disabled&&this.disabledInteractive||!this.disabled&&r==="noop")&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate)}_onInteractionEvent(r){r.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(r,n){if(this._animationMode==="NoopAnimations")return"";switch(r){case gl.Init:if(n===gl.Checked)return this._animationClasses.uncheckedToChecked;if(n==gl.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case gl.Unchecked:return n===gl.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case gl.Checked:return n===gl.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case gl.Indeterminate:return n===gl.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(r){let n=this._inputElement;n&&(n.nativeElement.indeterminate=r)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(r){r.target&&this._labelElement.nativeElement.contains(r.target)&&r.stopPropagation()}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(Xi),Te(ni),Jc("tabindex"),Te(rs,8),Te(oCt,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-checkbox"]],viewQuery:function(n,o){if(n&1&&(Ii(iCt,5),Ii(rCt,5),Ii(S_,5)),n&2){let s;ai(s=li())&&(o._inputElement=s.first),ai(s=li())&&(o._labelElement=s.first),ai(s=li())&&(o.ripple=s.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:16,hostBindings:function(n,o){n&2&&(il("id",o.id),mi("tabindex",null)("aria-label",null)("aria-labelledby",null),Aa(o.color?"mat-"+o.color:"mat-accent"),hi("_mat-animation-noopable",o._animationMode==="NoopAnimations")("mdc-checkbox--disabled",o.disabled)("mat-mdc-checkbox-disabled",o.disabled)("mat-mdc-checkbox-checked",o.checked)("mat-mdc-checkbox-disabled-interactive",o.disabledInteractive))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],id:"id",required:[2,"required","required",bi],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[2,"disableRipple","disableRipple",bi],tabIndex:[2,"tabIndex","tabIndex",r=>r==null?void 0:Ia(r)],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",bi],checked:[2,"checked","checked",bi],disabled:[2,"disabled","disabled",bi],indeterminate:[2,"indeterminate","indeterminate",bi]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[zi([sCt,{provide:em,useExisting:e,multi:!0}]),ar,Li,zt],ngContentSelectors:nCt,decls:15,vars:20,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(n,o){if(n&1){let s=eo();Br(),ae(0,"div",3),At("click",function(c){return _i(s),yi(o._preventBubblingFromLabel(c))}),ae(1,"div",4,0)(3,"div",5),At("click",function(){return _i(s),yi(o._onTouchTargetClick())}),ne(),ae(4,"input",6,1),At("blur",function(){return _i(s),yi(o._onBlur())})("click",function(){return _i(s),yi(o._onInputClick())})("change",function(c){return _i(s),yi(o._onInteractionEvent(c))}),ne(),bt(6,"div",7),ae(7,"div",8),cf(),ae(8,"svg",9),bt(9,"path",10),ne(),$C(),bt(10,"div",11),ne(),bt(11,"div",12),ne(),ae(12,"label",13,2),Ri(14),ne()()}if(n&2){let s=Js(2);ht("labelPosition",o.labelPosition),Ye(4),hi("mdc-checkbox--selected",o.checked),ht("checked",o.checked)("indeterminate",o.indeterminate)("disabled",o.disabled&&!o.disabledInteractive)("id",o.inputId)("required",o.required)("tabIndex",o.disabled&&!o.disabledInteractive?-1:o.tabIndex),mi("aria-label",o.ariaLabel||null)("aria-labelledby",o.ariaLabelledby)("aria-describedby",o.ariaDescribedby)("aria-checked",o.indeterminate?"mixed":null)("aria-disabled",o.disabled&&o.disabledInteractive?!0:null)("name",o.name)("value",o.value),Ye(7),ht("matRippleTrigger",s)("matRippleDisabled",o.disableRipple||o.disabled)("matRippleCentered",!0),Ye(),ht("for",o.inputId)}},dependencies:[S_,xue],styles:['.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom;padding:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);margin:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-focus-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity));background-color:var(--mdc-checkbox-selected-hover-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color, var(--mat-app-primary))}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity));background-color:var(--mdc-checkbox-selected-focus-state-layer-color, var(--mat-app-primary))}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));background-color:var(--mdc-checkbox-selected-pressed-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control~.mdc-checkbox__ripple{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;width:var(--mdc-checkbox-state-layer-size, 40px);height:var(--mdc-checkbox-state-layer-size, 40px);top:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);right:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.cdk-high-contrast-active .mdc-checkbox--disabled{opacity:.5}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1);-webkit-print-color-adjust:exact;color-adjust:exact;border-color:var(--mdc-checkbox-unselected-icon-color, var(--mat-app-on-surface-variant));top:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2)}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-icon-color, var(--mat-app-primary))}.mdc-checkbox--disabled .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color)}.mdc-checkbox__native-control:disabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:disabled:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color);border-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:not(:checked)~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color, var(--mat-app-on-surface));background-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mat-app-primary))}.mdc-checkbox__native-control:focus:focus:not(:checked)~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color, var(--mat-app-on-surface))}.mdc-checkbox__native-control:focus:focus:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mat-app-primary))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox:hover .mdc-checkbox__native-control~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color)}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color);border-color:rgba(0,0,0,0)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms cubic-bezier(0.4, 0, 0.6, 1);color:var(--mdc-checkbox-selected-checkmark-color, var(--mat-app-on-primary))}.cdk-high-contrast-active .mdc-checkbox__checkmark{color:CanvasText}.mdc-checkbox--disabled .mdc-checkbox__checkmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color, var(--mat-app-surface))}.cdk-high-contrast-active .mdc-checkbox--disabled .mdc-checkbox__checkmark,.cdk-high-contrast-active .mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__checkmark{color:CanvasText}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);border-color:var(--mdc-checkbox-selected-checkmark-color, var(--mat-app-on-primary))}.cdk-high-contrast-active .mdc-checkbox__mixedmark{margin:0 1px}.mdc-checkbox--disabled .mdc-checkbox__mixedmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color, var(--mat-app-surface))}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms cubic-bezier(0, 0, 0.2, 1),transform 180ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *,.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox .mat-internal-form-field{color:var(--mat-checkbox-label-text-color, var(--mat-app-on-surface));font-family:var(--mat-checkbox-label-text-font, var(--mat-app-body-medium-font));line-height:var(--mat-checkbox-label-text-line-height, var(--mat-app-body-medium-line-height));font-size:var(--mat-checkbox-label-text-size, var(--mat-app-body-medium-size));letter-spacing:var(--mat-checkbox-label-text-tracking, var(--mat-app-body-medium-tracking));font-weight:var(--mat-checkbox-label-text-weight, var(--mat-app-body-medium-weight))}.mat-mdc-checkbox.mat-mdc-checkbox-disabled.mat-mdc-checkbox-disabled-interactive{pointer-events:auto}.mat-mdc-checkbox.mat-mdc-checkbox-disabled.mat-mdc-checkbox-disabled-interactive input{cursor:default}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0});let t=e;return t})();var nRe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[A4,oi,oi]});let t=e;return t})();var E9e=U(P7e()),T9e=U(L7e());var Dn=U(TYe());import{createRequire as dGt}from"module";var uGt=dGt("/"),hGt;try{hGt=uGt("worker_threads").Worker}catch{}var El=Uint8Array,Id=Uint16Array,wce=Int32Array,Ez=new El([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tz=new El([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vce=new El([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),V7e=function(t,e){for(var i=new Id(31),r=0;r<31;++r)i[r]=e+=1<<t[r-1];for(var n=new wce(i[30]),r=1;r<30;++r)for(var o=i[r];o<i[r+1];++o)n[o]=o-i[r]<<5|r;return{b:i,r:n}},j7e=V7e(Ez,2),z7e=j7e.b,bce=j7e.r;z7e[28]=258,bce[258]=28;var W7e=V7e(Tz,0),fGt=W7e.b,F7e=W7e.r,_ce=new Id(32768);for(rn=0;rn<32768;++rn)Tg=(rn&43690)>>1|(rn&21845)<<1,Tg=(Tg&52428)>>2|(Tg&13107)<<2,Tg=(Tg&61680)>>4|(Tg&3855)<<4,_ce[rn]=((Tg&65280)>>8|(Tg&255)<<8)>>1;var Tg,rn,Dp=function(t,e,i){for(var r=t.length,n=0,o=new Id(e);n<r;++n)t[n]&&++o[t[n]-1];var s=new Id(e);for(n=1;n<e;++n)s[n]=s[n-1]+o[n-1]<<1;var a;if(i){a=new Id(1<<e);var c=15-e;for(n=0;n<r;++n)if(t[n])for(var d=n<<4|t[n],u=e-t[n],h=s[t[n]-1]++<<u,p=h|(1<<u)-1;h<=p;++h)a[_ce[h]>>c]=d}else for(a=new Id(r),n=0;n<r;++n)t[n]&&(a[n]=_ce[s[t[n]-1]++]>>15-t[n]);return a},V0=new El(288);for(rn=0;rn<144;++rn)V0[rn]=8;var rn;for(rn=144;rn<256;++rn)V0[rn]=9;var rn;for(rn=256;rn<280;++rn)V0[rn]=7;var rn;for(rn=280;rn<288;++rn)V0[rn]=8;var rn,PP=new El(32);for(rn=0;rn<32;++rn)PP[rn]=5;var rn,pGt=Dp(V0,9,0),mGt=Dp(V0,9,1),gGt=Dp(PP,5,0),vGt=Dp(PP,5,1),pce=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},Ph=function(t,e,i){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&i},mce=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(e&7)},Cce=function(t){return(t+7)/8|0},U7e=function(t,e,i){return(e==null||e<0)&&(e=0),(i==null||i>t.length)&&(i=t.length),new El(t.subarray(e,i))};var bGt=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Lh=function(t,e,i){var r=new Error(e||bGt[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,Lh),!i)throw r;return r},_Gt=function(t,e,i,r){var n=t.length,o=r?r.length:0;if(!n||e.f&&!e.l)return i||new El(0);var s=!i,a=s||e.i!=2,c=e.i;s&&(i=new El(n*3));var d=function(Le){var Ne=i.length;if(Le>Ne){var it=new El(Math.max(Ne*2,Le));it.set(i),i=it}},u=e.f||0,h=e.p||0,p=e.b||0,f=e.l,m=e.d,g=e.m,y=e.n,w=n*8;do{if(!f){u=Ph(t,h,1);var x=Ph(t,h+1,3);if(h+=3,x)if(x==1)f=mGt,m=vGt,g=9,y=5;else if(x==2){var G=Ph(t,h,31)+257,F=Ph(t,h+10,15)+4,O=G+Ph(t,h+5,31)+1;h+=14;for(var V=new El(O),J=new El(19),N=0;N<F;++N)J[vce[N]]=Ph(t,h+N*3,7);h+=F*3;for(var P=pce(J),$=(1<<P)-1,K=Dp(J,P,1),N=0;N<O;){var ve=K[Ph(t,h,$)];h+=ve&15;var T=ve>>4;if(T<16)V[N++]=T;else{var W=0,ee=0;for(T==16?(ee=3+Ph(t,h,3),h+=2,W=V[N-1]):T==17?(ee=3+Ph(t,h,7),h+=3):T==18&&(ee=11+Ph(t,h,127),h+=7);ee--;)V[N++]=W}}var te=V.subarray(0,G),se=V.subarray(G);g=pce(te),y=pce(se),f=Dp(te,g,1),m=Dp(se,y,1)}else Lh(1);else{var T=Cce(h)+4,M=t[T-4]|t[T-3]<<8,B=T+M;if(B>n){c&&Lh(0);break}a&&d(p+M),i.set(t.subarray(T,B),p),e.b=p+=M,e.p=h=B*8,e.f=u;continue}if(h>w){c&&Lh(0);break}}a&&d(p+131072);for(var Ae=(1<<g)-1,k=(1<<y)-1,S=h;;S=h){var W=f[mce(t,h)&Ae],I=W>>4;if(h+=W&15,h>w){c&&Lh(0);break}if(W||Lh(2),I<256)i[p++]=I;else if(I==256){S=h,f=null;break}else{var X=I-254;if(I>264){var N=I-257,Q=Ez[N];X=Ph(t,h,(1<<Q)-1)+z7e[N],h+=Q}var le=m[mce(t,h)&k],xe=le>>4;le||Lh(3),h+=le&15;var se=fGt[xe];if(xe>3){var Q=Tz[xe];se+=mce(t,h)&(1<<Q)-1,h+=Q}if(h>w){c&&Lh(0);break}a&&d(p+131072);var Re=p+X;if(p<se){var Oe=o-se,We=Math.min(se,Re);for(Oe+p<0&&Lh(3);p<We;++p)i[p]=r[Oe+p]}for(;p<Re;++p)i[p]=i[p-se]}}e.l=f,e.p=S,e.b=p,e.f=u,f&&(u=1,e.m=g,e.d=m,e.n=y)}while(!u);return p!=i.length&&s?U7e(i,0,p):i.subarray(0,p)},Rg=function(t,e,i){i<<=e&7;var r=e/8|0;t[r]|=i,t[r+1]|=i>>8},OP=function(t,e,i){i<<=e&7;var r=e/8|0;t[r]|=i,t[r+1]|=i>>8,t[r+2]|=i>>16},gce=function(t,e){for(var i=[],r=0;r<t.length;++r)t[r]&&i.push({s:r,f:t[r]});var n=i.length,o=i.slice();if(!n)return{t:Y7e,l:0};if(n==1){var s=new El(i[0].s+1);return s[i[0].s]=1,{t:s,l:1}}i.sort(function(B,G){return B.f-G.f}),i.push({s:-1,f:25001});var a=i[0],c=i[1],d=0,u=1,h=2;for(i[0]={s:-1,f:a.f+c.f,l:a,r:c};u!=n-1;)a=i[i[d].f<i[h].f?d++:h++],c=i[d!=u&&i[d].f<i[h].f?d++:h++],i[u++]={s:-1,f:a.f+c.f,l:a,r:c};for(var p=o[0].s,r=1;r<n;++r)o[r].s>p&&(p=o[r].s);var f=new Id(p+1),m=yce(i[u-1],f,0);if(m>e){var r=0,g=0,y=m-e,w=1<<y;for(o.sort(function(G,F){return f[F.s]-f[G.s]||G.f-F.f});r<n;++r){var x=o[r].s;if(f[x]>e)g+=w-(1<<m-f[x]),f[x]=e;else break}for(g>>=y;g>0;){var T=o[r].s;f[T]<e?g-=1<<e-f[T]++-1:++r}for(;r>=0&&g;--r){var M=o[r].s;f[M]==e&&(--f[M],++g)}m=e}return{t:new El(f),l:m}},yce=function(t,e,i){return t.s==-1?Math.max(yce(t.l,e,i+1),yce(t.r,e,i+1)):e[t.s]=i},H7e=function(t){for(var e=t.length;e&&!t[--e];);for(var i=new Id(++e),r=0,n=t[0],o=1,s=function(c){i[r++]=c},a=1;a<=e;++a)if(t[a]==n&&a!=e)++o;else{if(!n&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(n),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(n);o=1,n=t[a]}return{c:i.subarray(0,r),n:e}},NP=function(t,e){for(var i=0,r=0;r<e.length;++r)i+=t[r]*e[r];return i},q7e=function(t,e,i){var r=i.length,n=Cce(e+2);t[n]=r&255,t[n+1]=r>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var o=0;o<r;++o)t[n+o+4]=i[o];return(n+4+r)*8},B7e=function(t,e,i,r,n,o,s,a,c,d,u){Rg(e,u++,i),++n[256];for(var h=gce(n,15),p=h.t,f=h.l,m=gce(o,15),g=m.t,y=m.l,w=H7e(p),x=w.c,T=w.n,M=H7e(g),B=M.c,G=M.n,F=new Id(19),O=0;O<x.length;++O)++F[x[O]&31];for(var O=0;O<B.length;++O)++F[B[O]&31];for(var V=gce(F,7),J=V.t,N=V.l,P=19;P>4&&!J[vce[P-1]];--P);var $=d+5<<3,K=NP(n,V0)+NP(o,PP)+s,ve=NP(n,p)+NP(o,g)+s+14+3*P+NP(F,J)+2*F[16]+3*F[17]+7*F[18];if(c>=0&&$<=K&&$<=ve)return q7e(e,u,t.subarray(c,c+d));var W,ee,te,se;if(Rg(e,u,1+(ve<K)),u+=2,ve<K){W=Dp(p,f,0),ee=p,te=Dp(g,y,0),se=g;var Ae=Dp(J,N,0);Rg(e,u,T-257),Rg(e,u+5,G-1),Rg(e,u+10,P-4),u+=14;for(var O=0;O<P;++O)Rg(e,u+3*O,J[vce[O]]);u+=3*P;for(var k=[x,B],S=0;S<2;++S)for(var I=k[S],O=0;O<I.length;++O){var X=I[O]&31;Rg(e,u,Ae[X]),u+=J[X],X>15&&(Rg(e,u,I[O]>>5&127),u+=I[O]>>12)}}else W=pGt,ee=V0,te=gGt,se=PP;for(var O=0;O<a;++O){var Q=r[O];if(Q>255){var X=Q>>18&31;OP(e,u,W[X+257]),u+=ee[X+257],X>7&&(Rg(e,u,Q>>23&31),u+=Ez[X]);var le=Q&31;OP(e,u,te[le]),u+=se[le],le>3&&(OP(e,u,Q>>5&8191),u+=Tz[le])}else OP(e,u,W[Q]),u+=ee[Q]}return OP(e,u,W[256]),u+ee[256]},yGt=new wce([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Y7e=new El(0),wGt=function(t,e,i,r,n,o){var s=o.z||t.length,a=new El(r+s+5*(1+Math.ceil(s/7e3))+n),c=a.subarray(r,a.length-n),d=o.l,u=(o.r||0)&7;if(e){u&&(c[0]=o.r>>3);for(var h=yGt[e-1],p=h>>13,f=h&8191,m=(1<<i)-1,g=o.p||new Id(32768),y=o.h||new Id(m+1),w=Math.ceil(i/3),x=2*w,T=function(ct){return(t[ct]^t[ct+1]<<w^t[ct+2]<<x)&m},M=new wce(25e3),B=new Id(288),G=new Id(32),F=0,O=0,V=o.i||0,J=0,N=o.w||0,P=0;V+2<s;++V){var $=T(V),K=V&32767,ve=y[$];if(g[K]=ve,y[$]=K,N<=V){var W=s-V;if((F>7e3||J>24576)&&(W>423||!d)){u=B7e(t,c,0,M,B,G,O,J,P,V-P,u),J=F=O=0,P=V;for(var ee=0;ee<286;++ee)B[ee]=0;for(var ee=0;ee<30;++ee)G[ee]=0}var te=2,se=0,Ae=f,k=K-ve&32767;if(W>2&&$==T(V-k))for(var S=Math.min(p,W)-1,I=Math.min(32767,V),X=Math.min(258,W);k<=I&&--Ae&&K!=ve;){if(t[V+te]==t[V+te-k]){for(var Q=0;Q<X&&t[V+Q]==t[V+Q-k];++Q);if(Q>te){if(te=Q,se=k,Q>S)break;for(var le=Math.min(k,Q-2),xe=0,ee=0;ee<le;++ee){var Re=V-k+ee&32767,Oe=g[Re],We=Re-Oe&32767;We>xe&&(xe=We,ve=Re)}}}K=ve,ve=g[K],k+=K-ve&32767}if(se){M[J++]=268435456|bce[te]<<18|F7e[se];var Le=bce[te]&31,Ne=F7e[se]&31;O+=Ez[Le]+Tz[Ne],++B[257+Le],++G[Ne],N=V+te,++F}else M[J++]=t[V],++B[t[V]]}}for(V=Math.max(V,N);V<s;++V)M[J++]=t[V],++B[t[V]];u=B7e(t,c,d,M,B,G,O,J,P,V-P,u),d||(o.r=u&7|c[u/8|0]<<3,u-=7,o.h=y,o.p=g,o.i=V,o.w=N)}else{for(var V=o.w||0;V<s+d;V+=65535){var it=V+65535;it>=s&&(c[u/8|0]=d,it=s),u=q7e(c,u+1,t.subarray(V,it))}o.i=s}return U7e(a,0,r+Cce(u)+n)};var $7e=function(){var t=1,e=0;return{p:function(i){for(var r=t,n=e,o=i.length|0,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)n+=r+=i[s];r=(r&65535)+15*(r>>16),n=(n&65535)+15*(n>>16)}t=r,e=n},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},CGt=function(t,e,i,r,n){if(!n&&(n={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new El(o.length+t.length);s.set(o),s.set(t,o.length),t=s,n.w=o.length}return wGt(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,i,r,n)};var G7e=function(t,e,i){for(;i;++e)t[e]=i,i>>>=8};var xGt=function(t,e){var i=e.level,r=i==0?0:i<6?1:i==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var n=$7e();n.p(e.dictionary),G7e(t,2,n.d())}},SGt=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Lh(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&Lh(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Rz(t,e){e||(e={});var i=$7e();i.p(t);var r=CGt(t,e,e.dictionary?6:2,4);return xGt(r,e),G7e(r,r.length-4,i.d()),r}function X7e(t,e){return _Gt(t.subarray(SGt(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var EGt=typeof TextDecoder<"u"&&new TextDecoder,TGt=0;try{EGt.decode(Y7e,{stream:!0}),TGt=1}catch{}var Di=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function xce(){Di.console&&typeof Di.console.log=="function"&&Di.console.log.apply(Di.console,arguments)}var Hn={log:xce,warn:function(t){Di.console&&(typeof Di.console.warn=="function"?Di.console.warn.apply(Di.console,arguments):xce.call(null,arguments))},error:function(t){Di.console&&(typeof Di.console.error=="function"?Di.console.error.apply(Di.console,arguments):xce(t))}};function Sce(t,e,i){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){hC(r.response,e,i)},r.onerror=function(){Hn.error("could not download file")},r.send()}function K7e(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Az(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var LP,Ice,hC=Di.saveAs||((typeof window>"u"?"undefined":(0,Dn.default)(window))!=="object"||window!==Di?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,i){var r=Di.URL||Di.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?K7e(n.href)?Sce(t,e,i):Az(n,n.target="_blank"):Az(n)):(n.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(n.href)},4e4),setTimeout(function(){Az(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,i){if(e=e||t.name||"download",typeof t=="string")if(K7e(t))Sce(t,e,i);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Az(r)})}else navigator.msSaveOrOpenBlob(function(n,o){return o===void 0?o={autoBom:!1}:(0,Dn.default)(o)!=="object"&&(Hn.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(t,i),e)}:function(t,e,i,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return Sce(t,e,i);var n=t.type==="application/octet-stream",o=/constructor/i.test(Di.HTMLElement)||Di.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||n&&o)&&(typeof FileReader>"u"?"undefined":(0,Dn.default)(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var u=a.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=u:location=u,r=null},a.readAsDataURL(t)}else{var c=Di.URL||Di.webkitURL,d=c.createObjectURL(t);r?r.location=d:location.href=d,r=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});function f9e(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<i.length;r++){var n=i[r].re,o=i[r].process,s=n.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+a+c+d}}function Ece(t,e){var i=t[0],r=t[1],n=t[2],o=t[3];i=Tl(i,r,n,o,e[0],7,-680876936),o=Tl(o,i,r,n,e[1],12,-389564586),n=Tl(n,o,i,r,e[2],17,606105819),r=Tl(r,n,o,i,e[3],22,-1044525330),i=Tl(i,r,n,o,e[4],7,-176418897),o=Tl(o,i,r,n,e[5],12,1200080426),n=Tl(n,o,i,r,e[6],17,-1473231341),r=Tl(r,n,o,i,e[7],22,-45705983),i=Tl(i,r,n,o,e[8],7,1770035416),o=Tl(o,i,r,n,e[9],12,-1958414417),n=Tl(n,o,i,r,e[10],17,-42063),r=Tl(r,n,o,i,e[11],22,-1990404162),i=Tl(i,r,n,o,e[12],7,1804603682),o=Tl(o,i,r,n,e[13],12,-40341101),n=Tl(n,o,i,r,e[14],17,-1502002290),i=Rl(i,r=Tl(r,n,o,i,e[15],22,1236535329),n,o,e[1],5,-165796510),o=Rl(o,i,r,n,e[6],9,-1069501632),n=Rl(n,o,i,r,e[11],14,643717713),r=Rl(r,n,o,i,e[0],20,-373897302),i=Rl(i,r,n,o,e[5],5,-701558691),o=Rl(o,i,r,n,e[10],9,38016083),n=Rl(n,o,i,r,e[15],14,-660478335),r=Rl(r,n,o,i,e[4],20,-405537848),i=Rl(i,r,n,o,e[9],5,568446438),o=Rl(o,i,r,n,e[14],9,-1019803690),n=Rl(n,o,i,r,e[3],14,-187363961),r=Rl(r,n,o,i,e[8],20,1163531501),i=Rl(i,r,n,o,e[13],5,-1444681467),o=Rl(o,i,r,n,e[2],9,-51403784),n=Rl(n,o,i,r,e[7],14,1735328473),i=Al(i,r=Rl(r,n,o,i,e[12],20,-1926607734),n,o,e[5],4,-378558),o=Al(o,i,r,n,e[8],11,-2022574463),n=Al(n,o,i,r,e[11],16,1839030562),r=Al(r,n,o,i,e[14],23,-35309556),i=Al(i,r,n,o,e[1],4,-1530992060),o=Al(o,i,r,n,e[4],11,1272893353),n=Al(n,o,i,r,e[7],16,-155497632),r=Al(r,n,o,i,e[10],23,-1094730640),i=Al(i,r,n,o,e[13],4,681279174),o=Al(o,i,r,n,e[0],11,-358537222),n=Al(n,o,i,r,e[3],16,-722521979),r=Al(r,n,o,i,e[6],23,76029189),i=Al(i,r,n,o,e[9],4,-640364487),o=Al(o,i,r,n,e[12],11,-421815835),n=Al(n,o,i,r,e[15],16,530742520),i=Il(i,r=Al(r,n,o,i,e[2],23,-995338651),n,o,e[0],6,-198630844),o=Il(o,i,r,n,e[7],10,1126891415),n=Il(n,o,i,r,e[14],15,-1416354905),r=Il(r,n,o,i,e[5],21,-57434055),i=Il(i,r,n,o,e[12],6,1700485571),o=Il(o,i,r,n,e[3],10,-1894986606),n=Il(n,o,i,r,e[10],15,-1051523),r=Il(r,n,o,i,e[1],21,-2054922799),i=Il(i,r,n,o,e[8],6,1873313359),o=Il(o,i,r,n,e[15],10,-30611744),n=Il(n,o,i,r,e[6],15,-1560198380),r=Il(r,n,o,i,e[13],21,1309151649),i=Il(i,r,n,o,e[4],6,-145523070),o=Il(o,i,r,n,e[11],10,-1120210379),n=Il(n,o,i,r,e[2],15,718787259),r=Il(r,n,o,i,e[9],21,-343485551),t[0]=z0(i,t[0]),t[1]=z0(r,t[1]),t[2]=z0(n,t[2]),t[3]=z0(o,t[3])}function Hz(t,e,i,r,n,o){return e=z0(z0(e,t),z0(r,o)),z0(e<<n|e>>>32-n,i)}function Tl(t,e,i,r,n,o,s){return Hz(e&i|~e&r,t,e,n,o,s)}function Rl(t,e,i,r,n,o,s){return Hz(e&r|i&~r,t,e,n,o,s)}function Al(t,e,i,r,n,o,s){return Hz(e^i^r,t,e,n,o,s)}function Il(t,e,i,r,n,o,s){return Hz(i^(e|~r),t,e,n,o,s)}function p9e(t){var e,i=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Ece(r,RGt(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(Ece(r,n),e=0;e<16;e++)n[e]=0;return n[14]=8*i,Ece(r,n),r}function RGt(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i}LP=Di.atob.bind(Di),Ice=Di.btoa.bind(Di);var Z7e="0123456789abcdef".split("");function AGt(t){for(var e="",i=0;i<4;i++)e+=Z7e[t>>8*i+4&15]+Z7e[t>>8*i&15];return e}function IGt(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Dce(t){return p9e(t).map(IGt).join("")}var DGt=function(t){for(var e=0;e<t.length;e++)t[e]=AGt(t[e]);return t.join("")}(p9e("hello"))!="5d41402abc4b2a76b9719d911017c592";function z0(t,e){if(DGt){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}return t+e&4294967295}function Mce(t,e){var i,r,n,o;if(t!==i){for(var s=(n=t,o=1+(256/t.length>>0),new Array(o+1).join(n)),a=[],c=0;c<256;c++)a[c]=c;var d=0;for(c=0;c<256;c++){var u=a[c];d=(d+u+s.charCodeAt(c))%256,a[c]=a[d],a[d]=u}i=t,r=a}else a=r;var h=e.length,p=0,f=0,m="";for(c=0;c<h;c++)f=(f+(u=a[p=(p+1)%256]))%256,a[p]=a[f],a[f]=u,s=a[(a[p]+a[f])%256],m+=String.fromCharCode(e.charCodeAt(c)^s);return m}var Q7e={print:4,modify:8,copy:16,"annot-forms":32};function fR(t,e,i,r){this.v=1,this.r=2;var n=192;t.forEach(function(a){if(Q7e.perm!==void 0)throw new Error("Invalid permission: "+a);n+=Q7e[a]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var o=(e+this.padding).substr(0,32),s=(i+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^n)),this.encryptionKey=Dce(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Mce(this.encryptionKey,this.padding)}function pR(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",i=t.length,r=0;r<i;r++){var n=t.charCodeAt(r);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?e+="#"+("0"+n.toString(16)).slice(-2):e+=t[r]}return e}function J7e(t){if((0,Dn.default)(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(i,r,n){if(n=n||!1,typeof i!="string"||typeof r!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(i)||(e[i]={});var o=Math.random().toString(35);return e[i][o]=[r,!!n],o},this.unsubscribe=function(i){for(var r in e)if(e[r][i])return delete e[r][i],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(i){if(e.hasOwnProperty(i)){var r=Array.prototype.slice.call(arguments,1),n=[];for(var o in e[i]){var s=e[i][o];try{s[0].apply(t,r)}catch(a){Di.console&&Hn.error("jsPDF PubSub Error",a.message,a)}s[1]&&n.push(o)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Lz(t){if(!(this instanceof Lz))return new Lz(t);var e="opacity,stroke-opacity".split(",");for(var i in t)t.hasOwnProperty(i)&&e.indexOf(i)>=0&&(this[i]=t[i]);this.id="",this.objectNumber=-1}function m9e(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function fC(t,e,i,r,n){if(!(this instanceof fC))return new fC(t,e,i,r,n);this.type=t==="axial"?2:3,this.coords=e,this.colors=i,m9e.call(this,r,n)}function mR(t,e,i,r,n){if(!(this instanceof mR))return new mR(t,e,i,r,n);this.boundingBox=t,this.xStep=e,this.yStep=i,this.stream="",this.cloneIndex=0,m9e.call(this,r,n)}function Ti(t){var e,i=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],n=arguments[2],o=arguments[3],s=[],a=1,c=16,d="S",u=null;(0,Dn.default)(t=t||{})==="object"&&(i=t.orientation,r=t.unit||r,n=t.format||n,o=t.compress||t.compressPdf||o,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),a=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),r=r||"mm",i=(""+(i||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,p={},f={internal:{},__private__:{}};f.__private__.PubSub=J7e;var m="1.3",g=f.__private__.getPdfVersion=function(){return m};f.__private__.setPdfVersion=function(R){m=R};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return y};var w=f.__private__.getPageFormat=function(R){return y[R]};n=n||"a4";var x={COMPAT:"compat",ADVANCED:"advanced"},T=x.COMPAT;function M(){this.saveGraphicsState(),Se(new Rt(Ie,0,0,-Ie,0,$h()*Ie).toString()+" cm"),this.setFontSize(this.getFontSize()/Ie),d="n",T=x.ADVANCED}function B(){this.restoreGraphicsState(),d="S",T=x.COMPAT}var G=f.__private__.combineFontStyleAndFontWeight=function(R,re){if(R=="bold"&&re=="normal"||R=="bold"&&re==400||R=="normal"&&re=="italic"||R=="bold"&&re=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return re&&(R=re==400||re==="normal"?R==="italic"?"italic":"normal":re!=700&&re!=="bold"||R!=="normal"?(re==700?"bold":re)+""+R:"bold"),R};f.advancedAPI=function(R){var re=T===x.COMPAT;return re&&M.call(this),typeof R!="function"||(R(this),re&&B.call(this)),this},f.compatAPI=function(R){var re=T===x.ADVANCED;return re&&B.call(this),typeof R!="function"||(R(this),re&&M.call(this)),this},f.isAdvancedAPI=function(){return T===x.ADVANCED};var F,O=function(R){if(T!==x.ADVANCED)throw new Error(R+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},V=f.roundToPrecision=f.__private__.roundToPrecision=function(R,re){var De=e||re;if(isNaN(R)||isNaN(De))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return R.toFixed(De).replace(/0+$/,"")};F=f.hpf=f.__private__.hpf=typeof c=="number"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return V(R,c)}:c==="smart"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return V(R,R>-1&&R<1?16:5)}:function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return V(R,16)};var J=f.f2=f.__private__.f2=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f2");return V(R,2)},N=f.__private__.f3=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f3");return V(R,3)},P=f.scale=f.__private__.scale=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.scale");return T===x.COMPAT?R*Ie:T===x.ADVANCED?R:void 0},$=function(R){return T===x.COMPAT?$h()-R:T===x.ADVANCED?R:void 0},K=function(R){return P($(R))};f.__private__.setPrecision=f.setPrecision=function(R){typeof parseInt(R,10)=="number"&&(e=parseInt(R,10))};var ve,W="00000000000000000000000000000000",ee=f.__private__.getFileId=function(){return W},te=f.__private__.setFileId=function(R){return W=R!==void 0&&/^[a-fA-F0-9]{32}$/.test(R)?R.toUpperCase():W.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Xs=new fR(u.userPermissions,u.userPassword,u.ownerPassword,W)),W};f.setFileId=function(R){return te(R),this},f.getFileId=function(){return ee()};var se=f.__private__.convertDateToPDFDate=function(R){var re=R.getTimezoneOffset(),De=re<0?"+":"-",Fe=Math.floor(Math.abs(re/60)),qe=Math.abs(re%60),tt=[De,X(Fe),"'",X(qe),"'"].join("");return["D:",R.getFullYear(),X(R.getMonth()+1),X(R.getDate()),X(R.getHours()),X(R.getMinutes()),X(R.getSeconds()),tt].join("")},Ae=f.__private__.convertPDFDateToDate=function(R){var re=parseInt(R.substr(2,4),10),De=parseInt(R.substr(6,2),10)-1,Fe=parseInt(R.substr(8,2),10),qe=parseInt(R.substr(10,2),10),tt=parseInt(R.substr(12,2),10),pt=parseInt(R.substr(14,2),10);return new Date(re,De,Fe,qe,tt,pt,0)},k=f.__private__.setCreationDate=function(R){var re;if(R===void 0&&(R=new Date),R instanceof Date)re=se(R);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(R))throw new Error("Invalid argument passed to jsPDF.setCreationDate");re=R}return ve=re},S=f.__private__.getCreationDate=function(R){var re=ve;return R==="jsDate"&&(re=Ae(ve)),re};f.setCreationDate=function(R){return k(R),this},f.getCreationDate=function(R){return S(R)};var I,X=f.__private__.padd2=function(R){return("0"+parseInt(R)).slice(-2)},Q=f.__private__.padd2Hex=function(R){return("00"+(R=R.toString())).substr(R.length)},le=0,xe=[],Re=[],Oe=0,We=[],Le=[],Ne=!1,it=Re,ct=function(){le=0,Oe=0,Re=[],xe=[],We=[],Qo=on(),Jo=on()};f.__private__.setCustomOutputDestination=function(R){Ne=!0,it=R};var Ue=function(R){Ne||(it=R)};f.__private__.resetCustomOutputDestination=function(){Ne=!1,it=Re};var Se=f.__private__.out=function(R){return R=R.toString(),Oe+=R.length+1,it.push(R),it},gt=f.__private__.write=function(R){return Se(arguments.length===1?R.toString():Array.prototype.join.call(arguments," "))},ce=f.__private__.getArrayBuffer=function(R){for(var re=R.length,De=new ArrayBuffer(re),Fe=new Uint8Array(De);re--;)Fe[re]=R.charCodeAt(re);return De},de=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return de};var ye=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(R){return ye=T===x.ADVANCED?R/Ie:R,this};var Me,pe=f.__private__.getFontSize=f.getFontSize=function(){return T===x.COMPAT?ye:ye*Ie},ue=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(R){return ue=R,this},f.__private__.getR2L=f.getR2L=function(){return ue};var A,L=f.__private__.setZoomMode=function(R){var re=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(R))Me=R;else if(isNaN(R)){if(re.indexOf(R)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+R+'" is not recognized.');Me=R}else Me=parseInt(R,10)};f.__private__.getZoomMode=function(){return Me};var Y,Z=f.__private__.setPageMode=function(R){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(R)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+R+'" is not recognized.');A=R};f.__private__.getPageMode=function(){return A};var fe=f.__private__.setLayoutMode=function(R){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(R)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+R+'" is not recognized.');Y=R};f.__private__.getLayoutMode=function(){return Y},f.__private__.setDisplayMode=f.setDisplayMode=function(R,re,De){return L(R),fe(re),Z(De),this};var we={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(R){if(Object.keys(we).indexOf(R)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return we[R]},f.__private__.getDocumentProperties=function(){return we},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(R){for(var re in we)we.hasOwnProperty(re)&&R[re]&&(we[re]=R[re]);return this},f.__private__.setDocumentProperty=function(R,re){if(Object.keys(we).indexOf(R)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return we[R]=re};var ke,Ie,ze,rt,yt,st={},vt={},di=[],fi={},fo={},mr={},Bn={},vs=null,ft=0,ii=[],pi=new J7e(f),va=t.hotfixes||[],nn={},Oi={},ec=[],Rt=function R(re,De,Fe,qe,tt,pt){if(!(this instanceof R))return new R(re,De,Fe,qe,tt,pt);isNaN(re)&&(re=1),isNaN(De)&&(De=0),isNaN(Fe)&&(Fe=0),isNaN(qe)&&(qe=1),isNaN(tt)&&(tt=0),isNaN(pt)&&(pt=0),this._matrix=[re,De,Fe,qe,tt,pt]};Object.defineProperty(Rt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(Rt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(Rt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(Rt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(Rt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(Rt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(Rt.prototype,"a",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(Rt.prototype,"b",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(Rt.prototype,"c",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(Rt.prototype,"d",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(Rt.prototype,"e",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(Rt.prototype,"f",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(Rt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Rt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Rt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Rt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Rt.prototype.join=function(R){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(F).join(R)},Rt.prototype.multiply=function(R){var re=R.sx*this.sx+R.shy*this.shx,De=R.sx*this.shy+R.shy*this.sy,Fe=R.shx*this.sx+R.sy*this.shx,qe=R.shx*this.shy+R.sy*this.sy,tt=R.tx*this.sx+R.ty*this.shx+this.tx,pt=R.tx*this.shy+R.ty*this.sy+this.ty;return new Rt(re,De,Fe,qe,tt,pt)},Rt.prototype.decompose=function(){var R=this.sx,re=this.shy,De=this.shx,Fe=this.sy,qe=this.tx,tt=this.ty,pt=Math.sqrt(R*R+re*re),It=(R/=pt)*De+(re/=pt)*Fe;De-=R*It,Fe-=re*It;var ui=Math.sqrt(De*De+Fe*Fe);return It/=ui,R*(Fe/=ui)<re*(De/=ui)&&(R=-R,re=-re,It=-It,pt=-pt),{scale:new Rt(pt,0,0,ui,0,0),translate:new Rt(1,0,0,1,qe,tt),rotate:new Rt(R,re,-re,R,0,0),skew:new Rt(1,0,It,1,0,0)}},Rt.prototype.toString=function(R){return this.join(" ")},Rt.prototype.inversed=function(){var R=this.sx,re=this.shy,De=this.shx,Fe=this.sy,qe=this.tx,tt=this.ty,pt=1/(R*Fe-re*De),It=Fe*pt,ui=-re*pt,Pi=-De*pt,Fi=R*pt;return new Rt(It,ui,Pi,Fi,-It*qe-Pi*tt,-ui*qe-Fi*tt)},Rt.prototype.applyToPoint=function(R){var re=R.x*this.sx+R.y*this.shx+this.tx,De=R.x*this.shy+R.y*this.sy+this.ty;return new qh(re,De)},Rt.prototype.applyToRectangle=function(R){var re=this.applyToPoint(R),De=this.applyToPoint(new qh(R.x+R.w,R.y+R.h));return new i_(re.x,re.y,De.x-re.x,De.y-re.y)},Rt.prototype.clone=function(){var R=this.sx,re=this.shy,De=this.shx,Fe=this.sy,qe=this.tx,tt=this.ty;return new Rt(R,re,De,Fe,qe,tt)},f.Matrix=Rt;var ba=f.matrixMult=function(R,re){return re.multiply(R)},Dd=new Rt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Dd;var ks=function(R,re){if(!fo[R]){var De=(re instanceof fC?"Sh":"P")+(Object.keys(fi).length+1).toString(10);re.id=De,fo[R]=De,fi[De]=re,pi.publish("addPattern",re)}};f.ShadingPattern=fC,f.TilingPattern=mR,f.addShadingPattern=function(R,re){return O("addShadingPattern()"),ks(R,re),this},f.beginTilingPattern=function(R){O("beginTilingPattern()"),DC(R.boundingBox[0],R.boundingBox[1],R.boundingBox[2]-R.boundingBox[0],R.boundingBox[3]-R.boundingBox[1],R.matrix)},f.endTilingPattern=function(R,re){O("endTilingPattern()"),re.stream=Le[I].join(`
`),ks(R,re),pi.publish("endTilingPattern",re),ec.pop().restore()};var Cr=f.__private__.newObject=function(){var R=on();return po(R,!0),R},on=f.__private__.newObjectDeferred=function(){return le++,xe[le]=function(){return Oe},le},po=function(R,re){return re=typeof re=="boolean"&&re,xe[R]=Oe,re&&Se(R+" 0 obj"),R},Vn=f.__private__.newAdditionalObject=function(){var R={objId:on(),content:""};return We.push(R),R},Qo=on(),Jo=on(),Os=f.__private__.decodeColorString=function(R){var re=R.split(" ");if(re.length!==2||re[1]!=="g"&&re[1]!=="G")re.length===5&&(re[4]==="k"||re[4]==="K")&&(re=[(1-re[0])*(1-re[3]),(1-re[1])*(1-re[3]),(1-re[2])*(1-re[3]),"r"]);else{var De=parseFloat(re[0]);re=[De,De,De,"r"]}for(var Fe="#",qe=0;qe<3;qe++)Fe+=("0"+Math.floor(255*parseFloat(re[qe])).toString(16)).slice(-2);return Fe},Uc=f.__private__.encodeColorString=function(R){var re;typeof R=="string"&&(R={ch1:R});var De=R.ch1,Fe=R.ch2,qe=R.ch3,tt=R.ch4,pt=R.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof De=="string"&&De.charAt(0)!=="#"){var It=new f9e(De);if(It.ok)De=It.toHex();else if(!/^\d*\.?\d*$/.test(De))throw new Error('Invalid color "'+De+'" passed to jsPDF.encodeColorString.')}if(typeof De=="string"&&/^#[0-9A-Fa-f]{3}$/.test(De)&&(De="#"+De[1]+De[1]+De[2]+De[2]+De[3]+De[3]),typeof De=="string"&&/^#[0-9A-Fa-f]{6}$/.test(De)){var ui=parseInt(De.substr(1),16);De=ui>>16&255,Fe=ui>>8&255,qe=255&ui}if(Fe===void 0||tt===void 0&&De===Fe&&Fe===qe)if(typeof De=="string")re=De+" "+pt[0];else switch(R.precision){case 2:re=J(De/255)+" "+pt[0];break;case 3:default:re=N(De/255)+" "+pt[0]}else if(tt===void 0||(0,Dn.default)(tt)==="object"){if(tt&&!isNaN(tt.a)&&tt.a===0)return re=["1.","1.","1.",pt[1]].join(" ");if(typeof De=="string")re=[De,Fe,qe,pt[1]].join(" ");else switch(R.precision){case 2:re=[J(De/255),J(Fe/255),J(qe/255),pt[1]].join(" ");break;default:case 3:re=[N(De/255),N(Fe/255),N(qe/255),pt[1]].join(" ")}}else if(typeof De=="string")re=[De,Fe,qe,tt,pt[2]].join(" ");else switch(R.precision){case 2:re=[J(De),J(Fe),J(qe),J(tt),pt[2]].join(" ");break;case 3:default:re=[N(De),N(Fe),N(qe),N(tt),pt[2]].join(" ")}return re},Md=f.__private__.getFilters=function(){return s},Gs=f.__private__.putStream=function(R){var re=(R=R||{}).data||"",De=R.filters||Md(),Fe=R.alreadyAppliedFilters||[],qe=R.addLength1||!1,tt=re.length,pt=R.objectId,It=function(Ks){return Ks};if(u!==null&&pt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(It=Xs.encryptor(pt,0));var ui={};De===!0&&(De=["FlateEncode"]);var Pi=R.additionalKeyValues||[],Fi=(ui=Ti.API.processDataByFilters!==void 0?Ti.API.processDataByFilters(re,De):{data:re,reverseChain:[]}).reverseChain+(Array.isArray(Fe)?Fe.join(" "):Fe.toString());if(ui.data.length!==0&&(Pi.push({key:"Length",value:ui.data.length}),qe===!0&&Pi.push({key:"Length1",value:tt})),Fi.length!=0)if(Fi.split("/").length-1==1)Pi.push({key:"Filter",value:Fi});else{Pi.push({key:"Filter",value:"["+Fi+"]"});for(var cr=0;cr<Pi.length;cr+=1)if(Pi[cr].key==="DecodeParms"){for(var Jn=[],mo=0;mo<ui.reverseChain.split("/").length-1;mo+=1)Jn.push("null");Jn.push(Pi[cr].value),Pi[cr].value="["+Jn.join(" ")+"]"}}Se("<<");for(var Fo=0;Fo<Pi.length;Fo++)Se("/"+Pi[Fo].key+" "+Pi[Fo].value);Se(">>"),ui.data.length!==0&&(Se("stream"),Se(It(ui.data)),Se("endstream"))},qc=f.__private__.putPage=function(R){var re=R.number,De=R.data,Fe=R.objId,qe=R.contentsObjId;po(Fe,!0),Se("<</Type /Page"),Se("/Parent "+R.rootDictionaryObjId+" 0 R"),Se("/Resources "+R.resourceDictionaryObjId+" 0 R"),Se("/MediaBox ["+parseFloat(F(R.mediaBox.bottomLeftX))+" "+parseFloat(F(R.mediaBox.bottomLeftY))+" "+F(R.mediaBox.topRightX)+" "+F(R.mediaBox.topRightY)+"]"),R.cropBox!==null&&Se("/CropBox ["+F(R.cropBox.bottomLeftX)+" "+F(R.cropBox.bottomLeftY)+" "+F(R.cropBox.topRightX)+" "+F(R.cropBox.topRightY)+"]"),R.bleedBox!==null&&Se("/BleedBox ["+F(R.bleedBox.bottomLeftX)+" "+F(R.bleedBox.bottomLeftY)+" "+F(R.bleedBox.topRightX)+" "+F(R.bleedBox.topRightY)+"]"),R.trimBox!==null&&Se("/TrimBox ["+F(R.trimBox.bottomLeftX)+" "+F(R.trimBox.bottomLeftY)+" "+F(R.trimBox.topRightX)+" "+F(R.trimBox.topRightY)+"]"),R.artBox!==null&&Se("/ArtBox ["+F(R.artBox.bottomLeftX)+" "+F(R.artBox.bottomLeftY)+" "+F(R.artBox.topRightX)+" "+F(R.artBox.topRightY)+"]"),typeof R.userUnit=="number"&&R.userUnit!==1&&Se("/UserUnit "+R.userUnit),pi.publish("putPage",{objId:Fe,pageContext:ii[re],pageNumber:re,page:De}),Se("/Contents "+qe+" 0 R"),Se(">>"),Se("endobj");var tt=De.join(`
`);return T===x.ADVANCED&&(tt+=`
Q`),po(qe,!0),Gs({data:tt,filters:Md(),objectId:qe}),Se("endobj"),Fe},Np=f.__private__.putPages=function(){var R,re,De=[];for(R=1;R<=ft;R++)ii[R].objId=on(),ii[R].contentsObjId=on();for(R=1;R<=ft;R++)De.push(qc({number:R,data:Le[R],objId:ii[R].objId,contentsObjId:ii[R].contentsObjId,mediaBox:ii[R].mediaBox,cropBox:ii[R].cropBox,bleedBox:ii[R].bleedBox,trimBox:ii[R].trimBox,artBox:ii[R].artBox,userUnit:ii[R].userUnit,rootDictionaryObjId:Qo,resourceDictionaryObjId:Jo}));po(Qo,!0),Se("<</Type /Pages");var Fe="/Kids [";for(re=0;re<ft;re++)Fe+=De[re]+" 0 R ";Se(Fe+"]"),Se("/Count "+ft),Se(">>"),Se("endobj"),pi.publish("postPutPages")},Yc=function(R){pi.publish("putFont",{font:R,out:Se,newObject:Cr,putStream:Gs}),R.isAlreadyPutted!==!0&&(R.objectNumber=Cr(),Se("<<"),Se("/Type /Font"),Se("/BaseFont /"+pR(R.postScriptName)),Se("/Subtype /Type1"),typeof R.encoding=="string"&&Se("/Encoding /"+R.encoding),Se("/FirstChar 32"),Se("/LastChar 255"),Se(">>"),Se("endobj"))},kd=function(){for(var R in st)st.hasOwnProperty(R)&&(h===!1||h===!0&&p.hasOwnProperty(R))&&Yc(st[R])},Pp=function(R){R.objectNumber=Cr();var re=[];re.push({key:"Type",value:"/XObject"}),re.push({key:"Subtype",value:"/Form"}),re.push({key:"BBox",value:"["+[F(R.x),F(R.y),F(R.x+R.width),F(R.y+R.height)].join(" ")+"]"}),re.push({key:"Matrix",value:"["+R.matrix.toString()+"]"});var De=R.pages[1].join(`
`);Gs({data:De,additionalKeyValues:re,objectId:R.objectNumber}),Se("endobj")},Ig=function(){for(var R in nn)nn.hasOwnProperty(R)&&Pp(nn[R])},vC=function(R,re){var De,Fe=[],qe=1/(re-1);for(De=0;De<1;De+=qe)Fe.push(De);if(Fe.push(1),R[0].offset!=0){var tt={offset:0,color:R[0].color};R.unshift(tt)}if(R[R.length-1].offset!=1){var pt={offset:1,color:R[R.length-1].color};R.push(pt)}for(var It="",ui=0,Pi=0;Pi<Fe.length;Pi++){for(De=Fe[Pi];De>R[ui+1].offset;)ui++;var Fi=R[ui].offset,cr=(De-Fi)/(R[ui+1].offset-Fi),Jn=R[ui].color,mo=R[ui+1].color;It+=Q(Math.round((1-cr)*Jn[0]+cr*mo[0]).toString(16))+Q(Math.round((1-cr)*Jn[1]+cr*mo[1]).toString(16))+Q(Math.round((1-cr)*Jn[2]+cr*mo[2]).toString(16))}return It.trim()},wR=function(R,re){re||(re=21);var De=Cr(),Fe=vC(R.colors,re),qe=[];qe.push({key:"FunctionType",value:"0"}),qe.push({key:"Domain",value:"[0.0 1.0]"}),qe.push({key:"Size",value:"["+re+"]"}),qe.push({key:"BitsPerSample",value:"8"}),qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Gs({data:Fe,additionalKeyValues:qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:De}),Se("endobj"),R.objectNumber=Cr(),Se("<< /ShadingType "+R.type),Se("/ColorSpace /DeviceRGB");var tt="/Coords ["+F(parseFloat(R.coords[0]))+" "+F(parseFloat(R.coords[1]))+" ";R.type===2?tt+=F(parseFloat(R.coords[2]))+" "+F(parseFloat(R.coords[3])):tt+=F(parseFloat(R.coords[2]))+" "+F(parseFloat(R.coords[3]))+" "+F(parseFloat(R.coords[4]))+" "+F(parseFloat(R.coords[5])),Se(tt+="]"),R.matrix&&Se("/Matrix ["+R.matrix.toString()+"]"),Se("/Function "+De+" 0 R"),Se("/Extend [true true]"),Se(">>"),Se("endobj")},Qn=function(R,re){var De=on(),Fe=Cr();re.push({resourcesOid:De,objectOid:Fe}),R.objectNumber=Fe;var qe=[];qe.push({key:"Type",value:"/Pattern"}),qe.push({key:"PatternType",value:"1"}),qe.push({key:"PaintType",value:"1"}),qe.push({key:"TilingType",value:"1"}),qe.push({key:"BBox",value:"["+R.boundingBox.map(F).join(" ")+"]"}),qe.push({key:"XStep",value:F(R.xStep)}),qe.push({key:"YStep",value:F(R.yStep)}),qe.push({key:"Resources",value:De+" 0 R"}),R.matrix&&qe.push({key:"Matrix",value:"["+R.matrix.toString()+"]"}),Gs({data:R.stream,additionalKeyValues:qe,objectId:R.objectNumber}),Se("endobj")},Vh=function(R){var re;for(re in fi)fi.hasOwnProperty(re)&&(fi[re]instanceof fC?wR(fi[re]):fi[re]instanceof mR&&Qn(fi[re],R))},bC=function(R){for(var re in R.objectNumber=Cr(),Se("<<"),R)switch(re){case"opacity":Se("/ca "+J(R[re]));break;case"stroke-opacity":Se("/CA "+J(R[re]))}Se(">>"),Se("endobj")},_C=function(){var R;for(R in mr)mr.hasOwnProperty(R)&&bC(mr[R])},Dg=function(){for(var R in Se("/XObject <<"),nn)nn.hasOwnProperty(R)&&nn[R].objectNumber>=0&&Se("/"+R+" "+nn[R].objectNumber+" 0 R");pi.publish("putXobjectDict"),Se(">>")},CR=function(){Xs.oid=Cr(),Se("<<"),Se("/Filter /Standard"),Se("/V "+Xs.v),Se("/R "+Xs.r),Se("/U <"+Xs.toHexString(Xs.U)+">"),Se("/O <"+Xs.toHexString(Xs.O)+">"),Se("/P "+Xs.P),Se(">>"),Se("endobj")},yC=function(){for(var R in Se("/Font <<"),st)st.hasOwnProperty(R)&&(h===!1||h===!0&&p.hasOwnProperty(R))&&Se("/"+R+" "+st[R].objectNumber+" 0 R");Se(">>")},xR=function(){if(Object.keys(fi).length>0){for(var R in Se("/Shading <<"),fi)fi.hasOwnProperty(R)&&fi[R]instanceof fC&&fi[R].objectNumber>=0&&Se("/"+R+" "+fi[R].objectNumber+" 0 R");pi.publish("putShadingPatternDict"),Se(">>")}},Mg=function(R){if(Object.keys(fi).length>0){for(var re in Se("/Pattern <<"),fi)fi.hasOwnProperty(re)&&fi[re]instanceof f.TilingPattern&&fi[re].objectNumber>=0&&fi[re].objectNumber<R&&Se("/"+re+" "+fi[re].objectNumber+" 0 R");pi.publish("putTilingPatternDict"),Se(">>")}},SR=function(){if(Object.keys(mr).length>0){var R;for(R in Se("/ExtGState <<"),mr)mr.hasOwnProperty(R)&&mr[R].objectNumber>=0&&Se("/"+R+" "+mr[R].objectNumber+" 0 R");pi.publish("putGStateDict"),Se(">>")}},Eo=function(R){po(R.resourcesOid,!0),Se("<<"),Se("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),yC(),xR(),Mg(R.objectOid),SR(),Dg(),Se(">>"),Se("endobj")},U0=function(){var R=[];kd(),_C(),Ig(),Vh(R),pi.publish("putResources"),R.forEach(Eo),Eo({resourcesOid:Jo,objectOid:Number.MAX_SAFE_INTEGER}),pi.publish("postPutResources")},q0=function(){pi.publish("putAdditionalObjects");for(var R=0;R<We.length;R++){var re=We[R];po(re.objId,!0),Se(re.content),Se("endobj")}pi.publish("postPutAdditionalObjects")},wC=function(R){vt[R.fontName]=vt[R.fontName]||{},vt[R.fontName][R.fontStyle]=R.id},Y0=function(R,re,De,Fe,qe){var tt={id:"F"+(Object.keys(st).length+1).toString(10),postScriptName:R,fontName:re,fontStyle:De,encoding:Fe,isStandardFont:qe||!1,metadata:{}};return pi.publish("addFont",{font:tt,instance:this}),st[tt.id]=tt,wC(tt),tt.id},ER=function(R){for(var re=0,De=de.length;re<De;re++){var Fe=Y0.call(this,R[re][0],R[re][1],R[re][2],de[re][3],!0);h===!1&&(p[Fe]=!0);var qe=R[re][0].split("-");wC({id:Fe,fontName:qe[0],fontStyle:qe[1]||""})}pi.publish("addFonts",{fonts:st,dictionary:vt})},tc=function(R){return R.foo=function(){try{return R.apply(this,arguments)}catch(Fe){var re=Fe.stack||"";~re.indexOf(" at ")&&(re=re.split(" at ")[1]);var De="Error in function "+re.split(`
`)[0].split("<")[0]+": "+Fe.message;if(!Di.console)throw new Error(De);Di.console.error(De,Fe),Di.alert&&alert(De)}},R.foo.bar=R,R.foo},kg=function(R,re){var De,Fe,qe,tt,pt,It,ui,Pi,Fi;if(qe=(re=re||{}).sourceEncoding||"Unicode",pt=re.outputEncoding,(re.autoencode||pt)&&st[ke].metadata&&st[ke].metadata[qe]&&st[ke].metadata[qe].encoding&&(tt=st[ke].metadata[qe].encoding,!pt&&st[ke].encoding&&(pt=st[ke].encoding),!pt&&tt.codePages&&(pt=tt.codePages[0]),typeof pt=="string"&&(pt=tt[pt]),pt)){for(ui=!1,It=[],De=0,Fe=R.length;De<Fe;De++)(Pi=pt[R.charCodeAt(De)])?It.push(String.fromCharCode(Pi)):It.push(R[De]),It[De].charCodeAt(0)>>8&&(ui=!0);R=It.join("")}for(De=R.length;ui===void 0&&De!==0;)R.charCodeAt(De-1)>>8&&(ui=!0),De--;if(!ui)return R;for(It=re.noBOM?[]:[254,255],De=0,Fe=R.length;De<Fe;De++){if((Fi=(Pi=R.charCodeAt(De))>>8)>>8)throw new Error("Character at position "+De+" of string '"+R+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");It.push(Fi),It.push(Pi-(Fi<<8))}return String.fromCharCode.apply(void 0,It)},bs=f.__private__.pdfEscape=f.pdfEscape=function(R,re){return kg(R,re).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jh=f.__private__.beginPage=function(R){Le[++ft]=[],ii[ft]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(R[0]),topRightY:Number(R[1])}},ic(ft),Ue(Le[I])},$0=function(R,re){var De,Fe,qe;switch(i=re||i,typeof R=="string"&&(De=w(R.toLowerCase()),Array.isArray(De)&&(Fe=De[0],qe=De[1])),Array.isArray(R)&&(Fe=R[0]*Ie,qe=R[1]*Ie),isNaN(Fe)&&(Fe=n[0],qe=n[1]),(Fe>14400||qe>14400)&&(Hn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Fe=Math.min(14400,Fe),qe=Math.min(14400,qe)),n=[Fe,qe],i.substr(0,1)){case"l":qe>Fe&&(n=[qe,Fe]);break;case"p":Fe>qe&&(n=[qe,Fe])}jh(n),TC(Pg),Se(rc),t_!==0&&Se(t_+" J"),kl!==0&&Se(kl+" j"),pi.publish("addPage",{pageNumber:ft})},Lp=function(R){R>0&&R<=ft&&(Le.splice(R,1),ii.splice(R,1),ft--,I>ft&&(I=ft),this.setPage(I))},ic=function(R){R>0&&R<=ft&&(I=R)},TR=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Le.length-1},CC=function(R,re,De){var Fe,qe=void 0;return De=De||{},R=R!==void 0?R:st[ke].fontName,re=re!==void 0?re:st[ke].fontStyle,Fe=R.toLowerCase(),vt[Fe]!==void 0&&vt[Fe][re]!==void 0?qe=vt[Fe][re]:vt[R]!==void 0&&vt[R][re]!==void 0?qe=vt[R][re]:De.disableWarning===!1&&Hn.warn("Unable to look up font label for font '"+R+"', '"+re+"'. Refer to getFontList() for available fonts."),qe||De.noFallback||(qe=vt.times[re])==null&&(qe=vt.times.normal),qe},RR=f.__private__.putInfo=function(){var R=Cr(),re=function(Fe){return Fe};for(var De in u!==null&&(re=Xs.encryptor(R,0)),Se("<<"),Se("/Producer ("+bs(re("jsPDF "+Ti.version))+")"),we)we.hasOwnProperty(De)&&we[De]&&Se("/"+De.substr(0,1).toUpperCase()+De.substr(1)+" ("+bs(re(we[De]))+")");Se("/CreationDate ("+bs(re(ve))+")"),Se(">>"),Se("endobj")},G0=f.__private__.putCatalog=function(R){var re=(R=R||{}).rootDictionaryObjId||Qo;switch(Cr(),Se("<<"),Se("/Type /Catalog"),Se("/Pages "+re+" 0 R"),Me||(Me="fullwidth"),Me){case"fullwidth":Se("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Se("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Se("/OpenAction [3 0 R /Fit]");break;case"original":Se("/OpenAction [3 0 R /XYZ null null 1]");break;default:var De=""+Me;De.substr(De.length-1)==="%"&&(Me=parseInt(Me)/100),typeof Me=="number"&&Se("/OpenAction [3 0 R /XYZ null null "+J(Me)+"]")}switch(Y||(Y="continuous"),Y){case"continuous":Se("/PageLayout /OneColumn");break;case"single":Se("/PageLayout /SinglePage");break;case"two":case"twoleft":Se("/PageLayout /TwoColumnLeft");break;case"tworight":Se("/PageLayout /TwoColumnRight")}A&&Se("/PageMode /"+A),pi.publish("putCatalog"),Se(">>"),Se("endobj")},AR=f.__private__.putTrailer=function(){Se("trailer"),Se("<<"),Se("/Size "+(le+1)),Se("/Root "+le+" 0 R"),Se("/Info "+(le-1)+" 0 R"),u!==null&&Se("/Encrypt "+Xs.oid+" 0 R"),Se("/ID [ <"+W+"> <"+W+"> ]"),Se(">>")},IR=f.__private__.putHeader=function(){Se("%PDF-"+m),Se("%\xBA\xDF\xAC\xE0")},DR=f.__private__.putXRef=function(){var R="0000000000";Se("xref"),Se("0 "+(le+1)),Se("0000000000 65535 f ");for(var re=1;re<=le;re++)typeof xe[re]=="function"?Se((R+xe[re]()).slice(-10)+" 00000 n "):xe[re]!==void 0?Se((R+xe[re]).slice(-10)+" 00000 n "):Se("0000000000 00000 n ")},Ou=f.__private__.buildDocument=function(){ct(),Ue(Re),pi.publish("buildDocument"),IR(),Np(),q0(),U0(),u!==null&&CR(),RR(),G0();var R=Oe;return DR(),AR(),Se("startxref"),Se(""+R),Se("%%EOF"),Ue(Le[I]),Re.join(`
`)},zh=f.__private__.getBlob=function(R){return new Blob([ce(R)],{type:"application/pdf"})},Og=f.output=f.__private__.output=tc(function(R,re){switch(typeof(re=re||{})=="string"?re={filename:re}:re.filename=re.filename||"generated.pdf",R){case void 0:return Ou();case"save":f.save(re.filename);break;case"arraybuffer":return ce(Ou());case"blob":return zh(Ou());case"bloburi":case"bloburl":if(Di.URL!==void 0&&typeof Di.URL.createObjectURL=="function")return Di.URL&&Di.URL.createObjectURL(zh(Ou()))||void 0;Hn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var De="",Fe=Ou();try{De=Ice(Fe)}catch{De=Ice(unescape(encodeURIComponent(Fe)))}return"data:application/pdf;filename="+re.filename+";base64,"+De;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Di)==="[object Window]"){var qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",tt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';re.pdfObjectUrl&&(qe=re.pdfObjectUrl,tt="");var pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qe+'"'+tt+'></script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(re)+");</script></body></html>",It=Di.open();return It!==null&&It.document.write(pt),It}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Di)==="[object Window]"){var ui='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(re.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+re.filename+'" width="500px" height="400px" /></body></html>',Pi=Di.open();if(Pi!==null){Pi.document.write(ui);var Fi=this;Pi.document.documentElement.querySelector("#pdfViewer").onload=function(){Pi.document.title=re.filename,Pi.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Fi.output("bloburl"))}}return Pi}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Di)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var cr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",re)+'"></iframe></body></html>',Jn=Di.open();if(Jn!==null&&(Jn.document.write(cr),Jn.document.title=re.filename),Jn||typeof safari>"u")return Jn;break;case"datauri":case"dataurl":return Di.document.location.href=this.output("datauristring",re);default:return null}}),X0=function(R){return Array.isArray(va)===!0&&va.indexOf(R)>-1};switch(r){case"pt":Ie=1;break;case"mm":Ie=72/25.4;break;case"cm":Ie=72/2.54;break;case"in":Ie=72;break;case"px":Ie=X0("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ie=12;break;case"ex":Ie=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Ie=r}var Xs=null;k(),te();var MR=function(R){return u!==null?Xs.encryptor(R,0):function(re){return re}},xC=f.__private__.getPageInfo=f.getPageInfo=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ii[R].objId,pageNumber:R,pageContext:ii[R]}},Ni=f.__private__.getPageInfoByObjId=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var re in ii)if(ii[re].objId===R)break;return xC(re)},kR=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:ii[I].objId,pageNumber:I,pageContext:ii[I]}};f.addPage=function(){return $0.apply(this,arguments),this},f.setPage=function(){return ic.apply(this,arguments),Ue.call(this,Le[I]),this},f.insertPage=function(R){return this.addPage(),this.movePage(I,R),this},f.movePage=function(R,re){var De,Fe;if(R>re){De=Le[R],Fe=ii[R];for(var qe=R;qe>re;qe--)Le[qe]=Le[qe-1],ii[qe]=ii[qe-1];Le[re]=De,ii[re]=Fe,this.setPage(re)}else if(R<re){De=Le[R],Fe=ii[R];for(var tt=R;tt<re;tt++)Le[tt]=Le[tt+1],ii[tt]=ii[tt+1];Le[re]=De,ii[re]=Fe,this.setPage(re)}return this},f.deletePage=function(){return Lp.apply(this,arguments),this},f.__private__.text=f.text=function(R,re,De,Fe,qe){var tt,pt,It,ui,Pi,Fi,cr,Jn,mo,Fo=(Fe=Fe||{}).scope||this;if(typeof R=="number"&&typeof re=="number"&&(typeof De=="string"||Array.isArray(De))){var Ks=De;De=re,re=R,R=Ks}if(arguments[3]instanceof Rt?(O("The transform parameter of text() with a Matrix value"),mo=qe):(It=arguments[4],ui=arguments[5],(0,Dn.default)(cr=arguments[3])==="object"&&cr!==null||(typeof It=="string"&&(ui=It,It=null),typeof cr=="string"&&(ui=cr,cr=null),typeof cr=="number"&&(It=cr,cr=null),Fe={flags:cr,angle:It,align:ui})),isNaN(re)||isNaN(De)||R==null)throw new Error("Invalid arguments passed to jsPDF.text");if(R.length===0)return Fo;var es="",$c=!1,Ga=typeof Fe.lineHeightFactor=="number"?Fe.lineHeightFactor:Wh,xr=Fo.internal.scaleFactor;function MC(xn){return xn=xn.split("	").join(Array(Fe.TabLen||9).join(" ")),bs(xn,cr)}function o_(xn){for(var Sn,To=xn.concat(),ts=[],Bu=To.length;Bu--;)typeof(Sn=To.shift())=="string"?ts.push(Sn):Array.isArray(xn)&&(Sn.length===1||Sn[1]===void 0&&Sn[2]===void 0)?ts.push(Sn[0]):ts.push([Sn[0],Sn[1],Sn[2]]);return ts}function Vg(xn,Sn){var To;if(typeof xn=="string")To=Sn(xn)[0];else if(Array.isArray(xn)){for(var ts,Bu,h_=xn.concat(),$g=[],NC=h_.length;NC--;)typeof(ts=h_.shift())=="string"?$g.push(Sn(ts)[0]):Array.isArray(ts)&&typeof ts[0]=="string"&&(Bu=Sn(ts[0],ts[1],ts[2]),$g.push([Bu[0],Bu[1],Bu[2]]));To=$g}return To}var jg=!1,s_=!0;if(typeof R=="string")jg=!0;else if(Array.isArray(R)){var a_=R.concat();pt=[];for(var Pd,Ns=a_.length;Ns--;)(typeof(Pd=a_.shift())!="string"||Array.isArray(Pd)&&typeof Pd[0]!="string")&&(s_=!1);jg=s_}if(jg===!1)throw new Error('Type of text must be string or Array. "'+R+'" is not recognized.');typeof R=="string"&&(R=R.match(/[\r?\n]/)?R.split(/\r\n|\r|\n/g):[R]);var zg=ye/Fo.internal.scaleFactor,Wg=zg*(Ga-1);switch(Fe.baseline){case"bottom":De-=Wg;break;case"top":De+=zg-Wg;break;case"hanging":De+=zg-2*Wg;break;case"middle":De+=zg/2-Wg}if((Fi=Fe.maxWidth||0)>0&&(typeof R=="string"?R=Fo.splitTextToSize(R,Fi):Object.prototype.toString.call(R)==="[object Array]"&&(R=R.reduce(function(xn,Sn){return xn.concat(Fo.splitTextToSize(Sn,Fi))},[]))),tt={text:R,x:re,y:De,options:Fe,mutex:{pdfEscape:bs,activeFontKey:ke,fonts:st,activeFontSize:ye}},pi.publish("preProcessText",tt),R=tt.text,It=(Fe=tt.options).angle,!(mo instanceof Rt)&&It&&typeof It=="number"){It*=Math.PI/180,Fe.rotationDirection===0&&(It=-It),T===x.ADVANCED&&(It=-It);var Pu=Math.cos(It),Gh=Math.sin(It);mo=new Rt(Pu,Gh,-Gh,Pu,0,0)}else It&&It instanceof Rt&&(mo=It);T!==x.ADVANCED||mo||(mo=Dd),(Pi=Fe.charSpace||Ml)!==void 0&&(es+=F(P(Pi))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Jn=Fe.horizontalScale)!==void 0&&(es+=F(100*Jn)+` Tz
`),Fe.lang;var Zs=-1,HR=Fe.renderingMode!==void 0?Fe.renderingMode:Fe.stroke,Ug=Fo.internal.getCurrentPageInfo().pageContext;switch(HR){case 0:case!1:case"fill":Zs=0;break;case 1:case!0:case"stroke":Zs=1;break;case 2:case"fillThenStroke":Zs=2;break;case 3:case"invisible":Zs=3;break;case 4:case"fillAndAddForClipping":Zs=4;break;case 5:case"strokeAndAddPathForClipping":Zs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Zs=6;break;case 7:case"addToPathForClipping":Zs=7}var kC=Ug.usedRenderingMode!==void 0?Ug.usedRenderingMode:-1;Zs!==-1?es+=Zs+` Tr
`:kC!==-1&&(es+=`0 Tr
`),Zs!==-1&&(Ug.usedRenderingMode=Zs),ui=Fe.align||"left";var Xa,Xh=ye*Ga,qg=Fo.internal.pageSize.getWidth(),OC=st[ke];Pi=Fe.charSpace||Ml,Fi=Fe.maxWidth||0,cr=Object.assign({autoencode:!0,noBOM:!0},Fe.flags);var Kh=[],Vp=function(xn){return Fo.getStringUnitWidth(xn,{font:OC,charSpace:Pi,fontSize:ye,doKerning:!1})*ye/xr};if(Object.prototype.toString.call(R)==="[object Array]"){var Ka;pt=o_(R),ui!=="left"&&(Xa=pt.map(Vp));var _a,Zh=0;if(ui==="right"){re-=Xa[0],R=[],Ns=pt.length;for(var Lu=0;Lu<Ns;Lu++)Lu===0?(_a=Er(re),Ka=Dl(De)):(_a=P(Zh-Xa[Lu]),Ka=-Xh),R.push([pt[Lu],_a,Ka]),Zh=Xa[Lu]}else if(ui==="center"){re-=Xa[0]/2,R=[],Ns=pt.length;for(var Fu=0;Fu<Ns;Fu++)Fu===0?(_a=Er(re),Ka=Dl(De)):(_a=P((Zh-Xa[Fu])/2),Ka=-Xh),R.push([pt[Fu],_a,Ka]),Zh=Xa[Fu]}else if(ui==="left"){R=[],Ns=pt.length;for(var Yg=0;Yg<Ns;Yg++)R.push(pt[Yg])}else if(ui==="justify"&&OC.encoding==="Identity-H"){R=[],Ns=pt.length,Fi=Fi!==0?Fi:qg;for(var Hu=0,go=0;go<Ns;go++)if(Ka=go===0?Dl(De):-Xh,_a=go===0?Er(re):Hu,go<Ns-1){var l_=P((Fi-Xa[go])/(pt[go].split(" ").length-1)),ya=pt[go].split(" ");R.push([ya[0]+" ",_a,Ka]),Hu=0;for(var vo=1;vo<ya.length;vo++){var nc=(Vp(ya[vo-1]+" "+ya[vo])-Vp(ya[vo]))*xr+l_;vo==ya.length-1?R.push([ya[vo],nc,0]):R.push([ya[vo]+" ",nc,0]),Hu-=nc}}else R.push([pt[go],_a,Ka]);R.push(["",Hu,0])}else{if(ui!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(R=[],Ns=pt.length,Fi=Fi!==0?Fi:qg,go=0;go<Ns;go++)Ka=go===0?Dl(De):-Xh,_a=go===0?Er(re):0,go<Ns-1?Kh.push(F(P((Fi-Xa[go])/(pt[go].split(" ").length-1)))):Kh.push(0),R.push([pt[go],_a,Ka])}}var c_=typeof Fe.R2L=="boolean"?Fe.R2L:ue;c_===!0&&(R=Vg(R,function(xn,Sn,To){return[xn.split("").reverse().join(""),Sn,To]})),tt={text:R,x:re,y:De,options:Fe,mutex:{pdfEscape:bs,activeFontKey:ke,fonts:st,activeFontSize:ye}},pi.publish("postProcessText",tt),R=tt.text,$c=tt.mutex.isHex||!1;var d_=st[ke].encoding;d_!=="WinAnsiEncoding"&&d_!=="StandardEncoding"||(R=Vg(R,function(xn,Sn,To){return[MC(xn),Sn,To]})),pt=o_(R),R=[];for(var Qh,Jh,ef,jp=0,zp=1,Wp=Array.isArray(pt[0])?zp:jp,tf="",u_=function(xn,Sn,To){var ts="";return To instanceof Rt?(To=typeof Fe.angle=="number"?ba(To,new Rt(1,0,0,1,xn,Sn)):ba(new Rt(1,0,0,1,xn,Sn),To),T===x.ADVANCED&&(To=ba(new Rt(1,0,0,-1,0,0),To)),ts=To.join(" ")+` Tm
`):ts=F(xn)+" "+F(Sn)+` Td
`,ts},oc=0;oc<pt.length;oc++){switch(tf="",Wp){case zp:ef=($c?"<":"(")+pt[oc][0]+($c?">":")"),Qh=parseFloat(pt[oc][1]),Jh=parseFloat(pt[oc][2]);break;case jp:ef=($c?"<":"(")+pt[oc]+($c?">":")"),Qh=Er(re),Jh=Dl(De)}Kh!==void 0&&Kh[oc]!==void 0&&(tf=Kh[oc]+` Tw
`),oc===0?R.push(tf+u_(Qh,Jh,mo)+ef):Wp===jp?R.push(tf+ef):Wp===zp&&R.push(tf+u_(Qh,Jh,mo)+ef)}R=Wp===jp?R.join(` Tj
T* `):R.join(` Tj
`),R+=` Tj
`;var sc=`BT
/`;return sc+=ke+" "+ye+` Tf
`,sc+=F(ye*Ga)+` TL
`,sc+=Hp+`
`,sc+=es,sc+=R,Se(sc+="ET"),p[ke]=!0,Fo};var OR=f.__private__.clip=f.clip=function(R){return Se(R==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return OR("evenodd")},f.__private__.discardPath=f.discardPath=function(){return Se("n"),this};var Od=f.__private__.isValidStyle=function(R){var re=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(R)!==-1&&(re=!0),re};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(R){return Od(R)&&(d=R),this};var SC=f.__private__.getStyle=f.getStyle=function(R){var re=d;switch(R){case"D":case"S":re="S";break;case"F":re="f";break;case"FD":case"DF":re="B";break;case"f":case"f*":case"B":case"B*":re=R}return re},EC=f.close=function(){return Se("h"),this};f.stroke=function(){return Se("S"),this},f.fill=function(R){return Ng("f",R),this},f.fillEvenOdd=function(R){return Ng("f*",R),this},f.fillStroke=function(R){return Ng("B",R),this},f.fillStrokeEvenOdd=function(R){return Ng("B*",R),this};var Ng=function(R,re){(0,Dn.default)(re)==="object"?PR(re,R):Se(R)},K0=function(R){R===null||T===x.ADVANCED&&R===void 0||(R=SC(R),Se(R))};function NR(R,re,De,Fe,qe){var tt=new mR(re||this.boundingBox,De||this.xStep,Fe||this.yStep,this.gState,qe||this.matrix);tt.stream=this.stream;var pt=R+"$$"+this.cloneIndex+++"$$";return ks(pt,tt),tt}var PR=function(R,re){var De=fo[R.key],Fe=fi[De];if(Fe instanceof fC)Se("q"),Se(LR(re)),Fe.gState&&f.setGState(Fe.gState),Se(R.matrix.toString()+" cm"),Se("/"+De+" sh"),Se("Q");else if(Fe instanceof mR){var qe=new Rt(1,0,0,-1,0,$h());R.matrix&&(qe=qe.multiply(R.matrix||Dd),De=NR.call(Fe,R.key,R.boundingBox,R.xStep,R.yStep,qe).id),Se("q"),Se("/Pattern cs"),Se("/"+De+" scn"),Fe.gState&&f.setGState(Fe.gState),Se(re),Se("Q")}},LR=function(R){switch(R){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Z0=f.moveTo=function(R,re){return Se(F(P(R))+" "+F(K(re))+" m"),this},Nu=f.lineTo=function(R,re){return Se(F(P(R))+" "+F(K(re))+" l"),this},Nd=f.curveTo=function(R,re,De,Fe,qe,tt){return Se([F(P(R)),F(K(re)),F(P(De)),F(K(Fe)),F(P(qe)),F(K(tt)),"c"].join(" ")),this};f.__private__.line=f.line=function(R,re,De,Fe,qe){if(isNaN(R)||isNaN(re)||isNaN(De)||isNaN(Fe)||!Od(qe))throw new Error("Invalid arguments passed to jsPDF.line");return T===x.COMPAT?this.lines([[De-R,Fe-re]],R,re,[1,1],qe||"S"):this.lines([[De-R,Fe-re]],R,re,[1,1]).stroke()},f.__private__.lines=f.lines=function(R,re,De,Fe,qe,tt){var pt,It,ui,Pi,Fi,cr,Jn,mo,Fo,Ks,es,$c;if(typeof R=="number"&&($c=De,De=re,re=R,R=$c),Fe=Fe||[1,1],tt=tt||!1,isNaN(re)||isNaN(De)||!Array.isArray(R)||!Array.isArray(Fe)||!Od(qe)||typeof tt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Z0(re,De),pt=Fe[0],It=Fe[1],Pi=R.length,Ks=re,es=De,ui=0;ui<Pi;ui++)(Fi=R[ui]).length===2?(Ks=Fi[0]*pt+Ks,es=Fi[1]*It+es,Nu(Ks,es)):(cr=Fi[0]*pt+Ks,Jn=Fi[1]*It+es,mo=Fi[2]*pt+Ks,Fo=Fi[3]*It+es,Ks=Fi[4]*pt+Ks,es=Fi[5]*It+es,Nd(cr,Jn,mo,Fo,Ks,es));return tt&&EC(),K0(qe),this},f.path=function(R){for(var re=0;re<R.length;re++){var De=R[re],Fe=De.c;switch(De.op){case"m":Z0(Fe[0],Fe[1]);break;case"l":Nu(Fe[0],Fe[1]);break;case"c":Nd.apply(this,Fe);break;case"h":EC()}}return this},f.__private__.rect=f.rect=function(R,re,De,Fe,qe){if(isNaN(R)||isNaN(re)||isNaN(De)||isNaN(Fe)||!Od(qe))throw new Error("Invalid arguments passed to jsPDF.rect");return T===x.COMPAT&&(Fe=-Fe),Se([F(P(R)),F(K(re)),F(P(De)),F(P(Fe)),"re"].join(" ")),K0(qe),this},f.__private__.triangle=f.triangle=function(R,re,De,Fe,qe,tt,pt){if(isNaN(R)||isNaN(re)||isNaN(De)||isNaN(Fe)||isNaN(qe)||isNaN(tt)||!Od(pt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[De-R,Fe-re],[qe-De,tt-Fe],[R-qe,re-tt]],R,re,[1,1],pt,!0),this},f.__private__.roundedRect=f.roundedRect=function(R,re,De,Fe,qe,tt,pt){if(isNaN(R)||isNaN(re)||isNaN(De)||isNaN(Fe)||isNaN(qe)||isNaN(tt)||!Od(pt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var It=4/3*(Math.SQRT2-1);return qe=Math.min(qe,.5*De),tt=Math.min(tt,.5*Fe),this.lines([[De-2*qe,0],[qe*It,0,qe,tt-tt*It,qe,tt],[0,Fe-2*tt],[0,tt*It,-qe*It,tt,-qe,tt],[2*qe-De,0],[-qe*It,0,-qe,-tt*It,-qe,-tt],[0,2*tt-Fe],[0,-tt*It,qe*It,-tt,qe,-tt]],R+qe,re,[1,1],pt,!0),this},f.__private__.ellipse=f.ellipse=function(R,re,De,Fe,qe){if(isNaN(R)||isNaN(re)||isNaN(De)||isNaN(Fe)||!Od(qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var tt=4/3*(Math.SQRT2-1)*De,pt=4/3*(Math.SQRT2-1)*Fe;return Z0(R+De,re),Nd(R+De,re-pt,R+tt,re-Fe,R,re-Fe),Nd(R-tt,re-Fe,R-De,re-pt,R-De,re),Nd(R-De,re+pt,R-tt,re+Fe,R,re+Fe),Nd(R+tt,re+Fe,R+De,re+pt,R+De,re),K0(qe),this},f.__private__.circle=f.circle=function(R,re,De,Fe){if(isNaN(R)||isNaN(re)||isNaN(De)||!Od(Fe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(R,re,De,De,Fe)},f.setFont=function(R,re,De){return De&&(re=G(re,De)),ke=CC(R,re,{disableWarning:!1}),this};var FR=f.__private__.getFont=f.getFont=function(){return st[CC.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var R,re,De={};for(R in vt)if(vt.hasOwnProperty(R))for(re in De[R]=[],vt[R])vt[R].hasOwnProperty(re)&&De[R].push(re);return De},f.addFont=function(R,re,De,Fe,qe){var tt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&tt.indexOf(arguments[3])!==-1?qe=arguments[3]:arguments[3]&&tt.indexOf(arguments[3])==-1&&(De=G(De,Fe)),qe=qe||"Identity-H",Y0.call(this,R,re,De,qe)};var Wh,Pg=t.lineWidth||.200025,Lg=f.__private__.getLineWidth=f.getLineWidth=function(){return Pg},TC=f.__private__.setLineWidth=f.setLineWidth=function(R){return Pg=R,Se(F(P(R))+" w"),this};f.__private__.setLineDash=Ti.API.setLineDash=Ti.API.setLineDashPattern=function(R,re){if(R=R||[],re=re||0,isNaN(re)||!Array.isArray(R))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return R=R.map(function(De){return F(P(De))}).join(" "),re=F(P(re)),Se("["+R+"] "+re+" d"),this};var RC=f.__private__.getLineHeight=f.getLineHeight=function(){return ye*Wh};f.__private__.getLineHeight=f.getLineHeight=function(){return ye*Wh};var AC=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(R){return typeof(R=R||1.15)=="number"&&(Wh=R),this},Q0=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Wh};AC(t.lineHeight);var Er=f.__private__.getHorizontalCoordinate=function(R){return P(R)},Dl=f.__private__.getVerticalCoordinate=function(R){return T===x.ADVANCED?R:ii[I].mediaBox.topRightY-ii[I].mediaBox.bottomLeftY-P(R)},Fp=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(R){return F(Er(R))},Uh=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(R){return F(Dl(R))},rc=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Os(rc)},f.__private__.setStrokeColor=f.setDrawColor=function(R,re,De,Fe){return rc=Uc({ch1:R,ch2:re,ch3:De,ch4:Fe,pdfColorType:"draw",precision:2}),Se(rc),this};var J0=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Os(J0)},f.__private__.setFillColor=f.setFillColor=function(R,re,De,Fe){return J0=Uc({ch1:R,ch2:re,ch3:De,ch4:Fe,pdfColorType:"fill",precision:2}),Se(J0),this};var Hp=t.textColor||"0 g",Fg=f.__private__.getTextColor=f.getTextColor=function(){return Os(Hp)};f.__private__.setTextColor=f.setTextColor=function(R,re,De,Fe){return Hp=Uc({ch1:R,ch2:re,ch3:De,ch4:Fe,pdfColorType:"text",precision:3}),this};var Ml=t.charSpace,e_=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Ml||0)};f.__private__.setCharSpace=f.setCharSpace=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ml=R,this};var t_=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(R){var re=f.CapJoinStyles[R];if(re===void 0)throw new Error("Line cap style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return t_=re,Se(re+" J"),this};var kl=0;f.__private__.setLineJoin=f.setLineJoin=function(R){var re=f.CapJoinStyles[R];if(re===void 0)throw new Error("Line join style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return kl=re,Se(re+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(R){if(R=R||0,isNaN(R))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Se(F(P(R))+" M"),this},f.GState=Lz,f.setGState=function(R){(R=typeof R=="string"?mr[Bn[R]]:IC(null,R)).equals(vs)||(Se("/"+R.id+" gs"),vs=R)};var IC=function(R,re){if(!R||!Bn[R]){var De=!1;for(var Fe in mr)if(mr.hasOwnProperty(Fe)&&mr[Fe].equals(re)){De=!0;break}if(De)re=mr[Fe];else{var qe="GS"+(Object.keys(mr).length+1).toString(10);mr[qe]=re,re.id=qe}return R&&(Bn[R]=re.id),pi.publish("addGState",re),re}};f.addGState=function(R,re){return IC(R,re),this},f.saveGraphicsState=function(){return Se("q"),di.push({key:ke,size:ye,color:Hp}),this},f.restoreGraphicsState=function(){Se("Q");var R=di.pop();return ke=R.key,ye=R.size,Hp=R.color,vs=null,this},f.setCurrentTransformationMatrix=function(R){return Se(R.toString()+" cm"),this},f.comment=function(R){return Se("#"+R),this};var qh=function(R,re){var De=R||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return De},set:function(tt){isNaN(tt)||(De=parseFloat(tt))}});var Fe=re||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Fe},set:function(tt){isNaN(tt)||(Fe=parseFloat(tt))}});var qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qe},set:function(tt){qe=tt.toString()}}),this},i_=function(R,re,De,Fe){qh.call(this,R,re),this.type="rect";var qe=De||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qe},set:function(pt){isNaN(pt)||(qe=parseFloat(pt))}});var tt=Fe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return tt},set:function(pt){isNaN(pt)||(tt=parseFloat(pt))}}),this},r_=function(){this.page=ft,this.currentPage=I,this.pages=Le.slice(0),this.pagesContext=ii.slice(0),this.x=ze,this.y=rt,this.matrix=yt,this.width=Bp(I),this.height=$h(I),this.outputDestination=it,this.id="",this.objectNumber=-1};r_.prototype.restore=function(){ft=this.page,I=this.currentPage,ii=this.pagesContext,Le=this.pages,ze=this.x,rt=this.y,yt=this.matrix,n_(I,this.width),Bg(I,this.height),it=this.outputDestination};var DC=function(R,re,De,Fe,qe){ec.push(new r_),ft=I=0,Le=[],ze=R,rt=re,yt=qe,jh([De,Fe])},Hg=function(R){if(Oi[R])ec.pop().restore();else{var re=new r_,De="Xo"+(Object.keys(nn).length+1).toString(10);re.id=De,Oi[R]=De,nn[De]=re,pi.publish("addFormObject",re),ec.pop().restore()}};for(var Yh in f.beginFormObject=function(R,re,De,Fe,qe){return DC(R,re,De,Fe,qe),this},f.endFormObject=function(R){return Hg(R),this},f.doFormObject=function(R,re){var De=nn[Oi[R]];return Se("q"),Se(re.toString()+" cm"),Se("/"+De.id+" Do"),Se("Q"),this},f.getFormObject=function(R){var re=nn[Oi[R]];return{x:re.x,y:re.y,width:re.width,height:re.height,matrix:re.matrix}},f.save=function(R,re){return R=R||"generated.pdf",(re=re||{}).returnPromise=re.returnPromise||!1,re.returnPromise===!1?(hC(zh(Ou()),R),typeof hC.unload=="function"&&Di.setTimeout&&setTimeout(hC.unload,911),this):new Promise(function(De,Fe){try{var qe=hC(zh(Ou()),R);typeof hC.unload=="function"&&Di.setTimeout&&setTimeout(hC.unload,911),De(qe)}catch(tt){Fe(tt.message)}})},Ti.API)Ti.API.hasOwnProperty(Yh)&&(Yh==="events"&&Ti.API.events.length?function(R,re){var De,Fe,qe;for(qe=re.length-1;qe!==-1;qe--)De=re[qe][0],Fe=re[qe][1],R.subscribe.apply(R,[De].concat(typeof Fe=="function"?[Fe]:Fe))}(pi,Ti.API.events):f[Yh]=Ti.API[Yh]);var Bp=f.getPageWidth=function(R){return(ii[R=R||I].mediaBox.topRightX-ii[R].mediaBox.bottomLeftX)/Ie},n_=f.setPageWidth=function(R,re){ii[R].mediaBox.topRightX=re*Ie+ii[R].mediaBox.bottomLeftX},$h=f.getPageHeight=function(R){return(ii[R=R||I].mediaBox.topRightY-ii[R].mediaBox.bottomLeftY)/Ie},Bg=f.setPageHeight=function(R,re){ii[R].mediaBox.topRightY=re*Ie+ii[R].mediaBox.bottomLeftY};return f.internal={pdfEscape:bs,getStyle:SC,getFont:FR,getFontSize:pe,getCharSpace:e_,getTextColor:Fg,getLineHeight:RC,getLineHeightFactor:Q0,getLineWidth:Lg,write:gt,getHorizontalCoordinate:Er,getVerticalCoordinate:Dl,getCoordinateString:Fp,getVerticalCoordinateString:Uh,collections:{},newObject:Cr,newAdditionalObject:Vn,newObjectDeferred:on,newObjectDeferredBegin:po,getFilters:Md,putStream:Gs,events:pi,scaleFactor:Ie,pageSize:{getWidth:function(){return Bp(I)},setWidth:function(R){n_(I,R)},getHeight:function(){return $h(I)},setHeight:function(R){Bg(I,R)}},encryptionOptions:u,encryption:Xs,getEncryptor:MR,output:Og,getNumberOfPages:TR,pages:Le,out:Se,f2:J,f3:N,getPageInfo:xC,getPageInfoByObjId:Ni,getCurrentPageInfo:kR,getPDFVersion:g,Point:qh,Rectangle:i_,Matrix:Rt,hasHotfix:X0},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return Bp(I)},set:function(R){n_(I,R)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return $h(I)},set:function(R){Bg(I,R)},enumerable:!0,configurable:!0}),ER.call(f,de),ke="F1",$0(n,i),pi.publish("initialized"),f}fR.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},fR.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},fR.prototype.hexToBytes=function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(String.fromCharCode(parseInt(t.substr(i,2),16)));return e.join("")},fR.prototype.processOwnerPassword=function(t,e){return Mce(Dce(e).substr(0,5),t)},fR.prototype.encryptor=function(t,e){var i=Dce(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Mce(i,r)}},Lz.prototype.equals=function(t){var e,i="id,objectNumber,equals";if(!t||(0,Dn.default)(t)!==(0,Dn.default)(this))return!1;var r=0;for(e in this)if(!(i.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&i.indexOf(e)<0&&r--;return r===0},Ti.API={events:[]},Ti.version="2.5.2";var Zo=Ti.API,Pce=1,mC=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},uR=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},$i=function(t){return t.toFixed(2)},j0=function(t){return t.toFixed(5)};Zo.__acroform__={};var Wc=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},e9e=function(t){return t*Pce},Mp=function(t){var e=new v9e,i=ei.internal.getHeight(t)||0,r=ei.internal.getWidth(t)||0;return e.BBox=[0,0,Number($i(r)),Number($i(i))],e},MGt=Zo.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},kGt=Zo.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},OGt=Zo.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},ps=Zo.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return OGt(t,e-1)},ms=Zo.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return MGt(t,e-1)},gs=Zo.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return kGt(t,e-1)},NGt=Zo.__acroform__.calculateCoordinates=function(t,e){var i=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,n=t[0],o=t[1],s=t[2],a=t[3],c={};return c.lowerLeft_X=i(n)||0,c.lowerLeft_Y=r(o+a)||0,c.upperRight_X=i(n+s)||0,c.upperRight_Y=r(o)||0,[Number($i(c.lowerLeft_X)),Number($i(c.lowerLeft_Y)),Number($i(c.upperRight_X)),Number($i(c.upperRight_Y))]},PGt=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],i=t._V||t.DV,r=kce(t,i),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+n+" "+$i(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Mp(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},kce=function(t,e){var i=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=t.multiline?n.map(function(N){return N.split(`
`)}):n.map(function(N){return[N]});var o=i,s=ei.internal.getHeight(t)||0;s=s<0?-s:s;var a=ei.internal.getWidth(t)||0;a=a<0?-a:a;var c=function(N,P,$){if(N+1<n.length){var K=P+" "+n[N+1][0];return Iz(K,t,$).width<=a-4}return!1};o++;e:for(;o>0;){e="",o--;var d,u,h=Iz("3",t,o).height,p=t.multiline?s-o:(s-h)/2,f=p+=2,m=0,g=0,y=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Iz(e,t,o=12).width+", FieldWidth:"+a+`
`;break}for(var w="",x=0,T=0;T<n.length;T++)if(n.hasOwnProperty(T)){var M=!1;if(n[T].length!==1&&y!==n[T].length-1){if((h+2)*(x+2)+2>s)continue e;w+=n[T][y],M=!0,g=T,T--}else{w=(w+=n[T][y]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var B=parseInt(T),G=c(B,w,o),F=T>=n.length-1;if(G&&!F){w+=" ",y=0;continue}if(G||F){if(F)g=B;else if(t.multiline&&(h+2)*(x+2)+2>s)continue e}else{if(!t.multiline||(h+2)*(x+2)+2>s)continue e;g=B}}for(var O="",V=m;V<=g;V++){var J=n[V];if(t.multiline){if(V===g){O+=J[y]+" ",y=(y+1)%J.length;continue}if(V===m){O+=J[J.length-1]+" ";continue}}O+=J[0]+" "}switch(O=O.substr(O.length-1)==" "?O.substr(0,O.length-1):O,u=Iz(O,t,o).width,t.textAlign){case"right":d=a-u-2;break;case"center":d=(a-u)/2;break;case"left":default:d=2}e+=$i(d)+" "+$i(f)+` Td
`,e+="("+mC(O)+`) Tj
`,e+=-$i(d)+` 0 Td
`,f=-(o+2),u=0,m=M?g:g+1,x++,w=""}break}return r.text=e,r.fontSize=o,r},Iz=function(t,e,i){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(i),charSpace:0})*parseFloat(i);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(i),charSpace:0})*parseFloat(i)*1.5,width:n}},LGt={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},FGt=function(t,e){var i={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===i.type&&r.object===i.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(i)},HGt=function(t,e){for(var i in t)if(t.hasOwnProperty(i)){var r=i,n=t[i];e.internal.newObjectDeferredBegin(n.objId,!0),(0,Dn.default)(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete t[r]}},BGt=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Hh.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(LGt)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Pce=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new b9e,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(i){i.internal.events.unsubscribe(i.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete i.internal.acroformPlugin.acroFormDictionaryRoot._eventID,i.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(i){i.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=i.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in r)if(r.hasOwnProperty(n)){var o=r[n];o.objId=void 0,o.hasAnnotation&&FGt(o,i)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(i){if(i.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");i.internal.write("/AcroForm "+i.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(i){(function(r,n){var o=!r;for(var s in r||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(s)){var a=r[s],c=[],d=a.Rect;if(a.Rect&&(a.Rect=NGt(a.Rect,n)),n.internal.newObjectDeferredBegin(a.objId,!0),a.DA=ei.createDefaultAppearanceStream(a),(0,Dn.default)(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(c=a.getKeyValueListForStream()),a.Rect=d,a.hasAppearanceStream&&!a.appearanceStreamContent){var u=PGt(a);c.push({key:"AP",value:"<</N "+u+">>"}),n.internal.acroformPlugin.xForms.push(u)}if(a.appearanceStreamContent){var h="";for(var p in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(p)){var f=a.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var s in f)if(f.hasOwnProperty(s)){var m=f[s];typeof m=="function"&&(m=m.call(n,a)),h+="/"+s+" "+m+" ",n.internal.acroformPlugin.xForms.indexOf(m)>=0||n.internal.acroformPlugin.xForms.push(m)}}else typeof(m=f)=="function"&&(m=m.call(n,a)),h+="/"+s+" "+m,n.internal.acroformPlugin.xForms.indexOf(m)>=0||n.internal.acroformPlugin.xForms.push(m);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}n.internal.putStream({additionalKeyValues:c,objectId:a.objId}),n.internal.out("endobj")}o&&HGt(n.internal.acroformPlugin.xForms,n)})(i,t)}),t.internal.acroformPlugin.isInitialized=!0}},g9e=Zo.__acroform__.arrayToPdfArray=function(t,e,i){var r=function(s){return s};if(Array.isArray(t)){for(var n="[",o=0;o<t.length;o++)switch(o!==0&&(n+=" "),(0,Dn.default)(t[o])){case"boolean":case"number":case"object":n+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&i&&(r=i.internal.getEncryptor(e)),n+="("+mC(r(t[o].toString()))+")"):n+=t[o].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Tce=function(t,e,i){var r=function(n){return n};return e!==void 0&&i&&(r=i.internal.getEncryptor(e)),(t=t||"").toString(),t="("+mC(r(t))+")"},kp=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};kp.prototype.toString=function(){return this.objId+" 0 R"},kp.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},kp.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var i in e)if(Object.getOwnPropertyDescriptor(this,e[i]).configurable===!1){var r=e[i],n=this[r];n&&(Array.isArray(n)?t.push({key:r,value:g9e(n,this.objId,this.scope)}):n instanceof kp?(n.scope=this.scope,t.push({key:r,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:r,value:n}))}return t};var v9e=function(){kp.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(i){t=i.trim()},get:function(){return t||null}})};Wc(v9e,kp);var b9e=function(){kp.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var i=function(r){return r};return this.scope&&(i=this.scope.internal.getEncryptor(this.objId)),"("+mC(i(t))+")"}},set:function(i){t=i}})};Wc(b9e,kp);var Hh=function t(){kp.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ps(e,3)},set:function(w){w?this.F=ms(e,3):this.F=gs(e,3)}});var i=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return i},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');i=w}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(w){r=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(w){r[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(w){r[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(w){r[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(w){r[3]=w}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Fz)return;o="FieldObject"+t.FieldNum++}var w=function(x){return x};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+mC(w(o))+")"},set:function(w){o=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(w){o=w}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(w){s=w}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(w){a=w}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(w){c=w}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/Pce:d},set:function(w){d=w}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(w){u=w}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Fz||this instanceof pC))return Tce(h,this.objId,this.scope)},set:function(w){w=w.toString(),h=w}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ga?p:Tce(p,this.objId,this.scope)},set:function(w){w=w.toString(),p=this instanceof ga?w:w.substr(0,1)==="("?uR(w.substr(1,w.length-2)):uR(w)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ga?uR(p.substr(1,p.length-1)):p},set:function(w){w=w.toString(),p=this instanceof ga?"/"+w:w}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof ga?f:Tce(f,this.objId,this.scope)},set:function(w){w=w.toString(),f=this instanceof ga?w:w.substr(0,1)==="("?uR(w.substr(1,w.length-2)):uR(w)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ga?uR(f.substr(1,f.length-1)):f},set:function(w){w=w.toString(),f=this instanceof ga?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(w){w=!!w,g=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(w){m=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,1)},set:function(w){w?this.Ff=ms(this.Ff,1):this.Ff=gs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,2)},set:function(w){w?this.Ff=ms(this.Ff,2):this.Ff=gs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,3)},set:function(w){w?this.Ff=ms(this.Ff,3):this.Ff=gs(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');y=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(y){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:y=2;break;case"center":case 1:y=1;break;case"left":case 0:default:y=0}}})};Wc(Hh,kp);var gR=function(){Hh.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(i){t=i}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return g9e(e,this.objId,this.scope)},set:function(i){var r,n;n=[],typeof(r=i)=="string"&&(n=function(o,s,a){a||(a=1);for(var c,d=[];c=s.exec(o);)d.push(c[a]);return d}(r,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(i){e=i,this.sort&&e.sort()},this.addOption=function(i){i=(i=i||"").toString(),e.push(i),this.sort&&e.sort()},this.removeOption=function(i,r){for(r=r||!1,i=(i=i||"").toString();e.indexOf(i)!==-1&&(e.splice(e.indexOf(i),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,18)},set:function(i){i?this.Ff=ms(this.Ff,18):this.Ff=gs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,19)},set:function(i){this.combo===!0&&(i?this.Ff=ms(this.Ff,19):this.Ff=gs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,20)},set:function(i){i?(this.Ff=ms(this.Ff,20),e.sort()):this.Ff=gs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,22)},set:function(i){i?this.Ff=ms(this.Ff,22):this.Ff=gs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,23)},set:function(i){i?this.Ff=ms(this.Ff,23):this.Ff=gs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,27)},set:function(i){i?this.Ff=ms(this.Ff,27):this.Ff=gs(this.Ff,27)}}),this.hasAppearanceStream=!1};Wc(gR,Hh);var vR=function(){gR.call(this),this.fontName="helvetica",this.combo=!1};Wc(vR,gR);var bR=function(){vR.call(this),this.combo=!0};Wc(bR,vR);var kz=function(){bR.call(this),this.edit=!0};Wc(kz,bR);var ga=function(){Hh.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,15)},set:function(i){i?this.Ff=ms(this.Ff,15):this.Ff=gs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,16)},set:function(i){i?this.Ff=ms(this.Ff,16):this.Ff=gs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,17)},set:function(i){i?this.Ff=ms(this.Ff,17):this.Ff=gs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,26)},set:function(i){i?this.Ff=ms(this.Ff,26):this.Ff=gs(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};if(this.scope&&(i=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,n=[];for(r in n.push("<<"),e)n.push("/"+r+" ("+mC(i(e[r]))+")");return n.push(">>"),n.join(`
`)}},set:function(i){(0,Dn.default)(i)==="object"&&(e=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(i){typeof i=="string"&&(e.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}})};Wc(ga,Hh);var Oz=function(){ga.call(this),this.pushButton=!0};Wc(Oz,ga);var _R=function(){ga.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Wc(_R,ga);var Fz=function(){var t,e;Hh.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var i,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),r)s.push("/"+o+" ("+mC(n(r[o]))+")");return s.push(">>"),s.join(`
`)},set:function(n){(0,Dn.default)(n)==="object"&&(r=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(n){typeof n=="string"&&(r.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(n){i=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(n){i="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ei.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Wc(Fz,Hh),_R.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var i=this.Kids[e];i.appearanceStreamContent=t.createAppearanceStream(i.optionName),i.caption=t.getCA()}},_R.prototype.createOption=function(t){var e=new Fz;return e.Parent=this,e.optionName=t,this.Kids.push(e),VGt.call(this.scope,e),e};var Nz=function(){ga.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ei.CheckBox.createAppearanceStream()};Wc(Nz,ga);var pC=function(){Hh.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,13)},set:function(e){e?this.Ff=ms(this.Ff,13):this.Ff=gs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,21)},set:function(e){e?this.Ff=ms(this.Ff,21):this.Ff=gs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,23)},set:function(e){e?this.Ff=ms(this.Ff,23):this.Ff=gs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,24)},set:function(e){e?this.Ff=ms(this.Ff,24):this.Ff=gs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,25)},set:function(e){e?this.Ff=ms(this.Ff,25):this.Ff=gs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,26)},set:function(e){e?this.Ff=ms(this.Ff,26):this.Ff=gs(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Wc(pC,Hh);var Pz=function(){pC.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ps(this.Ff,14)},set:function(t){t?this.Ff=ms(this.Ff,14):this.Ff=gs(this.Ff,14)}}),this.password=!0};Wc(Pz,pC);var ei={CheckBox:{createAppearanceStream:function(){return{N:{On:ei.CheckBox.YesNormal},D:{On:ei.CheckBox.YesPushDown,Off:ei.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Mp(t);e.scope=t.scope;var i=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),o=kce(t,t.caption);return i.push("0.749023 g"),i.push("0 0 "+$i(ei.internal.getWidth(t))+" "+$i(ei.internal.getHeight(t))+" re"),i.push("f"),i.push("BMC"),i.push("q"),i.push("0 0 1 rg"),i.push("/"+r+" "+$i(o.fontSize)+" Tf "+n),i.push("BT"),i.push(o.text),i.push("ET"),i.push("Q"),i.push("EMC"),e.stream=i.join(`
`),e},YesNormal:function(t){var e=Mp(t);e.scope=t.scope;var i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),n=[],o=ei.internal.getHeight(t),s=ei.internal.getWidth(t),a=kce(t,t.caption);return n.push("1 g"),n.push("0 0 "+$i(s)+" "+$i(o)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+$i(s-1)+" "+$i(o-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+i+" "+$i(a.fontSize)+" Tf "+r),n.push(a.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Mp(t);e.scope=t.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+$i(ei.internal.getWidth(t))+" "+$i(ei.internal.getHeight(t))+" re"),i.push("f"),e.stream=i.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:ei.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=ei.RadioButton.Circle.YesNormal,e.D[t]=ei.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Mp(t);e.scope=t.scope;var i=[],r=ei.internal.getWidth(t)<=ei.internal.getHeight(t)?ei.internal.getWidth(t)/4:ei.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var n=ei.internal.Bezier_C,o=Number((r*n).toFixed(5));return i.push("q"),i.push("1 0 0 1 "+j0(ei.internal.getWidth(t)/2)+" "+j0(ei.internal.getHeight(t)/2)+" cm"),i.push(r+" 0 m"),i.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),i.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),i.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),i.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join(`
`),e},YesPushDown:function(t){var e=Mp(t);e.scope=t.scope;var i=[],r=ei.internal.getWidth(t)<=ei.internal.getHeight(t)?ei.internal.getWidth(t)/4:ei.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var n=Number((2*r).toFixed(5)),o=Number((n*ei.internal.Bezier_C).toFixed(5)),s=Number((r*ei.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+j0(ei.internal.getWidth(t)/2)+" "+j0(ei.internal.getHeight(t)/2)+" cm"),i.push(n+" 0 m"),i.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),i.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),i.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),i.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),i.push("f"),i.push("Q"),i.push("0 g"),i.push("q"),i.push("1 0 0 1 "+j0(ei.internal.getWidth(t)/2)+" "+j0(ei.internal.getHeight(t)/2)+" cm"),i.push(r+" 0 m"),i.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),i.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),i.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),i.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Mp(t);e.scope=t.scope;var i=[],r=ei.internal.getWidth(t)<=ei.internal.getHeight(t)?ei.internal.getWidth(t)/4:ei.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var n=Number((2*r).toFixed(5)),o=Number((n*ei.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+j0(ei.internal.getWidth(t)/2)+" "+j0(ei.internal.getHeight(t)/2)+" cm"),i.push(n+" 0 m"),i.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),i.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),i.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),i.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:ei.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=ei.RadioButton.Cross.YesNormal,e.D[t]=ei.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Mp(t);e.scope=t.scope;var i=[],r=ei.internal.calculateCross(t);return i.push("q"),i.push("1 1 "+$i(ei.internal.getWidth(t)-2)+" "+$i(ei.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push($i(r.x1.x)+" "+$i(r.x1.y)+" m"),i.push($i(r.x2.x)+" "+$i(r.x2.y)+" l"),i.push($i(r.x4.x)+" "+$i(r.x4.y)+" m"),i.push($i(r.x3.x)+" "+$i(r.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},YesPushDown:function(t){var e=Mp(t);e.scope=t.scope;var i=ei.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+$i(ei.internal.getWidth(t))+" "+$i(ei.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+$i(ei.internal.getWidth(t)-2)+" "+$i(ei.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push($i(i.x1.x)+" "+$i(i.x1.y)+" m"),r.push($i(i.x2.x)+" "+$i(i.x2.y)+" l"),r.push($i(i.x4.x)+" "+$i(i.x4.y)+" m"),r.push($i(i.x3.x)+" "+$i(i.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Mp(t);e.scope=t.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+$i(ei.internal.getWidth(t))+" "+$i(ei.internal.getHeight(t))+" re"),i.push("f"),e.stream=i.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+i}};ei.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=ei.internal.getWidth(t),i=ei.internal.getHeight(t),r=Math.min(e,i);return{x1:{x:(e-r)/2,y:(i-r)/2+r},x2:{x:(e-r)/2+r,y:(i-r)/2},x3:{x:(e-r)/2,y:(i-r)/2},x4:{x:(e-r)/2+r,y:(i-r)/2+r}}}},ei.internal.getWidth=function(t){var e=0;return(0,Dn.default)(t)==="object"&&(e=e9e(t.Rect[2])),e},ei.internal.getHeight=function(t){var e=0;return(0,Dn.default)(t)==="object"&&(e=e9e(t.Rect[3])),e};var VGt=Zo.addField=function(t){if(BGt(this,t),!(t instanceof Hh))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Zo.AcroFormChoiceField=gR,Zo.AcroFormListBox=vR,Zo.AcroFormComboBox=bR,Zo.AcroFormEditBox=kz,Zo.AcroFormButton=ga,Zo.AcroFormPushButton=Oz,Zo.AcroFormRadioButton=_R,Zo.AcroFormCheckBox=Nz,Zo.AcroFormTextField=pC,Zo.AcroFormPasswordField=Pz,Zo.AcroFormAppearance=ei,Zo.AcroForm={ChoiceField:gR,ListBox:vR,ComboBox:bR,EditBox:kz,Button:ga,PushButton:Oz,RadioButton:_R,CheckBox:Nz,TextField:pC,PasswordField:Pz,Appearance:ei},Ti.AcroForm={ChoiceField:gR,ListBox:vR,ComboBox:bR,EditBox:kz,Button:ga,PushButton:Oz,RadioButton:_R,CheckBox:Nz,TextField:pC,PasswordField:Pz,Appearance:ei};var Trr=Ti.AcroForm;function _9e(t){return t.reduce(function(e,i,r){return e[i]=r,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(N,P){var $,K,ve,W,ee,te=e;if((P=P||e)==="RGBA"||N.data!==void 0&&N.data instanceof Uint8ClampedArray&&"height"in N&&"width"in N)return"RGBA";if(G(N))for(ee in i)for(ve=i[ee],$=0;$<ve.length;$+=1){for(W=!0,K=0;K<ve[$].length;K+=1)if(ve[$][K]!==void 0&&ve[$][K]!==N[K]){W=!1;break}if(W===!0){te=ee;break}}else for(ee in i)for(ve=i[ee],$=0;$<ve.length;$+=1){for(W=!0,K=0;K<ve[$].length;K+=1)if(ve[$][K]!==void 0&&ve[$][K]!==N.charCodeAt(K)){W=!1;break}if(W===!0){te=ee;break}}return te===e&&P!==e&&(te=P),te},n=function N(P){for(var $=this.internal.write,K=this.internal.putStream,ve=(0,this.internal.getFilters)();ve.indexOf("FlateEncode")!==-1;)ve.splice(ve.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var W=[];if(W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Image"}),W.push({key:"Width",value:P.width}),W.push({key:"Height",value:P.height}),P.colorSpace===y.INDEXED?W.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(W.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===y.DEVICE_CMYK&&W.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),W.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&W.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)){for(var ee="",te=0,se=P.transparency.length;te<se;te++)ee+=P.transparency[te]+" "+P.transparency[te]+" ";W.push({key:"Mask",value:"["+ee+"]"})}P.sMask!==void 0&&W.push({key:"SMask",value:P.objectId+1+" 0 R"});var Ae=P.filter!==void 0?["/"+P.filter]:void 0;if(K({data:P.data,additionalKeyValues:W,alreadyAppliedFilters:Ae,objectId:P.objectId}),$("endobj"),"sMask"in P&&P.sMask!==void 0){var k="/Predictor "+P.predictor+" /Colors 1 /BitsPerComponent "+P.bitsPerComponent+" /Columns "+P.width,S={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:P.bitsPerComponent,decodeParameters:k,data:P.sMask};"filter"in P&&(S.filter=P.filter),N.call(this,S)}if(P.colorSpace===y.INDEXED){var I=this.internal.newObject();K({data:O(new Uint8Array(P.palette)),objectId:I}),$("endobj")}},o=function(){var N=this.internal.collections.addImage_images;for(var P in N)n.call(this,N[P])},s=function(){var N,P=this.internal.collections.addImage_images,$=this.internal.write;for(var K in P)$("/I"+(N=P[K]).index,N.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var N=this.internal.collections.addImage_images;return a.call(this),N},d=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(N){return typeof t["process"+N.toUpperCase()]=="function"},h=function(N){return(0,Dn.default)(N)==="object"&&N.nodeType===1},p=function(N,P){if(N.nodeName==="IMG"&&N.hasAttribute("src")){var $=""+N.getAttribute("src");if($.indexOf("data:image/")===0)return LP(unescape($).split("base64,").pop());var K=t.loadFile($,!0);if(K!==void 0)return K}if(N.nodeName==="CANVAS"){if(N.width===0||N.height===0)throw new Error("Given canvas must have data. Canvas width: "+N.width+", height: "+N.height);var ve;switch(P){case"PNG":ve="image/png";break;case"WEBP":ve="image/webp";break;case"JPEG":case"JPG":default:ve="image/jpeg"}return LP(N.toDataURL(ve,1).split("base64,").pop())}},f=function(N){var P=this.internal.collections.addImage_images;if(P){for(var $ in P)if(N===P[$].alias)return P[$]}},m=function(N,P,$){return N||P||(N=-96,P=-96),N<0&&(N=-1*$.width*72/N/this.internal.scaleFactor),P<0&&(P=-1*$.height*72/P/this.internal.scaleFactor),N===0&&(N=P*$.width/$.height),P===0&&(P=N*$.height/$.width),[N,P]},g=function(N,P,$,K,ve,W){var ee=m.call(this,$,K,ve),te=this.internal.getCoordinateString,se=this.internal.getVerticalCoordinateString,Ae=c.call(this);if($=ee[0],K=ee[1],Ae[ve.index]=ve,W){W*=Math.PI/180;var k=Math.cos(W),S=Math.sin(W),I=function(Q){return Q.toFixed(4)},X=[I(k),I(S),I(-1*S),I(k),0,0,"cm"]}this.internal.write("q"),W?(this.internal.write([1,"0","0",1,te(N),se(P+K),"cm"].join(" ")),this.internal.write(X.join(" ")),this.internal.write([te($),"0","0",te(K),"0","0","cm"].join(" "))):this.internal.write([te($),"0","0",te(K),te(N),se(P+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ve.index+" Do"),this.internal.write("Q")},y=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},x=t.__addimage__.sHashCode=function(N){var P,$,K=0;if(typeof N=="string")for($=N.length,P=0;P<$;P++)K=(K<<5)-K+N.charCodeAt(P),K|=0;else if(G(N))for($=N.byteLength/2,P=0;P<$;P++)K=(K<<5)-K+N[P],K|=0;return K},T=t.__addimage__.validateStringAsBase64=function(N){(N=N||"").toString().trim();var P=!0;return N.length===0&&(P=!1),N.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(N.substr(0,N.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(N.substr(-2))===!1&&(P=!1),P},M=t.__addimage__.extractImageFromDataUrl=function(N){var P=(N=N||"").split("base64,"),$=null;if(P.length===2){var K=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(P[0]);Array.isArray(K)&&($={mimeType:K[1],charset:K[2],data:P[1]})}return $},B=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(N){return B()&&N instanceof ArrayBuffer};var G=t.__addimage__.isArrayBufferView=function(N){return B()&&typeof Uint32Array<"u"&&(N instanceof Int8Array||N instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&N instanceof Uint8ClampedArray||N instanceof Int16Array||N instanceof Uint16Array||N instanceof Int32Array||N instanceof Uint32Array||N instanceof Float32Array||N instanceof Float64Array)},F=t.__addimage__.binaryStringToUint8Array=function(N){for(var P=N.length,$=new Uint8Array(P),K=0;K<P;K++)$[K]=N.charCodeAt(K);return $},O=t.__addimage__.arrayBufferToBinaryString=function(N){for(var P="",$=G(N)?N:new Uint8Array(N),K=0;K<$.length;K+=8192)P+=String.fromCharCode.apply(null,$.subarray(K,K+8192));return P};t.addImage=function(){var N,P,$,K,ve,W,ee,te,se;if(typeof arguments[1]=="number"?(P=e,$=arguments[1],K=arguments[2],ve=arguments[3],W=arguments[4],ee=arguments[5],te=arguments[6],se=arguments[7]):(P=arguments[1],$=arguments[2],K=arguments[3],ve=arguments[4],W=arguments[5],ee=arguments[6],te=arguments[7],se=arguments[8]),(0,Dn.default)(N=arguments[0])==="object"&&!h(N)&&"imageData"in N){var Ae=N;N=Ae.imageData,P=Ae.format||P||e,$=Ae.x||$||0,K=Ae.y||K||0,ve=Ae.w||Ae.width||ve,W=Ae.h||Ae.height||W,ee=Ae.alias||ee,te=Ae.compression||te,se=Ae.rotation||Ae.angle||se}var k=this.internal.getFilters();if(te===void 0&&k.indexOf("FlateEncode")!==-1&&(te="SLOW"),isNaN($)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var S=V.call(this,N,P,ee,te);return g.call(this,$,K,ve,W,S,se),this};var V=function(N,P,$,K){var ve,W,ee;if(typeof N=="string"&&r(N)===e){N=unescape(N);var te=J(N,!1);(te!==""||(te=t.loadFile(N,!0))!==void 0)&&(N=te)}if(h(N)&&(N=p(N,P)),P=r(N,P),!u(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((ee=$)==null||ee.length===0)&&($=function(se){return typeof se=="string"||G(se)?x(se):G(se.data)?x(se.data):null}(N)),(ve=f.call(this,$))||(B()&&(N instanceof Uint8Array||P==="RGBA"||(W=N,N=F(N))),ve=this["process"+P.toUpperCase()](N,d.call(this),$,function(se){return se&&typeof se=="string"&&(se=se.toUpperCase()),se in t.image_compression?se:w.NONE}(K),W)),!ve)throw new Error("An unknown error occurred whilst processing the image.");return ve},J=t.__addimage__.convertBase64ToBinaryString=function(N,P){var $;P=typeof P!="boolean"||P;var K,ve="";if(typeof N=="string"){K=($=M(N))!==null?$.data:N;try{ve=LP(K)}catch(W){if(P)throw T(K)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+W.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ve};t.getImageProperties=function(N){var P,$,K="";if(h(N)&&(N=p(N)),typeof N=="string"&&r(N)===e&&((K=J(N,!1))===""&&(K=t.loadFile(N)||""),N=K),$=r(N),!u($))throw new Error("addImage does not support files of type '"+$+"', please ensure that a plugin for '"+$+"' support is added.");if(!B()||N instanceof Uint8Array||(N=F(N)),!(P=this["process"+$.toUpperCase()](N)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=$,P}})(Ti.API),function(t){var e=function(i){if(i!==void 0&&i!="")return!0};Ti.API.events.push(["addPage",function(i){this.internal.getPageInfo(i.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(i){for(var r,n,o,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(i.objId),d=i.pageContext.annotations,u=!1,h=0;h<d.length&&!u;h++)switch((r=d[h]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var p=0;p<d.length;p++){r=d[p];var f=this.internal.pdfEscape,m=this.internal.getEncryptor(i.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(g.objId),x=r.title||"Note";o="<</Type /Annot /Subtype /Text "+(n="/Rect ["+s(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+f(w(r.contents))+")",o+=" /Popup "+y.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+f(w(x))+") >>",g.content=o;var T=g.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+s(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+T,r.open&&(o+=" /Open true"),o+=" >>",y.content=o,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":n="/Rect ["+s(r.bounds.x)+" "+a(r.bounds.y)+" "+s(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var M=r.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(m(r.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(r.options.name){var B=this.annotations._nameMap[r.options.name];r.options.pageNumber=B.page,r.options.top=B.y}else r.options.top||(r.options.top=0);if(n="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",o="",r.options.url)o="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(m(r.options.url))+") >>";else if(r.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,o+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var G=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),o+=" /XYZ "+r.options.left+" "+G+" "+r.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(i){var r=this.internal.getCurrentPageInfo();switch(i.type){case"link":this.link(i.bounds.x,i.bounds.y,i.bounds.w,i.bounds.h,i);break;case"text":case"freetext":r.pageContext.annotations.push(i)}},t.link=function(i,r,n,o,s){var a=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:c(i),y:d(r),w:c(i+n),h:d(r+o)},options:s,type:"link"})},t.textWithLink=function(i,r,n,o){var s,a,c=this.getTextWidth(i),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){a=o.maxWidth;var u=this.splitTextToSize(i,a).length;s=Math.ceil(d*u)}else a=c,s=d;return this.text(i,r,n,o),n+=.2*d,o.align==="center"&&(r-=c/2),o.align==="right"&&(r-=c),this.link(r,n-d,a,s,o),c},t.getTextWidth=function(i){var r=this.internal.getFontSize();return this.getStringUnitWidth(i)*r/this.internal.scaleFactor}}(Ti.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},i={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(g){return e[g.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},a=t.__arabicParser__.isArabicEndLetter=function(g){return s(g)&&o(g)&&e[g.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(g){return s(g)&&n.indexOf(g.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return s(g)&&o(g)&&e[g.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(g){return s(g)&&o(g)&&e[g.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(g){return s(g)&&o(g)&&e[g.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(g){return s(g)&&o(g)&&e[g.charCodeAt(0)].length==4},h=t.__arabicParser__.resolveLigatures=function(g){var y=0,w=i,x="",T=0;for(y=0;y<g.length;y+=1)w[g.charCodeAt(y)]!==void 0?(T++,typeof(w=w[g.charCodeAt(y)])=="number"&&(x+=String.fromCharCode(w),w=i,T=0),y===g.length-1&&(w=i,x+=g.charAt(y-(T-1)),y-=T-1,T=0)):(w=i,x+=g.charAt(y-T),y-=T,T=0);return x};t.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&r[g.charCodeAt(0)]!==void 0};var p=t.__arabicParser__.getCorrectForm=function(g,y,w){return s(g)?o(g)===!1?-1:!d(g)||!s(y)&&!s(w)||!s(w)&&a(y)||a(g)&&!s(y)||a(g)&&c(y)||a(g)&&a(y)?0:u(g)&&s(y)&&!a(y)&&s(w)&&d(w)?3:a(g)||!s(w)?1:2:-1},f=function(g){var y=0,w=0,x=0,T="",M="",B="",G=(g=g||"").split("\\s+"),F=[];for(y=0;y<G.length;y+=1){for(F.push(""),w=0;w<G[y].length;w+=1)T=G[y][w],M=G[y][w-1],B=G[y][w+1],s(T)?(x=p(T,M,B),F[y]+=x!==-1?String.fromCharCode(e[T.charCodeAt(0)][x]):T):F[y]+=T;F[y]=h(F[y])}return F.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(y)){var x=0;for(w=[],x=0;x<y.length;x+=1)Array.isArray(y[x])?w.push([f(y[x][0]),y[x][1],y[x][2]]):w.push([f(y[x])]);g=w}else g=f(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};t.events.push(["preProcessText",m])}(Ti.API),Ti.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var i=void 0;Object.defineProperty(this,"pdf",{get:function(){return i},set:function(a){i=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(a){n=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(a){o=a}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(i,r){var n;if((i=i||"2d")!=="2d")return null;for(n in r)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=r[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Ti.API),function(t){var e={left:0,top:0,bottom:0,right:0},i=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){r.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),h=d.font||this.getFont(),p=d.scaleFactor||this.internal.scaleFactor,f=0,m=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var w=d.maxWidth;w>0?typeof c=="string"?c=this.splitTextToSize(c,w):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(T,M){return T.concat(y.splitTextToSize(M,w))},[])):c=Array.isArray(c)?c:[c];for(var x=0;x<c.length;x++)f<(g=this.getStringUnitWidth(c[x],{font:h})*u)&&(f=g);return f!==0&&(m=c.length),{w:f/=p,h:Math.max((m*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/p,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,f&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,i===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,u,h,p){if(r.call(this),!u)throw new Error("No data for PDF table.");var f,m,g,y,w=[],x=[],T=[],M={},B={},G=[],F=[],O=(p=p||{}).autoSize||!1,V=p.printHeaders!==!1,J=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,N=p.margins||Object.assign({width:this.getPageWidth()},e),P=typeof p.padding=="number"?p.padding:3,$=p.headerBackgroundColor||"#c8c8c8",K=p.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=V,this.internal.__cell__.margins=N,this.internal.__cell__.table_font_size=J,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=$,this.internal.__cell__.headerTextColor=K,this.setFontSize(J),h==null)x=w=Object.keys(u[0]),T=w.map(function(){return"left"});else if(Array.isArray(h)&&(0,Dn.default)(h[0])==="object")for(w=h.map(function(Ae){return Ae.name}),x=h.map(function(Ae){return Ae.prompt||Ae.name||""}),T=h.map(function(Ae){return Ae.align||"left"}),f=0;f<h.length;f+=1)B[h[f].name]=h[f].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(x=w=h,T=w.map(function(){return"left"}));if(O||Array.isArray(h)&&typeof h[0]=="string")for(f=0;f<w.length;f+=1){for(M[y=w[f]]=u.map(function(Ae){return Ae[y]}),this.setFont(void 0,"bold"),G.push(this.getTextDimensions(x[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=M[y],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)G.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[y]=Math.max.apply(null,G)+P+P,G=[]}if(V){var ve={};for(f=0;f<w.length;f+=1)ve[w[f]]={},ve[w[f]].text=x[f],ve[w[f]].align=T[f];var W=a.call(this,ve,B);F=w.map(function(Ae){return new o(c,d,B[Ae],W,ve[Ae].text,void 0,ve[Ae].align)}),this.setTableHeaderRow(F),this.printHeaderRow(1,!1)}var ee=h.reduce(function(Ae,k){return Ae[k.name]=k.align,Ae},{});for(f=0;f<u.length;f+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:f,data:u[f]},this);var te=a.call(this,u[f],B);for(g=0;g<w.length;g+=1){var se=u[f][w[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:f,col:g,data:se},this),s.call(this,new o(c,d,B[w[g]],te,se,f+2,ee[w[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var a=function(c,d){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map(function(f){var m=c[f];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,d[f]-u-u)},this).map(function(f){return this.getLineHeightFactor()*f.length*h/p+u+u},this).reduce(function(f,m){return Math.max(f,m)},0)};t.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(i=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){u=this.internal.__cell__.tableHeaderRow[f].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,p.push(u)),u.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(m)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),i=!1}}(Ti.API);var y9e={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},w9e=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Oce=_9e(w9e),C9e=[100,200,300,400,500,600,700,800,900],jGt=_9e(C9e);function Nce(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),i=function(o){return y9e[o=o||"normal"]?o:"normal"}(t.style),r=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(t.weight),n=function(o){return typeof Oce[o=o||"normal"]=="number"?o:"normal"}(t.stretch);return{family:e,style:i,weight:r,stretch:n,src:t.src||[],ref:t.ref||{name:e,style:[n,i,r].join(" ")}}}function t9e(t,e,i,r){var n;for(n=i;n>=0&&n<e.length;n+=r)if(t[e[n]])return t[e[n]];for(n=i;n>=0&&n<e.length;n-=r)if(t[e[n]])return t[e[n]]}var zGt={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},i9e={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function r9e(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function WGt(t,e,i){for(var r=(i=i||{}).defaultFontFamily||"times",n=Object.assign({},zGt,i.genericFontFamilies||{}),o=null,s=null,a=0;a<e.length;++a)if(n[(o=Nce(e[a])).family]&&(o.family=n[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[r]))throw new Error("Could not find a font-family for the rule '"+r9e(o)+"' and default family '"+r+"'.");if(s=function(c,d){if(d[c])return d[c];var u=Oce[c],h=u<=Oce.normal?-1:1,p=t9e(d,w9e,u,h);if(!p)throw new Error("Could not find a matching font-stretch value for "+c);return p}(o.stretch,s),s=function(c,d){if(d[c])return d[c];for(var u=y9e[c],h=0;h<u.length;++h)if(d[u[h]])return d[u[h]];throw new Error("Could not find a matching font-style for "+c)}(o.style,s),!(s=function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var u=jGt[c],h=t9e(d,C9e,u,c<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+c);return h}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+r9e(o)+"'.");return s}function n9e(t){return t.trimLeft()}function UGt(t,e){for(var i=0;i<t.length;){if(t.charAt(i)===e)return[t.substring(0,i),t.substring(i+1)];i+=1}return null}function qGt(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Dz,o9e,s9e,Rce=["times"];(function(t){var e,i,r,n,o,s,a,c,d,u=function(S){return S=S||{},this.isStrokeTransparent=S.isStrokeTransparent||!1,this.strokeOpacity=S.strokeOpacity||1,this.strokeStyle=S.strokeStyle||"#000000",this.fillStyle=S.fillStyle||"#000000",this.isFillTransparent=S.isFillTransparent||!1,this.fillOpacity=S.fillOpacity||1,this.font=S.font||"10px sans-serif",this.textBaseline=S.textBaseline||"alphabetic",this.textAlign=S.textAlign||"left",this.lineWidth=S.lineWidth||1,this.lineJoin=S.lineJoin||"miter",this.lineCap=S.lineCap||"butt",this.path=S.path||[],this.transform=S.transform!==void 0?S.transform.clone():new c,this.globalCompositeOperation=S.globalCompositeOperation||"normal",this.globalAlpha=S.globalAlpha||1,this.clip_path=S.clip_path||[],this.currentPoint=S.currentPoint||new s,this.miterLimit=S.miterLimit||10,this.lastPoint=S.lastPoint||new s,this.lineDashOffset=S.lineDashOffset||0,this.lineDash=S.lineDash||[],this.margin=S.margin||[0,0,0,0],this.prevPageLastElemOffset=S.prevPageLastElemOffset||0,this.ignoreClearRect=typeof S.ignoreClearRect!="boolean"||S.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,i=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,a=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var h=function(S){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=S;Object.defineProperty(this,"pdf",{get:function(){return I}});var X=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return X},set:function(Ue){X=!!Ue}});var Q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Q},set:function(Ue){Q=!!Ue}});var le=0;Object.defineProperty(this,"posX",{get:function(){return le},set:function(Ue){isNaN(Ue)||(le=Ue)}});var xe=0;Object.defineProperty(this,"posY",{get:function(){return xe},set:function(Ue){isNaN(Ue)||(xe=Ue)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Ue){var Se;typeof Ue=="number"?Se=[Ue,Ue,Ue,Ue]:((Se=new Array(4))[0]=Ue[0],Se[1]=Ue.length>=2?Ue[1]:Se[0],Se[2]=Ue.length>=3?Ue[2]:Se[0],Se[3]=Ue.length>=4?Ue[3]:Se[1]),d.margin=Se}});var Re=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Re},set:function(Ue){Re=Ue}});var Oe=0;Object.defineProperty(this,"lastBreak",{get:function(){return Oe},set:function(Ue){Oe=Ue}});var We=[];Object.defineProperty(this,"pageBreaks",{get:function(){return We},set:function(Ue){We=Ue}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Ue){Ue instanceof u&&(d=Ue)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Ue){d.path=Ue}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(Ue){Le=Ue}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ue){var Se;Se=p(Ue),this.ctx.fillStyle=Se.style,this.ctx.isFillTransparent=Se.a===0,this.ctx.fillOpacity=Se.a,this.pdf.setFillColor(Se.r,Se.g,Se.b,{a:Se.a}),this.pdf.setTextColor(Se.r,Se.g,Se.b,{a:Se.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ue){var Se=p(Ue);this.ctx.strokeStyle=Se.style,this.ctx.isStrokeTransparent=Se.a===0,this.ctx.strokeOpacity=Se.a,Se.a===0?this.pdf.setDrawColor(255,255,255):(Se.a,this.pdf.setDrawColor(Se.r,Se.g,Se.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ue){["butt","round","square"].indexOf(Ue)!==-1&&(this.ctx.lineCap=Ue,this.pdf.setLineCap(Ue))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ue){isNaN(Ue)||(this.ctx.lineWidth=Ue,this.pdf.setLineWidth(Ue))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ue){["bevel","round","miter"].indexOf(Ue)!==-1&&(this.ctx.lineJoin=Ue,this.pdf.setLineJoin(Ue))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ue){isNaN(Ue)||(this.ctx.miterLimit=Ue,this.pdf.setMiterLimit(Ue))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ue){this.ctx.textBaseline=Ue}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ue){["right","end","center","left","start"].indexOf(Ue)!==-1&&(this.ctx.textAlign=Ue)}});var Ne=null;function it(Ue,Se){if(Ne===null){var gt=function(ce){var de=[];return Object.keys(ce).forEach(function(ye){ce[ye].forEach(function(Me){var pe=null;switch(Me){case"bold":pe={family:ye,weight:"bold"};break;case"italic":pe={family:ye,style:"italic"};break;case"bolditalic":pe={family:ye,weight:"bold",style:"italic"};break;case"":case"normal":pe={family:ye}}pe!==null&&(pe.ref={name:ye,style:Me},de.push(pe))})}),de}(Ue.getFontList());Ne=function(ce){for(var de={},ye=0;ye<ce.length;++ye){var Me=Nce(ce[ye]),pe=Me.family,ue=Me.stretch,A=Me.style,L=Me.weight;de[pe]=de[pe]||{},de[pe][ue]=de[pe][ue]||{},de[pe][ue][A]=de[pe][ue][A]||{},de[pe][ue][A][L]=Me}return de}(gt.concat(Se))}return Ne}var ct=null;Object.defineProperty(this,"fontFaces",{get:function(){return ct},set:function(Ue){Ne=null,ct=Ue}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ue){var Se;if(this.ctx.font=Ue,(Se=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ue))!==null){var gt=Se[1],ce=(Se[2],Se[3]),de=Se[4],ye=(Se[5],Se[6]),Me=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(de)[2];de=Math.floor(Me==="px"?parseFloat(de)*this.pdf.internal.scaleFactor:Me==="em"?parseFloat(de)*this.pdf.getFontSize():parseFloat(de)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(de);var pe=function(we){var ke,Ie,ze=[],rt=we.trim();if(rt==="")return Rce;if(rt in i9e)return[i9e[rt]];for(;rt!=="";){switch(Ie=null,ke=(rt=n9e(rt)).charAt(0)){case'"':case"'":Ie=UGt(rt.substring(1),ke);break;default:Ie=qGt(rt)}if(Ie===null||(ze.push(Ie[0]),(rt=n9e(Ie[1]))!==""&&rt.charAt(0)!==","))return Rce;rt=rt.replace(/^,/,"")}return ze}(ye);if(this.fontFaces){var ue=WGt(it(this.pdf,this.fontFaces),pe.map(function(we){return{family:we,stretch:"normal",weight:ce,style:gt}}));this.pdf.setFont(ue.ref.name,ue.ref.style)}else{var A="";(ce==="bold"||parseInt(ce,10)>=700||gt==="bold")&&(A="bold"),gt==="italic"&&(A+="italic"),A.length===0&&(A="normal");for(var L="",Y={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Z=0;Z<pe.length;Z++){if(this.pdf.internal.getFont(pe[Z],A,{noFallback:!0,disableWarning:!0})!==void 0){L=pe[Z];break}if(A==="bolditalic"&&this.pdf.internal.getFont(pe[Z],"bold",{noFallback:!0,disableWarning:!0})!==void 0)L=pe[Z],A="bold";else if(this.pdf.internal.getFont(pe[Z],"normal",{noFallback:!0,disableWarning:!0})!==void 0){L=pe[Z],A="normal";break}}if(L===""){for(var fe=0;fe<pe.length;fe++)if(Y[pe[fe]]){L=Y[pe[fe]];break}}L=L===""?"Times":L,this.pdf.setFont(L,A)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ue){this.ctx.globalCompositeOperation=Ue}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ue){this.ctx.globalAlpha=Ue}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ue){this.ctx.lineDashOffset=Ue,k.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ue){this.ctx.lineDash=Ue,k.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ue){this.ctx.ignoreClearRect=!!Ue}})};h.prototype.setLineDash=function(S){this.lineDash=S},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){M.call(this,"fill",!1)},h.prototype.stroke=function(){M.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(S,I){if(isNaN(S)||isNaN(I))throw Hn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var X=this.ctx.transform.applyToPoint(new s(S,I));this.path.push({type:"mt",x:X.x,y:X.y}),this.ctx.lastPoint=new s(S,I)},h.prototype.closePath=function(){var S=new s(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&(0,Dn.default)(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){S=new s(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(S.x,S.y)},h.prototype.lineTo=function(S,I){if(isNaN(S)||isNaN(I))throw Hn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var X=this.ctx.transform.applyToPoint(new s(S,I));this.path.push({type:"lt",x:X.x,y:X.y}),this.ctx.lastPoint=new s(X.x,X.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},h.prototype.quadraticCurveTo=function(S,I,X,Q){if(isNaN(X)||isNaN(Q)||isNaN(S)||isNaN(I))throw Hn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var le=this.ctx.transform.applyToPoint(new s(X,Q)),xe=this.ctx.transform.applyToPoint(new s(S,I));this.path.push({type:"qct",x1:xe.x,y1:xe.y,x:le.x,y:le.y}),this.ctx.lastPoint=new s(le.x,le.y)},h.prototype.bezierCurveTo=function(S,I,X,Q,le,xe){if(isNaN(le)||isNaN(xe)||isNaN(S)||isNaN(I)||isNaN(X)||isNaN(Q))throw Hn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Re=this.ctx.transform.applyToPoint(new s(le,xe)),Oe=this.ctx.transform.applyToPoint(new s(S,I)),We=this.ctx.transform.applyToPoint(new s(X,Q));this.path.push({type:"bct",x1:Oe.x,y1:Oe.y,x2:We.x,y2:We.y,x:Re.x,y:Re.y}),this.ctx.lastPoint=new s(Re.x,Re.y)},h.prototype.arc=function(S,I,X,Q,le,xe){if(isNaN(S)||isNaN(I)||isNaN(X)||isNaN(Q)||isNaN(le))throw Hn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(xe=!!xe,!this.ctx.transform.isIdentity){var Re=this.ctx.transform.applyToPoint(new s(S,I));S=Re.x,I=Re.y;var Oe=this.ctx.transform.applyToPoint(new s(0,X)),We=this.ctx.transform.applyToPoint(new s(0,0));X=Math.sqrt(Math.pow(Oe.x-We.x,2)+Math.pow(Oe.y-We.y,2))}Math.abs(le-Q)>=2*Math.PI&&(Q=0,le=2*Math.PI),this.path.push({type:"arc",x:S,y:I,radius:X,startAngle:Q,endAngle:le,counterclockwise:xe})},h.prototype.arcTo=function(S,I,X,Q,le){throw new Error("arcTo not implemented.")},h.prototype.rect=function(S,I,X,Q){if(isNaN(S)||isNaN(I)||isNaN(X)||isNaN(Q))throw Hn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(S,I),this.lineTo(S+X,I),this.lineTo(S+X,I+Q),this.lineTo(S,I+Q),this.lineTo(S,I),this.lineTo(S+X,I),this.lineTo(S,I)},h.prototype.fillRect=function(S,I,X,Q){if(isNaN(S)||isNaN(I)||isNaN(X)||isNaN(Q))throw Hn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var le={};this.lineCap!=="butt"&&(le.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(le.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(S,I,X,Q),this.fill(),le.hasOwnProperty("lineCap")&&(this.lineCap=le.lineCap),le.hasOwnProperty("lineJoin")&&(this.lineJoin=le.lineJoin)}},h.prototype.strokeRect=function(S,I,X,Q){if(isNaN(S)||isNaN(I)||isNaN(X)||isNaN(Q))throw Hn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(S,I,X,Q),this.stroke())},h.prototype.clearRect=function(S,I,X,Q){if(isNaN(S)||isNaN(I)||isNaN(X)||isNaN(Q))throw Hn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(S,I,X,Q))},h.prototype.save=function(S){S=typeof S!="boolean"||S;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,X=0;X<this.pdf.internal.getNumberOfPages();X++)this.pdf.setPage(X+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),S){this.ctx.fontSize=this.pdf.internal.getFontSize();var Q=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Q}},h.prototype.restore=function(S){S=typeof S!="boolean"||S;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,X=0;X<this.pdf.internal.getNumberOfPages();X++)this.pdf.setPage(X+1),this.pdf.internal.out("Q");this.pdf.setPage(I),S&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(S){var I,X,Q,le;if(S.isCanvasGradient===!0&&(S=S.getColor()),!S)return{r:0,g:0,b:0,a:0,style:S};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(S))I=0,X=0,Q=0,le=0;else{var xe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(S);if(xe!==null)I=parseInt(xe[1]),X=parseInt(xe[2]),Q=parseInt(xe[3]),le=1;else if((xe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(S))!==null)I=parseInt(xe[1]),X=parseInt(xe[2]),Q=parseInt(xe[3]),le=parseFloat(xe[4]);else{if(le=1,typeof S=="string"&&S.charAt(0)!=="#"){var Re=new f9e(S);S=Re.ok?Re.toHex():"#000000"}S.length===4?(I=S.substring(1,2),I+=I,X=S.substring(2,3),X+=X,Q=S.substring(3,4),Q+=Q):(I=S.substring(1,3),X=S.substring(3,5),Q=S.substring(5,7)),I=parseInt(I,16),X=parseInt(X,16),Q=parseInt(Q,16)}}return{r:I,g:X,b:Q,a:le,style:S}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(S,I,X,Q){if(isNaN(I)||isNaN(X)||typeof S!="string")throw Hn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Q=isNaN(Q)?void 0:Q,!f.call(this)){var le=te(this.ctx.transform.rotation),xe=this.ctx.transform.scaleX;P.call(this,{text:S,x:I,y:X,scale:xe,angle:le,align:this.textAlign,maxWidth:Q})}},h.prototype.strokeText=function(S,I,X,Q){if(isNaN(I)||isNaN(X)||typeof S!="string")throw Hn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){Q=isNaN(Q)?void 0:Q;var le=te(this.ctx.transform.rotation),xe=this.ctx.transform.scaleX;P.call(this,{text:S,x:I,y:X,scale:xe,renderingMode:"stroke",angle:le,align:this.textAlign,maxWidth:Q})}},h.prototype.measureText=function(S){if(typeof S!="string")throw Hn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,X=this.pdf.internal.scaleFactor,Q=I.internal.getFontSize(),le=I.getStringUnitWidth(S)*Q/I.internal.scaleFactor,xe=function(Re){var Oe=(Re=Re||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Oe}}),this};return new xe({width:le*=Math.round(96*X/72*1e4)/1e4})},h.prototype.scale=function(S,I){if(isNaN(S)||isNaN(I))throw Hn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var X=new c(S,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(X)},h.prototype.rotate=function(S){if(isNaN(S))throw Hn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new c(Math.cos(S),Math.sin(S),-Math.sin(S),Math.cos(S),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},h.prototype.translate=function(S,I){if(isNaN(S)||isNaN(I))throw Hn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var X=new c(1,0,0,1,S,I);this.ctx.transform=this.ctx.transform.multiply(X)},h.prototype.transform=function(S,I,X,Q,le,xe){if(isNaN(S)||isNaN(I)||isNaN(X)||isNaN(Q)||isNaN(le)||isNaN(xe))throw Hn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Re=new c(S,I,X,Q,le,xe);this.ctx.transform=this.ctx.transform.multiply(Re)},h.prototype.setTransform=function(S,I,X,Q,le,xe){S=isNaN(S)?1:S,I=isNaN(I)?0:I,X=isNaN(X)?0:X,Q=isNaN(Q)?1:Q,le=isNaN(le)?0:le,xe=isNaN(xe)?0:xe,this.ctx.transform=new c(S,I,X,Q,le,xe)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(S,I,X,Q,le,xe,Re,Oe,We){var Le=this.pdf.getImageProperties(S),Ne=1,it=1,ct=1,Ue=1;Q!==void 0&&Oe!==void 0&&(ct=Oe/Q,Ue=We/le,Ne=Le.width/Q*Oe/Q,it=Le.height/le*We/le),xe===void 0&&(xe=I,Re=X,I=0,X=0),Q!==void 0&&Oe===void 0&&(Oe=Q,We=le),Q===void 0&&Oe===void 0&&(Oe=Le.width,We=Le.height);for(var Se,gt=this.ctx.transform.decompose(),ce=te(gt.rotate.shx),de=new c,ye=(de=(de=(de=de.multiply(gt.translate)).multiply(gt.skew)).multiply(gt.scale)).applyToRectangle(new a(xe-I*ct,Re-X*Ue,Q*Ne,le*it)),Me=y.call(this,ye),pe=[],ue=0;ue<Me.length;ue+=1)pe.indexOf(Me[ue])===-1&&pe.push(Me[ue]);if(T(pe),this.autoPaging)for(var A=pe[0],L=pe[pe.length-1],Y=A;Y<L+1;Y++){this.pdf.setPage(Y);var Z=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],fe=Y===1?this.posY+this.margin[0]:this.margin[0],we=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ke=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ie=Y===1?0:we+(Y-2)*ke;if(this.ctx.clip_path.length!==0){var ze=this.path;Se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(Se,this.posX+this.margin[3],-Ie+fe+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=ze}var rt=JSON.parse(JSON.stringify(ye));rt=x([rt],this.posX+this.margin[3],-Ie+fe+this.ctx.prevPageLastElemOffset)[0];var yt=(Y>A||Y<L)&&g.call(this);yt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Z,ke,null).clip().discardPath()),this.pdf.addImage(S,"JPEG",rt.x,rt.y,rt.w,rt.h,null,null,ce),yt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(S,"JPEG",ye.x,ye.y,ye.w,ye.h,null,null,ce)};var y=function(S,I,X){var Q=[];I=I||this.pdf.internal.pageSize.width,X=X||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var le=this.posY+this.ctx.prevPageLastElemOffset;switch(S.type){default:case"mt":case"lt":Q.push(Math.floor((S.y+le)/X)+1);break;case"arc":Q.push(Math.floor((S.y+le-S.radius)/X)+1),Q.push(Math.floor((S.y+le+S.radius)/X)+1);break;case"qct":var xe=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x,S.y);Q.push(Math.floor((xe.y+le)/X)+1),Q.push(Math.floor((xe.y+xe.h+le)/X)+1);break;case"bct":var Re=Ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x2,S.y2,S.x,S.y);Q.push(Math.floor((Re.y+le)/X)+1),Q.push(Math.floor((Re.y+Re.h+le)/X)+1);break;case"rect":Q.push(Math.floor((S.y+le)/X)+1),Q.push(Math.floor((S.y+S.h+le)/X)+1)}for(var Oe=0;Oe<Q.length;Oe+=1)for(;this.pdf.internal.getNumberOfPages()<Q[Oe];)w.call(this);return Q},w=function(){var S=this.fillStyle,I=this.strokeStyle,X=this.font,Q=this.lineCap,le=this.lineWidth,xe=this.lineJoin;this.pdf.addPage(),this.fillStyle=S,this.strokeStyle=I,this.font=X,this.lineCap=Q,this.lineWidth=le,this.lineJoin=xe},x=function(S,I,X){for(var Q=0;Q<S.length;Q++)switch(S[Q].type){case"bct":S[Q].x2+=I,S[Q].y2+=X;case"qct":S[Q].x1+=I,S[Q].y1+=X;case"mt":case"lt":case"arc":default:S[Q].x+=I,S[Q].y+=X}return S},T=function(S){return S.sort(function(I,X){return I-X})},M=function(S,I){for(var X,Q,le=this.fillStyle,xe=this.strokeStyle,Re=this.lineCap,Oe=this.lineWidth,We=Math.abs(Oe*this.ctx.transform.scaleX),Le=this.lineJoin,Ne=JSON.parse(JSON.stringify(this.path)),it=JSON.parse(JSON.stringify(this.path)),ct=[],Ue=0;Ue<it.length;Ue++)if(it[Ue].x!==void 0)for(var Se=y.call(this,it[Ue]),gt=0;gt<Se.length;gt+=1)ct.indexOf(Se[gt])===-1&&ct.push(Se[gt]);for(var ce=0;ce<ct.length;ce++)for(;this.pdf.internal.getNumberOfPages()<ct[ce];)w.call(this);if(T(ct),this.autoPaging)for(var de=ct[0],ye=ct[ct.length-1],Me=de;Me<ye+1;Me++){this.pdf.setPage(Me),this.fillStyle=le,this.strokeStyle=xe,this.lineCap=Re,this.lineWidth=We,this.lineJoin=Le;var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ue=Me===1?this.posY+this.margin[0]:this.margin[0],A=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],L=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Y=Me===1?0:A+(Me-2)*L;if(this.ctx.clip_path.length!==0){var Z=this.path;X=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(X,this.posX+this.margin[3],-Y+ue+this.ctx.prevPageLastElemOffset),B.call(this,S,!0),this.path=Z}if(Q=JSON.parse(JSON.stringify(Ne)),this.path=x(Q,this.posX+this.margin[3],-Y+ue+this.ctx.prevPageLastElemOffset),I===!1||Me===0){var fe=(Me>de||Me<ye)&&g.call(this);fe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,L,null).clip().discardPath()),B.call(this,S,I),fe&&this.pdf.restoreGraphicsState()}this.lineWidth=Oe}else this.lineWidth=We,B.call(this,S,I),this.lineWidth=Oe;this.path=Ne},B=function(S,I){if((S!=="stroke"||I||!m.call(this))&&(S==="stroke"||I||!f.call(this))){for(var X,Q,le=[],xe=this.path,Re=0;Re<xe.length;Re++){var Oe=xe[Re];switch(Oe.type){case"begin":le.push({begin:!0});break;case"close":le.push({close:!0});break;case"mt":le.push({start:Oe,deltas:[],abs:[]});break;case"lt":var We=le.length;if(xe[Re-1]&&!isNaN(xe[Re-1].x)&&(X=[Oe.x-xe[Re-1].x,Oe.y-xe[Re-1].y],We>0)){for(;We>=0;We--)if(le[We-1].close!==!0&&le[We-1].begin!==!0){le[We-1].deltas.push(X),le[We-1].abs.push(Oe);break}}break;case"bct":X=[Oe.x1-xe[Re-1].x,Oe.y1-xe[Re-1].y,Oe.x2-xe[Re-1].x,Oe.y2-xe[Re-1].y,Oe.x-xe[Re-1].x,Oe.y-xe[Re-1].y],le[le.length-1].deltas.push(X);break;case"qct":var Le=xe[Re-1].x+2/3*(Oe.x1-xe[Re-1].x),Ne=xe[Re-1].y+2/3*(Oe.y1-xe[Re-1].y),it=Oe.x+2/3*(Oe.x1-Oe.x),ct=Oe.y+2/3*(Oe.y1-Oe.y),Ue=Oe.x,Se=Oe.y;X=[Le-xe[Re-1].x,Ne-xe[Re-1].y,it-xe[Re-1].x,ct-xe[Re-1].y,Ue-xe[Re-1].x,Se-xe[Re-1].y],le[le.length-1].deltas.push(X);break;case"arc":le.push({deltas:[],abs:[],arc:!0}),Array.isArray(le[le.length-1].abs)&&le[le.length-1].abs.push(Oe)}}Q=I?null:S==="stroke"?"stroke":"fill";for(var gt=!1,ce=0;ce<le.length;ce++)if(le[ce].arc)for(var de=le[ce].abs,ye=0;ye<de.length;ye++){var Me=de[ye];Me.type==="arc"?O.call(this,Me.x,Me.y,Me.radius,Me.startAngle,Me.endAngle,Me.counterclockwise,void 0,I,!gt):$.call(this,Me.x,Me.y),gt=!0}else if(le[ce].close===!0)this.pdf.internal.out("h"),gt=!1;else if(le[ce].begin!==!0){var pe=le[ce].start.x,ue=le[ce].start.y;K.call(this,le[ce].deltas,pe,ue),gt=!0}Q&&V.call(this,Q),I&&J.call(this)}},G=function(S){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,X=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return S-X;case"top":return S+I-X;case"hanging":return S+I-2*X;case"middle":return S+I/2-X;case"ideographic":return S;case"alphabetic":default:return S}},F=function(S){return S+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var S=function(){};return S.colorStops=[],S.addColorStop=function(I,X){this.colorStops.push([I,X])},S.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},S.isCanvasGradient=!0,S},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var O=function(S,I,X,Q,le,xe,Re,Oe,We){for(var Le=W.call(this,X,Q,le,xe),Ne=0;Ne<Le.length;Ne++){var it=Le[Ne];Ne===0&&(We?N.call(this,it.x1+S,it.y1+I):$.call(this,it.x1+S,it.y1+I)),ve.call(this,S,I,it.x2,it.y2,it.x3,it.y3,it.x4,it.y4)}Oe?J.call(this):V.call(this,Re)},V=function(S){switch(S){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},J=function(){this.pdf.clip(),this.pdf.discardPath()},N=function(S,I){this.pdf.internal.out(i(S)+" "+r(I)+" m")},P=function(S){var I;switch(S.align){case"right":case"end":I="right";break;case"center":I="center";break;case"left":case"start":default:I="left"}var X=this.pdf.getTextDimensions(S.text),Q=G.call(this,S.y),le=F.call(this,Q)-X.h,xe=this.ctx.transform.applyToPoint(new s(S.x,Q)),Re=this.ctx.transform.decompose(),Oe=new c;Oe=(Oe=(Oe=Oe.multiply(Re.translate)).multiply(Re.skew)).multiply(Re.scale);for(var We,Le,Ne,it=this.ctx.transform.applyToRectangle(new a(S.x,Q,X.w,X.h)),ct=Oe.applyToRectangle(new a(S.x,le,X.w,X.h)),Ue=y.call(this,ct),Se=[],gt=0;gt<Ue.length;gt+=1)Se.indexOf(Ue[gt])===-1&&Se.push(Ue[gt]);if(T(Se),this.autoPaging)for(var ce=Se[0],de=Se[Se.length-1],ye=ce;ye<de+1;ye++){this.pdf.setPage(ye);var Me=ye===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ue=this.pdf.internal.pageSize.height-this.margin[2],A=ue-this.margin[0],L=this.pdf.internal.pageSize.width-this.margin[1],Y=L-this.margin[3],Z=ye===1?0:pe+(ye-2)*A;if(this.ctx.clip_path.length!==0){var fe=this.path;We=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(We,this.posX+this.margin[3],-1*Z+Me),B.call(this,"fill",!0),this.path=fe}var we=x([JSON.parse(JSON.stringify(ct))],this.posX+this.margin[3],-Z+Me+this.ctx.prevPageLastElemOffset)[0];S.scale>=.01&&(Le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Le*S.scale),Ne=this.lineWidth,this.lineWidth=Ne*S.scale);var ke=this.autoPaging!=="text";if(ke||we.y+we.h<=ue){if(ke||we.y>=Me&&we.x<=L){var Ie=ke?S.text:this.pdf.splitTextToSize(S.text,S.maxWidth||L-we.x)[0],ze=x([JSON.parse(JSON.stringify(it))],this.posX+this.margin[3],-Z+Me+this.ctx.prevPageLastElemOffset)[0],rt=ke&&(ye>ce||ye<de)&&g.call(this);rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Y,A,null).clip().discardPath()),this.pdf.text(Ie,ze.x,ze.y,{angle:S.angle,align:I,renderingMode:S.renderingMode}),rt&&this.pdf.restoreGraphicsState()}}else we.y<ue&&(this.ctx.prevPageLastElemOffset+=ue-we.y);S.scale>=.01&&(this.pdf.setFontSize(Le),this.lineWidth=Ne)}else S.scale>=.01&&(Le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Le*S.scale),Ne=this.lineWidth,this.lineWidth=Ne*S.scale),this.pdf.text(S.text,xe.x+this.posX,xe.y+this.posY,{angle:S.angle,align:I,renderingMode:S.renderingMode,maxWidth:S.maxWidth}),S.scale>=.01&&(this.pdf.setFontSize(Le),this.lineWidth=Ne)},$=function(S,I,X,Q){X=X||0,Q=Q||0,this.pdf.internal.out(i(S+X)+" "+r(I+Q)+" l")},K=function(S,I,X){return this.pdf.lines(S,I,X,null,null)},ve=function(S,I,X,Q,le,xe,Re,Oe){this.pdf.internal.out([e(n(X+S)),e(o(Q+I)),e(n(le+S)),e(o(xe+I)),e(n(Re+S)),e(o(Oe+I)),"c"].join(" "))},W=function(S,I,X,Q){for(var le=2*Math.PI,xe=Math.PI/2;I>X;)I-=le;var Re=Math.abs(X-I);Re<le&&Q&&(Re=le-Re);for(var Oe=[],We=Q?-1:1,Le=I;Re>1e-5;){var Ne=Le+We*Math.min(Re,xe);Oe.push(ee.call(this,S,Le,Ne)),Re-=Math.abs(Ne-Le),Le=Ne}return Oe},ee=function(S,I,X){var Q=(X-I)/2,le=S*Math.cos(Q),xe=S*Math.sin(Q),Re=le,Oe=-xe,We=Re*Re+Oe*Oe,Le=We+Re*le+Oe*xe,Ne=4/3*(Math.sqrt(2*We*Le)-Le)/(Re*xe-Oe*le),it=Re-Ne*Oe,ct=Oe+Ne*Re,Ue=it,Se=-ct,gt=Q+I,ce=Math.cos(gt),de=Math.sin(gt);return{x1:S*Math.cos(I),y1:S*Math.sin(I),x2:it*ce-ct*de,y2:it*de+ct*ce,x3:Ue*ce-Se*de,y3:Ue*de+Se*ce,x4:S*Math.cos(X),y4:S*Math.sin(X)}},te=function(S){return 180*S/Math.PI},se=function(S,I,X,Q,le,xe){var Re=S+.5*(X-S),Oe=I+.5*(Q-I),We=le+.5*(X-le),Le=xe+.5*(Q-xe),Ne=Math.min(S,le,Re,We),it=Math.max(S,le,Re,We),ct=Math.min(I,xe,Oe,Le),Ue=Math.max(I,xe,Oe,Le);return new a(Ne,ct,it-Ne,Ue-ct)},Ae=function(S,I,X,Q,le,xe,Re,Oe){var We,Le,Ne,it,ct,Ue,Se,gt,ce,de,ye,Me,pe,ue,A=X-S,L=Q-I,Y=le-X,Z=xe-Q,fe=Re-le,we=Oe-xe;for(Le=0;Le<41;Le++)ce=(Se=(Ne=S+(We=Le/40)*A)+We*((ct=X+We*Y)-Ne))+We*(ct+We*(le+We*fe-ct)-Se),de=(gt=(it=I+We*L)+We*((Ue=Q+We*Z)-it))+We*(Ue+We*(xe+We*we-Ue)-gt),Le==0?(ye=ce,Me=de,pe=ce,ue=de):(ye=Math.min(ye,ce),Me=Math.min(Me,de),pe=Math.max(pe,ce),ue=Math.max(ue,de));return new a(Math.round(ye),Math.round(Me),Math.round(pe-ye),Math.round(ue-Me))},k=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var S,I,X=(S=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:S,lineDashOffset:I}));this.prevLineDash!==X&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=X)}}})(Ti.API),function(t){var e=function(o){var s,a,c,d,u,h,p,f,m,g;for(/[^\x00-\xFF]/.test(o),a=[],c=0,d=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;d>c;c+=4)(u=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(h=(u=((u=((u=((u=(u-(g=u%85))/85)-(m=u%85))/85)-(f=u%85))/85)-(p=u%85))/85)%85,a.push(h+33,p+33,f+33,m+33,g+33)):a.push(122);return function(y,w){for(var x=w;x>0;x--)y.pop()}(a,s.length),String.fromCharCode.apply(String,a)+"~>"},i=function(o){var s,a,c,d,u,h=String,p="length",f=255,m="charCodeAt",g="slice",y="replace";for(o[g](-2),o=o[g](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),c=[],d=0,u=(o+=s="uuuuu"[g](o[p]%5||5))[p];u>d;d+=5)a=52200625*(o[m](d)-33)+614125*(o[m](d+1)-33)+7225*(o[m](d+2)-33)+85*(o[m](d+3)-33)+(o[m](d+4)-33),c.push(f&a>>24,f&a>>16,f&a>>8,f&a);return function(w,x){for(var T=x;T>0;T--)w.pop()}(c,s[p]),h.fromCharCode.apply(h,c)},r=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var a="",c=0;c<o.length;c+=2)a+=String.fromCharCode("0x"+(o[c]+o[c+1]));return a},n=function(o){for(var s=new Uint8Array(o.length),a=o.length;a--;)s[a]=o.charCodeAt(a);return o=(s=Rz(s)).reduce(function(c,d){return c+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,s){var a=0,c=o||"",d=[];for(typeof(s=s||[])=="string"&&(s=[s]),a=0;a<s.length;a+=1)switch(s[a]){case"ASCII85Decode":case"/ASCII85Decode":c=i(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=r(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=n(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[a]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}}(Ti.API),function(t){t.loadFile=function(e,i,r){return function(n,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var a=void 0;try{a=function(c,d,u){var h=new XMLHttpRequest,p=0,f=function(m){var g=m.length,y=[],w=String.fromCharCode;for(p=0;p<g;p+=1)y.push(w(255&m.charCodeAt(p)));return y.join("")};if(h.open("GET",c,!d),h.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(h.onload=function(){h.status===200?u(f(this.responseText)):u(void 0)}),h.send(null),d&&h.status===200)return f(h.responseText)}(n,o,s)}catch{}return a}(e,i,r)},t.loadImageFile=t.loadFile}(Ti.API),function(t){function e(){return(Di.html2canvas?Promise.resolve(Di.html2canvas):import("./chunk-QUKFYY2S.mjs")).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function i(){return(Di.DOMPurify?Promise.resolve(Di.DOMPurify):import("./chunk-IXGY754F.mjs")).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var r=function(s){var a=(0,Dn.default)(s);return a==="undefined"?"undefined":a==="string"||s instanceof String?"string":a==="number"||s instanceof Number?"number":a==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":a==="object"?"object":"unknown"},n=function(s,a){var c=document.createElement(s);for(var d in a.className&&(c.className=a.className),a.innerHTML&&a.dompurify&&(c.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)c.style[d]=a.style[d];return c},o=function s(a){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),d=s.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,s,1,[s])).set(a)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,a){return s.__proto__=a||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,a){return this.then(function(){switch(a=a||function(c){switch(r(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(i).then(function(c){return this.set({src:n("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=function c(d,u){for(var h=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),p=d.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||h.appendChild(c(p,u));return d.nodeType===1&&(d.nodeName==="CANVAS"?(h.width=d.width,h.height=d.height,h.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(h.value=d.value),h.addEventListener("load",function(){h.scrollTop=d.scrollTop,h.scrollLeft=d.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(a){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,a(this.prop.container,c)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(a){var c=this.opt.jsPDF,d=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var p=0;p<d.length;++p){var f=d[p],m=f.src.find(function(g){return g.format==="truetype"});m&&c.addFont(m.url,f.ref.name,f.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,c.context2d.save(!0),a(this.prop.container,h)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,a,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,a):this.outputPdf(s,a)},o.prototype.outputPdf=function(s,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,a)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(r(s)!=="object")return this;var a=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(a)})},o.prototype.get=function(s,a){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return a?a(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(r(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function a(c,d){return Math.floor(c*d/72*96)}return this.then(function(){(s=s||Ti.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:a(s.inner.width,s.k),height:a(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,a,c,d){return s!=null&&(this.progress.val=s),a!=null&&(this.progress.state=a),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,a,c,d){return this.setProgress(s?this.progress.val+s:null,a||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(s,a){var c=this;return this.thenCore(s,a,function(d,u){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(h){return c.updateProgress(null,d),h}).then(d,u).then(function(h){return c.updateProgress(1),h})})},o.prototype.thenCore=function(s,a,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),a&&(a=a.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),u=c.call(d,s,a);return o.convert(u,this.__proto__)},o.prototype.thenExternal=function(s,a){return Promise.prototype.then.call(this,s,a)},o.prototype.thenList=function(s){var a=this;return s.forEach(function(c){a=a.thenCore(c)}),a},o.prototype.catch=function(s){s&&(s=s.bind(this));var a=Promise.prototype.catch.call(this,s);return o.convert(a,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Ti.getPageSize=function(s,a,c){if((0,Dn.default)(s)==="object"){var d=s;s=d.orientation,a=d.unit||a,c=d.format||c}a=a||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var u,h=(""+c).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+a}var f,m=0,g=0;if(p.hasOwnProperty(h))m=p[h][1]/u,g=p[h][0]/u;else try{m=c[1],g=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",g>m&&(f=g,g=m,m=f);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",m>g&&(f=g,g=m,m=f)}return{width:g,height:m,unit:a,k:u,orientation:s}},t.html=function(s,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(Nce):null;var c=new o(a);return a.worker?c:c.from(s).doCallback()}}(Ti.API),Ti.API.addJS=function(t){return s9e=t,this.internal.events.subscribe("postPutResources",function(){Dz=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Dz+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),o9e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+s9e+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Dz!==void 0&&o9e!==void 0&&this.internal.out("/Names <</JavaScript "+Dz+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var i=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=i.outline.render().split(/\r\n/),o=0;o<n.length;o++){var s=n[o],a=r.exec(s);if(a!=null){var c=a[1];i.internal.newObjectDeferredBegin(c,!1)}i.internal.write(s)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(o=0;o<d;o++){var h=i.internal.newObject();u.push(h);var p=i.internal.getPageInfo(o+1);i.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var f=i.internal.newObject();for(i.internal.write("<< /Names [ "),o=0;o<u.length;o++)i.internal.write("(page_"+(o+1)+")"+u[o]+" 0 R");i.internal.write(" ] >>","endobj"),e=i.internal.newObject(),i.internal.write("<< /Dests "+f+" 0 R"),i.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var i=this;i.outline={createNamedDestinations:!1,root:{children:[]}},i.outline.add=function(r,n,o){var s={title:n,options:o,children:[]};return r==null&&(r=this.root),r.children.push(s),s},i.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=i,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},i.outline.genIds_r=function(r){r.id=i.internal.newObjectDeferred();for(var n=0;n<r.children.length;n++)this.genIds_r(r.children[n])},i.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},i.outline.renderItems=function(r){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<r.children.length;o++){var s=r.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(r)),o>0&&this.line("/Prev "+this.makeRef(r.children[o-1])),o<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var a=this.count=this.count_r({count:0},s);if(a>0&&this.line("/Count "+a),s.options&&s.options.pageNumber){var c=i.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},i.outline.line=function(r){this.ctx.val+=r+`\r
`},i.outline.makeRef=function(r){return r.id+" 0 R"},i.outline.makeString=function(r){return"("+i.internal.pdfEscape(r)+")"},i.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},i.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},i.outline.count_r=function(r,n){for(var o=0;o<n.children.length;o++)r.count++,this.count_r(r,n.children[o]);return r.count}}])}(Ti.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(i,r,n,o,s,a){var c,d=this.decode.DCT_DECODE,u=null;if(typeof i=="string"||this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i)){switch(i=s||i,i=this.__addimage__.isArrayBuffer(i)?new Uint8Array(i):i,(c=function(h){for(var p,f=256*h.charCodeAt(4)+h.charCodeAt(5),m=h.length,g={width:0,height:0,numcomponents:1},y=4;y<m;y+=2){if(y+=f,e.indexOf(h.charCodeAt(y+1))!==-1){p=256*h.charCodeAt(y+5)+h.charCodeAt(y+6),g={width:256*h.charCodeAt(y+7)+h.charCodeAt(y+8),height:p,numcomponents:h.charCodeAt(y+9)};break}f=256*h.charCodeAt(y+2)+h.charCodeAt(y+3)}return g}(i=this.__addimage__.isArrayBufferView(i)?this.__addimage__.arrayBufferToBinaryString(i):i)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}u={data:i,width:c.width,height:c.height,colorSpace:a,bitsPerComponent:8,filter:d,index:r,alias:n}}return u}}(Ti.API);var hR,Mz,a9e,l9e,c9e,YGt=function(){var t,e,i;function r(o){var s,a,c,d,u,h,p,f,m,g,y,w,x,T;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(s=this.readUInt32(),m=(function(){var M,B;for(B=[],M=0;M<4;++M)B.push(String.fromCharCode(this.data[this.pos++]));return B}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),d=this.readUInt16()||100,h.delay=1e3*u/d,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(m==="fdAT"&&(this.pos+=4,s-=4),o=h?.data||this.imgData,w=0;0<=s?w<s:w>s;0<=s?++w:--w)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((g=c-this.transparency.indexed.length)>0)for(x=0;0<=g?x<g:x>g;0<=g?++x:--x)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":p=(y=this.read(s)).indexOf(0),f=String.fromCharCode.apply(String,y.slice(0,p)),this.text[f]=String.fromCharCode.apply(String,y.slice(p+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(T=this.colorType)===4||T===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(o){var s,a;for(a=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)a.push(this.data[this.pos++]);return a},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*s),c=0,d=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function u(h,p,f,m){var g,y,w,x,T,M,B,G,F,O,V,J,N,P,$,K,ve,W,ee,te,se,Ae=Math.ceil((d.width-h)/f),k=Math.ceil((d.height-p)/m),S=d.width==Ae&&d.height==k;for(P=s*Ae,J=S?a:new Uint8Array(P*k),M=o.length,N=0,y=0;N<k&&c<M;){switch(o[c++]){case 0:for(x=ve=0;ve<P;x=ve+=1)J[y++]=o[c++];break;case 1:for(x=W=0;W<P;x=W+=1)g=o[c++],T=x<s?0:J[y-s],J[y++]=(g+T)%256;break;case 2:for(x=ee=0;ee<P;x=ee+=1)g=o[c++],w=(x-x%s)/s,$=N&&J[(N-1)*P+w*s+x%s],J[y++]=($+g)%256;break;case 3:for(x=te=0;te<P;x=te+=1)g=o[c++],w=(x-x%s)/s,T=x<s?0:J[y-s],$=N&&J[(N-1)*P+w*s+x%s],J[y++]=(g+Math.floor((T+$)/2))%256;break;case 4:for(x=se=0;se<P;x=se+=1)g=o[c++],w=(x-x%s)/s,T=x<s?0:J[y-s],N===0?$=K=0:($=J[(N-1)*P+w*s+x%s],K=w&&J[(N-1)*P+(w-1)*s+x%s]),B=T+$-K,G=Math.abs(B-T),O=Math.abs(B-$),V=Math.abs(B-K),F=G<=O&&G<=V?T:O<=V?$:K,J[y++]=(g+F)%256;break;default:throw new Error("Invalid filter algorithm: "+o[c-1])}if(!S){var I=((p+N*m)*d.width+h)*s,X=N*P;for(x=0;x<Ae;x+=1){for(var Q=0;Q<s;Q+=1)a[I++]=J[X++];I+=(f-1)*s}}N++}}return o=X7e(o),d.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),a},r.prototype.decodePalette=function(){var o,s,a,c,d,u,h,p,f;for(a=this.palette,u=this.transparency.indexed||[],d=new Uint8Array((u.length||0)+a.length),c=0,o=0,s=h=0,p=a.length;h<p;s=h+=3)d[c++]=a[s],d[c++]=a[s+1],d[c++]=a[s+2],d[c++]=(f=u[o++])!=null?f:255;return d},r.prototype.copyToImageData=function(o,s){var a,c,d,u,h,p,f,m,g,y,w;if(c=this.colors,g=null,a=this.hasAlphaChannel,this.palette.length&&(g=(w=this._decodedPalette)!=null?w:this._decodedPalette=this.decodePalette(),c=4,a=!0),m=(d=o.data||o).length,h=g||s,u=p=0,c===1)for(;u<m;)f=g?4*s[u/4]:p,y=h[f++],d[u++]=y,d[u++]=y,d[u++]=y,d[u++]=a?h[f++]:255,p=f;else for(;u<m;)f=g?4*s[u/4]:p,d[u++]=h[f++],d[u++]=h[f++],d[u++]=h[f++],d[u++]=a?h[f++]:255,p=f},r.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var n=function(){if(Object.prototype.toString.call(Di)==="[object Window]"){try{e=Di.document.createElement("canvas"),i=e.getContext("2d")}catch{return!1}return!0}return!1};return n(),t=function(o){var s;if(n()===!0)return i.width=o.width,i.height=o.height,i.clearRect(0,0,o.width,o.height),i.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(o){var s,a,c,d,u,h,p,f;if(this.animation){for(f=[],a=u=0,h=(p=this.animation.frames).length;u<h;a=++u)s=p[a],c=o.createImageData(s.width,s.height),d=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,d),s.imageData=c,f.push(s.image=t(c));return f}},r.prototype.renderFrame=function(o,s){var a,c,d;return a=(c=this.animation.frames)[s],d=c[s-1],s===0&&o.clearRect(0,0,this.width,this.height),d?.disposeOp===1?o.clearRect(d.xOffset,d.yOffset,d.width,d.height):d?.disposeOp===2&&o.putImageData(d.imageData,d.xOffset,d.yOffset),a.blendOp===0&&o.clearRect(a.xOffset,a.yOffset,a.width,a.height),o.drawImage(a.image,a.xOffset,a.yOffset)},r.prototype.animate=function(o){var s,a,c,d,u,h,p=this;return a=0,h=this.animation,d=h.numFrames,c=h.frames,u=h.numPlays,(s=function(){var f,m;if(f=a++%d,m=c[f],p.renderFrame(o,f),d>1&&a/d<u)return p.animation._timeout=setTimeout(s,m.delay)})()},r.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},r.prototype.render=function(o){var s,a;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(a=s.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),s.putImageData(a,0,0))},r}();function $Gt(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var i=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,n=t[e++],o=n>>7,s=1<<(7&n)+1;t[e++],t[e++];var a=null,c=null;o&&(a=e,c=s,e+=3*s);var d=!0,u=[],h=0,p=null,f=0,m=null;for(this.width=i,this.height=r;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var g=t[e++];h=t[e++]|t[e++]<<8,p=t[e++],!(1&g)&&(p=null),f=g>>2&7,e++;break;case 254:for(;;){if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var y=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,T=t[e++]|t[e++]<<8,M=t[e++],B=M>>6&1,G=1<<(7&M)+1,F=a,O=c,V=!1;M>>7&&(V=!0,F=e,O=G,e+=3*G);var J=e;for(e++;;){var N;if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}u.push({x:y,y:w,width:x,height:T,has_local_palette:V,palette_offset:F,palette_size:O,data_offset:J,data_length:e-J,transparent_index:p,interlaced:!!B,delay:h,disposal:f});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=u.length)throw new Error("Frame index out of range.");return u[P]},this.decodeAndBlitFrameBGRA=function(P,$){var K=this.frameInfo(P),ve=K.width*K.height,W=new Uint8Array(ve);d9e(t,K.data_offset,W,ve);var ee=K.palette_offset,te=K.transparent_index;te===null&&(te=256);var se=K.width,Ae=i-se,k=se,S=4*(K.y*i+K.x),I=4*((K.y+K.height)*i+K.x),X=S,Q=4*Ae;K.interlaced===!0&&(Q+=4*i*7);for(var le=8,xe=0,Re=W.length;xe<Re;++xe){var Oe=W[xe];if(k===0&&(k=se,(X+=Q)>=I&&(Q=4*Ae+4*i*(le-1),X=S+(se+Ae)*(le<<1),le>>=1)),Oe===te)X+=4;else{var We=t[ee+3*Oe],Le=t[ee+3*Oe+1],Ne=t[ee+3*Oe+2];$[X++]=Ne,$[X++]=Le,$[X++]=We,$[X++]=255}--k}},this.decodeAndBlitFrameRGBA=function(P,$){var K=this.frameInfo(P),ve=K.width*K.height,W=new Uint8Array(ve);d9e(t,K.data_offset,W,ve);var ee=K.palette_offset,te=K.transparent_index;te===null&&(te=256);var se=K.width,Ae=i-se,k=se,S=4*(K.y*i+K.x),I=4*((K.y+K.height)*i+K.x),X=S,Q=4*Ae;K.interlaced===!0&&(Q+=4*i*7);for(var le=8,xe=0,Re=W.length;xe<Re;++xe){var Oe=W[xe];if(k===0&&(k=se,(X+=Q)>=I&&(Q=4*Ae+4*i*(le-1),X=S+(se+Ae)*(le<<1),le>>=1)),Oe===te)X+=4;else{var We=t[ee+3*Oe],Le=t[ee+3*Oe+1],Ne=t[ee+3*Oe+2];$[X++]=We,$[X++]=Le,$[X++]=Ne,$[X++]=255}--k}}}function d9e(t,e,i,r){for(var n=t[e++],o=1<<n,s=o+1,a=s+1,c=n+1,d=(1<<c)-1,u=0,h=0,p=0,f=t[e++],m=new Int32Array(4096),g=null;;){for(;u<16&&f!==0;)h|=t[e++]<<u,u+=8,f===1?f=t[e++]:--f;if(u<c)break;var y=h&d;if(h>>=c,u-=c,y!==o){if(y===s)break;for(var w=y<a?y:g,x=0,T=w;T>o;)T=m[T]>>8,++x;var M=T;if(p+x+(w!==y?1:0)>r)return void Hn.log("Warning, gif stream longer than expected.");i[p++]=M;var B=p+=x;for(w!==y&&(i[p++]=M),T=w;x--;)T=m[T],i[--B]=255&T,T>>=8;g!==null&&a<4096&&(m[a++]=g<<8|M,a>=d+1&&c<12&&(++c,d=d<<1|1)),g=y}else a=s+1,d=(1<<(c=n+1))-1,g=null}return p!==r&&Hn.log("Warning, gif stream shorter than expected."),i}function Ace(t){var e,i,r,n,o,s=Math.floor,a=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),h=new Array(65535),p=new Array(65535),f=new Array(64),m=new Array(64),g=[],y=0,w=7,x=new Array(64),T=new Array(64),M=new Array(64),B=new Array(256),G=new Array(2048),F=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],O=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],N=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],$=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ve=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function W(S,I){for(var X=0,Q=0,le=new Array,xe=1;xe<=16;xe++){for(var Re=1;Re<=S[xe];Re++)le[I[Q]]=[],le[I[Q]][0]=X,le[I[Q]][1]=xe,Q++,X++;X*=2}return le}function ee(S){for(var I=S[0],X=S[1]-1;X>=0;)I&1<<X&&(y|=1<<w),X--,--w<0&&(y==255?(te(255),te(0)):te(y),w=7,y=0)}function te(S){g.push(S)}function se(S){te(S>>8&255),te(255&S)}function Ae(S,I,X,Q,le){for(var xe,Re=le[0],Oe=le[240],We=function(de,ye){var Me,pe,ue,A,L,Y,Z,fe,we,ke,Ie=0;for(we=0;we<8;++we){Me=de[Ie],pe=de[Ie+1],ue=de[Ie+2],A=de[Ie+3],L=de[Ie+4],Y=de[Ie+5],Z=de[Ie+6];var ze=Me+(fe=de[Ie+7]),rt=Me-fe,yt=pe+Z,st=pe-Z,vt=ue+Y,di=ue-Y,fi=A+L,fo=A-L,mr=ze+fi,Bn=ze-fi,vs=yt+vt,ft=yt-vt;de[Ie]=mr+vs,de[Ie+4]=mr-vs;var ii=.707106781*(ft+Bn);de[Ie+2]=Bn+ii,de[Ie+6]=Bn-ii;var pi=.382683433*((mr=fo+di)-(ft=st+rt)),va=.5411961*mr+pi,nn=1.306562965*ft+pi,Oi=.707106781*(vs=di+st),ec=rt+Oi,Rt=rt-Oi;de[Ie+5]=Rt+va,de[Ie+3]=Rt-va,de[Ie+1]=ec+nn,de[Ie+7]=ec-nn,Ie+=8}for(Ie=0,we=0;we<8;++we){Me=de[Ie],pe=de[Ie+8],ue=de[Ie+16],A=de[Ie+24],L=de[Ie+32],Y=de[Ie+40],Z=de[Ie+48];var ba=Me+(fe=de[Ie+56]),Dd=Me-fe,ks=pe+Z,Cr=pe-Z,on=ue+Y,po=ue-Y,Vn=A+L,Qo=A-L,Jo=ba+Vn,Os=ba-Vn,Uc=ks+on,Md=ks-on;de[Ie]=Jo+Uc,de[Ie+32]=Jo-Uc;var Gs=.707106781*(Md+Os);de[Ie+16]=Os+Gs,de[Ie+48]=Os-Gs;var qc=.382683433*((Jo=Qo+po)-(Md=Cr+Dd)),Np=.5411961*Jo+qc,Yc=1.306562965*Md+qc,kd=.707106781*(Uc=po+Cr),Pp=Dd+kd,Ig=Dd-kd;de[Ie+40]=Ig+Np,de[Ie+24]=Ig-Np,de[Ie+8]=Pp+Yc,de[Ie+56]=Pp-Yc,Ie++}for(we=0;we<64;++we)ke=de[we]*ye[we],f[we]=ke>0?ke+.5|0:ke-.5|0;return f}(S,I),Le=0;Le<64;++Le)m[F[Le]]=We[Le];var Ne=m[0]-X;X=m[0],Ne==0?ee(Q[0]):(ee(Q[p[xe=32767+Ne]]),ee(h[xe]));for(var it=63;it>0&&m[it]==0;)it--;if(it==0)return ee(Re),X;for(var ct,Ue=1;Ue<=it;){for(var Se=Ue;m[Ue]==0&&Ue<=it;)++Ue;var gt=Ue-Se;if(gt>=16){ct=gt>>4;for(var ce=1;ce<=ct;++ce)ee(Oe);gt&=15}xe=32767+m[Ue],ee(le[(gt<<4)+p[xe]]),ee(h[xe]),Ue++}return it!=63&&ee(Re),X}function k(S){S=Math.min(Math.max(S,1),100),o!=S&&(function(I){for(var X=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Q=0;Q<64;Q++){var le=s((X[Q]*I+50)/100);le=Math.min(Math.max(le,1),255),a[F[Q]]=le}for(var xe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Re=0;Re<64;Re++){var Oe=s((xe[Re]*I+50)/100);Oe=Math.min(Math.max(Oe,1),255),c[F[Re]]=Oe}for(var We=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,Ne=0;Ne<8;Ne++)for(var it=0;it<8;it++)d[Le]=1/(a[F[Le]]*We[Ne]*We[it]*8),u[Le]=1/(c[F[Le]]*We[Ne]*We[it]*8),Le++}(S<50?Math.floor(5e3/S):Math.floor(200-2*S)),o=S)}this.encode=function(S,I){I&&k(I),g=new Array,y=0,w=7,se(65496),se(65504),se(16),te(74),te(70),te(73),te(70),te(0),te(1),te(1),te(0),se(1),se(1),te(0),te(0),function(){se(65499),se(132),te(0);for(var pe=0;pe<64;pe++)te(a[pe]);te(1);for(var ue=0;ue<64;ue++)te(c[ue])}(),function(pe,ue){se(65472),se(17),te(8),se(ue),se(pe),te(3),te(1),te(17),te(0),te(2),te(17),te(1),te(3),te(17),te(1)}(S.width,S.height),function(){se(65476),se(418),te(0);for(var pe=0;pe<16;pe++)te(O[pe+1]);for(var ue=0;ue<=11;ue++)te(V[ue]);te(16);for(var A=0;A<16;A++)te(J[A+1]);for(var L=0;L<=161;L++)te(N[L]);te(1);for(var Y=0;Y<16;Y++)te(P[Y+1]);for(var Z=0;Z<=11;Z++)te($[Z]);te(17);for(var fe=0;fe<16;fe++)te(K[fe+1]);for(var we=0;we<=161;we++)te(ve[we])}(),se(65498),se(12),te(3),te(1),te(0),te(2),te(17),te(3),te(17),te(0),te(63),te(0);var X=0,Q=0,le=0;y=0,w=7,this.encode.displayName="_encode_";for(var xe,Re,Oe,We,Le,Ne,it,ct,Ue,Se=S.data,gt=S.width,ce=S.height,de=4*gt,ye=0;ye<ce;){for(xe=0;xe<de;){for(Le=de*ye+xe,it=-1,ct=0,Ue=0;Ue<64;Ue++)Ne=Le+(ct=Ue>>3)*de+(it=4*(7&Ue)),ye+ct>=ce&&(Ne-=de*(ye+1+ct-ce)),xe+it>=de&&(Ne-=xe+it-de+4),Re=Se[Ne++],Oe=Se[Ne++],We=Se[Ne++],x[Ue]=(G[Re]+G[Oe+256>>0]+G[We+512>>0]>>16)-128,T[Ue]=(G[Re+768>>0]+G[Oe+1024>>0]+G[We+1280>>0]>>16)-128,M[Ue]=(G[Re+1280>>0]+G[Oe+1536>>0]+G[We+1792>>0]>>16)-128;X=Ae(x,d,X,e,r),Q=Ae(T,u,Q,i,n),le=Ae(M,u,le,i,n),xe+=32}ye+=8}if(w>=0){var Me=[];Me[1]=w+1,Me[0]=(1<<w+1)-1,ee(Me)}return se(65497),new Uint8Array(g)},t=t||50,function(){for(var S=String.fromCharCode,I=0;I<256;I++)B[I]=S(I)}(),e=W(O,V),i=W(P,$),r=W(J,N),n=W(K,ve),function(){for(var S=1,I=2,X=1;X<=15;X++){for(var Q=S;Q<I;Q++)p[32767+Q]=X,h[32767+Q]=[],h[32767+Q][1]=X,h[32767+Q][0]=Q;for(var le=-(I-1);le<=-S;le++)p[32767+le]=X,h[32767+le]=[],h[32767+le][1]=X,h[32767+le][0]=I-1+le;S<<=1,I<<=1}}(),function(){for(var S=0;S<256;S++)G[S]=19595*S,G[S+256>>0]=38470*S,G[S+512>>0]=7471*S+32768,G[S+768>>0]=-11059*S,G[S+1024>>0]=-21709*S,G[S+1280>>0]=32768*S+8421375,G[S+1536>>0]=-27439*S,G[S+1792>>0]=-5329*S}(),k(t)}function Fh(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function u9e(t){function e(O){if(!O)throw Error("assert :P")}function i(O,V,J){for(var N=0;4>N;N++)if(O[V+N]!=J.charCodeAt(N))return!0;return!1}function r(O,V,J,N,P){for(var $=0;$<P;$++)O[V+$]=J[N+$]}function n(O,V,J,N){for(var P=0;P<N;P++)O[V+P]=J}function o(O){return new Int32Array(O)}function s(O,V){for(var J=[],N=0;N<O;N++)J.push(new V);return J}function a(O,V){var J=[];return function N(P,$,K){for(var ve=K[$],W=0;W<ve&&(P.push(K.length>$+1?[]:new V),!(K.length<$+1));W++)N(P[W],$+1,K)}(J,0,O),J}var c=function(){var O=this;function V(v,C){for(var D=1<<C-1>>>0;v&D;)D>>>=1;return D?(v&D-1)+D:v}function J(v,C,D,j,ie){e(!(j%D));do v[C+(j-=D)]=ie;while(0<j)}function N(v,C,D,j,ie){if(e(2328>=ie),512>=ie)var oe=o(512);else if((oe=o(ie))==null)return 0;return function(he,ge,be,Ee,He,Ge){var Xe,je,nt=ge,Je=1<<be,Be=o(16),Ve=o(16);for(e(He!=0),e(Ee!=null),e(he!=null),e(0<be),je=0;je<He;++je){if(15<Ee[je])return 0;++Be[Ee[je]]}if(Be[0]==He)return 0;for(Ve[1]=0,Xe=1;15>Xe;++Xe){if(Be[Xe]>1<<Xe)return 0;Ve[Xe+1]=Ve[Xe]+Be[Xe]}for(je=0;je<He;++je)Xe=Ee[je],0<Ee[je]&&(Ge[Ve[Xe]++]=je);if(Ve[15]==1)return(Ee=new P).g=0,Ee.value=Ge[0],J(he,nt,1,Je,Ee),Je;var ot,ut=-1,at=Je-1,Wt=0,Et=1,vi=1,xt=1<<be;for(je=0,Xe=1,He=2;Xe<=be;++Xe,He<<=1){if(Et+=vi<<=1,0>(vi-=Be[Xe]))return 0;for(;0<Be[Xe];--Be[Xe])(Ee=new P).g=Xe,Ee.value=Ge[je++],J(he,nt+Wt,He,xt,Ee),Wt=V(Wt,Xe)}for(Xe=be+1,He=2;15>=Xe;++Xe,He<<=1){if(Et+=vi<<=1,0>(vi-=Be[Xe]))return 0;for(;0<Be[Xe];--Be[Xe]){if(Ee=new P,(Wt&at)!=ut){for(nt+=xt,ot=1<<(ut=Xe)-be;15>ut&&!(0>=(ot-=Be[ut]));)++ut,ot<<=1;Je+=xt=1<<(ot=ut-be),he[ge+(ut=Wt&at)].g=ot+be,he[ge+ut].value=nt-ge-ut}Ee.g=Xe-be,Ee.value=Ge[je++],J(he,nt+(Wt>>be),He,xt,Ee),Wt=V(Wt,Xe)}}return Et!=2*Ve[15]-1?0:Je}(v,C,D,j,ie,oe)}function P(){this.value=this.g=0}function $(){this.value=this.g=0}function K(){this.G=s(5,P),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ns,$)}function ve(v,C,D,j){e(v!=null),e(C!=null),e(2147483648>j),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=C,v.pa=D,v.Jd=C,v.Yc=D+j,v.Zc=4<=j?D+j-4+1:D,xe(v)}function W(v,C){for(var D=0;0<C--;)D|=Oe(v,128)<<C;return D}function ee(v,C){var D=W(v,C);return Re(v)?-D:D}function te(v,C,D,j){var ie,oe=0;for(e(v!=null),e(C!=null),e(4294967288>j),v.Sb=j,v.Ra=0,v.u=0,v.h=0,4<j&&(j=4),ie=0;ie<j;++ie)oe+=C[D+ie]<<8*ie;v.Ra=oe,v.bb=j,v.oa=C,v.pa=D}function se(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Pu-8>>>0,++v.bb,v.u-=8;X(v)&&(v.h=1,v.u=0)}function Ae(v,C){if(e(0<=C),!v.h&&C<=Wg){var D=I(v)&zg[C];return v.u+=C,se(v),D}return v.h=1,v.u=0}function k(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function S(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(v){return v.Ra>>>(v.u&Pu-1)>>>0}function X(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Pu}function Q(v,C){v.u=C,v.h=X(v)}function le(v){v.u>=Gh&&(e(v.u>=Gh),se(v))}function xe(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function Re(v){return W(v,1)}function Oe(v,C){var D=v.Ca;0>v.b&&xe(v);var j=v.b,ie=D*C>>>8,oe=(v.I>>>j>ie)+0;for(oe?(D-=ie,v.I-=ie+1<<j>>>0):D=ie+1,j=D,ie=0;256<=j;)ie+=8,j>>=8;return j=7^ie+Zs[j],v.b-=j,v.Ca=(D<<j)-1,oe}function We(v,C,D){v[C+0]=D>>24&255,v[C+1]=D>>16&255,v[C+2]=D>>8&255,v[C+3]=D>>0&255}function Le(v,C){return v[C+0]<<0|v[C+1]<<8}function Ne(v,C){return Le(v,C)|v[C+2]<<16}function it(v,C){return Le(v,C)|Le(v,C+2)<<16}function ct(v,C){var D=1<<C;return e(v!=null),e(0<C),v.X=o(D),v.X==null?0:(v.Mb=32-C,v.Xa=C,1)}function Ue(v,C){e(v!=null),e(C!=null),e(v.Xa==C.Xa),r(C.X,0,v.X,0,1<<C.Xa)}function Se(){this.X=[],this.Xa=this.Mb=0}function gt(v,C,D,j){e(D!=null),e(j!=null);var ie=D[0],oe=j[0];return ie==0&&(ie=(v*oe+C/2)/C),oe==0&&(oe=(C*ie+v/2)/v),0>=ie||0>=oe?0:(D[0]=ie,j[0]=oe,1)}function ce(v,C){return v+(1<<C)-1>>>C}function de(v,C){return((4278255360&v)+(4278255360&C)>>>0&4278255360)+((16711935&v)+(16711935&C)>>>0&16711935)>>>0}function ye(v,C){O[C]=function(D,j,ie,oe,he,ge,be){var Ee;for(Ee=0;Ee<he;++Ee){var He=O[v](ge[be+Ee-1],ie,oe+Ee);ge[be+Ee]=de(D[j+Ee],He)}}}function Me(){this.ud=this.hd=this.jd=0}function pe(v,C){return((4278124286&(v^C))>>>1)+(v&C)>>>0}function ue(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function A(v,C){return ue(v+(v-C+.5>>1))}function L(v,C,D){return Math.abs(C-D)-Math.abs(v-D)}function Y(v,C,D,j,ie,oe,he){for(j=oe[he-1],D=0;D<ie;++D)oe[he+D]=j=de(v[C+D],j)}function Z(v,C,D,j,ie){var oe;for(oe=0;oe<D;++oe){var he=v[C+oe],ge=he>>8&255,be=16711935&(be=(be=16711935&he)+((ge<<16)+ge));j[ie+oe]=(4278255360&he)+be>>>0}}function fe(v,C){C.jd=v>>0&255,C.hd=v>>8&255,C.ud=v>>16&255}function we(v,C,D,j,ie,oe){var he;for(he=0;he<j;++he){var ge=C[D+he],be=ge>>>8,Ee=ge,He=255&(He=(He=ge>>>16)+((v.jd<<24>>24)*(be<<24>>24)>>>5));Ee=255&(Ee=(Ee=Ee+((v.hd<<24>>24)*(be<<24>>24)>>>5))+((v.ud<<24>>24)*(He<<24>>24)>>>5)),ie[oe+he]=(4278255360&ge)+(He<<16)+Ee}}function ke(v,C,D,j,ie){O[C]=function(oe,he,ge,be,Ee,He,Ge,Xe,je){for(be=Ge;be<Xe;++be)for(Ge=0;Ge<je;++Ge)Ee[He++]=ie(ge[j(oe[he++])])},O[v]=function(oe,he,ge,be,Ee,He,Ge){var Xe=8>>oe.b,je=oe.Ea,nt=oe.K[0],Je=oe.w;if(8>Xe)for(oe=(1<<oe.b)-1,Je=(1<<Xe)-1;he<ge;++he){var Be,Ve=0;for(Be=0;Be<je;++Be)Be&oe||(Ve=j(be[Ee++])),He[Ge++]=ie(nt[Ve&Je]),Ve>>=Xe}else O["VP8LMapColor"+D](be,Ee,nt,Je,He,Ge,he,ge,je)}}function Ie(v,C,D,j,ie){for(D=C+D;C<D;){var oe=v[C++];j[ie++]=oe>>16&255,j[ie++]=oe>>8&255,j[ie++]=oe>>0&255}}function ze(v,C,D,j,ie){for(D=C+D;C<D;){var oe=v[C++];j[ie++]=oe>>16&255,j[ie++]=oe>>8&255,j[ie++]=oe>>0&255,j[ie++]=oe>>24&255}}function rt(v,C,D,j,ie){for(D=C+D;C<D;){var oe=(he=v[C++])>>16&240|he>>12&15,he=he>>0&240|he>>28&15;j[ie++]=oe,j[ie++]=he}}function yt(v,C,D,j,ie){for(D=C+D;C<D;){var oe=(he=v[C++])>>16&248|he>>13&7,he=he>>5&224|he>>3&31;j[ie++]=oe,j[ie++]=he}}function st(v,C,D,j,ie){for(D=C+D;C<D;){var oe=v[C++];j[ie++]=oe>>0&255,j[ie++]=oe>>8&255,j[ie++]=oe>>16&255}}function vt(v,C,D,j,ie,oe){if(oe==0)for(D=C+D;C<D;)We(j,((oe=v[C++])[0]>>24|oe[1]>>8&65280|oe[2]<<8&16711680|oe[3]<<24)>>>0),ie+=32;else r(j,ie,v,C,D)}function di(v,C){O[C][0]=O[v+"0"],O[C][1]=O[v+"1"],O[C][2]=O[v+"2"],O[C][3]=O[v+"3"],O[C][4]=O[v+"4"],O[C][5]=O[v+"5"],O[C][6]=O[v+"6"],O[C][7]=O[v+"7"],O[C][8]=O[v+"8"],O[C][9]=O[v+"9"],O[C][10]=O[v+"10"],O[C][11]=O[v+"11"],O[C][12]=O[v+"12"],O[C][13]=O[v+"13"],O[C][14]=O[v+"0"],O[C][15]=O[v+"0"]}function fi(v){return v==BC||v==VC||v==qp||v==rf}function fo(){this.eb=[],this.size=this.A=this.fb=0}function mr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Bn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new fo,this.f.kb=new mr,this.sd=null}function vs(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ft(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ii(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function pi(v,C){var D=v.T,j=C.ba.f.RGBA,ie=j.eb,oe=j.fb+v.ka*j.A,he=lc[C.ba.S],ge=v.y,be=v.O,Ee=v.f,He=v.N,Ge=v.ea,Xe=v.W,je=C.cc,nt=C.dc,Je=C.Mc,Be=C.Nc,Ve=v.ka,ot=v.ka+v.T,ut=v.U,at=ut+1>>1;for(Ve==0?he(ge,be,null,null,Ee,He,Ge,Xe,Ee,He,Ge,Xe,ie,oe,null,null,ut):(he(C.ec,C.fc,ge,be,je,nt,Je,Be,Ee,He,Ge,Xe,ie,oe-j.A,ie,oe,ut),++D);Ve+2<ot;Ve+=2)je=Ee,nt=He,Je=Ge,Be=Xe,He+=v.Rc,Xe+=v.Rc,oe+=2*j.A,he(ge,(be+=2*v.fa)-v.fa,ge,be,je,nt,Je,Be,Ee,He,Ge,Xe,ie,oe-j.A,ie,oe,ut);return be+=v.fa,v.j+ot<v.o?(r(C.ec,C.fc,ge,be,ut),r(C.cc,C.dc,Ee,He,at),r(C.Mc,C.Nc,Ge,Xe,at),D--):1&ot||he(ge,be,null,null,Ee,He,Ge,Xe,Ee,He,Ge,Xe,ie,oe+j.A,null,null,ut),D}function va(v,C,D){var j=v.F,ie=[v.J];if(j!=null){var oe=v.U,he=C.ba.S,ge=he==HC||he==qp;C=C.ba.f.RGBA;var be=[0],Ee=v.ka;be[0]=v.T,v.Kb&&(Ee==0?--be[0]:(--Ee,ie[0]-=v.width),v.j+v.ka+v.T==v.o&&(be[0]=v.o-v.j-Ee));var He=C.eb;Ee=C.fb+Ee*C.A,v=Sn(j,ie[0],v.width,oe,be,He,Ee+(ge?0:3),C.A),e(D==be),v&&fi(he)&&sc(He,Ee,ge,oe,be,C.A)}return 0}function nn(v){var C=v.ma,D=C.ba.S,j=11>D,ie=D==LC||D==FC||D==HC||D==VR||D==12||fi(D);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!s_(C.Oa,v,ie?11:12))return 0;if(ie&&fi(D)&&pt(),v.da)alert("todo:use_scaling");else{if(j){if(C.Ib=ii,v.Kb){if(D=v.U+1>>1,C.memory=o(v.U+2*D),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+v.U,C.Mc=C.cc,C.Nc=C.dc+D,C.Ib=pi,pt()}}else alert("todo:EmitYUV");ie&&(C.Jb=va,j&&qe())}if(j&&!XP){for(v=0;256>v;++v)KP[v]=89858*(v-128)+WC>>$p,ZP[v]=-22014*(v-128)+WC,rW[v]=-45773*(v-128),iW[v]=113618*(v-128)+WC>>$p;for(v=p_;v<qR;++v)C=76283*(v-16)+WC>>$p,nW[v-p_]=Ga(C,255),oW[v-p_]=Ga(C+8>>4,15);XP=1}return 1}function Oi(v){var C=v.ma,D=v.U,j=v.T;return e(!(1&v.ka)),0>=D||0>=j?0:(D=C.Ib(v,C),C.Jb!=null&&C.Jb(v,C,D),C.Dc+=D,1)}function ec(v){v.ma.memory=null}function Rt(v,C,D,j){return Ae(v,8)!=47?0:(C[0]=Ae(v,14)+1,D[0]=Ae(v,14)+1,j[0]=Ae(v,1),Ae(v,3)!=0?0:!v.h)}function ba(v,C){if(4>v)return v+1;var D=v-2>>1;return(2+(1&v)<<D)+Ae(C,D)+1}function Dd(v,C){return 120<C?C-120:1<=(D=((D=Wz[C-1])>>4)*v+(8-(15&D)))?D:1;var D}function ks(v,C,D){var j=I(D),ie=v[C+=255&j].g-8;return 0<ie&&(Q(D,D.u+8),j=I(D),C+=v[C].value,C+=j&(1<<ie)-1),Q(D,D.u+v[C].g),v[C].value}function Cr(v,C,D){return D.g+=v.g,D.value+=v.value<<C>>>0,e(8>=D.g),v.g}function on(v,C,D){var j=v.xc;return e((C=j==0?0:v.vc[v.md*(D>>j)+(C>>j)])<v.Wb),v.Ya[C]}function po(v,C,D,j){var ie=v.ab,oe=v.c*C,he=v.C;C=he+C;var ge=D,be=j;for(j=v.Ta,D=v.Ua;0<ie--;){var Ee=v.gc[ie],He=he,Ge=C,Xe=ge,je=be,nt=(be=j,ge=D,Ee.Ea);switch(e(He<Ge),e(Ge<=Ee.nc),Ee.hc){case 2:kC(Xe,je,(Ge-He)*nt,be,ge);break;case 0:var Je=He,Be=Ge,Ve=be,ot=ge,ut=(xt=Ee).Ea;Je==0&&(HR(Xe,je,null,null,1,Ve,ot),Y(Xe,je+1,0,0,ut-1,Ve,ot+1),je+=ut,ot+=ut,++Je);for(var at=1<<xt.b,Wt=at-1,Et=ce(ut,xt.b),vi=xt.K,xt=xt.w+(Je>>xt.b)*Et;Je<Be;){var Dr=vi,qr=xt,Tr=1;for(Ug(Xe,je,Ve,ot-ut,1,Ve,ot);Tr<ut;){var dr=(Tr&~Wt)+at;dr>ut&&(dr=ut),(0,Kh[Dr[qr++]>>8&15])(Xe,je+ +Tr,Ve,ot+Tr-ut,dr-Tr,Ve,ot+Tr),Tr=dr}je+=ut,ot+=ut,++Je&Wt||(xt+=Et)}Ge!=Ee.nc&&r(be,ge-nt,be,ge+(Ge-He-1)*nt,nt);break;case 1:for(nt=Xe,Be=je,ut=(Xe=Ee.Ea)-(ot=Xe&~(Ve=(je=1<<Ee.b)-1)),Je=ce(Xe,Ee.b),at=Ee.K,Ee=Ee.w+(He>>Ee.b)*Je;He<Ge;){for(Wt=at,Et=Ee,vi=new Me,xt=Be+ot,Dr=Be+Xe;Be<xt;)fe(Wt[Et++],vi),Vp(vi,nt,Be,je,be,ge),Be+=je,ge+=je;Be<Dr&&(fe(Wt[Et++],vi),Vp(vi,nt,Be,ut,be,ge),Be+=ut,ge+=ut),++He&Ve||(Ee+=Je)}break;case 3:if(Xe==be&&je==ge&&0<Ee.b){for(Be=be,Xe=nt=ge+(Ge-He)*nt-(ot=(Ge-He)*ce(Ee.Ea,Ee.b)),je=be,Ve=ge,Je=[],ot=(ut=ot)-1;0<=ot;--ot)Je[ot]=je[Ve+ot];for(ot=ut-1;0<=ot;--ot)Be[Xe+ot]=Je[ot];Xa(Ee,He,Ge,be,nt,be,ge)}else Xa(Ee,He,Ge,Xe,je,be,ge)}ge=j,be=D}be!=D&&r(j,D,ge,be,oe)}function Vn(v,C){var D=v.V,j=v.Ba+v.c*v.C,ie=C-v.C;if(e(C<=v.l.o),e(16>=ie),0<ie){var oe=v.l,he=v.Ta,ge=v.Ua,be=oe.width;if(po(v,ie,D,j),ie=ge=[ge],e((D=v.C)<(j=C)),e(oe.v<oe.va),j>oe.o&&(j=oe.o),D<oe.j){var Ee=oe.j-D;D=oe.j,ie[0]+=Ee*be}if(D>=j?D=0:(ie[0]+=4*oe.v,oe.ka=D-oe.j,oe.U=oe.va-oe.v,oe.T=j-D,D=1),D){if(ge=ge[0],11>(D=v.ca).S){var He=D.f.RGBA,Ge=(j=D.S,ie=oe.U,oe=oe.T,Ee=He.eb,He.A),Xe=oe;for(He=He.fb+v.Ma*He.A;0<Xe--;){var je=he,nt=ge,Je=ie,Be=Ee,Ve=He;switch(j){case PC:Ka(je,nt,Je,Be,Ve);break;case LC:_a(je,nt,Je,Be,Ve);break;case BC:_a(je,nt,Je,Be,Ve),sc(Be,Ve,0,Je,1,0);break;case BP:Fu(je,nt,Je,Be,Ve);break;case FC:vt(je,nt,Je,Be,Ve,1);break;case VC:vt(je,nt,Je,Be,Ve,1),sc(Be,Ve,0,Je,1,0);break;case HC:vt(je,nt,Je,Be,Ve,0);break;case qp:vt(je,nt,Je,Be,Ve,0),sc(Be,Ve,1,Je,1,0);break;case VR:Zh(je,nt,Je,Be,Ve);break;case rf:Zh(je,nt,Je,Be,Ve),xn(Be,Ve,Je,1,0);break;case jR:Lu(je,nt,Je,Be,Ve);break;default:e(0)}ge+=be,He+=Ge}v.Ma+=oe}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=D.height)}}v.C=C,e(v.C<=v.i)}function Qo(v){var C;if(0<v.ua)return 0;for(C=0;C<v.Wb;++C){var D=v.Ya[C].G,j=v.Ya[C].H;if(0<D[1][j[1]+0].g||0<D[2][j[2]+0].g||0<D[3][j[3]+0].g)return 0}return 1}function Jo(v,C,D,j,ie,oe){if(v.Z!=0){var he=v.qd,ge=v.rd;for(e(of[v.Z]!=null);C<D;++C)of[v.Z](he,ge,j,ie,j,ie,oe),he=j,ge=ie,ie+=oe;v.qd=he,v.rd=ge}}function Os(v,C){var D=v.l.ma,j=D.Z==0||D.Z==1?v.l.j:v.C;if(j=v.C<j?j:v.C,e(C<=v.l.o),C>j){var ie=v.l.width,oe=D.ca,he=D.tb+ie*j,ge=v.V,be=v.Ba+v.c*j,Ee=v.gc;e(v.ab==1),e(Ee[0].hc==3),qg(Ee[0],j,C,ge,be,oe,he),Jo(D,j,C,oe,he,ie)}v.C=v.Ma=C}function Uc(v,C,D,j,ie,oe,he){var ge=v.$/j,be=v.$%j,Ee=v.m,He=v.s,Ge=D+v.$,Xe=Ge;ie=D+j*ie;var je=D+j*oe,nt=280+He.ua,Je=v.Pb?ge:16777216,Be=0<He.ua?He.Wa:null,Ve=He.wc,ot=Ge<je?on(He,be,ge):null;e(v.C<oe),e(je<=ie);var ut=!1;e:for(;;){for(;ut||Ge<je;){var at=0;if(ge>=Je){var Wt=Ge-D;e((Je=v).Pb),Je.wd=Je.m,Je.xd=Wt,0<Je.s.ua&&Ue(Je.s.Wa,Je.s.vb),Je=ge+qz}if(be&Ve||(ot=on(He,be,ge)),e(ot!=null),ot.Qb&&(C[Ge]=ot.qb,ut=!0),!ut)if(le(Ee),ot.jc){at=Ee,Wt=C;var Et=Ge,vi=ot.pd[I(at)&Ns-1];e(ot.jc),256>vi.g?(Q(at,at.u+vi.g),Wt[Et]=vi.value,at=0):(Q(at,at.u+vi.g-256),e(256<=vi.value),at=vi.value),at==0&&(ut=!0)}else at=ks(ot.G[0],ot.H[0],Ee);if(Ee.h)break;if(ut||256>at){if(!ut)if(ot.nd)C[Ge]=(ot.qb|at<<8)>>>0;else{if(le(Ee),ut=ks(ot.G[1],ot.H[1],Ee),le(Ee),Wt=ks(ot.G[2],ot.H[2],Ee),Et=ks(ot.G[3],ot.H[3],Ee),Ee.h)break;C[Ge]=(Et<<24|ut<<16|at<<8|Wt)>>>0}if(ut=!1,++Ge,++be>=j&&(be=0,++ge,he!=null&&ge<=oe&&!(ge%16)&&he(v,ge),Be!=null))for(;Xe<Ge;)at=C[Xe++],Be.X[(506832829*at&4294967295)>>>Be.Mb]=at}else if(280>at){if(at=ba(at-256,Ee),Wt=ks(ot.G[4],ot.H[4],Ee),le(Ee),Wt=Dd(j,Wt=ba(Wt,Ee)),Ee.h)break;if(Ge-D<Wt||ie-Ge<at)break e;for(Et=0;Et<at;++Et)C[Ge+Et]=C[Ge+Et-Wt];for(Ge+=at,be+=at;be>=j;)be-=j,++ge,he!=null&&ge<=oe&&!(ge%16)&&he(v,ge);if(e(Ge<=ie),be&Ve&&(ot=on(He,be,ge)),Be!=null)for(;Xe<Ge;)at=C[Xe++],Be.X[(506832829*at&4294967295)>>>Be.Mb]=at}else{if(!(at<nt))break e;for(ut=at-280,e(Be!=null);Xe<Ge;)at=C[Xe++],Be.X[(506832829*at&4294967295)>>>Be.Mb]=at;at=Ge,e(!(ut>>>(Wt=Be).Xa)),C[at]=Wt.X[ut],ut=!0}ut||e(Ee.h==X(Ee))}if(v.Pb&&Ee.h&&Ge<ie)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&Ue(v.s.vb,v.s.Wa);else{if(Ee.h)break e;he?.(v,ge>oe?oe:ge),v.a=0,v.$=Ge-D}return 1}return v.a=3,0}function Md(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var C=v.Wa;C!=null&&(C.X=null),v.vb=null,e(v!=null)}function Gs(){var v=new Hg;return v==null?null:(v.a=0,v.xb=UP,di("Predictor","VP8LPredictors"),di("Predictor","VP8LPredictors_C"),di("PredictorAdd","VP8LPredictorsAdd"),di("PredictorAdd","VP8LPredictorsAdd_C"),kC=Z,Vp=we,Ka=Ie,_a=ze,Zh=rt,Lu=yt,Fu=st,O.VP8LMapColor32b=Xh,O.VP8LMapColor8b=OC,v)}function qc(v,C,D,j,ie){var oe=1,he=[v],ge=[C],be=j.m,Ee=j.s,He=null,Ge=0;e:for(;;){if(D)for(;oe&&Ae(be,1);){var Xe=he,je=ge,nt=j,Je=1,Be=nt.m,Ve=nt.gc[nt.ab],ot=Ae(Be,2);if(nt.Oc&1<<ot)oe=0;else{switch(nt.Oc|=1<<ot,Ve.hc=ot,Ve.Ea=Xe[0],Ve.nc=je[0],Ve.K=[null],++nt.ab,e(4>=nt.ab),ot){case 0:case 1:Ve.b=Ae(Be,3)+2,Je=qc(ce(Ve.Ea,Ve.b),ce(Ve.nc,Ve.b),0,nt,Ve.K),Ve.K=Ve.K[0];break;case 3:var ut,at=Ae(Be,8)+1,Wt=16<at?0:4<at?1:2<at?2:3;if(Xe[0]=ce(Ve.Ea,Wt),Ve.b=Wt,ut=Je=qc(at,1,0,nt,Ve.K)){var Et,vi=at,xt=Ve,Dr=1<<(8>>xt.b),qr=o(Dr);if(qr==null)ut=0;else{var Tr=xt.K[0],dr=xt.w;for(qr[0]=xt.K[0][0],Et=1;Et<1*vi;++Et)qr[Et]=de(Tr[dr+Et],qr[Et-1]);for(;Et<4*Dr;++Et)qr[Et]=0;xt.K[0]=null,xt.K[0]=qr,ut=1}}Je=ut;break;case 2:break;default:e(0)}oe=Je}}if(he=he[0],ge=ge[0],oe&&Ae(be,1)&&!(oe=1<=(Ge=Ae(be,4))&&11>=Ge)){j.a=3;break e}var _n;if(_n=oe)t:{var sn,Ui,Ho,Za=j,Bo=he,Qa=ge,Yr=Ge,is=D,Nl=Za.m,_s=Za.s,Ps=[null],wa=1,cc=0,Ld=Uz[Yr];i:for(;;){if(is&&Ae(Nl,1)){var ys=Ae(Nl,3)+2,ju=ce(Bo,ys),Ca=ce(Qa,ys),Kc=ju*Ca;if(!qc(ju,Ca,0,Za,Ps))break i;for(Ps=Ps[0],_s.xc=ys,sn=0;sn<Kc;++sn){var sf=Ps[sn]>>8&65535;Ps[sn]=sf,sf>=wa&&(wa=sf+1)}}if(Nl.h)break i;for(Ui=0;5>Ui;++Ui){var bo=Yp[Ui];!Ui&&0<Yr&&(bo+=1<<Yr),cc<bo&&(cc=bo)}var YR=s(wa*Ld,P),tL=wa,iL=s(tL,K);if(iL==null)var Gg=null;else e(65536>=tL),Gg=iL;var Fd=o(cc);if(Gg==null||Fd==null||YR==null){Za.a=1;break i}var Gp=YR;for(sn=Ho=0;sn<wa;++sn){var Hi=Gg[sn],b=Hi.G,E=Hi.H,H=0,q=1,me=0;for(Ui=0;5>Ui;++Ui){bo=Yp[Ui],b[Ui]=Gp,E[Ui]=Ho,!Ui&&0<Yr&&(bo+=1<<Yr);n:{var Pe,et=bo,Ut=Za,xi=Fd,gr=Gp,xa=Ho,Zc=0,Sa=Ut.m,Z9e=Ae(Sa,1);if(n(xi,0,0,et),Z9e){var Q9e=Ae(Sa,1)+1,J9e=Ae(Sa,1),Vce=Ae(Sa,J9e==0?1:8);xi[Vce]=1,Q9e==2&&(xi[Vce=Ae(Sa,8)]=1);var rL=1}else{var jce=o(19),zce=Ae(Sa,4)+4;if(19<zce){Ut.a=3;var nL=0;break n}for(Pe=0;Pe<zce;++Pe)jce[zP[Pe]]=Ae(Sa,3);var aW=void 0,$R=void 0,Wce=Ut,eYe=jce,oL=et,Uce=xi,lW=0,Xg=Wce.m,qce=8,Yce=s(128,P);r:for(;N(Yce,0,7,eYe,19);){if(Ae(Xg,1)){var tYe=2+2*Ae(Xg,3);if((aW=2+Ae(Xg,tYe))>oL)break r}else aW=oL;for($R=0;$R<oL&&aW--;){le(Xg);var $ce=Yce[0+(127&I(Xg))];Q(Xg,Xg.u+$ce.g);var UC=$ce.value;if(16>UC)Uce[$R++]=UC,UC!=0&&(qce=UC);else{var iYe=UC==16,Gce=UC-16,rYe=VP[Gce],Xce=Ae(Xg,jC[Gce])+rYe;if($R+Xce>oL)break r;for(var nYe=iYe?qce:0;0<Xce--;)Uce[$R++]=nYe}}lW=1;break r}lW||(Wce.a=3),rL=lW}(rL=rL&&!Sa.h)&&(Zc=N(gr,xa,8,xi,et)),rL&&Zc!=0?nL=Zc:(Ut.a=3,nL=0)}if(nL==0)break i;if(q&&jP[Ui]==1&&(q=Gp[Ho].g==0),H+=Gp[Ho].g,Ho+=nL,3>=Ui){var GR,cW=Fd[0];for(GR=1;GR<bo;++GR)Fd[GR]>cW&&(cW=Fd[GR]);me+=cW}}if(Hi.nd=q,Hi.Qb=0,q&&(Hi.qb=(b[3][E[3]+0].value<<24|b[1][E[1]+0].value<<16|b[2][E[2]+0].value)>>>0,H==0&&256>b[0][E[0]+0].value&&(Hi.Qb=1,Hi.qb+=b[0][E[0]+0].value<<8)),Hi.jc=!Hi.Qb&&6>me,Hi.jc){var sL,Xp=Hi;for(sL=0;sL<Ns;++sL){var Kg=sL,Zg=Xp.pd[Kg],aL=Xp.G[0][Xp.H[0]+Kg];256<=aL.value?(Zg.g=aL.g+256,Zg.value=aL.value):(Zg.g=0,Zg.value=0,Kg>>=Cr(aL,8,Zg),Kg>>=Cr(Xp.G[1][Xp.H[1]+Kg],16,Zg),Kg>>=Cr(Xp.G[2][Xp.H[2]+Kg],0,Zg),Cr(Xp.G[3][Xp.H[3]+Kg],24,Zg))}}}_s.vc=Ps,_s.Wb=wa,_s.Ya=Gg,_s.yc=YR,_n=1;break t}_n=0}if(!(oe=_n)){j.a=3;break e}if(0<Ge){if(Ee.ua=1<<Ge,!ct(Ee.Wa,Ge)){j.a=1,oe=0;break e}}else Ee.ua=0;var dW=j,Kce=he,oYe=ge,uW=dW.s,hW=uW.xc;if(dW.c=Kce,dW.i=oYe,uW.md=ce(Kce,hW),uW.wc=hW==0?-1:(1<<hW)-1,D){j.xb=Qz;break e}if((He=o(he*ge))==null){j.a=1,oe=0;break e}oe=(oe=Uc(j,He,0,he,ge,ge,null))&&!be.h;break e}return oe?(ie!=null?ie[0]=He:(e(He==null),e(D)),j.$=0,D||Md(Ee)):Md(Ee),oe}function Np(v,C){var D=v.c*v.i,j=D+C+16*C;return e(v.c<=C),v.V=o(j),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+D+C,1)}function Yc(v,C){var D=v.C,j=C-D,ie=v.V,oe=v.Ba+v.c*D;for(e(C<=v.l.o);0<j;){var he=16<j?16:j,ge=v.l.ma,be=v.l.width,Ee=be*he,He=ge.ca,Ge=ge.tb+be*D,Xe=v.Ta,je=v.Ua;po(v,he,ie,oe),To(Xe,je,He,Ge,Ee),Jo(ge,D,D+he,He,Ge,be),j-=he,ie+=he*v.c,D+=he}e(D==C),v.C=v.Ma=C}function kd(){this.ub=this.yd=this.td=this.Rb=0}function Pp(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ig(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function vC(){this.Yb=function(){var v=[];return function C(D,j,ie){for(var oe=ie[j],he=0;he<oe&&(D.push(ie.length>j+1?[]:0),!(ie.length<j+1));he++)C(D[he],j+1,ie)}(v,0,[3,11]),v}()}function wR(){this.jb=o(3),this.Wc=a([4,8],vC),this.Xc=a([4,17],vC)}function Qn(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Vh(){this.ld=this.La=this.dd=this.tc=0}function bC(){this.Na=this.la=0}function _C(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Dg(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function CR(){this.uc=this.M=this.Nb=0,this.wa=Array(new Vh),this.Y=0,this.ya=Array(new Dg),this.aa=0,this.l=new Mg}function yC(){this.y=o(16),this.f=o(8),this.ea=o(8)}function xR(){this.cb=this.a=0,this.sc="",this.m=new k,this.Od=new kd,this.Kc=new Pp,this.ed=new Qn,this.Qa=new Ig,this.Ic=this.$c=this.Aa=0,this.D=new CR,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,k),this.ia=0,this.pb=s(4,_C),this.Pa=new wR,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new yC),this.Hd=0,this.rb=Array(new bC),this.sb=0,this.wa=Array(new Vh),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Dg),this.L=this.aa=0,this.gd=a([4,2],Vh),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Mg(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function SR(){var v=new xR;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,f_||(f_=wC)),v}function Eo(v,C,D){return v.a==0&&(v.a=C,v.sc=D,v.cb=0),0}function U0(v,C,D){return 3<=D&&v[C+0]==157&&v[C+1]==1&&v[C+2]==42}function q0(v,C){if(v==null)return 0;if(v.a=0,v.sc="OK",C==null)return Eo(v,2,"null VP8Io passed to VP8GetHeaders()");var D=C.data,j=C.w,ie=C.ha;if(4>ie)return Eo(v,7,"Truncated header.");var oe=D[j+0]|D[j+1]<<8|D[j+2]<<16,he=v.Od;if(he.Rb=!(1&oe),he.td=oe>>1&7,he.yd=oe>>4&1,he.ub=oe>>5,3<he.td)return Eo(v,3,"Incorrect keyframe parameters.");if(!he.yd)return Eo(v,4,"Frame not displayable.");j+=3,ie-=3;var ge=v.Kc;if(he.Rb){if(7>ie)return Eo(v,7,"cannot parse picture header");if(!U0(D,j,ie))return Eo(v,3,"Bad code word");ge.c=16383&(D[j+4]<<8|D[j+3]),ge.Td=D[j+4]>>6,ge.i=16383&(D[j+6]<<8|D[j+5]),ge.Ud=D[j+6]>>6,j+=7,ie-=7,v.za=ge.c+15>>4,v.Ub=ge.i+15>>4,C.width=ge.c,C.height=ge.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,n((oe=v.Pa).jb,0,255,oe.jb.length),e((oe=v.Qa)!=null),oe.Cb=0,oe.Bb=0,oe.Fb=1,n(oe.Zb,0,0,oe.Zb.length),n(oe.Lb,0,0,oe.Lb)}if(he.ub>ie)return Eo(v,7,"bad partition length");ve(oe=v.m,D,j,he.ub),j+=he.ub,ie-=he.ub,he.Rb&&(ge.Ld=Re(oe),ge.Kd=Re(oe)),ge=v.Qa;var be,Ee=v.Pa;if(e(oe!=null),e(ge!=null),ge.Cb=Re(oe),ge.Cb){if(ge.Bb=Re(oe),Re(oe)){for(ge.Fb=Re(oe),be=0;4>be;++be)ge.Zb[be]=Re(oe)?ee(oe,7):0;for(be=0;4>be;++be)ge.Lb[be]=Re(oe)?ee(oe,6):0}if(ge.Bb)for(be=0;3>be;++be)Ee.jb[be]=Re(oe)?W(oe,8):255}else ge.Bb=0;if(oe.Ka)return Eo(v,3,"cannot parse segment header");if((ge=v.ed).zd=Re(oe),ge.Tb=W(oe,6),ge.wb=W(oe,3),ge.Pc=Re(oe),ge.Pc&&Re(oe)){for(Ee=0;4>Ee;++Ee)Re(oe)&&(ge.vd[Ee]=ee(oe,6));for(Ee=0;4>Ee;++Ee)Re(oe)&&(ge.od[Ee]=ee(oe,6))}if(v.L=ge.Tb==0?0:ge.zd?1:2,oe.Ka)return Eo(v,3,"cannot parse filter header");var He=ie;if(ie=be=j,j=be+He,ge=He,v.Xb=(1<<W(v.m,2))-1,He<3*(Ee=v.Xb))D=7;else{for(be+=3*Ee,ge-=3*Ee,He=0;He<Ee;++He){var Ge=D[ie+0]|D[ie+1]<<8|D[ie+2]<<16;Ge>ge&&(Ge=ge),ve(v.Jc[+He],D,be,Ge),be+=Ge,ge-=Ge,ie+=3}ve(v.Jc[+Ee],D,be,ge),D=be<j?0:5}if(D!=0)return Eo(v,D,"cannot parse partitions");for(D=W(be=v.m,7),ie=Re(be)?ee(be,4):0,j=Re(be)?ee(be,4):0,ge=Re(be)?ee(be,4):0,Ee=Re(be)?ee(be,4):0,be=Re(be)?ee(be,4):0,He=v.Qa,Ge=0;4>Ge;++Ge){if(He.Cb){var Xe=He.Zb[Ge];He.Fb||(Xe+=D)}else{if(0<Ge){v.pb[Ge]=v.pb[0];continue}Xe=D}var je=v.pb[Ge];je.Sc[0]=zR[Ga(Xe+ie,127)],je.Sc[1]=WR[Ga(Xe+0,127)],je.Eb[0]=2*zR[Ga(Xe+j,127)],je.Eb[1]=101581*WR[Ga(Xe+ge,127)]>>16,8>je.Eb[1]&&(je.Eb[1]=8),je.Qc[0]=zR[Ga(Xe+Ee,117)],je.Qc[1]=WR[Ga(Xe+be,127)],je.lc=Xe+be}if(!he.Rb)return Eo(v,4,"Not a key frame.");for(Re(oe),he=v.Pa,D=0;4>D;++D){for(ie=0;8>ie;++ie)for(j=0;3>j;++j)for(ge=0;11>ge;++ge)Ee=Oe(oe,Kz[D][ie][j][ge])?W(oe,8):Gz[D][ie][j][ge],he.Wc[D][ie].Yb[j][ge]=Ee;for(ie=0;17>ie;++ie)he.Xc[D][ie]=he.Wc[D][Zz[ie]]}return v.kc=Re(oe),v.kc&&(v.Bd=W(oe,8)),v.cb=1}function wC(v,C,D,j,ie,oe,he){var ge=C[ie].Yb[D];for(D=0;16>ie;++ie){if(!Oe(v,ge[D+0]))return ie;for(;!Oe(v,ge[D+1]);)if(ge=C[++ie].Yb[0],D=0,ie==16)return 16;var be=C[ie+1].Yb;if(Oe(v,ge[D+2])){var Ee=v,He=0;if(Oe(Ee,(Xe=ge)[(Ge=D)+3]))if(Oe(Ee,Xe[Ge+6])){for(ge=0,Ge=2*(He=Oe(Ee,Xe[Ge+8]))+(Xe=Oe(Ee,Xe[Ge+9+He])),He=0,Xe=Yz[Ge];Xe[ge];++ge)He+=He+Oe(Ee,Xe[ge]);He+=3+(8<<Ge)}else Oe(Ee,Xe[Ge+7])?(He=7+2*Oe(Ee,165),He+=Oe(Ee,145)):He=5+Oe(Ee,159);else He=Oe(Ee,Xe[Ge+4])?3+Oe(Ee,Xe[Ge+5]):2;ge=be[2]}else He=1,ge=be[1];be=he+$z[ie],0>(Ee=v).b&&xe(Ee);var Ge,Xe=Ee.b,je=(Ge=Ee.Ca>>1)-(Ee.I>>Xe)>>31;--Ee.b,Ee.Ca+=je,Ee.Ca|=1,Ee.I-=(Ge+1&je)<<Xe,oe[be]=((He^je)-je)*j[(0<ie)+0]}return 16}function Y0(v){var C=v.rb[v.sb-1];C.la=0,C.Na=0,n(v.zc,0,0,v.zc.length),v.ja=0}function ER(v,C){if(v==null)return 0;if(C==null)return Eo(v,2,"NULL VP8Io parameter in VP8Decode().");if(!v.cb&&!q0(v,C))return 0;if(e(v.cb),C.ac==null||C.ac(C)){C.ob&&(v.L=0);var D=Xc[v.L];if(v.L==2?(v.yb=0,v.zb=0):(v.yb=C.v-D>>4,v.zb=C.j-D>>4,0>v.yb&&(v.yb=0),0>v.zb&&(v.zb=0)),v.Va=C.o+15+D>>4,v.Hb=C.va+15+D>>4,v.Hb>v.za&&(v.Hb=v.za),v.Va>v.Ub&&(v.Va=v.Ub),0<v.L){var j=v.ed;for(D=0;4>D;++D){var ie;if(v.Qa.Cb){var oe=v.Qa.Lb[D];v.Qa.Fb||(oe+=j.Tb)}else oe=j.Tb;for(ie=0;1>=ie;++ie){var he=v.gd[D][ie],ge=oe;if(j.Pc&&(ge+=j.vd[0],ie&&(ge+=j.od[0])),0<(ge=0>ge?0:63<ge?63:ge)){var be=ge;0<j.wb&&(be=4<j.wb?be>>2:be>>1)>9-j.wb&&(be=9-j.wb),1>be&&(be=1),he.dd=be,he.tc=2*ge+be,he.ld=40<=ge?2:15<=ge?1:0}else he.tc=0;he.La=ie}}}D=0}else Eo(v,6,"Frame setup failed"),D=v.a;if(D=D==0){if(D){v.$c=0,0<v.Aa||(v.Ic=sW);e:{D=v.Ic,j=4*(be=v.za);var Ee=32*be,He=be+1,Ge=0<v.L?be*(0<v.Aa?2:1):0,Xe=(v.Aa==2?2:1)*be;if((he=j+832+(ie=3*(16*D+Xc[v.L])/2*Ee)+(oe=v.Fa!=null&&0<v.Fa.length?v.Kc.c*v.Kc.i:0))!=he)D=0;else{if(he>v.Vb){if(v.Vb=0,v.Ec=o(he),v.Fc=0,v.Ec==null){D=Eo(v,1,"no memory during frame initialization.");break e}v.Vb=he}he=v.Ec,ge=v.Fc,v.Ac=he,v.Bc=ge,ge+=j,v.Gd=s(Ee,yC),v.Hd=0,v.rb=s(He+1,bC),v.sb=1,v.wa=Ge?s(Ge,Vh):null,v.Y=0,v.D.Nb=0,v.D.wa=v.wa,v.D.Y=v.Y,0<v.Aa&&(v.D.Y+=be),e(!0),v.oc=he,v.pc=ge,ge+=832,v.ya=s(Xe,Dg),v.aa=0,v.D.ya=v.ya,v.D.aa=v.aa,v.Aa==2&&(v.D.aa+=be),v.R=16*be,v.B=8*be,be=(Ee=Xc[v.L])*v.R,Ee=Ee/2*v.B,v.sa=he,v.ta=ge+be,v.qa=v.sa,v.ra=v.ta+16*D*v.R+Ee,v.Ha=v.qa,v.Ia=v.ra+8*D*v.B+Ee,v.$c=0,ge+=ie,v.mb=oe?he:null,v.nb=oe?ge:null,e(ge+oe<=v.Fc+v.Vb),Y0(v),n(v.Ac,v.Bc,0,j),D=1}}if(D){if(C.ka=0,C.y=v.sa,C.O=v.ta,C.f=v.qa,C.N=v.ra,C.ea=v.Ha,C.Vd=v.Ia,C.fa=v.R,C.Rc=v.B,C.F=null,C.J=0,!NC){for(D=-255;255>=D;++D)ts[255+D]=0>D?-D:D;for(D=-1020;1020>=D;++D)Bu[1020+D]=-128>D?-128:127<D?127:D;for(D=-112;112>=D;++D)h_[112+D]=-16>D?-16:15<D?15:D;for(D=-255;510>=D;++D)$g[255+D]=0>D?0:255<D?255:D;NC=1}Yg=RR,Hu=Lp,l_=ic,ya=TR,vo=CC,go=$0,nc=J0,c_=Hp,d_=e_,Qh=t_,Jh=Fg,ef=Ml,jp=kl,zp=IC,Wp=Q0,tf=Er,u_=Dl,oc=Fp,Gc[0]=Od,Gc[1]=AR,Gc[2]=kR,Gc[3]=OR,Gc[4]=SC,Gc[5]=Ng,Gc[6]=EC,Gc[7]=K0,Gc[8]=PR,Gc[9]=NR,nf[0]=X0,nf[1]=DR,nf[2]=Ou,nf[3]=zh,nf[4]=Xs,nf[5]=MR,nf[6]=xC,Vu[0]=Nd,Vu[1]=IR,Vu[2]=LR,Vu[3]=Z0,Vu[4]=Wh,Vu[5]=FR,Vu[6]=Pg,D=1}else D=0}D&&(D=function(je,nt){for(je.M=0;je.M<je.Va;++je.M){var Je,Be=je.Jc[je.M&je.Xb],Ve=je.m,ot=je;for(Je=0;Je<ot.za;++Je){var ut=Ve,at=ot,Wt=at.Ac,Et=at.Bc+4*Je,vi=at.zc,xt=at.ya[at.aa+Je];if(at.Qa.Bb?xt.$b=Oe(ut,at.Pa.jb[0])?2+Oe(ut,at.Pa.jb[2]):Oe(ut,at.Pa.jb[1]):xt.$b=0,at.kc&&(xt.Ad=Oe(ut,at.Bd)),xt.Za=!Oe(ut,145)+0,xt.Za){var Dr=xt.Ob,qr=0;for(at=0;4>at;++at){var Tr,dr=vi[0+at];for(Tr=0;4>Tr;++Tr){dr=Xz[Wt[Et+Tr]][dr];for(var _n=WP[Oe(ut,dr[0])];0<_n;)_n=WP[2*_n+Oe(ut,dr[_n])];dr=-_n,Wt[Et+Tr]=dr}r(Dr,qr,Wt,Et,4),qr+=4,vi[0+at]=dr}}else dr=Oe(ut,156)?Oe(ut,128)?1:3:Oe(ut,163)?2:0,xt.Ob[0]=dr,n(Wt,Et,dr,4),n(vi,0,dr,4);xt.Dd=Oe(ut,142)?Oe(ut,114)?Oe(ut,183)?1:3:2:0}if(ot.m.Ka)return Eo(je,7,"Premature end-of-partition0 encountered.");for(;je.ja<je.za;++je.ja){if(ot=Be,ut=(Ve=je).rb[Ve.sb-1],Wt=Ve.rb[Ve.sb+Ve.ja],Je=Ve.ya[Ve.aa+Ve.ja],Et=Ve.kc?Je.Ad:0)ut.la=Wt.la=0,Je.Za||(ut.Na=Wt.Na=0),Je.Hc=0,Je.Gc=0,Je.ia=0;else{var sn,Ui;if(ut=Wt,Wt=ot,Et=Ve.Pa.Xc,vi=Ve.ya[Ve.aa+Ve.ja],xt=Ve.pb[vi.$b],at=vi.ad,Dr=0,qr=Ve.rb[Ve.sb-1],dr=Tr=0,n(at,Dr,0,384),vi.Za)var Ho=0,Za=Et[3];else{_n=o(16);var Bo=ut.Na+qr.Na;if(Bo=f_(Wt,Et[1],Bo,xt.Eb,0,_n,0),ut.Na=qr.Na=(0<Bo)+0,1<Bo)Yg(_n,0,at,Dr);else{var Qa=_n[0]+3>>3;for(_n=0;256>_n;_n+=16)at[Dr+_n]=Qa}Ho=1,Za=Et[0]}var Yr=15&ut.la,is=15&qr.la;for(_n=0;4>_n;++_n){var Nl=1&is;for(Qa=Ui=0;4>Qa;++Qa)Yr=Yr>>1|(Nl=(Bo=f_(Wt,Za,Bo=Nl+(1&Yr),xt.Sc,Ho,at,Dr))>Ho)<<7,Ui=Ui<<2|(3<Bo?3:1<Bo?2:at[Dr+0]!=0),Dr+=16;Yr>>=4,is=is>>1|Nl<<7,Tr=(Tr<<8|Ui)>>>0}for(Za=Yr,Ho=is>>4,sn=0;4>sn;sn+=2){for(Ui=0,Yr=ut.la>>4+sn,is=qr.la>>4+sn,_n=0;2>_n;++_n){for(Nl=1&is,Qa=0;2>Qa;++Qa)Bo=Nl+(1&Yr),Yr=Yr>>1|(Nl=0<(Bo=f_(Wt,Et[2],Bo,xt.Qc,0,at,Dr)))<<3,Ui=Ui<<2|(3<Bo?3:1<Bo?2:at[Dr+0]!=0),Dr+=16;Yr>>=2,is=is>>1|Nl<<5}dr|=Ui<<4*sn,Za|=Yr<<4<<sn,Ho|=(240&is)<<sn}ut.la=Za,qr.la=Ho,vi.Hc=Tr,vi.Gc=dr,vi.ia=43690&dr?0:xt.ia,Et=!(Tr|dr)}if(0<Ve.L&&(Ve.wa[Ve.Y+Ve.ja]=Ve.gd[Je.$b][Je.Za],Ve.wa[Ve.Y+Ve.ja].La|=!Et),ot.Ka)return Eo(je,7,"Premature end-of-file encountered.")}if(Y0(je),Ve=nt,ot=1,Je=(Be=je).D,ut=0<Be.L&&Be.M>=Be.zb&&Be.M<=Be.Va,Be.Aa==0)e:{if(Je.M=Be.M,Je.uc=ut,Vg(Be,Je),ot=1,Je=(Ui=Be.D).Nb,ut=(dr=Xc[Be.L])*Be.R,Wt=dr/2*Be.B,_n=16*Je*Be.R,Qa=8*Je*Be.B,Et=Be.sa,vi=Be.ta-ut+_n,xt=Be.qa,at=Be.ra-Wt+Qa,Dr=Be.Ha,qr=Be.Ia-Wt+Qa,is=(Yr=Ui.M)==0,Tr=Yr>=Be.Va-1,Be.Aa==2&&Vg(Be,Ui),Ui.uc)for(Nl=(Bo=Be).D.M,e(Bo.D.uc),Ui=Bo.yb;Ui<Bo.Hb;++Ui){Ho=Ui,Za=Nl;var _s=(Ps=(bo=Bo).D).Nb;sn=bo.R;var Ps=Ps.wa[Ps.Y+Ho],wa=bo.sa,cc=bo.ta+16*_s*sn+16*Ho,Ld=Ps.dd,ys=Ps.tc;if(ys!=0)if(e(3<=ys),bo.L==1)0<Ho&&tf(wa,cc,sn,ys+4),Ps.La&&oc(wa,cc,sn,ys),0<Za&&Wp(wa,cc,sn,ys+4),Ps.La&&u_(wa,cc,sn,ys);else{var ju=bo.B,Ca=bo.qa,Kc=bo.ra+8*_s*ju+8*Ho,sf=bo.Ha,bo=bo.Ia+8*_s*ju+8*Ho;_s=Ps.ld,0<Ho&&(c_(wa,cc,sn,ys+4,Ld,_s),Qh(Ca,Kc,sf,bo,ju,ys+4,Ld,_s)),Ps.La&&(ef(wa,cc,sn,ys,Ld,_s),zp(Ca,Kc,sf,bo,ju,ys,Ld,_s)),0<Za&&(nc(wa,cc,sn,ys+4,Ld,_s),d_(Ca,Kc,sf,bo,ju,ys+4,Ld,_s)),Ps.La&&(Jh(wa,cc,sn,ys,Ld,_s),jp(Ca,Kc,sf,bo,ju,ys,Ld,_s))}}if(Be.ia&&alert("todo:DitherRow"),Ve.put!=null){if(Ui=16*Yr,Yr=16*(Yr+1),is?(Ve.y=Be.sa,Ve.O=Be.ta+_n,Ve.f=Be.qa,Ve.N=Be.ra+Qa,Ve.ea=Be.Ha,Ve.W=Be.Ia+Qa):(Ui-=dr,Ve.y=Et,Ve.O=vi,Ve.f=xt,Ve.N=at,Ve.ea=Dr,Ve.W=qr),Tr||(Yr-=dr),Yr>Ve.o&&(Yr=Ve.o),Ve.F=null,Ve.J=null,Be.Fa!=null&&0<Be.Fa.length&&Ui<Yr&&(Ve.J=Bg(Be,Ve,Ui,Yr-Ui),Ve.F=Be.mb,Ve.F==null&&Ve.F.length==0)){ot=Eo(Be,3,"Could not decode alpha data.");break e}Ui<Ve.j&&(dr=Ve.j-Ui,Ui=Ve.j,e(!(1&dr)),Ve.O+=Be.R*dr,Ve.N+=Be.B*(dr>>1),Ve.W+=Be.B*(dr>>1),Ve.F!=null&&(Ve.J+=Ve.width*dr)),Ui<Yr&&(Ve.O+=Ve.v,Ve.N+=Ve.v>>1,Ve.W+=Ve.v>>1,Ve.F!=null&&(Ve.J+=Ve.v),Ve.ka=Ui-Ve.j,Ve.U=Ve.va-Ve.v,Ve.T=Yr-Ui,ot=Ve.put(Ve))}Je+1!=Be.Ic||Tr||(r(Be.sa,Be.ta-ut,Et,vi+16*Be.R,ut),r(Be.qa,Be.ra-Wt,xt,at+8*Be.B,Wt),r(Be.Ha,Be.Ia-Wt,Dr,qr+8*Be.B,Wt))}if(!ot)return Eo(je,6,"Output aborted.")}return 1}(v,C)),C.bc!=null&&C.bc(C),D&=1}return D?(v.cb=0,D):0}function tc(v,C,D,j,ie){ie=v[C+D+32*j]+(ie>>3),v[C+D+32*j]=-256&ie?0>ie?0:255:ie}function kg(v,C,D,j,ie,oe){tc(v,C,0,D,j+ie),tc(v,C,1,D,j+oe),tc(v,C,2,D,j-oe),tc(v,C,3,D,j-ie)}function bs(v){return(20091*v>>16)+v}function jh(v,C,D,j){var ie,oe=0,he=o(16);for(ie=0;4>ie;++ie){var ge=v[C+0]+v[C+8],be=v[C+0]-v[C+8],Ee=(35468*v[C+4]>>16)-bs(v[C+12]),He=bs(v[C+4])+(35468*v[C+12]>>16);he[oe+0]=ge+He,he[oe+1]=be+Ee,he[oe+2]=be-Ee,he[oe+3]=ge-He,oe+=4,C++}for(ie=oe=0;4>ie;++ie)ge=(v=he[oe+0]+4)+he[oe+8],be=v-he[oe+8],Ee=(35468*he[oe+4]>>16)-bs(he[oe+12]),tc(D,j,0,0,ge+(He=bs(he[oe+4])+(35468*he[oe+12]>>16))),tc(D,j,1,0,be+Ee),tc(D,j,2,0,be-Ee),tc(D,j,3,0,ge-He),oe++,j+=32}function $0(v,C,D,j){var ie=v[C+0]+4,oe=35468*v[C+4]>>16,he=bs(v[C+4]),ge=35468*v[C+1]>>16;kg(D,j,0,ie+he,v=bs(v[C+1]),ge),kg(D,j,1,ie+oe,v,ge),kg(D,j,2,ie-oe,v,ge),kg(D,j,3,ie-he,v,ge)}function Lp(v,C,D,j,ie){jh(v,C,D,j),ie&&jh(v,C+16,D,j+4)}function ic(v,C,D,j){Hu(v,C+0,D,j,1),Hu(v,C+32,D,j+128,1)}function TR(v,C,D,j){var ie;for(v=v[C+0]+4,ie=0;4>ie;++ie)for(C=0;4>C;++C)tc(D,j,C,ie,v)}function CC(v,C,D,j){v[C+0]&&ya(v,C+0,D,j),v[C+16]&&ya(v,C+16,D,j+4),v[C+32]&&ya(v,C+32,D,j+128),v[C+48]&&ya(v,C+48,D,j+128+4)}function RR(v,C,D,j){var ie,oe=o(16);for(ie=0;4>ie;++ie){var he=v[C+0+ie]+v[C+12+ie],ge=v[C+4+ie]+v[C+8+ie],be=v[C+4+ie]-v[C+8+ie],Ee=v[C+0+ie]-v[C+12+ie];oe[0+ie]=he+ge,oe[8+ie]=he-ge,oe[4+ie]=Ee+be,oe[12+ie]=Ee-be}for(ie=0;4>ie;++ie)he=(v=oe[0+4*ie]+3)+oe[3+4*ie],ge=oe[1+4*ie]+oe[2+4*ie],be=oe[1+4*ie]-oe[2+4*ie],Ee=v-oe[3+4*ie],D[j+0]=he+ge>>3,D[j+16]=Ee+be>>3,D[j+32]=he-ge>>3,D[j+48]=Ee-be>>3,j+=64}function G0(v,C,D){var j,ie=C-32,oe=Ol,he=255-v[ie-1];for(j=0;j<D;++j){var ge,be=oe,Ee=he+v[C-1];for(ge=0;ge<D;++ge)v[C+ge]=be[Ee+v[ie+ge]];C+=32}}function AR(v,C){G0(v,C,4)}function IR(v,C){G0(v,C,8)}function DR(v,C){G0(v,C,16)}function Ou(v,C){var D;for(D=0;16>D;++D)r(v,C+32*D,v,C-32,16)}function zh(v,C){var D;for(D=16;0<D;--D)n(v,C,v[C-1],16),C+=32}function Og(v,C,D){var j;for(j=0;16>j;++j)n(C,D+32*j,v,16)}function X0(v,C){var D,j=16;for(D=0;16>D;++D)j+=v[C-1+32*D]+v[C+D-32];Og(j>>5,v,C)}function Xs(v,C){var D,j=8;for(D=0;16>D;++D)j+=v[C-1+32*D];Og(j>>4,v,C)}function MR(v,C){var D,j=8;for(D=0;16>D;++D)j+=v[C+D-32];Og(j>>4,v,C)}function xC(v,C){Og(128,v,C)}function Ni(v,C,D){return v+2*C+D+2>>2}function kR(v,C){var D,j=C-32;for(j=new Uint8Array([Ni(v[j-1],v[j+0],v[j+1]),Ni(v[j+0],v[j+1],v[j+2]),Ni(v[j+1],v[j+2],v[j+3]),Ni(v[j+2],v[j+3],v[j+4])]),D=0;4>D;++D)r(v,C+32*D,j,0,j.length)}function OR(v,C){var D=v[C-1],j=v[C-1+32],ie=v[C-1+64],oe=v[C-1+96];We(v,C+0,16843009*Ni(v[C-1-32],D,j)),We(v,C+32,16843009*Ni(D,j,ie)),We(v,C+64,16843009*Ni(j,ie,oe)),We(v,C+96,16843009*Ni(ie,oe,oe))}function Od(v,C){var D,j=4;for(D=0;4>D;++D)j+=v[C+D-32]+v[C-1+32*D];for(j>>=3,D=0;4>D;++D)n(v,C+32*D,j,4)}function SC(v,C){var D=v[C-1+0],j=v[C-1+32],ie=v[C-1+64],oe=v[C-1-32],he=v[C+0-32],ge=v[C+1-32],be=v[C+2-32],Ee=v[C+3-32];v[C+0+96]=Ni(j,ie,v[C-1+96]),v[C+1+96]=v[C+0+64]=Ni(D,j,ie),v[C+2+96]=v[C+1+64]=v[C+0+32]=Ni(oe,D,j),v[C+3+96]=v[C+2+64]=v[C+1+32]=v[C+0+0]=Ni(he,oe,D),v[C+3+64]=v[C+2+32]=v[C+1+0]=Ni(ge,he,oe),v[C+3+32]=v[C+2+0]=Ni(be,ge,he),v[C+3+0]=Ni(Ee,be,ge)}function EC(v,C){var D=v[C+1-32],j=v[C+2-32],ie=v[C+3-32],oe=v[C+4-32],he=v[C+5-32],ge=v[C+6-32],be=v[C+7-32];v[C+0+0]=Ni(v[C+0-32],D,j),v[C+1+0]=v[C+0+32]=Ni(D,j,ie),v[C+2+0]=v[C+1+32]=v[C+0+64]=Ni(j,ie,oe),v[C+3+0]=v[C+2+32]=v[C+1+64]=v[C+0+96]=Ni(ie,oe,he),v[C+3+32]=v[C+2+64]=v[C+1+96]=Ni(oe,he,ge),v[C+3+64]=v[C+2+96]=Ni(he,ge,be),v[C+3+96]=Ni(ge,be,be)}function Ng(v,C){var D=v[C-1+0],j=v[C-1+32],ie=v[C-1+64],oe=v[C-1-32],he=v[C+0-32],ge=v[C+1-32],be=v[C+2-32],Ee=v[C+3-32];v[C+0+0]=v[C+1+64]=oe+he+1>>1,v[C+1+0]=v[C+2+64]=he+ge+1>>1,v[C+2+0]=v[C+3+64]=ge+be+1>>1,v[C+3+0]=be+Ee+1>>1,v[C+0+96]=Ni(ie,j,D),v[C+0+64]=Ni(j,D,oe),v[C+0+32]=v[C+1+96]=Ni(D,oe,he),v[C+1+32]=v[C+2+96]=Ni(oe,he,ge),v[C+2+32]=v[C+3+96]=Ni(he,ge,be),v[C+3+32]=Ni(ge,be,Ee)}function K0(v,C){var D=v[C+0-32],j=v[C+1-32],ie=v[C+2-32],oe=v[C+3-32],he=v[C+4-32],ge=v[C+5-32],be=v[C+6-32],Ee=v[C+7-32];v[C+0+0]=D+j+1>>1,v[C+1+0]=v[C+0+64]=j+ie+1>>1,v[C+2+0]=v[C+1+64]=ie+oe+1>>1,v[C+3+0]=v[C+2+64]=oe+he+1>>1,v[C+0+32]=Ni(D,j,ie),v[C+1+32]=v[C+0+96]=Ni(j,ie,oe),v[C+2+32]=v[C+1+96]=Ni(ie,oe,he),v[C+3+32]=v[C+2+96]=Ni(oe,he,ge),v[C+3+64]=Ni(he,ge,be),v[C+3+96]=Ni(ge,be,Ee)}function NR(v,C){var D=v[C-1+0],j=v[C-1+32],ie=v[C-1+64],oe=v[C-1+96];v[C+0+0]=D+j+1>>1,v[C+2+0]=v[C+0+32]=j+ie+1>>1,v[C+2+32]=v[C+0+64]=ie+oe+1>>1,v[C+1+0]=Ni(D,j,ie),v[C+3+0]=v[C+1+32]=Ni(j,ie,oe),v[C+3+32]=v[C+1+64]=Ni(ie,oe,oe),v[C+3+64]=v[C+2+64]=v[C+0+96]=v[C+1+96]=v[C+2+96]=v[C+3+96]=oe}function PR(v,C){var D=v[C-1+0],j=v[C-1+32],ie=v[C-1+64],oe=v[C-1+96],he=v[C-1-32],ge=v[C+0-32],be=v[C+1-32],Ee=v[C+2-32];v[C+0+0]=v[C+2+32]=D+he+1>>1,v[C+0+32]=v[C+2+64]=j+D+1>>1,v[C+0+64]=v[C+2+96]=ie+j+1>>1,v[C+0+96]=oe+ie+1>>1,v[C+3+0]=Ni(ge,be,Ee),v[C+2+0]=Ni(he,ge,be),v[C+1+0]=v[C+3+32]=Ni(D,he,ge),v[C+1+32]=v[C+3+64]=Ni(j,D,he),v[C+1+64]=v[C+3+96]=Ni(ie,j,D),v[C+1+96]=Ni(oe,ie,j)}function LR(v,C){var D;for(D=0;8>D;++D)r(v,C+32*D,v,C-32,8)}function Z0(v,C){var D;for(D=0;8>D;++D)n(v,C,v[C-1],8),C+=32}function Nu(v,C,D){var j;for(j=0;8>j;++j)n(C,D+32*j,v,8)}function Nd(v,C){var D,j=8;for(D=0;8>D;++D)j+=v[C+D-32]+v[C-1+32*D];Nu(j>>4,v,C)}function FR(v,C){var D,j=4;for(D=0;8>D;++D)j+=v[C+D-32];Nu(j>>3,v,C)}function Wh(v,C){var D,j=4;for(D=0;8>D;++D)j+=v[C-1+32*D];Nu(j>>3,v,C)}function Pg(v,C){Nu(128,v,C)}function Lg(v,C,D){var j=v[C-D],ie=v[C+0],oe=3*(ie-j)+BR[1020+v[C-2*D]-v[C+D]],he=Up[112+(oe+4>>3)];v[C-D]=Ol[255+j+Up[112+(oe+3>>3)]],v[C+0]=Ol[255+ie-he]}function TC(v,C,D,j){var ie=v[C+0],oe=v[C+D];return ac[255+v[C-2*D]-v[C-D]]>j||ac[255+oe-ie]>j}function RC(v,C,D,j){return 4*ac[255+v[C-D]-v[C+0]]+ac[255+v[C-2*D]-v[C+D]]<=j}function AC(v,C,D,j,ie){var oe=v[C-3*D],he=v[C-2*D],ge=v[C-D],be=v[C+0],Ee=v[C+D],He=v[C+2*D],Ge=v[C+3*D];return 4*ac[255+ge-be]+ac[255+he-Ee]>j?0:ac[255+v[C-4*D]-oe]<=ie&&ac[255+oe-he]<=ie&&ac[255+he-ge]<=ie&&ac[255+Ge-He]<=ie&&ac[255+He-Ee]<=ie&&ac[255+Ee-be]<=ie}function Q0(v,C,D,j){var ie=2*j+1;for(j=0;16>j;++j)RC(v,C+j,D,ie)&&Lg(v,C+j,D)}function Er(v,C,D,j){var ie=2*j+1;for(j=0;16>j;++j)RC(v,C+j*D,1,ie)&&Lg(v,C+j*D,1)}function Dl(v,C,D,j){var ie;for(ie=3;0<ie;--ie)Q0(v,C+=4*D,D,j)}function Fp(v,C,D,j){var ie;for(ie=3;0<ie;--ie)Er(v,C+=4,D,j)}function Uh(v,C,D,j,ie,oe,he,ge){for(oe=2*oe+1;0<ie--;){if(AC(v,C,D,oe,he))if(TC(v,C,D,ge))Lg(v,C,D);else{var be=v,Ee=C,He=D,Ge=be[Ee-2*He],Xe=be[Ee-He],je=be[Ee+0],nt=be[Ee+He],Je=be[Ee+2*He],Be=27*(ot=BR[1020+3*(je-Xe)+BR[1020+Ge-nt]])+63>>7,Ve=18*ot+63>>7,ot=9*ot+63>>7;be[Ee-3*He]=Ol[255+be[Ee-3*He]+ot],be[Ee-2*He]=Ol[255+Ge+Ve],be[Ee-He]=Ol[255+Xe+Be],be[Ee+0]=Ol[255+je-Be],be[Ee+He]=Ol[255+nt-Ve],be[Ee+2*He]=Ol[255+Je-ot]}C+=j}}function rc(v,C,D,j,ie,oe,he,ge){for(oe=2*oe+1;0<ie--;){if(AC(v,C,D,oe,he))if(TC(v,C,D,ge))Lg(v,C,D);else{var be=v,Ee=C,He=D,Ge=be[Ee-He],Xe=be[Ee+0],je=be[Ee+He],nt=Up[112+((Je=3*(Xe-Ge))+4>>3)],Je=Up[112+(Je+3>>3)],Be=nt+1>>1;be[Ee-2*He]=Ol[255+be[Ee-2*He]+Be],be[Ee-He]=Ol[255+Ge+Je],be[Ee+0]=Ol[255+Xe-nt],be[Ee+He]=Ol[255+je-Be]}C+=j}}function J0(v,C,D,j,ie,oe){Uh(v,C,D,1,16,j,ie,oe)}function Hp(v,C,D,j,ie,oe){Uh(v,C,1,D,16,j,ie,oe)}function Fg(v,C,D,j,ie,oe){var he;for(he=3;0<he;--he)rc(v,C+=4*D,D,1,16,j,ie,oe)}function Ml(v,C,D,j,ie,oe){var he;for(he=3;0<he;--he)rc(v,C+=4,1,D,16,j,ie,oe)}function e_(v,C,D,j,ie,oe,he,ge){Uh(v,C,ie,1,8,oe,he,ge),Uh(D,j,ie,1,8,oe,he,ge)}function t_(v,C,D,j,ie,oe,he,ge){Uh(v,C,1,ie,8,oe,he,ge),Uh(D,j,1,ie,8,oe,he,ge)}function kl(v,C,D,j,ie,oe,he,ge){rc(v,C+4*ie,ie,1,8,oe,he,ge),rc(D,j+4*ie,ie,1,8,oe,he,ge)}function IC(v,C,D,j,ie,oe,he,ge){rc(v,C+4,1,ie,8,oe,he,ge),rc(D,j+4,1,ie,8,oe,he,ge)}function qh(){this.ba=new Bn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ft,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function i_(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function r_(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function DC(){this.ua=0,this.Wa=new Se,this.vb=new Se,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new K,this.yc=new P}function Hg(){this.xb=this.a=0,this.l=new Mg,this.ca=new Bn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new S,this.Pb=0,this.wd=new S,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new DC,this.ab=0,this.gc=s(4,r_),this.Oc=0}function Yh(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Mg,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Bp(v,C,D,j,ie,oe,he){for(v=v==null?0:v[C+0],C=0;C<he;++C)ie[oe+C]=v+D[j+C]&255,v=ie[oe+C]}function n_(v,C,D,j,ie,oe,he){var ge;if(v==null)Bp(null,null,D,j,ie,oe,he);else for(ge=0;ge<he;++ge)ie[oe+ge]=v[C+ge]+D[j+ge]&255}function $h(v,C,D,j,ie,oe,he){if(v==null)Bp(null,null,D,j,ie,oe,he);else{var ge,be=v[C+0],Ee=be,He=be;for(ge=0;ge<he;++ge)Ee=He+(be=v[C+ge])-Ee,He=D[j+ge]+(-256&Ee?0>Ee?0:255:Ee)&255,Ee=be,ie[oe+ge]=He}}function Bg(v,C,D,j){var ie=C.width,oe=C.o;if(e(v!=null&&C!=null),0>D||0>=j||D+j>oe)return null;if(!v.Cc){if(v.ga==null){var he;if(v.ga=new Yh,(he=v.ga==null)||(he=C.width*C.o,e(v.Gb.length==0),v.Gb=o(he),v.Uc=0,v.Gb==null?he=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,he=1),he=!he),!he){he=v.ga;var ge=v.Fa,be=v.P,Ee=v.qc,He=v.mb,Ge=v.nb,Xe=be+1,je=Ee-1,nt=he.l;if(e(ge!=null&&He!=null&&C!=null),of[0]=null,of[1]=Bp,of[2]=n_,of[3]=$h,he.ca=He,he.tb=Ge,he.c=C.width,he.i=C.height,e(0<he.c&&0<he.i),1>=Ee)C=0;else if(he.$a=ge[be+0]>>0&3,he.Z=ge[be+0]>>2&3,he.Lc=ge[be+0]>>4&3,be=ge[be+0]>>6&3,0>he.$a||1<he.$a||4<=he.Z||1<he.Lc||be)C=0;else if(nt.put=Oi,nt.ac=nn,nt.bc=ec,nt.ma=he,nt.width=C.width,nt.height=C.height,nt.Da=C.Da,nt.v=C.v,nt.va=C.va,nt.j=C.j,nt.o=C.o,he.$a)e:{e(he.$a==1),C=Gs();t:for(;;){if(C==null){C=0;break e}if(e(he!=null),he.mc=C,C.c=he.c,C.i=he.i,C.l=he.l,C.l.ma=he,C.l.width=he.c,C.l.height=he.i,C.a=0,te(C.m,ge,Xe,je),!qc(he.c,he.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&Qo(C.s)?(he.ic=1,ge=C.c*C.i,C.Ta=null,C.Ua=0,C.V=o(ge),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(he.ic=0,C=Np(C,he.c)),!C))break t;C=1;break e}he.mc=null,C=0}else C=je>=he.c*he.i;he=!C}if(he)return null;v.ga.Lc!=1?v.Ga=0:j=oe-D}e(v.ga!=null),e(D+j<=oe);e:{if(C=(ge=v.ga).c,oe=ge.l.o,ge.$a==0){if(Xe=v.rc,je=v.Vc,nt=v.Fa,be=v.P+1+D*C,Ee=v.mb,He=v.nb+D*C,e(be<=v.P+v.qc),ge.Z!=0)for(e(of[ge.Z]!=null),he=0;he<j;++he)of[ge.Z](Xe,je,nt,be,Ee,He,C),Xe=Ee,je=He,He+=C,be+=C;else for(he=0;he<j;++he)r(Ee,He,nt,be,C),Xe=Ee,je=He,He+=C,be+=C;v.rc=Xe,v.Vc=je}else{if(e(ge.mc!=null),C=D+j,e((he=ge.mc)!=null),e(C<=he.i),he.C>=C)C=1;else if(ge.ic||qe(),ge.ic){ge=he.V,Xe=he.Ba,je=he.c;var Je=he.i,Be=(nt=1,be=he.$/je,Ee=he.$%je,He=he.m,Ge=he.s,he.$),Ve=je*Je,ot=je*C,ut=Ge.wc,at=Be<ot?on(Ge,Ee,be):null;e(Be<=Ve),e(C<=Je),e(Qo(Ge));t:for(;;){for(;!He.h&&Be<ot;){if(Ee&ut||(at=on(Ge,Ee,be)),e(at!=null),le(He),256>(Je=ks(at.G[0],at.H[0],He)))ge[Xe+Be]=Je,++Be,++Ee>=je&&(Ee=0,++be<=C&&!(be%16)&&Os(he,be));else{if(!(280>Je)){nt=0;break t}Je=ba(Je-256,He);var Wt,Et=ks(at.G[4],at.H[4],He);if(le(He),!(Be>=(Et=Dd(je,Et=ba(Et,He)))&&Ve-Be>=Je)){nt=0;break t}for(Wt=0;Wt<Je;++Wt)ge[Xe+Be+Wt]=ge[Xe+Be+Wt-Et];for(Be+=Je,Ee+=Je;Ee>=je;)Ee-=je,++be<=C&&!(be%16)&&Os(he,be);Be<ot&&Ee&ut&&(at=on(Ge,Ee,be))}e(He.h==X(He))}Os(he,be>C?C:be);break t}!nt||He.h&&Be<Ve?(nt=0,he.a=He.h?5:3):he.$=Be,C=nt}else C=Uc(he,he.V,he.Ba,he.c,he.i,C,Yc);if(!C){j=0;break e}}D+j>=oe&&(v.Cc=1),j=1}if(!j)return null;if(v.Cc&&((j=v.ga)!=null&&(j.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+D*ie}function R(v,C,D,j,ie,oe){for(;0<ie--;){var he,ge=v,be=C+(D?1:0),Ee=v,He=C+(D?0:3);for(he=0;he<j;++he){var Ge=Ee[He+4*he];Ge!=255&&(Ge*=32897,ge[be+4*he+0]=ge[be+4*he+0]*Ge>>23,ge[be+4*he+1]=ge[be+4*he+1]*Ge>>23,ge[be+4*he+2]=ge[be+4*he+2]*Ge>>23)}C+=oe}}function re(v,C,D,j,ie){for(;0<j--;){var oe;for(oe=0;oe<D;++oe){var he=v[C+2*oe+0],ge=15&(Ee=v[C+2*oe+1]),be=4369*ge,Ee=(240&Ee|Ee>>4)*be>>16;v[C+2*oe+0]=(240&he|he>>4)*be>>16&240|(15&he|he<<4)*be>>16>>4&15,v[C+2*oe+1]=240&Ee|ge}C+=ie}}function De(v,C,D,j,ie,oe,he,ge){var be,Ee,He=255;for(Ee=0;Ee<ie;++Ee){for(be=0;be<j;++be){var Ge=v[C+be];oe[he+4*be]=Ge,He&=Ge}C+=D,he+=ge}return He!=255}function Fe(v,C,D,j,ie){var oe;for(oe=0;oe<ie;++oe)D[j+oe]=v[C+oe]>>8}function qe(){sc=R,xn=re,Sn=De,To=Fe}function tt(v,C,D){O[v]=function(j,ie,oe,he,ge,be,Ee,He,Ge,Xe,je,nt,Je,Be,Ve,ot,ut){var at,Wt=ut-1>>1,Et=ge[be+0]|Ee[He+0]<<16,vi=Ge[Xe+0]|je[nt+0]<<16;e(j!=null);var xt=3*Et+vi+131074>>2;for(C(j[ie+0],255&xt,xt>>16,Je,Be),oe!=null&&(xt=3*vi+Et+131074>>2,C(oe[he+0],255&xt,xt>>16,Ve,ot)),at=1;at<=Wt;++at){var Dr=ge[be+at]|Ee[He+at]<<16,qr=Ge[Xe+at]|je[nt+at]<<16,Tr=Et+Dr+vi+qr+524296,dr=Tr+2*(Dr+vi)>>3;xt=dr+Et>>1,Et=(Tr=Tr+2*(Et+qr)>>3)+Dr>>1,C(j[ie+2*at-1],255&xt,xt>>16,Je,Be+(2*at-1)*D),C(j[ie+2*at-0],255&Et,Et>>16,Je,Be+(2*at-0)*D),oe!=null&&(xt=Tr+vi>>1,Et=dr+qr>>1,C(oe[he+2*at-1],255&xt,xt>>16,Ve,ot+(2*at-1)*D),C(oe[he+2*at+0],255&Et,Et>>16,Ve,ot+(2*at+0)*D)),Et=Dr,vi=qr}1&ut||(xt=3*Et+vi+131074>>2,C(j[ie+ut-1],255&xt,xt>>16,Je,Be+(ut-1)*D),oe!=null&&(xt=3*vi+Et+131074>>2,C(oe[he+ut-1],255&xt,xt>>16,Ve,ot+(ut-1)*D)))}}function pt(){lc[PC]=Jz,lc[LC]=zC,lc[BP]=eW,lc[FC]=qP,lc[HC]=YP,lc[VR]=$P,lc[jR]=UR,lc[BC]=zC,lc[VC]=qP,lc[qp]=YP,lc[rf]=$P}function It(v){return v&~tW?0>v?0:255:v>>GP}function ui(v,C){return It((19077*v>>8)+(26149*C>>8)-14234)}function Pi(v,C,D){return It((19077*v>>8)-(6419*C>>8)-(13320*D>>8)+8708)}function Fi(v,C){return It((19077*v>>8)+(33050*C>>8)-17685)}function cr(v,C,D,j,ie){j[ie+0]=ui(v,D),j[ie+1]=Pi(v,C,D),j[ie+2]=Fi(v,C)}function Jn(v,C,D,j,ie){j[ie+0]=Fi(v,C),j[ie+1]=Pi(v,C,D),j[ie+2]=ui(v,D)}function mo(v,C,D,j,ie){var oe=Pi(v,C,D);C=oe<<3&224|Fi(v,C)>>3,j[ie+0]=248&ui(v,D)|oe>>5,j[ie+1]=C}function Fo(v,C,D,j,ie){var oe=240&Fi(v,C)|15;j[ie+0]=240&ui(v,D)|Pi(v,C,D)>>4,j[ie+1]=oe}function Ks(v,C,D,j,ie){j[ie+0]=255,cr(v,C,D,j,ie+1)}function es(v,C,D,j,ie){Jn(v,C,D,j,ie),j[ie+3]=255}function $c(v,C,D,j,ie){cr(v,C,D,j,ie),j[ie+3]=255}function Ga(v,C){return 0>v?0:v>C?C:v}function xr(v,C,D){O[v]=function(j,ie,oe,he,ge,be,Ee,He,Ge){for(var Xe=He+(-2&Ge)*D;He!=Xe;)C(j[ie+0],oe[he+0],ge[be+0],Ee,He),C(j[ie+1],oe[he+0],ge[be+0],Ee,He+D),ie+=2,++he,++be,He+=2*D;1&Ge&&C(j[ie+0],oe[he+0],ge[be+0],Ee,He)}}function MC(v,C,D){return D==0?v==0?C==0?6:5:C==0?4:0:D}function o_(v,C,D,j,ie){switch(v>>>30){case 3:Hu(C,D,j,ie,0);break;case 2:go(C,D,j,ie);break;case 1:ya(C,D,j,ie)}}function Vg(v,C){var D,j,ie=C.M,oe=C.Nb,he=v.oc,ge=v.pc+40,be=v.oc,Ee=v.pc+584,He=v.oc,Ge=v.pc+600;for(D=0;16>D;++D)he[ge+32*D-1]=129;for(D=0;8>D;++D)be[Ee+32*D-1]=129,He[Ge+32*D-1]=129;for(0<ie?he[ge-1-32]=be[Ee-1-32]=He[Ge-1-32]=129:(n(he,ge-32-1,127,21),n(be,Ee-32-1,127,9),n(He,Ge-32-1,127,9)),j=0;j<v.za;++j){var Xe=C.ya[C.aa+j];if(0<j){for(D=-1;16>D;++D)r(he,ge+32*D-4,he,ge+32*D+12,4);for(D=-1;8>D;++D)r(be,Ee+32*D-4,be,Ee+32*D+4,4),r(He,Ge+32*D-4,He,Ge+32*D+4,4)}var je=v.Gd,nt=v.Hd+j,Je=Xe.ad,Be=Xe.Hc;if(0<ie&&(r(he,ge-32,je[nt].y,0,16),r(be,Ee-32,je[nt].f,0,8),r(He,Ge-32,je[nt].ea,0,8)),Xe.Za){var Ve=he,ot=ge-32+16;for(0<ie&&(j>=v.za-1?n(Ve,ot,je[nt].y[15],4):r(Ve,ot,je[nt+1].y,0,4)),D=0;4>D;D++)Ve[ot+128+D]=Ve[ot+256+D]=Ve[ot+384+D]=Ve[ot+0+D];for(D=0;16>D;++D,Be<<=2)Ve=he,ot=ge+QP[D],Gc[Xe.Ob[D]](Ve,ot),o_(Be,Je,16*+D,Ve,ot)}else if(Ve=MC(j,ie,Xe.Ob[0]),nf[Ve](he,ge),Be!=0)for(D=0;16>D;++D,Be<<=2)o_(Be,Je,16*+D,he,ge+QP[D]);for(D=Xe.Gc,Ve=MC(j,ie,Xe.Dd),Vu[Ve](be,Ee),Vu[Ve](He,Ge),Be=Je,Ve=be,ot=Ee,255&(Xe=D>>0)&&(170&Xe?l_(Be,256,Ve,ot):vo(Be,256,Ve,ot)),Xe=He,Be=Ge,255&(D>>=8)&&(170&D?l_(Je,320,Xe,Be):vo(Je,320,Xe,Be)),ie<v.Ub-1&&(r(je[nt].y,0,he,ge+480,16),r(je[nt].f,0,be,Ee+224,8),r(je[nt].ea,0,He,Ge+224,8)),D=8*oe*v.B,je=v.sa,nt=v.ta+16*j+16*oe*v.R,Je=v.qa,Xe=v.ra+8*j+D,Be=v.Ha,Ve=v.Ia+8*j+D,D=0;16>D;++D)r(je,nt+D*v.R,he,ge+32*D,16);for(D=0;8>D;++D)r(Je,Xe+D*v.B,be,Ee+32*D,8),r(Be,Ve+D*v.B,He,Ge+32*D,8)}}function jg(v,C,D,j,ie,oe,he,ge,be){var Ee=[0],He=[0],Ge=0,Xe=be!=null?be.kd:0,je=be??new i_;if(v==null||12>D)return 7;je.data=v,je.w=C,je.ha=D,C=[C],D=[D],je.gb=[je.gb];e:{var nt=C,Je=D,Be=je.gb;if(e(v!=null),e(Je!=null),e(Be!=null),Be[0]=0,12<=Je[0]&&!i(v,nt[0],"RIFF")){if(i(v,nt[0]+8,"WEBP")){Be=3;break e}var Ve=it(v,nt[0]+4);if(12>Ve||4294967286<Ve){Be=3;break e}if(Xe&&Ve>Je[0]-8){Be=7;break e}Be[0]=Ve,nt[0]+=12,Je[0]-=12}Be=0}if(Be!=0)return Be;for(Ve=0<je.gb[0],D=D[0];;){e:{var ot=v;Je=C,Be=D;var ut=Ee,at=He,Wt=nt=[0];if((xt=Ge=[Ge])[0]=0,8>Be[0])Be=7;else{if(!i(ot,Je[0],"VP8X")){if(it(ot,Je[0]+4)!=10){Be=3;break e}if(18>Be[0]){Be=7;break e}var Et=it(ot,Je[0]+8),vi=1+Ne(ot,Je[0]+12);if(2147483648<=vi*(ot=1+Ne(ot,Je[0]+15))){Be=3;break e}Wt!=null&&(Wt[0]=Et),ut!=null&&(ut[0]=vi),at!=null&&(at[0]=ot),Je[0]+=18,Be[0]-=18,xt[0]=1}Be=0}}if(Ge=Ge[0],nt=nt[0],Be!=0)return Be;if(Je=!!(2&nt),!Ve&&Ge)return 3;if(oe!=null&&(oe[0]=!!(16&nt)),he!=null&&(he[0]=Je),ge!=null&&(ge[0]=0),he=Ee[0],nt=He[0],Ge&&Je&&be==null){Be=0;break}if(4>D){Be=7;break}if(Ve&&Ge||!Ve&&!Ge&&!i(v,C[0],"ALPH")){D=[D],je.na=[je.na],je.P=[je.P],je.Sa=[je.Sa];e:{Et=v,Be=C,Ve=D;var xt=je.gb;ut=je.na,at=je.P,Wt=je.Sa,vi=22,e(Et!=null),e(Ve!=null),ot=Be[0];var Dr=Ve[0];for(e(ut!=null),e(Wt!=null),ut[0]=null,at[0]=null,Wt[0]=0;;){if(Be[0]=ot,Ve[0]=Dr,8>Dr){Be=7;break e}var qr=it(Et,ot+4);if(4294967286<qr){Be=3;break e}var Tr=8+qr+1&-2;if(vi+=Tr,0<xt&&vi>xt){Be=3;break e}if(!i(Et,ot,"VP8 ")||!i(Et,ot,"VP8L")){Be=0;break e}if(Dr[0]<Tr){Be=7;break e}i(Et,ot,"ALPH")||(ut[0]=Et,at[0]=ot+8,Wt[0]=qr),ot+=Tr,Dr-=Tr}}if(D=D[0],je.na=je.na[0],je.P=je.P[0],je.Sa=je.Sa[0],Be!=0)break}D=[D],je.Ja=[je.Ja],je.xa=[je.xa];e:if(xt=v,Be=C,Ve=D,ut=je.gb[0],at=je.Ja,Wt=je.xa,Et=Be[0],ot=!i(xt,Et,"VP8 "),vi=!i(xt,Et,"VP8L"),e(xt!=null),e(Ve!=null),e(at!=null),e(Wt!=null),8>Ve[0])Be=7;else{if(ot||vi){if(xt=it(xt,Et+4),12<=ut&&xt>ut-12){Be=3;break e}if(Xe&&xt>Ve[0]-8){Be=7;break e}at[0]=xt,Be[0]+=8,Ve[0]-=8,Wt[0]=vi}else Wt[0]=5<=Ve[0]&&xt[Et+0]==47&&!(xt[Et+4]>>5),at[0]=Ve[0];Be=0}if(D=D[0],je.Ja=je.Ja[0],je.xa=je.xa[0],C=C[0],Be!=0)break;if(4294967286<je.Ja)return 3;if(ge==null||Je||(ge[0]=je.xa?2:1),he=[he],nt=[nt],je.xa){if(5>D){Be=7;break}ge=he,Xe=nt,Je=oe,v==null||5>D?v=0:5<=D&&v[C+0]==47&&!(v[C+4]>>5)?(Ve=[0],xt=[0],ut=[0],te(at=new S,v,C,D),Rt(at,Ve,xt,ut)?(ge!=null&&(ge[0]=Ve[0]),Xe!=null&&(Xe[0]=xt[0]),Je!=null&&(Je[0]=ut[0]),v=1):v=0):v=0}else{if(10>D){Be=7;break}ge=nt,v==null||10>D||!U0(v,C+3,D-3)?v=0:(Xe=v[C+0]|v[C+1]<<8|v[C+2]<<16,Je=16383&(v[C+7]<<8|v[C+6]),v=16383&(v[C+9]<<8|v[C+8]),1&Xe||3<(Xe>>1&7)||!(Xe>>4&1)||Xe>>5>=je.Ja||!Je||!v?v=0:(he&&(he[0]=Je),ge&&(ge[0]=v),v=1))}if(!v||(he=he[0],nt=nt[0],Ge&&(Ee[0]!=he||He[0]!=nt)))return 3;be!=null&&(be[0]=je,be.offset=C-be.w,e(4294967286>C-be.w),e(be.offset==be.ha-D));break}return Be==0||Be==7&&Ge&&be==null?(oe!=null&&(oe[0]|=je.na!=null&&0<je.na.length),j!=null&&(j[0]=he),ie!=null&&(ie[0]=nt),0):Be}function s_(v,C,D){var j=C.width,ie=C.height,oe=0,he=0,ge=j,be=ie;if(C.Da=v!=null&&0<v.Da,C.Da&&(ge=v.cd,be=v.bd,oe=v.v,he=v.j,11>D||(oe&=-2,he&=-2),0>oe||0>he||0>=ge||0>=be||oe+ge>j||he+be>ie))return 0;if(C.v=oe,C.j=he,C.va=oe+ge,C.o=he+be,C.U=ge,C.T=be,C.da=v!=null&&0<v.da,C.da){if(!gt(ge,be,D=[v.ib],oe=[v.hb]))return 0;C.ib=D[0],C.hb=oe[0]}return C.ob=v!=null&&v.ob,C.Kb=v==null||!v.Sd,C.da&&(C.ob=C.ib<3*j/4&&C.hb<3*ie/4,C.Kb=0),1}function a_(v){if(v==null)return 2;if(11>v.S){var C=v.f.RGBA;C.fb+=(v.height-1)*C.A,C.A=-C.A}else C=v.f.kb,v=v.height,C.O+=(v-1)*C.fa,C.fa=-C.fa,C.N+=(v-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(v-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(v-1)*C.lb,C.lb=-C.lb);return 0}function Pd(v,C,D,j){if(j==null||0>=v||0>=C)return 2;if(D!=null){if(D.Da){var ie=D.cd,oe=D.bd,he=-2&D.v,ge=-2&D.j;if(0>he||0>ge||0>=ie||0>=oe||he+ie>v||ge+oe>C)return 2;v=ie,C=oe}if(D.da){if(!gt(v,C,ie=[D.ib],oe=[D.hb]))return 2;v=ie[0],C=oe[0]}}j.width=v,j.height=C;e:{var be=j.width,Ee=j.height;if(v=j.S,0>=be||0>=Ee||!(v>=PC&&13>v))v=2;else{if(0>=j.Rd&&j.sd==null){he=oe=ie=C=0;var He=(ge=be*eL[v])*Ee;if(11>v||(oe=(Ee+1)/2*(C=(be+1)/2),v==12&&(he=(ie=be)*Ee)),(Ee=o(He+2*oe+he))==null){v=1;break e}j.sd=Ee,11>v?((be=j.f.RGBA).eb=Ee,be.fb=0,be.A=ge,be.size=He):((be=j.f.kb).y=Ee,be.O=0,be.fa=ge,be.Fd=He,be.f=Ee,be.N=0+He,be.Ab=C,be.Cd=oe,be.ea=Ee,be.W=0+He+oe,be.Db=C,be.Ed=oe,v==12&&(be.F=Ee,be.J=0+He+2*oe),be.Tc=he,be.lb=ie)}if(C=1,ie=j.S,oe=j.width,he=j.height,ie>=PC&&13>ie)if(11>ie)v=j.f.RGBA,C&=(ge=Math.abs(v.A))*(he-1)+oe<=v.size,C&=ge>=oe*eL[ie],C&=v.eb!=null;else{v=j.f.kb,ge=(oe+1)/2,He=(he+1)/2,be=Math.abs(v.fa),Ee=Math.abs(v.Ab);var Ge=Math.abs(v.Db),Xe=Math.abs(v.lb),je=Xe*(he-1)+oe;C&=be*(he-1)+oe<=v.Fd,C&=Ee*(He-1)+ge<=v.Cd,C=(C&=Ge*(He-1)+ge<=v.Ed)&be>=oe&Ee>=ge&Ge>=ge,C&=v.y!=null,C&=v.f!=null,C&=v.ea!=null,ie==12&&(C&=Xe>=oe,C&=je<=v.Tc,C&=v.F!=null)}else C=0;v=C?0:2}}return v!=0||D!=null&&D.fd&&(v=a_(j)),v}var Ns=64,zg=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Wg=24,Pu=32,Gh=8,Zs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ye("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(v){return v},O.Predictor2=function(v,C,D){return C[D+0]},O.Predictor3=function(v,C,D){return C[D+1]},O.Predictor4=function(v,C,D){return C[D-1]},O.Predictor5=function(v,C,D){return pe(pe(v,C[D+1]),C[D+0])},O.Predictor6=function(v,C,D){return pe(v,C[D-1])},O.Predictor7=function(v,C,D){return pe(v,C[D+0])},O.Predictor8=function(v,C,D){return pe(C[D-1],C[D+0])},O.Predictor9=function(v,C,D){return pe(C[D+0],C[D+1])},O.Predictor10=function(v,C,D){return pe(pe(v,C[D-1]),pe(C[D+0],C[D+1]))},O.Predictor11=function(v,C,D){var j=C[D+0];return 0>=L(j>>24&255,v>>24&255,(C=C[D-1])>>24&255)+L(j>>16&255,v>>16&255,C>>16&255)+L(j>>8&255,v>>8&255,C>>8&255)+L(255&j,255&v,255&C)?j:v},O.Predictor12=function(v,C,D){var j=C[D+0];return(ue((v>>24&255)+(j>>24&255)-((C=C[D-1])>>24&255))<<24|ue((v>>16&255)+(j>>16&255)-(C>>16&255))<<16|ue((v>>8&255)+(j>>8&255)-(C>>8&255))<<8|ue((255&v)+(255&j)-(255&C)))>>>0},O.Predictor13=function(v,C,D){var j=C[D-1];return(A((v=pe(v,C[D+0]))>>24&255,j>>24&255)<<24|A(v>>16&255,j>>16&255)<<16|A(v>>8&255,j>>8&255)<<8|A(v>>0&255,j>>0&255))>>>0};var HR=O.PredictorAdd0;O.PredictorAdd1=Y,ye("Predictor2","PredictorAdd2"),ye("Predictor3","PredictorAdd3"),ye("Predictor4","PredictorAdd4"),ye("Predictor5","PredictorAdd5"),ye("Predictor6","PredictorAdd6"),ye("Predictor7","PredictorAdd7"),ye("Predictor8","PredictorAdd8"),ye("Predictor9","PredictorAdd9"),ye("Predictor10","PredictorAdd10"),ye("Predictor11","PredictorAdd11"),ye("Predictor12","PredictorAdd12"),ye("Predictor13","PredictorAdd13");var Ug=O.PredictorAdd2;ke("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),ke("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var kC,Xa=O.ColorIndexInverseTransform,Xh=O.MapARGB,qg=O.VP8LColorIndexInverseTransformAlpha,OC=O.MapAlpha,Kh=O.VP8LPredictorsAdd=[];Kh.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var Vp,Ka,_a,Zh,Lu,Fu,Yg,Hu,go,l_,ya,vo,nc,c_,d_,Qh,Jh,ef,jp,zp,Wp,tf,u_,oc,sc,xn,Sn,To,ts=o(511),Bu=o(2041),h_=o(225),$g=o(767),NC=0,BR=Bu,Up=h_,Ol=$g,ac=ts,PC=0,LC=1,BP=2,FC=3,HC=4,VR=5,jR=6,BC=7,VC=8,qp=9,rf=10,jC=[2,3,7],VP=[3,3,11],Yp=[280,256,256,256,40],jP=[0,1,1,1,0],zP=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Wz=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Uz=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],qz=8,zR=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],WR=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],f_=null,Yz=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],$z=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],WP=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Gz=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Xz=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Kz=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Zz=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],nf=[],Gc=[],Vu=[],Qz=1,UP=2,of=[],lc=[];tt("UpsampleRgbLinePair",cr,3),tt("UpsampleBgrLinePair",Jn,3),tt("UpsampleRgbaLinePair",$c,4),tt("UpsampleBgraLinePair",es,4),tt("UpsampleArgbLinePair",Ks,4),tt("UpsampleRgba4444LinePair",Fo,2),tt("UpsampleRgb565LinePair",mo,2);var Jz=O.UpsampleRgbLinePair,eW=O.UpsampleBgrLinePair,zC=O.UpsampleRgbaLinePair,qP=O.UpsampleBgraLinePair,YP=O.UpsampleArgbLinePair,$P=O.UpsampleRgba4444LinePair,UR=O.UpsampleRgb565LinePair,$p=16,WC=1<<$p-1,p_=-227,qR=482,GP=6,tW=(256<<GP)-1,XP=0,KP=o(256),iW=o(256),rW=o(256),ZP=o(256),nW=o(qR-p_),oW=o(qR-p_);xr("YuvToRgbRow",cr,3),xr("YuvToBgrRow",Jn,3),xr("YuvToRgbaRow",$c,4),xr("YuvToBgraRow",es,4),xr("YuvToArgbRow",Ks,4),xr("YuvToRgba4444Row",Fo,2),xr("YuvToRgb565Row",mo,2);var QP=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Xc=[0,2,8],JP=[8,7,6,4,4,2,2,2,1,1,1,1],sW=1;this.WebPDecodeRGBA=function(v,C,D,j,ie){var oe=LC,he=new qh,ge=new Bn;he.ba=ge,ge.S=oe,ge.width=[ge.width],ge.height=[ge.height];var be=ge.width,Ee=ge.height,He=new vs;if(He==null||v==null)var Ge=2;else e(He!=null),Ge=jg(v,C,D,He.width,He.height,He.Pd,He.Qd,He.format,null);if(Ge!=0?be=0:(be!=null&&(be[0]=He.width[0]),Ee!=null&&(Ee[0]=He.height[0]),be=1),be){ge.width=ge.width[0],ge.height=ge.height[0],j!=null&&(j[0]=ge.width),ie!=null&&(ie[0]=ge.height);e:{if(j=new Mg,(ie=new i_).data=v,ie.w=C,ie.ha=D,ie.kd=1,C=[0],e(ie!=null),((v=jg(ie.data,ie.w,ie.ha,null,null,null,C,null,ie))==0||v==7)&&C[0]&&(v=4),(C=v)==0){if(e(he!=null),j.data=ie.data,j.w=ie.w+ie.offset,j.ha=ie.ha-ie.offset,j.put=Oi,j.ac=nn,j.bc=ec,j.ma=he,ie.xa){if((v=Gs())==null){he=1;break e}if(function(Xe,je){var nt=[0],Je=[0],Be=[0];t:for(;;){if(Xe==null)return 0;if(je==null)return Xe.a=2,0;if(Xe.l=je,Xe.a=0,te(Xe.m,je.data,je.w,je.ha),!Rt(Xe.m,nt,Je,Be)){Xe.a=3;break t}if(Xe.xb=UP,je.width=nt[0],je.height=Je[0],!qc(nt[0],Je[0],1,Xe,null))break t;return 1}return e(Xe.a!=0),0}(v,j)){if(j=(C=Pd(j.width,j.height,he.Oa,he.ba))==0){t:{j=v;i:for(;;){if(j==null){j=0;break t}if(e(j.s.yc!=null),e(j.s.Ya!=null),e(0<j.s.Wb),e((D=j.l)!=null),e((ie=D.ma)!=null),j.xb!=0){if(j.ca=ie.ba,j.tb=ie.tb,e(j.ca!=null),!s_(ie.Oa,D,FC)){j.a=2;break i}if(!Np(j,D.width)||D.da)break i;if((D.da||fi(j.ca.S))&&qe(),11>j.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),j.ca.f.kb.F!=null&&qe()),j.Pb&&0<j.s.ua&&j.s.vb.X==null&&!ct(j.s.vb,j.s.Wa.Xa)){j.a=1;break i}j.xb=0}if(!Uc(j,j.V,j.Ba,j.c,j.i,D.o,Vn))break i;ie.Dc=j.Ma,j=1;break t}e(j.a!=0),j=0}j=!j}j&&(C=v.a)}else C=v.a}else{if((v=new SR)==null){he=1;break e}if(v.Fa=ie.na,v.P=ie.P,v.qc=ie.Sa,q0(v,j)){if((C=Pd(j.width,j.height,he.Oa,he.ba))==0){if(v.Aa=0,D=he.Oa,e((ie=v)!=null),D!=null){if(0<(be=0>(be=D.Md)?0:100<be?255:255*be/100)){for(Ee=He=0;4>Ee;++Ee)12>(Ge=ie.pb[Ee]).lc&&(Ge.ia=be*JP[0>Ge.lc?0:Ge.lc]>>3),He|=Ge.ia;He&&(alert("todo:VP8InitRandom"),ie.ia=1)}ie.Ga=D.Id,100<ie.Ga?ie.Ga=100:0>ie.Ga&&(ie.Ga=0)}ER(v,j)||(C=v.a)}}else C=v.a}C==0&&he.Oa!=null&&he.Oa.fd&&(C=a_(he.ba))}he=C}oe=he!=0?null:11>oe?ge.f.RGBA.eb:ge.f.kb.y}else oe=null;return oe};var eL=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(O,V){for(var J="",N=0;N<4;N++)J+=String.fromCharCode(O[V++]);return J}function u(O,V){return(O[V+0]<<0|O[V+1]<<8|O[V+2]<<16)>>>0}function h(O,V){return(O[V+0]<<0|O[V+1]<<8|O[V+2]<<16|O[V+3]<<24)>>>0}new c;var p=[0],f=[0],m=[],g=new c,y=t,w=function(O,V){var J={},N=0,P=!1,$=0,K=0;if(J.frames=[],!function(I,X,Q,le){for(var xe=0;xe<le;xe++)if(I[X+xe]!=Q.charCodeAt(xe))return!0;return!1}(O,V,"RIFF",4)){var ve,W;for(h(O,V+=4),V+=8;V<O.length;){var ee=d(O,V),te=h(O,V+=4);V+=4;var se=te+(1&te);switch(ee){case"VP8 ":case"VP8L":J.frames[N]===void 0&&(J.frames[N]={}),(S=J.frames[N]).src_off=P?K:V-8,S.src_size=$+te+8,N++,P&&(P=!1,$=0,K=0);break;case"VP8X":(S=J.header={}).feature_flags=O[V];var Ae=V+4;S.canvas_width=1+u(O,Ae),Ae+=3,S.canvas_height=1+u(O,Ae),Ae+=3;break;case"ALPH":P=!0,$=se+8,K=V-8;break;case"ANIM":(S=J.header).bgcolor=h(O,V),Ae=V+4,S.loop_count=(ve=O)[(W=Ae)+0]<<0|ve[W+1]<<8,Ae+=2;break;case"ANMF":var k,S;(S=J.frames[N]={}).offset_x=2*u(O,V),V+=3,S.offset_y=2*u(O,V),V+=3,S.width=1+u(O,V),V+=3,S.height=1+u(O,V),V+=3,S.duration=u(O,V),V+=3,k=O[V++],S.dispose=1&k,S.blend=k>>1&1}ee!="ANMF"&&(V+=se)}return J}}(y,0);w.response=y,w.rgbaoutput=!0,w.dataurl=!1;var x=w.header?w.header:null,T=w.frames?w.frames:null;if(x){x.loop_counter=x.loop_count,p=[x.canvas_height],f=[x.canvas_width];for(var M=0;M<T.length&&T[M].blend!=0;M++);}var B=T[0],G=g.WebPDecodeRGBA(y,B.src_off,B.src_size,f,p);B.rgba=G,B.imgwidth=f[0],B.imgheight=p[0];for(var F=0;F<f[0]*p[0]*4;F++)m[F]=G[F];return this.width=f,this.height=p,this.data=m,this}(function(t){var e=function(){return typeof Rz=="function"},i=function(p,f,m,g){var y=4,w=s;switch(g){case t.image_compression.FAST:y=1,w=o;break;case t.image_compression.MEDIUM:y=6,w=a;break;case t.image_compression.SLOW:y=9,w=c}p=r(p,f,m,w);var x=Rz(p,{level:y});return t.__addimage__.arrayBufferToBinaryString(x)},r=function(p,f,m,g){for(var y,w,x,T=p.length/f,M=new Uint8Array(p.length+T),B=u(),G=0;G<T;G+=1){if(x=G*f,y=p.subarray(x,x+f),g)M.set(g(y,m,w),x+G);else{for(var F,O=B.length,V=[];F<O;F+=1)V[F]=B[F](y,m,w);var J=h(V.concat());M.set(V[J],x+G)}w=y}return M},n=function(p){var f=Array.apply([],p);return f.unshift(0),f},o=function(p,f){var m,g=[],y=p.length;g[0]=1;for(var w=0;w<y;w+=1)m=p[w-f]||0,g[w+1]=p[w]-m+256&255;return g},s=function(p,f,m){var g,y=[],w=p.length;y[0]=2;for(var x=0;x<w;x+=1)g=m&&m[x]||0,y[x+1]=p[x]-g+256&255;return y},a=function(p,f,m){var g,y,w=[],x=p.length;w[0]=3;for(var T=0;T<x;T+=1)g=p[T-f]||0,y=m&&m[T]||0,w[T+1]=p[T]+256-(g+y>>>1)&255;return w},c=function(p,f,m){var g,y,w,x,T=[],M=p.length;T[0]=4;for(var B=0;B<M;B+=1)g=p[B-f]||0,y=m&&m[B]||0,w=m&&m[B-f]||0,x=d(g,y,w),T[B+1]=p[B]-x+256&255;return T},d=function(p,f,m){if(p===f&&f===m)return p;var g=Math.abs(f-m),y=Math.abs(p-m),w=Math.abs(p+f-m-m);return g<=y&&g<=w?p:y<=w?f:m},u=function(){return[n,o,s,a,c]},h=function(p){var f=p.map(function(m){return m.reduce(function(g,y){return g+Math.abs(y)},0)});return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(p,f,m,g){var y,w,x,T,M,B,G,F,O,V,J,N,P,$,K,ve=this.decode.FLATE_DECODE,W="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(x=new YGt(p)).imgData,w=x.bits,y=x.colorSpace,M=x.colors,[4,6].indexOf(x.colorType)!==-1){if(x.bits===8){O=(F=x.pixelBitlength==32?new Uint32Array(x.decodePixels().buffer):x.pixelBitlength==16?new Uint16Array(x.decodePixels().buffer):new Uint8Array(x.decodePixels().buffer)).length,J=new Uint8Array(O*x.colors),V=new Uint8Array(O);var ee,te=x.pixelBitlength-x.bits;for($=0,K=0;$<O;$++){for(P=F[$],ee=0;ee<te;)J[K++]=P>>>ee&255,ee+=x.bits;V[$]=P>>>ee&255}}if(x.bits===16){O=(F=new Uint32Array(x.decodePixels().buffer)).length,J=new Uint8Array(O*(32/x.pixelBitlength)*x.colors),V=new Uint8Array(O*(32/x.pixelBitlength)),N=x.colors>1,$=0,K=0;for(var se=0;$<O;)P=F[$++],J[K++]=P>>>0&255,N&&(J[K++]=P>>>16&255,P=F[$++],J[K++]=P>>>0&255),V[se++]=P>>>16&255;w=8}g!==t.image_compression.NONE&&e()?(p=i(J,x.width*x.colors,x.colors,g),G=i(V,x.width,1,g)):(p=J,G=V,ve=void 0)}if(x.colorType===3&&(y=this.color_spaces.INDEXED,B=x.palette,x.transparency.indexed)){var Ae=x.transparency.indexed,k=0;for($=0,O=Ae.length;$<O;++$)k+=Ae[$];if((k/=255)===O-1&&Ae.indexOf(0)!==-1)T=[Ae.indexOf(0)];else if(k!==O){for(F=x.decodePixels(),V=new Uint8Array(F.length),$=0,O=F.length;$<O;$++)V[$]=Ae[F[$]];G=i(V,x.width,1)}}var S=function(I){var X;switch(I){case t.image_compression.FAST:X=11;break;case t.image_compression.MEDIUM:X=13;break;case t.image_compression.SLOW:X=14;break;default:X=12}return X}(g);return ve===this.decode.FLATE_DECODE&&(W="/Predictor "+S+" "),W+="/Colors "+M+" /BitsPerComponent "+w+" /Columns "+x.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(G&&this.__addimage__.isArrayBuffer(G)||this.__addimage__.isArrayBufferView(G))&&(G=this.__addimage__.arrayBufferToBinaryString(G)),{alias:m,data:p,index:f,filter:ve,decodeParameters:W,transparency:T,palette:B,sMask:G,predictor:S,width:x.width,height:x.height,bitsPerComponent:w,colorSpace:y}}}})(Ti.API),function(t){t.processGIF89A=function(e,i,r,n){var o=new $Gt(e),s=o.width,a=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:s,height:a},u=new Ace(100).encode(d,100);return t.processJPEG.call(this,u,i,r,n)},t.processGIF87A=t.processGIF89A}(Ti.API),Fh.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:r,blue:i,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Fh.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(i){Hn.log("bit decode error:"+i)}},Fh.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),i=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<e;n++)for(var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+8*n*4,a=0;a<8&&8*n+a<this.width;a++){var c=this.palette[o>>7-a&1];this.data[s+4*a]=c.blue,this.data[s+4*a+1]=c.green,this.data[s+4*a+2]=c.red,this.data[s+4*a+3]=255}i!==0&&(this.pos+=4-i)}},Fh.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,n=0;n<t;n++){var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+2*n*4,a=o>>4,c=15&o,d=this.palette[a];if(this.data[s]=d.blue,this.data[s+1]=d.green,this.data[s+2]=d.red,this.data[s+3]=255,2*n+1>=this.width)break;d=this.palette[c],this.data[s+4]=d.blue,this.data[s+4+1]=d.green,this.data[s+4+2]=d.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Fh.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+4*r;if(n<this.palette.length){var s=this.palette[n];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},Fh.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,n=0;n<this.width;n++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,a=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,d=o>>15?255:0,u=r*this.width*4+4*n;this.data[u]=c,this.data[u+1]=a,this.data[u+2]=s,this.data[u+3]=d}this.pos+=t}},Fh.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),i=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,c=(s>>5&i)/i*255|0,d=(s>>11)/e*255|0,u=n*this.width*4+4*o;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=a,this.data[u+3]=255}this.pos+=t}},Fh.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*i;this.data[s]=o,this.data[s+1]=n,this.data[s+2]=r,this.data[s+3]=255}this.pos+=this.width%4}},Fh.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*i;this.data[a]=o,this.data[a+1]=n,this.data[a+2]=r,this.data[a+3]=s}},Fh.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,i,r,n){var o=new Fh(e,!1),s=o.width,a=o.height,c={data:o.getData(),width:s,height:a},d=new Ace(100).encode(c,100);return t.processJPEG.call(this,d,i,r,n)}}(Ti.API),u9e.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,i,r,n){var o=new u9e(e,!1),s=o.width,a=o.height,c={data:o.getData(),width:s,height:a},d=new Ace(100).encode(c,100);return t.processJPEG.call(this,d,i,r,n)}}(Ti.API),Ti.API.processRGBA=function(t,e,i){for(var r=t.data,n=r.length,o=new Uint8Array(n/4*3),s=new Uint8Array(n/4),a=0,c=0,d=0;d<n;d+=4){var u=r[d],h=r[d+1],p=r[d+2],f=r[d+3];o[a++]=u,o[a++]=h,o[a++]=p,s[c++]=f}var m=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:m,index:e,alias:i,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Ti.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},hR=Ti.API,Mz=hR.getCharWidthsArray=function(t,e){var i,r,n=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:n.metadata.Unicode.widths,c=a.fof?a.fof:1,d=e.kerning?e.kerning:n.metadata.Unicode.kerning,u=d.fof?d.fof:1,h=e.doKerning!==!1,p=0,f=t.length,m=0,g=a[0]||c,y=[];for(i=0;i<f;i++)r=t.charCodeAt(i),typeof n.metadata.widthOfString=="function"?y.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(r))+s*(1e3/o)||0)/1e3):(p=h&&(0,Dn.default)(d[r])==="object"&&!isNaN(parseInt(d[r][m],10))?d[r][m]/u:0,y.push((a[r]||g)/c+p)),m=r;return y},a9e=hR.getStringUnitWidth=function(t,e){var i=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return hR.processArabic&&(t=hR.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,i,n)/i:Mz.apply(this,arguments).reduce(function(o,s){return o+s},0)},l9e=function(t,e,i,r){for(var n=[],o=0,s=t.length,a=0;o!==s&&a+e[o]<i;)a+=e[o],o++;n.push(t.slice(0,o));var c=o;for(a=0;o!==s;)a+e[o]>r&&(n.push(t.slice(c,o)),a=0,c=o),a+=e[o],o++;return c!==o&&n.push(t.slice(c,o)),n},c9e=function(t,e,i){i||(i={});var r,n,o,s,a,c,d,u=[],h=[u],p=i.textIndent||0,f=0,m=0,g=t.split(" "),y=Mz.apply(this,[" ",i])[0];if(c=i.lineIndent===-1?g[0].length+2:i.lineIndent||0){var w=Array(c).join(" "),x=[];g.map(function(M){(M=M.split(/\s*\n/)).length>1?x=x.concat(M.map(function(B,G){return(G&&B.length?`
`:"")+B})):x.push(M[0])}),g=x,c=a9e.apply(this,[w,i])}for(o=0,s=g.length;o<s;o++){var T=0;if(r=g[o],c&&r[0]==`
`&&(r=r.substr(1),T=1),p+f+(m=(n=Mz.apply(this,[r,i])).reduce(function(M,B){return M+B},0))>e||T){if(m>e){for(a=l9e.apply(this,[r,n,e-(p+f),e]),u.push(a.shift()),u=[a.pop()];a.length;)h.push([a.shift()]);m=n.slice(r.length-(u[0]?u[0].length:0)).reduce(function(M,B){return M+B},0)}else u=[r];h.push(u),p=m+c,f=y}else u.push(r),p+=f+m,f=y}return d=c?function(M,B){return(B?w:"")+M.join(" ")}:function(M){return M.join(" ")},h.map(d)},hR.splitTextToSize=function(t,e,i){var r,n=(i=i||{}).fontSize||this.internal.getFontSize(),o=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,i);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/n;o.textIndent=i.textIndent?1*i.textIndent*this.internal.scaleFactor/n:0,o.lineIndent=i.lineIndent;var a,c,d=[];for(a=0,c=r.length;a<c;a++)d=d.concat(c9e.apply(this,[r[a],s,o]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",i={},r={},n=0;n<e.length;n++)i[e[n]]="0123456789abcdef"[n],r["0123456789abcdef"[n]]=e[n];var o=function(h){return"0x"+parseInt(h,10).toString(16)},s=t.__fontmetrics__.compress=function(h){var p,f,m,g,y=["{"];for(var w in h){if(p=h[w],isNaN(parseInt(w,10))?f="'"+w+"'":(w=parseInt(w,10),f=(f=o(w).slice(2)).slice(0,-1)+r[f.slice(-1)]),typeof p=="number")p<0?(m=o(p).slice(3),g="-"):(m=o(p).slice(2),g=""),m=g+m.slice(0,-1)+r[m.slice(-1)];else{if((0,Dn.default)(p)!=="object")throw new Error("Don't know what to do with value type "+(0,Dn.default)(p)+".");m=s(p)}y.push(f+m)}return y.push("}"),y.join("")},a=t.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,f,m,g,y={},w=1,x=y,T=[],M="",B="",G=h.length-1,F=1;F<G;F+=1)(g=h[F])=="'"?p?(m=p.join(""),p=void 0):p=[]:p?p.push(g):g=="{"?(T.push([x,m]),x={},m=void 0):g=="}"?((f=T.pop())[0][f[1]]=x,m=void 0,x=f[0]):g=="-"?w=-1:m===void 0?i.hasOwnProperty(g)?(M+=i[g],m=parseInt(M,16)*w,w=1,M=""):M+=g:i.hasOwnProperty(g)?(B+=i[g],x[m]=parseInt(B,16)*w,w=1,m=void 0,B=""):B+=g;return y},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(h){var p=h.font,f=u.Unicode[p.postScriptName];f&&(p.metadata.Unicode={},p.metadata.Unicode.widths=f.widths,p.metadata.Unicode.kerning=f.kerning);var m=d.Unicode[p.postScriptName];m&&(p.metadata.Unicode.encoding=m,p.encoding=m.codePages[0])}])}(Ti.API),function(t){var e=function(i){for(var r=i.length,n=new Uint8Array(r),o=0;o<r;o++)n[o]=i.charCodeAt(o);return n};t.API.events.push(["addFont",function(i){var r=void 0,n=i.font,o=i.instance;if(!n.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(r=o.existsFileInVFS(n.postScriptName)===!1?o.loadFile(n.postScriptName):o.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(s,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(LP(a)),s.metadata=t.API.TTFFont.open(a),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(n,r)}}])}(Ti),function(t){function e(){return(Di.canvg?Promise.resolve(Di.canvg):import("./chunk-XQQTYRNZ.mjs")).catch(function(i){return Promise.reject(new Error("Could not load canvg: "+i))}).then(function(i){return i.default?i.default:i})}Ti.API.addSvgAsImage=function(i,r,n,o,s,a,c,d){if(isNaN(r)||isNaN(n))throw Hn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw Hn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=o,u.height=s;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(m){return m.fromString(h,i,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(p)}).then(function(){f.addImage(u.toDataURL("image/jpeg",1),r,n,o,s,c,d)})}}(),Ti.API.putTotalPages=function(t){var e,i=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),i=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),i=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var n=0;n<this.internal.pages[r].length;n++)this.internal.pages[r][n]=this.internal.pages[r][n].replace(e,i);return this},Ti.API.viewerPreferences=function(t,e){var i;t=t||{},e=e||!1;var r,n,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),c=[],d=0,u=0,h=0;function p(m,g){var y,w=!1;for(y=0;y<m.length;y+=1)m[y]===g&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),i=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var f=a.length;for(h=0;h<f;h+=1)i[a[h]].value=i[a[h]].defaultValue,i[a[h]].explicitSet=!1}if((0,Dn.default)(t)==="object"){for(n in t)if(o=t[n],p(a,n)&&o!==void 0){if(i[n].type==="boolean"&&typeof o=="boolean")i[n].value=o;else if(i[n].type==="name"&&p(i[n].valueSet,o))i[n].value=o;else if(i[n].type==="integer"&&Number.isInteger(o))i[n].value=o;else if(i[n].type==="array"){for(d=0;d<o.length;d+=1)if(r=!0,o[d].length===1&&typeof o[d][0]=="number")c.push(String(o[d]-1));else if(o[d].length>1){for(u=0;u<o[d].length;u+=1)typeof o[d][u]!="number"&&(r=!1);r===!0&&c.push([o[d][0]-1,o[d][1]-1].join(" "))}i[n].value="["+c.join(" ")+"]"}else i[n].value=i[n].defaultValue;i[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in i)i[m].explicitSet===!0&&(i[m].type==="name"?g.push("/"+m+" /"+i[m].value):g.push("/"+m+" "+i[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=i,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(r)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=o.length+s.length+a.length+n.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(n+o+s+a+c),this.internal.write("endstream"),this.internal.write("endobj")},i=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",i),this.internal.events.subscribe("postPutResources",e)),this}}(Ti.API),function(t){var e=t.API,i=e.pdfEscape16=function(o,s){for(var a,c=s.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],h=0,p=o.length;h<p;++h){if(a=s.metadata.characterToGlyph(o.charCodeAt(h)),s.metadata.glyIdsUsed.push(a),s.metadata.toUnicode[a]=o.charCodeAt(h),c.indexOf(a)==-1&&(c.push(a),c.push([parseInt(s.metadata.widthOfGlyph(a),10)])),a=="0")return u.join("");a=a.toString(16),u.push(d[4-a.length],a)}return u.join("")},r=function(o){var s,a,c,d,u,h,p;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,p=(a=Object.keys(o).sort(function(f,m){return f-m})).length;h<p;h++)s=a[h],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(d=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var a=s.font,c=s.out,d=s.newObject,u=s.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="Identity-H"){for(var h=a.metadata.Unicode.widths,p=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),f="",m=0;m<p.length;m++)f+=String.fromCharCode(p[m]);var g=d();u({data:f,addLength1:!0,objectId:g}),c("endobj");var y=d();u({data:r(a.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var w=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+pR(a.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),c("/Flags "+a.metadata.flags),c("/StemV "+a.metadata.stemV),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c(">>"),c("endobj");var x=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+pR(a.fontName)),c("/FontDescriptor "+w+" 0 R"),c("/W "+t.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+a.encoding+")"),c(">>"),c(">>"),c("endobj"),a.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+pR(a.fontName)),c("/Encoding /"+a.encoding),c("/DescendantFonts ["+x+" 0 R]"),c(">>"),c("endobj"),a.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var a=s.font,c=s.out,d=s.newObject,u=s.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var h=a.metadata.rawData,p="",f=0;f<h.length;f++)p+=String.fromCharCode(h[f]);var m=d();u({data:p,addLength1:!0,objectId:m}),c("endobj");var g=d();u({data:r(a.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=d();c("<<"),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c("/StemV "+a.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),c("/FontName /"+pR(a.fontName)),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c(">>"),c("endobj"),a.objectNumber=d();for(var w=0;w<a.metadata.hmtx.widths.length;w++)a.metadata.hmtx.widths[w]=parseInt(a.metadata.hmtx.widths[w]*(1e3/a.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+pR(a.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),c("endobj"),a.isAlreadyPutted=!0}})(o)}]);var n=function(o){var s,a=o.text||"",c=o.x,d=o.y,u=o.options||{},h=o.mutex||{},p=h.pdfEscape,f=h.activeFontKey,m=h.fonts,g=f,y="",w=0,x="",T=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:a,x:c,y:d,options:u,mutex:h};for(x=a,g=f,Array.isArray(a)&&(x=a[0]),w=0;w<x.length;w+=1)m[g].metadata.hasOwnProperty("cmap")&&(s=m[g].metadata.cmap.unicode.codeMap[x[w].charCodeAt(0)]),s||x[w].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?y+=x[w]:y+="";var M="";return parseInt(g.slice(1))<14||T==="WinAnsiEncoding"?M=p(y,g).split("").map(function(B){return B.charCodeAt(0).toString(16)}).join(""):T==="Identity-H"&&(M=i(y,m[g])),h.isHex=!0,{text:M,x:c,y:d,options:u,mutex:h}};e.events.push(["postProcessText",function(o){var s=o.text||"",a=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var d=0;for(d=0;d<s.length;d+=1)Array.isArray(s[d])&&s[d].length===3?a.push([n(Object.assign({},c,{text:s[d][0]})).text,s[d][1],s[d][2]]):a.push(n(Object.assign({},c,{text:s[d]})).text);o.text=a}else o.text=n(Object.assign({},c,{text:s})).text}])}(Ti),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(i){return e.call(this),this.internal.vFS[i]!==void 0},t.addFileToVFS=function(i,r){return e.call(this),this.internal.vFS[i]=r,this},t.getFileFromVFS=function(i){return e.call(this),this.internal.vFS[i]!==void 0?this.internal.vFS[i]:null}}(Ti.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var n,o,s,a,c,d,u,h=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),x=!1,T=0;this.__bidiEngine__={};var M=function(N){var P=N.charCodeAt(),$=P>>8,K=g[$];return K!==void 0?h[256*K+(255&P)]:$===252||$===253?"AL":w.test($)?"L":$===8?"R":"N"},B=function(N){for(var P,$=0;$<N.length;$++){if((P=M(N.charAt($)))==="L")return!1;if(P==="R")return!0}return!1},G=function(N,P,$,K){var ve,W,ee,te,se=P[K];switch(se){case"L":case"R":x=!1;break;case"N":case"AN":break;case"EN":x&&(se="AN");break;case"AL":x=!0,se="R";break;case"WS":se="N";break;case"CS":K<1||K+1>=P.length||(ve=$[K-1])!=="EN"&&ve!=="AN"||(W=P[K+1])!=="EN"&&W!=="AN"?se="N":x&&(W="AN"),se=W===ve?W:"N";break;case"ES":se=(ve=K>0?$[K-1]:"B")==="EN"&&K+1<P.length&&P[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&$[K-1]==="EN"){se="EN";break}if(x){se="N";break}for(ee=K+1,te=P.length;ee<te&&P[ee]==="ET";)ee++;se=ee<te&&P[ee]==="EN"?"EN":"N";break;case"NSM":if(s&&!a){for(te=P.length,ee=K+1;ee<te&&P[ee]==="NSM";)ee++;if(ee<te){var Ae=N[K],k=Ae>=1425&&Ae<=2303||Ae===64286;if(ve=P[ee],k&&(ve==="R"||ve==="AL")){se="R";break}}}se=K<1||(ve=P[K-1])==="B"?"N":$[K-1];break;case"B":x=!1,n=!0,se=T;break;case"S":o=!0,se="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":x=!1;break;case"BN":se="N"}return se},F=function(N,P,$){var K=N.split("");return $&&O(K,$,{hiLevel:T}),K.reverse(),P&&P.reverse(),K.join("")},O=function(N,P,$){var K,ve,W,ee,te,se=-1,Ae=N.length,k=0,S=[],I=T?f:p,X=[];for(x=!1,n=!1,o=!1,ve=0;ve<Ae;ve++)X[ve]=M(N[ve]);for(W=0;W<Ae;W++){if(te=k,S[W]=G(N,X,S,W),K=240&(k=I[te][m[S[W]]]),k&=15,P[W]=ee=I[k][5],K>0)if(K===16){for(ve=se;ve<W;ve++)P[ve]=1;se=-1}else se=-1;if(I[k][6])se===-1&&(se=W);else if(se>-1){for(ve=se;ve<W;ve++)P[ve]=ee;se=-1}X[W]==="B"&&(P[W]=0),$.hiLevel|=ee}o&&function(Q,le,xe){for(var Re=0;Re<xe;Re++)if(Q[Re]==="S"){le[Re]=T;for(var Oe=Re-1;Oe>=0&&Q[Oe]==="WS";Oe--)le[Oe]=T}}(X,P,Ae)},V=function(N,P,$,K,ve){if(!(ve.hiLevel<N)){if(N===1&&T===1&&!n)return P.reverse(),void($&&$.reverse());for(var W,ee,te,se,Ae=P.length,k=0;k<Ae;){if(K[k]>=N){for(te=k+1;te<Ae&&K[te]>=N;)te++;for(se=k,ee=te-1;se<ee;se++,ee--)W=P[se],P[se]=P[ee],P[ee]=W,$&&(W=$[se],$[se]=$[ee],$[ee]=W);k=te}k++}}},J=function(N,P,$){var K=N.split(""),ve={hiLevel:T};return $||($=[]),O(K,$,ve),function(W,ee,te){if(te.hiLevel!==0&&u)for(var se,Ae=0;Ae<W.length;Ae++)ee[Ae]===1&&(se=y.indexOf(W[Ae]))>=0&&(W[Ae]=y[se+1])}(K,$,ve),V(2,K,P,$,ve),V(1,K,P,$,ve),K.join("")};return this.__bidiEngine__.doBidiReorder=function(N,P,$){if(function(ve,W){if(W)for(var ee=0;ee<ve.length;ee++)W[ee]=ee;a===void 0&&(a=B(ve)),d===void 0&&(d=B(ve))}(N,P),s||!c||d)if(s&&c&&a^d)T=a?1:0,N=F(N,P,$);else if(!s&&c&&d)T=a?1:0,N=J(N,P,$),N=F(N,P);else if(!s||a||c||d){if(s&&!c&&a^d)N=F(N,P),a?(T=0,N=J(N,P,$)):(T=1,N=J(N,P,$),N=F(N,P));else if(s&&a&&!c&&d)T=1,N=J(N,P,$),N=F(N,P);else if(!s&&!c&&a^d){var K=u;a?(T=1,N=J(N,P,$),T=0,u=!1,N=J(N,P,$),u=K):(T=0,N=J(N,P,$),N=F(N,P),T=1,u=!1,N=J(N,P,$),u=K,N=F(N,P))}}else T=0,N=J(N,P,$);else T=a?1:0,N=J(N,P,$);return N},this.__bidiEngine__.setOptions=function(N){N&&(s=N.isInputVisual,c=N.isOutputVisual,a=N.isInputRtl,d=N.isOutputRtl,u=N.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],i=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var n=r.text,o=(r.x,r.y,r.options||{}),s=(r.mutex,o.lang,[]);if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,i.setOptions(o),Object.prototype.toString.call(n)==="[object Array]"){var a=0;for(s=[],a=0;a<n.length;a+=1)Object.prototype.toString.call(n[a])==="[object Array]"?s.push([i.doBidiReorder(n[a][0]),n[a][1],n[a][2]]):s.push([i.doBidiReorder(n[a])]);r.text=s}else r.text=i.doBidiReorder(n);i.setOptions({isInputVisual:!0})}])}(Ti),Ti.API.TTFFont=function(){function t(e){var i;if(this.rawData=e,i=this.contents=new W0(e),this.contents.pos=4,i.readString(4)==="ttcf")throw new Error("TTCF not supported.");i.pos=0,this.parse(),this.subset=new lXt(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new GGt(this.contents),this.head=new KGt(this),this.name=new tXt(this),this.cmap=new x9e(this),this.toUnicode={},this.hhea=new ZGt(this),this.maxp=new iXt(this),this.hmtx=new rXt(this),this.post=new JGt(this),this.os2=new QGt(this),this.loca=new aXt(this),this.glyf=new nXt(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,i,r,n,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,a,c,d;for(d=[],s=0,a=(c=this.bbox).length;s<a;s++)e=c[s],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(n=this.post.italic_angle),32768&(i=n>>16)&&(i=-(1+(65535^i))),this.italicAngle=+(i+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var i;return((i=this.cmap.unicode)!=null?i.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var i;return i=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*i},t.prototype.widthOfString=function(e,i,r){var n,o,s,a;for(s=0,o=0,a=(e=""+e).length;0<=a?o<a:o>a;o=0<=a?++o:--o)n=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(n))+r*(1e3/i)||0;return s*(i/1e3)},t.prototype.lineHeight=function(e,i){var r;return i==null&&(i=!1),r=i?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var Bh,W0=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var i,r;for(r=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)r[i]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var i,r,n;for(n=[],i=0,r=e.length;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push(this.writeByte(e.charCodeAt(i)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,i,r,n,o,s,a,c;return e=this.readByte(),i=this.readByte(),r=this.readByte(),n=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^i)+1099511627776*(255^r)+4294967296*(255^n)+16777216*(255^o)+65536*(255^s)+256*(255^a)+(255^c)+1):72057594037927940*e+281474976710656*i+1099511627776*r+4294967296*n+16777216*o+65536*s+256*a+c},t.prototype.writeLongLong=function(e){var i,r;return i=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var i,r;for(i=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)i.push(this.readByte());return i},t.prototype.write=function(e){var i,r,n,o;for(o=[],r=0,n=e.length;r<n;r++)i=e[r],o.push(this.writeByte(i));return o},t}(),GGt=function(){var t;function e(i){var r,n,o;for(this.scalarType=i.readInt(),this.tableCount=i.readShort(),this.searchRange=i.readShort(),this.entrySelector=i.readShort(),this.rangeShift=i.readShort(),this.tables={},n=0,o=this.tableCount;0<=o?n<o:n>o;n=0<=o?++n:--n)r={tag:i.readString(4),checksum:i.readInt(),offset:i.readInt(),length:i.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(i){var r,n,o,s,a,c,d,u,h,p,f,m,g;for(g in f=Object.keys(i).length,c=Math.log(2),h=16*Math.floor(Math.log(f)/c),s=Math.floor(h/c),u=16*f-h,(n=new W0).writeInt(this.scalarType),n.writeShort(f),n.writeShort(h),n.writeShort(s),n.writeShort(u),o=16*f,d=n.pos+o,a=null,m=[],i)for(p=i[g],n.writeString(g),n.writeInt(t(p)),n.writeInt(d),n.writeInt(p.length),m=m.concat(p),g==="head"&&(a=d),d+=p.length;d%4;)m.push(0),d++;return n.write(m),r=2981146554-t(n.data),n.pos=a+8,n.writeUInt32(r),n.data},t=function(i){var r,n,o,s;for(i=S9e.call(i);i.length%4;)i.push(0);for(o=new W0(i),n=0,r=0,s=i.length;r<s;r=r+=4)n+=o.readUInt32();return 4294967295&n},e}(),XGt={}.hasOwnProperty,Op=function(t,e){for(var i in e)XGt.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Bh=function(){function t(e){var i;this.file=e,i=this.file.directory.tables[this.tag],this.exists=!!i,i&&(this.offset=i.offset,this.length=i.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var KGt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="head",e.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.revision=i.readInt(),this.checkSumAdjustment=i.readInt(),this.magicNumber=i.readInt(),this.flags=i.readShort(),this.unitsPerEm=i.readShort(),this.created=i.readLongLong(),this.modified=i.readLongLong(),this.xMin=i.readShort(),this.yMin=i.readShort(),this.xMax=i.readShort(),this.yMax=i.readShort(),this.macStyle=i.readShort(),this.lowestRecPPEM=i.readShort(),this.fontDirectionHint=i.readShort(),this.indexToLocFormat=i.readShort(),this.glyphDataFormat=i.readShort()},e.prototype.encode=function(i){var r;return(r=new W0).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(i),r.writeShort(this.glyphDataFormat),r.data},e}(),h9e=function(){function t(e,i){var r,n,o,s,a,c,d,u,h,p,f,m,g,y,w,x,T;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=i+e.readInt(),h=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(f=e.readUInt16(),p=f/2,e.pos+=6,o=function(){var M,B;for(B=[],c=M=0;0<=p?M<p:M>p;c=0<=p?++M:--M)B.push(e.readUInt16());return B}(),e.pos+=2,g=function(){var M,B;for(B=[],c=M=0;0<=p?M<p:M>p;c=0<=p?++M:--M)B.push(e.readUInt16());return B}(),d=function(){var M,B;for(B=[],c=M=0;0<=p?M<p:M>p;c=0<=p?++M:--M)B.push(e.readUInt16());return B}(),u=function(){var M,B;for(B=[],c=M=0;0<=p?M<p:M>p;c=0<=p?++M:--M)B.push(e.readUInt16());return B}(),n=(this.length-e.pos+this.offset)/2,a=function(){var M,B;for(B=[],c=M=0;0<=n?M<n:M>n;c=0<=n?++M:--M)B.push(e.readUInt16());return B}(),c=w=0,T=o.length;w<T;c=++w)for(y=o[c],r=x=m=g[c];m<=y?x<=y:x>=y;r=m<=y?++x:--x)u[c]===0?s=r+d[c]:(s=a[u[c]/2+(r-m)-(p-c)]||0)!==0&&(s+=d[c]),this.codeMap[r]=65535&s}e.pos=h}return t.encode=function(e,i){var r,n,o,s,a,c,d,u,h,p,f,m,g,y,w,x,T,M,B,G,F,O,V,J,N,P,$,K,ve,W,ee,te,se,Ae,k,S,I,X,Q,le,xe,Re,Oe,We,Le,Ne;switch(K=new W0,s=Object.keys(e).sort(function(it,ct){return it-ct}),i){case"macroman":for(g=0,y=function(){var it=[];for(m=0;m<256;++m)it.push(0);return it}(),x={0:0},o={},ve=0,se=s.length;ve<se;ve++)x[Oe=e[n=s[ve]]]==null&&(x[Oe]=++g),o[n]={old:e[n],new:x[e[n]]},y[n]=x[e[n]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(y),{charMap:o,subtable:K.data,maxGlyphID:g+1};case"unicode":for(P=[],h=[],T=0,x={},r={},w=d=null,W=0,Ae=s.length;W<Ae;W++)x[B=e[n=s[W]]]==null&&(x[B]=++T),r[n]={old:B,new:x[B]},a=x[B]-n,w!=null&&a===d||(w&&h.push(w),P.push(n),d=a),w=n;for(w&&h.push(w),h.push(65535),P.push(65535),J=2*(V=P.length),O=2*Math.pow(Math.log(V)/Math.LN2,2),p=Math.log(O/2)/Math.LN2,F=2*V-O,c=[],G=[],f=[],m=ee=0,k=P.length;ee<k;m=++ee){if(N=P[m],u=h[m],N===65535){c.push(0),G.push(0);break}if(N-($=r[N].new)>=32768)for(c.push(0),G.push(2*(f.length+V-m)),n=te=N;N<=u?te<=u:te>=u;n=N<=u?++te:--te)f.push(r[n].new);else c.push($-N),G.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*V+2*f.length),K.writeUInt16(0),K.writeUInt16(J),K.writeUInt16(O),K.writeUInt16(p),K.writeUInt16(F),xe=0,S=h.length;xe<S;xe++)n=h[xe],K.writeUInt16(n);for(K.writeUInt16(0),Re=0,I=P.length;Re<I;Re++)n=P[Re],K.writeUInt16(n);for(We=0,X=c.length;We<X;We++)a=c[We],K.writeUInt16(a);for(Le=0,Q=G.length;Le<Q;Le++)M=G[Le],K.writeUInt16(M);for(Ne=0,le=f.length;Ne<le;Ne++)g=f[Ne],K.writeUInt16(g);return{charMap:r,subtable:K.data,maxGlyphID:T+1}}},t}(),x9e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="cmap",e.prototype.parse=function(i){var r,n,o;for(i.pos=this.offset,this.version=i.readUInt16(),o=i.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=o?n<o:n>o;n=0<=o?++n:--n)r=new h9e(i,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(i,r){var n,o;return r==null&&(r="macroman"),n=h9e.encode(i,r),(o=new W0).writeUInt16(0),o.writeUInt16(1),n.table=o.data.concat(n.subtable),n},e}(),ZGt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="hhea",e.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.ascender=i.readShort(),this.decender=i.readShort(),this.lineGap=i.readShort(),this.advanceWidthMax=i.readShort(),this.minLeftSideBearing=i.readShort(),this.minRightSideBearing=i.readShort(),this.xMaxExtent=i.readShort(),this.caretSlopeRise=i.readShort(),this.caretSlopeRun=i.readShort(),this.caretOffset=i.readShort(),i.pos+=8,this.metricDataFormat=i.readShort(),this.numberOfMetrics=i.readUInt16()},e}(),QGt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="OS/2",e.prototype.parse=function(i){if(i.pos=this.offset,this.version=i.readUInt16(),this.averageCharWidth=i.readShort(),this.weightClass=i.readUInt16(),this.widthClass=i.readUInt16(),this.type=i.readShort(),this.ySubscriptXSize=i.readShort(),this.ySubscriptYSize=i.readShort(),this.ySubscriptXOffset=i.readShort(),this.ySubscriptYOffset=i.readShort(),this.ySuperscriptXSize=i.readShort(),this.ySuperscriptYSize=i.readShort(),this.ySuperscriptXOffset=i.readShort(),this.ySuperscriptYOffset=i.readShort(),this.yStrikeoutSize=i.readShort(),this.yStrikeoutPosition=i.readShort(),this.familyClass=i.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(i.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(i.readInt());return n}(),this.vendorID=i.readString(4),this.selection=i.readShort(),this.firstCharIndex=i.readShort(),this.lastCharIndex=i.readShort(),this.version>0&&(this.ascent=i.readShort(),this.descent=i.readShort(),this.lineGap=i.readShort(),this.winAscent=i.readShort(),this.winDescent=i.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(i.readInt());return n}(),this.version>1))return this.xHeight=i.readShort(),this.capHeight=i.readShort(),this.defaultChar=i.readShort(),this.breakChar=i.readShort(),this.maxContext=i.readShort()},e}(),JGt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="post",e.prototype.parse=function(i){var r,n,o;switch(i.pos=this.offset,this.format=i.readInt(),this.italicAngle=i.readInt(),this.underlinePosition=i.readShort(),this.underlineThickness=i.readShort(),this.isFixedPitch=i.readInt(),this.minMemType42=i.readInt(),this.maxMemType42=i.readInt(),this.minMemType1=i.readInt(),this.maxMemType1=i.readInt(),this.format){case 65536:break;case 131072:var s;for(n=i.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(i.readUInt16());for(this.names=[],o=[];i.pos<this.offset+this.length;)r=i.readByte(),o.push(this.names.push(i.readString(r)));return o;case 151552:return n=i.readUInt16(),this.offsets=i.read(n);case 196608:break;case 262144:return this.map=(function(){var a,c,d;for(d=[],s=a=0,c=this.file.maxp.numGlyphs;0<=c?a<c:a>c;s=0<=c?++a:--a)d.push(i.readUInt32());return d}).call(this)}},e}(),eXt=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},tXt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="name",e.prototype.parse=function(i){var r,n,o,s,a,c,d,u,h,p,f;for(i.pos=this.offset,i.readShort(),r=i.readShort(),c=i.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:i.readShort(),encodingID:i.readShort(),languageID:i.readShort(),nameID:i.readShort(),length:i.readShort(),offset:this.offset+c+i.readShort()});for(d={},s=h=0,p=n.length;h<p;s=++h)o=n[s],i.pos=o.offset,u=i.readString(o.length),a=new eXt(u,o),d[f=o.nameID]==null&&(d[f]=[]),d[o.nameID].push(a);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),iXt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="maxp",e.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.numGlyphs=i.readUInt16(),this.maxPoints=i.readUInt16(),this.maxContours=i.readUInt16(),this.maxCompositePoints=i.readUInt16(),this.maxComponentContours=i.readUInt16(),this.maxZones=i.readUInt16(),this.maxTwilightPoints=i.readUInt16(),this.maxStorage=i.readUInt16(),this.maxFunctionDefs=i.readUInt16(),this.maxInstructionDefs=i.readUInt16(),this.maxStackElements=i.readUInt16(),this.maxSizeOfInstructions=i.readUInt16(),this.maxComponentElements=i.readUInt16(),this.maxComponentDepth=i.readUInt16()},e}(),rXt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="hmtx",e.prototype.parse=function(i){var r,n,o,s,a,c,d;for(i.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:i.readUInt16(),lsb:i.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,h;for(h=[],r=u=0;0<=o?u<o:u>o;r=0<=o?++u:--u)h.push(i.readInt16());return h}(),this.widths=(function(){var u,h,p,f;for(f=[],u=0,h=(p=this.metrics).length;u<h;u++)s=p[u],f.push(s.advance);return f}).call(this),n=this.widths[this.widths.length-1],d=[],r=a=0;0<=o?a<o:a>o;r=0<=o?++a:--a)d.push(this.widths.push(n));return d},e.prototype.forGlyph=function(i){return i in this.metrics?this.metrics[i]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[i-this.metrics.length]}},e}(),S9e=[].slice,nXt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(i){var r,n,o,s,a,c,d,u,h,p;return i in this.cache?this.cache[i]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(i),(o=s.lengthOf(i))===0?this.cache[i]=null:(r.pos=this.offset+n,a=(c=new W0(r.read(o))).readShort(),u=c.readShort(),p=c.readShort(),d=c.readShort(),h=c.readShort(),this.cache[i]=a===-1?new sXt(c,u,p,d,h):new oXt(c,a,u,p,d,h),this.cache[i]))},e.prototype.encode=function(i,r,n){var o,s,a,c,d;for(a=[],s=[],c=0,d=r.length;c<d;c++)o=i[r[c]],s.push(a.length),o&&(a=a.concat(o.encode(n)));return s.push(a.length),{table:a,offsets:s}},e}(),oXt=function(){function t(e,i,r,n,o,s){this.raw=e,this.numberOfContours=i,this.xMin=r,this.yMin=n,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),sXt=function(){function t(e,i,r,n,o){var s,a;for(this.raw=e,this.xMin=i,this.yMin=r,this.xMax=n,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return t.prototype.encode=function(){var e,i,r;for(i=new W0(S9e.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)i.pos=this.glyphOffsets[e];return i.data},t}(),aXt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Op(e,Bh),e.prototype.tag="loca",e.prototype.parse=function(i){var r,n;return i.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var o,s;for(s=[],n=0,o=this.length;n<o;n+=2)s.push(2*i.readUInt16());return s}).call(this):(function(){var o,s;for(s=[],n=0,o=this.length;n<o;n+=4)s.push(i.readUInt32());return s}).call(this)},e.prototype.indexOf=function(i){return this.offsets[i]},e.prototype.lengthOf=function(i){return this.offsets[i+1]-this.offsets[i]},e.prototype.encode=function(i,r){for(var n=new Uint32Array(this.offsets.length),o=0,s=0,a=0;a<n.length;++a)if(n[a]=o,s<r.length&&r[s]==a){++s,n[a]=o;var c=this.offsets[a],d=this.offsets[a+1]-c;d>0&&(o+=d)}for(var u=new Array(4*n.length),h=0;h<n.length;++h)u[4*h+3]=255&n[h],u[4*h+2]=(65280&n[h])>>8,u[4*h+1]=(16711680&n[h])>>16,u[4*h]=(4278190080&n[h])>>24;return u},e}(),lXt=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,i,r,n,o;for(i in n=this.font.cmap.tables[0].codeMap,e={},o=this.subset)r=o[i],e[i]=n[r];return e},t.prototype.glyphsFor=function(e){var i,r,n,o,s,a,c;for(n={},s=0,a=e.length;s<a;s++)n[o=e[s]]=this.font.glyf.glyphFor(o);for(o in i=[],n)(r=n[o])!=null&&r.compound&&i.push.apply(i,r.glyphIDs);if(i.length>0)for(o in c=this.glyphsFor(i))r=c[o],n[o]=r;return n},t.prototype.encode=function(e,i){var r,n,o,s,a,c,d,u,h,p,f,m,g,y,w;for(n in r=x9e.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),f={0:0},w=r.charMap)f[(c=w[n]).old]=c.new;for(m in p=r.maxGlyphID,s)m in f||(f[m]=p++);return u=function(x){var T,M;for(T in M={},x)M[x[T]]=T;return M}(f),h=Object.keys(u).sort(function(x,T){return x-T}),g=function(){var x,T,M;for(M=[],x=0,T=h.length;x<T;x++)a=h[x],M.push(u[a]);return M}(),o=this.font.glyf.encode(s,g,f),d=this.font.loca.encode(o.offsets,g),y={cmap:this.font.cmap.raw(),glyf:o.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(i)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},t}();Ti.API.PDFObject=function(){var t;function e(){}return t=function(i,r){return(Array(r+1).join("0")+i).slice(-r)},e.convert=function(i){var r,n,o,s;if(Array.isArray(i))return"["+function(){var a,c,d;for(d=[],a=0,c=i.length;a<c;a++)r=i[a],d.push(e.convert(r));return d}().join(" ")+"]";if(typeof i=="string")return"/"+i;if(i?.isString)return"("+i+")";if(i instanceof Date)return"(D:"+t(i.getUTCFullYear(),4)+t(i.getUTCMonth(),2)+t(i.getUTCDate(),2)+t(i.getUTCHours(),2)+t(i.getUTCMinutes(),2)+t(i.getUTCSeconds(),2)+"Z)";if({}.toString.call(i)==="[object Object]"){for(n in o=["<<"],i)s=i[n],o.push("/"+n+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+i},e}();var yR=(()=>{let e=class e{constructor(){this.downloadSubjectTrigger=new Ft,this.downloadFileTrigger=new Ft,this.downloadExcelTrigger=new Ft,this.downloadPDFTrigger=new Ft}get downloadSubjectTriggered$(){return this.downloadSubjectTrigger.asObservable()}get downloadFileTriggered$(){return this.downloadFileTrigger.asObservable()}get downloadExcelTriggered$(){return this.downloadExcelTrigger.asObservable()}get downloadPDFTriggered$(){return this.downloadPDFTrigger.asObservable()}triggerGenerateSubject(){this.downloadSubjectTrigger.next()}triggerGenerateFile(){this.downloadFileTrigger.next()}triggerGenerateExcel(){this.downloadExcelTrigger.next()}triggerGeneratePDF(){this.downloadPDFTrigger.next()}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var R9e=(()=>{let e=class e{constructor(r,n){this.interactionService=r,this.translocoService=n}ngOnChanges(r){r.name&&(this.name=r.name.currentValue)}ngOnInit(){this.interactionService.downloadSubjectTriggered$.subscribe(()=>{this.generateSubject()}),this.interactionService.downloadFileTriggered$.subscribe(()=>{this.generateFile()}),this.interactionService.downloadExcelTriggered$.subscribe(()=>{this.generateExcel()}),this.interactionService.downloadPDFTriggered$.subscribe(()=>{this.generatePDF()})}exportToExcel(r,n){let o=new E9e.Workbook,s=this.data.months;console.log(this.data);var a=this.data.downloads_graph_data.reverse(),c=this.data.datasets_graph_data.reverse(),d=this.data.files_graph_data.reverse(),u=this.data.users_graph_data.reverse(),h=this.data.size_graph_data.reverse();let p=o.addWorksheet("Read Me");p.addRow(["FAQ"]),p.addRow([]),p.addRow(["Tab","Field Name","Definition"]),p.addRow(["Downloads","",""]),p.addRow(["","Date",""]),p.addRow(["","Count","Total amount of downloads in the given month"]),p.addRow(["","Cumul Count","Total cumulative downloads in the given month"]),p.addRow(["Datasets","",""]),p.addRow(["","Date",""]),p.addRow(["","Count","Total amount of realesed datasets in the given month"]),p.addRow(["","Cumul Count","Total cumulative realesed datasets in the given month"]),p.addRow(["Files","",""]),p.addRow(["","Date",""]),p.addRow(["","Count","Total amount of files in realesed datasets in the given month"]),p.addRow(["","Cumul Count","Total cumulative files in realesed datasets in the given month"]),p.addRow(["Users","",""]),p.addRow(["","Date",""]),p.addRow(["","Count","Total count of users who opened an account in the given month"]),p.addRow(["","Cumul Count","Total cumulative count of users in the given month"]),p.addRow(["Storage","",""]),p.addRow(["","Date",""]),p.addRow(["","Count","Total approximate GB of storage allocated in the given month"]),p.addRow(["","Percent","Total cumulative approximate GB of storage allocated in the given month"]),p.addRow(["Subject Breakdown","",""]),p.addRow(["","Subject","Subect of Dataset"]),p.addRow(["","Count","Total count of datasets with assigned subject"]),p.addRow(["","Percent","Percent of datasets with assigned subject over all other subjects"]),p.addRow(["File Breakdown","",""]),p.addRow(["","Type","type of file"]),p.addRow(["","Content Type","specfic format of file"]),p.addRow(["","Count","Total count of datasets with assigned subject"]),p.addRow(["","Percent","Percent of datasets with file type over all other file types"]),p.getColumn(1).width=20,p.getColumn(2).width=15,p.getColumn(3).width=60;let f=o.addWorksheet("Downloads"),m=Object.keys(["date","count","cumul count"]);f.addRow(["date","count","cumul count"]),f.getColumn(1).width=15,f.getColumn(2).width=15,f.getColumn(3).width=15;let g=o.addWorksheet("Datasets"),y=Object.keys(["date","count","cumul count"]);g.addRow(["date","count","cumul count"]),g.getColumn(1).width=15,g.getColumn(2).width=15,g.getColumn(3).width=15;let w=o.addWorksheet("Files"),x=Object.keys(["date","count","cumul count"]);w.addRow(["date","count","cumul count"]),w.getColumn(1).width=15,w.getColumn(2).width=15,w.getColumn(3).width=15;let T=o.addWorksheet("Users"),M=Object.keys(["date","count","cumul count"]);T.addRow(["date","count","cumul count"]),T.getColumn(1).width=15,T.getColumn(2).width=15,T.getColumn(3).width=15;let B=o.addWorksheet("Storage"),G=Object.keys(["date","count","cumul count"]);B.addRow(["date","count","cumul count"]),B.getColumn(1).width=15,B.getColumn(2).width=15,B.getColumn(3).width=15;let F=o.addWorksheet("Subject Breakdown"),O=Object.keys(["subject","count","percent"]);F.addRow(["subject","count","percent"]),F.getColumn(1).width=30,F.getColumn(2).width=15,F.getColumn(3).width=15;let V=o.addWorksheet("File Breakdown"),J=Object.keys(["file type","specific type","count","percent"]);V.addRow(["type","content type","count","percent"]),V.getColumn(1).width=20,V.getColumn(2).width=30,V.getColumn(3).width=15,V.getColumn(3).width=15;for(let N=0;N<s.length-1;N+=1)f.addRow([s[N],this.data.downloads_graph_agg_data[N],a[N]]),g.addRow([s[N],this.data.datasets_graph_agg_data[N],c[N]]),w.addRow([s[N],this.data.files_graph_agg_data[N],d[N]]),T.addRow([s[N],this.data.users_graph_agg_data[N],u[N]]),B.addRow([s[N],this.data.size_graph_agg_data[N],h[N]]);for(let N=0;N<this.data.subject_full_data.length-1;N+=1)F.addRow([this.data.subject_full_data[N].subject,this.data.subject_full_data[N].count,this.data.subject_full_data[N].percent]);for(let N=0;N<this.data.file_content_full_data.length-1;N+=1)V.addRow([this.data.file_content_full_data[N].type,this.data.file_content_full_data[N].contenttype,this.data.file_content_full_data[N].count,this.data.file_content_full_data[N].percent]);o.xlsx.writeBuffer().then(N=>{let P=new Blob([N],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,T9e.saveAs)(P,`${n}.xlsx`)})}generatePDF(){return Ei(this,null,function*(){let r=new Ti("p","mm","a4"),n=r.internal.pageSize.getHeight(),o=r.internal.pageSize.getWidth(),s=10,a=10,c=5,d=90,u=90,h=a,p=(I,X,Q,le)=>{let xe=I.width/I.height,Re=le,Oe=le/xe;Q+Oe>n-a&&(r.addPage(),Q=a,h=a);let We=document.createElement("canvas");We.width=I.width,We.height=I.height;let Le=We.getContext("2d");Le&&(Le.fillStyle="white",Le.fillRect(0,0,We.width,We.height),Le.drawImage(I,0,0));let Ne=We.toDataURL("image/png");return r.addImage(Ne,"PNG",X,Q,Re,Oe),Oe+c},f="Borealis Report";this.name&&this.name!=="(All)"&&(f=`${this.name} - ${f}`);let m=new Date().toLocaleDateString("en-US",{year:"numeric",month:"numeric",day:"numeric"});r.setFont("helvetica","normal"),r.setFontSize(9),r.text(f,s,a);let g=r.getTextWidth(m);r.text(m,o-s-g,a),r.setFont("helvetica","bold"),r.setFontSize(14);let y=document.getElementById("responsive-title")?.textContent??"";(y==="(All)"||y==="")&&(y="Borealis (All)");let w=o-2*s,x=r.splitTextToSize(y,w),T=7,M=a+10;r.text(x,s,M);let B=x.length*T;r.setFont("helvetica","italic"),r.setFontSize(11);let G=document.getElementById("pdf_date")?.textContent??"",F=M+B+1.5;r.text(G,s,F),h=F+6;let O=6,V=4,J=(o-s*2-V*(O-1))/O,N=15,P=h,$=[this.translocoService.translate("Collections"),this.translocoService.translate("Datasets"),this.translocoService.translate("Files"),this.translocoService.translate("Downloads"),this.translocoService.translate("Users"),this.translocoService.translate("Storage")],K=[document.getElementById("total_collections_num")?.textContent??"",document.getElementById("total_datasets_num")?.textContent??"",document.getElementById("total_files_num")?.textContent??"",document.getElementById("total_downloads_num")?.textContent??"",document.getElementById("total_users_num")?.textContent??"",document.getElementById("total_size_num")?.textContent??""];for(let I=0;I<O;I++){let X=s+I*(J+V);this.drawCard(r,$[I],K[I],X,P,J,N)}h+=N+10;let W=document.querySelector("#pdf_bargraphs")?.querySelectorAll("canvas")??[],ee=document.querySelector("#subjectGraph canvas"),te=document.querySelector("#fileGraph canvas"),se=o-s-d,Ae=h,k=[{leftIndex:0,leftTitle:this.translocoService.translate("NumberofDownloads"),rightCanvas:W[4],rightTitle:this.translocoService.translate("StorageUsage")},{leftIndex:1,leftTitle:this.translocoService.translate("NumberofDatasets"),rightCanvas:ee,rightTitle:this.translocoService.translate("SubjectBreakdown")},{leftIndex:2,leftTitle:this.translocoService.translate("NumberofFiles"),rightCanvas:te,rightTitle:this.translocoService.translate("FileContentBreakdown")},{leftIndex:3,leftTitle:this.translocoService.translate("Numberofusers"),rightCanvas:null,rightTitle:""}];for(let I of k){Ae+10>n-a&&(r.addPage(),Ae=a);let X=0,Q=W[I.leftIndex];if(Q&&(r.setFont("helvetica","normal"),r.setFontSize(8),r.text(I.leftTitle,s,Ae),X=p(Q,s,Ae+4,d)),I.rightCanvas){r.setFont("helvetica","normal"),r.setFontSize(8),r.text(I.rightTitle,se,Ae);let le=p(I.rightCanvas,se,Ae+4,d);X=Math.max(X,le)}Ae+=X+6}let S="Borealis Report";this.name&&this.name!=="(All)"&&(S=`${this.name} - ${S}`),r.save(S)})}exportChartAsJPEG(r,n,o=.5){let a=document.getElementById(r).querySelector("canvas");if(!a){console.error(`No canvas found inside element with id ${r}`);return}let c=document.createElement("canvas");c.width=a.width,c.height=a.height;let d=c.getContext("2d");d&&(d.fillStyle="white",d.fillRect(0,0,c.width,c.height),d.drawImage(a,0,0));let u=document.createElement("canvas");u.width=c.width*o,u.height=c.height*o;let h=u.getContext("2d");h&&(h.scale(o,o),h.drawImage(c,0,0));let p=u.toDataURL("image/jpeg",1),f=document.createElement("a");f.download=n,f.href=p,f.click()}drawCard(r,n,o,s,a,c,d,u=2){r.setDrawColor(180,180,180),r.setFillColor(255,255,255),r.roundedRect(s,a,c,d,u,u,"FD"),r.setFont("helvetica","normal"),r.setFontSize(8),r.text(n,s+2,a+5),r.setFont("helvetica","normal"),r.setFontSize(10);let m=r.getTextWidth(o),g=s+c-2-m,y=a+d-3;r.text(o,g,y)}generateSubject(){this.exportChartAsJPEG("subjectGraph","subject-graph.jpeg",1)}generateFile(){this.exportChartAsJPEG("fileGraph","file-graph.jpeg",1)}generateExcel(){var r="Borealis Report";this.name!="(All)"&&(r=this.name+" - "+r),this.exportToExcel(this.data,r)}};e.\u0275fac=function(n){return new(n||e)(Te(yR),Te(id))},e.\u0275cmp=Tt({type:e,selectors:[["app-download"]],inputs:{data:"data",name:"name"},standalone:!0,features:[Li,zt],decls:0,vars:0,template:function(n,o){}}),e.\u0275prov=kt({token:e,factory:e.\u0275fac});let t=e;return t})();var A9e={transformMenu:zu("transformMenu",[df("void",ns({opacity:0,transform:"scale(0.8)"})),Ll("void => enter",fc("120ms cubic-bezier(0, 0, 0.2, 1)",ns({opacity:1,transform:"scale(1)"}))),Ll("* => void",fc("100ms 25ms linear",ns({opacity:0})))]),fadeInItems:zu("fadeInItems",[df("showing",ns({opacity:1})),Ll("void => *",[ns({opacity:0}),fc("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},Zrr=A9e.fadeInItems,Qrr=A9e.transformMenu;var cXt=new St("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{let t=Jt($r);return()=>t.scrollStrategies.reposition()}});function dXt(t){return()=>t.scrollStrategies.reposition()}var uXt={provide:cXt,deps:[$r],useFactory:dXt};var I9e=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({providers:[uXt],imports:[Wn,E_,oi,Wd,Vd,oi]});let t=e;return t})();var hXt=["tooltip"],k9e=20;var O9e=new St("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let t=Jt($r);return()=>t.scrollStrategies.reposition({scrollThrottle:k9e})}});function fXt(t){return()=>t.scrollStrategies.reposition({scrollThrottle:k9e})}var pXt={provide:O9e,deps:[$r],useFactory:fXt};function mXt(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var gXt=new St("mat-tooltip-default-options",{providedIn:"root",factory:mXt});var D9e="tooltip-panel",M9e=pc({passive:!0}),vXt=8,bXt=8,_Xt=24,yXt=200,Bz=(()=>{let e=class e{get position(){return this._position}set position(r){r!==this._position&&(this._position=r,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(r){this._positionAtOrigin=hf(r),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(r){let n=hf(r);this._disabled!==n&&(this._disabled=n,n?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(r){this._showDelay=Zp(r)}get hideDelay(){return this._hideDelay}set hideDelay(r){this._hideDelay=Zp(r),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(r){let n=this._message;this._message=r!=null?String(r).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(n)}get tooltipClass(){return this._tooltipClass}set tooltipClass(r){this._tooltipClass=r,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(r,n,o,s,a,c,d,u,h,p,f,m){this._overlay=r,this._elementRef=n,this._scrollDispatcher=o,this._viewContainerRef=s,this._ngZone=a,this._platform=c,this._ariaDescriber=d,this._focusMonitor=u,this._dir=p,this._defaultOptions=f,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=wXt,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._touchstartTimeout=null,this._destroyed=new Ft,this._injector=Jt(kn),this._scrollStrategy=h,this._document=m,f&&(this._showDelay=f.showDelay,this._hideDelay=f.hideDelay,f.position&&(this.position=f.position),f.positionAtOrigin&&(this.positionAtOrigin=f.positionAtOrigin),f.touchGestures&&(this.touchGestures=f.touchGestures),f.tooltipClass&&(this.tooltipClass=f.tooltipClass)),p.change.pipe(Hr(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=vXt}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Hr(this._destroyed)).subscribe(r=>{r?r==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let r=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,o])=>{r.removeEventListener(n,o,M9e)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(r,this.message,"tooltip"),this._focusMonitor.stopMonitoring(r)}show(r=this.showDelay,n){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let o=this._createOverlay(n);this._detach(),this._portal=this._portal||new qu(this._tooltipComponent,this._viewContainerRef);let s=this._tooltipInstance=o.attach(this._portal).instance;s._triggerElement=this._elementRef.nativeElement,s._mouseLeaveHideDelay=this._hideDelay,s.afterHidden().pipe(Hr(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),s.show(r)}hide(r=this.hideDelay){let n=this._tooltipInstance;n&&(n.isVisible()?n.hide(r):(n._cancelPendingAnimations(),this._detach()))}toggle(r){this._isTooltipVisible()?this.hide():this.show(void 0,r)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(r){if(this._overlayRef){let s=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!r)&&s._origin instanceof qt)return this._overlayRef;this._detach()}let n=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),o=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin?r||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(n);return o.positionChanges.pipe(Hr(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:o,panelClass:`${this._cssClassPrefix}-${D9e}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Hr(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Hr(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Hr(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&s.keyCode===27&&!jo(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(r){let n=r.getConfig().positionStrategy,o=this._getOrigin(),s=this._getOverlayPosition();n.withPositions([this._addOffset(Ke(Ke({},o.main),s.main)),this._addOffset(Ke(Ke({},o.fallback),s.fallback))])}_addOffset(r){let n=bXt,o=!this._dir||this._dir.value=="ltr";return r.originY==="top"?r.offsetY=-n:r.originY==="bottom"?r.offsetY=n:r.originX==="start"?r.offsetX=o?-n:n:r.originX==="end"&&(r.offsetX=o?n:-n),r}_getOrigin(){let r=!this._dir||this._dir.value=="ltr",n=this.position,o;n=="above"||n=="below"?o={originX:"center",originY:n=="above"?"top":"bottom"}:n=="before"||n=="left"&&r||n=="right"&&!r?o={originX:"start",originY:"center"}:(n=="after"||n=="right"&&r||n=="left"&&!r)&&(o={originX:"end",originY:"center"});let{x:s,y:a}=this._invertPosition(o.originX,o.originY);return{main:o,fallback:{originX:s,originY:a}}}_getOverlayPosition(){let r=!this._dir||this._dir.value=="ltr",n=this.position,o;n=="above"?o={overlayX:"center",overlayY:"bottom"}:n=="below"?o={overlayX:"center",overlayY:"top"}:n=="before"||n=="left"&&r||n=="right"&&!r?o={overlayX:"end",overlayY:"center"}:(n=="after"||n=="right"&&r||n=="left"&&!r)&&(o={overlayX:"start",overlayY:"center"});let{x:s,y:a}=this._invertPosition(o.overlayX,o.overlayY);return{main:o,fallback:{overlayX:s,overlayY:a}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),ed(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(r){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=r,this._tooltipInstance._markForCheck())}_invertPosition(r,n){return this.position==="above"||this.position==="below"?n==="top"?n="bottom":n==="bottom"&&(n="top"):r==="end"?r="start":r==="start"&&(r="end"),{x:r,y:n}}_updateCurrentPositionClass(r){let{overlayY:n,originX:o,originY:s}=r,a;if(n==="center"?this._dir&&this._dir.value==="rtl"?a=o==="end"?"left":"right":a=o==="start"?"left":"right":a=n==="bottom"&&s==="top"?"above":"below",a!==this._currentPosition){let c=this._overlayRef;if(c){let d=`${this._cssClassPrefix}-${D9e}-`;c.removePanelClass(d+this._currentPosition),c.addPanelClass(d+a)}this._currentPosition=a}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",r=>{this._setupPointerExitEventsIfNeeded();let n;r.x!==void 0&&r.y!==void 0&&(n=r),this.show(void 0,n)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",r=>{let n=r.targetTouches?.[0],o=n?{x:n.clientX,y:n.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let s=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,o)},this._defaultOptions.touchLongPressShowDelay??s)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let r=[];if(this._platformSupportsMouseEvents())r.push(["mouseleave",n=>{let o=n.relatedTarget;(!o||!this._overlayRef?.overlayElement.contains(o))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let n=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};r.push(["touchend",n],["touchcancel",n])}this._addListeners(r),this._passiveListeners.push(...r)}_addListeners(r){r.forEach(([n,o])=>{this._elementRef.nativeElement.addEventListener(n,o,M9e)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(r){if(this._isTooltipVisible()){let n=this._document.elementFromPoint(r.clientX,r.clientY),o=this._elementRef.nativeElement;n!==o&&!o.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){let r=this.touchGestures;if(r!=="off"){let n=this._elementRef.nativeElement,o=n.style;(r==="on"||n.nodeName!=="INPUT"&&n.nodeName!=="TEXTAREA")&&(o.userSelect=o.msUserSelect=o.webkitUserSelect=o.MozUserSelect="none"),(r==="on"||!n.draggable)&&(o.webkitUserDrag="none"),o.touchAction="none",o.webkitTapHighlightColor="transparent"}}_syncAriaDescription(r){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,r,"tooltip"),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}};e.\u0275fac=function(n){return new(n||e)(Te($r),Te(qt),Te(bA),Te(Qs),Te(ni),Te(yr),Te(sue),Te(Qp),Te(O9e),Te(ss),Te(gXt,8),Te(ir))},e.\u0275dir=Ot({type:e,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(n,o){n&2&&hi("mat-mdc-tooltip-disabled",o.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0});let t=e;return t})(),wXt=(()=>{let e=class e{constructor(r,n,o){this._changeDetectorRef=r,this._elementRef=n,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new Ft,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled=o==="NoopAnimations"}show(r){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},r)}hide(r){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},r)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:r}){(!r||!this._triggerElement.contains(r))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let r=this._elementRef.nativeElement.getBoundingClientRect();return r.height>_Xt&&r.width>=yXt}_handleAnimationEnd({animationName:r}){(r===this._showAnimation||r===this._hideAnimation)&&this._finalizeAnimation(r===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(r){r?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(r){let n=this._tooltip.nativeElement,o=this._showAnimation,s=this._hideAnimation;if(n.classList.remove(r?s:o),n.classList.add(r?o:s),this._isVisible!==r&&(this._isVisible=r,this._changeDetectorRef.markForCheck()),r&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let a=getComputedStyle(n);(a.getPropertyValue("animation-duration")==="0s"||a.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}r&&this._onShow(),this._animationsDisabled&&(n.classList.add("_mat-animation-noopable"),this._finalizeAnimation(r))}};e.\u0275fac=function(n){return new(n||e)(Te(Xi),Te(qt),Te(rs,8))},e.\u0275cmp=Tt({type:e,selectors:[["mat-tooltip-component"]],viewQuery:function(n,o){if(n&1&&Ii(hXt,7),n&2){let s;ai(s=li())&&(o._tooltip=s.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(n,o){n&1&&At("mouseleave",function(a){return o._handleMouseLeave(a)})},standalone:!0,features:[zt],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(n,o){if(n&1){let s=eo();ae(0,"div",1,0),At("animationend",function(c){return _i(s),yi(o._handleAnimationEnd(c))}),ae(2,"div",2),_e(3),ne()()}n&2&&(hi("mdc-tooltip--multiline",o._isMultiline),ht("ngClass",o.tooltipClass),Ye(3),zn(o.message))},dependencies:[JC],styles:['.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-app-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-app-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-app-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-app-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-app-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-app-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-app-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-app-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0});let t=e;return t})();var Vz=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({providers:[pXt],imports:[DL,Wn,Wd,oi,oi,Vd]});let t=e;return t})();var P9e=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[oi,oi]});let t=e;return t})();var L9e=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Mt({type:e}),e.\u0275inj=Dt({imports:[nx,Wn,oi,E_,JW,P9e]});let t=e;return t})();var CXt=()=>[400,200,150],xXt=()=>[100,400,150,100],F9e=(()=>{let e=class e{ngOnChanges(r){r.data&&this.processData(this.data)}constructor(r,n){this.translocoService=r,this.InteractionService=n,this.subject_table=[],this.file_content_table=[],this.downloads_graph_data=[],this.datasets_graph_data=[],this.files_graph_data=[],this.users_graph_data=[],this.size_graph_data=[],this.name_dropdown_data=[],this.barChartDataDownloadsAgg_data=[],this.barChartDataDatasetsAgg_data=[],this.barChartDataFiles_Aggdata=[],this.barChartDataUsers_Aggdata=[],this.barChartDataSize_Aggdata=[],this.pieChartDataSubject_data=[],this.pieChartLabelsSubject=[],this.pieChartDataSubject=[],this.pieChartDataFile_data=[],this.pieChartLabelsFile=[],this.pieChartDataFile=[],this.barChartDataDownloads_data=[],this.barChartDataDownloads={labels:[],datasets:[]},this.barChartDataDatasets_data=[],this.barChartDataDatasets={labels:[],datasets:[]},this.barChartDataFiles_data=[],this.barChartDataFiles={labels:[],datasets:[]},this.barChartDataUsers_data=[],this.barChartDataUsers={labels:[],datasets:[]},this.barChartDataSize_data=[],this.barChartDataSize={labels:[],datasets:[]},this.subject_columns=[],this.file_content_columns=[],this.months=[],this.downloads_labels=[],this.datasets_labels=[],this.file_labels=[],this.user_labels=[],this.storage_usage=[],this.subjectTranslations={},this.fileTranslations={}}processData(r){console.log("yoyoyo",r),this.barChartDataDownloads_data=r.downloads_graph_data,this.barChartDataDatasets_data=r.datasets_graph_data,this.barChartDataFiles_data=r.files_graph_data,this.barChartDataUsers_data=r.users_graph_data,this.barChartDataSize_data=r.size_graph_data,this.barChartDataDownloadsAgg_data=r.downloads_graph_agg_data,this.barChartDataDatasetsAgg_data=r.datasets_graph_agg_data,this.barChartDataFiles_Aggdata=r.files_graph_agg_data,this.barChartDataUsers_Aggdata=r.users_graph_agg_data,this.barChartDataSize_Aggdata=r.size_graph_agg_data,this.pieChartLabelsSubject=r.subject_label_data,this.pieChartDataSubject_data=r.subject_data,this.pieChartLabelsFile=r.file_content_label_data,this.pieChartDataFile_data=r.file_content_data,this.subject_table=r.subject_full_data,this.file_content_table=r.file_content_full_data,this.months=r.months,this.translocoService.selectTranslateObject(["MonthlyFileDownloads","MonthlyDatasetsPublished","MonthlyFilePublished","MonthlyUsersJoined","MonthlyAuthorsRegistered","MonthlyStorageUsed","CumulativeFileDownloads","CumulativeDatasetsPublished","CumulativeFilePublished","CumulativeUsersJoined","CumulativeAuthorsRegistered","CumulativeStorageUsed","Subject","Count","Distribution","FileType","SpecificFileType","SocialSciences","EarthandEnvironmentalSciences","Other","MedicineHealthandLifeSciences","ArtsandHumanities","Engineering","AgriculturalSciences","ComputerandInformationScience","Physics","Chemistry","BusinessandManagement","Law","MathematicalSciences","AstronomyandAstrophysics","image","text","application","video","audio","model","type","chemical","biosequence","multipart"]).subscribe(([n,o,s,a,c,d,u,h,p,f,m,g,y,w,x,T,M,B,G,F,O,V,J,N,P,$,K,ve,W,ee,te,se,Ae,k,S,I,X,Q,le,xe,Re])=>{let Oe={"Social Sciences":B,"Earth and Environmental Sciences":G,Other:F,"Medicine, Health and Life Sciences":O,"Arts and Humanities":V,Engineering:J,"Agricultural Sciences":N,"Computer and Information Science":P,Physics:$,Chemistry:K,"Business and Management":ve,Law:W,"Mathematical Sciences":ee,"Astronomy and Astrophysics":te},We={image:se,text:Ae,application:k,video:S,audio:I,model:X,type:Q,chemical:le,biosequence:xe,multipart:Re};this.subject_table=r.subject_full_data.map(Ne=>Lt(Ke({},Ne),{subject:Oe[Ne.subject]||Ne.subject})),this.pieChartLabelsSubject=r.subject_label_data.map(Ne=>Oe[Ne]||Ne),this.file_content_table=r.file_content_full_data.map(Ne=>Lt(Ke({},Ne),{type:We[Ne.type]||Ne.type})),this.pieChartLabelsFile=r.file_content_label_data.map(Ne=>We[Ne]||Ne),this.downloads_labels=[n,u],this.datasets_labels=[o,h],this.file_labels=[s,p],this.user_labels=[a,f],this.storage_usage=[d,g];let Le=this.months;this.barChartDataDownloads={labels:Le,datasets:[{data:this.barChartDataDownloadsAgg_data,label:n,backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataDownloads_data,label:u,backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.barChartDataDatasets={labels:Le,datasets:[{data:this.barChartDataDatasetsAgg_data,label:o,backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataDatasets_data,label:h,backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.barChartDataFiles={labels:Le,datasets:[{data:this.barChartDataFiles_Aggdata,label:s,backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataFiles_data,label:p,backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.barChartDataUsers={labels:Le,datasets:[{data:this.barChartDataUsers_Aggdata,label:this.user_labels[0],backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataUsers_data,label:this.user_labels[1],backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.barChartDataSize={labels:Le,datasets:[{data:this.barChartDataSize_Aggdata,label:d,backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataSize_data,label:g,backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.subject_columns=[{data:"subject",readOnly:"true",title:y},{data:"count",readOnly:"true",title:w},{data:"percent",readOnly:"true",title:x}],this.file_content_columns=[{data:"type",readOnly:"true",title:T},{data:"contenttype",readOnly:"true",title:M},{data:"count",readOnly:"true",title:w},{data:"percent",readOnly:"true",title:x}]}),this.pieChartDataSubject=[{data:this.pieChartDataSubject_data,label:"Subject Breakdown"}],this.pieChartDataFile=[{data:this.pieChartDataFile_data,label:"File Content Breakdown"}],console.log("yoyoyoyoyo",this.barChartDataDownloads)}downloadSubject(){this.InteractionService.triggerGenerateSubject()}downloadFile(){this.InteractionService.triggerGenerateFile()}};e.\u0275fac=function(n){return new(n||e)(Te(id),Te(yR))},e.\u0275cmp=Tt({type:e,selectors:[["app-graph-dashboard"]],inputs:{data:"data",selectedCollection_Activate_Name:"selectedCollection_Activate_Name"},standalone:!0,features:[Li,zt],decls:48,vars:48,consts:[[2,"display","inline-block","height","200px","padding","30px","padding-top","20px","font-size","18px"],["id","pdf_bargraphs"],[1,"graph-title"],[1,"graph-section",3,"barChartData"],[1,"graph-title",2,"padding-top","20px"],["id","subjectGraphTitle",2,"padding-top","20px"],[1,"hide-scrollbar",2,"border","1px solid lightgray"],["appearance","outlined",1,"example-card",2,"min-width","750px","max-width","750px","min-height","333px","max-height","300px","justify-content","center"],["mat-button","","extended","",2,"position","absolute","height","28px","width","12px","top","4px","right","4px","font-size","12px","border-style","dotted","border-width","1px",3,"click"],[2,"font-size","16px","height","16px","width","12px","display","block","line-height","1","margin-left","10px"],["id","subjectGraph"],["width","520","height","200",3,"pieChartLabels","pieChartData"],["id","hot",1,"hide-scrollbar"],["licenseKey","non-commercial-and-evaluation",1,"hide-scrollbar",3,"data","colHeaders","colWidths","rowHeaders","height","columnSorting","columns","filters"],[1,"hide-scrollbar",2,"margin-top","20px"],["id","fileGraphTitle"],[1,"hide-scrollbar",2,"margin-top","5px","border","1px solid lightgray"],["id","fileGraph"],["width","380","height","200",3,"pieChartLabels","pieChartData"]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"div",1)(2,"div",2),_e(3),br(4,"transloco"),ne(),bt(5,"app-horizontal-bar-graph",3),ae(6,"div",4),_e(7),br(8,"transloco"),ne(),bt(9,"app-horizontal-bar-graph",3),ae(10,"div",4),_e(11),br(12,"transloco"),ne(),bt(13,"app-horizontal-bar-graph",3),ae(14,"div",4),_e(15),br(16,"transloco"),ne(),bt(17,"app-horizontal-bar-graph",3),ae(18,"div",4),_e(19),br(20,"transloco"),ne(),bt(21,"app-horizontal-bar-graph",3),ne(),ae(22,"p",5),_e(23),br(24,"transloco"),ne(),ae(25,"div",6)(26,"mat-card",7)(27,"button",8),At("click",function(){return o.downloadSubject()}),ae(28,"mat-icon",9),_e(29,"download"),ne()(),ae(30,"mat-card-content",10),bt(31,"app-pie-graph",11),ne()(),ae(32,"div",12),bt(33,"app-generic-table",13),ne()(),bt(34,"div",14),ae(35,"p",15),_e(36),br(37,"transloco"),ne(),bt(38,"p"),ae(39,"div",16)(40,"mat-card",7)(41,"button",8),At("click",function(){return o.downloadFile}),ae(42,"mat-icon",9),_e(43,"download"),ne()(),ae(44,"mat-card-content",17),bt(45,"app-pie-graph",18),ne()(),ae(46,"div",12),bt(47,"app-generic-table",13),ne()()()),n&2&&(Ye(3),ji(" ",_r(4,32,"NumberofDownloads")," "),Ye(2),ht("barChartData",o.barChartDataDownloads),Ye(2),ji(" ",_r(8,34,"NumberofDatasets")," "),Ye(2),ht("barChartData",o.barChartDataDatasets),Ye(2),ji(" ",_r(12,36,"NumberofFiles")," "),Ye(2),ht("barChartData",o.barChartDataFiles),Ye(2),ji(" ",_r(16,38,o.selectedCollection_Activate_Name==="(All)"?"Numberofusers":"Numberofauthors")," "),Ye(2),ht("barChartData",o.barChartDataUsers),Ye(2),ji(" ",_r(20,40,"StorageUsage")," "),Ye(2),ht("barChartData",o.barChartDataSize),Ye(2),ji(" ",_r(24,42,"SubjectBreakdown")," "),Ye(8),ht("pieChartLabels",o.pieChartLabelsSubject)("pieChartData",o.pieChartDataSubject),Ye(2),ht("data",o.subject_table)("colHeaders",!0)("colWidths",_W(46,CXt))("rowHeaders",!1)("height",250)("columnSorting",!0)("columns",o.subject_columns)("filters",!1),Ye(3),ji(" ",_r(37,44,"FileContentBreakdown")," "),Ye(9),ht("pieChartLabels",o.pieChartLabelsFile)("pieChartData",o.pieChartDataFile),Ye(2),ht("data",o.file_content_table)("colHeaders",!0)("colWidths",_W(47,xXt))("rowHeaders",!1)("height",250)("columnSorting",!0)("columns",o.file_content_columns)("filters",!1))},dependencies:[Vge,jge,Dv,Iv,Gu,$d,sE,nE,oE,Gx,Mv,tRe]});let t=e;return t})();var SXt=t=>({color:t}),EXt=(t,e)=>({color:t,"font-weight":e});function TXt(t,e){t&1&&(ae(0,"div"),_e(1),br(2,"transloco"),ne()),t&2&&(Ye(),ji(" ",_r(2,1,"Collections")," "))}function RXt(t,e){t&1&&(ae(0,"div"),_e(1),br(2,"transloco"),ne()),t&2&&(Ye(),ji(" ",_r(2,1,"Collections")," "))}var H9e=(()=>{let e=class e{constructor(r,n,o){this.translocoService=r,this.interactionService=n,this.decimalPipe=o,this.barChartDataDownloads_data=[],this.barChartDataDatasets_data=[],this.barChartDataFiles_data=[],this.barChartDataUsers_data=[],this.barChartDataSize_data=[],this.barChartDataDownloadsAgg_data=[],this.barChartDataDatasetsAgg_data=[],this.barChartDataFiles_Aggdata=[],this.barChartDataUsers_Aggdata=[],this.barChartDataSize_Aggdata=[],this.pieChartDataSubject_data=[],this.pieChartLabelsSubject=[],this.pieChartDataSubject=[],this.pieChartDataFile_data=[],this.pieChartLabelsFile=[],this.pieChartDataFile=[],this.total_collections_num="-",this.total_dataverses_num="-",this.total_datasets_num="-",this.total_files_num="-",this.total_downloads_num="-",this.total_users_num="-",this.total_size_num="-"}ngOnInit(){this.langSub=this.translocoService.langChanges$.subscribe(()=>{this.processData(this.data)})}ngOnDestroy(){this.langSub?.unsubscribe()}ngOnChanges(r){(r.data||r.date_start_on)&&this.processData(this.data)}getCurrentLocale(){return this.translocoService.getActiveLang()==="fr"?"fr-FR":"en-US"}formatNumber(r){return this.decimalPipe.transform(r,"1.0-0",this.getCurrentLocale())??"0"}formatDecimal(r){return this.decimalPipe.transform(r,"1.2-2",this.getCurrentLocale())??"0"}processData(r){if(r){if(this.barChartDataDownloads_data=r.downloads_graph_data,this.barChartDataDatasets_data=r.datasets_graph_data,this.barChartDataFiles_data=r.files_graph_data,this.barChartDataUsers_data=r.users_graph_data,this.barChartDataSize_data=r.size_graph_data,this.barChartDataDownloadsAgg_data=r.downloads_graph_agg_data,this.barChartDataDatasetsAgg_data=r.datasets_graph_agg_data,this.barChartDataFiles_Aggdata=r.files_graph_agg_data,this.barChartDataUsers_Aggdata=r.users_graph_agg_data,this.barChartDataSize_Aggdata=r.size_graph_agg_data,this.total_collections_num=this.formatNumber(r.name_dropdown_data?.length??0),this.selectedCollection_Activate_Name==="(All)"){let n=r.dataverse_count-r.name_dropdown_data.length;this.total_dataverses_num=this.formatNumber(n)}else this.total_dataverses_num=this.formatNumber(r.dataverse_count);if(this.date_start_on!==""){let n=this.barChartDataDatasetsAgg_data.reduce((d,u)=>d+u,0),o=this.barChartDataFiles_Aggdata.reduce((d,u)=>d+u,0),s=this.barChartDataDownloadsAgg_data.reduce((d,u)=>d+u,0),a=this.barChartDataUsers_Aggdata.reduce((d,u)=>d+u,0),c=this.barChartDataSize_Aggdata.reduce((d,u)=>d+u,0);this.total_datasets_num=this.formatNumber(n),this.total_files_num=this.formatNumber(o),this.total_downloads_num=this.formatNumber(s),this.total_users_num=this.formatNumber(a),this.total_size_num=this.formatDecimal(c)}else{let n=this.barChartDataDatasets_data.length-1;this.total_datasets_num=this.formatNumber(this.barChartDataDatasets_data[n]??0),this.total_files_num=this.formatNumber(this.barChartDataFiles_data[n]??0),this.total_downloads_num=this.formatNumber(this.barChartDataDownloads_data[n]??0),this.total_users_num=this.formatNumber(this.barChartDataUsers_data[n]??0);let o=this.barChartDataSize_data[n]??0;this.total_size_num=this.formatDecimal(o)}}}downloadExcel(){this.interactionService.triggerGenerateExcel()}downloadPDF(){this.interactionService.triggerGeneratePDF()}};e.\u0275fac=function(n){return new(n||e)(Te(id),Te(yR),Te(bL))},e.\u0275cmp=Tt({type:e,selectors:[["app-value-export-dashboard"]],inputs:{data:"data",selectedCollection_Activate_Name:"selectedCollection_Activate_Name",date_start_on:"date_start_on"},standalone:!0,features:[zi([bL]),Li,zt],decls:89,vars:44,consts:[[2,"display","inline-block","height","200px","padding-top","10px","font-size","18px"],[1,"button-grid",2,"display","grid","grid-template-columns","repeat(2, 1fr)","gap","5px",`/* space between buttons */
    max-width`,"400px"],["mat-button","",1,"mat-small",2,"border-width","1px","font-size","12px","border-style","solid","width","122px","height","25px","display","flex","justify-content","flex-start","align-items","center","gap","8px","text-align","left",3,"click","ngStyle"],["mat-button","","matTooltip","Export of previous metrics App","href","https://borealisdata.ca/metricsbackend/api/metrics/report",1,"mat-small",2,"border-width","1px","font-size","12px","border-style","solid","width","122px","height","25px","display","flex","justify-content","flex-start","align-items","center","gap","8px","text-align","left"],["matTooltip","Expected for future release",2,"display","inline-block",3,"matTooltipDisabled"],["mat-button","",1,"mat-small",2,"border-width","1px","font-size","9px","border-style","solid","width","122px","height","25px","display","flex","justify-content","flex-start","align-items","center","gap","8px","text-align","left",3,"disabled"],["appearance","outlined","id","pdf_collections_num",1,"example-card",2,"min-width","250px","max-width","250px","margin-bottom","8px","margin-top","10px","background-color","white !important","box-shadow","none !important"],[4,"ngIf"],["id","total_collections_num",2,"text-align","right","color","black","font-size","20px"],["appearance","outlined","id","pdf_datasets_num",1,"example-card",2,"min-width","250px","max-width","250px","margin-bottom","8px","margin-top","10px","background-color","white !important","box-shadow","none !important"],["id","total_datasets_num",2,"text-align","right","color","black","font-size","20px"],["appearance","outlined","id","pdf_files_num",1,"example-card",2,"min-width","250px","max-width","250px","margin-bottom","8px","margin-top","10px","background-color","white !important","box-shadow","none !important"],["id","total_files_num",2,"text-align","right","color","black","font-size","20px"],["appearance","outlined","id","pdf_downloads_nums",1,"example-card",2,"min-width","250px","max-width","250px","margin-bottom","8px","margin-top","10px","background-color","white !important","box-shadow","none !important"],["id","total_downloads_num",2,"text-align","right","color","black","font-size","20px"],["appearance","outlined","id","pdf_users_nums",1,"example-card",2,"min-width","250px","max-width","250px","margin-bottom","8px","margin-top","10px","background-color","white !important","box-shadow","none !important"],["id","total_users_num",2,"text-align","right","color","black","font-size","20px"],["appearance","outlined","id","pdf_storage_nums",1,"example-card",2,"min-width","250px","max-width","250px","margin-bottom","8px","margin-top","10px","background-color","white !important","box-shadow","none !important"],["id","total_size_num",2,"text-align","right","color","black","font-size","20px"]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"div",1)(2,"button",2),At("click",function(){return o.downloadExcel()}),ae(3,"mat-icon"),_e(4," download "),ne(),_e(5),br(6,"transloco"),ne(),ae(7,"button",2),At("click",function(){return o.downloadPDF()}),ae(8,"mat-icon"),_e(9," download "),ne(),_e(10),br(11,"transloco"),ne(),ae(12,"a",3)(13,"mat-icon"),_e(14," download "),ne(),_e(15),br(16,"transloco"),ne(),ae(17,"span",4)(18,"button",5)(19,"mat-icon"),_e(20," download "),ne(),_e(21," MakeDataCount "),ne()()(),ae(22,"mat-card",6)(23,"mat-card-header")(24,"mat-card-title-group")(25,"mat-card-title"),wi(26,TXt,3,3,"div",7)(27,RXt,3,3,"div",7),ne()()(),ae(28,"mat-card-content")(29,"h1",8)(30,"b"),_e(31),ne()()()(),ae(32,"mat-card",9)(33,"mat-card-header")(34,"mat-card-title-group")(35,"mat-card-title"),_e(36),br(37,"transloco"),ne(),bt(38,"mat-card-subtitle"),ne()(),ae(39,"mat-card-content")(40,"h1",10)(41,"b"),_e(42),ne()()()(),ae(43,"mat-card",11)(44,"mat-card-header")(45,"mat-card-title-group")(46,"mat-card-title"),_e(47),br(48,"transloco"),ne(),bt(49,"mat-card-subtitle"),ne()(),ae(50,"mat-card-content")(51,"h1",12)(52,"b"),_e(53),ne()()()(),ae(54,"mat-card",13)(55,"mat-card-header")(56,"mat-card-title-group")(57,"mat-card-title"),_e(58),br(59,"transloco"),ne(),bt(60,"mat-card-subtitle"),ne()(),ae(61,"mat-card-content")(62,"h1",14)(63,"b"),_e(64),ne()()()(),ae(65,"mat-card",15)(66,"mat-card-header")(67,"mat-card-title-group")(68,"mat-card-title"),_e(69),br(70,"transloco"),ne(),bt(71,"mat-card-subtitle"),ne()(),ae(72,"mat-card-content")(73,"h1",16)(74,"b"),_e(75),ne()()()(),ae(76,"mat-card",17)(77,"mat-card-header")(78,"mat-card-title-group")(79,"mat-card-title"),_e(80),br(81,"transloco"),ne(),bt(82,"mat-card-subtitle"),ne()(),ae(83,"mat-card-content")(84,"h1",18)(85,"b"),_e(86),br(87,"transloco"),ne()()()()(),bt(88,"div")),n&2&&(Ye(2),ht("ngStyle",yW(39,SXt,o.selectedCollection_Activate_Name!="(All)"?"purple":"black")),Ye(3),ji(" ",_r(6,21,"Excel")," "),Ye(2),ht("ngStyle",oA(41,EXt,o.selectedCollection_Activate_Name!="(All)"?"purple":"black",o.selectedCollection_Activate_Name!="(All)"?"bold":"=normal")),Ye(3),ji(" ",_r(11,23,"PDF")," "),Ye(5),ji(" ",_r(16,25,"Legacy")," "),Ye(2),ht("matTooltipDisabled",!1),Ye(),ht("disabled",!0),Ye(8),ht("ngIf",o.selectedCollection_Activate_Name=="(All)"),Ye(),ht("ngIf",o.selectedCollection_Activate_Name!="(All)"),Ye(4),zn(o.total_collections_num),Ye(5),ji(" ",_r(37,27,"Datasets")," "),Ye(6),zn(o.total_datasets_num),Ye(5),ji(" ",_r(48,29,"Files")," "),Ye(6),zn(o.total_files_num),Ye(5),ji(" ",_r(59,31,"Downloads")," "),Ye(6),zn(o.total_downloads_num),Ye(5),ji(" ",_r(70,33,"Users")," "),Ye(6),zn(o.total_users_num),Ye(5),ji(" ",_r(81,35,"StorageUsage")," "),Ye(6),vde("",o.total_size_num," ",_r(87,37,"GB")," "))},dependencies:[Wn,ex,gL,nE,T4,S4,x4,E4,oE,Mv,Gu,$ge,$d,Dv,Iv,Vz,Bz]});let t=e;return t})();var UXt=U(nl()),Y9e=U(nl());function AXt(t,e){}var gC=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}};var Hce=(()=>{let e=class e extends ux{constructor(r,n,o,s,a,c,d,u){super(),this._elementRef=r,this._focusTrapFactory=n,this._config=s,this._interactivityChecker=a,this._ngZone=c,this._overlayRef=d,this._focusMonitor=u,this._platform=Jt(yr),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=Jt(Xi),this._injector=Jt(kn),this._isDestroyed=!1,this.attachDomPortal=h=>{this._portalOutlet.hasAttached();let p=this._portalOutlet.attachDomPortal(h);return this._contentAttached(),p},this._document=o,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(r){this._ariaLabelledByQueue.push(r),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(r){let n=this._ariaLabelledByQueue.indexOf(r);n>-1&&(this._ariaLabelledByQueue.splice(n,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(r){this._portalOutlet.hasAttached();let n=this._portalOutlet.attachComponentPortal(r);return this._contentAttached(),n}attachTemplatePortal(r){this._portalOutlet.hasAttached();let n=this._portalOutlet.attachTemplatePortal(r);return this._contentAttached(),n}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(r,n){this._interactivityChecker.isFocusable(r)||(r.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let o=()=>{r.removeEventListener("blur",o),r.removeEventListener("mousedown",o),r.removeAttribute("tabindex")};r.addEventListener("blur",o),r.addEventListener("mousedown",o)})),r.focus(n)}_focusByCssSelector(r,n){let o=this._elementRef.nativeElement.querySelector(r);o&&this._forceFocus(o,n)}_trapFocus(){this._isDestroyed||ed(()=>{let r=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||r.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement()||this._focusDialogContainer();break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus);break}},{injector:this._injector})}_restoreFocus(){let r=this._config.restoreFocus,n=null;if(typeof r=="string"?n=this._document.querySelector(r):typeof r=="boolean"?n=r?this._elementFocusedBeforeDialogWasOpened:null:r&&(n=r),this._config.restoreFocus&&n&&typeof n.focus=="function"){let o=tv(),s=this._elementRef.nativeElement;(!o||o===this._document.body||o===s||s.contains(o))&&(this._focusMonitor?(this._focusMonitor.focusVia(n,this._closeInteractionType),this._closeInteractionType=null):n.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){let r=this._elementRef.nativeElement,n=tv();return r===n||r.contains(n)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=tv()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(fA),Te(ir,8),Te(gC),Te(hA),Te(ni),Te(tm),Te(Qp))},e.\u0275cmp=Tt({type:e,selectors:[["cdk-dialog-container"]],viewQuery:function(n,o){if(n&1&&Ii(sv,7),n&2){let s;ai(s=li())&&(o._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(n,o){n&2&&mi("id",o._config.id||null)("role",o._config.role)("aria-modal",o._config.ariaModal)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null)},standalone:!0,features:[vr,zt],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(n,o){n&1&&wi(0,AXt,0,0,"ng-template",0)},dependencies:[sv],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2});let t=e;return t})(),FP=class{constructor(e,i){this.overlayRef=e,this.config=i,this.closed=new Ft,this.disableClose=i.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=i.id,this.keydownEvents.subscribe(r=>{r.keyCode===27&&!this.disableClose&&!jo(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{i.closeOnOverlayDetachments!==!1&&this.close()})}close(e,i){if(this.containerInstance){let r=this.closed;this.containerInstance._closeInteractionType=i?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),r.next(e),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",i=""){return this.overlayRef.updateSize({width:e,height:i}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}},IXt=new St("DialogScrollStrategy",{providedIn:"root",factory:()=>{let t=Jt($r);return()=>t.scrollStrategies.block()}}),DXt=new St("DialogData"),MXt=new St("DefaultDialogConfig");var kXt=0,B9e=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(r,n,o,s,a,c){this._overlay=r,this._injector=n,this._defaultOptions=o,this._parentDialog=s,this._overlayContainer=a,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Ft,this._afterOpenedAtThisLevel=new Ft,this._ariaHiddenElements=new Map,this.afterAllClosed=YC(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Fs(void 0))),this._scrollStrategy=c}open(r,n){let o=this._defaultOptions||new gC;n=Ke(Ke({},o),n),n.id=n.id||`cdk-dialog-${kXt++}`,n.id&&this.getDialogById(n.id);let s=this._getOverlayConfig(n),a=this._overlay.create(s),c=new FP(a,n),d=this._attachContainer(a,c,n);return c.containerInstance=d,this._attachDialogContent(r,c,d,n),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(c),c.closed.subscribe(()=>this._removeOpenDialog(c,!0)),this.afterOpened.next(c),c}closeAll(){Fce(this.openDialogs,r=>r.close())}getDialogById(r){return this.openDialogs.find(n=>n.id===r)}ngOnDestroy(){Fce(this._openDialogsAtThisLevel,r=>{r.config.closeOnDestroy===!1&&this._removeOpenDialog(r,!1)}),Fce(this._openDialogsAtThisLevel,r=>r.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(r){let n=new mf({positionStrategy:r.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:r.scrollStrategy||this._scrollStrategy(),panelClass:r.panelClass,hasBackdrop:r.hasBackdrop,direction:r.direction,minWidth:r.minWidth,minHeight:r.minHeight,maxWidth:r.maxWidth,maxHeight:r.maxHeight,width:r.width,height:r.height,disposeOnNavigation:r.closeOnNavigation});return r.backdropClass&&(n.backdropClass=r.backdropClass),n}_attachContainer(r,n,o){let s=o.injector||o.viewContainerRef?.injector,a=[{provide:gC,useValue:o},{provide:FP,useValue:n},{provide:tm,useValue:r}],c;o.container?typeof o.container=="function"?c=o.container:(c=o.container.type,a.push(...o.container.providers(o))):c=Hce;let d=new qu(c,o.viewContainerRef,kn.create({parent:s||this._injector,providers:a}),o.componentFactoryResolver);return r.attach(d).instance}_attachDialogContent(r,n,o,s){if(r instanceof Pl){let a=this._createInjector(s,n,o,void 0),c={$implicit:s.data,dialogRef:n};s.templateContext&&(c=Ke(Ke({},c),typeof s.templateContext=="function"?s.templateContext():s.templateContext)),o.attachTemplatePortal(new ov(r,null,c,a))}else{let a=this._createInjector(s,n,o,this._injector),c=o.attachComponentPortal(new qu(r,s.viewContainerRef,a,s.componentFactoryResolver));n.componentRef=c,n.componentInstance=c.instance}}_createInjector(r,n,o,s){let a=r.injector||r.viewContainerRef?.injector,c=[{provide:DXt,useValue:r.data},{provide:FP,useValue:n}];return r.providers&&(typeof r.providers=="function"?c.push(...r.providers(n,r,o)):c.push(...r.providers)),r.direction&&(!a||!a.get(ss,null,{optional:!0}))&&c.push({provide:ss,useValue:{value:r.direction,change:qi()}}),kn.create({parent:a||s,providers:c})}_removeOpenDialog(r,n){let o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,a)=>{s?a.setAttribute("aria-hidden",s):a.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),n&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){let r=this._overlayContainer.getContainerElement();if(r.parentElement){let n=r.parentElement.children;for(let o=n.length-1;o>-1;o--){let s=n[o];s!==r&&s.nodeName!=="SCRIPT"&&s.nodeName!=="STYLE"&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){let r=this._parentDialog;return r?r._getAfterAllClosed():this._afterAllClosedAtThisLevel}};e.\u0275fac=function(n){return new(n||e)(lt($r),lt(kn),lt(MXt,8),lt(e,12),lt(wx),lt(IXt))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Fce(t,e){let i=t.length;for(;i--;)e(t[i])}function OXt(t,e){}var HP=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}},Bce="mdc-dialog--open",V9e="mdc-dialog--opening",j9e="mdc-dialog--closing",NXt=150,PXt=75,LXt=(()=>{let e=class e extends Hce{constructor(r,n,o,s,a,c,d,u,h){super(r,n,o,s,a,c,d,h),this._animationMode=u,this._animationStateChanged=new Nt,this._animationsEnabled=this._animationMode!=="NoopAnimations",this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?W9e(this._config.enterAnimationDuration)??NXt:0,this._exitAnimationDuration=this._animationsEnabled?W9e(this._config.exitAnimationDuration)??PXt:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(z9e,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(V9e,Bce)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(Bce),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(Bce),this._animationsEnabled?(this._hostElement.style.setProperty(z9e,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(j9e)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(r){this._actionSectionCount+=r,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(V9e,j9e)}_waitForAnimationToComplete(r,n){this._animationTimer!==null&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(n,r)}_requestAnimationFrame(r){this._ngZone.runOutsideAngular(()=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(r):r()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(r){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:r})}ngOnDestroy(){super.ngOnDestroy(),this._animationTimer!==null&&clearTimeout(this._animationTimer)}attachComponentPortal(r){let n=super.attachComponentPortal(r);return n.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),n}};e.\u0275fac=function(n){return new(n||e)(Te(qt),Te(fA),Te(ir,8),Te(HP),Te(hA),Te(ni),Te(tm),Te(rs,8),Te(Qp))},e.\u0275cmp=Tt({type:e,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(n,o){n&2&&(il("id",o._config.id),mi("aria-modal",o._config.ariaModal)("role",o._config.role)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null),hi("_mat-animation-noopable",!o._animationsEnabled)("mat-mdc-dialog-container-with-actions",o._actionSectionCount>0))},standalone:!0,features:[vr,zt],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"div",1),wi(2,OXt,0,0,"ng-template",2),ne()())},dependencies:[sv],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12));border-radius:var(--mdc-dialog-container-shape, var(--mat-app-corner-extra-large, 4px));background-color:var(--mdc-dialog-container-color, var(--mat-app-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mdc-dialog-subhead-color, var(--mat-app-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mdc-dialog-subhead-font, var(--mat-app-headline-small-font, inherit));line-height:var(--mdc-dialog-subhead-line-height, var(--mat-app-headline-small-line-height, 1.5rem));font-size:var(--mdc-dialog-subhead-size, var(--mat-app-headline-small-size, 1rem));font-weight:var(--mdc-dialog-subhead-weight, var(--mat-app-headline-small-weight, 400));letter-spacing:var(--mdc-dialog-subhead-tracking, var(--mat-app-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mdc-dialog-supporting-text-color, var(--mat-app-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mdc-dialog-supporting-text-font, var(--mat-app-body-medium-font, inherit));line-height:var(--mdc-dialog-supporting-text-line-height, var(--mat-app-body-medium-line-height, 1.5rem));font-size:var(--mdc-dialog-supporting-text-size, var(--mat-app-body-medium-size, 1rem));font-weight:var(--mdc-dialog-supporting-text-weight, var(--mat-app-body-medium-weight, 400));letter-spacing:var(--mdc-dialog-supporting-text-tracking, var(--mat-app-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.cdk-high-contrast-active .mat-mdc-dialog-actions{border-top-color:CanvasText}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}'],encapsulation:2});let t=e;return t})(),z9e="--mat-dialog-transition-duration";function W9e(t){return t==null?null:typeof t=="number"?t:t.endsWith("ms")?Zp(t.substring(0,t.length-2)):t.endsWith("s")?Zp(t.substring(0,t.length-1))*1e3:t==="0"?0:null}var jz=function(t){return t[t.OPEN=0]="OPEN",t[t.CLOSING=1]="CLOSING",t[t.CLOSED=2]="CLOSED",t}(jz||{}),Ag=class{constructor(e,i,r){this._ref=e,this._containerInstance=r,this._afterOpened=new Ft,this._beforeClosed=new Ft,this._state=jz.OPEN,this.disableClose=i.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),r._animationStateChanged.pipe(Ls(n=>n.state==="opened"),Vo(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(Ls(n=>n.state==="closed"),Vo(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),Ra(this.backdropClick(),this.keydownEvents().pipe(Ls(n=>n.keyCode===27&&!this.disableClose&&!jo(n)))).subscribe(n=>{this.disableClose||(n.preventDefault(),FXt(this,n.type==="keydown"?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(Ls(i=>i.state==="closing"),Vo(1)).subscribe(i=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),i.totalTime+100)}),this._state=jz.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let i=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?i.left(e.left):i.right(e.right):i.centerHorizontally(),e&&(e.top||e.bottom)?e.top?i.top(e.top):i.bottom(e.bottom):i.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",i=""){return this._ref.updateSize(e,i),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=jz.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}};function FXt(t,e,i){return t._closeInteractionType=e,t.close(i)}var HXt=new St("MatMdcDialogData"),BXt=new St("mat-mdc-dialog-default-options"),VXt=new St("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{let t=Jt($r);return()=>t.scrollStrategies.block()}});var jXt=0,U9e=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){let r=this._parentDialog;return r?r._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(r,n,o,s,a,c,d,u){this._overlay=r,this._defaultOptions=s,this._scrollStrategy=a,this._parentDialog=c,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Ft,this._afterOpenedAtThisLevel=new Ft,this.dialogConfigClass=HP,this.afterAllClosed=YC(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Fs(void 0))),this._dialog=n.get(B9e),this._dialogRefConstructor=Ag,this._dialogContainerType=LXt,this._dialogDataToken=HXt}open(r,n){let o;n=Ke(Ke({},this._defaultOptions||new HP),n),n.id=n.id||`mat-mdc-dialog-${jXt++}`,n.scrollStrategy=n.scrollStrategy||this._scrollStrategy();let s=this._dialog.open(r,Lt(Ke({},n),{positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:n},{provide:gC,useValue:n}]},templateContext:()=>({dialogRef:o}),providers:(a,c,d)=>(o=new this._dialogRefConstructor(a,n,d),o.updatePosition(n?.position),[{provide:this._dialogContainerType,useValue:d},{provide:this._dialogDataToken,useValue:c.data},{provide:this._dialogRefConstructor,useValue:o}])}));return o.componentRef=s.componentRef,o.componentInstance=s.componentInstance,this.openDialogs.push(o),this.afterOpened.next(o),o.afterClosed().subscribe(()=>{let a=this.openDialogs.indexOf(o);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||this._getAfterAllClosed().next())}),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(r){return this.openDialogs.find(n=>n.id===r)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(r){let n=r.length;for(;n--;)r[n].close()}};e.\u0275fac=function(n){return new(n||e)(lt($r),lt(kn),lt(mL,8),lt(BXt,8),lt(VXt),lt(e,12),lt(wx),lt(rs,8))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var q9e=(()=>{let e=class e{constructor(r){this.translocoService=r}switchLanguage(r){this.translocoService.setActiveLang(r)}getLanguage(){return this.translocoService.getActiveLang()}};e.\u0275fac=function(n){return new(n||e)(lt(id))},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var qXt=["input"];function YXt(t,e){t&1&&bt(0,"mat-progress-bar",18)}function $Xt(t,e){t&1&&bt(0,"div",19)}function GXt(t,e){t&1&&(ae(0,"div",48)(1,"h1",49),_e(2),br(3,"transloco"),ne()()),t&2&&(Ye(2),zn(_r(3,1,"All")))}function XXt(t,e){if(t&1&&(ae(0,"div",48)(1,"h4",50)(2,"b"),_e(3," \u2022 Collection Selected \u2022 "),ne()(),ae(4,"h1",49),_e(5),ne()()),t&2){let i=$t(2);Ye(5),zn(i.selectedCollection_Activate_Name)}}function KXt(t,e){t&1&&(ae(0,"div",51)(1,"p")(2,"i"),_e(3),br(4,"transloco"),ne()()()),t&2&&(Ye(3),ji("",_r(4,1,"ErrorMessage1")," "))}function ZXt(t,e){t&1&&bt(0,"input",52)}function QXt(t,e){if(t&1&&bt(0,"input",36),t&2){$t();let i=Js(29),r=$t();ht("matDatepicker",i)("formControl",r.date_start)("min",r.creation_date)("max",r.todayDate)}}function JXt(t,e){if(t&1&&(ae(0,"mat-datepicker-toggle",37)(1,"mat-icon",38),_e(2,"event"),ne()()),t&2){$t();let i=Js(29);ht("for",i)("disableRipple",!0)}}function eKt(t,e){if(t&1){let i=eo();ae(0,"div",20),wi(1,GXt,4,3,"div",21)(2,XXt,6,1,"div",21),ae(3,"div",22)(4,"p")(5,"i"),_e(6),ne()()(),wi(7,KXt,5,3,"div",23),ne(),bt(8,"hr",24),ae(9,"div",25)(10,"div",26)(11,"div",27)(12,"mat-card",28)(13,"mat-card-header")(14,"mat-card-title-group")(15,"mat-card-title"),_e(16),br(17,"transloco"),ne(),bt(18,"mat-card-subtitle"),ne()(),ae(19,"mat-card-content",29)(20,"div",30)(21,"mat-form-field",31)(22,"mat-label"),_e(23),br(24,"transloco"),ne(),wi(25,ZXt,1,0,"input",32)(26,QXt,1,4,"input",33)(27,JXt,3,2,"mat-datepicker-toggle",34),ae(28,"mat-datepicker",35,1),At("monthSelected",function(n){_i(i);let o=Js(29),s=$t();return yi(s.setStartMonthAndYear(n,o))}),ne()(),ae(30,"mat-form-field",31)(31,"mat-label"),_e(32),br(33,"transloco"),ne(),bt(34,"input",36),ae(35,"mat-datepicker-toggle",37)(36,"mat-icon",38),_e(37,"event"),ne()(),ae(38,"mat-datepicker",35,2),At("monthSelected",function(n){_i(i);let o=Js(39),s=$t();return yi(s.setEndMonthAndYear(n,o))}),ne()()(),ae(40,"div",39)(41,"mat-checkbox",40),At("ngModelChange",function(n){_i(i);let o=$t();return yi(o.start_on=!n)}),_e(42),br(43,"transloco"),ne(),ae(44,"div",41)(45,"button",42),At("click",function(){_i(i);let n=$t();return yi(n.CollectionDataButtonActivate())}),_e(46),br(47,"transloco"),ne()()()()(),ae(48,"mat-card",43)(49,"mat-card-header")(50,"mat-card-title-group")(51,"mat-card-title"),_e(52),br(53,"transloco"),ne(),bt(54,"mat-card-subtitle"),ne()(),ae(55,"mat-card-content")(56,"app-tree",44),At("dataEvent",function(n){_i(i);let o=$t();return yi(o.getCollectionFromTree(n))}),ne()()()()(),bt(57,"app-graph-dashboard",45)(58,"app-value-export-dashboard",46),ne(),bt(59,"div",47)}if(t&2){let i=Js(39),r=$t();Ye(),ht("ngIf",r.selectedCollection_Activate==="(All)"),Ye(),ht("ngIf",r.selectedCollection_Activate!=="(All)"),Ye(4),zn(r.date_String),Ye(),ht("ngIf",r.error_flag),Ye(9),ji(" ",_r(17,28,"DateRange")," "),Ye(7),zn(_r(24,30,"StartDate")),Ye(2),ht("ngIf",!r.start_on),Ye(),ht("ngIf",r.start_on),Ye(),ht("ngIf",r.start_on),Ye(5),zn(_r(33,32,"EndDate")),Ye(2),ht("matDatepicker",i)("formControl",r.date_end)("min",r.creation_date)("max",r.maxDate),Ye(),ht("for",i)("disableRipple",!0),Ye(6),ht("ngModel",!r.start_on),Ye(),ji(" ",_r(43,34,"AllTime")," "),Ye(3),ht("disabled",r.isStartTimeAfterEndTime()),Ye(),ji(" ",_r(47,36,"Submit")," "),Ye(6),ji(" ",_r(53,38,"CollectionTree")," "),Ye(4),ht("data",r.raw_table_data)("current_active",r.selectedCollection_Activate_Name),Ye(),ht("data",r.raw_table_data)("selectedCollection_Activate_Name",r.selectedCollection_Activate_Name),Ye(),ht("data",r.raw_table_data)("selectedCollection_Activate_Name",r.selectedCollection_Activate_Name)("date_start_on",r.date_start_activate)}}p4();var Jl=Y9e.default||UXt,tKt={parse:{dateInput:"YYYY-MM"},display:{dateInput:"YYYY-MM",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}},zz=(()=>{let e=class e{setStartMonthAndYear(r,n){this.date_start=new jd(Jl());let o=this.date_start.value??Jl();o.month(r.month()),o.year(r.year()),this.date_start.setValue(o),n.close()}setEndMonthAndYear(r,n){this.dateStringFormat();let o=this.date_end.value??Jl();o.month(r.month()),o.year(r.year()),this.date_end.setValue(o),n.close()}submitDate(){let r=this.date_start.value??Jl(),n=this.date_end.value??Jl();console.log(r,n);let o=r.format("YYYY-MM"),s=n.format("YYYY-MM");this.start_on||(this.date_start_activate="",console.log(this.date_start_activate)),this.bad_range=!1,this.start_on&&o>s&&(this.bad_range=!0,this.date_select_on=!1),this.start_on&&!this.bad_range&&(this.date_start_activate=o,this.date_end_activate=s,this.date_select_on=!0),!this.start_on&&!this.bad_range&&(this.date_end_activate=s,this.date_select_on=!0)}isStartTimeAfterEndTime(){let r=this.date_start.value,n=this.date_end.value;return!r||!n?!0:Jl(n).isBefore(Jl(r))&&this.start_on}dateStringFormat(){if(!this.monthTranslations||Object.keys(this.monthTranslations).length===0)return"";let r=this.date_end.value??Jl(),n=r.format("YYYY"),o=parseInt(r.format("MM")),a=`${this.monthTranslations[o.toString()]||""} ${n}`;if(this.start_on){let c=this.date_start.value??Jl(),d=c.format("YYYY"),u=parseInt(c.format("MM"));return`${`${this.monthTranslations[u.toString()]||""} ${d}`} - ${a}`}return`- ${a}`}getData(r){this.raw_table_data=r.DataverseTabData,this.table_data=r.DataverseTabData.table_data,this.alias_data=r.DataverseTabData.alias_data,this.subject_table=r.DataverseTabData.subject_full_data,this.file_content_table=r.DataverseTabData.file_content_full_data,this.options=this.options.concat(r.DataverseTabData.name_dropdown_data.sort()),this.searchGroups[2].names=this.options,this.selectedCollection_Current=="(All)"?this.searchGroups[1].names=[]:this.searchGroups[1].names=this.table_data.map(n=>n.name),console.log(this.searchGroups),this.months=r.DataverseTabData.months,this.creation_date=r.DataverseTabData.creation_date,this.error_flag=r.DataverseTabData.error_flag,this.pieChartLabelsSubject=r.DataverseTabData.subject_label_data,this.pieChartDataSubject_data=r.DataverseTabData.subject_data,this.pieChartLabelsFile=r.DataverseTabData.file_content_label_data,this.pieChartDataFile_data=r.DataverseTabData.file_content_data,this.total_collections_num=r.DataverseTabData.name_dropdown_data.length.toString(),this.selectedCollection_Activate_Name=="(All)"?this.total_dataverses_num=(r.DataverseTabData.dataverse_count-r.DataverseTabData.name_dropdown_data.length).toString():this.total_dataverses_num=r.DataverseTabData.dataverse_count,this.date_start_activate!=""?(console.log("ds is activated here"),this.total_datasets_num=this.barChartDataDatasetsAgg_data.reduce((n,o)=>n+o,0).toLocaleString(),this.total_files_num=this.barChartDataFiles_Aggdata.reduce((n,o)=>n+o,0).toLocaleString(),this.total_downloads_num=this.barChartDataDownloadsAgg_data.reduce((n,o)=>n+o,0).toLocaleString(),this.total_users_num=this.barChartDataUsers_Aggdata.reduce((n,o)=>n+o,0).toLocaleString(),this.total_size_num=this.barChartDataSize_Aggdata.reduce((n,o)=>n+o,0).toFixed(2).toLocaleString(),+"GB"):(this.total_datasets_num=this.barChartDataDatasets_data[this.barChartDataDatasetsAgg_data.length-1].toLocaleString(),this.total_files_num=this.barChartDataFiles_data[this.barChartDataDatasets_data.length-1].toLocaleString(),this.total_downloads_num=this.barChartDataDownloads_data[this.barChartDataDownloads_data.length-1].toLocaleString(),this.total_users_num=this.barChartDataUsers_data[this.barChartDataUsers_data.length-1].toLocaleString(),this.total_size_num=this.barChartDataSize_data[this.barChartDataSize_data.length-1].toFixed(2).toLocaleString()+"GB"),this.total_collections_change=((this.barChartDataDatasets_data[0]-this.barChartDataDatasets_data[1])/this.barChartDataDatasets_data[1]*100).toFixed(2).toString()+"%",this.translocoService.selectTranslateObject(["Subject","Count","Distribution","FileType","SpecificFileType"]).subscribe(([n,o,s,a,c])=>{let d=this.months;this.barChartDataDownloads={labels:d,datasets:[{data:this.barChartDataDownloadsAgg_data,label:"Monthly File Downloads",backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataDownloads_data,label:"Cumulative File Downloads",backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.barChartDataDatasets={labels:d,datasets:[{data:this.barChartDataDatasetsAgg_data,label:"Monthly Datasets Published",backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataDatasets_data,label:"Cumulative Datasets Published",backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.barChartDataFiles={labels:d,datasets:[{data:this.barChartDataFiles_Aggdata,label:"Monthly File Published",backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataFiles_data,label:"Cumulative File Published",backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.barChartDataUsers={labels:d,datasets:[{data:this.barChartDataUsers_Aggdata,label:"Monthly Users Joined",backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataUsers_data,label:"Cumulative Users Joined",backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.barChartDataSize={labels:d,datasets:[{data:this.barChartDataSize_Aggdata,label:"Monthly Storage Used",backgroundColor:"rgba(102, 0, 102, 0.5)",borderColor:"rgba(102, 0, 102, 0.5)",hoverBackgroundColor:"rgba(102, 0, 102, 0.7)",hoverBorderColor:"rgba(102, 0, 102, 0.7)"},{data:this.barChartDataSize_data,label:"Cumulative Storage Used",backgroundColor:"rgba(0, 100, 255, 0.5)",borderColor:"rgba(0, 100, 255, 0.5)",hoverBackgroundColor:"rgba(0, 100, 255, 0.7)",hoverBorderColor:"rgba(0, 100, 255, 0.7)"}]},this.subject_columns=[{data:"subject",readOnly:"true",title:n},{data:"count",readOnly:"true",title:o},{data:"percent",readOnly:"true",title:s}],this.file_content_columns=[{data:"type",readOnly:"true",title:a},{data:"contenttype",readOnly:"true",title:c},{data:"count",readOnly:"true",title:o},{data:"percent",readOnly:"true",title:s}]}),this.pieChartDataSubject=[{data:this.pieChartDataSubject_data,label:"Subject Breakdown"}],this.pieChartDataFile=[{data:this.pieChartDataFile_data,label:"File Content Breakdown"}],console.log(this.pieChartDataSubject)}ngOnInit(){this.translocoService.selectTranslateObject("months").subscribe(r=>{this.monthTranslations=r,this.date_String=this.dateStringFormat()}),this.searchGroupOptions=this.searchForm.get("searchGroup").valueChanges.pipe(Fs(""),Gi(r=>this._filterGroup(r||"")))}_filterGroup(r){return r?this.searchGroups.map(n=>({letter:n.letter,names:this._filter(n.names,r)})).filter(n=>n.names.length>0):this.searchGroups}selectedCollection(r){if(this.selectedCollection_Current_Name=r.value,r.value=="(All)")this.selectedCollection_Current="(All)";else for(let n=0;n<=this.alias_data.length;n++)this.alias_data[n].name==r.value&&(this.selectedCollection_Current=this.alias_data[n].alias);console.log(r.value)}getCollectionFromTree(r){r.includes("(All)")?(this.selectedCollection_Activate="(All)",this.selectedCollection_Activate_Name="(All)"):(this.receivedCollectionFromTree=r,console.log(r),this.selectedCollection_Current=r[1],this.selectedCollection_Current_Name=r[0],this.selectedCollection_Activate=this.selectedCollection_Current,this.selectedCollection_Activate_Name=this.selectedCollection_Current_Name),this.submitDate(),this.date_String=this.dateStringFormat()}selectedDate(r,n){console.log(r),console.log(n)}CollectionDataButtonActivate(){console.log(this.date_end<this.date_start),this.selectedOption=this.selectedCollection_Current_Name;var r=!1;if(this.selectedOption=="(All)")this.selectedCollection_Current="(All)",this.selectedCollection_Current_Name="(All)",r=!0;else for(let n=0;n<this.alias_data.length;n++)this.alias_data[n].name===this.selectedOption&&(console.log(this.alias_data[n].alias),this.selectedCollection_Current=this.alias_data[n].alias,this.selectedCollection_Current_Name=this.selectedOption,r=!0);r&&(this.selectedCollection_Activate=this.selectedCollection_Current,this.selectedCollection_Activate_Name=this.selectedCollection_Current_Name,this.submitDate(),this.date_String=this.dateStringFormat(),console.log(this.selectedCollection_Activate))}constructor(r,n,o,s,a,c){this._liveAnnouncer=r,this.dialog=n,this.languageService=o,this.translocoService=s,this.cdr=a,this.loadingService=c,this._formBuilder=Jt(she),this.start_on=!1,this.minDate=new Date(new Date().setMonth(new Date().getDate()<7?new Date().getMonth()-1:new Date().getMonth())),this.maxDate=new Date(new Date().setMonth(new Date().getDate()<7?new Date().getMonth()-1:new Date().getMonth())),this.date_start=new jd(Jl().date()<7?Jl().subtract(1,"month"):Jl()),this.date_end=new jd(Jl().date()<7?Jl().subtract(1,"month"):Jl()),this.date_String=this.dateStringFormat(),this.date_start_activate="",this.date_end_activate="",this.date_select_on=!1,this.todayDate=new Date(new Date().setMonth(new Date().getDate()<7?new Date().getMonth()-1:new Date().getMonth())),this.bad_range=!1,this.myControl=new jd(""),this.options=[],this.selectedOption="(All)",this.searchForm=this._formBuilder.group({searchGroup:""}),this.searchGroups=[{letter:"Default",names:["(All)"]},{letter:"Sub Dataverses",names:[]},{letter:"Collections",names:[]}],this.table_data=[],this.alias_data=[],this.raw_table_data={},this.subject_table=[],this.file_content_table=[],this.downloads_graph_data=[],this.datasets_graph_data=[],this.files_graph_data=[],this.users_graph_data=[],this.size_graph_data=[],this.name_dropdown_data=[],this.creation_date=[],this.barChartDataDownloads_data=[],this.barChartDataDownloads={labels:[],datasets:[]},this.barChartDataDatasets_data=[],this.barChartDataDatasets={labels:[],datasets:[]},this.barChartDataFiles_data=[],this.barChartDataFiles={labels:[],datasets:[]},this.barChartDataUsers_data=[],this.barChartDataUsers={labels:[],datasets:[]},this.barChartDataSize_data=[],this.barChartDataSize={labels:[],datasets:[]},this.subject_columns=[],this.file_content_columns=[],this.months=[],this.barChartDataDownloadsAgg_data=[],this.barChartDataDatasetsAgg_data=[],this.barChartDataFiles_Aggdata=[],this.barChartDataUsers_Aggdata=[],this.barChartDataSize_Aggdata=[],this.pieChartDataSubject_data=[],this.pieChartLabelsSubject=[],this.pieChartDataSubject=[],this.pieChartDataFile_data=[],this.pieChartLabelsFile=[],this.pieChartDataFile=[],this.selectedCollection_Current="(All)",this.selectedCollection_Activate="(All)",this.selectedCollection_Current_Name="(All)",this.selectedCollection_Activate_Name="(All)",this.total_collections_num="-",this.total_dataverses_num="-",this.total_datasets_num="-",this.total_files_num="-",this.total_downloads_num="-",this.total_users_num="-",this.total_size_num="-",this.total_collections_change="-",this.total_datasets_change="-",this.total_files_chnage="-",this.total_downloads_change="-",this.total_users_change="-",this.total_size_change="-",this.downloads_labels=[this.translocoService.selectTranslate("MonthlyFileDownloads"),this.translocoService.selectTranslate("CumulativeFileDownloads")],this.datasets_labels=[this.translocoService.selectTranslate("MonthlyDatasetsPublished"),this.translocoService.selectTranslate("CumulativeDatasetsPublished")],this.file_labels=[this.translocoService.selectTranslate("MonthlyFilePublished"),this.translocoService.selectTranslate("CumulativeFilePublished")],this.user_labels=[this.translocoService.selectTranslate("MonthlyUsersJoined"),this.translocoService.selectTranslate("CumulativeUsersJoined")],this.storage_usage=[this.translocoService.selectTranslate("MonthlyStorageUsed"),this.translocoService.selectTranslate("CumulativeStorageUsed")],this.dataset_table_data=[],this.file_table_data=[],this.subjectTableOn=!1,this.fileContentTableOn=!1,this.receivedCollectionFromTree=[],this.isOpen=!1,this.isLoading=!1,this.error_flag=!1,this.monthTranslations={},this._filter=(d,u)=>{let h=u.toLowerCase();return d.filter(p=>p.toLowerCase().includes(h))},this.displayedColumns=["name","views","downloads","citations"],this.title="metrics-app",this.range=new uv({start:new jd(null),end:new jd(null)}),this.filteredOptions=this.options.slice(),this.loadingService.isLoading$.subscribe(d=>{this.isLoading=d})}filter(){let r=this.input.nativeElement.value.toLowerCase();this.filteredOptions=this.options.filter(n=>n.toLowerCase().includes(r))}switchLanguage(r){this.languageService.switchLanguage(r),this.cdr.detectChanges(),this.cdr.markForCheck()}getLanguage(){return this.languageService.getLanguage()}ngAfterViewInit(){}announceSortChange(r){r.direction?this._liveAnnouncer.announce(`Sorted ${r.direction}ending`):this._liveAnnouncer.announce("Sorting cleared")}openAboutDialog(){this.dialog.open(iKt)}openTOCDialog(){this.getLanguage()==="fr"?this.dialog.open(nKt):this.dialog.open(rKt)}openContactDialog(){this.dialog.open(oKt)}openFAQDialog(){this.dialog.open(sKt)}subjectToggle(){this.subjectTableOn?this.subjectTableOn=!1:this.subjectTableOn=!0}defaultButton(){window.location.reload()}};e.\u0275fac=function(n){return new(n||e)(Te(IL),Te(U9e),Te(q9e),Te(id),Te(Xi),Te(_4))},e.\u0275cmp=Tt({type:e,selectors:[["app-root"]],viewQuery:function(n,o){if(n&1&&(Ii(qXt,5),Ii(eve,5)),n&2){let s;ai(s=li())&&(o.input=s.first),ai(s=li())&&(o.sort=s.first)}},standalone:!0,features:[zi([che(tKt)]),zt],decls:38,vars:27,consts:[["download",""],["dp_s",""],["dp_e",""],[2,"padding","20px"],[2,"float","left"],["src","assets/logo.png","alt","image",2,"max-width","100%","height","30px","position","absolute"],[2,"position","relative","left","35px"],[2,"float","right","align-items","center"],[2,"float","right","position","relative"],["mat-button","",3,"click","disabled"],[2,"clear","both"],["mat-button","",1,"mat-small",2,"min-width","1%",3,"click"],["mode","indeterminate",4,"ngIf"],["class","loading-overlay",4,"ngIf"],[3,"messageEvent","collectionSelected","collectionSelectedName","startDate","endDate","start_on"],[2,"max-width","fit-content","margin-left","auto","margin-right","auto"],[3,"data","name"],[3,"ngIf"],["mode","indeterminate"],[1,"loading-overlay"],[1,"title-container"],["id","pdf_name",4,"ngIf"],["id","pdf_date",2,"margin-bottom","4px"],["style",`
    margin-bottom: 4px; 
    margin-left: 5px; 
    color: red; 
    border: 1px solid red; 
    border-radius: 8px; 
    background-color: #ffe5e5; 
    padding: 10px 10px 0px 10px; 
    max-width: 300px;
    line-height: 1;
    `,4,"ngIf"],[2,"border","none","height","1px","background-color","#ccc","margin","16px 0"],[2,"margin","auto","width","100%","display","flex"],[2,"vertical-align","top"],["id","main_meteris"],["appearance","outlined",1,"example-card","hide-scrollbar",2,"min-width","350px","max-width","350px","margin-bottom","10px","margin-left","5px","margin-top","10px","max-height","500px","overflow-y","auto","font-size","12px"],[2,"margin-top","10px","margin-left","17px"],[2,"display","flex","flex-direction","row"],["appearance","outline","disableRipple","",1,"compact-form-field",2,"margin-left","10px"],["matInput","","disabled","",4,"ngIf"],["matInput","",3,"matDatepicker","formControl","min","max",4,"ngIf"],["matIconSuffix","","class","custom-toggle",3,"for","disableRipple",4,"ngIf"],["startView","multi-year","panelClass","example-month-picker",3,"monthSelected"],["matInput","",3,"matDatepicker","formControl","min","max"],["matIconSuffix","",1,"custom-toggle",3,"for","disableRipple"],["matDatepickerToggleIcon","",1,"small-datepicker-icon"],[2,"display","flex","align-items","center","margin-top","-20px","margin-left","12px","margin-right","20px"],["matTooltip","Generates metrics from creation, visual displays last 24 months",2,"font-size","16px","transform","scale(0.9)","transform-origin","left top","margin-left","8px",3,"ngModelChange","ngModel"],[2,"margin-left","auto","margin-right","10px"],["mat-button","",2,"border","1px solid","font-size","12px","width","125px","height","25px",3,"click","disabled"],["appearance","outlined",1,"example-card","hide-scrollbar",2,"min-width","350px","max-width","350px","margin-left","5px","max-height","3350px","overflow-y","auto","font-size","12px"],[3,"dataEvent","data","current_active"],[3,"data","selectedCollection_Activate_Name"],[3,"data","selectedCollection_Activate_Name","date_start_on"],[2,"padding-top","1200px","height","1000px"],["id","pdf_name"],["id","responsive-title",1,"responsive-title"],[2,"color","purple"],[2,"margin-bottom","4px","margin-left","5px","color","red","border","1px solid red","border-radius","8px","background-color","#ffe5e5","padding","10px 10px 0px 10px","max-width","300px","line-height","1"],["matInput","","disabled",""]],template:function(n,o){if(n&1){let s=eo();ae(0,"div")(1,"h2",3)(2,"div",4),bt(3,"img",5),ae(4,"div",6),_e(5),br(6,"transloco"),ne()(),ae(7,"div",7)(8,"div",8)(9,"button",9),At("click",function(){return _i(s),yi(o.switchLanguage("en"))}),_e(10," English "),ne(),_e(11," | "),ae(12,"button",9),At("click",function(){return _i(s),yi(o.switchLanguage("fr"))}),_e(13," Fran\xE7ais "),ne()(),ae(14,"div",10)(15,"button",11),At("click",function(){return _i(s),yi(o.openAboutDialog())}),_e(16),br(17,"transloco"),ne(),_e(18," | "),ae(19,"button",11),At("click",function(){return _i(s),yi(o.openTOCDialog())}),_e(20),br(21,"transloco"),ne(),_e(22," | "),ae(23,"button",11),At("click",function(){return _i(s),yi(o.openContactDialog())}),_e(24),br(25,"transloco"),ne(),_e(26," | "),ae(27,"button",11),At("click",function(){return _i(s),yi(o.openFAQDialog())}),_e(28),br(29,"transloco"),ne()()()()(),wi(30,YXt,1,0,"mat-progress-bar",12)(31,$Xt,1,0,"div",13),ae(32,"app-posts",14),At("messageEvent",function(c){return _i(s),yi(o.getData(c))}),ne(),ae(33,"div",15)(34,"div",10),bt(35,"app-download",16,0),wi(37,eKt,60,40,"ng-template",17),ne()()}n&2&&(Ye(5),ji(" ",_r(6,17,"Title")," "),Ye(4),ht("disabled",o.getLanguage()=="en"),Ye(3),ht("disabled",o.getLanguage()=="fr"),Ye(4),ji(" ",_r(17,19,"About")," "),Ye(4),ji(" ",_r(21,21,"TermsofUse")," "),Ye(4),ji(" ",_r(25,23,"Contact")," "),Ye(4),ji(" ",_r(29,25,"FAQ")," "),Ye(2),ht("ngIf",o.isLoading),Ye(),ht("ngIf",o.isLoading),Ye(),ht("collectionSelected",o.selectedCollection_Activate)("collectionSelectedName",o.selectedCollection_Current_Name)("startDate",o.date_start_activate)("endDate",o.date_end_activate)("start_on",o.date_select_on),Ye(3),ht("data",o.raw_table_data)("name",o.selectedOption),Ye(2),ht("ngIf",!0))},dependencies:[Rue,hv,bU,IA,Che,DU,wU,yU,Lhe,ahe,A_,TA,pU,AA,bx,Iue,zge,Gu,$d,Gx,Mv,tve,oB,HTe,FTe,g4,PK,NK,I9e,Pde,WTe,eRe,Wn,ex,sE,nE,oE,T4,E4,x4,S4,nRe,A4,R9e,Vz,Bz,Dv,Iv,L9e,F9e,H9e,v4],styles:[".handsontable[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%], .handsontable[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]{background:red!important;color:red!important}.mat-mdc-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:40px!important}.title-container[_ngcontent-%COMP%]{vertical-align:top;margin-top:60px;margin-left:0;padding-left:0;position:relative;max-width:none;width:100%;box-sizing:border-box}.responsive-title[_ngcontent-%COMP%]{font-weight:700;font-size:clamp(16px,4vw,32px);white-space:normal;overflow-wrap:break-word;max-width:73vw;padding-left:5px}#pdf_name[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{line-height:1.2;padding-bottom:4px}#pdf_date[_ngcontent-%COMP%]{margin-top:-10px;font-size:18px;margin-left:5px}.compact-mat-form-field[_ngcontent-%COMP%]{width:140px;--mat-form-field-container-height: 36px;--mat-form-field-container-vertical-padding: 4px;font-size:16px}.compact-mat-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding-top:4px;padding-bottom:4px;height:32px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0000004d;z-index:9999}"],changeDetection:0});let t=e;return t})(),iKt=(()=>{let e=class e{constructor(r){this.dialogRef=r}closeDialog(){this.dialogRef.close()}};e.\u0275fac=function(n){return new(n||e)(Te(Ag))},e.\u0275cmp=Tt({type:e,selectors:[["about-dialog-popup"]],decls:115,vars:0,consts:[[1,"dialog-container",2,"position","relative","height","600px","width","700px","padding","20px 40px","overflow-y","auto","box-sizing","border-box"],["aria-label","Close dialog",1,"close-button",2,"position","absolute","top","10px","right","10px","background","transparent","border","none","font-size","24px","cursor","pointer",3,"click"],["mat-dialog-title","",2,"font-size","32px","font-weight","bold","margin-top","40px"]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"button",1),At("click",function(){return o.closeDialog()}),_e(2," \u2715 "),ne(),ae(3,"h1",2),_e(4,"About"),ne(),ae(5,"p")(6,"strong"),_e(7,"Borealis"),ne(),_e(8,", the Canadian Dataverse Repository, is a bilingual, multidisciplinary, secure, Canadian research data repository, supported by academic libraries and research institutions across Canada. Borealis supports open discovery, management, sharing, and preservation of Canadian research data. "),ne(),ae(9,"p"),_e(10," The Borealis Metrics Report allows users to curate and analyze usage data across the entire platform and within specific collections. The interface is available in English or "),ae(11,"em"),_e(12,"en fran\xE7ais"),ne(),_e(13,". Please note that Collection names and data are represented in their original language, as are the corresponding metadata. "),ne(),ae(14,"p"),_e(15," Below is an overview of the features available in the Borealis Metrics Report, as well as a description of categories and filters users may choose to apply. "),ne(),ae(16,"h3")(17,"i"),_e(18,"Left-hand Panel"),ne()(),ae(19,"h4")(20,"strong"),_e(21,"Collections Tree"),ne()(),ae(22,"p"),_e(23," The Collections Tree is a configuration tool that allows users to navigate and search over 1,500 collections in their intended, hierarchical data structure. Collections and subcollections follow a nested structure, with reports available for the collection as a whole or for specific subcollections. "),ne(),ae(24,"p"),_e(25," To view metrics for a specific collection or subcollection, click the "),ae(26,"strong"),_e(27,"\u201CFull Report\u201D"),ne(),_e(28," button in the nested tree structure. "),ne(),ae(29,"h4")(30,"strong"),_e(31,"Date Range"),ne()(),ae(32,"p"),_e(33," Users can examine data within any specific timeframe, from its creation to the most recent month. "),ne(),ae(34,"h3")(35,"i"),_e(36,"Centre and Right-hand Panel"),ne()(),ae(37,"h4")(38,"strong"),_e(39,"Graph Dashboard"),ne()(),ae(40,"p"),_e(41," Graphs are generated when the "),ae(42,"strong"),_e(43,"\u201CMonthly\u201D"),ne(),_e(44," and/or "),ae(45,"strong"),_e(46,"\u201CCumulative\u201D"),ne(),_e(47," metrics are selected at the top of bar graphs or from the legend next to pie graphs. Graph data ranges will adjust based on the selected dates and collections. "),ne(),ae(48,"h4")(49,"strong"),_e(50,"Exports"),ne()(),ae(51,"p"),_e(52,"The Borealis Metrics Report currently supports four export options:"),ne(),ae(53,"ul")(54,"li")(55,"strong"),_e(56,"Excel"),ne(),_e(57," \u2013 Exports data from the selected collection and date range into a multi-sheet XLSX file."),ne(),ae(58,"li")(59,"strong"),_e(60,"PDF"),ne(),_e(61," \u2013 Exports the graphs and right-hand panel metrics for the selected collections and date range into a single organized PDF."),ne(),ae(62,"li")(63,"strong"),_e(64,"Legacy"),ne(),_e(65," \u2013 Structured data export from a previous version of the Borealis Metrics Report. Data in this export may be formatted differently than other export formats."),ne(),ae(66,"li")(67,"strong"),_e(68,"Make Data Count"),ne(),_e(69," \u2013 Exports usage metrics compliant with Make Data Count standards for research data metrics."),ne()(),ae(70,"h4")(71,"strong"),_e(72,"Collections"),ne()(),ae(73,"p"),_e(74,"The number of collections currently hosted on Borealis. This metric does not update based on date or selected collection as it is representative of current Borealis holdings."),ne(),ae(75,"h4")(76,"strong"),_e(77,"Datasets"),ne()(),ae(78,"p"),_e(79,"The number of datasets within a selected collection."),ne(),ae(80,"h4")(81,"strong"),_e(82,"Files"),ne()(),ae(83,"p"),_e(84,"The number of files within a selected collection."),ne(),ae(85,"h4")(86,"strong"),_e(87,"Downloads"),ne()(),ae(88,"p"),_e(89,"Number of downloaded files from a selected collection."),ne(),ae(90,"h4")(91,"strong"),_e(92,"Users"),ne()(),ae(93,"p"),_e(94,"The number of user accounts in Borealis. "),ne(),ae(95,"h4")(96,"strong"),_e(97,"Authors"),ne()(),ae(98,"p"),_e(99,"The number of authors with published contributions in a selected collection."),ne(),ae(100,"h4")(101,"strong"),_e(102,"Storage Usage"),ne()(),ae(103,"p"),_e(104,"Total file size for a selected dataverse."),ne(),ae(105,"h4")(106,"strong"),_e(107,"Subject Breakdown"),ne()(),ae(108,"p"),_e(109,"Breakdown of assigned subjects for datasets and their distribution within a selected collection."),ne(),ae(110,"h4")(111,"strong"),_e(112,"File Breakdown"),ne()(),ae(113,"p"),_e(114,"Breakdown of file types and extensions of files within a selected collection, as well as their distribution."),ne()())},encapsulation:2});let t=e;return t})(),rKt=(()=>{let e=class e{constructor(r){this.dialogRef=r}closeDialog(){this.dialogRef.close()}};e.\u0275fac=function(n){return new(n||e)(Te(Ag))},e.\u0275cmp=Tt({type:e,selectors:[["toc-dialog-popup-en"]],decls:139,vars:0,consts:[[2,"height","600px","width","700px","padding","20px 40px","overflow-y","auto","box-sizing","border-box"],["aria-label","Close dialog",1,"close-button",2,"position","absolute","top","10px","right","10px","background","transparent","border","none","font-size","24px","cursor","pointer",3,"click"],[2,"font-size","32px","font-weight","bold","margin-top","40px"],["href","https://creativecommons.org/licenses/by-sa/4.0/","target","_blank"]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"button",1),At("click",function(){return o.closeDialog()}),_e(2," \u2715 "),ne(),ae(3,"h1",2),_e(4,"Terms of Use"),ne(),ae(5,"h2"),_e(6,"Introduction"),ne(),ae(7,"p"),_e(8," Borealis, the Canadian Dataverse Repository, is a digital research data repository available to researchers at participating Canadian universities and research organizations with infrastructure hosted by the University of Toronto Libraries (UTL) in Ontario, Canada. The open-source Dataverse software is developed and maintained by the Institute of Quantitative Social Science (IQSS) at Harvard University, with the assistance of Dataverse community members from around the world. "),ne(),ae(9,"p"),_e(10," Borealis is designed to provide Canadian researchers with a place to store, share, and publish their research data. It is also designed to allow researchers from around the world to discover, view, and download research data from Canadian researchers. "),ne(),ae(11,"h2"),_e(12,"Acceptance of Terms"),ne(),ae(13,"p"),_e(14," The following terms and conditions govern all use of the Borealis website (the Site) and the services available on or at the Site (taken together, the Service). The Service is operated by the University of Toronto Libraries (the Service Provider). The Service is offered subject to acceptance, without modification, of the terms and conditions contained herein (the Terms of Use) and all other operating rules, policies, and procedures that may be published from time to time on this Site by the Service Provider. "),ne(),ae(15,"p"),_e(16," The Service Provider may refuse to offer the Service to any person or entity at any time and may change its eligibility criteria, at any time, at its sole discretion. "),ne(),ae(17,"h2"),_e(18,"Modification of Terms of Use"),ne(),ae(19,"p"),_e(20," The Service Provider reserves the right, at its sole discretion, to modify or replace any of the Terms of Use at any time. It is your responsibility to check the Terms of Use periodically for changes. Your continued use of the Service following the posting of any changes to the Terms of Use constitutes acceptance of those changes. "),ne(),ae(21,"h2"),_e(22,"Rules and Conduct"),ne(),ae(23,"p"),_e(24," As a condition of use, you promise not to use the Service for any purpose that is prohibited by the Terms of Use. For purposes of the Terms of Use, \u201CContent\u201D includes, without limitation, any information, data, text, software, scripts, graphics, and interactive features generated, provided, or otherwise made accessible by the Service Provider on or through the Service. "),ne(),ae(25,"p"),_e(26," By way of example, and not as a limitation, you shall not (or permit others to) take any action or upload, download, post, submit, or otherwise distribute any Content using any communications service that: "),ne(),ae(27,"ul")(28,"li"),_e(29,"Infringes any patent, trademark, trade secret, copyright, right of publicity, or other right of any person or entity;"),ne(),ae(30,"li"),_e(31,"Is unlawful, threatening, abusive, harassing, defamatory, libelous, deceptive, fraudulent, invasive of another\u2019s privacy, tortious, obscene, offensive, or profane;"),ne(),ae(32,"li"),_e(33,"Constitutes unauthorized or unsolicited advertising or spam;"),ne(),ae(34,"li"),_e(35,"Contains software viruses or malicious code designed to disrupt or gain unauthorized access to systems or data."),ne()(),ae(36,"p"),_e(37," Additionally, you shall not: "),ne(),ae(38,"ul")(39,"li"),_e(40,"Take any action that imposes an unreasonable load on the Service;"),ne(),ae(41,"li"),_e(42,"Interfere with the proper working of the Service;"),ne(),ae(43,"li"),_e(44,"Bypass any security measures of the Service."),ne()(),ae(45,"p"),_e(46," You shall abide by all applicable local, provincial, national, and international laws and regulations. "),ne(),ae(47,"h2"),_e(48,"Registration"),ne(),ae(49,"p"),_e(50," You may be required to register with the Site to use the Service. You must provide accurate and complete information. You must not use a username: "),ne(),ae(51,"ul")(52,"li"),_e(53,"With the intent to impersonate someone else;"),ne(),ae(54,"li"),_e(55,"That is subject to the rights of someone else without permission;"),ne(),ae(56,"li"),_e(57,"That is offensive or obscene."),ne()(),ae(58,"p"),_e(59," You are responsible for maintaining the confidentiality of your password and for all activity under your account. "),ne(),ae(60,"h2"),_e(61,"Affiliation with Participating Institutions"),ne(),ae(62,"p"),_e(63," Participating Institutions have administrative control over their collections and may implement their own policies. Users must adhere to those institutional policies. "),ne(),ae(64,"h2"),_e(65,"User Content"),ne(),ae(66,"p"),_e(67," Users may upload Content such as documents, images, videos, audio, and more. The Service Provider is not responsible for lost or damaged content. You warrant you have the right to license any content you upload. "),ne(),ae(68,"h2"),_e(69,"Terms and Conditions of User Content"),ne(),ae(70,"p"),_e(71," The Service Provider does not pre-screen uploaded content. By publishing content, you confirm it: "),ne(),ae(72,"ul")(73,"li"),_e(74,"Does not infringe on others' rights;"),ne(),ae(75,"li"),_e(76,"Does not violate laws;"),ne(),ae(77,"li"),_e(78,"Does not contain malware;"),ne(),ae(79,"li"),_e(80,"Includes proper attribution and REB approval if applicable."),ne()(),ae(81,"h2"),_e(82,"Sensitive and Confidential Data"),ne(),ae(83,"p"),_e(84," You confirm that content does not include identifying information unless: "),ne(),ae(85,"ul")(86,"li"),_e(87,"Subjects have consented;"),ne(),ae(88,"li"),_e(89,"It relates to public figures in public contexts;"),ne(),ae(90,"li"),_e(91,"It is historical or otherwise public;"),ne(),ae(92,"li"),_e(93,"It complies with privacy and ethical standards."),ne()(),ae(94,"h2"),_e(95,"Permission for Data Reuse and Long-term Preservation"),ne(),ae(96,"p"),_e(97," By uploading, you grant a non-exclusive license to the Service Provider and Participating Institutions to use and preserve the content. This includes backups, format migration, cataloguing, and metadata harvesting in accordance with the FAIR Principles. "),ne(),ae(98,"h2"),_e(99,"Removal of Data"),ne(),ae(100,"p"),_e(101," Content may be removed by the Service Provider or Participating Institutions for any reason, including legal or policy violations. "),ne(),ae(102,"h2"),_e(103,"Termination of Access"),ne(),ae(104,"p"),_e(105," Your access to the Service may be terminated at any time. Provisions such as warranties, indemnity, and liability limitations survive termination. "),ne(),ae(106,"h2"),_e(107,"No Warranties"),ne(),ae(108,"p"),_e(109," THE SERVICE AND CONTENT ARE PROVIDED \u201CAS IS\u201D WITHOUT WARRANTIES OF ANY KIND. USE AT YOUR OWN RISK. "),ne(),ae(110,"h2"),_e(111,"Limitation of Liability"),ne(),ae(112,"p"),_e(113," The Service Provider is not liable for indirect, incidental, or consequential damages or for direct damages exceeding $10 CAD. "),ne(),ae(114,"h2"),_e(115,"Indemnification"),ne(),ae(116,"p"),_e(117," You agree to indemnify the Service Provider against any claims or damages resulting from your use of the Service or your content. "),ne(),ae(118,"h2"),_e(119,"Dispute Resolution"),ne(),ae(120,"p"),_e(121," Disputes will be governed by Ontario law and resolved in Ontario courts. Any claims must be brought within one year. "),ne(),ae(122,"h2"),_e(123,"Integration and Severability"),ne(),ae(124,"p"),_e(125," These Terms of Use constitute the full agreement. If any provision is invalid, the rest remain in effect. "),ne(),ae(126,"h2"),_e(127,"Miscellaneous"),ne(),ae(128,"p"),_e(129," You may not assign these Terms. Notices may be delivered via email or mail. The Service Provider may assign rights without notice. "),ne(),ae(130,"h2"),_e(131,"Copyright and Trademark Notices"),ne(),ae(132,"p"),_e(133," Copyright for supplemental material and tools belongs to the Service Provider or authors. \u201CDataverse\u201D and its logo are trademarks of IQSS at Harvard University. "),ne(),ae(134,"p"),_e(135," This Terms of Use document is available under a "),ae(136,"a",3),_e(137,"CC BY-SA 4.0"),ne(),_e(138," license. It incorporates portions developed by Swivel, LLC, IQSS at Harvard University, the University of Toronto, and OCUL. "),ne()())},encapsulation:2});let t=e;return t})(),nKt=(()=>{let e=class e{constructor(r){this.dialogRef=r}closeDialog(){this.dialogRef.close()}};e.\u0275fac=function(n){return new(n||e)(Te(Ag))},e.\u0275cmp=Tt({type:e,selectors:[["toc-dialog-popup-fr"]],decls:169,vars:0,consts:[[2,"height","600px","width","700px","padding","20px 40px","overflow-y","auto","box-sizing","border-box","position","relative"],["aria-label","Close dialog",1,"close-button",2,"position","absolute","top","10px","right","10px","background","transparent","border","none","font-size","24px","cursor","pointer",3,"click"],[2,"font-size","32px","font-weight","bold","margin-top","40px"],["href","https://creativecommons.org/licenses/by-sa/4.0/","target","_blank"]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"button",1),At("click",function(){return o.closeDialog()}),_e(2," \u2715 "),ne(),ae(3,"h1",2),_e(4,"Terms of Use (I need French)"),ne(),ae(5,"div")(6,"h1"),_e(7,"Introduction"),ne(),ae(8,"p"),_e(9," Borealis, le d\xE9p\xF4t Dataverse canadien, est un d\xE9p\xF4t de donn\xE9es de recherche num\xE9riques ouvert aux membres des universit\xE9s et institutions de recherche participantes au Canada, avec une infrastructure fournie par les Biblioth\xE8ques de l\u2019Universit\xE9 de Toronto (UTL) en Ontario, Canada. Le logiciel Dataverse \xE0 code libre est un outil d\xE9velopp\xE9 et maintenu par l\u2019Institute of Quantitative Social Science (IQSS) de l\u2019Universit\xE9 Harvard, avec l\u2019aide des membres de la communaut\xE9 Dataverse du monde entier. "),ne(),ae(10,"p"),_e(11," Borealis est con\xE7u pour fournir aux membres de la communaut\xE9 de la recherche au Canada un endroit o\xF9 stocker, partager et publier leurs donn\xE9es de recherche. Il est \xE9galement con\xE7u pour permettre aux chercheuses et chercheurs du monde entier de d\xE9couvrir, visualiser et t\xE9l\xE9charger des donn\xE9es de recherche h\xE9berg\xE9es au Canada. "),ne(),ae(12,"h2"),_e(13,"Acceptation des conditions d\u2019utilisation"),ne(),ae(14,"p"),_e(15," Les pr\xE9sentes conditions d\u2019utilisations r\xE9gissent toute utilisation du site web de Borealis (le Site) et les services disponibles sur le site ou par son interm\xE9diaire (pris ensemble, le Service). Le service est exploit\xE9 par les Biblioth\xE8ques de l\u2019Universit\xE9 de Toronto (le Fournisseur de services). Le service est offert sous r\xE9serve de l\u2019acceptation, sans modification, des conditions d\u2019utilisation contenues aux pr\xE9sentes (les Conditions d\u2019utilisation) et de toutes les autres r\xE8gles de fonctionnement, politiques et proc\xE9dures qui peuvent \xEAtre publi\xE9es de temps \xE0 autre sur le site par le fournisseur de services. "),ne(),ae(16,"p"),_e(17," Le fournisseur de services peut refuser d\u2019offrir le service \xE0 toute personne ou entit\xE9 \xE0 tout moment et peut modifier ses crit\xE8res d\u2019admissibilit\xE9, \xE0 tout moment, \xE0 sa seule discr\xE9tion. "),ne(),ae(18,"h2"),_e(19,"Modification des conditions d\u2019utilisation"),ne(),ae(20,"p"),_e(21," Le fournisseur de services se r\xE9serve le droit, \xE0 sa seule discr\xE9tion, de modifier ou de remplacer les conditions d\u2019utilisation \xE0 tout moment. Il est de votre responsabilit\xE9 de v\xE9rifier les conditions d\u2019utilisation p\xE9riodiquement pour les changements. Votre utilisation continue du service apr\xE8s la publication de toute modification des conditions d\u2019utilisation constitue l\u2019acceptation de ces modifications. "),ne(),ae(22,"h2"),_e(23,"R\xE8gles et conduite"),ne(),ae(24,"p"),_e(25," Comme condition d\u2019utilisation, vous vous engagez \xE0 ne pas utiliser le service \xE0 des fins interdites par les conditions d\u2019utilisation. Aux fins des conditions d\u2019utilisation, le \xAB\u2009Contenu\u2009\xBB comprend, sans limitation, toutes les informations, donn\xE9es, textes, logiciels, scripts, graphiques et fonctionnalit\xE9s interactives g\xE9n\xE9r\xE9s, fournis ou autrement rendus accessibles par le fournisseur de services sur le service ou par son interm\xE9diaire. "),ne(),ae(26,"p"),_e(27," \xC0 titre d\u2019exemple, mais sans s\u2019y limiter, vous ne devez pas (ou permettre \xE0 d\u2019autres de) soit (a) prendre des mesures ou (b) t\xE9l\xE9verser, t\xE9l\xE9charger, publier, soumettre ou autrement distribuer ou faciliter la distribution de tout contenu \xE0 l\u2019aide de tout service de communication ou autre service disponible sur le service ou par l\u2019entremise de celui-ci, qui : "),ne(),ae(28,"ul")(29,"li"),_e(30,"enfreint tout brevet, marque d\xE9pos\xE9e, secret commercial, droit d\u2019auteur, droit de publicit\xE9 ou autre droit de toute autre personne ou entit\xE9;"),ne(),ae(31,"li"),_e(32,"est ill\xE9gal, mena\xE7ant, abusif, harcelant, diffamatoire, calomnieux, trompeur, frauduleux, envahissant la vie priv\xE9e d\u2019autrui, d\xE9lictuel, obsc\xE8ne, offensant ou profane;"),ne(),ae(33,"li"),_e(34,"constitue de la publicit\xE9 non autoris\xE9e ou non sollicit\xE9e, du courrier ind\xE9sirable ou en masse (c\u2019est-\xE0-dire des pourriels);"),ne(),ae(35,"li"),_e(36,"contient des virus logiciels ou tout autre code informatique, fichier ou programme con\xE7u ou destin\xE9 \xE0 perturber, endommager, limiter ou interf\xE9rer avec le bon fonctionnement de tout logiciel, mat\xE9riel ou \xE9quipement de t\xE9l\xE9communication ou pour endommager ou obtenir un acc\xE8s non autoris\xE9 \xE0 tout syst\xE8me, des donn\xE9es ou d\u2019autres informations, ou tout tiers."),ne()(),ae(37,"p"),_e(38," De plus, vous ne devez pas : (i) prendre de mesures qui imposent ou peuvent imposer (tel que d\xE9termin\xE9 par le fournisseur de services \xE0 sa seule discr\xE9tion) une charge d\xE9raisonnable ou disproportionn\xE9e sur l\u2019infrastructure du service; (ii) interf\xE9rer ou tenter d\u2019interf\xE9rer avec le bon fonctionnement du service ou toute activit\xE9 men\xE9e sur le service; ou (iii) contourner toute mesure que le fournisseur de services peut utiliser pour emp\xEAcher ou restreindre l\u2019acc\xE8s au service (ou \xE0 d\u2019autres comptes, syst\xE8mes informatiques ou r\xE9seaux connect\xE9s au service). "),ne(),ae(39,"p"),_e(40," Vous devez respecter toutes les lois et r\xE9glementations locales, provinciales, nationales et internationales applicables. "),ne(),ae(41,"h2"),_e(42,"Inscription"),ne(),ae(43,"p"),_e(44," Comme condition d\u2019utilisation du service, vous pouvez \xEAtre amen\xE9 \xE0 vous inscrire sur le site et \xE0 s\xE9lectionner un mot de passe et un nom d\u2019utilisateur. Pour plus d\u2019information sur l\u2019information recueillie d\xE9coulant de l\u2019utilisation du site, consultez l\u2019\xE9nonc\xE9 de vie priv\xE9e de Borealis. "),ne(),ae(45,"p"),_e(46," Vous devez fournir au fournisseur de services des informations d\u2019inscription exactes, compl\xE8tes et mises \xE0 jour. Ne pas le faire constituera une violation des conditions d\u2019utilisation, ce qui peut entra\xEEner la r\xE9siliation imm\xE9diate de votre compte. "),ne(),ae(47,"p"),_e(48," Vous ne devez pas s\xE9lectionner ou utiliser comme nom d\u2019utilisateur un nom qui : "),ne(),ae(49,"ul")(50,"li"),_e(51,"est le nom d\u2019une autre personne dans l\u2019intention de se faire passer pour cette personne;"),ne(),ae(52,"li"),_e(53,"est le nom qui est soumis aux droits d\u2019une personne autre que vous sans autorisation appropri\xE9e;"),ne(),ae(54,"li"),_e(55,"est un nom offensant, vulgaire ou obsc\xE8ne."),ne()(),ae(56,"p"),_e(57," Le fournisseur de services se r\xE9serve le droit de refuser l\u2019enregistrement ou d\u2019annuler un compte, \xE0 sa seule discr\xE9tion. Vous \xEAtes la seule personne responsable de l\u2019activit\xE9 qui se produit avec votre compte et \xEAtes responsable du maintien de la confidentialit\xE9 de votre mot de passe. Vous informerez imm\xE9diatement le fournisseur de services par \xE9crit de toute utilisation non autoris\xE9e de votre compte ou toute autre violation de s\xE9curit\xE9 li\xE9e au compte dont vous avez connaissance. "),ne(),ae(58,"h2"),_e(59,"Affiliation avec des \xE9tablissements participants"),ne(),ae(60,"p"),_e(61," Le fournisseur de services fournit aux \xE9tablissements participants (\xE9tablissements d\u2019enseignement postsecondaire avec lesquels le fournisseur de services a un contrat d\u2019utilisation du service) une collection institutionnelle sur laquelle ils ont un contr\xF4le administratif. Les \xE9tablissements participants ont \xE9galement la possibilit\xE9 de cr\xE9er et d\u2019appliquer leurs propres politiques et proc\xE9dures, qui doivent toutes \xEAtre suivies par la communaut\xE9 d\u2019utilisation affili\xE9e \xE0 cet \xE9tablissement participant. "),ne(),ae(62,"h2"),_e(63,"Contenu des utilisateurs"),ne(),ae(64,"p"),_e(65," Le service offre aux utilisatrices et utilisateurs affili\xE9s aux \xE9tablissements participants la possibilit\xE9 d\u2019acc\xE9der, de t\xE9l\xE9verser, de soumettre, de divulguer, de distribuer et de publier du contenu, y compris, sans s\u2019y limiter, des documents, des images, des vid\xE9os, du son et d\u2019autres informations. Vous reconnaissez que le fournisseur de services n\u2019est pas responsable de toute perte de votre contenu ou dommage \xE0 votre contenu, en tout ou en partie. "),ne(),ae(66,"p"),_e(67," Vous d\xE9clarez et garantissez en outre que vous avez l\xE9galement le droit et le plein pouvoir de cr\xE9er une licence d\u2019utilisation de votre contenu de la mani\xE8re d\xE9crite dans les pr\xE9sentes conditions d\u2019utilisation, et que vous n\u2019\xEAtes soumis \xE0 aucune obligation ou restriction cr\xE9\xE9e par une loi, un contrat ou autre qui vous emp\xEAcherait de conclure et d\u2019ex\xE9cuter pleinement les pr\xE9sentes conditions d\u2019utilisation. "),ne(),ae(68,"h2"),_e(69,"Conditions d\u2019utilisation du contenu des utilisateurs"),ne(),ae(70,"p"),_e(71," Le fournisseur de services n\u2019examine pas le contenu t\xE9l\xE9vers\xE9 sur le service avant ou apr\xE8s sa publication (c\u2019est-\xE0-dire rendu public) au moyen du service. Il est de votre responsabilit\xE9 de vous assurer que votre contenu respecte toutes les conditions d\u2019utilisation d\xE9crites aux pr\xE9sentes avant le t\xE9l\xE9chargement et la publication au moyen du service. Si le contenu ne respecte pas les pr\xE9sentes conditions d\u2019utilisation, vous serez tenu l\xE9galement et financi\xE8rement responsable des dommages si le Contenu viole les pr\xE9sentes conditions d\u2019utilisation. "),ne(),ae(72,"p"),_e(73," En publiant du contenu au moyen du service, vous faites les d\xE9clarations et garanties suivantes : "),ne(),ae(74,"ul")(75,"li"),_e(76,"Votre contenu n\u2019enfreint pas les droits d\u2019auteur ou autres droits de propri\xE9t\xE9 intellectuelle, y compris, mais sans s\u2019y limiter, les brevets, marques de commerce, secrets commerciaux, droits d\u2019auteur, droits de publicit\xE9 ou autres droits de tout autre tiers."),ne(),ae(77,"li"),_e(78,"Votre contenu ne viole aucune loi, y compris, mais sans s\u2019y limiter, les lois relatives \xE0 la diffamation et \xE0 l\u2019obsc\xE9nit\xE9."),ne(),ae(79,"li"),_e(80,"Vous informerez rapidement le fournisseur de services et votre \xE9tablissement participant de tout probl\xE8me de confidentialit\xE9, de vie priv\xE9e ou de protection des donn\xE9es, de licence ou d\u2019enjeu intellectuel concernant votre contenu."),ne(),ae(81,"li"),_e(82,"Votre contenu ne contient pas de virus ou tout autre code informatique, fichier ou programme con\xE7u ou destin\xE9 \xE0 perturber, \xE0 endommager, \xE0 limiter ou \xE0 interf\xE9rer avec le bon fonctionnement de tout logiciel, mat\xE9riel ou \xE9quipement de t\xE9l\xE9communication ou pour endommager ou obtenir un acc\xE8s non autoris\xE9 \xE0 tout syst\xE8me, donn\xE9es et autres informations."),ne(),ae(83,"li"),_e(84,"Si votre contenu est soumis \xE0 l\u2019examen d\u2019un comit\xE9 d\u2019\xE9thique de la recherche (CER), celui-ci a donn\xE9 son approbation pour que votre contenu soit t\xE9l\xE9vers\xE9 et distribu\xE9 publiquement."),ne(),ae(85,"li"),_e(86,"Votre contenu contient une attribution et une citation appropri\xE9es dans le respect de l\u2019int\xE9grit\xE9 acad\xE9mique et des normes disciplinaires."),ne()(),ae(87,"h2"),_e(88,"Donn\xE9es sensibles et confidentielles"),ne(),ae(89,"p"),_e(90," En utilisant le service, vous confirmez que tout votre contenu ne contient pas d\u2019informations qui pourraient identifier directement ou indirectement un sujet, sauf si la divulgation de ces informations d\u2019identification ne risque pas de constituer une atteinte injustifi\xE9e \xE0 la vie priv\xE9e ou une violation de la confidentialit\xE9. Vous confirmez en outre que toutes les informations personnellement identifiables dans votre contenu respectent au moins l\u2019une des conditions suivantes : "),ne(),ae(91,"ul")(92,"li"),_e(93,"Les informations ont \xE9t\xE9 pr\xE9c\xE9demment rendues publiques."),ne(),ae(94,"li"),_e(95,"Les informations d\xE9crivent des personnalit\xE9s publiques, lorsque ces informations se rapportent \xE0 leurs r\xF4les publics et \xE0 d\u2019autres sujets non sensibles."),ne(),ae(96,"li"),_e(97,"Un laps de temps suffisant s\u2019est \xE9coul\xE9 depuis la collecte de l\u2019information pour qu\u2019elle puisse \xEAtre consid\xE9r\xE9e comme historique."),ne(),ae(98,"li"),_e(99,"Tous les sujets identifi\xE9s ont donn\xE9 un consentement \xE9clair\xE9 explicite permettant la divulgation publique de leurs informations."),ne(),ae(100,"li"),_e(101,"Toutes les informations ont \xE9t\xE9 collect\xE9es avec une d\xE9claration explicite concernant leur caract\xE8re public, telles que les informations collect\xE9es \xE0 des fins r\xE9glementaires gouvernementales."),ne(),ae(102,"li"),_e(103,"Pour les documents f\xE9d\xE9raux (c\u2019est-\xE0-dire le contenu cr\xE9\xE9 par une agence du gouvernement f\xE9d\xE9ral canadien ou en vertu d\u2019un contrat f\xE9d\xE9ral) uniquement, tous les sujets identifi\xE9s sont d\xE9c\xE9d\xE9s et aucune loi f\xE9d\xE9rale ne restreint explicitement la divulgation de ces informations."),ne()(),ae(104,"h2"),_e(105,"Autorisation de r\xE9utilisation des donn\xE9es et de pr\xE9servation \xE0 long terme"),ne(),ae(106,"p"),_e(107," En d\xE9posant ou en t\xE9l\xE9versant du contenu au moyen du service, vous accordez au fournisseur de services et aux \xE9tablissements participants une licence mondiale, non exclusive, libre de redevances et transf\xE9rable pour utiliser, reproduire, distribuer, pr\xE9parer des \u0153uvres d\xE9riv\xE9es, afficher et ex\xE9cuter le contenu en lien avec ce service. Cela comprend, mais sans s\u2019y limiter, la cr\xE9ation de copies, de sauvegardes et la modification des formats de donn\xE9es \xE0 des fins de pr\xE9servation et de r\xE9utilisation. Vous autorisez en outre le fournisseur de services et les \xE9tablissements participants \xE0 migrer votre contenu vers tout support, format ou plateforme \xE0 des fins de pr\xE9servation. Le fournisseur de services fera de son mieux pour maintenir l\u2019int\xE9grit\xE9 de votre contenu conform\xE9ment aux conditions d\u2019utilisation et de ses ententes avec les \xE9tablissements participants. "),ne(),ae(108,"p"),_e(109," Vous autorisez en outre le fournisseur de services, sans s\u2019y limiter, \xE0 : "),ne(),ae(110,"ul")(111,"li"),_e(112,"promouvoir et annoncer votre contenu, sous quelque forme que ce soit, pour le service;"),ne(),ae(113,"li"),_e(114,"d\xE9crire, cataloguer, valider et documenter votre contenu afin de le stocker, le traduire, le copier ou le reformater de quelque mani\xE8re que ce soit afin d\u2019assurer sa rep\xE9rabilit\xE9 future, son accessibilit\xE9, son interop\xE9rabilit\xE9 et sa d\xE9couvrabilit\xE9 conform\xE9ment aux Principes FAIR;"),ne(),ae(115,"li"),_e(116,"r\xE9colter ou autoriser la r\xE9colte de m\xE9tadonn\xE9es ou d\u2019autres documents dans votre contenu pour les catalogues d\u2019acc\xE8s public et les services de d\xE9couverte."),ne()(),ae(117,"p"),_e(118," Le fournisseur de services se r\xE9serve le droit, mais n\u2019a aucune obligation, de faciliter la pr\xE9servation, la v\xE9rification, la gestion et l\u2019utilisation, ainsi que l\u2019archivage permanent de vos donn\xE9es \xE0 plusieurs endroits. "),ne(),ae(119,"h2"),_e(120,"Suppression des donn\xE9es"),ne(),ae(121,"p"),_e(122,"Le fournisseur de services n\u2019a aucune obligation de surveiller le site, le service ou le contenu. Le fournisseur de services et les \xE9tablissements participants peuvent supprimer tout contenu \xE0 tout moment pour quelque raison que ce soit (y compris, mais sans s\u2019y limiter, sur r\xE9ception d\u2019une demande ou d\u2019all\xE9gations de tiers ou d\u2019autorit\xE9s li\xE9es au contenu), y compris conform\xE9ment aux politiques de curation et de conservation du service ou des \xE9tablissements participants."),ne(),ae(123,"h2"),_e(124,"R\xE9siliation d\u2019acc\xE8s"),ne(),ae(125,"p"),_e(126,"Le fournisseur de services peut r\xE9silier votre acc\xE8s en tout ou en partie au service \xE0 tout moment, avec ou sans motif, avec ou sans pr\xE9avis, avec effet imm\xE9diat. Si vous souhaitez r\xE9silier votre compte, vous devez en informer le fournisseur de services."),ne(),ae(127,"p"),_e(128,"Toutes les dispositions des pr\xE9sentes conditions d\u2019utilisation qui, de par leur nature, devraient survivre \xE0 la r\xE9siliation survivront \xE0 la r\xE9siliation, y compris, sans s\u2019y limiter, les dispositions relatives \xE0 la propri\xE9t\xE9, les exclusions de garantie, les indemnit\xE9s et les limitations de responsabilit\xE9."),ne(),ae(129,"h2"),_e(130,"Aucune garantie"),ne(),ae(131,"p"),_e(132,"LE SERVICE (Y COMPRIS, SANS LIMITATION, LE CONTENU) EST FOURNI \xAB\u2009EN L\u2019\xC9TAT\u2009\xBB ET \xAB\u2009SELON LA DISPONIBILIT\xC9\u2009\xBB ET SANS GARANTIE D\u2019AUCUNE SORTE, EXPRESSE OU IMPLICITE, Y COMPRIS, MAIS SANS S\u2019Y LIMITER, LES GARANTIES IMPLICITES DE TITRE, NON-CONTREFA\xC7ON, QUALIT\xC9 MARCHANDE ET D\u2019AD\xC9QUATION \xC0 UN USAGE PARTICULIER, ET TOUTE GARANTIE IMPLICITE PAR TOUT COURS D\u2019EX\xC9CUTION OU D\u2019UTILISATION DU COMMERCE, QUI SONT EXPRESS\xC9MENT EXCLUES. LE FOURNISSEUR DE SERVICES ET SES ADMINISTRATEURS, EMPLOY\xC9S, AGENTS, FOURNISSEURS, PARTENAIRES ET FOURNISSEURS DE CONTENU NE GARANTISSENT PAS QUE : (A) LE CONTENU EST OPPORTUN, EXACT, COMPLET, FIABLE OU CORRECT; (B) LE SERVICE SERA S\xC9CURIS\xC9 OU DISPONIBLE \xC0 TOUT MOMENT OU ENDROIT PARTICULIER; (C) TOUT D\xC9FAUT OU ERREUR SERONT CORRIG\xC9S; (D) LE CONTENU EST EXEMPT DE VIRUS OU D\u2019AUTRES \xC9L\xC9MENTS NUISIBLES; OU (E) LES R\xC9SULTATS DE L\u2019UTILISATION DU SERVICE R\xC9PONDRONT \xC0 VOS BESOINS. VOTRE UTILISATION DU SERVICE EST UNIQUEMENT \xC0 VOS PROPRES RISQUES."),ne(),ae(133,"p"),_e(134,"LE FOURNISSEUR DE SERVICES N\u2019OFFRE AUCUNE GARANTIE, EXPRESSE OU IMPLICITE, PAR EFFET DE LA LOI OU AUTRE, CONCERNANT LE SERVICE OU LE CONTENU FOURNI OU EN LIEN AVEC CELUI-CI."),ne(),ae(135,"h2"),_e(136,"Limitation de responsabilit\xE9"),ne(),ae(137,"p"),_e(138,"EN AUCUN CAS LE FOURNISSEUR DE SERVICES, NI SES ADMINISTRATEURS, EMPLOY\xC9S, AGENTS, PARTENAIRES, FOURNISSEURS OU FOURNISSEURS DE CONTENU, NE SERA TENU RESPONSABLE EN VERTU D\u2019UN CONTRAT, DE D\xC9LIT, DE RESPONSABILIT\xC9 STRICTE, DE N\xC9GLIGENCE OU DE TOUTE AUTRE TH\xC9ORIE JURIDIQUE CONCERNANT LE SERVICE OU TOUT CONTENU (I) POUR TOUTE PERTE DE B\xC9N\xC9FICES OU TOUS DOMMAGES SP\xC9CIAUX, INDIRECTS, ACCESSOIRES, PUNITIFS OU CONS\xC9CUTIFS DE QUELQUE NATURE QUE CE SOIT, SUBSTITUENT DES BIENS OU SERVICES (PEU IMPORTE COMMENT CELA SURVIENT); (II) POUR TOUS LES BOGUES, VIRUS, CHEVAUX DE TROIE OU ANALOGUES (PEU IMPORTE LA SOURCE D\u2019ORIGINE); (III) POUR TOUTE ERREUR OU OMISSION DANS TOUT CONTENU OU POUR TOUTE PERTE OU DOMMAGE DE QUELQUE NATURE QUE CE SOIT R\xC9SULTANT DE VOTRE UTILISATION DE TOUT CONTENU PUBLI\xC9, ENVOY\xC9 PAR COURRIEL, TRANSMIS OU AUTREMENT MIS \xC0 DISPOSITION SUR OU PAR L\u2019INTERM\xC9DIAIRE DU SERVICE; OU (IV) POUR TOUT DOMMAGE DIRECT DE PLUS DE (EN TOTAL) 10 $ (CANADIEN)."),ne(),ae(139,"h2"),_e(140,"Indemnisation"),ne(),ae(141,"p"),_e(142,"Vous indemnisez et d\xE9gagerez le fournisseur de services de toute responsabilit\xE9 contre toute perte, co\xFBt, d\xE9pense, responsabilit\xE9 ou dommage, y compris, sans s\u2019y limiter, tous les honoraires d\u2019avocat et frais de justice raisonnables, r\xE9sultant de (i) l\u2019utilisation ou la mauvaise utilisation du service; (ii) votre acc\xE8s au site, l\u2019utilisation du service, la violation des conditions d\u2019utilisation par vous; ou, (iii) la violation par vous, ou tout tiers utilisant votre compte, de toute propri\xE9t\xE9 intellectuelle ou autre droit de toute personne ou entit\xE9. Ces pertes, co\xFBts, d\xE9penses, dommages ou responsabilit\xE9s incluront, sans limitation, tous les dommages r\xE9els, g\xE9n\xE9raux, sp\xE9ciaux et cons\xE9cutifs."),ne(),ae(143,"h2"),_e(144,"R\xE8glement des litiges"),ne(),ae(145,"p"),_e(146,"Une version imprim\xE9e des conditions d\u2019utilisation et de tout avis donn\xE9 sous forme \xE9lectronique est recevable dans les proc\xE9dures judiciaires ou administratives fond\xE9es sur les conditions d\u2019utilisation ou li\xE9es aux conditions d\u2019utilisation dans la m\xEAme mesure et sous r\xE9serve des m\xEAmes conditions que les autres documents commerciaux et enregistrements g\xE9n\xE9r\xE9s \xE0 l\u2019origine et conserv\xE9s sous forme imprim\xE9e. Vous acceptez que toute cause d\u2019action d\xE9coulant de ou li\xE9e au service doit commencer dans un d\xE9lai d\u2019un (1) an apr\xE8s la survenance de la cause d\u2019action; dans le cas contraire, une telle cause d\u2019action est d\xE9finitivement interdite."),ne(),ae(147,"p"),_e(148,"Ces conditions d\u2019utilisation seront r\xE9gies et interpr\xE9t\xE9es conform\xE9ment aux lois de la province de l\u2019Ontario. Tous les litiges en vertu des pr\xE9sentes conditions d\u2019utilisation seront r\xE9solus par les tribunaux provinciaux ou f\xE9d\xE9raux applicables de l\u2019Ontario. Vous consentez \xE0 la juridiction de ces tribunaux et renoncez \xE0 toute d\xE9fense juridictionnelle ou de lieu autrement disponible. L\u2019utilisation du service n\u2019est autoris\xE9e dans aucune juridiction qui ne donne pas effet \xE0 toutes les dispositions des conditions d\u2019utilisation, y compris, sans limitation, cette section."),ne(),ae(149,"h2"),_e(150,"Int\xE9gration et divisibilit\xE9"),ne(),ae(151,"p"),_e(152,"Les conditions d\u2019utilisation constituent l\u2019int\xE9gralit\xE9 de l\u2019accord entre vous et le fournisseur de services en ce qui concerne le service et l\u2019utilisation de son site, et remplacent toutes les communications et propositions ant\xE9rieures ou contemporaines (qu\u2019elles soient orales, \xE9crites ou \xE9lectroniques) entre vous et le fournisseur de services en ce qui concerne le site (mais \xE0 l\u2019exclusion de l\u2019utilisation de tout logiciel pouvant faire l\u2019objet d\u2019un contrat de licence d\u2019utilisateur final distinct). Si une disposition de ces conditions d\u2019utilisation est jug\xE9e inapplicable ou invalide, cette disposition sera limit\xE9e ou \xE9limin\xE9e dans la mesure minimale n\xE9cessaire afin que les conditions d\u2019utilisation restent par ailleurs pleinement en vigueur et ex\xE9cutoires."),ne(),ae(153,"h2"),_e(154,"Divers"),ne(),ae(155,"p"),_e(156,"Les conditions d\u2019utilisation vous sont personnelles et ne sont pas cessibles, transf\xE9rables ou sous-licenciables par vous, sauf avec le consentement \xE9crit pr\xE9alable du fournisseur de services. Le fournisseur de services peut c\xE9der, transf\xE9rer ou d\xE9l\xE9guer n\u2019importe lequel de ses droits et obligations en vertu des pr\xE9sentes sans consentement. Aucune agence, partenariat, coentreprise ou relation de travail n\u2019est cr\xE9\xE9 \xE0 la suite de ces conditions d\u2019utilisation et aucune des parties n\u2019a le pouvoir de quelque nature que ce soit de lier l\u2019autre \xE0 quelque \xE9gard que ce soit. Dans toute action ou proc\xE9dure visant \xE0 faire valoir les droits en vertu des pr\xE9sentes conditions d\u2019utilisation, la partie gagnante aura le droit de recouvrer les frais et honoraires d\u2019avocat. Tous les avis en vertu des pr\xE9sentes conditions d\u2019utilisation seront faits par \xE9crit et seront r\xE9put\xE9s avoir \xE9t\xE9 d\xFBment donn\xE9s lors de leur r\xE9ception, s\u2019ils sont personnellement remis ou envoy\xE9s par courrier certifi\xE9 ou recommand\xE9, avec accus\xE9 de r\xE9ception; lorsque la r\xE9ception est confirm\xE9e \xE9lectroniquement, s\u2019il est transmis par t\xE9l\xE9copieur ou par courriel; ou le lendemain de son envoi, s\u2019il est envoy\xE9 pour livraison le lendemain par un service de livraison de nuit reconnu."),ne(),ae(157,"h2"),_e(158,"Avis de droits d\u2019auteur et de marques"),ne(),ae(159,"p"),_e(160,"Vous reconnaissez que les droits d\u2019auteur de toutes les donn\xE9es ajout\xE9es par le fournisseur de services de vos documents, et de tout logiciel de recherche, guides d\u2019utilisation, documentation et toute autre propri\xE9t\xE9 intellectuelle pr\xE9par\xE9s par le fournisseur de services ou ses employ\xE9s pour aider les utilisateurs \xE0 l\u2019utilisation du service appartiendront \xE0 la personne qui l\u2019a cr\xE9\xE9."),ne(),ae(161,"p")(162,"em"),_e(163,"*MD *Le r\xE9seau Dataverse et le logo Dataverse sont des marques ou des marques d\xE9pos\xE9es de l\u2019Institute of Quantitative Social Science (IQSS) de l\u2019Universit\xE9 Harvard."),ne()(),ae(164,"p"),_e(165,"Ce document de conditions d\u2019utilisation est disponible sous un "),ae(166,"a",3),_e(167,"CC BY-SA 4.0"),ne(),_e(168,". Il comprend des parties d\xE9velopp\xE9es \xE0 l\u2019origine par Swivel, LLC, l\u2019Institute for Quantitative Social Science (IQSS) de l\u2019Universit\xE9 Harvard, l\u2019Universit\xE9 de Toronto et le Conseil des biblioth\xE8ques universitaires de l\u2019Ontario (CBUO)."),ne()()())},encapsulation:2});let t=e;return t})(),oKt=(()=>{let e=class e{constructor(r){this.dialogRef=r}closeDialog(){this.dialogRef.close()}submitFeedback(r){if(r.valid){let n=r.value;console.log("Feedback submitted:",n),this.dialogRef.close(n)}}};e.\u0275fac=function(n){return new(n||e)(Te(Ag))},e.\u0275cmp=Tt({type:e,selectors:[["contact-dialog-popup"]],standalone:!0,features:[zt],decls:59,vars:1,consts:[["feedbackForm","ngForm"],[2,"height","600px","width","700px","padding","20px 40px","overflow-y","auto","box-sizing","border-box","position","relative"],["aria-label","Close dialog",2,"position","absolute","top","10px","right","10px","background","transparent","border","none","font-size","24px","cursor","pointer",3,"click"],["mat-dialog-title","",2,"font-size","32px","font-weight","bold","margin-top","40px"],[2,"margin-top","20px"],[2,"margin-top","30px",3,"ngSubmit"],["appearance","outline",2,"width","100%","margin-bottom","20px"],["matInput","","type","email","name","email","ngModel","","required",""],["matInput","","type","text","name","affiliation","ngModel",""],["name","role","ngModel","","required",""],["value","Student"],["value","Researcher"],["value","Faculty"],["value","Librarian"],["value","Staff"],["value","Other"],["matInput","","name","likes","ngModel","","rows","4"],["matInput","","name","dislikes","ngModel","","rows","4"],["matInput","","name","interfaceFeedback","ngModel","","rows","4"],["appearance","outline",2,"width","100%","margin-bottom","30px"],["matInput","","name","navigationFeedback","ngModel","","required","","rows","4"],[2,"display","flex","justify-content","flex-end","gap","10px"],["mat-button","","type","button",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"disabled"]],template:function(n,o){if(n&1){let s=eo();ae(0,"div",1)(1,"button",2),At("click",function(){return _i(s),yi(o.closeDialog())}),_e(2," \u2715 "),ne(),ae(3,"h1",3),_e(4," Contact - Feedback Form"),ne(),ae(5,"p",4),_e(6," In order to ensure that the new Borealis Metrics Reporting application is fully functional and beneficial to the Canadian research data community, we are asking Borealis member institutions to take a few moments to provide feedback about their experience using the new Borealis Metrics Report. "),ne(),ae(7,"p"),_e(8," All responses are voluntary and can be anonymous. We ask you to provide your institution so we can adequately understand regional differences. If you have specific questions to which you would like a direct response from the Borealis team, please include your email address so we can be in touch. "),ne(),ae(9,"p")(10,"strong"),_e(11,"Thank you for taking the time to give us your feedback!"),ne()(),ae(12,"form",5,0),At("ngSubmit",function(){_i(s);let c=Js(13);return yi(o.submitFeedback(c))}),ae(14,"mat-form-field",6)(15,"mat-label"),_e(16,"Email "),ne(),bt(17,"input",7),ne(),ae(18,"mat-form-field",6)(19,"mat-label"),_e(20,"Affiliation (Institution)"),ne(),bt(21,"input",8),ne(),ae(22,"mat-form-field",6)(23,"mat-label"),_e(24,"Role"),ne(),ae(25,"mat-select",9)(26,"mat-option",10),_e(27,"Student"),ne(),ae(28,"mat-option",11),_e(29,"Researcher"),ne(),ae(30,"mat-option",12),_e(31,"Faculty"),ne(),ae(32,"mat-option",13),_e(33,"Librarian"),ne(),ae(34,"mat-option",14),_e(35,"Staff"),ne(),ae(36,"mat-option",15),_e(37,"Other"),ne()()(),ae(38,"mat-form-field",6)(39,"mat-label"),_e(40,"What do you like about the new Borealis Metrics Report?"),ne(),bt(41,"textarea",16),ne(),ae(42,"mat-form-field",6)(43,"mat-label"),_e(44,"What do you dislike about the new Borealis Metrics Report?"),ne(),bt(45,"textarea",17),ne(),ae(46,"mat-form-field",6)(47,"mat-label"),_e(48,"Feedback about the interface (layout, labels, visuals, tabs, etc.)"),ne(),bt(49,"textarea",18),ne(),ae(50,"mat-form-field",19)(51,"mat-label"),_e(52,"Feedback about navigating the Metrics Report"),ne(),bt(53,"textarea",20),ne(),ae(54,"div",21)(55,"button",22),At("click",function(){return _i(s),yi(o.closeDialog())}),_e(56,"Cancel"),ne(),ae(57,"button",23),_e(58,"Submit"),ne()()()()}if(n&2){let s=Js(13);Ye(57),ht("disabled",!s.valid)}},dependencies:[AA,rhe,A_,TA,Xue,mU,bx,I_,hv,bU,IA,wU,yU,Gu,$d,DU,Phe,gA],encapsulation:2});let t=e;return t})(),sKt=(()=>{let e=class e{constructor(r){this.dialogRef=r}closeDialog(){this.dialogRef.close()}};e.\u0275fac=function(n){return new(n||e)(Te(Ag))},e.\u0275cmp=Tt({type:e,selectors:[["faq-dialog-popup"]],decls:59,vars:0,consts:[[2,"height","600px","width","700px","padding","20px 40px","overflow-y","auto","box-sizing","border-box"],["aria-label","Close dialog",1,"close-button",2,"position","absolute","top","10px","right","10px","background","transparent","border","none","font-size","24px","cursor","pointer",3,"click"],[2,"font-size","32px","font-weight","bold","margin-top","40px"],["href","https://guides.dataverse.org/en/latest/api/metrics.html","target","_blank"],["href","mailto:info@borealisdata.ca"]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"button",1),At("click",function(){return o.closeDialog()}),_e(2," \u2715 "),ne(),ae(3,"h1",2),_e(4,"FAQ"),ne(),ae(5,"h3")(6,"strong"),_e(7,"Where is this data collected from?"),ne()(),ae(8,"p"),_e(9," Data is collected through the Dataverse Metrics API. For more information, visit: "),ae(10,"a",3),_e(11," guides.dataverse.org/en/latest/api/metrics.html "),ne()(),ae(12,"h3")(13,"strong"),_e(14,"What is \u201CBorealis (All)\u201D? "),ne()(),ae(15,"p"),_e(16," \u201CBorealis (All)\u201D refers to the entirety of Borealis, meaning the data represents all data and collections in Borealis. "),ne(),ae(17,"h3")(18,"strong"),_e(19,"Why isn\u2019t X specific dataverse included in the report?"),ne()(),ae(20,"p"),_e(21," It may take time for a new collection to be reflected in the source data. Additionally, collections must be published, not in draft mode, to be included. "),ne(),ae(22,"h3")(23,"strong"),_e(24,"Why isn\u2019t my collection displayed in French/English?"),ne()(),ae(25,"p"),_e(26," Collections are displayed in their original, published language. While the interface will update to match the language selected by the user, collection data will not. "),ne(),ae(27,"h3")(28,"strong"),_e(29,"What does \u201CLegacy\u201D mean for data download?"),ne()(),ae(30,"p"),_e(31," The Legacy download option provides a structured data export that was hosted on the previous version of the Borealis Metrics Report. Data in this export may be formatted differently from other available export formats such as Make Data Count. "),ne(),ae(32,"h3")(33,"strong"),_e(34,"What is Make Data Count?"),ne()(),ae(35,"p"),_e(36," Make Data Count is a third-party, community-led initiative that promotes the development of open data metrics to meaningfully assess data usage and impact. The intention is to establish standardized metrics for usage data such as views, downloads and citations that can be applied broadly across datasets and repository platforms to encourage collaboration and data sharing practices. "),ne(),ae(37,"p"),_e(38," Make Data Count is part of a larger initiative through the Research Data Alliance\u2019s Data Usage Metrics Working Group, and is operated in collaboration with DataCite. Make Data Count is unique in its focus on community-driven standards and its dedication to open metrics for widespread collaboration and adoption across the research data landscape. "),ne(),ae(39,"p"),_e(40," Make Data Count developed the COUNTER Code of Practice for Research Data, the standard used to track views and downloads in the Borealis Metrics Report. The Borealis Metrics Report also uses the DataCite Citation Corpus, co-developed by DataCite and Make Data Count, to provide citation metrics for data in Borealis. "),ne(),ae(41,"h3")(42,"strong"),_e(43,"It\u2019s the first day of the month \u2014 why isn\u2019t data from this month included in the report?"),ne()(),ae(44,"p"),_e(45," It can take a few business days (typically 3\u20135) for the current month\u2019s data to appear in the metrics. "),ne(),ae(46,"h3")(47,"strong"),_e(48,"Why can\u2019t I access metrics specific to my institution for the Odesi collection?"),ne()(),ae(49,"p"),_e(50," Following the Odesi redevelopment and migration from Nesstar to Borealis in 2023, the majority of data in Odesi is now open. As part of this transition, we no longer collect or provide institution-level metrics. "),ne(),ae(51,"h3")(52,"strong"),_e(53,"Who can I contact for other questions, improvements, discovered bugs and feature requests?"),ne()(),ae(54,"p"),_e(55," Please reach out via email to "),ae(56,"a",4),_e(57,"info@borealisdata.ca"),ne(),_e(58," using the contact tab and a member of our team will be happy to help "),ne()())},encapsulation:2});let t=e;return t})();var $9e=[{path:"",component:zz}];var G9e=(()=>{let e=class e{constructor(){this.http=Jt(ev)}getTranslation(r){return this.http.get(`assets/i18n/${r}.json`)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=kt({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var X9e={providers:[_de({eventCoalescing:!0}),Tde(),Bge({config:{availableLangs:["en","fr"],defaultLang:"en",reRenderOnLangChange:!0,prodMode:!wde()},loader:G9e}),Nde($9e),Dde(),Sge(xge())]};var aKt={providers:[Ode()]},K9e=Sde(X9e,aKt);var lKt=()=>Ade(zz,K9e),oar=lKt;export{Vi as a,yke as b,oar as c};
