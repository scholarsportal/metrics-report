<div>
  <h2 style="padding:20px;"> 
    <div style="float: left">
      <img style="max-width: 100%; height:30px; position: absolute;" src="assets/logo.png" alt="image">
      <div style="position: relative; left:35px"> {{ 'Title' | transloco }} </div>
    </div>
    <div style="float:right; align-items: center;">
      <div style="float:right; position: relative;">
        <button mat-button (click)="switchLanguage('en')" [disabled]="getLanguage()=='en'"> English </button>
        |
        <button mat-button (click)="switchLanguage('fr')" [disabled]="getLanguage()=='fr'"> Français </button>
      </div>
      <div  style="clear:both;">
        <button (click)="openAboutDialog()" style="min-width: 1%;" class="mat-small" mat-button> {{ 'About' | transloco }} </button>
        | 
        <button (click)="openTOCDialog()" style="min-width: 1%;" class="mat-small" mat-button> {{ 'TermsofUse' | transloco }} </button>
        |
        <button (click)="openContactDialog()" style="min-width: 1%;" class="mat-small" mat-button> {{ 'Contact' | transloco }} </button>
        |
        <button (click)="openFAQDialog()" style="min-width: 1%;" class="mat-small" mat-button> {{ 'FAQ' | transloco }} </button>
      </div>
    </div>
  </h2>
</div>

<mat-progress-bar mode="indeterminate" *ngIf="isLoading"></mat-progress-bar>
<div class="loading-overlay" *ngIf="isLoading"></div>

<app-posts (messageEvent)="getData($event)" [collectionSelected]="selectedCollection_Activate" [collectionSelectedName]="selectedCollection_Current_Name" [startDate]="date_start_activate" [endDate]="date_end_activate" [start_on]="date_select_on"></app-posts>

<!-- Content BELOW, inside your fit-content container -->
<div style="
  max-width: fit-content;
  margin-left: auto;
  margin-right: auto;
">

  <div style="clear:both;">
    <app-download #download [data]="raw_table_data" [name]="selectedOption"></app-download>
    <ng-template [ngIf]="true">

      <!-- Title + Date Container -->
  <div class="title-container" style="">
    <div *ngIf="selectedCollection_Activate === '(All)'" id="pdf_name">
      <h1 id="responsive-title" class="responsive-title">{{ 'All' | transloco }}</h1>
    </div>

    <div *ngIf="selectedCollection_Activate !== '(All)'" id="pdf_name">
      <h4 style="color: purple;"><b> • Collection Selected • </b></h4>
      <h1 id="responsive-title" class="responsive-title">{{ selectedCollection_Activate_Name }}</h1>
    </div>

    <div id="pdf_date" style="margin-bottom: 4px;">
      <p><i>{{ date_String }}</i></p>
    </div>

    <div *ngIf="error_flag" style="
    margin-bottom: 4px; 
    margin-left: 5px; 
    color: red; 
    border: 1px solid red; 
    border-radius: 8px; 
    background-color: #ffe5e5; 
    padding: 10px 10px 0px 10px; 
    max-width: 300px;
    line-height: 1;
    ">
  <p><i>{{ 'ErrorMessage1' | transloco }} </i></p> 
</div>
  </div>

      <hr style="border: none; height: 1px; background-color: #ccc; margin: 16px 0;">

      <div style="margin: auto; width: 100%; display: flex;">
        <div style="vertical-align:top;">
          <div id="main_meteris">

            <mat-card class="example-card hide-scrollbar" appearance="outlined" style="min-width: 350px; max-width: 350px; margin-bottom: 10px; margin-left: 5px; margin-top: 10px; max-height: 500px; overflow-y: auto; font-size: 12px;">
              <mat-card-header>
                <mat-card-title-group>
                  <mat-card-title> {{ 'DateRange' | transloco }} </mat-card-title>
                  <mat-card-subtitle> </mat-card-subtitle>
                </mat-card-title-group>
              </mat-card-header>
              <mat-card-content style="margin-top: 10px; margin-left: 17px">
                <div style="display: flex; flex-direction: row;">
                  <!-- Start Date -->
                  <mat-form-field appearance="outline" class="compact-form-field" style="margin-left: 10px;" disableRipple>
                    <mat-label>{{ 'StartDate' | transloco }}</mat-label>

                    <input matInput *ngIf="!start_on" disabled>

                    <input matInput *ngIf="start_on"
                           [matDatepicker]="dp_s"
                           [formControl]="date_start"
                           [min]="this.creation_date"
                           [max]="todayDate">

                    <mat-datepicker-toggle *ngIf="start_on"
                                           matIconSuffix
                                           [for]="dp_s"
                                           class="custom-toggle"
                                           [disableRipple]="true">
                      <mat-icon matDatepickerToggleIcon class="small-datepicker-icon">event</mat-icon>
                    </mat-datepicker-toggle>

                    <mat-datepicker #dp_s
                                    startView="multi-year"
                                    (monthSelected)="setStartMonthAndYear($event, dp_s)"
                                    panelClass="example-month-picker">
                    </mat-datepicker>
                  </mat-form-field>

                  <!-- End Date -->
                  <mat-form-field appearance="outline" class="compact-form-field" style="margin-left: 10px;" disableRipple>
                    <mat-label>{{ 'EndDate' | transloco }}</mat-label>

                    <input matInput
                           [matDatepicker]="dp_e"
                           [formControl]="date_end"
                           [min]="this.creation_date"
                           [max]="maxDate">

                    <mat-datepicker-toggle matIconSuffix
                                           [for]="dp_e"
                                           class="custom-toggle"
                                           [disableRipple]="true">
                      <mat-icon matDatepickerToggleIcon class="small-datepicker-icon">event</mat-icon>
                    </mat-datepicker-toggle>

                    <mat-datepicker #dp_e
                                    startView="multi-year"
                                    (monthSelected)="setEndMonthAndYear($event, dp_e)"
                                    panelClass="example-month-picker">
                    </mat-datepicker>
                  </mat-form-field>
                </div>

                <div style="display: flex; align-items: center; margin-top: -20px; margin-left: 12px; margin-right: 20px;">
                  <mat-checkbox 
                    matTooltip="Generates metrics from creation, visual displays last 24 months"
                    [ngModel]="!start_on"
                    (ngModelChange)="start_on = !$event"
                    style="font-size: 16px; transform: scale(0.9); transform-origin: left top; margin-left: 8px;">
                    {{ 'AllTime' | transloco }}
                  </mat-checkbox>

                  <div style="margin-left: auto; margin-right: 10px;">
                    <button (click)="CollectionDataButtonActivate()"
                            [disabled]="isStartTimeAfterEndTime()"
                            mat-button
                            style="border: 1px solid; font-size: 12px; width: 125px; height: 25px;">
                      {{ 'Submit' | transloco }}
                    </button>
                  </div>
                </div>

              </mat-card-content>
            </mat-card>

            <mat-card class="example-card hide-scrollbar" appearance="outlined" style="min-width: 350px; max-width: 350px; margin-left: 5px; max-height: 3165px; overflow-y: auto; font-size: 12px;">
              <mat-card-header>
                <mat-card-title-group>
                  <mat-card-title> {{ 'CollectionTree' | transloco }} </mat-card-title>
                  <mat-card-subtitle> </mat-card-subtitle>
                </mat-card-title-group>
              </mat-card-header>
              <mat-card-content>
                <app-tree [data]="raw_table_data" [current_active]="selectedCollection_Activate_Name" (dataEvent)="getCollectionFromTree($event)"> </app-tree>
              </mat-card-content>
            </mat-card>

          </div>
        </div> 
        
        <app-graph-dashboard [data]="raw_table_data" [selectedCollection_Activate_Name]="selectedCollection_Activate_Name"></app-graph-dashboard>

        <app-value-export-dashboard [data]="raw_table_data" [selectedCollection_Activate_Name]="selectedCollection_Activate_Name" [date_start_on]="date_start_activate"></app-value-export-dashboard>

      </div>
            
      <div style="padding-top: 1200px; height: 1000px">
      </div>
    
    </ng-template>

</div>